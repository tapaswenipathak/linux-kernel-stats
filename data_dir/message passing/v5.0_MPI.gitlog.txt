commit 8294b4a889218daea3ddf7101f1afe62461883a6
Author: Masahiro Yamada <masahiroy@kernel.org>
Date:   Sat Jan 7 01:12:13 2023 +0900

    riscv: fix -Wundef warning for CONFIG_RISCV_BOOT_SPINWAIT
    
    commit 5b89c6f9b2df2b7cf6da8e0b2b87c8995b378cad upstream.
    
    Since commit 80b6093b55e3 ("kbuild: add -Wundef to KBUILD_CPPFLAGS
    for W=1 builds"), building with W=1 detects misuse of #if.
    
      $ make W=1 ARCH=riscv CROSS_COMPILE=riscv64-linux-gnu- arch/riscv/kernel/
        [snip]
        AS      arch/riscv/kernel/head.o
      arch/riscv/kernel/head.S:329:5: warning: "CONFIG_RISCV_BOOT_SPINWAIT" is not defined, evaluates to 0 [-Wundef]
        329 | #if CONFIG_RISCV_BOOT_SPINWAIT
            |     ^~~~~~~~~~~~~~~~~~~~~~~~~~
    
    CONFIG_RISCV_BOOT_SPINWAIT is a bool option. #ifdef should be used.
    
    Signed-off-by: Masahiro Yamada <masahiroy@kernel.org>
    Fixes: 2ffc48fc7071 ("RISC-V: Move spinwait booting method to its own config")
    Link: https://lore.kernel.org/r/20230106161213.2374093-1-masahiroy@kernel.org
    Cc: stable@vger.kernel.org
    Signed-off-by: Palmer Dabbelt <palmer@rivosinc.com>
    Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>

commit f5e58b546cbe76f049df97570cf0580aaaf3f900
Author: Arnd Bergmann <arnd@arndb.de>
Date:   Tue Jan 17 17:44:43 2023 +0100

    drm/panfrost: fix GENERIC_ATOMIC64 dependency
    
    [ Upstream commit 6437a549ae178a3f5a5c03e983f291ebcdc2bbc7 ]
    
    On ARMv5 and earlier, a randconfig build can still run into
    
    WARNING: unmet direct dependencies detected for IOMMU_IO_PGTABLE_LPAE
      Depends on [n]: IOMMU_SUPPORT [=y] && (ARM [=y] || ARM64 || COMPILE_TEST [=y]) && !GENERIC_ATOMIC64 [=y]
      Selected by [y]:
      - DRM_PANFROST [=y] && HAS_IOMEM [=y] && DRM [=y] && (ARM [=y] || ARM64 || COMPILE_TEST [=y] && !GENERIC_ATOMIC64 [=y]) && MMU [=y]
    
    Rework the dependencies to always require a working cmpxchg64.
    
    Fixes: db594ba3fcf9 ("drm/panfrost: depend on !GENERIC_ATOMIC64 when using COMPILE_TEST")
    Signed-off-by: Arnd Bergmann <arnd@arndb.de>
    Reviewed-by: Steven Price <steven.price@arm.com>
    Signed-off-by: Steven Price <steven.price@arm.com>
    Link: https://patchwork.freedesktop.org/patch/msgid/20230117164456.1591901-1-arnd@kernel.org
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit ba4ca7d2dd85bf46ca22c89209ad1093517acb8f
Author: Randy Dunlap <rdunlap@infradead.org>
Date:   Mon Jan 9 22:25:29 2023 -0800

    phy: ti: fix Kconfig warning and operator precedence
    
    [ Upstream commit 7124c93887cc4e6c5b48920f83115e4a5892e870 ]
    
    Fix Kconfig depends operator precedence to prevent a Kconfig warning:
    
    WARNING: unmet direct dependencies detected for MUX_MMIO
      Depends on [n]: MULTIPLEXER [=m] && OF [=n]
      Selected by [m]:
      - PHY_AM654_SERDES [=m] && (OF [=n] && ARCH_K3 || COMPILE_TEST [=y]) && COMMON_CLK [=y]
    
    Fixes: 71e2f5c5c224 ("phy: ti: Add a new SERDES driver for TI's AM654x SoC")
    Fixes: 091876cc355d ("phy: ti: j721e-wiz: Add support for WIZ module present in TI J721E SoC")
    Signed-off-by: Randy Dunlap <rdunlap@infradead.org>
    Cc: Vinod Koul <vkoul@kernel.org>
    Cc: Kishon Vijay Abraham I <kishon@kernel.org>
    Cc: linux-phy@lists.infradead.org
    Cc: Arnd Bergmann <arnd@arndb.de>
    Link: https://lore.kernel.org/r/20230110062529.22668-1-rdunlap@infradead.org
    Signed-off-by: Vinod Koul <vkoul@kernel.org>
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit 80bb370bce773e137f795356598eb3ad326c14bd
Author: Masahiro Yamada <masahiroy@kernel.org>
Date:   Mon Jan 9 04:23:17 2023 +0900

    kbuild: export top-level LDFLAGS_vmlinux only to scripts/Makefile.vmlinux
    
    [ Upstream commit 8debed3efe3a731451ad9a91a7a74eeb18a7f7eb ]
    
    Nathan Chancellor reports that $(NM) emits an error message when
    GNU Make 4.4 is used to build the ARM zImage.
    
      $ make-4.4 ARCH=arm CROSS_COMPILE=arm-linux-gnueabi- O=build defconfig zImage
        [snip]
        LD      vmlinux
        NM      System.map
        SORTTAB vmlinux
        OBJCOPY arch/arm/boot/Image
        Kernel: arch/arm/boot/Image is ready
      arm-linux-gnueabi-nm: 'arch/arm/boot/compressed/../../../../vmlinux': No such file
      /bin/sh: 1: arithmetic expression: expecting primary: " "
        LDS     arch/arm/boot/compressed/vmlinux.lds
        AS      arch/arm/boot/compressed/head.o
        GZIP    arch/arm/boot/compressed/piggy_data
        AS      arch/arm/boot/compressed/piggy.o
        CC      arch/arm/boot/compressed/misc.o
    
    This occurs since GNU Make commit 98da874c4303 ("[SV 10593] Export
    variables to $(shell ...) commands"), and the O= option is needed to
    reproduce it. The generated zImage is correct despite the error message.
    
    As the commit description of 98da874c4303 [1] says, exported variables
    are passed down to $(shell ) functions, which means exported recursive
    variables might be expanded earlier than before, in the parse stage.
    
    The following test code demonstrates the change for GNU Make 4.4.
    
    [Test Makefile]
    
      $(shell echo hello > foo)
      export foo = $(shell cat bar/../foo)
      $(shell mkdir bar)
    
      all:
              @echo $(foo)
    
    [GNU Make 4.3]
    
      $ rm -rf bar; make-4.3
      hello
    
    [GNU Make 4.4]
    
      $ rm -rf bar; make-4.4
      cat: bar/../foo: No such file or directory
      hello
    
    The 'foo' is a resursively expanded (i.e. lazily expanded) variable.
    
    GNU Make 4.3 expands 'foo' just before running the recipe '@echo $(foo)',
    at this point, the directory 'bar' exists.
    
    GNU Make 4.4 expands 'foo' to evaluate $(shell mkdir bar) because it is
    exported. At this point, the directory 'bar' does not exit yet. The cat
    command cannot resolve the bar/../foo path, hence the error message.
    
    Let's get back to the kernel Makefile.
    
    In arch/arm/boot/compressed/Makefile, KBSS_SZ is referenced by
    LDFLAGS_vmlinux, which is recursive and also exported by the top
    Makefile.
    
    GNU Make 4.3 expands KBSS_SZ just before running the recipes, so no
    error message.
    
    GNU Make 4.4 expands KBSS_SZ in the parse stage, where the directory
    arm/arm/boot/compressed does not exit yet. When compiled with O=,
    the output directory is created by $(shell mkdir -p $(obj-dirs))
    in scripts/Makefile.build.
    
    There are two ways to fix this particular issue:
    
     - change "$(obj)/../../../../vmlinux" in KBSS_SZ to "vmlinux"
     - unexport LDFLAGS_vmlinux
    
    This commit takes the latter course because it is what I originally
    intended.
    
    Commit 3ec8a5b33dea ("kbuild: do not export LDFLAGS_vmlinux")
    unexported LDFLAGS_vmlinux.
    
    Commit 5d4aeffbf709 ("kbuild: rebuild .vmlinux.export.o when its
    prerequisite is updated") accidentally exported it again.
    
    We can clean up arch/arm/boot/compressed/Makefile later.
    
    [1]: https://git.savannah.gnu.org/cgit/make.git/commit/?id=98da874c43035a490cdca81331724f233a3d0c9a
    
    Link: https://lore.kernel.org/all/Y7i8+EjwdnhHtlrr@dev-arch.thelio-3990X/
    Fixes: 5d4aeffbf709 ("kbuild: rebuild .vmlinux.export.o when its prerequisite is updated")
    Reported-by: Nathan Chancellor <nathan@kernel.org>
    Signed-off-by: Masahiro Yamada <masahiroy@kernel.org>
    Reviewed-by: Nicolas Schier <nicolas@fjasle.eu>
    Tested-by: Nathan Chancellor <nathan@kernel.org>
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit 00b433d5664abf96d2c286fa57899fce7e3c4ce9
Author: Randy Dunlap <rdunlap@infradead.org>
Date:   Sat Oct 29 22:56:36 2022 -0700

    reset: ti-sci: honor TI_SCI_PROTOCOL setting when not COMPILE_TEST
    
    [ Upstream commit 13678f3feb3009b23aab424864fd0dac0765c83e ]
    
    There is a build error when COMPILE_TEST=y, TI_SCI_PROTOCOL=m,
    and RESET_TI_SCI=y:
    
    drivers/reset/reset-ti-sci.o: in function `ti_sci_reset_probe':
    reset-ti-sci.c:(.text+0x22c): undefined reference to `devm_ti_sci_get_handle'
    
    Fix this by making RESET_TI_SCI honor the Kconfig setting of
    TI_SCI_PROTOCOL when COMPILE_TEST is not set. When COMPILE_TEST is set,
    TI_SCI_PROTOCOL must be disabled (=n).
    
    Fixes: a6af504184c9 ("reset: ti-sci: Allow building under COMPILE_TEST")
    Signed-off-by: Randy Dunlap <rdunlap@infradead.org>
    Reported-by: kernel test robot <lkp@intel.com>
    Cc: Nishanth Menon <nm@ti.com>
    Cc: Tero Kristo <kristo@kernel.org>
    Cc: Santosh Shilimkar <ssantosh@kernel.org>
    Cc: linux-arm-kernel@lists.infradead.org
    Cc: Philipp Zabel <p.zabel@pengutronix.de>
    Reviewed-by: Nishanth Menon <nm@ti.com>
    Link: https://lore.kernel.org/r/20221030055636.3139-1-rdunlap@infradead.org
    Signed-off-by: Philipp Zabel <p.zabel@pengutronix.de>
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit 1e7919f0b1562b27a50683a92e2dbca6d9355511
Author: Arnd Bergmann <arnd@arndb.de>
Date:   Tue Jan 17 17:44:43 2023 +0100

    drm/panfrost: fix GENERIC_ATOMIC64 dependency
    
    [ Upstream commit 6437a549ae178a3f5a5c03e983f291ebcdc2bbc7 ]
    
    On ARMv5 and earlier, a randconfig build can still run into
    
    WARNING: unmet direct dependencies detected for IOMMU_IO_PGTABLE_LPAE
      Depends on [n]: IOMMU_SUPPORT [=y] && (ARM [=y] || ARM64 || COMPILE_TEST [=y]) && !GENERIC_ATOMIC64 [=y]
      Selected by [y]:
      - DRM_PANFROST [=y] && HAS_IOMEM [=y] && DRM [=y] && (ARM [=y] || ARM64 || COMPILE_TEST [=y] && !GENERIC_ATOMIC64 [=y]) && MMU [=y]
    
    Rework the dependencies to always require a working cmpxchg64.
    
    Fixes: db594ba3fcf9 ("drm/panfrost: depend on !GENERIC_ATOMIC64 when using COMPILE_TEST")
    Signed-off-by: Arnd Bergmann <arnd@arndb.de>
    Reviewed-by: Steven Price <steven.price@arm.com>
    Signed-off-by: Steven Price <steven.price@arm.com>
    Link: https://patchwork.freedesktop.org/patch/msgid/20230117164456.1591901-1-arnd@kernel.org
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit 24af570c99b4d249907bdb29fb8c16c7f7f82866
Author: Randy Dunlap <rdunlap@infradead.org>
Date:   Mon Jan 9 22:25:29 2023 -0800

    phy: ti: fix Kconfig warning and operator precedence
    
    [ Upstream commit 7124c93887cc4e6c5b48920f83115e4a5892e870 ]
    
    Fix Kconfig depends operator precedence to prevent a Kconfig warning:
    
    WARNING: unmet direct dependencies detected for MUX_MMIO
      Depends on [n]: MULTIPLEXER [=m] && OF [=n]
      Selected by [m]:
      - PHY_AM654_SERDES [=m] && (OF [=n] && ARCH_K3 || COMPILE_TEST [=y]) && COMMON_CLK [=y]
    
    Fixes: 71e2f5c5c224 ("phy: ti: Add a new SERDES driver for TI's AM654x SoC")
    Fixes: 091876cc355d ("phy: ti: j721e-wiz: Add support for WIZ module present in TI J721E SoC")
    Signed-off-by: Randy Dunlap <rdunlap@infradead.org>
    Cc: Vinod Koul <vkoul@kernel.org>
    Cc: Kishon Vijay Abraham I <kishon@kernel.org>
    Cc: linux-phy@lists.infradead.org
    Cc: Arnd Bergmann <arnd@arndb.de>
    Link: https://lore.kernel.org/r/20230110062529.22668-1-rdunlap@infradead.org
    Signed-off-by: Vinod Koul <vkoul@kernel.org>
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit 1e97e2e08e79a55488876d7d538d0ddb7d0a6552
Author: Arnd Bergmann <arnd@arndb.de>
Date:   Tue Jan 17 17:44:43 2023 +0100

    drm/panfrost: fix GENERIC_ATOMIC64 dependency
    
    [ Upstream commit 6437a549ae178a3f5a5c03e983f291ebcdc2bbc7 ]
    
    On ARMv5 and earlier, a randconfig build can still run into
    
    WARNING: unmet direct dependencies detected for IOMMU_IO_PGTABLE_LPAE
      Depends on [n]: IOMMU_SUPPORT [=y] && (ARM [=y] || ARM64 || COMPILE_TEST [=y]) && !GENERIC_ATOMIC64 [=y]
      Selected by [y]:
      - DRM_PANFROST [=y] && HAS_IOMEM [=y] && DRM [=y] && (ARM [=y] || ARM64 || COMPILE_TEST [=y] && !GENERIC_ATOMIC64 [=y]) && MMU [=y]
    
    Rework the dependencies to always require a working cmpxchg64.
    
    Fixes: db594ba3fcf9 ("drm/panfrost: depend on !GENERIC_ATOMIC64 when using COMPILE_TEST")
    Signed-off-by: Arnd Bergmann <arnd@arndb.de>
    Reviewed-by: Steven Price <steven.price@arm.com>
    Signed-off-by: Steven Price <steven.price@arm.com>
    Link: https://patchwork.freedesktop.org/patch/msgid/20230117164456.1591901-1-arnd@kernel.org
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit fa566549a152a99b6aca9be80b84d506eb2a91c6
Author: Randy Dunlap <rdunlap@infradead.org>
Date:   Mon Jan 9 22:25:29 2023 -0800

    phy: ti: fix Kconfig warning and operator precedence
    
    [ Upstream commit 7124c93887cc4e6c5b48920f83115e4a5892e870 ]
    
    Fix Kconfig depends operator precedence to prevent a Kconfig warning:
    
    WARNING: unmet direct dependencies detected for MUX_MMIO
      Depends on [n]: MULTIPLEXER [=m] && OF [=n]
      Selected by [m]:
      - PHY_AM654_SERDES [=m] && (OF [=n] && ARCH_K3 || COMPILE_TEST [=y]) && COMMON_CLK [=y]
    
    Fixes: 71e2f5c5c224 ("phy: ti: Add a new SERDES driver for TI's AM654x SoC")
    Fixes: 091876cc355d ("phy: ti: j721e-wiz: Add support for WIZ module present in TI J721E SoC")
    Signed-off-by: Randy Dunlap <rdunlap@infradead.org>
    Cc: Vinod Koul <vkoul@kernel.org>
    Cc: Kishon Vijay Abraham I <kishon@kernel.org>
    Cc: linux-phy@lists.infradead.org
    Cc: Arnd Bergmann <arnd@arndb.de>
    Link: https://lore.kernel.org/r/20230110062529.22668-1-rdunlap@infradead.org
    Signed-off-by: Vinod Koul <vkoul@kernel.org>
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit 5b89c6f9b2df2b7cf6da8e0b2b87c8995b378cad
Author: Masahiro Yamada <masahiroy@kernel.org>
Date:   Sat Jan 7 01:12:13 2023 +0900

    riscv: fix -Wundef warning for CONFIG_RISCV_BOOT_SPINWAIT
    
    Since commit 80b6093b55e3 ("kbuild: add -Wundef to KBUILD_CPPFLAGS
    for W=1 builds"), building with W=1 detects misuse of #if.
    
      $ make W=1 ARCH=riscv CROSS_COMPILE=riscv64-linux-gnu- arch/riscv/kernel/
        [snip]
        AS      arch/riscv/kernel/head.o
      arch/riscv/kernel/head.S:329:5: warning: "CONFIG_RISCV_BOOT_SPINWAIT" is not defined, evaluates to 0 [-Wundef]
        329 | #if CONFIG_RISCV_BOOT_SPINWAIT
            |     ^~~~~~~~~~~~~~~~~~~~~~~~~~
    
    CONFIG_RISCV_BOOT_SPINWAIT is a bool option. #ifdef should be used.
    
    Signed-off-by: Masahiro Yamada <masahiroy@kernel.org>
    Fixes: 2ffc48fc7071 ("RISC-V: Move spinwait booting method to its own config")
    Link: https://lore.kernel.org/r/20230106161213.2374093-1-masahiroy@kernel.org
    Cc: stable@vger.kernel.org
    Signed-off-by: Palmer Dabbelt <palmer@rivosinc.com>

commit 6437a549ae178a3f5a5c03e983f291ebcdc2bbc7
Author: Arnd Bergmann <arnd@arndb.de>
Date:   Tue Jan 17 17:44:43 2023 +0100

    drm/panfrost: fix GENERIC_ATOMIC64 dependency
    
    On ARMv5 and earlier, a randconfig build can still run into
    
    WARNING: unmet direct dependencies detected for IOMMU_IO_PGTABLE_LPAE
      Depends on [n]: IOMMU_SUPPORT [=y] && (ARM [=y] || ARM64 || COMPILE_TEST [=y]) && !GENERIC_ATOMIC64 [=y]
      Selected by [y]:
      - DRM_PANFROST [=y] && HAS_IOMEM [=y] && DRM [=y] && (ARM [=y] || ARM64 || COMPILE_TEST [=y] && !GENERIC_ATOMIC64 [=y]) && MMU [=y]
    
    Rework the dependencies to always require a working cmpxchg64.
    
    Fixes: db594ba3fcf9 ("drm/panfrost: depend on !GENERIC_ATOMIC64 when using COMPILE_TEST")
    Signed-off-by: Arnd Bergmann <arnd@arndb.de>
    Reviewed-by: Steven Price <steven.price@arm.com>
    Signed-off-by: Steven Price <steven.price@arm.com>
    Link: https://patchwork.freedesktop.org/patch/msgid/20230117164456.1591901-1-arnd@kernel.org

commit 9bfa3a61503743c91081004141953da90d2eaca0
Author: Shin'ichiro Kawasaki <shinichiro.kawasaki@wdc.com>
Date:   Wed Dec 7 11:36:59 2022 +0900

    scsi: mpi3mr: Refer CONFIG_SCSI_MPI3MR in Makefile
    
    [ Upstream commit f0a43ba6c66cc0688e2748d986a1459fdd3442ef ]
    
    When Kconfig item CONFIG_SCSI_MPI3MR was introduced for mpi3mr driver, the
    Makefile of the driver was not modified to refer the Kconfig item.
    
    As a result, mpi3mr.ko is built regardless of the Kconfig item value y or
    m. Also, if 'make localmodconfig' can not find the Kconfig item in the
    Makefile, then it does not generate CONFIG_SCSI_MPI3MR=m even when
    mpi3mr.ko is loaded on the system.
    
    Refer to the Kconfig item to avoid the issues.
    
    Fixes: c4f7ac64616e ("scsi: mpi3mr: Add mpi30 Rev-R headers and Kconfig")
    Signed-off-by: Shin'ichiro Kawasaki <shinichiro.kawasaki@wdc.com>
    Link: https://lore.kernel.org/r/20221207023659.2411785-1-shinichiro.kawasaki@wdc.com
    Reviewed-by: Damien Le Moal <damien.lemoal@opensource.wdc.com>
    Acked-by: Sathya Prakash Veerichetty <sathya.prakash@broadcom.com>
    Signed-off-by: Martin K. Petersen <martin.petersen@oracle.com>
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit 13259b60b71b2f1e83b8e91f78f9728d470c1042
Author: Shin'ichiro Kawasaki <shinichiro.kawasaki@wdc.com>
Date:   Wed Dec 7 11:36:59 2022 +0900

    scsi: mpi3mr: Refer CONFIG_SCSI_MPI3MR in Makefile
    
    [ Upstream commit f0a43ba6c66cc0688e2748d986a1459fdd3442ef ]
    
    When Kconfig item CONFIG_SCSI_MPI3MR was introduced for mpi3mr driver, the
    Makefile of the driver was not modified to refer the Kconfig item.
    
    As a result, mpi3mr.ko is built regardless of the Kconfig item value y or
    m. Also, if 'make localmodconfig' can not find the Kconfig item in the
    Makefile, then it does not generate CONFIG_SCSI_MPI3MR=m even when
    mpi3mr.ko is loaded on the system.
    
    Refer to the Kconfig item to avoid the issues.
    
    Fixes: c4f7ac64616e ("scsi: mpi3mr: Add mpi30 Rev-R headers and Kconfig")
    Signed-off-by: Shin'ichiro Kawasaki <shinichiro.kawasaki@wdc.com>
    Link: https://lore.kernel.org/r/20221207023659.2411785-1-shinichiro.kawasaki@wdc.com
    Reviewed-by: Damien Le Moal <damien.lemoal@opensource.wdc.com>
    Acked-by: Sathya Prakash Veerichetty <sathya.prakash@broadcom.com>
    Signed-off-by: Martin K. Petersen <martin.petersen@oracle.com>
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit d089baa5b68a18fd9fcb8003837681875dd7a214
Author: Manivannan Sadhasivam <manivannan.sadhasivam@linaro.org>
Date:   Tue Nov 29 12:41:59 2022 +0530

    soc: qcom: Select REMAP_MMIO for LLCC driver
    
    commit 5d2fe2d7b616b8baa18348ead857b504fc2de336 upstream.
    
    LLCC driver uses REGMAP_MMIO for accessing the hardware registers. So
    select the dependency in Kconfig. Without this, there will be errors
    while building the driver with COMPILE_TEST only:
    
    ERROR: modpost: "__devm_regmap_init_mmio_clk" [drivers/soc/qcom/llcc-qcom.ko] undefined!
    make[1]: *** [scripts/Makefile.modpost:126: Module.symvers] Error 1
    make: *** [Makefile:1944: modpost] Error 2
    
    Cc: <stable@vger.kernel.org> # 4.19
    Fixes: a3134fb09e0b ("drivers: soc: Add LLCC driver")
    Reported-by: Borislav Petkov <bp@alien8.de>
    Signed-off-by: Manivannan Sadhasivam <manivannan.sadhasivam@linaro.org>
    Signed-off-by: Bjorn Andersson <andersson@kernel.org>
    Link: https://lore.kernel.org/r/20221129071201.30024-2-manivannan.sadhasivam@linaro.org
    Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>

commit 4f1d37ff4226eb99d6b69e9f4518e279e1a851bf
Author: Eric Dumazet <edumazet@google.com>
Date:   Fri Dec 16 16:29:17 2022 +0000

    net: stream: purge sk_error_queue in sk_stream_kill_queues()
    
    [ Upstream commit e0c8bccd40fc1c19e1d246c39bcf79e357e1ada3 ]
    
    Changheon Lee reported TCP socket leaks, with a nice repro.
    
    It seems we leak TCP sockets with the following sequence:
    
    1) SOF_TIMESTAMPING_TX_ACK is enabled on the socket.
    
       Each ACK will cook an skb put in error queue, from __skb_tstamp_tx().
       __skb_tstamp_tx() is using skb_clone(), unless
       SOF_TIMESTAMPING_OPT_TSONLY was also requested.
    
    2) If the application is also using MSG_ZEROCOPY, then we put in the
       error queue cloned skbs that had a struct ubuf_info attached to them.
    
       Whenever an struct ubuf_info is allocated, sock_zerocopy_alloc()
       does a sock_hold().
    
       As long as the cloned skbs are still in sk_error_queue,
       socket refcount is kept elevated.
    
    3) Application closes the socket, while error queue is not empty.
    
    Since tcp_close() no longer purges the socket error queue,
    we might end up with a TCP socket with at least one skb in
    error queue keeping the socket alive forever.
    
    This bug can be (ab)used to consume all kernel memory
    and freeze the host.
    
    We need to purge the error queue, with proper synchronization
    against concurrent writers.
    
    Fixes: 24bcbe1cc69f ("net: stream: don't purge sk_error_queue in sk_stream_kill_queues()")
    Reported-by: Changheon Lee <darklight2357@icloud.com>
    Signed-off-by: Eric Dumazet <edumazet@google.com>
    Signed-off-by: David S. Miller <davem@davemloft.net>
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit 24724b2cbc7c0e60f2ed218ea8ae44cc122b3bf2
Author: Manivannan Sadhasivam <manivannan.sadhasivam@linaro.org>
Date:   Tue Nov 29 12:41:59 2022 +0530

    soc: qcom: Select REMAP_MMIO for LLCC driver
    
    commit 5d2fe2d7b616b8baa18348ead857b504fc2de336 upstream.
    
    LLCC driver uses REGMAP_MMIO for accessing the hardware registers. So
    select the dependency in Kconfig. Without this, there will be errors
    while building the driver with COMPILE_TEST only:
    
    ERROR: modpost: "__devm_regmap_init_mmio_clk" [drivers/soc/qcom/llcc-qcom.ko] undefined!
    make[1]: *** [scripts/Makefile.modpost:126: Module.symvers] Error 1
    make: *** [Makefile:1944: modpost] Error 2
    
    Cc: <stable@vger.kernel.org> # 4.19
    Fixes: a3134fb09e0b ("drivers: soc: Add LLCC driver")
    Reported-by: Borislav Petkov <bp@alien8.de>
    Signed-off-by: Manivannan Sadhasivam <manivannan.sadhasivam@linaro.org>
    Signed-off-by: Bjorn Andersson <andersson@kernel.org>
    Link: https://lore.kernel.org/r/20221129071201.30024-2-manivannan.sadhasivam@linaro.org
    Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>

commit 6f00bd0402a1e3d2d556afba57c045bd7931e4d3
Author: Eric Dumazet <edumazet@google.com>
Date:   Fri Dec 16 16:29:17 2022 +0000

    net: stream: purge sk_error_queue in sk_stream_kill_queues()
    
    [ Upstream commit e0c8bccd40fc1c19e1d246c39bcf79e357e1ada3 ]
    
    Changheon Lee reported TCP socket leaks, with a nice repro.
    
    It seems we leak TCP sockets with the following sequence:
    
    1) SOF_TIMESTAMPING_TX_ACK is enabled on the socket.
    
       Each ACK will cook an skb put in error queue, from __skb_tstamp_tx().
       __skb_tstamp_tx() is using skb_clone(), unless
       SOF_TIMESTAMPING_OPT_TSONLY was also requested.
    
    2) If the application is also using MSG_ZEROCOPY, then we put in the
       error queue cloned skbs that had a struct ubuf_info attached to them.
    
       Whenever an struct ubuf_info is allocated, sock_zerocopy_alloc()
       does a sock_hold().
    
       As long as the cloned skbs are still in sk_error_queue,
       socket refcount is kept elevated.
    
    3) Application closes the socket, while error queue is not empty.
    
    Since tcp_close() no longer purges the socket error queue,
    we might end up with a TCP socket with at least one skb in
    error queue keeping the socket alive forever.
    
    This bug can be (ab)used to consume all kernel memory
    and freeze the host.
    
    We need to purge the error queue, with proper synchronization
    against concurrent writers.
    
    Fixes: 24bcbe1cc69f ("net: stream: don't purge sk_error_queue in sk_stream_kill_queues()")
    Reported-by: Changheon Lee <darklight2357@icloud.com>
    Signed-off-by: Eric Dumazet <edumazet@google.com>
    Signed-off-by: David S. Miller <davem@davemloft.net>
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit bab542cf56fc174c8447c00b73be99ffd66d2d39
Author: Eric Dumazet <edumazet@google.com>
Date:   Fri Dec 16 16:29:17 2022 +0000

    net: stream: purge sk_error_queue in sk_stream_kill_queues()
    
    [ Upstream commit e0c8bccd40fc1c19e1d246c39bcf79e357e1ada3 ]
    
    Changheon Lee reported TCP socket leaks, with a nice repro.
    
    It seems we leak TCP sockets with the following sequence:
    
    1) SOF_TIMESTAMPING_TX_ACK is enabled on the socket.
    
       Each ACK will cook an skb put in error queue, from __skb_tstamp_tx().
       __skb_tstamp_tx() is using skb_clone(), unless
       SOF_TIMESTAMPING_OPT_TSONLY was also requested.
    
    2) If the application is also using MSG_ZEROCOPY, then we put in the
       error queue cloned skbs that had a struct ubuf_info attached to them.
    
       Whenever an struct ubuf_info is allocated, sock_zerocopy_alloc()
       does a sock_hold().
    
       As long as the cloned skbs are still in sk_error_queue,
       socket refcount is kept elevated.
    
    3) Application closes the socket, while error queue is not empty.
    
    Since tcp_close() no longer purges the socket error queue,
    we might end up with a TCP socket with at least one skb in
    error queue keeping the socket alive forever.
    
    This bug can be (ab)used to consume all kernel memory
    and freeze the host.
    
    We need to purge the error queue, with proper synchronization
    against concurrent writers.
    
    Fixes: 24bcbe1cc69f ("net: stream: don't purge sk_error_queue in sk_stream_kill_queues()")
    Reported-by: Changheon Lee <darklight2357@icloud.com>
    Signed-off-by: Eric Dumazet <edumazet@google.com>
    Signed-off-by: David S. Miller <davem@davemloft.net>
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit 780297af3c85266d2f286e778132e9016630735f
Author: Manivannan Sadhasivam <manivannan.sadhasivam@linaro.org>
Date:   Tue Nov 29 12:41:59 2022 +0530

    soc: qcom: Select REMAP_MMIO for LLCC driver
    
    commit 5d2fe2d7b616b8baa18348ead857b504fc2de336 upstream.
    
    LLCC driver uses REGMAP_MMIO for accessing the hardware registers. So
    select the dependency in Kconfig. Without this, there will be errors
    while building the driver with COMPILE_TEST only:
    
    ERROR: modpost: "__devm_regmap_init_mmio_clk" [drivers/soc/qcom/llcc-qcom.ko] undefined!
    make[1]: *** [scripts/Makefile.modpost:126: Module.symvers] Error 1
    make: *** [Makefile:1944: modpost] Error 2
    
    Cc: <stable@vger.kernel.org> # 4.19
    Fixes: a3134fb09e0b ("drivers: soc: Add LLCC driver")
    Reported-by: Borislav Petkov <bp@alien8.de>
    Signed-off-by: Manivannan Sadhasivam <manivannan.sadhasivam@linaro.org>
    Signed-off-by: Bjorn Andersson <andersson@kernel.org>
    Link: https://lore.kernel.org/r/20221129071201.30024-2-manivannan.sadhasivam@linaro.org
    Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>

commit 9062493811676ee0efe6c74d98f00ca38c4e17d4
Author: Eric Dumazet <edumazet@google.com>
Date:   Fri Dec 16 16:29:17 2022 +0000

    net: stream: purge sk_error_queue in sk_stream_kill_queues()
    
    [ Upstream commit e0c8bccd40fc1c19e1d246c39bcf79e357e1ada3 ]
    
    Changheon Lee reported TCP socket leaks, with a nice repro.
    
    It seems we leak TCP sockets with the following sequence:
    
    1) SOF_TIMESTAMPING_TX_ACK is enabled on the socket.
    
       Each ACK will cook an skb put in error queue, from __skb_tstamp_tx().
       __skb_tstamp_tx() is using skb_clone(), unless
       SOF_TIMESTAMPING_OPT_TSONLY was also requested.
    
    2) If the application is also using MSG_ZEROCOPY, then we put in the
       error queue cloned skbs that had a struct ubuf_info attached to them.
    
       Whenever an struct ubuf_info is allocated, sock_zerocopy_alloc()
       does a sock_hold().
    
       As long as the cloned skbs are still in sk_error_queue,
       socket refcount is kept elevated.
    
    3) Application closes the socket, while error queue is not empty.
    
    Since tcp_close() no longer purges the socket error queue,
    we might end up with a TCP socket with at least one skb in
    error queue keeping the socket alive forever.
    
    This bug can be (ab)used to consume all kernel memory
    and freeze the host.
    
    We need to purge the error queue, with proper synchronization
    against concurrent writers.
    
    Fixes: 24bcbe1cc69f ("net: stream: don't purge sk_error_queue in sk_stream_kill_queues()")
    Reported-by: Changheon Lee <darklight2357@icloud.com>
    Signed-off-by: Eric Dumazet <edumazet@google.com>
    Signed-off-by: David S. Miller <davem@davemloft.net>
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit 23025cbccada8908fc6cd4d09e851de66898d2d7
Merge: e8f60cd7db24 a67aad57d9ae
Author: Linus Torvalds <torvalds@linux-foundation.org>
Date:   Thu Jan 12 05:50:56 2023 -0600

    Merge tag 'scsi-fixes' of git://git.kernel.org/pub/scm/linux/kernel/git/jejb/scsi
    
    Pull SCSI fixes from James Bottomley:
     "Ten small fixes (less the one that cleaned up a reverted removal),
      nine in drivers of which the ufs one is the most critical.
    
      The single core patch is a minor speedup to error handling"
    
    * tag 'scsi-fixes' of git://git.kernel.org/pub/scm/linux/kernel/git/jejb/scsi:
      scsi: libsas: Grab the ATA port lock in sas_ata_device_link_abort()
      scsi: hisi_sas: Fix tag freeing for reserved tags
      scsi: ufs: core: WLUN suspend SSU/enter hibern8 fail recovery
      scsi: scsi_debug: Delete unreachable code in inquiry_vpd_b0()
      scsi: mpi3mr: Refer CONFIG_SCSI_MPI3MR in Makefile
      scsi: core: scsi_error: Do not queue pointless abort workqueue functions
      scsi: storvsc: Fix swiotlb bounce buffer leak in confidential VM
      scsi: iscsi: Fix multiple iSCSI session unbind events sent to userspace
      scsi: mpi3mr: Remove usage of dma_get_required_mask() API
      scsi: mpt3sas: Remove usage of dma_get_required_mask() API

commit 823fed7c400fbba5d0aaa606cf60615fb32a0c48
Author: Manivannan Sadhasivam <manivannan.sadhasivam@linaro.org>
Date:   Tue Nov 29 12:41:59 2022 +0530

    soc: qcom: Select REMAP_MMIO for LLCC driver
    
    commit 5d2fe2d7b616b8baa18348ead857b504fc2de336 upstream.
    
    LLCC driver uses REGMAP_MMIO for accessing the hardware registers. So
    select the dependency in Kconfig. Without this, there will be errors
    while building the driver with COMPILE_TEST only:
    
    ERROR: modpost: "__devm_regmap_init_mmio_clk" [drivers/soc/qcom/llcc-qcom.ko] undefined!
    make[1]: *** [scripts/Makefile.modpost:126: Module.symvers] Error 1
    make: *** [Makefile:1944: modpost] Error 2
    
    Cc: <stable@vger.kernel.org> # 4.19
    Fixes: a3134fb09e0b ("drivers: soc: Add LLCC driver")
    Reported-by: Borislav Petkov <bp@alien8.de>
    Signed-off-by: Manivannan Sadhasivam <manivannan.sadhasivam@linaro.org>
    Signed-off-by: Bjorn Andersson <andersson@kernel.org>
    Link: https://lore.kernel.org/r/20221129071201.30024-2-manivannan.sadhasivam@linaro.org
    Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>

commit 3cb0f23039e0e3395a96e0f52bd69910ced2f720
Author: Masahiro Yamada <masahiroy@kernel.org>
Date:   Fri Jan 6 17:18:21 2023 +0100

    ARM: 9284/1: include <asm/pgtable.h> from proc-macros.S to fix -Wundef warnings
    
    Since commit 80b6093b55e3 ("kbuild: add -Wundef to KBUILD_CPPFLAGS
    for W=1 builds"), building with W=1 detects -Wundef warnings for
    assembly code.
    
      $ make W=1 ARCH=arm CROSS_COMPILE=arm-linux-gnueabihf-  arch/arm/mm/
        [snip]
        AS      arch/arm/mm/cache-v7.o
      In file included from arch/arm/mm/cache-v7.S:17:
      arch/arm/mm/proc-macros.S:109:5: warning: "L_PTE_SHARED" is not defined, evaluates to 0 [-Wundef]
        109 | #if L_PTE_SHARED != PTE_EXT_SHARED
            |     ^~~~~~~~~~~~
      arch/arm/mm/proc-macros.S:109:21: warning: "PTE_EXT_SHARED" is not defined, evaluates to 0 [-Wundef]
        109 | #if L_PTE_SHARED != PTE_EXT_SHARED
            |                     ^~~~~~~~~~~~~~
      arch/arm/mm/proc-macros.S:113:10: warning: "L_PTE_XN" is not defined, evaluates to 0 [-Wundef]
        113 |         (L_PTE_XN+L_PTE_USER+L_PTE_RDONLY+L_PTE_DIRTY+L_PTE_YOUNG+\
            |          ^~~~~~~~
      arch/arm/mm/proc-macros.S:113:19: warning: "L_PTE_USER" is not defined, evaluates to 0 [-Wundef]
        113 |         (L_PTE_XN+L_PTE_USER+L_PTE_RDONLY+L_PTE_DIRTY+L_PTE_YOUNG+\
            |                   ^~~~~~~~~~
      arch/arm/mm/proc-macros.S:113:30: warning: "L_PTE_RDONLY" is not defined, evaluates to 0 [-Wundef]
        113 |         (L_PTE_XN+L_PTE_USER+L_PTE_RDONLY+L_PTE_DIRTY+L_PTE_YOUNG+\
            |                              ^~~~~~~~~~~~
      arch/arm/mm/proc-macros.S:113:43: warning: "L_PTE_DIRTY" is not defined, evaluates to 0 [-Wundef]
        113 |         (L_PTE_XN+L_PTE_USER+L_PTE_RDONLY+L_PTE_DIRTY+L_PTE_YOUNG+\
            |                                           ^~~~~~~~~~~
      arch/arm/mm/proc-macros.S:113:55: warning: "L_PTE_YOUNG" is not defined, evaluates to 0 [-Wundef]
        113 |         (L_PTE_XN+L_PTE_USER+L_PTE_RDONLY+L_PTE_DIRTY+L_PTE_YOUNG+\
            |                                                       ^~~~~~~~~~~
      arch/arm/mm/proc-macros.S:114:10: warning: "L_PTE_PRESENT" is not defined, evaluates to 0 [-Wundef]
        114 |          L_PTE_PRESENT) > L_PTE_SHARED
            |          ^~~~~~~~~~~~~
      arch/arm/mm/proc-macros.S:114:27: warning: "L_PTE_SHARED" is not defined, evaluates to 0 [-Wundef]
        114 |          L_PTE_PRESENT) > L_PTE_SHARED
            |                           ^~~~~~~~~~~~
    
    Include <asm/pgtable.h> from proc-macros.S to fix the warnings.
    
    Signed-off-by: Masahiro Yamada <masahiroy@kernel.org>
    Signed-off-by: Russell King (Oracle) <rmk+kernel@armlinux.org.uk>

commit 7124c93887cc4e6c5b48920f83115e4a5892e870
Author: Randy Dunlap <rdunlap@infradead.org>
Date:   Mon Jan 9 22:25:29 2023 -0800

    phy: ti: fix Kconfig warning and operator precedence
    
    Fix Kconfig depends operator precedence to prevent a Kconfig warning:
    
    WARNING: unmet direct dependencies detected for MUX_MMIO
      Depends on [n]: MULTIPLEXER [=m] && OF [=n]
      Selected by [m]:
      - PHY_AM654_SERDES [=m] && (OF [=n] && ARCH_K3 || COMPILE_TEST [=y]) && COMMON_CLK [=y]
    
    Fixes: 71e2f5c5c224 ("phy: ti: Add a new SERDES driver for TI's AM654x SoC")
    Fixes: 091876cc355d ("phy: ti: j721e-wiz: Add support for WIZ module present in TI J721E SoC")
    Signed-off-by: Randy Dunlap <rdunlap@infradead.org>
    Cc: Vinod Koul <vkoul@kernel.org>
    Cc: Kishon Vijay Abraham I <kishon@kernel.org>
    Cc: linux-phy@lists.infradead.org
    Cc: Arnd Bergmann <arnd@arndb.de>
    Link: https://lore.kernel.org/r/20230110062529.22668-1-rdunlap@infradead.org
    Signed-off-by: Vinod Koul <vkoul@kernel.org>

commit 8debed3efe3a731451ad9a91a7a74eeb18a7f7eb
Author: Masahiro Yamada <masahiroy@kernel.org>
Date:   Mon Jan 9 04:23:17 2023 +0900

    kbuild: export top-level LDFLAGS_vmlinux only to scripts/Makefile.vmlinux
    
    Nathan Chancellor reports that $(NM) emits an error message when
    GNU Make 4.4 is used to build the ARM zImage.
    
      $ make-4.4 ARCH=arm CROSS_COMPILE=arm-linux-gnueabi- O=build defconfig zImage
        [snip]
        LD      vmlinux
        NM      System.map
        SORTTAB vmlinux
        OBJCOPY arch/arm/boot/Image
        Kernel: arch/arm/boot/Image is ready
      arm-linux-gnueabi-nm: 'arch/arm/boot/compressed/../../../../vmlinux': No such file
      /bin/sh: 1: arithmetic expression: expecting primary: " "
        LDS     arch/arm/boot/compressed/vmlinux.lds
        AS      arch/arm/boot/compressed/head.o
        GZIP    arch/arm/boot/compressed/piggy_data
        AS      arch/arm/boot/compressed/piggy.o
        CC      arch/arm/boot/compressed/misc.o
    
    This occurs since GNU Make commit 98da874c4303 ("[SV 10593] Export
    variables to $(shell ...) commands"), and the O= option is needed to
    reproduce it. The generated zImage is correct despite the error message.
    
    As the commit description of 98da874c4303 [1] says, exported variables
    are passed down to $(shell ) functions, which means exported recursive
    variables might be expanded earlier than before, in the parse stage.
    
    The following test code demonstrates the change for GNU Make 4.4.
    
    [Test Makefile]
    
      $(shell echo hello > foo)
      export foo = $(shell cat bar/../foo)
      $(shell mkdir bar)
    
      all:
              @echo $(foo)
    
    [GNU Make 4.3]
    
      $ rm -rf bar; make-4.3
      hello
    
    [GNU Make 4.4]
    
      $ rm -rf bar; make-4.4
      cat: bar/../foo: No such file or directory
      hello
    
    The 'foo' is a resursively expanded (i.e. lazily expanded) variable.
    
    GNU Make 4.3 expands 'foo' just before running the recipe '@echo $(foo)',
    at this point, the directory 'bar' exists.
    
    GNU Make 4.4 expands 'foo' to evaluate $(shell mkdir bar) because it is
    exported. At this point, the directory 'bar' does not exit yet. The cat
    command cannot resolve the bar/../foo path, hence the error message.
    
    Let's get back to the kernel Makefile.
    
    In arch/arm/boot/compressed/Makefile, KBSS_SZ is referenced by
    LDFLAGS_vmlinux, which is recursive and also exported by the top
    Makefile.
    
    GNU Make 4.3 expands KBSS_SZ just before running the recipes, so no
    error message.
    
    GNU Make 4.4 expands KBSS_SZ in the parse stage, where the directory
    arm/arm/boot/compressed does not exit yet. When compiled with O=,
    the output directory is created by $(shell mkdir -p $(obj-dirs))
    in scripts/Makefile.build.
    
    There are two ways to fix this particular issue:
    
     - change "$(obj)/../../../../vmlinux" in KBSS_SZ to "vmlinux"
     - unexport LDFLAGS_vmlinux
    
    This commit takes the latter course because it is what I originally
    intended.
    
    Commit 3ec8a5b33dea ("kbuild: do not export LDFLAGS_vmlinux")
    unexported LDFLAGS_vmlinux.
    
    Commit 5d4aeffbf709 ("kbuild: rebuild .vmlinux.export.o when its
    prerequisite is updated") accidentally exported it again.
    
    We can clean up arch/arm/boot/compressed/Makefile later.
    
    [1]: https://git.savannah.gnu.org/cgit/make.git/commit/?id=98da874c43035a490cdca81331724f233a3d0c9a
    
    Link: https://lore.kernel.org/all/Y7i8+EjwdnhHtlrr@dev-arch.thelio-3990X/
    Fixes: 5d4aeffbf709 ("kbuild: rebuild .vmlinux.export.o when its prerequisite is updated")
    Reported-by: Nathan Chancellor <nathan@kernel.org>
    Signed-off-by: Masahiro Yamada <masahiroy@kernel.org>
    Reviewed-by: Nicolas Schier <nicolas@fjasle.eu>
    Tested-by: Nathan Chancellor <nathan@kernel.org>

commit 97bcdf24e00075cf37ee4cbd63f07f54e25c5265
Merge: 13d159553ef2 3a2390c6777e
Author: Arnd Bergmann <arnd@arndb.de>
Date:   Mon Jan 9 23:16:08 2023 +0100

    Merge tag 'reset-fixes-for-v6.2' of git://git.pengutronix.de/pza/linux into arm/fixes
    
    Reset controller fixes for v6.2
    
    Avoid a build error by disabling the invalid combination of building
    reset-ti-sci built-in but ti-sci as a module.
    Fix a possible NULL pointer dereference in reset-uniphier-glue in case
    platform_get_resource() fails.
    
    * tag 'reset-fixes-for-v6.2' of git://git.pengutronix.de/pza/linux:
      reset: uniphier-glue: Fix possible null-ptr-deref
      reset: ti-sci: honor TI_SCI_PROTOCOL setting when not COMPILE_TEST
    
    Link: https://lore.kernel.org/r/20230104095855.3809733-1-p.zabel@pengutronix.de
    Signed-off-by: Arnd Bergmann <arnd@arndb.de>

commit f993d24a948d22710148dae2c48b8a87155f6cb9
Author: Masahiro Yamada <masahiroy@kernel.org>
Date:   Sat Jan 7 01:10:23 2023 +0900

    s390: fix -Wundef warning for CONFIG_KERNEL_ZSTD
    
    Since commit 80b6093b55e3 ("kbuild: add -Wundef to KBUILD_CPPFLAGS
    for W=1 builds"), building with W=1 detects misuse of #(el)if.
    
      $ make W=1 ARCH=s390 CROSS_COMPILE=s390x-linux-gnu-
        [snip]
      arch/s390/boot/decompressor.c:28:7: warning: "CONFIG_KERNEL_ZSTD" is not defined, evaluates to 0 [-Wundef]
         28 | #elif CONFIG_KERNEL_ZSTD
            |       ^~~~~~~~~~~~~~~~~~
    
    This issue has been hidden because arch/s390/boot/Makefile overwrites
    KBUILD_CFLAGS, dropping -Wundef.
    
    CONFIG_KERNEL_ZSTD is a bool option. #elif defined() should be used.
    
    The line #ifdef CONFIG_KERNEL_BZIP2 is fine, but I changed it for
    consistency.
    
    Signed-off-by: Masahiro Yamada <masahiroy@kernel.org>
    Link: https://lore.kernel.org/r/20230106161024.2373602-1-masahiroy@kernel.org
    Signed-off-by: Heiko Carstens <hca@linux.ibm.com>

commit c8c1eec578a9ae2dc8f14a1846942a0b7bf29d1d
Author: Eric Dumazet <edumazet@google.com>
Date:   Fri Dec 16 16:29:17 2022 +0000

    net: stream: purge sk_error_queue in sk_stream_kill_queues()
    
    [ Upstream commit e0c8bccd40fc1c19e1d246c39bcf79e357e1ada3 ]
    
    Changheon Lee reported TCP socket leaks, with a nice repro.
    
    It seems we leak TCP sockets with the following sequence:
    
    1) SOF_TIMESTAMPING_TX_ACK is enabled on the socket.
    
       Each ACK will cook an skb put in error queue, from __skb_tstamp_tx().
       __skb_tstamp_tx() is using skb_clone(), unless
       SOF_TIMESTAMPING_OPT_TSONLY was also requested.
    
    2) If the application is also using MSG_ZEROCOPY, then we put in the
       error queue cloned skbs that had a struct ubuf_info attached to them.
    
       Whenever an struct ubuf_info is allocated, sock_zerocopy_alloc()
       does a sock_hold().
    
       As long as the cloned skbs are still in sk_error_queue,
       socket refcount is kept elevated.
    
    3) Application closes the socket, while error queue is not empty.
    
    Since tcp_close() no longer purges the socket error queue,
    we might end up with a TCP socket with at least one skb in
    error queue keeping the socket alive forever.
    
    This bug can be (ab)used to consume all kernel memory
    and freeze the host.
    
    We need to purge the error queue, with proper synchronization
    against concurrent writers.
    
    Fixes: 24bcbe1cc69f ("net: stream: don't purge sk_error_queue in sk_stream_kill_queues()")
    Reported-by: Changheon Lee <darklight2357@icloud.com>
    Signed-off-by: Eric Dumazet <edumazet@google.com>
    Signed-off-by: David S. Miller <davem@davemloft.net>
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit 481fdb48895f30373820ad8f3800118adf0a47c7
Author: Manivannan Sadhasivam <manivannan.sadhasivam@linaro.org>
Date:   Tue Nov 29 12:50:22 2022 +0530

    soc: qcom: Select REMAP_MMIO for ICC_BWMON driver
    
    commit a84160fbf4f2c8c5ffa588e19ea8f92eabd7ad17 upstream.
    
    ICC_BWMON driver uses REGMAP_MMIO for accessing the hardware registers.
    So select the dependency in Kconfig. Without this, there will be errors
    while building the driver with COMPILE_TEST only:
    
    ERROR: modpost: "__devm_regmap_init_mmio_clk" [drivers/soc/qcom/icc-bwmon.ko] undefined!
    make[1]: *** [scripts/Makefile.modpost:126: Module.symvers] Error 1
    make: *** [Makefile:1944: modpost] Error 2
    
    Cc: <stable@vger.kernel.org> # 6.0
    Cc: Krzysztof Kozlowski <krzysztof.kozlowski@linaro.org>
    Fixes: b9c2ae6cac40 ("soc: qcom: icc-bwmon: Add bandwidth monitoring driver")
    Signed-off-by: Manivannan Sadhasivam <manivannan.sadhasivam@linaro.org>
    Reviewed-by: Krzysztof Kozlowski <krzysztof.kozlowski@linaro.org>
    Signed-off-by: Bjorn Andersson <andersson@kernel.org>
    Link: https://lore.kernel.org/r/20221129072022.41962-1-manivannan.sadhasivam@linaro.org
    Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>

commit 25a4d44ca5c5eeaf9ec1573dda5e8613f9a6fa54
Author: Manivannan Sadhasivam <manivannan.sadhasivam@linaro.org>
Date:   Tue Nov 29 12:41:59 2022 +0530

    soc: qcom: Select REMAP_MMIO for LLCC driver
    
    commit 5d2fe2d7b616b8baa18348ead857b504fc2de336 upstream.
    
    LLCC driver uses REGMAP_MMIO for accessing the hardware registers. So
    select the dependency in Kconfig. Without this, there will be errors
    while building the driver with COMPILE_TEST only:
    
    ERROR: modpost: "__devm_regmap_init_mmio_clk" [drivers/soc/qcom/llcc-qcom.ko] undefined!
    make[1]: *** [scripts/Makefile.modpost:126: Module.symvers] Error 1
    make: *** [Makefile:1944: modpost] Error 2
    
    Cc: <stable@vger.kernel.org> # 4.19
    Fixes: a3134fb09e0b ("drivers: soc: Add LLCC driver")
    Reported-by: Borislav Petkov <bp@alien8.de>
    Signed-off-by: Manivannan Sadhasivam <manivannan.sadhasivam@linaro.org>
    Signed-off-by: Bjorn Andersson <andersson@kernel.org>
    Link: https://lore.kernel.org/r/20221129071201.30024-2-manivannan.sadhasivam@linaro.org
    Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>

commit ca6536972ea547b630688356e93e71dd8ec79116
Author: Manivannan Sadhasivam <manivannan.sadhasivam@linaro.org>
Date:   Tue Nov 29 12:50:22 2022 +0530

    soc: qcom: Select REMAP_MMIO for ICC_BWMON driver
    
    commit a84160fbf4f2c8c5ffa588e19ea8f92eabd7ad17 upstream.
    
    ICC_BWMON driver uses REGMAP_MMIO for accessing the hardware registers.
    So select the dependency in Kconfig. Without this, there will be errors
    while building the driver with COMPILE_TEST only:
    
    ERROR: modpost: "__devm_regmap_init_mmio_clk" [drivers/soc/qcom/icc-bwmon.ko] undefined!
    make[1]: *** [scripts/Makefile.modpost:126: Module.symvers] Error 1
    make: *** [Makefile:1944: modpost] Error 2
    
    Cc: <stable@vger.kernel.org> # 6.0
    Cc: Krzysztof Kozlowski <krzysztof.kozlowski@linaro.org>
    Fixes: b9c2ae6cac40 ("soc: qcom: icc-bwmon: Add bandwidth monitoring driver")
    Signed-off-by: Manivannan Sadhasivam <manivannan.sadhasivam@linaro.org>
    Reviewed-by: Krzysztof Kozlowski <krzysztof.kozlowski@linaro.org>
    Signed-off-by: Bjorn Andersson <andersson@kernel.org>
    Link: https://lore.kernel.org/r/20221129072022.41962-1-manivannan.sadhasivam@linaro.org
    Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>

commit 70e71f0dc86f455bc9ad8bd3efeff55c4b0f9931
Author: Manivannan Sadhasivam <manivannan.sadhasivam@linaro.org>
Date:   Tue Nov 29 12:41:59 2022 +0530

    soc: qcom: Select REMAP_MMIO for LLCC driver
    
    commit 5d2fe2d7b616b8baa18348ead857b504fc2de336 upstream.
    
    LLCC driver uses REGMAP_MMIO for accessing the hardware registers. So
    select the dependency in Kconfig. Without this, there will be errors
    while building the driver with COMPILE_TEST only:
    
    ERROR: modpost: "__devm_regmap_init_mmio_clk" [drivers/soc/qcom/llcc-qcom.ko] undefined!
    make[1]: *** [scripts/Makefile.modpost:126: Module.symvers] Error 1
    make: *** [Makefile:1944: modpost] Error 2
    
    Cc: <stable@vger.kernel.org> # 4.19
    Fixes: a3134fb09e0b ("drivers: soc: Add LLCC driver")
    Reported-by: Borislav Petkov <bp@alien8.de>
    Signed-off-by: Manivannan Sadhasivam <manivannan.sadhasivam@linaro.org>
    Signed-off-by: Bjorn Andersson <andersson@kernel.org>
    Link: https://lore.kernel.org/r/20221129071201.30024-2-manivannan.sadhasivam@linaro.org
    Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>

commit a494398bde273143c2352dd373cad8211f7d94b2
Author: Masahiro Yamada <masahiroy@kernel.org>
Date:   Thu Jan 5 12:13:06 2023 +0900

    s390: define RUNTIME_DISCARD_EXIT to fix link error with GNU ld < 2.36
    
    Nathan Chancellor reports that the s390 vmlinux fails to link with
    GNU ld < 2.36 since commit 99cb0d917ffa ("arch: fix broken BuildID
    for arm64 and riscv").
    
    It happens for defconfig, or more specifically for CONFIG_EXPOLINE=y.
    
      $ s390x-linux-gnu-ld --version | head -n1
      GNU ld (GNU Binutils for Debian) 2.35.2
      $ make -s ARCH=s390 CROSS_COMPILE=s390x-linux-gnu- allnoconfig
      $ ./scripts/config -e CONFIG_EXPOLINE
      $ make -s ARCH=s390 CROSS_COMPILE=s390x-linux-gnu- olddefconfig
      $ make -s ARCH=s390 CROSS_COMPILE=s390x-linux-gnu-
      `.exit.text' referenced in section `.s390_return_reg' of drivers/base/dd.o: defined in discarded section `.exit.text' of drivers/base/dd.o
      make[1]: *** [scripts/Makefile.vmlinux:34: vmlinux] Error 1
      make: *** [Makefile:1252: vmlinux] Error 2
    
    arch/s390/kernel/vmlinux.lds.S wants to keep EXIT_TEXT:
    
            .exit.text : {
                    EXIT_TEXT
            }
    
    But, at the same time, EXIT_TEXT is thrown away by DISCARD because
    s390 does not define RUNTIME_DISCARD_EXIT.
    
    I still do not understand why the latter wins after 99cb0d917ffa,
    but defining RUNTIME_DISCARD_EXIT seems correct because the comment
    line in arch/s390/kernel/vmlinux.lds.S says:
    
            /*
             * .exit.text is discarded at runtime, not link time,
             * to deal with references from __bug_table
             */
    
    Nathan also found that binutils commit 21401fc7bf67 ("Duplicate output
    sections in scripts") cured this issue, so we cannot reproduce it with
    binutils 2.36+, but it is better to not rely on it.
    
    Fixes: 99cb0d917ffa ("arch: fix broken BuildID for arm64 and riscv")
    Link: https://lore.kernel.org/all/Y7Jal56f6UBh1abE@dev-arch.thelio-3990X/
    Reported-by: Nathan Chancellor <nathan@kernel.org>
    Signed-off-by: Masahiro Yamada <masahiroy@kernel.org>
    Link: https://lore.kernel.org/r/20230105031306.1455409-1-masahiroy@kernel.org
    Signed-off-by: Heiko Carstens <hca@linux.ibm.com>

commit 13678f3feb3009b23aab424864fd0dac0765c83e
Author: Randy Dunlap <rdunlap@infradead.org>
Date:   Sat Oct 29 22:56:36 2022 -0700

    reset: ti-sci: honor TI_SCI_PROTOCOL setting when not COMPILE_TEST
    
    There is a build error when COMPILE_TEST=y, TI_SCI_PROTOCOL=m,
    and RESET_TI_SCI=y:
    
    drivers/reset/reset-ti-sci.o: in function `ti_sci_reset_probe':
    reset-ti-sci.c:(.text+0x22c): undefined reference to `devm_ti_sci_get_handle'
    
    Fix this by making RESET_TI_SCI honor the Kconfig setting of
    TI_SCI_PROTOCOL when COMPILE_TEST is not set. When COMPILE_TEST is set,
    TI_SCI_PROTOCOL must be disabled (=n).
    
    Fixes: a6af504184c9 ("reset: ti-sci: Allow building under COMPILE_TEST")
    Signed-off-by: Randy Dunlap <rdunlap@infradead.org>
    Reported-by: kernel test robot <lkp@intel.com>
    Cc: Nishanth Menon <nm@ti.com>
    Cc: Tero Kristo <kristo@kernel.org>
    Cc: Santosh Shilimkar <ssantosh@kernel.org>
    Cc: linux-arm-kernel@lists.infradead.org
    Cc: Philipp Zabel <p.zabel@pengutronix.de>
    Reviewed-by: Nishanth Menon <nm@ti.com>
    Link: https://lore.kernel.org/r/20221030055636.3139-1-rdunlap@infradead.org
    Signed-off-by: Philipp Zabel <p.zabel@pengutronix.de>

commit b458d349f8753f666233828ebd30df6f100cf7d5
Author: Eric Dumazet <edumazet@google.com>
Date:   Fri Dec 16 16:29:17 2022 +0000

    net: stream: purge sk_error_queue in sk_stream_kill_queues()
    
    [ Upstream commit e0c8bccd40fc1c19e1d246c39bcf79e357e1ada3 ]
    
    Changheon Lee reported TCP socket leaks, with a nice repro.
    
    It seems we leak TCP sockets with the following sequence:
    
    1) SOF_TIMESTAMPING_TX_ACK is enabled on the socket.
    
       Each ACK will cook an skb put in error queue, from __skb_tstamp_tx().
       __skb_tstamp_tx() is using skb_clone(), unless
       SOF_TIMESTAMPING_OPT_TSONLY was also requested.
    
    2) If the application is also using MSG_ZEROCOPY, then we put in the
       error queue cloned skbs that had a struct ubuf_info attached to them.
    
       Whenever an struct ubuf_info is allocated, sock_zerocopy_alloc()
       does a sock_hold().
    
       As long as the cloned skbs are still in sk_error_queue,
       socket refcount is kept elevated.
    
    3) Application closes the socket, while error queue is not empty.
    
    Since tcp_close() no longer purges the socket error queue,
    we might end up with a TCP socket with at least one skb in
    error queue keeping the socket alive forever.
    
    This bug can be (ab)used to consume all kernel memory
    and freeze the host.
    
    We need to purge the error queue, with proper synchronization
    against concurrent writers.
    
    Fixes: 24bcbe1cc69f ("net: stream: don't purge sk_error_queue in sk_stream_kill_queues()")
    Reported-by: Changheon Lee <darklight2357@icloud.com>
    Signed-off-by: Eric Dumazet <edumazet@google.com>
    Signed-off-by: David S. Miller <davem@davemloft.net>
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit 8c330c36b3970d0917f48827fa6c7a9c75aa4602
Author: Eric Dumazet <edumazet@google.com>
Date:   Fri Dec 16 16:29:17 2022 +0000

    net: stream: purge sk_error_queue in sk_stream_kill_queues()
    
    [ Upstream commit e0c8bccd40fc1c19e1d246c39bcf79e357e1ada3 ]
    
    Changheon Lee reported TCP socket leaks, with a nice repro.
    
    It seems we leak TCP sockets with the following sequence:
    
    1) SOF_TIMESTAMPING_TX_ACK is enabled on the socket.
    
       Each ACK will cook an skb put in error queue, from __skb_tstamp_tx().
       __skb_tstamp_tx() is using skb_clone(), unless
       SOF_TIMESTAMPING_OPT_TSONLY was also requested.
    
    2) If the application is also using MSG_ZEROCOPY, then we put in the
       error queue cloned skbs that had a struct ubuf_info attached to them.
    
       Whenever an struct ubuf_info is allocated, sock_zerocopy_alloc()
       does a sock_hold().
    
       As long as the cloned skbs are still in sk_error_queue,
       socket refcount is kept elevated.
    
    3) Application closes the socket, while error queue is not empty.
    
    Since tcp_close() no longer purges the socket error queue,
    we might end up with a TCP socket with at least one skb in
    error queue keeping the socket alive forever.
    
    This bug can be (ab)used to consume all kernel memory
    and freeze the host.
    
    We need to purge the error queue, with proper synchronization
    against concurrent writers.
    
    Fixes: 24bcbe1cc69f ("net: stream: don't purge sk_error_queue in sk_stream_kill_queues()")
    Reported-by: Changheon Lee <darklight2357@icloud.com>
    Signed-off-by: Eric Dumazet <edumazet@google.com>
    Signed-off-by: David S. Miller <davem@davemloft.net>
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit 9da204cd67c4fe97e8aa465d10d5c2e7076f7f42
Author: Eric Dumazet <edumazet@google.com>
Date:   Fri Dec 16 16:29:17 2022 +0000

    net: stream: purge sk_error_queue in sk_stream_kill_queues()
    
    [ Upstream commit e0c8bccd40fc1c19e1d246c39bcf79e357e1ada3 ]
    
    Changheon Lee reported TCP socket leaks, with a nice repro.
    
    It seems we leak TCP sockets with the following sequence:
    
    1) SOF_TIMESTAMPING_TX_ACK is enabled on the socket.
    
       Each ACK will cook an skb put in error queue, from __skb_tstamp_tx().
       __skb_tstamp_tx() is using skb_clone(), unless
       SOF_TIMESTAMPING_OPT_TSONLY was also requested.
    
    2) If the application is also using MSG_ZEROCOPY, then we put in the
       error queue cloned skbs that had a struct ubuf_info attached to them.
    
       Whenever an struct ubuf_info is allocated, sock_zerocopy_alloc()
       does a sock_hold().
    
       As long as the cloned skbs are still in sk_error_queue,
       socket refcount is kept elevated.
    
    3) Application closes the socket, while error queue is not empty.
    
    Since tcp_close() no longer purges the socket error queue,
    we might end up with a TCP socket with at least one skb in
    error queue keeping the socket alive forever.
    
    This bug can be (ab)used to consume all kernel memory
    and freeze the host.
    
    We need to purge the error queue, with proper synchronization
    against concurrent writers.
    
    Fixes: 24bcbe1cc69f ("net: stream: don't purge sk_error_queue in sk_stream_kill_queues()")
    Reported-by: Changheon Lee <darklight2357@icloud.com>
    Signed-off-by: Eric Dumazet <edumazet@google.com>
    Signed-off-by: David S. Miller <davem@davemloft.net>
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit a1c7a7cde6c92e42eb2cc8a04a9529c3fe8f19c8
Merge: 6b1c374c4560 d347a951906b
Author: Martin K. Petersen <martin.petersen@oracle.com>
Date:   Fri Dec 30 16:31:44 2022 +0000

    Merge branch '6.2/mpt-mpi' into 6.2/scsi-fixes
    
    Pull in Broadcom MPI/MPT fixes that conflicted with patch resolution
    upstream.
    
    Signed-off-by: Martin K. Petersen <martin.petersen@oracle.com>

commit 7406fd75a92066712b6f696983f89438f474049a
Merge: 7c0846125358 37fecbb80721
Author: Linus Torvalds <torvalds@linux-foundation.org>
Date:   Wed Dec 21 09:19:24 2022 -0800

    Merge tag 'mfd-next-6.2' of git://git.kernel.org/pub/scm/linux/kernel/git/lee/mfd
    
    Pull MFD updates from Lee Jones:
     "New Drivers:
       - Add support for Ampere Computing SMpro
       - Add support for TI TPS65219 PMIC
    
      New Functionality:
       - Add support for multiple devices of the same type; rk808
    
      Fix-ups:
       - Convert a bunch of I2C class drivers over to .probe_new()
       - Remove superfluous includes; mc13xxx-*, palmas, timberdale
       - Use correct includes for GPIO handling; madera-core
       - Convert to GPIOD; twl6040
       - Remove unused platform data handling; twl6040
       - Device Tree changes; many
       - Remove unused drivers; dm355evm_msp, davinci_voicecodec, htc-i2cpld
       - Add support for modules; palmas
       - Enable COMPILE_TEST support; intel_soc_pmic*
       - Trivial: spelling / whitespace fixes; mc13xxx-spi
       - Replace old PM helpers with new ones; many
       - Convert deprecated mask_invert usage to unmask_base; many
       - Use devm_*() calls; qcom_rpm
       - MAINTAINER fix-ups
       - Make use of improved / replaced APIs; palmas, fsl-imx25-tsadc,
         stm32-lptimer, qcom_rpm, rohm-*
    
      Bug Fixes:
       - Add bounds / error checking; mt6360-core
       - No sleeping inside critical sections; axp20x
       - Fix missing dependencies; ROHM_BD957XMUF
       - Repair error paths; qcom-pm8008"
    
    * tag 'mfd-next-6.2' of git://git.kernel.org/pub/scm/linux/kernel/git/lee/mfd: (161 commits)
      dt-bindings: mfd: da9062: Correct file name for watchdog
      mfd: pm8008: Fix return value check in pm8008_probe()
      mfd: rohm: Use dev_err_probe()
      mfd: Drop obsolete dependencies on COMPILE_TEST
      dt-bindings: mfd: da9062: Move IRQ to optional properties
      mfd: qcom_rpm: Use devm_of_platform_populate() to simplify code
      mfd: qcom_rpm: Fix an error handling path in qcom_rpm_probe()
      mfd: stm32-lptimer: Use devm_platform_get_and_ioremap_resource()
      mfd: rohm-bd9576: Convert to i2c's .probe_new()
      mfd: fsl-imx25-tsadc: Use devm_platform_get_and_ioremap_resource()
      dt-bindings: Fix maintainer email for a few ROHM ICs
      mfd: palmas: Use device_get_match_data() to simplify the code
      Input: Add tps65219 interrupt driven powerbutton
      mfd: tps65219: Add driver for TI TPS65219 PMIC
      mfd: bd957x: Fix Kconfig dependency on REGMAP_IRQ
      mfd: wcd934x: Convert irq chip to config regs
      mfd: tps65090: Replace irqchip mask_invert with unmask_base
      mfd: sun4i-gpadc: Replace irqchip mask_invert with unmask_base
      mfd: stpmic1: Fix swapped mask/unmask in irq chip
      mfd: sprd-sc27xx-spi: Replace irqchip mask_invert with unmask_base
      ...

commit acd04af6e4765bdc322adab3bf72e249b8b65457
Merge: 9322af3e6aea e88f319a2546
Author: Linus Torvalds <torvalds@linux-foundation.org>
Date:   Mon Dec 19 09:00:00 2022 -0600

    Merge tag 'rtc-6.2' of git://git.kernel.org/pub/scm/linux/kernel/git/abelloni/linux
    
    Pull RTC updates from Alexandre Belloni:
     "Most of the changes are a rework of the cmos driver by Rafael and
      fixes for issues found using static checkers. The removal of a driver
      leads to a reduction of the number of LOC of the subsystem.
    
      Removed driver:
       - davinci
    
      Updates:
       - convert i2c drivers to .probe_new
       - fix spelling mistakes and duplicated words in comments
       - cmos: rework wake setup and ACPI event handling
       - cros-ec: Limit RTC alarm range to fix alarmtimer
       - ds1347: fix century register handling
       - efi: wakeup support
       - isl12022: temperature sensor support
       - pcf85063: fix read_alarm and clkout
       - pcf8523: use stop bit to detect invalid time
       - pcf8563: use RTC_FEATURE_ALARM
       - snvs: be more flexible on LPSRT reads
       - many static checker fixes"
    
    * tag 'rtc-6.2' of git://git.kernel.org/pub/scm/linux/kernel/git/abelloni/linux: (48 commits)
      rtc: ds1742: use devm_platform_get_and_ioremap_resource()
      rtc: mxc_v2: Add missing clk_disable_unprepare()
      rtc: rs5c313: correct some spelling mistakes
      rtc: at91rm9200: Fix syntax errors in comments
      rtc: remove duplicated words in comments
      rtc: rv3028: Use IRQ flags obtained from device tree if available
      rtc: ds1307: use sysfs_emit() to instead of scnprintf()
      rtc: isl12026: drop obsolete dependency on COMPILE_TEST
      dt-bindings: rtc: m41t80: Convert text schema to YAML one
      rtc: pcf85063: fix pcf85063_clkout_control
      rtc: rx6110: fix warning with !OF
      rtc: rk808: reduce 'struct rk808' usage
      rtc: msc313: Fix function prototype mismatch in msc313_rtc_probe()
      dt-bindings: rtc: convert rtc-meson.txt to dt-schema
      rtc: pic32: Move devm_rtc_allocate_device earlier in pic32_rtc_probe()
      rtc: st-lpc: Add missing clk_disable_unprepare in st_rtc_probe()
      rtc: pcf85063: Fix reading alarm
      rtc: pcf8523: fix for stop bit
      rtc: efi: Add wakeup support
      rtc: pcf8563: clear RTC_FEATURE_ALARM if no irq
      ...

commit e0c8bccd40fc1c19e1d246c39bcf79e357e1ada3
Author: Eric Dumazet <edumazet@google.com>
Date:   Fri Dec 16 16:29:17 2022 +0000

    net: stream: purge sk_error_queue in sk_stream_kill_queues()
    
    Changheon Lee reported TCP socket leaks, with a nice repro.
    
    It seems we leak TCP sockets with the following sequence:
    
    1) SOF_TIMESTAMPING_TX_ACK is enabled on the socket.
    
       Each ACK will cook an skb put in error queue, from __skb_tstamp_tx().
       __skb_tstamp_tx() is using skb_clone(), unless
       SOF_TIMESTAMPING_OPT_TSONLY was also requested.
    
    2) If the application is also using MSG_ZEROCOPY, then we put in the
       error queue cloned skbs that had a struct ubuf_info attached to them.
    
       Whenever an struct ubuf_info is allocated, sock_zerocopy_alloc()
       does a sock_hold().
    
       As long as the cloned skbs are still in sk_error_queue,
       socket refcount is kept elevated.
    
    3) Application closes the socket, while error queue is not empty.
    
    Since tcp_close() no longer purges the socket error queue,
    we might end up with a TCP socket with at least one skb in
    error queue keeping the socket alive forever.
    
    This bug can be (ab)used to consume all kernel memory
    and freeze the host.
    
    We need to purge the error queue, with proper synchronization
    against concurrent writers.
    
    Fixes: 24bcbe1cc69f ("net: stream: don't purge sk_error_queue in sk_stream_kill_queues()")
    Reported-by: Changheon Lee <darklight2357@icloud.com>
    Signed-off-by: Eric Dumazet <edumazet@google.com>
    Signed-off-by: David S. Miller <davem@davemloft.net>

commit 58bcac11fd94f950abc7b8466c5ceac7be07a00e
Merge: 84e57d292203 81c25247a2a0
Author: Linus Torvalds <torvalds@linux-foundation.org>
Date:   Fri Dec 16 03:22:53 2022 -0800

    Merge tag 'usb-6.2-rc1' of git://git.kernel.org/pub/scm/linux/kernel/git/gregkh/usb
    
    Pull USB and Thunderbolt driver updates from Greg KH:
     "Here is the large set of USB and Thunderbolt driver changes for
      6.2-rc1. Overall, thanks to the removal of a driver, more lines were
      removed than added, a nice change. Highlights include:
    
       - removal of the sisusbvga driver that was not used by anyone anymore
    
       - minor thunderbolt driver changes and tweaks
    
       - chipidea driver updates
    
       - usual set of typec driver features and hardware support added
    
       - musb minor driver fixes
    
       - fotg210 driver fixes, bringing that hardware back from the "dead"
    
       - minor dwc3 driver updates
    
       - addition, and then removal, of a list.h helper function for many
         USB and other subsystem drivers, that ended up breaking the build.
         That will come back for 6.3-rc1, it missed this merge window.
    
       - usual xhci updates and enhancements
    
       - usb-serial driver updates and support for new devices
    
       - other minor USB driver updates
    
      All of these have been in linux-next for a while with no reported
      problems"
    
    * tag 'usb-6.2-rc1' of git://git.kernel.org/pub/scm/linux/kernel/git/gregkh/usb: (153 commits)
      usb: gadget: uvc: Rename bmInterfaceFlags -> bmInterlaceFlags
      usb: dwc2: power on/off phy for peripheral mode in dual-role mode
      usb: dwc2: disable lpm feature on Rockchip SoCs
      dt-bindings: usb: mtk-xhci: add support for mt7986
      usb: dwc3: core: defer probe on ulpi_read_id timeout
      usb: ulpi: defer ulpi_register on ulpi_read_id timeout
      usb: misc: onboard_usb_hub: add Genesys Logic GL850G hub support
      dt-bindings: usb: Add binding for Genesys Logic GL850G hub controller
      dt-bindings: vendor-prefixes: add Genesys Logic
      usb: fotg210-udc: fix potential memory leak in fotg210_udc_probe()
      usb: typec: tipd: Set mode of operation for USB Type-C connector
      usb: gadget: udc: drop obsolete dependencies on COMPILE_TEST
      usb: musb: remove extra check in musb_gadget_vbus_draw
      usb: gadget: uvc: Prevent buffer overflow in setup handler
      usb: dwc3: qcom: Fix memory leak in dwc3_qcom_interconnect_init
      usb: typec: wusb3801: fix fwnode refcount leak in wusb3801_probe()
      usb: storage: Add check for kcalloc
      USB: sisusbvga: use module_usb_driver()
      USB: sisusbvga: rename sisusb.c to sisusbvga.c
      USB: sisusbvga: remove console support
      ...

commit bb0a1799bbc498053011729dcac0d9430e7d750a
Author: Jean Delvare <jdelvare@suse.de>
Date:   Thu Nov 24 15:43:59 2022 +0100

    rtc: isl12026: drop obsolete dependency on COMPILE_TEST
    
    Since commit 0166dc11be91 ("of: make CONFIG_OF user selectable"), it
    is possible to test-build any driver which depends on OF on any
    architecture by explicitly selecting OF. Therefore depending on
    COMPILE_TEST as an alternative is no longer needed.
    
    It is actually better to always build such drivers with OF enabled,
    so that the test builds are closer to how each driver will actually be
    built on its intended target. Building them without OF may not test
    much as the compiler will optimize out potentially large parts of the
    code. In the worst case, this could even pop false positive warnings.
    Dropping COMPILE_TEST here improves the quality of our testing and
    avoids wasting time on non-existent issues.
    
    Signed-off-by: Jean Delvare <jdelvare@suse.de>
    Cc: Alessandro Zummo <a.zummo@towertech.it>
    Cc: Alexandre Belloni <alexandre.belloni@bootlin.com>
    Link: https://lore.kernel.org/r/20221124154359.039be06c@endymion.delvare
    Signed-off-by: Alexandre Belloni <alexandre.belloni@bootlin.com>

commit a12a383e59ce486abd719b6bda33c353a3b385e7
Author: Krzysztof Kozlowski <krzysztof.kozlowski@linaro.org>
Date:   Thu Dec 15 14:43:37 2022 +0100

    ASoC: lochnagar: Fix unused lochnagar_of_match warning
    
    lochnagar_of_match is used unconditionally, so COMPILE_TEST builds
    without OF warn:
    
      sound/soc/codecs/lochnagar-sc.c:247:34: error: lochnagar_of_match defined but not used [-Werror=unused-const-variable=]
    
    Reported-by: kernel test robot <lkp@intel.com>
    Signed-off-by: Krzysztof Kozlowski <krzysztof.kozlowski@linaro.org>
    Link: https://lore.kernel.org/r/20221215134337.77944-1-krzysztof.kozlowski@linaro.org
    Signed-off-by: Mark Brown <broonie@kernel.org>

commit f0a43ba6c66cc0688e2748d986a1459fdd3442ef
Author: Shin'ichiro Kawasaki <shinichiro.kawasaki@wdc.com>
Date:   Wed Dec 7 11:36:59 2022 +0900

    scsi: mpi3mr: Refer CONFIG_SCSI_MPI3MR in Makefile
    
    When Kconfig item CONFIG_SCSI_MPI3MR was introduced for mpi3mr driver, the
    Makefile of the driver was not modified to refer the Kconfig item.
    
    As a result, mpi3mr.ko is built regardless of the Kconfig item value y or
    m. Also, if 'make localmodconfig' can not find the Kconfig item in the
    Makefile, then it does not generate CONFIG_SCSI_MPI3MR=m even when
    mpi3mr.ko is loaded on the system.
    
    Refer to the Kconfig item to avoid the issues.
    
    Fixes: c4f7ac64616e ("scsi: mpi3mr: Add mpi30 Rev-R headers and Kconfig")
    Signed-off-by: Shin'ichiro Kawasaki <shinichiro.kawasaki@wdc.com>
    Link: https://lore.kernel.org/r/20221207023659.2411785-1-shinichiro.kawasaki@wdc.com
    Reviewed-by: Damien Le Moal <damien.lemoal@opensource.wdc.com>
    Acked-by: Sathya Prakash Veerichetty <sathya.prakash@broadcom.com>
    Signed-off-by: Martin K. Petersen <martin.petersen@oracle.com>

commit 86a0b4255e84563739d137ad374af6c7215bb3ff
Merge: 531d2644f3b1 e291c116f60f
Author: Linus Torvalds <torvalds@linux-foundation.org>
Date:   Tue Dec 13 13:20:36 2022 -0800

    Merge tag 'input-for-v6.2-rc0' of git://git.kernel.org/pub/scm/linux/kernel/git/dtor/input
    
    Pull input updates from Dmitry Torokhov:
    
     - a new driver for Cypress Generation 5 touchscreens
    
     - a new driver for Hynitron cstxxx touchscreens
    
     - a new driver for Himax hx83112b touchscreen
    
     - I2C input devices have been converted to use i2c's probe_new()
    
     - a large number of input devices are now using
       DEFINE_SIMPLE_DEV_PM_OPS and pm_sleep_ptr() and no longer use
       __maybe_unused annotations
    
     - improvements to msg2638 touchscreen driver to also support msg2138
    
     - conversion of several input deevine bindings to yaml/DT schema
    
     - changes to select touch drivers to move handling of wake irqs to the
       PM core
    
     - other assorted fixes and improvements.
    
    * tag 'input-for-v6.2-rc0' of git://git.kernel.org/pub/scm/linux/kernel/git/dtor/input: (165 commits)
      Input: elants_i2c - delay longer with reset asserted
      dt-bindings: input: Convert ti,drv260x to DT schema
      dt-bindings: input: gpio-beeper: Convert to yaml schema
      Input: pxspad - fix unused data warning when force feedback not enabled
      Input: lpc32xx - allow building with COMPILE_TEST
      Input: nomadik-ske-keypad - allow building with COMPILE_TEST
      Input: pxa27xx-keypad - allow build with COMPILE_TEST
      Input: spear-keyboard - improve build coverage using COMPILE_TEST
      Input: tegra-kbc - allow build with COMPILE_TEST
      Input: tegra-kbc - switch to DEFINE_SIMPLE_DEV_PM_OPS() and pm_sleep_ptr()
      Input: tca6416-keypad - switch to DEFINE_SIMPLE_DEV_PM_OPS() and pm_sleep_ptr()
      Input: tc3589x - switch to DEFINE_SIMPLE_DEV_PM_OPS() and pm_sleep_ptr()
      Input: st-keyscan - switch to DEFINE_SIMPLE_DEV_PM_OPS() and pm_sleep_ptr()
      Input: sh-keysc - switch to DEFINE_SIMPLE_DEV_PM_OPS() and pm_sleep_ptr()
      Input: qt1070 - switch to DEFINE_SIMPLE_DEV_PM_OPS() and pm_sleep_ptr()
      Input: pxa27x_keypad - switch to DEFINE_SIMPLE_DEV_PM_OPS() and pm_sleep_ptr()
      Input: pmic8xxx-keypad - switch to DEFINE_SIMPLE_DEV_PM_OPS() and pm_sleep_ptr()
      Input: nomadik-ske-keypad - switch to DEFINE_SIMPLE_DEV_PM_OPS() and pm_sleep_ptr()
      Input: mcs-touchkey - switch to DEFINE_SIMPLE_DEV_PM_OPS() and pm_sleep_ptr()
      Input: max7359-keypad - switch to DEFINE_SIMPLE_DEV_PM_OPS() and pm_sleep_ptr()
      ...

commit d0f3ad23cf4f4046e88eef92c608d43cad9e4f7e
Merge: c5589c436d46 3cf241c3d56f
Author: Linus Torvalds <torvalds@linux-foundation.org>
Date:   Tue Dec 13 12:54:31 2022 -0800

    Merge tag 'spi-v6.2' of git://git.kernel.org/pub/scm/linux/kernel/git/broonie/spi
    
    Pull spi updates from Mark Brown:
     "A busy enough release, but not for the core which has only seen very
      small updates. The biggest addition is the readdition of support for
      detailed configuration of the timings around chip selects. That had
      been removed for lack of use but there's been applications found for
      it on Atmel systems. Otherwise the updates are mostly feature
      additions and cleanups to existing drivers.
    
      Summary:
    
       - Provide a helper for getting device match data in a way that
         abstracts away which firmware interface is being used.
    
       - Re-add the spi_set_cs_timing() API for detailed configuration of
         the timing around chip select and support it on Atmel.
    
       - Support for MediaTek MT7986, Microchip PCI1xxxx, Nuvoton WPCM450
         FIU and Socionext F_OSPI"
    
    * tag 'spi-v6.2' of git://git.kernel.org/pub/scm/linux/kernel/git/broonie/spi: (66 commits)
      spi: dt-bindings: Convert Synquacer SPI to DT schema
      spi: spi-gpio: Don't set MOSI as an input if not 3WIRE mode
      spi: spi-mtk-nor: Add recovery mechanism for dma read timeout
      spi: spi-fsl-lpspi: add num-cs binding for lpspi
      spi: spi-fsl-lpspi: support multiple cs for lpspi
      spi: mtk-snfi: Add snfi support for MT7986 IC
      spi: spidev: mask SPI_CS_HIGH in SPI_IOC_RD_MODE
      spi: cadence-quadspi: Add minimum operable clock rate warning to baudrate divisor calculation
      spi: microchip: pci1xxxx: Add suspend and resume support for PCI1XXXX SPI driver
      spi: dt-bindings: nuvoton,wpcm450-fiu: Fix warning in example (missing reg property)
      spi: dt-bindings: nuvoton,wpcm450-fiu: Fix error in example (bogus include)
      spi: mediatek: Enable irq when pdata is ready
      spi: spi-mtk-nor: Unify write buffer on/off
      spi: intel: Add support for SFDP opcode
      spi: intel: Take possible chip address into account in intel_spi_read/write_reg()
      spi: intel: Implement adjust_op_size()
      spi: intel: Use ->replacement_op in intel_spi_hw_cycle()
      spi: cadence: Drop obsolete dependency on COMPILE_TEST
      spi: Add Nuvoton WPCM450 Flash Interface Unit (FIU) bindings
      spi: wpcm-fiu: Add direct map support
      ...

commit c5589c436d4646e0dc23f64264db8e04cf67c88f
Merge: b8cc9174ff9e 8f3cbcd6b440
Author: Linus Torvalds <torvalds@linux-foundation.org>
Date:   Tue Dec 13 12:49:59 2022 -0800

    Merge tag 'regulator-v6.2' of git://git.kernel.org/pub/scm/linux/kernel/git/broonie/regulator
    
    Pull regulator updates from Mark Brown:
     "Quite a quiet release for regulator, the diffstat is dominated by the
      I2C migration to probe_new() and the newly added MT6357 driver. We've
      just one framework addition and the rest is all new device support,
      fixes and cleanups.
    
      The framework addition is an API for requesting all regulators defined
      in DT, this isn't great practice but has reasonable applications when
      there is generic code handling devices on buses where the bus
      specification doesn't include power. The immediate application is MDIO
      but I believe there's others, it's another API that'll need an eye
      keeping on it for undesirable usage.
    
      Summary:
    
        - An API for requesting all regulators defined in DT
    
        - Conversion of lots of drivers to the I2C probe_new() API
    
        - Support for Mediatek MT6357, Qualcomm PM8550, PMR735a and Richtek
          RT6190"
    
    * tag 'regulator-v6.2' of git://git.kernel.org/pub/scm/linux/kernel/git/broonie/regulator: (56 commits)
      regulator: core: Use different devices for resource allocation and DT lookup
      dt-bindings: Add missing 'unevaluatedProperties' to regulator nodes
      regulator: qcom-labibb: Fix missing of_node_put() in qcom_labibb_regulator_probe()
      regulator: add mt6357 regulator
      regulator: dt-bindings: Add binding schema for mt6357 regulators
      regulator: core: fix resource leak in regulator_register()
      regulator: core: fix module refcount leak in set_supply()
      regulator: core: fix use_count leakage when handling boot-on
      regulator: rk808: Use dev_err_probe
      regulator: rk808: reduce 'struct rk808' usage
      regulator: Drop obsolete dependencies on COMPILE_TEST
      regulator: pv88080-regulator: Convert to i2c's .probe_new()
      regulator: pfuze100-regulator: Convert to i2c's .probe_new()
      regulator: isl6271a-regulator: Convert to i2c's .probe_new()
      regulator: fan53555: Convert to i2c's .probe_new()
      regulator: act8865-regulator: Convert to i2c's .probe_new()
      regulator: qcom-rpmh: Add support for PM8550 regulators
      regulator: dt-bindings: qcom,rpmh: Add compatible for PM8550
      regulator: tps65023-regulator: Convert to i2c's .probe_new()
      regulator: tps62360-regulator: Convert to i2c's .probe_new()
      ...

commit 1e4fa020d574768445fca2d9bbfe473ec8bbd224
Merge: a594533df0f6 a34506e08db7
Author: Linus Torvalds <torvalds@linux-foundation.org>
Date:   Tue Dec 13 12:32:07 2022 -0800

    Merge tag 'mtd/for-6.2' of git://git.kernel.org/pub/scm/linux/kernel/git/mtd/linux
    
    Pull mtd updates from Miquel Raynal:
     "MTD core changes:
       - Fix refcount error in del_mtd_device()
       - Fix possible resource leak in init_mtd()
       - Set ROOT_DEV for partitions marked as rootfs in DT
       - Describe marking rootfs partitions in the bindings
       - Fix device name leak when register device fails in add_mtd_device()
       - Try to find OF node for every MTD partition
       - simplify (a bit) code find partition-matching dynamic OF node
    
      MTD driver changes:
       - pxa2xx-flash maps: fix memory leak in probe
       - BCM parser: refer to ARCH_BCMBCA instead of ARCH_BCM4908
       - lpddr2_nvm: Fix possible null-ptr-deref
       - inftlcore: fix repeated words in comments
       - lart: remove driver
       - tplink:
          - Add TP-Link SafeLoader partitions table parser and bindings
          - Describe TP-Link SafeLoader parser
          - Describe TP-Link SafeLoader dynamic subpartitions
       - mtdoops:
          - Panic caused mtdoops to call mtdoops_erase function immediately
          - Add mtdoops_erase function and move mtdoops_inc_counter after it
          - Change printk() to counterpart pr_ functions
    
      MTD binding cleanup:
       - Fixed-partitions: Fix 'sercomm,scpart-id' schema
       - Standardize the style in the examples
       - Drop object types when referencing other files
       - Argue in favor of keeping additionalProperties set to true
       - NVMEM-cells:
          - Inherit from MTD partitions
          - Drop range property from example
       - Partitions:
          - Change qcom,smem-part partition type
          - Constrain the list of parsers
       - Physmap: Reuse the generic definitions
       - SPI-NOR: Drop common properties
       - Sunxi-nand: Add an example to validate the bindings
       - Onenand: Mention the expected node name
       - Ingenic: Mark partitions in the controller node as deprecated
       - NAND:
          - Standardize the child node name
          - Drop common properties already defined in generic files
          - nand-chip.yaml should reference mtd.yaml
       - Remove useless file about partitions
       - Clarify all partition subnodes
    
      SPI NOR core changes:
       - Add support for flash reset using the dt reset-gpios property.
       - Update hwcaps.mask to include 8D-8D-8D read and page program ops
         when xSPI profile 1.0 table is defined.
       - Bypass zero erase size in spi_nor_find_best_erase_type().
       - Fix select_uniform_erase to skip 0 erase size
       - Add generic flash driver. If a flash is not found in the flash_info
         array, fall back to the generic flash driver which is described
         solely by the flash's SFDP tables.
       - Fix the number of bytes for the dummy cycles in
         spi_nor_spimem_check_readop().
       - Introduce SPI_NOR_QUAD_PP flag, as PP_1_1_4 is not SFDP
         discoverable.
    
      SPI NOR manufacturer drivers changes:
       - Spansion:
          - use PARSE_SFDP for s28hs512t,
          - add support for s28hl512t, s28hl01gt, and s28hs01gt.
       - Gigadevice: Replace default_init() with post_bfpt() for gd25q256.
       - Micron - ST: Enable locking for mt25qu256a.
       - Winbond: Add support for W25Q512NW-IQ.
       - ISSI: Use PARSE_SFDP and SPI_NOR_QUAD_PP.
    
      Raw NAND core changes:
       - Drop obsolete dependencies on COMPILE_TEST
       - MAINTAINERS: rectify entry for MESON NAND controller bindings
       - Drop EXPORT_SYMBOL_GPL for nanddev_erase()
    
      Raw NAND driver changes:
       - marvell: Enable NFC/DEVBUS arbiter
       - gpmi: Use pm_runtime_resume_and_get instead of pm_runtime_get_sync
       - mpc5121: Replace NO_IRQ by 0
       - lpc32xx_{slc,mlc}:
          - Switch to using pm_ptr()
          - Switch to using gpiod API
       - lpc32xx_mlc: Switch to using pm_ptr()
       - cadence: Support 64-bit slave dma interface
       - rockchip: Describe rk3128-nfc in the bindings
       - brcmnand: Update interrupts description in the bindings
    
      SPI-NAND driver changes:
       - winbond:
          - Add Winbond W25N02KV flash support
          - Fix flash identification"
    
    * tag 'mtd/for-6.2' of git://git.kernel.org/pub/scm/linux/kernel/git/mtd/linux: (76 commits)
      mtd: rawnand: Drop obsolete dependencies on COMPILE_TEST
      mtd: maps: pxa2xx-flash: fix memory leak in probe
      mtd: core: Fix refcount error in del_mtd_device()
      mtd: spi-nor: add SFDP fixups for Quad Page Program
      mtd: spi-nor: issi: is25wp256: Init flash based on SFDP
      mtd: spi-nor: winbond: add support for W25Q512NW-IQ
      mtd: spi-nor: micron-st: Enable locking for mt25qu256a
      mtd: spi-nor: Fix the number of bytes for the dummy cycles
      mtd: spi-nor: gigadevice: gd25q256: replace gd25q256_default_init with gd25q256_post_bfpt
      mtd: spi-nor: Fix formatting in spi_nor_read_raw() kerneldoc comment
      mtd: spi-nor: sysfs: print JEDEC ID for generic flash driver
      mtd: spi-nor: add generic flash driver
      mtd: spi-nor: fix select_uniform_erase to skip 0 erase size
      mtd: spi-nor: move function declaration out of sfdp.h
      mtd: spi-nor: remember full JEDEC flash ID
      mtd: spi-nor: sysfs: hide manufacturer if it is not set
      mtd: spi-nor: hide jedec_id sysfs attribute if not present
      mtd: spi-nor: Check for zero erase size in spi_nor_find_best_erase_type()
      mtd: rawnand: marvell: Enable NFC/DEVBUS arbiter
      mtd: parsers: refer to ARCH_BCMBCA instead of ARCH_BCM4908
      ...

commit b2b509fb5a1e6af1e630a755b32c4658099df70b
Merge: 21af0d557ea9 47bf2b2393ea
Author: David S. Miller <davem@davemloft.net>
Date:   Mon Dec 12 12:11:37 2022 +0000

    Merge tag 'linux-can-next-for-6.2-20221212' of git://git.kernel.org/pub/scm/linux/kernel/git/mkl/linux-can-next
    
    Marc Kleine-Budde says:
    
    ====================
    linux-can-next-for-6.2-20221212
    
    this is a pull request of 39 patches for net-next/master.
    
    The first 2 patches are by me fix a warning and coding style in the
    kvaser_usb driver.
    
    Vivek Yadav's patch sorts the includes of the m_can driver.
    
    Biju Das contributes 5 patches for the rcar_canfd driver improve the
    support for different IP core variants.
    
    Jean Delvare's patch for the ctucanfd drops the dependency on
    COMPILE_TEST.
    
    Vincent Mailhol's patch sorts the includes of the etas_es58x driver.
    
    Haibo Chen's contributes 2 patches that add i.MX93 support to the
    flexcan driver.
    
    Lad Prabhakar's patch updates the dt-bindings documentation of the
    rcar_canfd driver.
    
    Minghao Chi's patch converts the c_can platform driver to
    devm_platform_get_and_ioremap_resource().
    
    In the next 7 patches Vincent Mailhol adds devlink support to the
    etas_es58x driver to report firmware, bootloader and hardware version.
    
    Xu Panda's patch converts a strncpy() -> strscpy() in the ucan driver.
    
    Ye Bin's patch removes a useless parameter from the AF_CAN protocol.
    
    The next 2 patches by Vincent Mailhol and remove unneeded or unused
    pointers to struct usb_interface in device's priv struct in the ucan
    and gs_usb driver.
    
    Vivek Yadav's patch cleans up the usage of the RAM initialization in
    the m_can driver.
    
    A patch by me add support for SO_MARK to the AF_CAN protocol.
    
    Geert Uytterhoeven's patch fixes the number of CAN channels in the
    rcan_canfd bindings documentation.
    
    In the last 11 patches Markus Schneider-Pargmann optimizes the
    register access in the t_can driver and cleans up the tcan glue
    driver.
    ====================
    
    Signed-off-by: David S. Miller <davem@davemloft.net>

commit 005c54278b3dd38f6045a2450a8c988cc7d3def2
Author: Jean Delvare <jdelvare@suse.de>
Date:   Thu Nov 24 14:16:04 2022 +0100

    can: ctucanfd: Drop obsolete dependency on COMPILE_TEST
    
    Since commit 0166dc11be91 ("of: make CONFIG_OF user selectable"), it
    is possible to test-build any driver which depends on OF on any
    architecture by explicitly selecting OF. Therefore depending on
    COMPILE_TEST as an alternative is no longer needed.
    
    It is actually better to always build such drivers with OF enabled,
    so that the test builds are closer to how each driver will actually be
    built on its intended target. Building them without OF may not test
    much as the compiler will optimize out potentially large parts of the
    code. In the worst case, this could even pop false positive warnings.
    Dropping COMPILE_TEST here improves the quality of our testing and
    avoids wasting time on non-existent issues.
    
    Signed-off-by: Jean Delvare <jdelvare@suse.de>
    Cc: Pavel Pisa <pisa@cmp.felk.cvut.cz>
    Cc: Ondrej Ille <ondrej.ille@gmail.com>
    Acked-by: Pavel Pisa <pisa@cmp.felk.cvut.cz>
    Link: https://lore.kernel.org/all/20221124141604.4265225f@endymion.delvare
    Signed-off-by: Marc Kleine-Budde <mkl@pengutronix.de>

commit b534dc46c8ae0165b1b2509be24dbea4fa9c4011
Author: Willem de Bruijn <willemb@google.com>
Date:   Wed Dec 7 09:37:01 2022 -0500

    net_tstamp: add SOF_TIMESTAMPING_OPT_ID_TCP
    
    Add an option to initialize SOF_TIMESTAMPING_OPT_ID for TCP from
    write_seq sockets instead of snd_una.
    
    This should have been the behavior from the start. Because processes
    may now exist that rely on the established behavior, do not change
    behavior of the existing option, but add the right behavior with a new
    flag. It is encouraged to always set SOF_TIMESTAMPING_OPT_ID_TCP on
    stream sockets along with the existing SOF_TIMESTAMPING_OPT_ID.
    
    Intuitively the contract is that the counter is zero after the
    setsockopt, so that the next write N results in a notification for
    the last byte N - 1.
    
    On idle sockets snd_una == write_seq and this holds for both. But on
    sockets with data in transmission, snd_una records the unacked offset
    in the stream. This depends on the ACK response from the peer. A
    process cannot learn this in a race free manner (ioctl SIOCOUTQ is one
    racy approach).
    
    write_seq records the offset at the last byte written by the process.
    This is a better starting point. It matches the intuitive contract in
    all circumstances, unaffected by external behavior.
    
    The new timestamp flag necessitates increasing sk_tsflags to 32 bits.
    Move the field in struct sock to avoid growing the socket (for some
    common CONFIG variants). The UAPI interface so_timestamping.flags is
    already int, so 32 bits wide.
    
    Reported-by: Sotirios Delimanolis <sotodel@meta.com>
    Signed-off-by: Willem de Bruijn <willemb@google.com>
    Link: https://lore.kernel.org/r/20221207143701.29861-1-willemdebruijn.kernel@gmail.com
    Signed-off-by: Jakub Kicinski <kuba@kernel.org>

commit 6f1f0ad910f73f5533b65e1748448d334e0ec697
Author: Jean Delvare <jdelvare@suse.de>
Date:   Fri Nov 25 17:04:44 2022 +0100

    usb: gadget: udc: drop obsolete dependencies on COMPILE_TEST
    
    Since commit 0166dc11be91 ("of: make CONFIG_OF user selectable"), it
    is possible to test-build any driver which depends on OF on any
    architecture by explicitly selecting OF. Therefore depending on
    COMPILE_TEST as an alternative is no longer needed.
    
    It is actually better to always build such drivers with OF enabled,
    so that the test builds are closer to how each driver will actually be
    built on its intended target. Building them without OF may not test
    much as the compiler will optimize out potentially large parts of the
    code. In the worst case, this could even pop false positive warnings.
    Dropping COMPILE_TEST here improves the quality of our testing and
    avoids wasting time on non-existent issues.
    
    Cc: Greg Kroah-Hartman <gregkh@linuxfoundation.org>
    Cc: Nicolas Ferre <nicolas.ferre@microchip.com>
    Cc: Alexandre Belloni <alexandre.belloni@bootlin.com>
    Cc: Claudiu Beznea <claudiu.beznea@microchip.com>
    Cc: Michal Simek <michal.simek@xilinx.com>
    Acked-by: Nicolas Ferre <nicolas.ferre@microchip.com>
    Signed-off-by: Jean Delvare <jdelvare@suse.de>
    Link: https://lore.kernel.org/r/20221125170444.36620123@endymion.delvare
    Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>

commit 96836a35ffb3bcdf412d5753363daf5ee3e68548
Author: Jean Delvare <jdelvare@suse.de>
Date:   Tue Nov 22 15:41:34 2022 +0100

    mfd: Drop obsolete dependencies on COMPILE_TEST
    
    Since commit 0166dc11be91 ("of: make CONFIG_OF user selectable"), it
    is possible to test-build any driver which depends on OF on any
    architecture by explicitly selecting OF. Therefore depending on
    COMPILE_TEST as an alternative is no longer needed.
    
    It is actually better to always build such drivers with OF enabled,
    so that the test builds are closer to how each driver will actually be
    built on its intended target. Building them without OF may not test
    much as the compiler will optimize out potentially large parts of the
    code. In the worst case, this could even pop false positive warnings.
    Dropping COMPILE_TEST here improves the quality of our testing and
    avoids wasting time on non-existent issues.
    
    As a minor optimization, this also lets us drop of_match_ptr(), as we
    now know what it will resolve to, we might as well save cpp some work.
    
    Signed-off-by: Jean Delvare <jdelvare@suse.de>
    Cc: Lee Jones <lee@kernel.org>
    Cc: Bartosz Golaszewski <brgl@bgdev.pl>
    Cc: Chanwoo Choi <cw00.choi@samsung.com>
    Cc: Krzysztof Kozlowski <krzysztof.kozlowski@linaro.org>
    Cc: Bartlomiej Zolnierkiewicz <b.zolnierkie@samsung.com>
    Cc: Luca Ceresoli <luca.ceresoli@bootlin.com>
    Cc: "Jonathan Neuschfer" <j.neuschaefer@gmx.net>
    Signed-off-by: Lee Jones <lee@kernel.org>
    Link: https://lore.kernel.org/r/20221122154134.58a7a18b@endymion.delvare

commit 327d1f01a21eaad6184d3d4c192bb7954a6c810e
Author: Lee Jones <lee@kernel.org>
Date:   Fri Nov 25 12:07:49 2022 +0000

    drm/amdgpu: temporarily disable broken Clang builds due to blown stack-frame
    
    commit 6f6cb1714365a07dbc66851879538df9f6969288 upstream.
    
    Patch series "Fix a bunch of allmodconfig errors", v2.
    
    Since b339ec9c229aa ("kbuild: Only default to -Werror if COMPILE_TEST")
    WERROR now defaults to COMPILE_TEST meaning that it's enabled for
    allmodconfig builds.  This leads to some interesting build failures when
    using Clang, each resolved in this set.
    
    With this set applied, I am able to obtain a successful allmodconfig Arm
    build.
    
    
    This patch (of 2):
    
    calculate_bandwidth() is presently broken on all !(X86_64 || SPARC64 ||
    ARM64) architectures built with Clang (all released versions), whereby the
    stack frame gets blown up to well over 5k.  This would cause an immediate
    kernel panic on most architectures.  We'll revert this when the following
    bug report has been resolved:
    https://github.com/llvm/llvm-project/issues/41896.
    
    Link: https://lkml.kernel.org/r/20221125120750.3537134-1-lee@kernel.org
    Link: https://lkml.kernel.org/r/20221125120750.3537134-2-lee@kernel.org
    Signed-off-by: Lee Jones <lee@kernel.org>
    Suggested-by: Arnd Bergmann <arnd@arndb.de>
    Acked-by: Arnd Bergmann <arnd@arndb.de>
    Cc: Alex Deucher <alexander.deucher@amd.com>
    Cc: "Christian Knig" <christian.koenig@amd.com>
    Cc: Daniel Vetter <daniel@ffwll.ch>
    Cc: David Airlie <airlied@gmail.com>
    Cc: Harry Wentland <harry.wentland@amd.com>
    Cc: Lee Jones <lee@kernel.org>
    Cc: Leo Li <sunpeng.li@amd.com>
    Cc: Maarten Lankhorst <maarten.lankhorst@linux.intel.com>
    Cc: Maxime Ripard <mripard@kernel.org>
    Cc: Nathan Chancellor <nathan@kernel.org>
    Cc: Nick Desaulniers <ndesaulniers@google.com>
    Cc: "Pan, Xinhui" <Xinhui.Pan@amd.com>
    Cc: Rodrigo Siqueira <Rodrigo.Siqueira@amd.com>
    Cc: Thomas Zimmermann <tzimmermann@suse.de>
    Cc: Tom Rix <trix@redhat.com>
    Cc: <stable@vger.kernel.org>
    Signed-off-by: Andrew Morton <akpm@linux-foundation.org>
    Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>

commit ac2d7fa9084892c2c1232016ecdeadf4b354212f
Author: Lee Jones <lee@kernel.org>
Date:   Fri Nov 25 12:07:49 2022 +0000

    drm/amdgpu: temporarily disable broken Clang builds due to blown stack-frame
    
    commit 6f6cb1714365a07dbc66851879538df9f6969288 upstream.
    
    Patch series "Fix a bunch of allmodconfig errors", v2.
    
    Since b339ec9c229aa ("kbuild: Only default to -Werror if COMPILE_TEST")
    WERROR now defaults to COMPILE_TEST meaning that it's enabled for
    allmodconfig builds.  This leads to some interesting build failures when
    using Clang, each resolved in this set.
    
    With this set applied, I am able to obtain a successful allmodconfig Arm
    build.
    
    
    This patch (of 2):
    
    calculate_bandwidth() is presently broken on all !(X86_64 || SPARC64 ||
    ARM64) architectures built with Clang (all released versions), whereby the
    stack frame gets blown up to well over 5k.  This would cause an immediate
    kernel panic on most architectures.  We'll revert this when the following
    bug report has been resolved:
    https://github.com/llvm/llvm-project/issues/41896.
    
    Link: https://lkml.kernel.org/r/20221125120750.3537134-1-lee@kernel.org
    Link: https://lkml.kernel.org/r/20221125120750.3537134-2-lee@kernel.org
    Signed-off-by: Lee Jones <lee@kernel.org>
    Suggested-by: Arnd Bergmann <arnd@arndb.de>
    Acked-by: Arnd Bergmann <arnd@arndb.de>
    Cc: Alex Deucher <alexander.deucher@amd.com>
    Cc: "Christian Knig" <christian.koenig@amd.com>
    Cc: Daniel Vetter <daniel@ffwll.ch>
    Cc: David Airlie <airlied@gmail.com>
    Cc: Harry Wentland <harry.wentland@amd.com>
    Cc: Lee Jones <lee@kernel.org>
    Cc: Leo Li <sunpeng.li@amd.com>
    Cc: Maarten Lankhorst <maarten.lankhorst@linux.intel.com>
    Cc: Maxime Ripard <mripard@kernel.org>
    Cc: Nathan Chancellor <nathan@kernel.org>
    Cc: Nick Desaulniers <ndesaulniers@google.com>
    Cc: "Pan, Xinhui" <Xinhui.Pan@amd.com>
    Cc: Rodrigo Siqueira <Rodrigo.Siqueira@amd.com>
    Cc: Thomas Zimmermann <tzimmermann@suse.de>
    Cc: Tom Rix <trix@redhat.com>
    Cc: <stable@vger.kernel.org>
    Signed-off-by: Andrew Morton <akpm@linux-foundation.org>
    Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>

commit 8649c023c427c1c934043e3083e575a7e69d53bb
Author: Lee Jones <lee@kernel.org>
Date:   Fri Nov 25 12:07:49 2022 +0000

    drm/amdgpu: temporarily disable broken Clang builds due to blown stack-frame
    
    commit 6f6cb1714365a07dbc66851879538df9f6969288 upstream.
    
    Patch series "Fix a bunch of allmodconfig errors", v2.
    
    Since b339ec9c229aa ("kbuild: Only default to -Werror if COMPILE_TEST")
    WERROR now defaults to COMPILE_TEST meaning that it's enabled for
    allmodconfig builds.  This leads to some interesting build failures when
    using Clang, each resolved in this set.
    
    With this set applied, I am able to obtain a successful allmodconfig Arm
    build.
    
    
    This patch (of 2):
    
    calculate_bandwidth() is presently broken on all !(X86_64 || SPARC64 ||
    ARM64) architectures built with Clang (all released versions), whereby the
    stack frame gets blown up to well over 5k.  This would cause an immediate
    kernel panic on most architectures.  We'll revert this when the following
    bug report has been resolved:
    https://github.com/llvm/llvm-project/issues/41896.
    
    Link: https://lkml.kernel.org/r/20221125120750.3537134-1-lee@kernel.org
    Link: https://lkml.kernel.org/r/20221125120750.3537134-2-lee@kernel.org
    Signed-off-by: Lee Jones <lee@kernel.org>
    Suggested-by: Arnd Bergmann <arnd@arndb.de>
    Acked-by: Arnd Bergmann <arnd@arndb.de>
    Cc: Alex Deucher <alexander.deucher@amd.com>
    Cc: "Christian Knig" <christian.koenig@amd.com>
    Cc: Daniel Vetter <daniel@ffwll.ch>
    Cc: David Airlie <airlied@gmail.com>
    Cc: Harry Wentland <harry.wentland@amd.com>
    Cc: Lee Jones <lee@kernel.org>
    Cc: Leo Li <sunpeng.li@amd.com>
    Cc: Maarten Lankhorst <maarten.lankhorst@linux.intel.com>
    Cc: Maxime Ripard <mripard@kernel.org>
    Cc: Nathan Chancellor <nathan@kernel.org>
    Cc: Nick Desaulniers <ndesaulniers@google.com>
    Cc: "Pan, Xinhui" <Xinhui.Pan@amd.com>
    Cc: Rodrigo Siqueira <Rodrigo.Siqueira@amd.com>
    Cc: Thomas Zimmermann <tzimmermann@suse.de>
    Cc: Tom Rix <trix@redhat.com>
    Cc: <stable@vger.kernel.org>
    Signed-off-by: Andrew Morton <akpm@linux-foundation.org>
    Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>

commit 1c89ef672a161bfdb5c72f35b80940ea56c9f935
Author: Jonathan Cameron <Jonathan.Cameron@huawei.com>
Date:   Sun Dec 4 18:08:40 2022 +0000

    Input: lpc32xx - allow building with COMPILE_TEST
    
    Used to test the PM changes.
    
    Signed-off-by: Jonathan Cameron <Jonathan.Cameron@huawei.com>
    Link: https://lore.kernel.org/r/20221204180841.2211588-32-jic23@kernel.org
    Signed-off-by: Dmitry Torokhov <dmitry.torokhov@gmail.com>

commit 78c2b18b1e85b6e3ddff9d3cff3597f0d5e7b82d
Author: Jonathan Cameron <Jonathan.Cameron@huawei.com>
Date:   Sun Dec 4 18:08:39 2022 +0000

    Input: nomadik-ske-keypad - allow building with COMPILE_TEST
    
    Used to build test the PM changes.
    
    Signed-off-by: Jonathan Cameron <Jonathan.Cameron@huawei.com>
    Link: https://lore.kernel.org/r/20221204180841.2211588-31-jic23@kernel.org
    Signed-off-by: Dmitry Torokhov <dmitry.torokhov@gmail.com>

commit ececc2024e10c07605888517515c19990925161a
Author: Jonathan Cameron <Jonathan.Cameron@huawei.com>
Date:   Sun Dec 4 18:08:38 2022 +0000

    Input: pxa27xx-keypad - allow build with COMPILE_TEST
    
    Used to build test PM changes.
    
    Signed-off-by: Jonathan Cameron <Jonathan.Cameron@huawei.com>
    Link: https://lore.kernel.org/r/20221204180841.2211588-30-jic23@kernel.org
    Signed-off-by: Dmitry Torokhov <dmitry.torokhov@gmail.com>

commit 0b07641ec0f94e166b9dd5b175d65769f025d6e3
Author: Jonathan Cameron <Jonathan.Cameron@huawei.com>
Date:   Sun Dec 4 18:08:37 2022 +0000

    Input: spear-keyboard - improve build coverage using COMPILE_TEST
    
    Used to test the PM changes.
    
    Signed-off-by: Jonathan Cameron <Jonathan.Cameron@huawei.com>
    Link: https://lore.kernel.org/r/20221204180841.2211588-29-jic23@kernel.org
    Signed-off-by: Dmitry Torokhov <dmitry.torokhov@gmail.com>

commit d65adc2b16f89e244b746eb149af17f93b75bbdc
Author: Jonathan Cameron <Jonathan.Cameron@huawei.com>
Date:   Sun Dec 4 18:08:36 2022 +0000

    Input: tegra-kbc - allow build with COMPILE_TEST
    
    Used to build test PM changes.
    
    Signed-off-by: Jonathan Cameron <Jonathan.Cameron@huawei.com>
    Link: https://lore.kernel.org/r/20221204180841.2211588-28-jic23@kernel.org
    Signed-off-by: Dmitry Torokhov <dmitry.torokhov@gmail.com>

commit 6132a490f9c81d621fdb4e8c12f617dc062130a2
Merge: e6d22108621c 6ed54e1789a2
Author: Thomas Gleixner <tglx@linutronix.de>
Date:   Wed Dec 7 17:50:44 2022 +0100

    Merge tag 'irqchip-6.2' of git://git.kernel.org/pub/scm/linux/kernel/git/maz/arm-platforms into irq/core
    
    Pull irqchip updates frim Marc Zyngier:
    
     - More APCI fixes and improvements for the LoongArch architecture,
       adding support for the HTVEC irqchip, suspend-resume, and some
       PCI INTx workarounds
    
     - Initial DT support for LoongArch. I'm not even kidding.
    
     - Support for the MTK CIRQv2, a minor deviation from the original version
    
     - Error handling fixes for wpcm450, GIC...
    
     - BE detection for a FSL controller
    
     - Declare the Sifive PLIC as wake-up agnostic
    
     - Simplify fishing out the device data for the ST irqchip
    
     - Mark some data structures as __initconst in the apple-aic driver
    
     - Switch over from strtobool to kstrtobool
    
     - COMPILE_TEST fixes

commit b5a8668dab74ee37886aec5a1748f681a2d6cc6c
Author: Randy Dunlap <rdunlap@infradead.org>
Date:   Mon Oct 31 22:54:33 2022 -0700

    mfd: intel_soc_pmic: Allow COMPILE_TEST or I2C_DESIGNWARE_PLATFORM
    
    Linus expressed a desire to have intel_soc_pmic_crc.o (INTEL_SOC_PMIC,
    for Crystal Cove) be built on an "allmodconfig" build, when
    I2C_DESIGNWARE_PLATFORM=m, to enhance build test coverage.
    
    The PMIC driver won't work in this case since it requires
    I2C_DESIGNWARE_PLATFORM=y to operate properly, but adding
    "|| COMPILE_TEST" does improve the build test coverage.
    
    Link: https://lore.kernel.org/all/CAHk-=wg=hh8xkPjiySnjAyR66AG64eyZ1Y9gHw+MCs8uuSZReA@mail.gmail.com/
    
    Suggested-by: Linus Torvalds <torvalds@linux-foundation.org>
    Signed-off-by: Randy Dunlap <rdunlap@infradead.org>
    Reviewed-by: Hans de Goede <hdegoede@redhat.com>
    Signed-off-by: Lee Jones <lee@kernel.org>
    Link: https://lore.kernel.org/r/20221101055433.16891-1-rdunlap@infradead.org

commit a234442c0b51163841762748e7e22c3718337923
Author: Brian Norris <briannorris@chromium.org>
Date:   Mon Dec 5 16:04:06 2022 -0800

    mmc: sdhci-brcmstb: Resolve "unused" warnings with CONFIG_OF=n
    
    With W=1, we can see this gcc warning:
    
    drivers/mmc/host/sdhci-brcmstb.c:182:34: warning: sdhci_brcm_of_match defined but not used [-Wunused-const-variable=]
      182 | static const struct of_device_id sdhci_brcm_of_match[] = {
          |                                  ^~~~~~~~~~~~~~~~~~~
    
    Rather than play around more with #ifdef's, the simplest solution is to
    just mark this __maybe_unused.
    
    Fixes: 50bfe185c42a ("mmc: sdhci-brcmstb: Allow building with COMPILE_TEST")
    Reported-by: kernel test robot <lkp@intel.com>
    Link: https://lore.kernel.org/all/202212060700.NjMecjxS-lkp@intel.com/
    Signed-off-by: Brian Norris <briannorris@chromium.org>
    Acked-by: Florian Fainelli <f.fainelli@gmail.com>
    Link: https://lore.kernel.org/r/20221205160353.1.I5fa28f1045f17fb9285d507accf139f8b2a8f4b5@changeid
    Signed-off-by: Ulf Hansson <ulf.hansson@linaro.org>

commit 50bfe185c42a2199b65fc759cb1b2e6a0a915427
Author: Brian Norris <briannorris@chromium.org>
Date:   Mon Oct 24 11:17:59 2022 -0700

    mmc: sdhci-brcmstb: Allow building with COMPILE_TEST
    
    This driver is pretty simple, and it can be useful to build it (for
    validation purposes) without BMIPS or ARCH_BRCMSTB.
    
    It technically depends on CONFIG_OF to do anything useful at runtime,
    but it still works out OK for compile-testing using the !OF stubs.
    
    Signed-off-by: Brian Norris <briannorris@chromium.org>
    Acked-by: Florian Fainelli <f.fainelli@gmail.com>
    Acked-by: Adrian Hunter <adrian.hunter@intel.com>
    Link: https://lore.kernel.org/r/20221024181759.2355583-1-briannorris@chromium.org
    Signed-off-by: Ulf Hansson <ulf.hansson@linaro.org>

commit a84160fbf4f2c8c5ffa588e19ea8f92eabd7ad17
Author: Manivannan Sadhasivam <manivannan.sadhasivam@linaro.org>
Date:   Tue Nov 29 12:50:22 2022 +0530

    soc: qcom: Select REMAP_MMIO for ICC_BWMON driver
    
    ICC_BWMON driver uses REGMAP_MMIO for accessing the hardware registers.
    So select the dependency in Kconfig. Without this, there will be errors
    while building the driver with COMPILE_TEST only:
    
    ERROR: modpost: "__devm_regmap_init_mmio_clk" [drivers/soc/qcom/icc-bwmon.ko] undefined!
    make[1]: *** [scripts/Makefile.modpost:126: Module.symvers] Error 1
    make: *** [Makefile:1944: modpost] Error 2
    
    Cc: <stable@vger.kernel.org> # 6.0
    Cc: Krzysztof Kozlowski <krzysztof.kozlowski@linaro.org>
    Fixes: b9c2ae6cac40 ("soc: qcom: icc-bwmon: Add bandwidth monitoring driver")
    Signed-off-by: Manivannan Sadhasivam <manivannan.sadhasivam@linaro.org>
    Reviewed-by: Krzysztof Kozlowski <krzysztof.kozlowski@linaro.org>
    Signed-off-by: Bjorn Andersson <andersson@kernel.org>
    Link: https://lore.kernel.org/r/20221129072022.41962-1-manivannan.sadhasivam@linaro.org

commit 5d2fe2d7b616b8baa18348ead857b504fc2de336
Author: Manivannan Sadhasivam <manivannan.sadhasivam@linaro.org>
Date:   Tue Nov 29 12:41:59 2022 +0530

    soc: qcom: Select REMAP_MMIO for LLCC driver
    
    LLCC driver uses REGMAP_MMIO for accessing the hardware registers. So
    select the dependency in Kconfig. Without this, there will be errors
    while building the driver with COMPILE_TEST only:
    
    ERROR: modpost: "__devm_regmap_init_mmio_clk" [drivers/soc/qcom/llcc-qcom.ko] undefined!
    make[1]: *** [scripts/Makefile.modpost:126: Module.symvers] Error 1
    make: *** [Makefile:1944: modpost] Error 2
    
    Cc: <stable@vger.kernel.org> # 4.19
    Fixes: a3134fb09e0b ("drivers: soc: Add LLCC driver")
    Reported-by: Borislav Petkov <bp@alien8.de>
    Signed-off-by: Manivannan Sadhasivam <manivannan.sadhasivam@linaro.org>
    Signed-off-by: Bjorn Andersson <andersson@kernel.org>
    Link: https://lore.kernel.org/r/20221129071201.30024-2-manivannan.sadhasivam@linaro.org

commit 1d46f1ae82494fae60802c1ed09ca5009e1b414c
Merge: 2399401feee2 6408cc05a50a
Author: Miquel Raynal <miquel.raynal@bootlin.com>
Date:   Mon Dec 5 15:37:27 2022 +0100

    Merge tag 'nand/for-6.2' into mtd/next
    
    Raw NAND core changes:
    * Drop obsolete dependencies on COMPILE_TEST
    * MAINTAINERS: rectify entry for MESON NAND controller bindings
    * Drop EXPORT_SYMBOL_GPL for nanddev_erase()
    
    Raw NAND driver changes:
    * marvell: Enable NFC/DEVBUS arbiter
    * gpmi: Use pm_runtime_resume_and_get instead of pm_runtime_get_sync
    * mpc5121: Replace NO_IRQ by 0
    * lpc32xx_{slc,mlc}:
      - Switch to using pm_ptr()
      - Switch to using gpiod API
    * lpc32xx_mlc: Switch to using pm_ptr()
    * cadence: Support 64-bit slave dma interface
    * rockchip: Describe rk3128-nfc in the bindings
    * brcmnand: Update interrupts description in the bindings
    
    SPI-NAND driver changes:
    * winbond:
      - Add Winbond W25N02KV flash support
      - Fix flash identification
    
    Fix merge conflict with mtd tree regarding the brcm bindings.
    
    Signed-off-by: Miquel Raynal <miquel.raynal@bootlin.com>

commit 6ed54e1789a29d3f1557454cc7d2eb9c10d1d37b
Merge: 4363c8525e07 3ae977d0e4e3
Author: Marc Zyngier <maz@kernel.org>
Date:   Mon Dec 5 10:45:41 2022 +0000

    Merge branch irq/misc-6.2 into irq/irqchip-next
    
    * irq/misc-6.2:
      : .
      : Random minor fixes and improvments:
      :
      : - More Loongson fixes after the Loongarch merge
      :
      : - Error handling fixes for wpcm450, GIC...
      :
      : - BE detection for a FSL controller
      :
      : - Declare the Sifive PLIC as wake-up agnostic
      :
      : - Simplify fishing out the device data for the ST irqchip
      :
      : - Mark some data structures as __initconst in the apple-aic driver
      :
      : - Switch over from strtobool to kstrtobool
      :
      : - COMPILET_TEST fixes
      :
      : - and the mandatory "repeated word" commit...
      : .
      irqchip/ls-extirq: Fix endianness detection
      irqchip/gic: Use kstrtobool() instead of strtobool()
      irqchip/sifive-plic: Support wake IRQs
      irqchip/loongson-liointc: Fix improper error handling in liointc_init()
      irqchip/sl28cpld: Replace irqchip mask_invert with unmask_base
      irqchip/wpcm450: Fix memory leak in wpcm450_aic_of_init()
      irqchip/st: Use device_get_match_data() to simplify the code
      irqchip/al-fic: Drop obsolete dependency on COMPILE_TEST
      irqchip: gic-pm: Use pm_runtime_resume_and_get() in gic_probe()
      irqchip/mips-gic: Drop repeated word in comment
      irqchip/apple-aic: Mark aic_info structs __initconst
    
    Signed-off-by: Marc Zyngier <maz@kernel.org>

commit d03407183d97554dfffea70f385b5bdd520f846c
Author: Kalle Valo <quic_kvalo@quicinc.com>
Date:   Fri Dec 2 12:30:27 2022 +0200

    wifi: ath10k: fix QCOM_SMEM dependency
    
    Nathan noticed that when HWSPINLOCK is disabled there's a Kconfig warning:
    
      WARNING: unmet direct dependencies detected for QCOM_SMEM
        Depends on [n]: (ARCH_QCOM [=y] || COMPILE_TEST [=n]) && HWSPINLOCK [=n]
        Selected by [m]:
        - ATH10K_SNOC [=m] && NETDEVICES [=y] && WLAN [=y] && WLAN_VENDOR_ATH [=y] && ATH10K [=m] && (ARCH_QCOM [=y] || COMPILE_TEST [=n])
    
    The problem here is that QCOM_SMEM depends on HWSPINLOCK so we cannot select
    QCOM_SMEM and instead we neeed to use 'depends on'.
    
    Reported-by: Nathan Chancellor <nathan@kernel.org>
    Link: https://lore.kernel.org/all/Y4YsyaIW+CPdHWv3@dev-arch.thelio-3990X/
    Fixes: 4d79f6f34bbb ("wifi: ath10k: Store WLAN firmware version in SMEM image table")
    Signed-off-by: Kalle Valo <quic_kvalo@quicinc.com>
    Signed-off-by: Kalle Valo <kvalo@kernel.org>
    Link: https://lore.kernel.org/r/20221202103027.25974-1-kvalo@kernel.org

commit f51c3741c87ea662464bf36baf84fced56afbab6
Author: Shin'ichiro Kawasaki <shinichiro.kawasaki@wdc.com>
Date:   Fri Nov 11 10:44:49 2022 +0900

    scsi: mpi3mr: Suppress command reply debug prints
    
    [ Upstream commit 7d21fcfb409500dc9b114567f0ef8d30b3190dee ]
    
    After it receives command reply, mpi3mr driver checks command result. If
    the result is not zero, it prints out command information. This debug
    information is confusing since they are printed even when the non-zero
    result is expected. "Power-on or device reset occurred" is printed for Test
    Unit Ready command at drive detection. Inquiry failure for unsupported VPD
    page header is also printed. They are harmless but look like failures.
    
    To avoid the confusion, print the command reply debug information only when
    the module parameter logging_level has value MPI3_DEBUG_SCSI_ERROR= 64, in
    same manner as mpt3sas driver.
    
    Signed-off-by: Shin'ichiro Kawasaki <shinichiro.kawasaki@wdc.com>
    Link: https://lore.kernel.org/r/20221111014449.1649968-1-shinichiro.kawasaki@wdc.com
    Reviewed-by: Damien Le Moal <damien.lemoal@opensource.wdc.com>
    Signed-off-by: Martin K. Petersen <martin.petersen@oracle.com>
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit 6f6cb1714365a07dbc66851879538df9f6969288
Author: Lee Jones <lee@kernel.org>
Date:   Fri Nov 25 12:07:49 2022 +0000

    drm/amdgpu: temporarily disable broken Clang builds due to blown stack-frame
    
    Patch series "Fix a bunch of allmodconfig errors", v2.
    
    Since b339ec9c229aa ("kbuild: Only default to -Werror if COMPILE_TEST")
    WERROR now defaults to COMPILE_TEST meaning that it's enabled for
    allmodconfig builds.  This leads to some interesting build failures when
    using Clang, each resolved in this set.
    
    With this set applied, I am able to obtain a successful allmodconfig Arm
    build.
    
    
    This patch (of 2):
    
    calculate_bandwidth() is presently broken on all !(X86_64 || SPARC64 ||
    ARM64) architectures built with Clang (all released versions), whereby the
    stack frame gets blown up to well over 5k.  This would cause an immediate
    kernel panic on most architectures.  We'll revert this when the following
    bug report has been resolved:
    https://github.com/llvm/llvm-project/issues/41896.
    
    Link: https://lkml.kernel.org/r/20221125120750.3537134-1-lee@kernel.org
    Link: https://lkml.kernel.org/r/20221125120750.3537134-2-lee@kernel.org
    Signed-off-by: Lee Jones <lee@kernel.org>
    Suggested-by: Arnd Bergmann <arnd@arndb.de>
    Acked-by: Arnd Bergmann <arnd@arndb.de>
    Cc: Alex Deucher <alexander.deucher@amd.com>
    Cc: "Christian Knig" <christian.koenig@amd.com>
    Cc: Daniel Vetter <daniel@ffwll.ch>
    Cc: David Airlie <airlied@gmail.com>
    Cc: Harry Wentland <harry.wentland@amd.com>
    Cc: Lee Jones <lee@kernel.org>
    Cc: Leo Li <sunpeng.li@amd.com>
    Cc: Maarten Lankhorst <maarten.lankhorst@linux.intel.com>
    Cc: Maxime Ripard <mripard@kernel.org>
    Cc: Nathan Chancellor <nathan@kernel.org>
    Cc: Nick Desaulniers <ndesaulniers@google.com>
    Cc: "Pan, Xinhui" <Xinhui.Pan@amd.com>
    Cc: Rodrigo Siqueira <Rodrigo.Siqueira@amd.com>
    Cc: Thomas Zimmermann <tzimmermann@suse.de>
    Cc: Tom Rix <trix@redhat.com>
    Cc: <stable@vger.kernel.org>
    Signed-off-by: Andrew Morton <akpm@linux-foundation.org>

commit 22683e480b370ad1b3a34cfa461028d1f51da12d
Author: Jean Delvare <jdelvare@suse.de>
Date:   Sun Nov 27 15:52:30 2022 +0100

    usb: misc: onboard_usb_hub: Drop obsolete dependency on COMPILE_TEST
    
    Since commit 0166dc11be91 ("of: make CONFIG_OF user selectable"), it
    is possible to test-build any driver which depends on OF on any
    architecture by explicitly selecting OF. Therefore depending on
    COMPILE_TEST as an alternative is no longer needed.
    
    It is actually better to always build such drivers with OF enabled,
    so that the test builds are closer to how each driver will actually be
    built on its intended target. Building them without OF may not test
    much as the compiler will optimize out potentially large parts of the
    code. In the worst case, this could even pop false positive warnings.
    Dropping COMPILE_TEST here improves the quality of our testing and
    avoids wasting time on non-existent issues.
    
    Cc: Matthias Kaehlcke <mka@chromium.org>
    Cc: Greg Kroah-Hartman <gregkh@linuxfoundation.org>
    Signed-off-by: Jean Delvare <jdelvare@suse.de>
    Link: https://lore.kernel.org/r/20221127155230.144886b7@endymion.delvare
    Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>

commit 11e87890dab52d14af2b2f3945835ec6db473e3b
Author: Jean Delvare <jdelvare@suse.de>
Date:   Sun Nov 27 19:35:49 2022 +0100

    ASoC: SOF: Drop obsolete dependency on COMPILE_TEST
    
    Since commit 0166dc11be91 ("of: make CONFIG_OF user selectable"), it
    is possible to test-build any driver which depends on OF on any
    architecture by explicitly selecting OF. Therefore depending on
    COMPILE_TEST as an alternative is no longer needed.
    
    Signed-off-by: Jean Delvare <jdelvare@suse.de>
    Link: https://lore.kernel.org/r/20221127193549.211bf8f7@endymion.delvare
    Signed-off-by: Mark Brown <broonie@kernel.org>

commit d695d089e35e28f3f0ed4595a242922cc28f9b20
Author: Jean Delvare <jdelvare@suse.de>
Date:   Sun Nov 27 19:34:41 2022 +0100

    ASoC: rsnd: Drop obsolete dependency on COMPILE_TEST
    
    Since commit 0166dc11be91 ("of: make CONFIG_OF user selectable"), it
    is possible to test-build any driver which depends on OF on any
    architecture by explicitly selecting OF. Therefore depending on
    COMPILE_TEST as an alternative is no longer needed.
    
    Signed-off-by: Jean Delvare <jdelvare@suse.de>
    Link: https://lore.kernel.org/r/20221127193441.0b54484d@endymion.delvare
    Signed-off-by: Mark Brown <broonie@kernel.org>

commit 59e2cf8d21e05391c42628eb9fb5bb40f9d9698f
Author: Nathan Chancellor <nathan@kernel.org>
Date:   Mon Nov 21 20:21:21 2022 +0100

    ARM: 9275/1: Drop '-mthumb' from AFLAGS_ISA
    
    When building with CONFIG_THUMB2_KERNEL=y + a version of clang from
    Debian using CROSS_COMPILE=arm-linux-gnueabihf-, the following warning
    occurs frequently:
    
      <built-in>:383:9: warning: '__thumb2__' macro redefined [-Wmacro-redefined]
      #define __thumb2__ 2
              ^
      <built-in>:353:9: note: previous definition is here
      #define __thumb2__ 1
              ^
      1 warning generated.
    
    Debian carries a downstream patch that changes the default CPU of the
    arm-linux-gnueabihf target from 'arm1176jzf-s' (v6) to 'cortex-a7' (v7).
    As a result, '-mthumb' defines both '__thumb__' and '__thumb2__'. The
    define of '__thumb2__' via the command line was purposefully added to
    catch a situation like this.
    
    In a similar vein as commit 26b12e084bce ("ARM: 9264/1: only use
    -mtp=cp15 for the compiler"), do not add '-mthumb' to AFLAGS_ISA, as it
    is already passed to the assembler via '-Wa,-mthumb' and '__thumb2__' is
    already defined for preprocessing.
    
    Link: https://salsa.debian.org/pkg-llvm-team/llvm-toolchain/-/raw/622dbcbd40b316ed3905a2d25d9623544a06e6b1/debian/patches/930008-arm.diff
    
    Fixes: 1d2e9b67b001 ("ARM: 9265/1: pass -march= only to compiler")
    Reported-by: "kernelci.org bot" <bot@kernelci.org>
    Reviewed-by: Nick Desaulniers <ndesaulniers@google.com>
    Tested-by: Nick Desaulniers <ndesaulniers@google.com>
    Reviewed-by: Ard Biesheuvel <ardb@kernel.org>
    Signed-off-by: Nathan Chancellor <nathan@kernel.org>
    Signed-off-by: Russell King (Oracle) <rmk+kernel@armlinux.org.uk>

commit 9869f37aa4ee2a2e08536529dab4ccda9e23ce0c
Author: Jean Delvare <jdelvare@suse.de>
Date:   Mon Nov 21 16:16:22 2022 +0100

    irqchip/al-fic: Drop obsolete dependency on COMPILE_TEST
    
    Since commit 0166dc11be91 ("of: make CONFIG_OF user selectable"), it
    is possible to test-build any driver which depends on OF on any
    architecture by explicitly selecting OF. Therefore depending on
    COMPILE_TEST as an alternative is no longer needed.
    
    It is actually better to always build such drivers with OF enabled,
    so that the test builds are closer to how each driver will actually be
    built on its intended target. Building them without OF may not test
    much as the compiler will optimize out potentially large parts of the
    code. In the worst case, this could even pop false positive warnings.
    Dropping COMPILE_TEST here improves the quality of our testing and
    avoids wasting time on non-existent issues.
    
    Signed-off-by: Jean Delvare <jdelvare@suse.de>
    Cc: Talel Shenhar <talel@amazon.com>
    Cc: Thomas Gleixner <tglx@linutronix.de>
    Cc: Marc Zyngier <maz@kernel.org>
    Signed-off-by: Marc Zyngier <maz@kernel.org>
    Link: https://lore.kernel.org/r/20221121161622.6294a899@endymion.delvare

commit 9d2427f36c5c4ebf8294bc48f0c0190f4cdf0485
Author: Zheng Bin <zhengbin13@huawei.com>
Date:   Thu Oct 27 17:59:04 2022 +0800

    slimbus: qcom-ngd: Fix build error when CONFIG_SLIM_QCOM_NGD_CTRL=y && CONFIG_QCOM_RPROC_COMMON=m
    
    commit e54fad8044db18cc400df8d01bfb86cada08b7cb upstream.
    
    If CONFIG_SLIM_QCOM_NGD_CTRL=y, CONFIG_QCOM_RPROC_COMMON=m, COMPILE_TEST=y,
    bulding fails:
    
    drivers/slimbus/qcom-ngd-ctrl.o: In function `qcom_slim_ngd_ctrl_probe':
    qcom-ngd-ctrl.c:(.text+0x330): undefined reference to `qcom_register_ssr_notifier'
    qcom-ngd-ctrl.c:(.text+0x5fc): undefined reference to `qcom_unregister_ssr_notifier'
    drivers/slimbus/qcom-ngd-ctrl.o: In function `qcom_slim_ngd_remove':
    qcom-ngd-ctrl.c:(.text+0x90c): undefined reference to `qcom_unregister_ssr_notifier'
    
    Make SLIM_QCOM_NGD_CTRL depends on QCOM_RPROC_COMMON || (COMPILE_TEST && !QCOM_RPROC_COMMON) to fix this.
    
    Fixes: e291691c6977 ("slimbus: qcom-ngd-ctrl: allow compile testing without QCOM_RPROC_COMMON")
    Cc: stable <stable@kernel.org>
    Signed-off-by: Zheng Bin <zhengbin13@huawei.com>
    Reviewed-by: Krzysztof Kozlowski <krzysztof.kozlowski@linaro.org>
    Link: https://lore.kernel.org/r/20221027095904.3388959-1-zhengbin13@huawei.com
    Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>

commit 6b35ac831555552028d5bd69eede69d4658f802c
Author: Zheng Bin <zhengbin13@huawei.com>
Date:   Thu Oct 27 17:59:04 2022 +0800

    slimbus: qcom-ngd: Fix build error when CONFIG_SLIM_QCOM_NGD_CTRL=y && CONFIG_QCOM_RPROC_COMMON=m
    
    commit e54fad8044db18cc400df8d01bfb86cada08b7cb upstream.
    
    If CONFIG_SLIM_QCOM_NGD_CTRL=y, CONFIG_QCOM_RPROC_COMMON=m, COMPILE_TEST=y,
    bulding fails:
    
    drivers/slimbus/qcom-ngd-ctrl.o: In function `qcom_slim_ngd_ctrl_probe':
    qcom-ngd-ctrl.c:(.text+0x330): undefined reference to `qcom_register_ssr_notifier'
    qcom-ngd-ctrl.c:(.text+0x5fc): undefined reference to `qcom_unregister_ssr_notifier'
    drivers/slimbus/qcom-ngd-ctrl.o: In function `qcom_slim_ngd_remove':
    qcom-ngd-ctrl.c:(.text+0x90c): undefined reference to `qcom_unregister_ssr_notifier'
    
    Make SLIM_QCOM_NGD_CTRL depends on QCOM_RPROC_COMMON || (COMPILE_TEST && !QCOM_RPROC_COMMON) to fix this.
    
    Fixes: e291691c6977 ("slimbus: qcom-ngd-ctrl: allow compile testing without QCOM_RPROC_COMMON")
    Cc: stable <stable@kernel.org>
    Signed-off-by: Zheng Bin <zhengbin13@huawei.com>
    Reviewed-by: Krzysztof Kozlowski <krzysztof.kozlowski@linaro.org>
    Link: https://lore.kernel.org/r/20221027095904.3388959-1-zhengbin13@huawei.com
    Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>

commit 9c512e476b0bf8b4f22982eac82db7ff7cc08f73
Author: Jean Delvare <jdelvare@suse.de>
Date:   Fri Nov 25 08:31:14 2022 +0100

    spi: cadence: Drop obsolete dependency on COMPILE_TEST
    
    Since commit 0166dc11be91 ("of: make CONFIG_OF user selectable"), it
    is possible to test-build any driver which depends on OF on any
    architecture by explicitly selecting OF. Therefore depending on
    COMPILE_TEST as an alternative is no longer needed.
    
    Signed-off-by: Jean Delvare <jdelvare@suse.de>
    Link: https://lore.kernel.org/r/20221125083114.67e7f83c@endymion.delvare
    Signed-off-by: Mark Brown <broonie@kernel.org>

commit 6408cc05a50aaf88074a5a31d065e5af87a456f5
Author: Jean Delvare <jdelvare@suse.de>
Date:   Thu Nov 24 11:59:46 2022 +0100

    mtd: rawnand: Drop obsolete dependencies on COMPILE_TEST
    
    Since commit 0166dc11be91 ("of: make CONFIG_OF user selectable"), it
    is possible to test-build any driver which depends on OF on any
    architecture by explicitly selecting OF. Therefore depending on
    COMPILE_TEST as an alternative is no longer needed.
    
    It is actually better to always build such drivers with OF enabled,
    so that the test builds are closer to how each driver will actually be
    built on its intended target. Building them without OF may not test
    much as the compiler will optimize out potentially large parts of the
    code. In the worst case, this could even pop false positive warnings.
    Dropping COMPILE_TEST here improves the quality of our testing and
    avoids wasting time on non-existent issues.
    
    Signed-off-by: Jean Delvare <jdelvare@suse.de>
    Cc: Miquel Raynal <miquel.raynal@bootlin.com>
    Cc: Richard Weinberger <richard@nod.at>
    Cc: Vignesh Raghavendra <vigneshr@ti.com>
    Cc: Naga Sureshkumar Relli <nagasure@xilinx.com>
    Signed-off-by: Miquel Raynal <miquel.raynal@bootlin.com>
    Link: https://lore.kernel.org/linux-mtd/20221124115946.5edb771c@endymion.delvare

commit c4b02c92d9673ef4704fd0c8f008fec183517b64
Author: Jean Delvare <jdelvare@suse.de>
Date:   Thu Nov 24 14:47:08 2022 +0100

    regulator: Drop obsolete dependencies on COMPILE_TEST
    
    Since commit 0166dc11be91 ("of: make CONFIG_OF user selectable"), it
    is possible to test-build any driver which depends on OF on any
    architecture by explicitly selecting OF. Therefore depending on
    COMPILE_TEST as an alternative is no longer needed.
    
    It is actually better to always build such drivers with OF enabled,
    so that the test builds are closer to how each driver will actually be
    built on its intended target. Building them without OF may not test
    much as the compiler will optimize out potentially large parts of the
    code. In the worst case, this could even pop false positive warnings.
    Dropping COMPILE_TEST here improves the quality of our testing and
    avoids wasting time on non-existent issues.
    
    As a minor optimization, this also lets us drop several occurrences of
    of_match_ptr(), __maybe_unused and some ifdef guarding, as we now know
    what all of this will resolve to, we might as well save cpp some work.
    
    Signed-off-by: Jean Delvare <jdelvare@suse.de>
    Cc: Liam Girdwood <lgirdwood@gmail.com>
    Cc: Mark Brown <broonie@kernel.org>
    Cc: Icenowy Zheng <icenowy@aosc.io>
    Link: https://lore.kernel.org/r/20221124144708.64371b98@endymion.delvare
    Signed-off-by: Mark Brown <broonie@kernel.org>

commit 3e65412709293d5fb65249408e8e801b23b72635
Author: Michael Ellerman <mpe@ellerman.id.au>
Date:   Thu Oct 6 14:20:18 2022 +1100

    powerpc: Make instruction dump work with scripts/decodecode
    
    Matt reported that scripts/decodecode doesn't work for the instruction
    dump in the powerpc oops output. Although there are scripts around that
    can decode it, it would be preferable if the standard in-tree script
    worked.
    
    All other arches prefix the instruction dump with "Code:", and that's
    what the script looks for, so use that.
    
    The script then works as expected:
    
      $ CROSS_COMPILE=powerpc64le-linux-gnu- ./scripts/decodecode
      Code:
      fbc1fff0 f821ffc1 7c7d1b78 7c9c2378 ebc30028 7fdff378 48000018 60000000
      60000000 ebff0008 7c3ef840 41820048 <815f0060> e93f0000 5529077c 7d295378
      ^D
    
      All code
      ========
         0:   f0 ff c1 fb     std     r30,-16(r1)
         4:   c1 ff 21 f8     stdu    r1,-64(r1)
         8:   78 1b 7d 7c     mr      r29,r3
         ...
    
    Note that the script doesn't cope well with printk timestamps or printk
    caller info.
    
    Reported-by: Matthew Wilcox <willy@infradead.org>
    Signed-off-by: Michael Ellerman <mpe@ellerman.id.au>
    Link: https://lore.kernel.org/r/20221006032019.1128624-1-mpe@ellerman.id.au

commit 5f964b02468599696bfa7ea7f1eab140a224127a
Author: Jean Delvare <jdelvare@suse.de>
Date:   Tue Nov 22 14:19:52 2022 -0800

    Input: stmpe-ts - drop obsolete dependency on COMPILE_TEST
    
    Since commit 0166dc11be91 ("of: make CONFIG_OF user selectable"), it
    is possible to test-build any driver which depends on OF on any
    architecture by explicitly selecting OF. Therefore depending on
    COMPILE_TEST as an alternative is no longer needed.
    
    It is actually better to always build such drivers with OF enabled,
    so that the test builds are closer to how each driver will actually be
    built on its intended target. Building them without OF may not test
    much as the compiler will optimize out potentially large parts of the
    code. In the worst case, this could even pop false positive warnings.
    Dropping COMPILE_TEST here improves the quality of our testing and
    avoids wasting time on non-existent issues.
    
    Signed-off-by: Jean Delvare <jdelvare@suse.de>
    Link: https://lore.kernel.org/r/20221121145203.1efb0c08@endymion.delvare
    Signed-off-by: Dmitry Torokhov <dmitry.torokhov@gmail.com>

commit 3205054dc6fe2425ff24827a51fdf7cbbb528680
Author: Lukas Bulwahn <lukas.bulwahn@gmail.com>
Date:   Wed Nov 16 12:04:44 2022 +0100

    usb: dwc3: improve the config dependency of USB_DWC3_XILINX
    
    A request to Manish Narani (see Link) asked for clarification of the
    reference to the config ARCH_VERSAL in the support of Xilinx SoCs with
    DesignWare Core USB3 IP.
    
    As there is no response, clean up the reference to the non-existing config
    symbol. While at it, follow up on Felipe Balbi's request to add the
    alternative COMPILE_TEST dependency.
    
    Link: https://lore.kernel.org/all/CAKXUXMwgWfX8+OvY0aCwRNukencwJERAZzU7p4eOLXQ2zv6rAg@mail.gmail.com/
    
    Signed-off-by: Lukas Bulwahn <lukas.bulwahn@gmail.com>
    Acked-by: Thinh Nguyen <Thinh.Nguyen@synopsys.com>
    Link: https://lore.kernel.org/r/20221116110444.8340-1-lukas.bulwahn@gmail.com
    Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>

commit 98b2afc8a67f651ed01fc7d5a7e2528e63dd4e08
Author: Bjrn Tpel <bjorn@rivosinc.com>
Date:   Tue Nov 15 19:20:51 2022 +0100

    selftests/bpf: Pass target triple to get_sys_includes macro
    
    When cross-compiling [1], the get_sys_includes make macro should use
    the target system include path, and not the build hosts system include
    path.
    
    Make clang honor the CROSS_COMPILE triple.
    
    [1] e.g. "ARCH=riscv CROSS_COMPILE=riscv64-linux-gnu- make"
    
    Signed-off-by: Bjrn Tpel <bjorn@rivosinc.com>
    Signed-off-by: Andrii Nakryiko <andrii@kernel.org>
    Tested-by: Anders Roxell <anders.roxell@linaro.org>
    Link: https://lore.kernel.org/bpf/20221115182051.582962-2-bjorn@kernel.org

commit 7d21fcfb409500dc9b114567f0ef8d30b3190dee
Author: Shin'ichiro Kawasaki <shinichiro.kawasaki@wdc.com>
Date:   Fri Nov 11 10:44:49 2022 +0900

    scsi: mpi3mr: Suppress command reply debug prints
    
    After it receives command reply, mpi3mr driver checks command result. If
    the result is not zero, it prints out command information. This debug
    information is confusing since they are printed even when the non-zero
    result is expected. "Power-on or device reset occurred" is printed for Test
    Unit Ready command at drive detection. Inquiry failure for unsupported VPD
    page header is also printed. They are harmless but look like failures.
    
    To avoid the confusion, print the command reply debug information only when
    the module parameter logging_level has value MPI3_DEBUG_SCSI_ERROR= 64, in
    same manner as mpt3sas driver.
    
    Signed-off-by: Shin'ichiro Kawasaki <shinichiro.kawasaki@wdc.com>
    Link: https://lore.kernel.org/r/20221111014449.1649968-1-shinichiro.kawasaki@wdc.com
    Reviewed-by: Damien Le Moal <damien.lemoal@opensource.wdc.com>
    Signed-off-by: Martin K. Petersen <martin.petersen@oracle.com>

commit e54fad8044db18cc400df8d01bfb86cada08b7cb
Author: Zheng Bin <zhengbin13@huawei.com>
Date:   Thu Oct 27 17:59:04 2022 +0800

    slimbus: qcom-ngd: Fix build error when CONFIG_SLIM_QCOM_NGD_CTRL=y && CONFIG_QCOM_RPROC_COMMON=m
    
    If CONFIG_SLIM_QCOM_NGD_CTRL=y, CONFIG_QCOM_RPROC_COMMON=m, COMPILE_TEST=y,
    bulding fails:
    
    drivers/slimbus/qcom-ngd-ctrl.o: In function `qcom_slim_ngd_ctrl_probe':
    qcom-ngd-ctrl.c:(.text+0x330): undefined reference to `qcom_register_ssr_notifier'
    qcom-ngd-ctrl.c:(.text+0x5fc): undefined reference to `qcom_unregister_ssr_notifier'
    drivers/slimbus/qcom-ngd-ctrl.o: In function `qcom_slim_ngd_remove':
    qcom-ngd-ctrl.c:(.text+0x90c): undefined reference to `qcom_unregister_ssr_notifier'
    
    Make SLIM_QCOM_NGD_CTRL depends on QCOM_RPROC_COMMON || (COMPILE_TEST && !QCOM_RPROC_COMMON) to fix this.
    
    Fixes: e291691c6977 ("slimbus: qcom-ngd-ctrl: allow compile testing without QCOM_RPROC_COMMON")
    Cc: stable <stable@kernel.org>
    Signed-off-by: Zheng Bin <zhengbin13@huawei.com>
    Reviewed-by: Krzysztof Kozlowski <krzysztof.kozlowski@linaro.org>
    Link: https://lore.kernel.org/r/20221027095904.3388959-1-zhengbin13@huawei.com
    Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>

commit a6e770733dc4ce616ff77f43f50507fa2034ff49
Author: Conor Dooley <conor.dooley@microchip.com>
Date:   Wed Oct 19 13:53:02 2022 +0100

    arm64: topology: move store_cpu_topology() to shared code
    
    commit 456797da792fa7cbf6698febf275fe9b36691f78 upstream.
    
    arm64's method of defining a default cpu topology requires only minimal
    changes to apply to RISC-V also. The current arm64 implementation exits
    early in a uniprocessor configuration by reading MPIDR & claiming that
    uniprocessor can rely on the default values.
    
    This is appears to be a hangover from prior to '3102bc0e6ac7 ("arm64:
    topology: Stop using MPIDR for topology information")', because the
    current code just assigns default values for multiprocessor systems.
    
    With the MPIDR references removed, store_cpu_topolgy() can be moved to
    the common arch_topology code.
    
    Reviewed-by: Sudeep Holla <sudeep.holla@arm.com>
    Acked-by: Catalin Marinas <catalin.marinas@arm.com>
    Reviewed-by: Atish Patra <atishp@rivosinc.com>
    Signed-off-by: Conor Dooley <conor.dooley@microchip.com>
    Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>

commit 60dd3dc2acc4088d717f452b2094c45734c52ce8
Author: Conor Dooley <conor.dooley@microchip.com>
Date:   Wed Oct 19 13:52:09 2022 +0100

    arm64: topology: move store_cpu_topology() to shared code
    
    commit 456797da792fa7cbf6698febf275fe9b36691f78 upstream.
    
    arm64's method of defining a default cpu topology requires only minimal
    changes to apply to RISC-V also. The current arm64 implementation exits
    early in a uniprocessor configuration by reading MPIDR & claiming that
    uniprocessor can rely on the default values.
    
    This is appears to be a hangover from prior to '3102bc0e6ac7 ("arm64:
    topology: Stop using MPIDR for topology information")', because the
    current code just assigns default values for multiprocessor systems.
    
    With the MPIDR references removed, store_cpu_topolgy() can be moved to
    the common arch_topology code.
    
    Reviewed-by: Sudeep Holla <sudeep.holla@arm.com>
    Acked-by: Catalin Marinas <catalin.marinas@arm.com>
    Reviewed-by: Atish Patra <atishp@rivosinc.com>
    Signed-off-by: Conor Dooley <conor.dooley@microchip.com>
    Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>

commit 06481cd9f7f692088bce03244f8cf132018f2fc6
Author: Javier Martinez Canillas <javierm@redhat.com>
Date:   Wed Oct 19 10:56:01 2022 +0200

    kbuild: Quote OBJCOPY var to avoid a pahole call break the build
    
    commit ff2e6efda0d5c51b33e2bcc0b0b981ac0a0ef214 upstream.
    
    [backported for dependency, skipped Makefile.modfinal change,
    because module BTF is not supported in 5.10]
    
    The ccache tool can be used to speed up cross-compilation, by calling the
    compiler and binutils through ccache. For example, following should work:
    
        $ export ARCH=arm64 CROSS_COMPILE="ccache aarch64-linux-gnu-"
    
        $ make M=drivers/gpu/drm/rockchip/
    
    but pahole fails to extract the BTF info from DWARF, breaking the build:
    
          CC [M]  drivers/gpu/drm/rockchip//rockchipdrm.mod.o
          LD [M]  drivers/gpu/drm/rockchip//rockchipdrm.ko
          BTF [M] drivers/gpu/drm/rockchip//rockchipdrm.ko
        aarch64-linux-gnu-objcopy: invalid option -- 'J'
        Usage: aarch64-linux-gnu-objcopy [option(s)] in-file [out-file]
         Copies a binary file, possibly transforming it in the process
        ...
        make[1]: *** [scripts/Makefile.modpost:156: __modpost] Error 2
        make: *** [Makefile:1866: modules] Error 2
    
    this fails because OBJCOPY is set to "ccache aarch64-linux-gnu-copy" and
    later pahole is executed with the following command line:
    
        LLVM_OBJCOPY=$(OBJCOPY) $(PAHOLE) -J --btf_base vmlinux $@
    
    which gets expanded to:
    
        LLVM_OBJCOPY=ccache aarch64-linux-gnu-objcopy pahole -J ...
    
    instead of:
    
        LLVM_OBJCOPY="ccache aarch64-linux-gnu-objcopy" pahole -J ...
    
    Fixes: 5f9ae91f7c0d ("kbuild: Build kernel module BTFs if BTF is enabled and pahole supports it")
    Signed-off-by: Javier Martinez Canillas <javierm@redhat.com>
    Signed-off-by: Andrii Nakryiko <andrii@kernel.org>
    Acked-by: Andrii Nakryiko <andrii@kernel.org>
    Acked-by: Arnaldo Carvalho de Melo <acme@redhat.com>
    Link: https://lore.kernel.org/bpf/20210526215228.3729875-1-javierm@redhat.com
    Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>

commit 29c1c44646aec5d5134f2365259a84becc1ee7d3
Author: Mubashir Adnan Qureshi <mubashirq@google.com>
Date:   Wed Oct 26 13:51:14 2022 +0000

    tcp: add u32 counter in tcp_sock and an SNMP counter for PLB
    
    A u32 counter is added to tcp_sock for counting the number of PLB
    triggered rehashes for a TCP connection. An SNMP counter is also
    added to count overall PLB triggered rehash events for a host. These
    counters are hooked up to PLB implementation for DCTCP.
    
    TCP_NLA_REHASH is added to SCM_TIMESTAMPING_OPT_STATS that reports
    the rehash attempts triggered due to PLB or timeouts. This gives
    a historical view of sustained congestion or timeouts experienced
    by the TCP connection.
    
    Signed-off-by: Mubashir Adnan Qureshi <mubashirq@google.com>
    Signed-off-by: Yuchung Cheng <ycheng@google.com>
    Signed-off-by: Neal Cardwell <ncardwell@google.com>
    Reviewed-by: Eric Dumazet <edumazet@google.com>
    Signed-off-by: David S. Miller <davem@davemloft.net>

commit 25c2e5911705c69d7b01c35ea0b32cbe6ada67cd
Author: Nikita Shubin <n.shubin@yadro.com>
Date:   Mon Aug 15 16:22:38 2022 +0300

    perf tools riscv: Add support for get_cpuid_str function
    
    The get_cpuid_str function returns the string that contains values of
    MVENDORID, MARCHID and MIMPID in hex format separated by coma.
    
    The values themselves are taken from first cpu entry in "/proc/cpuid"
    that contains "mvendorid", "marchid" and "mimpid".
    
    Signed-off-by: Nikita Shubin <n.shubin@yadro.com>
    Tested-by: Kautuk Consul <kconsul@ventanamicro.com>
    Acked-by: Palmer Dabbelt <palmer@rivosinc.com>
    Cc: Albert Ou <aou@eecs.berkeley.edu>
    Cc: Alexander Shishkin <alexander.shishkin@linux.intel.com>
    Cc: Anup Patel <anup@brainfault.org>
    Cc: Ingo Molnar <mingo@redhat.com>
    Cc: Jiri Olsa <jolsa@kernel.org>
    Cc: Mark Rutland <mark.rutland@arm.com>
    Cc: Namhyung Kim <namhyung@kernel.org>
    Cc: Palmer Dabbelt <palmer@dabbelt.com>
    Cc: Paul Walmsley <paul.walmsley@sifive.com>
    Cc: Peter Zijlstra <peterz@infradead.org>
    Cc: linux-riscv@lists.infradead.org
    Cc: linux@yadro.com
    Link: https://lore.kernel.org/r/20220815132251.25702-2-nikita.shubin@maquefel.me
    Signed-off-by: Arnaldo Carvalho de Melo <acme@redhat.com>

commit d46c24f307fbc491980d4170071dc6d79b8b9b3e
Author: Conor Dooley <conor.dooley@microchip.com>
Date:   Fri Jul 15 18:51:55 2022 +0100

    arm64: topology: move store_cpu_topology() to shared code
    
    commit 456797da792fa7cbf6698febf275fe9b36691f78 upstream.
    
    arm64's method of defining a default cpu topology requires only minimal
    changes to apply to RISC-V also. The current arm64 implementation exits
    early in a uniprocessor configuration by reading MPIDR & claiming that
    uniprocessor can rely on the default values.
    
    This is appears to be a hangover from prior to '3102bc0e6ac7 ("arm64:
    topology: Stop using MPIDR for topology information")', because the
    current code just assigns default values for multiprocessor systems.
    
    With the MPIDR references removed, store_cpu_topolgy() can be moved to
    the common arch_topology code.
    
    Reviewed-by: Sudeep Holla <sudeep.holla@arm.com>
    Acked-by: Catalin Marinas <catalin.marinas@arm.com>
    Reviewed-by: Atish Patra <atishp@rivosinc.com>
    Signed-off-by: Conor Dooley <conor.dooley@microchip.com>
    Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>

commit 9195a860ef0a384d2ca2065cc61a0cc80d620de5
Author: Moudy Ho <moudy.ho@mediatek.com>
Date:   Thu Oct 20 16:19:47 2022 +0800

    media: platform: mtk-mdp3: remove unused VIDEO_MEDIATEK_VPU config
    
    Since REMOTEPROC completely replaces the VIDEO_MEDIATEK_VPU in MDP3,
    unused config should be removed to avoid compilation warnings
    reported on i386 or x86_64.
    
    Warning messages:
        WARNING: unmet direct dependencies detected for VIDEO_MEDIATEK_VPU
              Depends on [n]: MEDIA_SUPPORT [=y] && MEDIA_PLATFORM_SUPPORT [=y]
            && MEDIA_PLATFORM_DRIVERS [=y] && V4L_MEM2MEM_DRIVERS [=n] &&
            VIDEO_DEV [=y] && (ARCH_MEDIATEK || COMPILE_TEST [=y])
              Selected by [y]:
              - VIDEO_MEDIATEK_MDP3 [=y] && MEDIA_SUPPORT [=y] &&
            MEDIA_PLATFORM_SUPPORT [=y] && MEDIA_PLATFORM_DRIVERS [=y] &&
            (MTK_IOMMU [=n] || COMPILE_TEST [=y]) && VIDEO_DEV [=y] &&
            (ARCH_MEDIATEK || COMPILE_TEST [=y]) && HAS_DMA [=y] && REMOTEPROC
            [=y]
    
    Fixes: 61890ccaefaf ("media: platform: mtk-mdp3: add MediaTek MDP3 driver")
    Signed-off-by: Moudy Ho <moudy.ho@mediatek.com>
    Reviewed-by: AngeloGioacchino Del Regno <angelogioacchino.delregno@collabora.com>
    Signed-off-by: Hans Verkuil <hverkuil-cisco@xs4all.nl>

commit 32863f41ee774d3e1fc787e07bf31bdf9d9953f9
Author: Conor Dooley <conor.dooley@microchip.com>
Date:   Fri Jul 15 18:51:55 2022 +0100

    arm64: topology: move store_cpu_topology() to shared code
    
    commit 456797da792fa7cbf6698febf275fe9b36691f78 upstream.
    
    arm64's method of defining a default cpu topology requires only minimal
    changes to apply to RISC-V also. The current arm64 implementation exits
    early in a uniprocessor configuration by reading MPIDR & claiming that
    uniprocessor can rely on the default values.
    
    This is appears to be a hangover from prior to '3102bc0e6ac7 ("arm64:
    topology: Stop using MPIDR for topology information")', because the
    current code just assigns default values for multiprocessor systems.
    
    With the MPIDR references removed, store_cpu_topolgy() can be moved to
    the common arch_topology code.
    
    Reviewed-by: Sudeep Holla <sudeep.holla@arm.com>
    Acked-by: Catalin Marinas <catalin.marinas@arm.com>
    Reviewed-by: Atish Patra <atishp@rivosinc.com>
    Signed-off-by: Conor Dooley <conor.dooley@microchip.com>
    Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>

commit 65244389b1b347447a7eed866d9d458963e851e8
Author: Michal Kubecek <mkubecek@suse.cz>
Date:   Mon Oct 17 16:55:17 2022 +0200

    scsi: mpi3mr: Select CONFIG_SCSI_SAS_ATTRS
    
    Starting with commit 42fc9fee116f ("scsi: mpi3mr: Add helper functions to
    manage device's port"), kernel configured with CONFIG_SCSI_MPI3MR=m and
    CONFIG_SCSI_SAS_ATTRS=n fails to build because modpost cannot find symbols
    used in mpi3mr_transport.c:
    
      ERROR: modpost: "sas_port_alloc_num" [drivers/scsi/mpi3mr/mpi3mr.ko] undefined!
      ERROR: modpost: "sas_remove_host" [drivers/scsi/mpi3mr/mpi3mr.ko] undefined!
      ERROR: modpost: "sas_phy_alloc" [drivers/scsi/mpi3mr/mpi3mr.ko] undefined!
      ERROR: modpost: "sas_phy_free" [drivers/scsi/mpi3mr/mpi3mr.ko] undefined!
      ...
    
    Select CONFIG_SCSI_SAS_ATTRS when CONFIG_SCSI_MPI3MR is enabled to prevent
    inconsistent configs.
    
    Link: https://lore.kernel.org/r/20221017145517.93BCB6043B@lion.mk-sys.cz
    Fixes: 42fc9fee116f ("scsi: mpi3mr: Add helper functions to manage device's port")
    Acked-by: Sathya Prakash Veerichetty <sathya.prakash@broadcom.com>
    Signed-off-by: Michal Kubecek <mkubecek@suse.cz>
    Signed-off-by: Martin K. Petersen <martin.petersen@oracle.com>

commit b9b6543be3c6241f180901ed363f5baeb3472c94
Author: Conor Dooley <conor.dooley@microchip.com>
Date:   Fri Jul 15 18:51:55 2022 +0100

    arm64: topology: move store_cpu_topology() to shared code
    
    commit 456797da792fa7cbf6698febf275fe9b36691f78 upstream.
    
    arm64's method of defining a default cpu topology requires only minimal
    changes to apply to RISC-V also. The current arm64 implementation exits
    early in a uniprocessor configuration by reading MPIDR & claiming that
    uniprocessor can rely on the default values.
    
    This is appears to be a hangover from prior to '3102bc0e6ac7 ("arm64:
    topology: Stop using MPIDR for topology information")', because the
    current code just assigns default values for multiprocessor systems.
    
    With the MPIDR references removed, store_cpu_topolgy() can be moved to
    the common arch_topology code.
    
    Reviewed-by: Sudeep Holla <sudeep.holla@arm.com>
    Acked-by: Catalin Marinas <catalin.marinas@arm.com>
    Reviewed-by: Atish Patra <atishp@rivosinc.com>
    Signed-off-by: Conor Dooley <conor.dooley@microchip.com>
    Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>

commit c8a17756c42581ba1a567d1dd3b69e8f5619a7d8
Author: Thomas Zimmermann <tzimmermann@suse.de>
Date:   Tue Oct 11 17:07:08 2022 +0200

    drm/ofdrm: Add ofdrm for Open Firmware framebuffers
    
    Open Firmware provides basic display output via the 'display' node.
    DT platform code already provides a device that represents the node's
    framebuffer. Add a DRM driver for the device. The display mode and
    color format is pre-initialized by the system's firmware. Runtime
    modesetting via DRM is not possible. The display is useful during
    early boot stages or as error fallback.
    
    Similar functionality is already provided by fbdev's offb driver,
    which is insufficient for modern userspace. The old driver includes
    support for BootX device tree, which can be found on old 32-bit
    PowerPC Macintosh systems. If these are still in use, the
    functionality can be added to ofdrm or implemented in a new
    driver. As with simpledrm, the fbdev driver cannot be selected if
    ofdrm is already enabled.
    
    Two notable points about the driver:
    
     * Reading the framebuffer aperture from the device tree is not
    reliable on all systems. Ofdrm takes the heuristics and a comment
    from offb to pick the correct range.
    
     * No resource management may be tied to the underlying PCI device.
    Otherwise the handover to the native driver will fail with a resource
    conflict. PCI management is therefore done as part of the platform
    device's cleanup.
    
    The driver has been tested on qemu's ppc64le emulation. The device
    hand-over has been tested with bochs.
    
    v5:
            * use drm_atomic_helper_check_crtc_primary_plane()
    v4:
            * set preferred depth to the correct value
            * set bpp value for console emulation
            * output scanout-buffer parameters with drm_dbg()
    v3:
            * reintegrate FWFB helpers into ofdrm
            * use damage iterator
            * sync GEM BOs with drm_gem_fb_{begin,end}_cpu_access()
            * fix various atomic_check helpers
            * remove CRTC atomic_{enable,disable} (Javier)
            * compute stride with drm_format_info_min_pitch() (Daniel)
    v2:
            * removed simple-pipe helpers
            * built driver on top of FWFB helpers
            * merged all init code into single function
            * make PCI support optional (Michal)
            * support COMPILE_TEST (Javier)
    
    Signed-off-by: Thomas Zimmermann <tzimmermann@suse.de>
    Reviewed-by: Javier Martinez Canillas <javierm@redhat.com>
    
    convert
    Link: https://patchwork.freedesktop.org/patch/msgid/20221011150712.3928-2-tzimmermann@suse.de

commit 48a4dec82f15cc53190c3c8f385700dd9c581dcd
Author: Jean Delvare <jdelvare@suse.de>
Date:   Mon Oct 10 11:05:02 2022 -0700

    Input: atmel_captouch - drop obsolete dependency on COMPILE_TEST
    
    Since commit 0166dc11be91 ("of: make CONFIG_OF user selectable"), it
    is possible to test-build any driver which depends on OF on any
    architecture by explicitly selecting OF. Therefore depending on
    COMPILE_TEST as an alternative is no longer needed.
    
    It is actually better to always build such drivers with OF enabled,
    so that the test builds are closer to how each driver will actually be
    built on its intended target. Building them without OF may not test
    much as the compiler will optimize out potentially large parts of the
    code. In the worst case, this could even pop false positive warnings.
    Dropping COMPILE_TEST here improves the quality of our testing and
    avoids wasting time on non-existent issues.
    
    As a matter of fact, dropping the alternative dependency on
    COMPILE_TEST allows removing preprocessor directives, which will
    speed up the build.
    
    Signed-off-by: Jean Delvare <jdelvare@suse.de>
    Link: https://lore.kernel.org/r/20221004102606.5d49e5d7@endymion.delvare
    Signed-off-by: Dmitry Torokhov <dmitry.torokhov@gmail.com>

commit 6181073dd6a7e5deafc60e7981bd765b6c93da8c
Merge: 881eccbef525 30963b2f75bf
Author: Linus Torvalds <torvalds@linux-foundation.org>
Date:   Fri Oct 7 16:36:24 2022 -0700

    Merge tag 'tty-6.1-rc1' of git://git.kernel.org/pub/scm/linux/kernel/git/gregkh/tty
    
    Pull tty/serial driver updates from Greg KH:
     "Here is the big set of TTY and Serial driver updates for 6.1-rc1.
    
      Lots of cleanups in here, no real new functionality this time around,
      with the diffstat being that we removed more lines than we added!
    
      Included in here are:
    
       - termios unification cleanups from Al Viro, it's nice to finally get
         this work done
    
       - tty serial transmit cleanups in various drivers in preparation for
         more cleanup and unification in future releases (that work was not
         ready for this release)
    
       - n_gsm fixes and updates
    
       - ktermios cleanups and code reductions
    
       - dt bindings json conversions and updates for new devices
    
       - some serial driver updates for new devices
    
       - lots of other tiny cleanups and janitorial stuff. Full details in
         the shortlog.
    
      All of these have been in linux-next for a while with no reported
      issues"
    
    * tag 'tty-6.1-rc1' of git://git.kernel.org/pub/scm/linux/kernel/git/gregkh/tty: (102 commits)
      serial: cpm_uart: Don't request IRQ too early for console port
      tty: serial: do unlock on a common path in altera_jtaguart_console_putc()
      tty: serial: unify TX space reads under altera_jtaguart_tx_space()
      tty: serial: use FIELD_GET() in lqasc_tx_ready()
      tty: serial: extend lqasc_tx_ready() to lqasc_console_putchar()
      tty: serial: allow pxa.c to be COMPILE_TESTed
      serial: stm32: Fix unused-variable warning
      tty: serial: atmel: Add COMMON_CLK dependency to SERIAL_ATMEL
      serial: 8250: Fix restoring termios speed after suspend
      serial: Deassert Transmit Enable on probe in driver-specific way
      serial: 8250_dma: Convert to use uart_xmit_advance()
      serial: 8250_omap: Convert to use uart_xmit_advance()
      MAINTAINERS: Solve warning regarding inexistent atmel-usart binding
      serial: stm32: Deassert Transmit Enable on ->rs485_config()
      serial: ar933x: Deassert Transmit Enable on ->rs485_config()
      tty: serial: atmel: Use FIELD_PREP/FIELD_GET
      tty: serial: atmel: Make the driver aware of the existence of GCLK
      tty: serial: atmel: Only divide Clock Divisor if the IP is USART
      tty: serial: atmel: Separate mode clearing between UART and USART
      dt-bindings: serial: atmel,at91-usart: Add gclk as a possible USART clock
      ...

commit dda0ba40da68255cea24474e69bcf14499408e2b
Merge: 038239640e3a 43cf168fa999
Author: Linus Torvalds <torvalds@linux-foundation.org>
Date:   Mon Oct 3 10:01:19 2022 -0700

    Merge tag 'nolibc.2022.09.30a' of git://git.kernel.org/pub/scm/linux/kernel/git/paulmck/linux-rcu
    
    Pull nolibc updates from Paul McKenney:
     "Most notably greatly improved testing. These tests are located in
      tools/testing/selftests/nolibc. The output of "make help" is as
      follows:
    
        Supported targets under selftests/nolibc:
          all          call the "run" target below
          help         this help
          sysroot      create the nolibc sysroot here (uses $ARCH)
          nolibc-test  build the executable (uses $CC and $CROSS_COMPILE)
          initramfs    prepare the initramfs with nolibc-test
          defconfig    create a fresh new default config (uses $ARCH)
          kernel       (re)build the kernel with the initramfs (uses $ARCH)
          run          runs the kernel in QEMU after building it (uses $ARCH, $TEST)
          rerun        runs a previously prebuilt kernel in QEMU (uses $ARCH, $TEST)
          clean        clean the sysroot, initramfs, build and output files
    
        The output file is "run.out". Test ranges may be passed using $TEST.
    
        Currently using the following variables:
          ARCH          = x86
          CROSS_COMPILE =
          CC            = gcc
          OUTPUT        = /home/git/linux-rcu/tools/testing/selftests/nolibc/
          TEST          =
          QEMU_ARCH     = x86_64 [determined from $ARCH]
          IMAGE_NAME    = bzImage [determined from $ARCH]
    
      The output of a successful x86 "make run" is currently as follows,
      with kernel build output omitted:
    
        $ make run
        71 test(s) passed."
    
    * tag 'nolibc.2022.09.30a' of git://git.kernel.org/pub/scm/linux/kernel/git/paulmck/linux-rcu:
      selftests/nolibc: Avoid generated files being committed
      selftests/nolibc: add a "help" target
      selftests/nolibc: "sysroot" target installs a local copy of the sysroot
      selftests/nolibc: add a "run" target to start the kernel in QEMU
      selftests/nolibc: add a "defconfig" target
      selftests/nolibc: add a "kernel" target to build the kernel with the initramfs
      selftests/nolibc: support glibc as well
      selftests/nolibc: condition some tests on /proc existence
      selftests/nolibc: recreate and populate /dev and /proc if missing
      selftests/nolibc: on x86, support exiting with isa-debug-exit
      selftests/nolibc: exit with poweroff on success when getpid() == 1
      selftests/nolibc: add a few tests for some libc functions
      selftests/nolibc: implement a few tests for various syscalls
      selftests/nolibc: support a test definition format
      selftests/nolibc: add basic infrastructure to ease creation of nolibc tests
      tools/nolibc: make sys_mmap() automatically use the right __NR_mmap definition
      tools/nolibc: fix build warning in sys_mmap() when my_syscall6 is not defined
      tools/nolibc: make argc 32-bit in riscv startup code

commit 8a1088116ba5ddbfcd69789b4a153733c9686cbb
Author: Jiri Slaby <jslaby@suse.cz>
Date:   Tue Sep 27 13:05:28 2022 +0200

    tty: serial: allow pxa.c to be COMPILE_TESTed
    
    There is no issue compiling pxa.c even in the SERIAL_8250=y case. So to
    cover it in the usual configurations, add "|| COMPILE_TEST" there.
    
    Signed-off-by: Jiri Slaby <jslaby@suse.cz>
    Link: https://lore.kernel.org/r/20220927110528.12815-1-jslaby@suse.cz
    Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>

commit 7bc08355a4917f2bbd38e7af5207f339f47e5d36
Author: Srinivas Kandagatla <srinivas.kandagatla@linaro.org>
Date:   Fri Sep 30 11:53:47 2022 +0100

    ASoC: qcom: fix unmet direct dependencies for SND_SOC_QDSP6
    
    SND_SOC_QDSP6 already has COMPILE_TEST so remove that from
    SND_SOC_SC8280XP and also add QCOM_APR dependencies to
    SND_SOC_SC8280XP like other Qualcomm machine drivers.
    
    This should also fix below warning:
    on x86_64, when QCOM_APR is not set and COMPILE_TEST=y:
    
    WARNING: unmet direct dependencies detected for SND_SOC_QDSP6
      Depends on [n]: SOUND [=y] && !UML && SND [=y] && SND_SOC [=y]
            && SND_SOC_QCOM [=y] && QCOM_APR [=n] && COMMON_CLK [=y]
      Selected by [y]:
      - SND_SOC_SC8280XP [=y] && SOUND [=y] && !UML && SND [=y] && SND_SOC [=y]
            && SND_SOC_QCOM [=y] && (QCOM_APR [=n] || COMPILE_TEST [=y]) &&
             SOUNDWIRE [=y] && COMMON_CLK [=y]
    
    Fixes: 295aeea6646a ("ASoC: qcom: add machine driver for sc8280xp")
    Reported-by: Randy Dunlap <rdunlap@infradead.org>
    Signed-off-by: Srinivas Kandagatla <srinivas.kandagatla@linaro.org>
    Link: https://lore.kernel.org/r/20220930105347.41127-1-srinivas.kandagatla@linaro.org
    Signed-off-by: Mark Brown <broonie@kernel.org>

commit 68197205b3f61977c51c164117ba9650f5587bb6
Author: Randy Dunlap <rdunlap@infradead.org>
Date:   Mon May 30 19:55:57 2022 -0700

    drm/hisilicon: Add depends on MMU
    
    [ Upstream commit d8a79c03054911c375a2252627a429c9bc4615b6 ]
    
    The Kconfig symbol depended on MMU but was dropped by the commit
    acad3fe650a5 ("drm/hisilicon: Removed the dependency on the mmu")
    because it already had as a dependency ARM64 that already selects MMU.
    
    But later, commit a0f25a6bb319 ("drm/hisilicon/hibmc: Allow to be built
    if COMPILE_TEST is enabled") allowed the driver to be built for non-ARM64
    when COMPILE_TEST is set but that could lead to unmet direct dependencies
    and linking errors.
    
    Prevent a kconfig warning when MMU is not enabled by making
    DRM_HISI_HIBMC depend on MMU.
    
    WARNING: unmet direct dependencies detected for DRM_TTM
      Depends on [n]: HAS_IOMEM [=y] && DRM [=m] && MMU [=n]
      Selected by [m]:
      - DRM_TTM_HELPER [=m] && HAS_IOMEM [=y] && DRM [=m]
      - DRM_HISI_HIBMC [=m] && HAS_IOMEM [=y] && DRM [=m] && PCI [=y] && (ARM64 || COMPILE_TEST [=y])
    
    Fixes: acad3fe650a5 ("drm/hisilicon: Removed the dependency on the mmu")
    Signed-off-by: Randy Dunlap <rdunlap@infradead.org>
    Cc: Gerd Hoffmann <kraxel@redhat.com>
    Cc: Thomas Zimmermann <tzimmermann@suse.de>
    Cc: Xinliang Liu <xinliang.liu@linaro.org>
    Cc: Tian Tao  <tiantao6@hisilicon.com>
    Cc: John Stultz <jstultz@google.com>
    Cc: Xinwei Kong <kong.kongxinwei@hisilicon.com>
    Cc: Chen Feng <puck.chen@hisilicon.com>
    Cc: Christian Koenig <christian.koenig@amd.com>
    Cc: Huang Rui <ray.huang@amd.com>
    Cc: David Airlie <airlied@linux.ie>
    Cc: Daniel Vetter <daniel@ffwll.ch>
    Reviewed-by: Javier Martinez Canillas <javierm@redhat.com>
    Signed-off-by: Javier Martinez Canillas <javierm@redhat.com>
    Link: https://patchwork.freedesktop.org/patch/msgid/20220531025557.29593-1-rdunlap@infradead.org
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit ca86577c10bc9970586ca89981243c1905c436d3
Author: Randy Dunlap <rdunlap@infradead.org>
Date:   Mon May 30 19:55:57 2022 -0700

    drm/hisilicon: Add depends on MMU
    
    [ Upstream commit d8a79c03054911c375a2252627a429c9bc4615b6 ]
    
    The Kconfig symbol depended on MMU but was dropped by the commit
    acad3fe650a5 ("drm/hisilicon: Removed the dependency on the mmu")
    because it already had as a dependency ARM64 that already selects MMU.
    
    But later, commit a0f25a6bb319 ("drm/hisilicon/hibmc: Allow to be built
    if COMPILE_TEST is enabled") allowed the driver to be built for non-ARM64
    when COMPILE_TEST is set but that could lead to unmet direct dependencies
    and linking errors.
    
    Prevent a kconfig warning when MMU is not enabled by making
    DRM_HISI_HIBMC depend on MMU.
    
    WARNING: unmet direct dependencies detected for DRM_TTM
      Depends on [n]: HAS_IOMEM [=y] && DRM [=m] && MMU [=n]
      Selected by [m]:
      - DRM_TTM_HELPER [=m] && HAS_IOMEM [=y] && DRM [=m]
      - DRM_HISI_HIBMC [=m] && HAS_IOMEM [=y] && DRM [=m] && PCI [=y] && (ARM64 || COMPILE_TEST [=y])
    
    Fixes: acad3fe650a5 ("drm/hisilicon: Removed the dependency on the mmu")
    Signed-off-by: Randy Dunlap <rdunlap@infradead.org>
    Cc: Gerd Hoffmann <kraxel@redhat.com>
    Cc: Thomas Zimmermann <tzimmermann@suse.de>
    Cc: Xinliang Liu <xinliang.liu@linaro.org>
    Cc: Tian Tao  <tiantao6@hisilicon.com>
    Cc: John Stultz <jstultz@google.com>
    Cc: Xinwei Kong <kong.kongxinwei@hisilicon.com>
    Cc: Chen Feng <puck.chen@hisilicon.com>
    Cc: Christian Koenig <christian.koenig@amd.com>
    Cc: Huang Rui <ray.huang@amd.com>
    Cc: David Airlie <airlied@linux.ie>
    Cc: Daniel Vetter <daniel@ffwll.ch>
    Reviewed-by: Javier Martinez Canillas <javierm@redhat.com>
    Signed-off-by: Javier Martinez Canillas <javierm@redhat.com>
    Link: https://patchwork.freedesktop.org/patch/msgid/20220531025557.29593-1-rdunlap@infradead.org
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit 68c4acee6328df271918945c2e7a5c3d5b7a7823
Author: Javier Martinez Canillas <javierm@redhat.com>
Date:   Thu Dec 16 22:09:36 2021 +0100

    drm/hisilicon/hibmc: Allow to be built if COMPILE_TEST is enabled
    
    [ Upstream commit a0f25a6bb319aa05e04dcf51707c97c2881b4f47 ]
    
    The commit feeb07d0ca5a ("drm/hisilicon/hibmc: Make CONFIG_DRM_HISI_HIBMC
    depend on ARM64") made the driver Kconfig symbol to depend on ARM64 since
    it only supports that architecture and loading the module on others would
    lead to incorrect video modes being used.
    
    But it also prevented the driver to be built on other architectures which
    is useful to have compile test coverage when doing subsystem wide changes.
    
    Make the dependency instead to be (ARM64 || COMPILE_TEST), so the driver
    is buildable when the CONFIG_COMPILE_TEST option is enabled.
    
    Signed-off-by: Javier Martinez Canillas <javierm@redhat.com>
    Acked-by: Thomas Zimmermann <tzimmermann@suse.de>
    Link: https://patchwork.freedesktop.org/patch/msgid/20211216210936.3329977-1-javierm@redhat.com
    Stable-dep-of: d8a79c030549 ("drm/hisilicon: Add depends on MMU")
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit 9101e54c95cfad1008cff6fd5a6c3b4f18c6fb4a
Author: Randy Dunlap <rdunlap@infradead.org>
Date:   Mon May 30 19:55:57 2022 -0700

    drm/hisilicon: Add depends on MMU
    
    [ Upstream commit d8a79c03054911c375a2252627a429c9bc4615b6 ]
    
    The Kconfig symbol depended on MMU but was dropped by the commit
    acad3fe650a5 ("drm/hisilicon: Removed the dependency on the mmu")
    because it already had as a dependency ARM64 that already selects MMU.
    
    But later, commit a0f25a6bb319 ("drm/hisilicon/hibmc: Allow to be built
    if COMPILE_TEST is enabled") allowed the driver to be built for non-ARM64
    when COMPILE_TEST is set but that could lead to unmet direct dependencies
    and linking errors.
    
    Prevent a kconfig warning when MMU is not enabled by making
    DRM_HISI_HIBMC depend on MMU.
    
    WARNING: unmet direct dependencies detected for DRM_TTM
      Depends on [n]: HAS_IOMEM [=y] && DRM [=m] && MMU [=n]
      Selected by [m]:
      - DRM_TTM_HELPER [=m] && HAS_IOMEM [=y] && DRM [=m]
      - DRM_HISI_HIBMC [=m] && HAS_IOMEM [=y] && DRM [=m] && PCI [=y] && (ARM64 || COMPILE_TEST [=y])
    
    Fixes: acad3fe650a5 ("drm/hisilicon: Removed the dependency on the mmu")
    Signed-off-by: Randy Dunlap <rdunlap@infradead.org>
    Cc: Gerd Hoffmann <kraxel@redhat.com>
    Cc: Thomas Zimmermann <tzimmermann@suse.de>
    Cc: Xinliang Liu <xinliang.liu@linaro.org>
    Cc: Tian Tao  <tiantao6@hisilicon.com>
    Cc: John Stultz <jstultz@google.com>
    Cc: Xinwei Kong <kong.kongxinwei@hisilicon.com>
    Cc: Chen Feng <puck.chen@hisilicon.com>
    Cc: Christian Koenig <christian.koenig@amd.com>
    Cc: Huang Rui <ray.huang@amd.com>
    Cc: David Airlie <airlied@linux.ie>
    Cc: Daniel Vetter <daniel@ffwll.ch>
    Reviewed-by: Javier Martinez Canillas <javierm@redhat.com>
    Signed-off-by: Javier Martinez Canillas <javierm@redhat.com>
    Link: https://patchwork.freedesktop.org/patch/msgid/20220531025557.29593-1-rdunlap@infradead.org
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit bac7328fc0d7b30b80f85e8cc64e5c26044f48a7
Author: Javier Martinez Canillas <javierm@redhat.com>
Date:   Thu Dec 16 22:09:36 2021 +0100

    drm/hisilicon/hibmc: Allow to be built if COMPILE_TEST is enabled
    
    [ Upstream commit a0f25a6bb319aa05e04dcf51707c97c2881b4f47 ]
    
    The commit feeb07d0ca5a ("drm/hisilicon/hibmc: Make CONFIG_DRM_HISI_HIBMC
    depend on ARM64") made the driver Kconfig symbol to depend on ARM64 since
    it only supports that architecture and loading the module on others would
    lead to incorrect video modes being used.
    
    But it also prevented the driver to be built on other architectures which
    is useful to have compile test coverage when doing subsystem wide changes.
    
    Make the dependency instead to be (ARM64 || COMPILE_TEST), so the driver
    is buildable when the CONFIG_COMPILE_TEST option is enabled.
    
    Signed-off-by: Javier Martinez Canillas <javierm@redhat.com>
    Acked-by: Thomas Zimmermann <tzimmermann@suse.de>
    Link: https://patchwork.freedesktop.org/patch/msgid/20211216210936.3329977-1-javierm@redhat.com
    Stable-dep-of: d8a79c030549 ("drm/hisilicon: Add depends on MMU")
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit e7fafef9830c4a01e60f76e3860a9bef0262378d
Author: Suganath Prabu S <suganath-prabu.subramani@broadcom.com>
Date:   Fri Mar 5 15:58:58 2021 +0530

    scsi: mpt3sas: Force PCIe scatterlist allocations to be within same 4 GB region
    
    [ Upstream commit d6adc251dd2fede6aaaf6c39f7e4ad799eda3758 ]
    
    According to the MPI specification, PCIe SGL buffers can not cross a 4 GB
    boundary.
    
    While allocating, if any buffer crosses the 4 GB boundary, then:
    
     - Release the already allocated memory pools; and
    
     - Reallocate them by changing the DMA coherent mask to 32-bit
    
    Link: https://lore.kernel.org/r/20210305102904.7560-2-suganath-prabu.subramani@broadcom.com
    Signed-off-by: Suganath Prabu S <suganath-prabu.subramani@broadcom.com>
    Signed-off-by: Martin K. Petersen <martin.petersen@oracle.com>
    Stable-dep-of: e0e0747de0ea ("scsi: mpt3sas: Fix return value check of dma_get_required_mask()")
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit 4d73b97b8dbaf09af6e5878ce3288ba93956a3fd
Author: Ren Zhijie <renzhijie2@huawei.com>
Date:   Mon Sep 26 07:40:42 2022 +0000

    ASoC: codecs: wcd934x: Fix Kconfig dependency
    
    If CONFIG_REGMAP_SLIMBUS is not set,
    make ARCH=x86_64 CROSS_COMPILE=x86_64-linux-gnu-,
    will be failed, like this:
    
    sound/soc/codecs/wcd934x.o: In function `wcd934x_codec_probe':
    wcd934x.c:(.text+0x3310): undefined reference to `__regmap_init_slimbus'
    make: *** [vmlinux] Error 1
    
    Add select REGMAP_SLIMBUS to config SND_SOC_WCD934X.
    
    Fixes: a61f3b4f476e ("ASoC: wcd934x: add support to wcd9340/wcd9341 codec")
    Signed-off-by: Ren Zhijie <renzhijie2@huawei.com>
    Reviewed-by: Krzysztof Kozlowski <krzysztof.kozlowski@linaro.org>
    Link: https://lore.kernel.org/r/20220926074042.13297-1-renzhijie2@huawei.com
    Signed-off-by: Mark Brown <broonie@kernel.org>

commit 1e6989a3357c85ddc1c691eaf872ccd2e21f5a10
Author: Randy Dunlap <rdunlap@infradead.org>
Date:   Wed Aug 31 17:08:21 2022 -0700

    ARM: sunplus: fix serial console kconfig and build problems
    
    Fix kconfig dependency warnings and subsequent build errors:
    
    WARNING: unmet direct dependencies detected for SERIAL_SUNPLUS
      Depends on [n]: TTY [=n] && HAS_IOMEM [=y] && (ARCH_SUNPLUS [=y] || COMPILE_TEST [=n])
      Selected by [y]:
      - SOC_SP7021 [=y] && ARCH_SUNPLUS [=y]
    
    WARNING: unmet direct dependencies detected for SERIAL_SUNPLUS_CONSOLE
      Depends on [n]: TTY [=n] && HAS_IOMEM [=y] && SERIAL_SUNPLUS [=y]
      Selected by [y]:
      - SOC_SP7021 [=y] && ARCH_SUNPLUS [=y]
    
    (samples, not all:)
    drivers/tty/serial/sunplus-uart.c:342: undefined reference to `uart_get_baud_rate'
    arm-linux-gnueabi-ld: drivers/tty/serial/sunplus-uart.c:379: undefined reference to `uart_update_timeout'
    drivers/tty/serial/sunplus-uart.c:526: undefined reference to `uart_console_write'
    arm-linux-gnueabi-ld: drivers/tty/serial/sunplus-uart.c:274: undefined reference to `tty_flip_buffer_push'
    arm-linux-gnueabi-ld: drivers/tty/serial/sunplus-uart.o:(.data+0xa8): undefined reference to `uart_console_device'
    drivers/tty/serial/sunplus-uart.c:720: undefined reference to `uart_register_driver'
    arm-linux-gnueabi-ld: drivers/tty/serial/sunplus-uart.c:726: undefined reference to `uart_unregister_driver'
    drivers/tty/serial/sunplus-uart.c:551: undefined reference to `uart_parse_options'
    arm-linux-gnueabi-ld: drivers/tty/serial/sunplus-uart.c:553: undefined reference to `uart_set_options'
    
    This is the same technique that is used 2 times in
    arch/arm/mach-versatile/Kconfig.
    
    Fixes: 0aa94eea8d95 ("ARM: sunplus: Add initial support for Sunplus SP7021 SoC")
    Reported-by: kernel test robot <lkp@intel.com>
    Signed-off-by: Randy Dunlap <rdunlap@infradead.org>
    Cc: Qin Jian <qinjian@cqplus1.com>
    Cc: Necip Fazil Yildiran <fazilyildiran@gmail.com>
    Cc: Arnd Bergmann <arnd@arndb.de>
    Cc: linux-arm-kernel@lists.infradead.org
    Cc: patches@armlinux.org.uk
    Signed-off-by: Arnd Bergmann <arnd@arndb.de>

commit 309e9f4a17cf76e730c3101ecb5addfd93368556
Author: Helge Deller <deller@gmx.de>
Date:   Tue Sep 13 08:51:10 2022 +0200

    parisc: Allow CONFIG_64BIT with ARCH=parisc
    
    commit 805ce8614958c925877ba6b6dc26cdf9f8800474 upstream.
    
    The previous patch triggered a build failure for the debian kernel,
    which has CONFIG_64BIT enabled, uses the CROSS_COMPILER environment
    variable and uses ARCH=parisc to configure the kernel for 64-bit
    support.
    
    This patch weakens the previous patch while keeping the recommended way
    to configure the kernel with:
        ARCH=parisc     -> build 32-bit kernel
        ARCH=parisc64   -> build 64-bit kernel
    while adding the possibility for debian to configure a 64-bit kernel
    even if ARCH=parisc is set (PA8X00 CPU has to be selected and
    CONFIG_64BIT needs to be enabled).
    
    The downside of this patch is, that we now have a small window open
    again where people may get it wrong: if they enable CONFIG_64BIT and try
    to compile with a 32-bit compiler.
    
    Fixes: 3dcfb729b5f4 ("parisc: Make CONFIG_64BIT available for ARCH=parisc64 only")
    Signed-off-by: Helge Deller <deller@gmx.de>
    Cc: <stable@vger.kernel.org> # 5.15+
    Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>

commit ac12a96d1d3535e94f6af0fd0f2d4f9d8be4c71d
Author: Helge Deller <deller@gmx.de>
Date:   Tue Sep 13 08:51:10 2022 +0200

    parisc: Allow CONFIG_64BIT with ARCH=parisc
    
    commit 805ce8614958c925877ba6b6dc26cdf9f8800474 upstream.
    
    The previous patch triggered a build failure for the debian kernel,
    which has CONFIG_64BIT enabled, uses the CROSS_COMPILER environment
    variable and uses ARCH=parisc to configure the kernel for 64-bit
    support.
    
    This patch weakens the previous patch while keeping the recommended way
    to configure the kernel with:
        ARCH=parisc     -> build 32-bit kernel
        ARCH=parisc64   -> build 64-bit kernel
    while adding the possibility for debian to configure a 64-bit kernel
    even if ARCH=parisc is set (PA8X00 CPU has to be selected and
    CONFIG_64BIT needs to be enabled).
    
    The downside of this patch is, that we now have a small window open
    again where people may get it wrong: if they enable CONFIG_64BIT and try
    to compile with a 32-bit compiler.
    
    Fixes: 3dcfb729b5f4 ("parisc: Make CONFIG_64BIT available for ARCH=parisc64 only")
    Signed-off-by: Helge Deller <deller@gmx.de>
    Cc: <stable@vger.kernel.org> # 5.15+
    Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>

commit 54b9a2bb6c013a34cfdb5a6241367b003773662f
Author: Ren Zhijie <renzhijie2@huawei.com>
Date:   Mon Sep 19 10:58:40 2022 +0800

    octeontx2-pf: Fix unused variable build error
    
    If CONFIG_DCB is not set,
    make ARCH=x86_64 CROSS_COMPILE=x86_64-linux-gnu-,
    will be failed, like this:
    
    drivers/net/ethernet/marvell/octeontx2/nic/otx2_pf.c: In function otx2_select_queue:
    drivers/net/ethernet/marvell/octeontx2/nic/otx2_pf.c:1886:19: error: unused variable pf [-Werror=unused-variable]
      struct otx2_nic *pf = netdev_priv(netdev);
                       ^~
    cc1: all warnings being treated as errors
    
    To fix this build error, put the definition of *pf under the CONFIG_DCB.
    
    Fixes: 99c969a83d82 ("octeontx2-pf: Add egress PFC support")
    Signed-off-by: Ren Zhijie <renzhijie2@huawei.com>
    Link: https://lore.kernel.org/r/20220919025840.256411-1-renzhijie2@huawei.com
    Signed-off-by: Jakub Kicinski <kuba@kernel.org>

commit d8a79c03054911c375a2252627a429c9bc4615b6
Author: Randy Dunlap <rdunlap@infradead.org>
Date:   Mon May 30 19:55:57 2022 -0700

    drm/hisilicon: Add depends on MMU
    
    The Kconfig symbol depended on MMU but was dropped by the commit
    acad3fe650a5 ("drm/hisilicon: Removed the dependency on the mmu")
    because it already had as a dependency ARM64 that already selects MMU.
    
    But later, commit a0f25a6bb319 ("drm/hisilicon/hibmc: Allow to be built
    if COMPILE_TEST is enabled") allowed the driver to be built for non-ARM64
    when COMPILE_TEST is set but that could lead to unmet direct dependencies
    and linking errors.
    
    Prevent a kconfig warning when MMU is not enabled by making
    DRM_HISI_HIBMC depend on MMU.
    
    WARNING: unmet direct dependencies detected for DRM_TTM
      Depends on [n]: HAS_IOMEM [=y] && DRM [=m] && MMU [=n]
      Selected by [m]:
      - DRM_TTM_HELPER [=m] && HAS_IOMEM [=y] && DRM [=m]
      - DRM_HISI_HIBMC [=m] && HAS_IOMEM [=y] && DRM [=m] && PCI [=y] && (ARM64 || COMPILE_TEST [=y])
    
    Fixes: acad3fe650a5 ("drm/hisilicon: Removed the dependency on the mmu")
    Signed-off-by: Randy Dunlap <rdunlap@infradead.org>
    Cc: Gerd Hoffmann <kraxel@redhat.com>
    Cc: Thomas Zimmermann <tzimmermann@suse.de>
    Cc: Xinliang Liu <xinliang.liu@linaro.org>
    Cc: Tian Tao  <tiantao6@hisilicon.com>
    Cc: John Stultz <jstultz@google.com>
    Cc: Xinwei Kong <kong.kongxinwei@hisilicon.com>
    Cc: Chen Feng <puck.chen@hisilicon.com>
    Cc: Christian Koenig <christian.koenig@amd.com>
    Cc: Huang Rui <ray.huang@amd.com>
    Cc: David Airlie <airlied@linux.ie>
    Cc: Daniel Vetter <daniel@ffwll.ch>
    Reviewed-by: Javier Martinez Canillas <javierm@redhat.com>
    Signed-off-by: Javier Martinez Canillas <javierm@redhat.com>
    Link: https://patchwork.freedesktop.org/patch/msgid/20220531025557.29593-1-rdunlap@infradead.org

commit ecf8322f464d62759d838ea62cdeff6966a60134
Author: Damien Le Moal <damien.lemoal@opensource.wdc.com>
Date:   Tue Sep 20 08:52:02 2022 +0900

    ata: ahci_st: Enable compile test
    
    Enable compiling the ahci_st driver when COMPILE_TEST is enabled.
    
    Signed-off-by: Damien Le Moal <damien.lemoal@opensource.wdc.com>

commit a113c02f57388fc4d179ac5580303d97a000ede7
Author: Dan Carpenter <dan.carpenter@oracle.com>
Date:   Thu Sep 15 14:10:30 2022 +0300

    scsi: mpi3mr: Fix error codes in mpi3mr_report_manufacture()
    
    There are three error paths which return success:
    
    1) Propagate the error code from mpi3mr_post_transport_req() if it fails.
    
    2) Return -EINVAL if "ioc_status != MPI3_IOCSTATUS_SUCCESS".
    
    3) Return -EINVAL if "le16_to_cpu(mpi_reply.response_data_length) !=
       sizeof(struct rep_manu_reply)"
    
    Link: https://lore.kernel.org/r/YyMIJh1HU2Qz9+Rs@kili
    Fixes: 2bd37e284914 ("scsi: mpi3mr: Add framework to issue MPT transport cmds")
    Acked-by: Sathya Prakash Veerichetty <sathya.prakash@broadcom.com>
    Signed-off-by: Dan Carpenter <dan.carpenter@oracle.com>
    Signed-off-by: Martin K. Petersen <martin.petersen@oracle.com>

commit 805ce8614958c925877ba6b6dc26cdf9f8800474
Author: Helge Deller <deller@gmx.de>
Date:   Tue Sep 13 08:51:10 2022 +0200

    parisc: Allow CONFIG_64BIT with ARCH=parisc
    
    The previous patch triggered a build failure for the debian kernel,
    which has CONFIG_64BIT enabled, uses the CROSS_COMPILER environment
    variable and uses ARCH=parisc to configure the kernel for 64-bit
    support.
    
    This patch weakens the previous patch while keeping the recommended way
    to configure the kernel with:
        ARCH=parisc     -> build 32-bit kernel
        ARCH=parisc64   -> build 64-bit kernel
    while adding the possibility for debian to configure a 64-bit kernel
    even if ARCH=parisc is set (PA8X00 CPU has to be selected and
    CONFIG_64BIT needs to be enabled).
    
    The downside of this patch is, that we now have a small window open
    again where people may get it wrong: if they enable CONFIG_64BIT and try
    to compile with a 32-bit compiler.
    
    Fixes: 3dcfb729b5f4 ("parisc: Make CONFIG_64BIT available for ARCH=parisc64 only")
    Signed-off-by: Helge Deller <deller@gmx.de>
    Cc: <stable@vger.kernel.org> # 5.15+

commit 84dd3b2b95ef8a33a0c2d7c2c21d4d5edb9f7f08
Author: Jean Delvare <jdelvare@suse.de>
Date:   Wed Aug 3 22:34:48 2022 +0200

    dmaengine: dw-axi-dmac: Drop obsolete dependency on COMPILE_TEST
    
    Since commit 0166dc11be91 ("of: make CONFIG_OF user selectable"), it
    is possible to test-build any driver which depends on OF on any
    architecture by explicitly selecting OF. Therefore depending on
    COMPILE_TEST as an alternative is no longer needed.
    
    It is actually better to always build such drivers with OF enabled,
    so that the test builds are closer to how each driver will actually be
    built on its intended target. Building them without OF may not test
    much as the compiler will optimize out potentially large parts of the
    code. In the worst case, this could even pop false positive warnings.
    Dropping COMPILE_TEST here improves the quality of our testing and
    avoids wasting time on non-existent issues.
    
    Signed-off-by: Jean Delvare <jdelvare@suse.de>
    Cc: Eugeniy Paltsev <Eugeniy.Paltsev@synopsys.com>
    Cc: Vinod Koul <vkoul@kernel.org>
    Link: https://lore.kernel.org/r/20220803223448.6f08095b@endymion.delvare
    Signed-off-by: Vinod Koul <vkoul@kernel.org>

commit 5134272f9f3f71d4e1f3aa15cb09321af49b3646
Author: Qingtao Cao <qingtao.cao.au@gmail.com>
Date:   Fri Sep 2 16:14:34 2022 +1000

    gpio: exar: access MPIO registers on cascaded chips
    
    When EXAR xr17v35x chips are cascaded in order to access the MPIO registers
    (part of the Device Configuration Registers) of the secondary chips, an offset
    needs to be applied based on the number of primary chip's UART channels.
    
    Signed-off-by: Qingtao Cao <qingtao.cao@digi.com>
    Reviewed-by: Andy Shevchenko <andy.shevchenko@gmail.com>
    Signed-off-by: Bartosz Golaszewski <brgl@bgdev.pl>

commit 7d2497b7fd3bf45706360bfe289f19d61d37f536
Author: Martin Povier <povik+lin@cutebit.org>
Date:   Thu Sep 1 13:34:14 2022 +0200

    ASoC: apple: mca: Unselect COMMON_CLK in Kconfig
    
    The MCA driver selects COMMON_CLK, which leads to misconfiguration
    on platforms with HAVE_LEGACY_CLK (under compile test). Kconfig catches
    the conflict with the following warning:
    
      WARNING: unmet direct dependencies detected for COMMON_CLK
      Depends on [n]: !HAVE_LEGACY_CLK [=y]
      Selected by [m]:
      - SND_SOC_APPLE_MCA [=m] && SOUND [=m] && !UML && SND [=m] &&
        SND_SOC [=m] && (ARCH_APPLE || COMPILE_TEST [=y])
    
    Eventually the build fails with errors like:
    
    >> drivers/clk/clk.c:867:6: error: redefinition of 'clk_unprepare'
         867 | void clk_unprepare(struct clk *clk)
             |      ^~~~~~~~~~~~~
       In file included from drivers/clk/clk.c:9:
       include/linux/clk.h:303:20: note: previous definition of 'clk_unprepare' with type 'void(struct clk *)'
         303 | static inline void clk_unprepare(struct clk *clk)
             |                    ^~~~~~~~~~~~~
    
    which appears to be because COMMON_CLK is selected but HAVE_CLK_PREPARE
    is not. In the end it seems we had no business selecting COMMON_CLK from
    an unrelated driver like that, so remove the selection. The linux/clk.h
    API is there anyway.
    
    Fixes: 3df5d0d97289 ("ASoC: apple: mca: Start new platform driver")
    Reported-by: kernel test robot <lkp@intel.com>
    Signed-off-by: Martin Povier <povik+lin@cutebit.org>
    Link: https://lore.kernel.org/r/20220901113415.27449-1-povik+lin@cutebit.org
    Signed-off-by: Mark Brown <broonie@kernel.org>

commit f45fadde91ec892fdc453e3df9469e9457152526
Author: Bradley Grove <bgrove@attotech.com>
Date:   Fri Aug 5 13:46:09 2022 -0400

    scsi: mpt3sas: Disable MPI2_FUNCTION_FW_DOWNLOAD for ATTO devices
    
    Disable firmware download for ATTO devices where it is not supported.
    
    Link: https://lore.kernel.org/r/20220805174609.14830-2-bgrove@attotech.com
    Co-developed-by: Rob Crispo <rcrispo@attotech.com>
    Signed-off-by: Rob Crispo <rcrispo@attotech.com>
    Signed-off-by: Bradley Grove <bgrove@attotech.com>
    Signed-off-by: Martin K. Petersen <martin.petersen@oracle.com>

commit 5204e836544763cb085e653c82d4da77a427591a
Author: Krzysztof Kozlowski <krzysztof.kozlowski@linaro.org>
Date:   Tue Aug 30 10:58:55 2022 +0300

    ASoC: codecs: rk817: fix missing I2C dependency in compile test
    
    SND_SOC_RK817 uses I2C regmap so compile testing without parent MFD_RK808, requires I2C:
    
      WARNING: unmet direct dependencies detected for REGMAP_I2C
        Depends on [n]: I2C [=n]
        Selected by [y]:
        - SND_SOC_RK817 [=y] && SOUND [=y] && !UML && SND [=y] && SND_SOC [=y] && (MFD_RK808 [=n] || COMPILE_TEST [=y])
    
    Reported-by: kernel test robot <lkp@intel.com>
    Fixes: 5b7f4e5de61b ("ASoC: codecs: allow compile testing without MFD drivers")
    Signed-off-by: Krzysztof Kozlowski <krzysztof.kozlowski@linaro.org>
    Link: https://lore.kernel.org/r/20220830075855.278046-1-krzysztof.kozlowski@linaro.org
    Signed-off-by: Mark Brown <broonie@kernel.org>

commit 5530acc8b9bfcfa5f90909b940be39a84c350033
Author: Robert Elliott <elliott@hpe.com>
Date:   Sat Aug 20 13:41:40 2022 -0500

    crypto: Kconfig - remove AES_ARM64 ref by SA2UL
    
    Remove the CRYPTO_AES_ARM64 selection by the TI security
    accelerator driver (SA2UL), which leads to this problem when
    running make allmodconfig for arm (32-bit):
    
    WARNING: unmet direct dependencies detected for CRYPTO_AES_ARM64
      Depends on [n]: CRYPTO [=y] && ARM64
      Selected by [m]:
      - CRYPTO_DEV_SA2UL [=m] && CRYPTO [=y] && CRYPTO_HW [=y] && (ARCH_K3
        || COMPILE_TEST [=y])
    
    Fixes: 7694b6ca649fe ("crypto: sa2ul - Add crypto driver")
    Signed-off-by: Robert Elliott <elliott@hpe.com>
    Signed-off-by: Herbert Xu <herbert@gondor.apana.org.au>

commit 7c12bb8f59d36507bf70c35dae083dfe9cafc815
Author: Huacai Chen <chenhuacai@loongson.cn>
Date:   Thu Aug 25 19:34:59 2022 +0800

    LoongArch: Select PCI_QUIRKS to avoid build error
    
    PCI_LOONGSON is a mandatory for LoongArch and it is selected in Kconfig
    unconditionally, but its dependency PCI_QUIRKS is missing and may cause
    a build error when "make randconfig":
    
       arch/loongarch/pci/acpi.c: In function 'pci_acpi_setup_ecam_mapping':
    >> arch/loongarch/pci/acpi.c:103:29: error: 'loongson_pci_ecam_ops' undeclared (first use in this function)
         103 |                 ecam_ops = &loongson_pci_ecam_ops;
             |                             ^~~~~~~~~~~~~~~~~~~~~
       arch/loongarch/pci/acpi.c:103:29: note: each undeclared identifier is reported only once for each function it appears in
    
    Kconfig warnings: (for reference only)
       WARNING: unmet direct dependencies detected for PCI_LOONGSON
       Depends on [n]: PCI [=y] && (MACH_LOONGSON64 [=y] || COMPILE_TEST [=y]) && (OF [=y] || ACPI [=y]) && PCI_QUIRKS [=n]
       Selected by [y]:
       - LOONGARCH [=y]
    
    Fix it by selecting PCI_QUIRKS unconditionally, too.
    
    Reported-by: kernel test robot <lkp@intel.com>
    Tested-by: Randy Dunlap <rdunlap@infradead.org>
    Signed-off-by: Huacai Chen <chenhuacai@loongson.cn>

commit 127e3bb0dae18d7c688b23bffd67248e787f37d9
Author: Ren Zhijie <renzhijie2@huawei.com>
Date:   Sun Jun 19 19:54:32 2022 +0800

    scsi: ufs: ufs-mediatek: Fix build error and type mismatch
    
    commit f54912b228a8df6c0133e31bc75628677bb8c6e5 upstream.
    
    If CONFIG_PM_SLEEP is not set.
    
    make ARCH=arm64 CROSS_COMPILE=aarch64-linux-gnu-, will fail:
    
    drivers/ufs/host/ufs-mediatek.c: In function ufs_mtk_vreg_fix_vcc:
    drivers/ufs/host/ufs-mediatek.c:688:46: warning: format %u expects argument of type unsigned int, but argument 4 has type long unsigned int [-Wformat=]
        snprintf(vcc_name, MAX_VCC_NAME, "vcc-opt%u", res.a1);
                                                 ~^   ~~~~~~
                                                 %lu
    drivers/ufs/host/ufs-mediatek.c: In function ufs_mtk_system_suspend:
    drivers/ufs/host/ufs-mediatek.c:1371:8: error: implicit declaration of function ufshcd_system_suspend; did you mean ufs_mtk_system_suspend? [-Werror=implicit-function-declaration]
      ret = ufshcd_system_suspend(dev);
            ^~~~~~~~~~~~~~~~~~~~~
            ufs_mtk_system_suspend
    drivers/ufs/host/ufs-mediatek.c: In function ufs_mtk_system_resume:
    drivers/ufs/host/ufs-mediatek.c:1386:9: error: implicit declaration of function ufshcd_system_resume; did you mean ufs_mtk_system_resume? [-Werror=implicit-function-declaration]
      return ufshcd_system_resume(dev);
             ^~~~~~~~~~~~~~~~~~~~
             ufs_mtk_system_resume
    cc1: some warnings being treated as errors
    
    The declaration of func "ufshcd_system_suspend()" depends on
    CONFIG_PM_SLEEP, so the function wrapper ufs_mtk_system_suspend() should
    wrapped by CONFIG_PM_SLEEP too.
    
    Link: https://lore.kernel.org/r/20220619115432.205504-1-renzhijie2@huawei.com
    Fixes: 3fd23b8dfb54 ("scsi: ufs: ufs-mediatek: Fix the timing of configuring device regulators")
    Reported-by: Hulk Robot <hulkci@huawei.com>
    Reviewed-by: Stanley Chu <stanley.chu@mediatek.com>
    Signed-off-by: Ren Zhijie <renzhijie2@huawei.com>
    Signed-off-by: Martin K. Petersen <martin.petersen@oracle.com>
    [only take the suspend/resume portion of the commit - gregkh]
    Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>

commit d66d392c72a69b90a2303cca0b49b72d06048933
Author: Ren Zhijie <renzhijie2@huawei.com>
Date:   Sun Jun 19 19:54:32 2022 +0800

    scsi: ufs: ufs-mediatek: Fix build error and type mismatch
    
    commit f54912b228a8df6c0133e31bc75628677bb8c6e5 upstream.
    
    If CONFIG_PM_SLEEP is not set.
    
    make ARCH=arm64 CROSS_COMPILE=aarch64-linux-gnu-, will fail:
    
    drivers/ufs/host/ufs-mediatek.c: In function ufs_mtk_vreg_fix_vcc:
    drivers/ufs/host/ufs-mediatek.c:688:46: warning: format %u expects argument of type unsigned int, but argument 4 has type long unsigned int [-Wformat=]
        snprintf(vcc_name, MAX_VCC_NAME, "vcc-opt%u", res.a1);
                                                 ~^   ~~~~~~
                                                 %lu
    drivers/ufs/host/ufs-mediatek.c: In function ufs_mtk_system_suspend:
    drivers/ufs/host/ufs-mediatek.c:1371:8: error: implicit declaration of function ufshcd_system_suspend; did you mean ufs_mtk_system_suspend? [-Werror=implicit-function-declaration]
      ret = ufshcd_system_suspend(dev);
            ^~~~~~~~~~~~~~~~~~~~~
            ufs_mtk_system_suspend
    drivers/ufs/host/ufs-mediatek.c: In function ufs_mtk_system_resume:
    drivers/ufs/host/ufs-mediatek.c:1386:9: error: implicit declaration of function ufshcd_system_resume; did you mean ufs_mtk_system_resume? [-Werror=implicit-function-declaration]
      return ufshcd_system_resume(dev);
             ^~~~~~~~~~~~~~~~~~~~
             ufs_mtk_system_resume
    cc1: some warnings being treated as errors
    
    The declaration of func "ufshcd_system_suspend()" depends on
    CONFIG_PM_SLEEP, so the function wrapper ufs_mtk_system_suspend() should
    wrapped by CONFIG_PM_SLEEP too.
    
    Link: https://lore.kernel.org/r/20220619115432.205504-1-renzhijie2@huawei.com
    Fixes: 3fd23b8dfb54 ("scsi: ufs: ufs-mediatek: Fix the timing of configuring device regulators")
    Reported-by: Hulk Robot <hulkci@huawei.com>
    Reviewed-by: Stanley Chu <stanley.chu@mediatek.com>
    Signed-off-by: Ren Zhijie <renzhijie2@huawei.com>
    Signed-off-by: Martin K. Petersen <martin.petersen@oracle.com>
    [only take the suspend/resume portion of the commit - gregkh]
    Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>

commit 874765c9251f602ccc43b05d05b2e0525c1f7d21
Author: Jean Delvare <jdelvare@suse.de>
Date:   Thu Aug 4 13:45:45 2022 +0200

    i2c: muxes: Drop obsolete dependency on COMPILE_TEST
    
    Since commit 0166dc11be91 ("of: make CONFIG_OF user selectable"), it
    is possible to test-build any driver which depends on OF on any
    architecture by explicitly selecting OF. Therefore depending on
    COMPILE_TEST as an alternative is no longer needed.
    
    It is actually better to always build such drivers with OF enabled,
    so that the test builds are closer to how each driver will actually be
    built on its intended target. Building them without OF may not test
    much as the compiler will optimize out potentially large parts of the
    code. In the worst case, this could even pop false positive warnings.
    Dropping COMPILE_TEST here improves the quality of our testing and
    avoids wasting time on non-existent issues.
    
    Signed-off-by: Jean Delvare <jdelvare@suse.de>
    Acked-by: Peter Rosin <peda@axentia.se>
    Signed-off-by: Wolfram Sang <wsa@kernel.org>

commit 56fae4304c8eea2dfb9037ded1aa774acb110d69
Author: Jean Delvare <jdelvare@suse.de>
Date:   Wed Aug 3 22:47:55 2022 +0200

    crypto: keembay-ocs - Drop obsolete dependency on COMPILE_TEST
    
    Since commit 0166dc11be91 ("of: make CONFIG_OF user selectable"), it
    is possible to test-build any driver which depends on OF on any
    architecture by explicitly selecting OF. Therefore depending on
    COMPILE_TEST as an alternative is no longer needed.
    
    It is actually better to always build such drivers with OF enabled,
    so that the test builds are closer to how each driver will actually be
    built on its intended target. Building them without OF may not test
    much as the compiler will optimize out potentially large parts of the
    code. In the worst case, this could even pop false positive warnings.
    Dropping COMPILE_TEST here improves the quality of our testing and
    avoids wasting time on non-existent issues.
    
    Signed-off-by: Jean Delvare <jdelvare@suse.de>
    Cc: Declan Murphy <declan.murphy@intel.com>
    Cc: Daniele Alessandrelli <daniele.alessandrelli@intel.com>
    Cc: Mark Gross <mgross@linux.intel.com>
    Cc: Herbert Xu <herbert@gondor.apana.org.au>
    Cc: Prabhjot Khurana <prabhjot.khurana@intel.com>
    Cc: "David S. Miller" <davem@davemloft.net>
    Signed-off-by: Herbert Xu <herbert@gondor.apana.org.au>

commit 789f3fa9dca071c95350583c34a70afec8afc51d
Merge: 568035b01cfb fbd92809997a
Author: Palmer Dabbelt <palmer@rivosinc.com>
Date:   Thu Aug 18 13:40:51 2022 -0700

    Merge tag 'riscv-topo-on-6.0-rc1' of https://git.kernel.org/pub/scm/linux/kernel/git/conor/linux.git/ into for-next
    
    Fix RISC-V's topology reporting
    
    The goal here is the fix the incorrectly reported arch topology on
    RISC-V which seems to have been broken since it was added.
    cpu, package and thread IDs are all currently reported as -1, so tools
    like lstopo think systems have multiple threads on the same core when
    this is not true:
    https://github.com/open-mpi/hwloc/issues/536
    
    arm64's topology code basically applies to RISC-V too, so it has been
    made generic along with the removal of MPIDR related code, which
    appears to be redudant code since '3102bc0e6ac7 ("arm64: topology: Stop
    using MPIDR for topology information")' replaced the code that actually
    interacted with MPIDR with default values.
    
    * tag 'riscv-topo-on-6.0-rc1' of https://git.kernel.org/pub/scm/linux/kernel/git/conor/linux.git/:
      riscv: topology: fix default topology reporting
      arm64: topology: move store_cpu_topology() to shared code

commit 49a407af0c52d760b34579e50a63aa85134c90ee
Author: Amadeusz Sawiski <amadeuszx.slawinski@linux.intel.com>
Date:   Fri Jul 22 13:19:59 2022 +0200

    ASoC: Intel: avs: Use lookup table to create modules
    
    commit 1e744351bcb9c4cee81300de5a6097100d835386 upstream.
    
    As reported by Nathan, when building avs driver using clang with:
      CONFIG_COMPILE_TEST=y
      CONFIG_FORTIFY_SOURCE=y
      CONFIG_KASAN=y
      CONFIG_PCI=y
      CONFIG_SOUND=y
      CONFIG_SND=y
      CONFIG_SND_SOC=y
      CONFIG_SND_SOC_INTEL_AVS=y
    
    there are reports of too big stack use, like:
      sound/soc/intel/avs/path.c:815:18: error: stack frame size (2176) exceeds limit (2048) in 'avs_path_create' [-Werror,-Wframe-larger-than]
      struct avs_path *avs_path_create(struct avs_dev *adev, u32 dma_id,
                       ^
      1 error generated.
    
    This is apparently caused by inlining many calls to guid_equal which
    inlines fortified memcpy, using 2 size_t variables.
    
    Instead of hardcoding many calls to guid_equal, use lookup table with
    one call, this improves stack usage.
    
    Link: https://lore.kernel.org/alsa-devel/YtlzY9aYdbS4Y3+l@dev-arch.thelio-3990X/T/
    Link: https://github.com/ClangBuiltLinux/linux/issues/1642
    Signed-off-by: Amadeusz Sawiski <amadeuszx.slawinski@linux.intel.com>
    Reported-by: Nathan Chancellor <nathan@kernel.org>
    Build-tested-by: Nathan Chancellor <nathan@kernel.org>
    Reviewed-by: Cezary Rojewski <cezary.rojewski@intel.com>
    Link: https://lore.kernel.org/r/20220722111959.2588597-1-amadeuszx.slawinski@linux.intel.com
    Signed-off-by: Mark Brown <broonie@kernel.org>
    Cc: Naresh Kamboju <naresh.kamboju@linaro.org>
    Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>

commit b7960089439aa7bd042b5823ea92d702341f7819
Author: YueHaibing <yuehaibing@huawei.com>
Date:   Sat Jun 11 12:16:12 2022 +0800

    drm/display: Fix build error without CONFIG_OF
    
    [ Upstream commit 876271118aa41097d035c84f99648746b4a125f3 ]
    
    While CONFIG_OF is n but COMPILE_TEST is y, we got this:
    
    WARNING: unmet direct dependencies detected for DRM_DP_AUX_BUS
      Depends on [n]: HAS_IOMEM [=y] && DRM [=y] && OF [=n]
      Selected by [y]:
      - DRM_MSM [=y] && HAS_IOMEM [=y] && DRM [=y] && (ARCH_QCOM || SOC_IMX5 || COMPILE_TEST [=y]) && COMMON_CLK [=y] && IOMMU_SUPPORT [=y] && (QCOM_OCMEM [=n] || QCOM_OCMEM [=n]=n) && (QCOM_LLCC [=y] || QCOM_LLCC [=y]=n) && (QCOM_COMMAND_DB [=n] || QCOM_COMMAND_DB [=n]=n)
    
    Make DRM_DP_AUX_BUS depends on OF || COMPILE_TEST to fix this warning.
    
    Fixes: 1e0f66420b13 ("drm/display: Introduce a DRM display-helper module")
    Signed-off-by: YueHaibing <yuehaibing@huawei.com>
    Reviewed-by: Dmitry Baryshkov <dmitry.baryshkov@linaro.org>
    Reviewed-by: Abhinav Kumar <quic_abhinavk@quicinc.com>
    Acked-by: Linus Walleij <linus.walleij@linaro.org>
    Signed-off-by: Linus Walleij <linus.walleij@linaro.org>
    Link: https://patchwork.freedesktop.org/patch/msgid/20220611041612.1976-1-yuehaibing@huawei.com
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit 456797da792fa7cbf6698febf275fe9b36691f78
Author: Conor Dooley <conor.dooley@microchip.com>
Date:   Fri Jul 15 18:51:55 2022 +0100

    arm64: topology: move store_cpu_topology() to shared code
    
    arm64's method of defining a default cpu topology requires only minimal
    changes to apply to RISC-V also. The current arm64 implementation exits
    early in a uniprocessor configuration by reading MPIDR & claiming that
    uniprocessor can rely on the default values.
    
    This is appears to be a hangover from prior to '3102bc0e6ac7 ("arm64:
    topology: Stop using MPIDR for topology information")', because the
    current code just assigns default values for multiprocessor systems.
    
    With the MPIDR references removed, store_cpu_topolgy() can be moved to
    the common arch_topology code.
    
    Reviewed-by: Sudeep Holla <sudeep.holla@arm.com>
    Acked-by: Catalin Marinas <catalin.marinas@arm.com>
    Reviewed-by: Atish Patra <atishp@rivosinc.com>
    Signed-off-by: Conor Dooley <conor.dooley@microchip.com>

commit 556a2c7dca337954040ffdf0c544aa8bbb75583b
Author: Ren Zhijie <renzhijie2@huawei.com>
Date:   Fri Jun 24 09:19:11 2022 +0800

    PCI: endpoint: Fix Kconfig dependency
    
    If CONFIG_NTB is not set and CONFIG_PCI_EPF_VNTB is y.
    
    make ARCH=x86_64 CROSS_COMPILE=x86_64-linux-gnu-, will be failed, like this:
    
    drivers/pci/endpoint/functions/pci-epf-vntb.o: In function `epf_ntb_cmd_handler':
    pci-epf-vntb.c:(.text+0x95e): undefined reference to `ntb_db_event'
    pci-epf-vntb.c:(.text+0xa1f): undefined reference to `ntb_link_event'
    pci-epf-vntb.c:(.text+0xa42): undefined reference to `ntb_link_event'
    drivers/pci/endpoint/functions/pci-epf-vntb.o: In function `pci_vntb_probe':
    pci-epf-vntb.c:(.text+0x1250): undefined reference to `ntb_register_device'
    
    The functions ntb_*() are defined in drivers/ntb/core.c, which need CONFIG_NTB setting y to be build-in.
    To fix this build error, add depends on NTB.
    
    Reported-by: Hulk Robot <hulkci@huawei.com>
    Fixes: ff32fac00d97("NTB: EPF: support NTB transfer between PCI RC and EP connection")
    Signed-off-by: Ren Zhijie <renzhijie2@huawei.com>
    Acked-by: Frank Li <frank.li@nxp.com>
    Acked-by: Randy Dunlap <rdunlap@infradead.org>
    Tested-by: Randy Dunlap <rdunlap@infradead.org> # build-tested
    Reported-by: Randy Dunlap <rdunlap@infradead.org>
    Signed-off-by: Jon Mason <jdmason@kudzu.us>

commit 033c88d58b66a5bf61a9a4f0029c4fb771f0555e
Merge: d5af75f77c52 7f0169cde0ce
Author: Linus Torvalds <torvalds@linux-foundation.org>
Date:   Mon Aug 8 14:23:37 2022 -0700

    Merge tag 'thermal-5.20-rc1-2' of git://git.kernel.org/pub/scm/linux/kernel/git/rafael/linux-pm
    
    Pull more thermal control updates from Rafael Wysocki:
     "These fix an error code path issue leading to a NULL pointer
      dereference, drop Kconfig dependencies that are not needed any more
      after recent changes, add CPU IDs for new chips to a driver and fix up
      the tmon utility.
    
      Specifics:
    
       - Fix NULL pointer dereference in the thermal sysfs interface that
         results from an error code path mishandling (Rafael Wysocki).
    
       - Drop COMPILE_TEST dependency that's not needed any more from two
         thermal Kconfig entries (Jean Delvare).
    
       - Make the Intel TCC cooling driver support Alder Lake-N and Raptor
         Lake-P (Sumeet Pawnikar).
    
       - Fix possible path truncations in the tmon utility (Florian
         Fainelli)"
    
    * tag 'thermal-5.20-rc1-2' of git://git.kernel.org/pub/scm/linux/kernel/git/rafael/linux-pm:
      tools/thermal: Fix possible path truncations
      thermal: Drop obsolete dependency on COMPILE_TEST
      thermal: sysfs: Fix cooling_device_stats_setup() error code path
      thermal: intel: Add TCC cooling support for Alder Lake-N and Raptor Lake-P

commit 7f0169cde0ced2e2b7bdf3dcedcf8c71efc6afc0
Merge: 312c1a44da37 8df4ef3eaa62 6c58cf40e3a1
Author: Rafael J. Wysocki <rafael.j.wysocki@intel.com>
Date:   Mon Aug 8 19:39:09 2022 +0200

    Merge branches 'thermal-core' and 'thermal-tools'
    
    Merge additional changes in the thermal core and thermal tools updates
    for 5.20-rc1:
    
     - Fix NULL poiter dereference in the thermal sysfs interface that
       results from an error code path mishandling (Rafael Wysocki).
    
     - Drop COMPILE_TEST dependency that's not needed any more from two
       thermal Kconfig entries (Jean Delvare).
    
     - Fix possible path truncations in the tmon utility (Florian Fainelli).
    
    * thermal-core:
      thermal: Drop obsolete dependency on COMPILE_TEST
      thermal: sysfs: Fix cooling_device_stats_setup() error code path
    
    * thermal-tools:
      tools/thermal: Fix possible path truncations

commit fad235ed4338749a66ddf32971d4042b9ef47f44
Merge: 8db4a0291b09 1630eee2d4e7
Author: Linus Torvalds <torvalds@linux-foundation.org>
Date:   Fri Aug 5 10:02:33 2022 -0700

    Merge tag 'arm-late-6.0' of git://git.kernel.org/pub/scm/linux/kernel/git/soc/soc
    
    Pull more ARM SoC updates from Arnd Bergmann:
     "These updates came in after I had already tagged the branches, but
      they still seem appropriate for 6.0 and most of them were part of
      linux-next through other trees.
    
       - The reset controller tree adds one new driver for the TI TPS380x
         power management chip and a few minor changes in other drivers
    
       - Apple M1 now has a DT entry for the NVMe controller after the
         driver was merged, and has a new mailing list in the MAINTAINERS
         file.
    
       - Fixes for USB on the Socionext Uniphier platforms and the network
         controller on Intel Cyclone5"
    
    * tag 'arm-late-6.0' of git://git.kernel.org/pub/scm/linux/kernel/git/soc/soc:
      arm64: dts: uniphier: Fix USB interrupts for PXs3 SoC
      ARM: dts: uniphier: Fix USB interrupts for PXs2 SoC
      arm64: dts: apple: t8103: Add ANS2 NVMe nodes
      reset: tps380x: Fix spelling mistake "Voltags" -> "Voltage"
      reset: tps380x: Add TPS380x device driver supprt
      dt-bindings: reset: Add TPS380x documentation
      dt-bindings: reset: renesas,rzg2l-usbphy-ctrl: Document RZ/G2UL USBPHY Control bindings
      ARM: dts: add EMAC AXI settings for Cyclone5
      reset: reset-simple should depends on HAS_IOMEM
      Revert "reset: microchip-sparx5: allow building as a module"
      reset: a10sr: allow building under COMPILE_TEST
      reset: allow building of reset simple driver if expert config selected
      reset: microchip-sparx5: allow building as a module
      arm64: dts: apple: Re-parent ANS2 power domains
      MAINTAINERS: add ARM/APPLE MACHINE mailing list

commit b44f2fd87919b5ae6e1756d4c7ba2cbba22238e1
Merge: 12b68040a5e4 5493ee1919ea
Author: Linus Torvalds <torvalds@linux-foundation.org>
Date:   Wed Aug 3 19:52:08 2022 -0700

    Merge tag 'drm-next-2022-08-03' of git://anongit.freedesktop.org/drm/drm
    
    Pull drm updates from Dave Airlie:
     "Highlights:
    
       - New driver for logicvc - which is a display IP core.
    
       - EDID parser rework to add new extensions
    
       - fbcon scrolling improvements
    
       - i915 has some more DG2 work but not enabled by default, but should
         have enough features for userspace to work now.
    
      Otherwise it's lots of work all over the place. Detailed summary:
    
      New driver:
       - logicvc
    
      vfio:
       - use aperture API
    
      core:
       - of: Add data-lane helpers and convert drivers
       - connector: Remove deprecated ida_simple_get()
    
      media:
       - Add various RGB666 and RGB888 format constants
    
      panel:
       - Add HannStar HSD101PWW
       - Add ETML0700Y5DHA
    
      dma-buf:
       - add sync-file API
       - set dma mask for udmabuf devices
    
      fbcon:
       - Improve scrolling performance
       - Sanitize input
    
      fbdev:
       - device unregistering fixes
       - vesa: Support COMPILE_TEST
       - Disable firmware-device registration when first native driver loads
    
      aperture:
       - fix segfault during hot-unplug
       - export for use with other subsystems
    
      client:
       - use driver validated modes
    
      dp:
       - aux: make probing more reliable
       - mst: Read extended DPCD capabilities during system resume
       - Support waiting for HDP signal
       - Port-validation fixes
    
      edid:
       - CEA data-block iterators
       - struct drm_edid introduction
       - implement HF-EEODB extension
    
      gem:
       - don't use fb format non-existing planes
    
      probe-helper:
       - use 640x480 as displayport fallback
    
      scheduler:
       - don't kill jobs in interrupt context
    
      bridge:
       - Add support for i.MX8qxp and i.MX8qm
       - lots of fixes/cleanups
       - Add TI-DLPC3433
       - fy07024di26a30d: Optional GPIO reset
       - ldb: Add reg and reg-name properties to bindings, Kconfig fixes
       - lt9611: Fix display sensing;
       - tc358767: DSI/DPI refactoring and DSI-to-eDP support, DSI lane handling
       - tc358775: Fix clock settings
       - ti-sn65dsi83: Allow GPIO to sleep
       - adv7511: I2C fixes
       - anx7625: Fix error handling; DPI fixes; Implement HDP timeout via callback
       - fsl-ldb: Drop DE flip
       - ti-sn65dsi86: Convert to atomic modesetting
    
      amdgpu:
       - use atomic fence helpers in DM
       - fix VRAM address calculations
       - export CRTC bpc via debugfs
       - Initial devcoredump support
       - Enable high priority gfx queue on asics which support it
       - Adjust GART size on newer APUs for S/G display
       - Soft reset for GFX 11 / SDMA 6
       - Add gfxoff status query for vangogh
       - Fix timestamps for cursor only commits
       - Adjust GART size on newer APUs for S/G display
       - fix buddy memory corruption
    
      amdkfd:
       - MMU notifier fixes
       - P2P DMA support using dma-buf
       - Add available memory IOCTL
       - HMM profiler support
       - Simplify GPUVM validation
       - Unified memory for CWSR save/restore area
    
      i915:
       - General driver clean-up
       - DG2 enabling (still under force probe)
           - DG2 small BAR memory support
           - HuC loading support
           - DG2 workarounds
           - DG2/ATS-M device IDs added
       - Ponte Vecchio prep work and new blitter engines
       - add Meteorlake support
       - Fix sparse warnings
       - DMC MMIO range checks
       - Audio related fixes
       - Runtime PM fixes
       - PSR fixes
       - Media freq factor and per-gt enhancements
       - DSI fixes for ICL+
       - Disable DMC flip queue handlers
       - ADL_P voltage swing updates
       - Use more the VBT for panel information
       - Fix on Type-C ports with TBT mode
       - Improve fastset and allow seamless M/N changes
       - Accept more fixed modes with VRR/DMRRS panels
       - Disable connector polling for a headless SKU
       - ADL-S display PLL w/a
       - Enable THP on Icelake and beyond
       - Fix i915_gem_object_ggtt_pin_ww regression on old platforms
       - Expose per tile media freq factor in sysfs
       - Fix dma_resv fence handling in multi-batch execbuf
       - Improve on suspend / resume time with VT-d enabled
       - export CRTC bpc settings via debugfs
    
      msm:
       - gpu: a619 support
       - gpu: Fix for unclocked GMU register access
       - gpu: Devcore dump enhancements
       - client utilization via fdinfo support
       - fix fence rollover issue
       - gem: Lockdep false-positive warning fix
       - gem: Switch to pfn mappings
       - WB support on sc7180
       - dp: dropped custom bulk clock implementation
       - fix link retraining on resolution change
       - hdmi: dropped obsolete GPIO support
    
      tegra:
       - context isolation for host1x engines
       - tegra234 soc support
    
      mediatek:
       - add vdosys0/1 for mt8195
       - add MT8195 dp_intf driver
    
      exynos:
       - Fix resume function issue of exynos decon driver by calling
         clk_disable_unprepare() properly if clk_prepare_enable() failed.
    
      nouveau:
       - set of misc fixes/cleanups
       - display cleanups
    
      gma500:
       - Cleanup connector I2C handling
    
      hyperv:
       - Unify VRAM allocation of Gen1 and Gen2
    
      meson:
       - Support YUV422 output; Refcount fixes
    
      mgag200:
       - Support damage clipping
       - Support gamma handling
       - Protect concurrent HW access
       - Fixes to connector
       - Store model-specific limits in device-info structure
       - fix PCI register init
    
      panfrost:
       - Valhall support
    
      r128:
       - Fix bit-shift overflow
    
      rockchip:
       - Locking fixes in error path
    
      ssd130x:
       - Fix built-in linkage
    
      udl:
       - Always advertize VGA connector
    
      ast:
       - Support multiple outputs
       - fix black screen on resume
    
      sun4i:
       - HDMI PHY cleanups
    
      vc4:
       - Add support for BCM2711
    
      vkms:
       - Allocate output buffer with vmalloc()
    
      mcde:
       - Fix ref-count leak
    
      mxsfb/lcdif:
       - Support i.MX8MP LCD controller
    
      stm/ltdc:
       - Support dynamic Z order
       - Support mirroring
    
      ingenic:
       - Fix display at maximum resolution"
    
    * tag 'drm-next-2022-08-03' of git://anongit.freedesktop.org/drm/drm: (1480 commits)
      drm/amd/display: Fix a compilation failure on PowerPC caused by FPU code
      drm/amdgpu: enable support for psp 13.0.4 block
      drm/amdgpu: add files for PSP 13.0.4
      drm/amdgpu: add header files for MP 13.0.4
      drm/amdgpu: correct RLC_RLCS_BOOTLOAD_STATUS offset and index
      drm/amdgpu: send msg to IMU for the front-door loading
      drm/amdkfd: use time_is_before_jiffies(a + b) to replace "jiffies - a > b"
      drm/amdgpu: fix hive reference leak when reflecting psp topology info
      drm/amd/pm: enable GFX ULV feature support for SMU13.0.0
      drm/amd/pm: update driver if header for SMU 13.0.0
      drm/amdgpu: move mes self test after drm sched re-started
      drm/amdgpu: drop non-necessary call trace dump
      drm/amdgpu: enable VCN cg and JPEG cg/pg
      drm/amdgpu: vcn_4_0_2 video codec query
      drm/amdgpu: add VCN_4_0_2 firmware support
      drm/amdgpu: add VCN function in NBIO v7.7
      drm/amdgpu: fix a vcn4 boot poll bug in emulation mode
      drm/amd/amdgpu: add memory training support for PSP_V13
      drm/amdkfd: remove an unnecessary amdgpu_bo_ref
      drm/amd/pm: Add get_gfx_off_status interface for yellow carp
      ...

commit 8df4ef3eaa62b25afbb30cc7707cc99ec155ed71
Author: Jean Delvare <jdelvare@suse.de>
Date:   Sun Jul 31 14:13:52 2022 +0200

    thermal: Drop obsolete dependency on COMPILE_TEST
    
    Since commit 0166dc11be91 ("of: make CONFIG_OF user selectable"), it
    is possible to test-build any driver which depends on OF on any
    architecture by explicitly selecting OF. Therefore depending on
    COMPILE_TEST as an alternative is no longer needed.
    
    It is actually better to always build such drivers with OF enabled,
    so that the test builds are closer to how each driver will actually be
    built on its intended target. Building them without OF may not test
    much as the compiler will optimize out potentially large parts of the
    code. In the worst case, this could even pop false positive warnings.
    Dropping COMPILE_TEST here improves the quality of our testing and
    avoids wasting time on non-existent issues.
    
    Signed-off-by: Jean Delvare <jdelvare@suse.de>
    Signed-off-by: Rafael J. Wysocki <rafael.j.wysocki@intel.com>

commit d2fd1ddd311d94460b285f9dac7e8dbcccd0b8bf
Merge: 3d7cb6b04c3f d985db836226
Author: Arnd Bergmann <arnd@arndb.de>
Date:   Tue Aug 2 15:57:46 2022 +0200

    Merge tag 'reset-for-v5.20' of git://git.pengutronix.de/pza/linux into arm/late
    
    Reset controller updates for v5.20
    
    Allow reset-simple to be selected under EXPERT and reset-a10sr to be
    built under COMPILE_TEST. Add Renesas RZ/G2UL USBPHY binding and a new
    driver for the TI TPS380x line of voltage supervisor ICs with manual
    reset control.
    
    A patch to make reset-microchip-sparx5 buildable as a module had to be
    reverted as that turned out to break MDIO on kswitch-d10.
    
    * tag 'reset-for-v5.20' of git://git.pengutronix.de/pza/linux:
      reset: tps380x: Fix spelling mistake "Voltags" -> "Voltage"
      reset: tps380x: Add TPS380x device driver supprt
      dt-bindings: reset: Add TPS380x documentation
      dt-bindings: reset: renesas,rzg2l-usbphy-ctrl: Document RZ/G2UL USBPHY Control bindings
      reset: reset-simple should depends on HAS_IOMEM
      Revert "reset: microchip-sparx5: allow building as a module"
      reset: a10sr: allow building under COMPILE_TEST
      reset: allow building of reset simple driver if expert config selected
      reset: microchip-sparx5: allow building as a module
    
    Link: https://lore.kernel.org/r/20220729133620.488379-1-p.zabel@pengutronix.de
    Signed-off-by: Arnd Bergmann <arnd@arndb.de>

commit de0269765b268717b70f16f809560e83d5a8d0e7
Author: Ren Zhijie <renzhijie2@huawei.com>
Date:   Tue Jul 26 11:35:20 2022 +0800

    ACPI/IORT: Fix build error implicit-function-declaration
    
    If CONFIG_ACPI_IORT=y and CONFIG_IOMMU_API is not set,
    make ARCH=arm64 CROSS_COMPILE=aarch64-linux-gnu-,
    will be failed, like this:
    
    drivers/acpi/arm64/iort.c: In function iort_get_rmr_sids:
    drivers/acpi/arm64/iort.c:1406:2: error: implicit declaration of function iort_iommu_rmr_get_resv_regions; did you mean iort_iommu_get_resv_regions? [-Werror=implicit-function-declaration]
      iort_iommu_rmr_get_resv_regions(iommu_fwnode, NULL, head);
      ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
      iort_iommu_get_resv_regions
    cc1: some warnings being treated as errors
    make[3]: *** [drivers/acpi/arm64/iort.o] Error 1
    
    The function iort_iommu_rmr_get_resv_regions()
    is declared under CONFIG_IOMMU_API,
    and the callers of iort_get_rmr_sids() and iort_put_rmr_sids()
    would select IOMMU_API.
    
    To fix this error, move the definitions to #ifdef CONFIG_IOMMU_API.
    
    Fixes: e302eea8f497 ("ACPI/IORT: Add a helper to retrieve RMR info directly")
    Signed-off-by: Ren Zhijie <renzhijie2@huawei.com>
    Acked-by: Hanjun Guo <guohanjun@huawei.com>
    Link: https://lore.kernel.org/r/20220726033520.47865-1-renzhijie2@huawei.com
    Signed-off-by: Joerg Roedel <jroedel@suse.de>

commit 7fb48d25b5ce3bc488dbb019bf1736248181de9a
Author: Vincent Mailhol <mailhol.vincent@wanadoo.fr>
Date:   Wed Jul 27 19:16:34 2022 +0900

    can: dev: add generic function can_ethtool_op_get_ts_info_hwts()
    
    Add function can_ethtool_op_get_ts_info_hwts(). This function will be
    used by CAN devices with hardware TX/RX timestamping support to
    implement ethtool_ops::get_ts_info. This function does not offer
    support to activate/deactivate hardware timestamps at device level nor
    support the filter options (which is currently the case for all CAN
    devices with hardware timestamping support).
    
    The fact that hardware timestamp can not be deactivated at hardware
    level does not impact the userland. As long as the user do not set
    SO_TIMESTAMPING using a setsockopt() or ioctl(), the kernel will not
    emit TX timestamps (RX timestamps will still be reproted as it is the
    case currently).
    
    Drivers which need more fine grained control remains free to implement
    their own function, but we foresee that the generic function
    introduced here will be sufficient for the majority.
    
    Signed-off-by: Vincent Mailhol <mailhol.vincent@wanadoo.fr>
    Link: https://lore.kernel.org/all/20220727101641.198847-8-mailhol.vincent@wanadoo.fr
    Signed-off-by: Marc Kleine-Budde <mkl@pengutronix.de>

commit f20d5116b7f3d8d40e1248a59be89e667eaabd62
Author: Ren Zhijie <renzhijie2@huawei.com>
Date:   Sun Jul 24 19:06:19 2022 +0800

    ASoC: mediatek: mt8186: fix Kconfig dependency
    
    If CONFIG_SND_SOC_MT8186=y and CONFIG_SND_SOC_MT6358 is not set,
    make ARCH=x86_64 CROSS_COMPILE=x86_64-linux-gnu-, will be failed, like this:
    
    sound/soc/mediatek/mt8186/mt8186-mt6366-common.o: In function `mt8186_mt6366_init':
    mt8186-mt6366-common.c:(.text+0x4d): undefined reference to `mt6358_set_mtkaif_protocol'
    make: *** [vmlinux] Error 1
    
    To fix this build error, add select SND_SOC_MT6358 to config SND_SOC_MT8186 dependency.
    
    Fixes: 097e874ad3fc ("ASoC: mediatek: mt8186: add platform driver")
    Signed-off-by: Ren Zhijie <renzhijie2@huawei.com>
    Link: https://lore.kernel.org/r/20220724110619.212774-1-renzhijie2@huawei.com
    Signed-off-by: Mark Brown <broonie@kernel.org>

commit 26ae150bbb6d19767f10800e17ad0fd81f3da67e
Author: Ren Zhijie <renzhijie2@huawei.com>
Date:   Mon Jul 25 10:36:11 2022 +0800

    ALSA: hda: cs35l41: Fix build error unused-function
    
    If CONFIG_PM_SLEEP is not set,
    make ARCH=x86_64 CROSS_COMPILE=x86_64-linux-gnu-, will be failed, like this:
    
    sound/pci/hda/cs35l41_hda.c:583:12: error: cs35l41_runtime_resume defined but not used [-Werror=unused-function]
     static int cs35l41_runtime_resume(struct device *dev)
                ^~~~~~~~~~~~~~~~~~~~~~
    sound/pci/hda/cs35l41_hda.c:565:12: error: cs35l41_runtime_suspend defined but not used [-Werror=unused-function]
     static int cs35l41_runtime_suspend(struct device *dev)
                ^~~~~~~~~~~~~~~~~~~~~~~
    cc1: all warnings being treated as errors
    make[3]: *** [sound/pci/hda/cs35l41_hda.o] Error 1
    
    commit 1a3c7bb08826 ("PM: core: Add new *_PM_OPS macros,
    deprecate old ones"), add new marco RUNTIME_PM_OPS to fix this unused-function problem.
    
    Fixes: 1873ebd30cc8 ("ALSA: hda: cs35l41: Support Hibernation during Suspend")
    Signed-off-by: Ren Zhijie <renzhijie2@huawei.com>
    Link: https://lore.kernel.org/r/20220725023611.57055-1-renzhijie2@huawei.com
    Signed-off-by: Takashi Iwai <tiwai@suse.de>

commit 88bd24d73d5bfa1b7b97a9221ff320fc44ef401a
Author: Emil Renner Berthing <emil.renner.berthing@canonical.com>
Date:   Sat Jun 25 16:42:07 2022 +0100

    riscv: compat: vdso: Fix vdso_install target
    
    When CONFIG_COMPAT=y the vdso_install target fails:
    
    $ make ARCH=riscv CROSS_COMPILE=riscv64-linux-gnu- vdso_install
      INSTALL vdso.so
    make[1]: *** No rule to make target 'vdso_install'.  Stop.
    make: *** [arch/riscv/Makefile:112: vdso_install] Error 2
    
    The problem is that arch/riscv/kernel/compat_vdso/Makefile doesn't
    have a vdso_install target, but instead calls it compat_vdso_install.
    
    Signed-off-by: Emil Renner Berthing <emil.renner.berthing@canonical.com>
    Link: https://lore.kernel.org/r/20220625154207.80972-1-emil.renner.berthing@canonical.com
    Fixes: 0715372a06ce ("riscv: compat: vdso: Add COMPAT_VDSO base code implementation")
    Cc: stable@vger.kernel.org
    Signed-off-by: Palmer Dabbelt <palmer@rivosinc.com>

commit 1e744351bcb9c4cee81300de5a6097100d835386
Author: Amadeusz Sawiski <amadeuszx.slawinski@linux.intel.com>
Date:   Fri Jul 22 13:19:59 2022 +0200

    ASoC: Intel: avs: Use lookup table to create modules
    
    As reported by Nathan, when building avs driver using clang with:
      CONFIG_COMPILE_TEST=y
      CONFIG_FORTIFY_SOURCE=y
      CONFIG_KASAN=y
      CONFIG_PCI=y
      CONFIG_SOUND=y
      CONFIG_SND=y
      CONFIG_SND_SOC=y
      CONFIG_SND_SOC_INTEL_AVS=y
    
    there are reports of too big stack use, like:
      sound/soc/intel/avs/path.c:815:18: error: stack frame size (2176) exceeds limit (2048) in 'avs_path_create' [-Werror,-Wframe-larger-than]
      struct avs_path *avs_path_create(struct avs_dev *adev, u32 dma_id,
                       ^
      1 error generated.
    
    This is apparently caused by inlining many calls to guid_equal which
    inlines fortified memcpy, using 2 size_t variables.
    
    Instead of hardcoding many calls to guid_equal, use lookup table with
    one call, this improves stack usage.
    
    Link: https://lore.kernel.org/alsa-devel/YtlzY9aYdbS4Y3+l@dev-arch.thelio-3990X/T/
    Link: https://github.com/ClangBuiltLinux/linux/issues/1642
    Signed-off-by: Amadeusz Sawiski <amadeuszx.slawinski@linux.intel.com>
    Reported-by: Nathan Chancellor <nathan@kernel.org>
    Build-tested-by: Nathan Chancellor <nathan@kernel.org>
    Reviewed-by: Cezary Rojewski <cezary.rojewski@intel.com>
    Link: https://lore.kernel.org/r/20220722111959.2588597-1-amadeuszx.slawinski@linux.intel.com
    Signed-off-by: Mark Brown <broonie@kernel.org>

commit 7e76e4bc00999846c17604dc25486fffa542078d
Author: Tzung-Bi Shih <tzungbi@kernel.org>
Date:   Mon Jul 18 10:50:47 2022 +0000

    platform/chrome: cros_kbd_led_backlight: fix build warning
    
    drivers/platform/chrome/cros_kbd_led_backlight.c got a new build warning
    when using the randconfig in [1]:
    >>> warning: unused variable 'keyboard_led_drvdata_ec_pwm'
    
    The warning happens when CONFIG_CROS_EC is set but CONFIG_OF is not set.
    Reproduce:
    - mkdir build_dir
    - wget [1] -O build_dir/.config
    - COMPILER_INSTALL_PATH=$HOME/0day COMPILER=clang make.cross W=1 \
      O=build_dir ARCH=s390 SHELL=/bin/bash drivers/platform/chrome/
    
    Fix the warning by using __maybe_unused.  Also use IS_ENABLED() because
    CROS_EC is a tristate.
    
    [1]: https://download.01.org/0day-ci/archive/20220717/202207170538.MR39dw8m-lkp@intel.com/config
    
    Fixes: 40f58143745e ("platform/chrome: cros_kbd_led_backlight: support EC PWM backend")
    Reported-by: kernel test robot <lkp@intel.com>
    Signed-off-by: Tzung-Bi Shih <tzungbi@kernel.org>
    Reviewed-by: Guenter Roeck <groeck@chromium.org>
    Link: https://lore.kernel.org/r/20220718105047.2356542-1-tzungbi@kernel.org

commit b5eb8cde863cdf455436c7ba3fb7362c49e1e64e
Author: Ren Zhijie <renzhijie2@huawei.com>
Date:   Thu Jul 14 20:11:44 2022 +0800

    clk: qcom: fix build error initializer element is not constant
    
    CONFIG_CC_VERSION_TEXT="x86_64-linux-gnu-gcc (Ubuntu 7.4.0-1ubuntu1~18.04.1) 7.4.0"
    make ARCH=x86_64 CROSS_COMPILE=x86_64-linux-gnu-, will be failed, like this:
    
    drivers/clk/qcom/gpucc-sm8350.c:111:2: error: initializer element is not constant
      gpu_cc_parent,
      ^~~~~~~~~~~~~
    drivers/clk/qcom/gpucc-sm8350.c:111:2: note: (near initialization for gpu_cc_parent_data_0[0])
    drivers/clk/qcom/gpucc-sm8350.c:126:2: error: initializer element is not constant
      gpu_cc_parent,
      ^~~~~~~~~~~~~
    drivers/clk/qcom/gpucc-sm8350.c:126:2: note: (near initialization for gpu_cc_parent_data_1[0])
    make[3]: *** [drivers/clk/qcom/gpucc-sm8350.o] Error 1
    
    It seems that nested constant initializer is not supported in GCC 7.4.0. For portability resons, we should fix it.
    
    Reported-by: Hulk Robot <hulkci@huawei.com>
    Fixes: 160758b05ab1 ("clk: qcom: add support for SM8350 GPUCC")
    Signed-off-by: Ren Zhijie <renzhijie2@huawei.com>
    Signed-off-by: Bjorn Andersson <bjorn.andersson@linaro.org>
    Link: https://lore.kernel.org/r/20220714121144.71062-1-renzhijie2@huawei.com

commit 29589ca09a74cfc0c50ad002e298bf4b8e69e0bd
Author: Ard Biesheuvel <ardb@kernel.org>
Date:   Tue May 31 09:49:24 2022 +0100

    ARM: 9208/1: entry: add .ltorg directive to keep literals in range
    
    LKP reports a build issue on Clang, related to a literal load of
    __current issued through the ldr_va macro. This turns out to be due to
    the fact that group relocations are disabled when CONFIG_COMPILE_TEST=y,
    which means that the ldr_va macro resolves to a pair of LDR
    instructions, the first one being a literal load issued too far from its
    literal pool.
    
    Due to the introduction of a couple of new uses of this macro in commit
    508074607c7b95b2 ("ARM: 9195/1: entry: avoid explicit literal loads"),
    the literal pools end up getting rearranged in a way that causes the
    literal for __current to go out of range. Let's fix this up by putting a
    .ltorg directive in a suitable place in the code.
    
    Link: https://lore.kernel.org/all/202205290805.1vZLAr36-lkp@intel.com/
    
    Fixes: 508074607c7b95b2 ("ARM: 9195/1: entry: avoid explicit literal loads")
    Reported-by: kernel test robot <lkp@intel.com>
    Signed-off-by: Ard Biesheuvel <ardb@kernel.org>
    Tested-by: Nathan Chancellor <nathan@kernel.org>
    Signed-off-by: Russell King (Oracle) <rmk+kernel@armlinux.org.uk>

commit 0356d778aa1e14d80db40a9dae02192d6b47a5ac
Author: Ren Zhijie <renzhijie2@huawei.com>
Date:   Thu Jun 9 20:04:48 2022 +0800

    hwmon: (pmbus) fix build error unused-function
    
    If CONFIG_PMBUS is y and CONFIG_DEBUG_FS is not set.
    
    make ARCH=arm64 CROSS_COMPILE=aarch64-linux-gnu-, will be failed, like this:
    drivers/hwmon/pmbus/pmbus_core.c:593:13: error: pmbus_check_block_register defined but not used [-Werror=unused-function]
     static bool pmbus_check_block_register(struct i2c_client *client, int page,
                 ^~~~~~~~~~~~~~~~~~~~~~~~~~
    cc1: all warnings being treated as errors
    make[3]: *** [drivers/hwmon/pmbus/pmbus_core.o] Error 1
    make[2]: *** [drivers/hwmon/pmbus] Error 2
    make[2]: *** Waiting for unfinished jobs....
    make[1]: *** [drivers/hwmon] Error 2
    make[1]: *** Waiting for unfinished jobs....
    make: *** [drivers] Error 2
    
    To fix building warning, use __maybe_unused to attach this func.
    
    Reported-by: Hulk Robot <hulkci@huawei.com>
    Fixes: c3ffc3a1ff83("hwmon: (pmbus) add a function to check the presence of a block register")
    Signed-off-by: Ren Zhijie <renzhijie2@huawei.com>
    Link: https://lore.kernel.org/r/20220609120448.139907-1-renzhijie2@huawei.com
    [groeck: Fixed continuation line alignment]
    Signed-off-by: Guenter Roeck <linux@roeck-us.net>

commit b97adb596399581df42a5f94e14235359f150373
Author: Uwe Kleine-Knig <u.kleine-koenig@pengutronix.de>
Date:   Fri May 27 17:34:45 2022 +0200

    hwmon: Allow to compile ASB100 and FSCHMD on !X86
    
    The two drivers compile just fine on ARCH=arm. Allow to select
    these drivers if COMPILE_TEST is enabled.
    
    Signed-off-by: Uwe Kleine-Knig <u.kleine-koenig@pengutronix.de>
    Reviewed-by: Jean Delvare <jdelvare@suse.de>
    Link: https://lore.kernel.org/r/20220527153445.1871086-1-u.kleine-koenig@pengutronix.de
    Signed-off-by: Guenter Roeck <linux@roeck-us.net>

commit 1795c16a436057f95fef5b622d808885dd772d0e
Author: Randy Dunlap <rdunlap@infradead.org>
Date:   Tue Jul 12 11:33:48 2022 -0700

    ASoC: amd: fix Jadeite kconfig warning and build errors
    
    Since SND_SOC_ES8316 has a hard dependency on I2C and since 'select'
    does not follow any dependency chains, SND_SOC_AMD_ST_ES8336_MACH
    also needs to have a hard dependency on I2C.
    
    Fixes a kconfig warning and subsequent build errors:
    
    WARNING: unmet direct dependencies detected for SND_SOC_ES8316
      Depends on [n]: SOUND [=y] && !UML && SND [=y] && SND_SOC [=y] && I2C [=n]
      Selected by [y]:
      - SND_SOC_AMD_ST_ES8336_MACH [=y] && SOUND [=y] && !UML && SND [=y] && SND_SOC [=y] && SND_SOC_AMD_ACP [=y] && ACPI [=y] && (I2C [=n] || COMPILE_TEST [=y])
    
    sound/soc/codecs/es8316.c:866:1: warning: data definition has no type or storage class
      866 | module_i2c_driver(es8316_i2c_driver);
    sound/soc/codecs/es8316.c:866:1: error: type defaults to int in declaration of module_i2c_driver [-Werror=implicit-int]
    sound/soc/codecs/es8316.c:866:1: warning: parameter names (without types) in function declaration
    sound/soc/codecs/es8316.c:857:26: warning: es8316_i2c_driver defined but not used [-Wunused-variable]
      857 | static struct i2c_driver es8316_i2c_driver = {
    
    Fixes: f94fa8405801 ("ASoC: amd: enable machine driver build for Jadeite platform")
    Signed-off-by: Randy Dunlap <rdunlap@infradead.org>
    Cc: Vijendar Mukunda <Vijendar.Mukunda@amd.com>
    Cc: Mark Brown <broonie@kernel.org>
    Cc: alsa-devel@alsa-project.org
    Cc: Jaroslav Kysela <perex@perex.cz>
    Cc: Takashi Iwai <tiwai@suse.com>
    Link: https://lore.kernel.org/r/20220712183348.31046-1-rdunlap@infradead.org
    Signed-off-by: Mark Brown <broonie@kernel.org>

commit 1c5fd97373115b932afa72fbc5425560e0d1148f
Author: Ren Zhijie <renzhijie2@huawei.com>
Date:   Sun Jun 19 18:47:12 2022 +0800

    mmc: sdhci-pci-gli: Fix build error unused-function
    
    If CONFIG_PM is not set.
    
    make ARCH=x86_64 CROSS_COMPILE=x86_64-linux-gnu-, will be failed, like this:
    
    drivers/mmc/host/sdhci-pci-gli.c:834:13: error: gl9763e_set_low_power_negotiation defined but not used [-Werror=unused-function]
     static void gl9763e_set_low_power_negotiation(struct sdhci_pci_slot *slot, bool enable)
                 ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    cc1: all warnings being treated as errors
    make[3]: *** [drivers/mmc/host/sdhci-pci-gli.o] Error 1
    
    To fix building warning, wrap all related code with CONFIG_PM.
    
    Reported-by: Hulk Robot <hulkci@huawei.com>
    Signed-off-by: Ren Zhijie <renzhijie2@huawei.com>
    Acked-by: Adrian Hunter <adrian.hunter@intel.com>
    Link: https://lore.kernel.org/r/20220619104712.125364-1-renzhijie2@huawei.com
    Signed-off-by: Ulf Hansson <ulf.hansson@linaro.org>

commit 6e44e0dc5806b614f1a683fc8d91f677f18bf2f4
Author: Chanho Park <chanho61.park@samsung.com>
Date:   Thu Jul 7 17:27:53 2022 +0900

    dt-bindings: arm: cpus: add cortex-a78ae compatible
    
    Cortex A78AE's MPIDR has been added since
    commit 83bea32ac7ed ("arm64: Add part number for Arm Cortex-A78AE")
    We also need to add the compatible.
    
    Signed-off-by: Chanho Park <chanho61.park@samsung.com>
    Signed-off-by: Rob Herring <robh@kernel.org>
    Link: https://lore.kernel.org/r/20220707082753.28862-1-chanho61.park@samsung.com

commit af19f1936d63f8aefeca61a5410f8908e0f11f56
Author: Philipp Zabel <p.zabel@pengutronix.de>
Date:   Mon Jul 11 15:06:24 2022 +0200

    reset: a10sr: allow building under COMPILE_TEST
    
    This driver can be built under COMPILE_TEST. Allow it.
    
    Signed-off-by: Philipp Zabel <p.zabel@pengutronix.de>
    Link: https://lore.kernel.org/r/20220711130624.1217599-1-p.zabel@pengutronix.de

commit 50d6281ce9b8412f7ef02d1bc9d23aa62ae0cf98
Author: Ren Zhijie <renzhijie2@huawei.com>
Date:   Thu Jun 30 20:35:28 2022 +0800

    dma-mapping: Fix build error unused-value
    
    If CONFIG_DMA_DECLARE_COHERENT is not set,
    make ARCH=x86_64 CROSS_COMPILE=x86_64-linux-gnu- will be failed, like this:
    
    drivers/remoteproc/remoteproc_core.c: In function rproc_rvdev_release:
    ./include/linux/dma-map-ops.h:182:42: error: statement with no effect [-Werror=unused-value]
     #define dma_release_coherent_memory(dev) (0)
                                              ^
    drivers/remoteproc/remoteproc_core.c:464:2: note: in expansion of macro dma_release_coherent_memory
      dma_release_coherent_memory(dev);
      ^~~~~~~~~~~~~~~~~~~~~~~~~~~
    cc1: all warnings being treated as errors
    
    The return type of function dma_release_coherent_memory in CONFIG_DMA_DECLARE_COHERENT area is void, so in !CONFIG_DMA_DECLARE_COHERENT area it should neither return any value nor be defined as zero.
    
    Reported-by: Hulk Robot <hulkci@huawei.com>
    Fixes: e61c451476e6 ("dma-mapping: Add dma_release_coherent_memory to DMA API")
    Signed-off-by: Ren Zhijie <renzhijie2@huawei.com>
    Reviewed-by: Christoph Hellwig <hch@lst.de>
    Link: https://lore.kernel.org/r/20220630123528.251181-1-renzhijie2@huawei.com
    Signed-off-by: Mathieu Poirier <mathieu.poirier@linaro.org>

commit f145d411a67efacc0731fc3f9c7b2d89fb62523a
Author: Ignat Korchagin <ignat@cloudflare.com>
Date:   Fri Jun 17 09:42:10 2022 +0100

    crypto: rsa - implement Chinese Remainder Theorem for faster private key operations
    
    Changes from v1:
      * exported mpi_sub and mpi_mul, otherwise the build fails when RSA is a module
    
    The kernel RSA ASN.1 private key parser already supports only private keys with
    additional values to be used with the Chinese Remainder Theorem [1], but these
    values are currently not used.
    
    This rudimentary CRT implementation speeds up RSA private key operations for the
    following Go benchmark up to ~3x.
    
    This implementation also tries to minimise the allocation of additional MPIs,
    so existing MPIs are reused as much as possible (hence the variable names are a
    bit weird).
    
    The benchmark used:
    
    ```
    package keyring_test
    
    import (
            "crypto"
            "crypto/rand"
            "crypto/rsa"
            "crypto/x509"
            "io"
            "syscall"
            "testing"
            "unsafe"
    )
    
    type KeySerial int32
    type Keyring int32
    
    const (
            KEY_SPEC_PROCESS_KEYRING Keyring = -2
            KEYCTL_PKEY_SIGN                 = 27
    )
    
    var (
            keyTypeAsym = []byte("asymmetric\x00")
            sha256pkcs1 = []byte("enc=pkcs1 hash=sha256\x00")
    )
    
    func (keyring Keyring) LoadAsym(desc string, payload []byte) (KeySerial, error) {
            cdesc := []byte(desc + "\x00")
            serial, _, errno := syscall.Syscall6(syscall.SYS_ADD_KEY, uintptr(unsafe.Pointer(&keyTypeAsym[0])), uintptr(unsafe.Pointer(&cdesc[0])), uintptr(unsafe.Pointer(&payload[0])), uintptr(len(payload)), uintptr(keyring), uintptr(0))
            if errno == 0 {
                    return KeySerial(serial), nil
            }
    
            return KeySerial(serial), errno
    }
    
    type pkeyParams struct {
            key_id         KeySerial
            in_len         uint32
            out_or_in2_len uint32
            __spare        [7]uint32
    }
    
    // the output signature buffer is an input parameter here, because we want to
    // avoid Go buffer allocation leaking into our benchmarks
    func (key KeySerial) Sign(info, digest, out []byte) error {
            var params pkeyParams
            params.key_id = key
            params.in_len = uint32(len(digest))
            params.out_or_in2_len = uint32(len(out))
    
            _, _, errno := syscall.Syscall6(syscall.SYS_KEYCTL, KEYCTL_PKEY_SIGN, uintptr(unsafe.Pointer(&params)), uintptr(unsafe.Pointer(&info[0])), uintptr(unsafe.Pointer(&digest[0])), uintptr(unsafe.Pointer(&out[0])), uintptr(0))
            if errno == 0 {
                    return nil
            }
    
            return errno
    }
    
    func BenchmarkSign(b *testing.B) {
            priv, err := rsa.GenerateKey(rand.Reader, 2048)
            if err != nil {
                    b.Fatalf("failed to generate private key: %v", err)
            }
    
            pkcs8, err := x509.MarshalPKCS8PrivateKey(priv)
            if err != nil {
                    b.Fatalf("failed to serialize the private key to PKCS8 blob: %v", err)
            }
    
            serial, err := KEY_SPEC_PROCESS_KEYRING.LoadAsym("test rsa key", pkcs8)
            if err != nil {
                    b.Fatalf("failed to load the private key into the keyring: %v", err)
            }
    
            b.Logf("loaded test rsa key: %v", serial)
    
            digest := make([]byte, 32)
            _, err = io.ReadFull(rand.Reader, digest)
            if err != nil {
                    b.Fatalf("failed to generate a random digest: %v", err)
            }
    
            sig := make([]byte, 256)
            for n := 0; n < b.N; n++ {
                    err = serial.Sign(sha256pkcs1, digest, sig)
                    if err != nil {
                            b.Fatalf("failed to sign the digest: %v", err)
                    }
            }
    
            err = rsa.VerifyPKCS1v15(&priv.PublicKey, crypto.SHA256, digest, sig)
            if err != nil {
                    b.Fatalf("failed to verify the signature: %v", err)
            }
    }
    ```
    
    [1]: https://en.wikipedia.org/wiki/RSA_(cryptosystem)#Using_the_Chinese_remainder_algorithm
    
    Signed-off-by: Ignat Korchagin <ignat@cloudflare.com>
    Reported-by: kernel test robot <lkp@intel.com>
    Signed-off-by: Herbert Xu <herbert@gondor.apana.org.au>

commit 876271118aa41097d035c84f99648746b4a125f3
Author: YueHaibing <yuehaibing@huawei.com>
Date:   Sat Jun 11 12:16:12 2022 +0800

    drm/display: Fix build error without CONFIG_OF
    
    While CONFIG_OF is n but COMPILE_TEST is y, we got this:
    
    WARNING: unmet direct dependencies detected for DRM_DP_AUX_BUS
      Depends on [n]: HAS_IOMEM [=y] && DRM [=y] && OF [=n]
      Selected by [y]:
      - DRM_MSM [=y] && HAS_IOMEM [=y] && DRM [=y] && (ARCH_QCOM || SOC_IMX5 || COMPILE_TEST [=y]) && COMMON_CLK [=y] && IOMMU_SUPPORT [=y] && (QCOM_OCMEM [=n] || QCOM_OCMEM [=n]=n) && (QCOM_LLCC [=y] || QCOM_LLCC [=y]=n) && (QCOM_COMMAND_DB [=n] || QCOM_COMMAND_DB [=n]=n)
    
    Make DRM_DP_AUX_BUS depends on OF || COMPILE_TEST to fix this warning.
    
    Fixes: 1e0f66420b13 ("drm/display: Introduce a DRM display-helper module")
    Signed-off-by: YueHaibing <yuehaibing@huawei.com>
    Reviewed-by: Dmitry Baryshkov <dmitry.baryshkov@linaro.org>
    Reviewed-by: Abhinav Kumar <quic_abhinavk@quicinc.com>
    Acked-by: Linus Walleij <linus.walleij@linaro.org>
    Signed-off-by: Linus Walleij <linus.walleij@linaro.org>
    Link: https://patchwork.freedesktop.org/patch/msgid/20220611041612.1976-1-yuehaibing@huawei.com

commit f03efd4d4dd89ac72c246ea2eaed137a2d7ddd26
Author: Helge Deller <deller@gmx.de>
Date:   Tue May 31 22:09:27 2022 +0200

    scsi: mpt3sas: Fix out-of-bounds compiler warning
    
    [ Upstream commit 120f1d95efb1cdb6fe023c84e38ba06d8f78cd03 ]
    
    I'm facing this warning when building for the parisc64 architecture:
    
    drivers/scsi/mpt3sas/mpt3sas_base.c: In function _base_make_ioc_operational:
    drivers/scsi/mpt3sas/mpt3sas_base.c:5396:40: warning: array subscript Mpi2SasIOUnitPage1_t {aka struct _MPI2_CONFIG_PAGE_SASIOUNIT_1}[0] is partly outside array bounds of unsigned char[20] [-Warray-bounds]
     5396 |             (le16_to_cpu(sas_iounit_pg1->SASWideMaxQueueDepth)) ?
    drivers/scsi/mpt3sas/mpt3sas_base.c:5382:26: note: referencing an object of size 20 allocated by kzalloc
     5382 |         sas_iounit_pg1 = kzalloc(sz, GFP_KERNEL);
          |                          ^~~~~~~~~~~~~~~~~~~~~~~
    
    The problem is, that only 20 bytes are allocated with kmalloc(), which is
    sufficient to hold the bytes which are needed.  Nevertheless, gcc complains
    because the whole Mpi2SasIOUnitPage1_t struct is 32 bytes in size and thus
    doesn't fit into those 20 bytes.
    
    This patch simply allocates all 32 bytes (instead of 20) and thus avoids
    the warning. There is no functional change introduced by this patch.
    
    While touching the code I cleaned up to calculation of max_wideport_qd,
    max_narrowport_qd and max_sata_qd to make it easier readable.
    
    Test successfully tested on a HP C8000 PA-RISC workstation with 64-bit
    kernel.
    
    Link: https://lore.kernel.org/r/YpZ197iZdDZSCzrT@p100
    Signed-off-by: Helge Deller <deller@gmx.de>
    Signed-off-by: Martin K. Petersen <martin.petersen@oracle.com>
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit cb8aa5b92a319a0b08cf57e331cef0213b884263
Author: Helge Deller <deller@gmx.de>
Date:   Tue May 31 22:09:27 2022 +0200

    scsi: mpt3sas: Fix out-of-bounds compiler warning
    
    [ Upstream commit 120f1d95efb1cdb6fe023c84e38ba06d8f78cd03 ]
    
    I'm facing this warning when building for the parisc64 architecture:
    
    drivers/scsi/mpt3sas/mpt3sas_base.c: In function _base_make_ioc_operational:
    drivers/scsi/mpt3sas/mpt3sas_base.c:5396:40: warning: array subscript Mpi2SasIOUnitPage1_t {aka struct _MPI2_CONFIG_PAGE_SASIOUNIT_1}[0] is partly outside array bounds of unsigned char[20] [-Warray-bounds]
     5396 |             (le16_to_cpu(sas_iounit_pg1->SASWideMaxQueueDepth)) ?
    drivers/scsi/mpt3sas/mpt3sas_base.c:5382:26: note: referencing an object of size 20 allocated by kzalloc
     5382 |         sas_iounit_pg1 = kzalloc(sz, GFP_KERNEL);
          |                          ^~~~~~~~~~~~~~~~~~~~~~~
    
    The problem is, that only 20 bytes are allocated with kmalloc(), which is
    sufficient to hold the bytes which are needed.  Nevertheless, gcc complains
    because the whole Mpi2SasIOUnitPage1_t struct is 32 bytes in size and thus
    doesn't fit into those 20 bytes.
    
    This patch simply allocates all 32 bytes (instead of 20) and thus avoids
    the warning. There is no functional change introduced by this patch.
    
    While touching the code I cleaned up to calculation of max_wideport_qd,
    max_narrowport_qd and max_sata_qd to make it easier readable.
    
    Test successfully tested on a HP C8000 PA-RISC workstation with 64-bit
    kernel.
    
    Link: https://lore.kernel.org/r/YpZ197iZdDZSCzrT@p100
    Signed-off-by: Helge Deller <deller@gmx.de>
    Signed-off-by: Martin K. Petersen <martin.petersen@oracle.com>
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit f54912b228a8df6c0133e31bc75628677bb8c6e5
Author: Ren Zhijie <renzhijie2@huawei.com>
Date:   Sun Jun 19 19:54:32 2022 +0800

    scsi: ufs: ufs-mediatek: Fix build error and type mismatch
    
    If CONFIG_PM_SLEEP is not set.
    
    make ARCH=arm64 CROSS_COMPILE=aarch64-linux-gnu-, will fail:
    
    drivers/ufs/host/ufs-mediatek.c: In function ufs_mtk_vreg_fix_vcc:
    drivers/ufs/host/ufs-mediatek.c:688:46: warning: format %u expects argument of type unsigned int, but argument 4 has type long unsigned int [-Wformat=]
        snprintf(vcc_name, MAX_VCC_NAME, "vcc-opt%u", res.a1);
                                                 ~^   ~~~~~~
                                                 %lu
    drivers/ufs/host/ufs-mediatek.c: In function ufs_mtk_system_suspend:
    drivers/ufs/host/ufs-mediatek.c:1371:8: error: implicit declaration of function ufshcd_system_suspend; did you mean ufs_mtk_system_suspend? [-Werror=implicit-function-declaration]
      ret = ufshcd_system_suspend(dev);
            ^~~~~~~~~~~~~~~~~~~~~
            ufs_mtk_system_suspend
    drivers/ufs/host/ufs-mediatek.c: In function ufs_mtk_system_resume:
    drivers/ufs/host/ufs-mediatek.c:1386:9: error: implicit declaration of function ufshcd_system_resume; did you mean ufs_mtk_system_resume? [-Werror=implicit-function-declaration]
      return ufshcd_system_resume(dev);
             ^~~~~~~~~~~~~~~~~~~~
             ufs_mtk_system_resume
    cc1: some warnings being treated as errors
    
    The declaration of func "ufshcd_system_suspend()" depends on
    CONFIG_PM_SLEEP, so the function wrapper ufs_mtk_system_suspend() should
    wrapped by CONFIG_PM_SLEEP too.
    
    Link: https://lore.kernel.org/r/20220619115432.205504-1-renzhijie2@huawei.com
    Fixes: 3fd23b8dfb54 ("scsi: ufs: ufs-mediatek: Fix the timing of configuring device regulators")
    Reported-by: Hulk Robot <hulkci@huawei.com>
    Reviewed-by: Stanley Chu <stanley.chu@mediatek.com>
    Signed-off-by: Ren Zhijie <renzhijie2@huawei.com>
    Signed-off-by: Martin K. Petersen <martin.petersen@oracle.com>

commit 34705a57e7df97d161324263c103c4d4d120dfe7
Author: Javier Martinez Canillas <javierm@redhat.com>
Date:   Fri Jun 10 11:00:05 2022 +0200

    efi: sysfb_efi: remove unnecessary <asm/efi.h> include
    
    Nothing defined in the header is used by drivers/firmware/efi/sysfb_efi.c
    but also, including it can lead to build errors when built on arches that
    don't have an asm/efi.h header file.
    
    This can happen for example if a driver that is built when COMPILE_TEST is
    enabled selects the SYSFB symbol, e.g. on powerpc with allyesconfig:
    
    drivers/firmware/efi/sysfb_efi.c:29:10: fatal error: asm/efi.h: No such file or directory
       29 | #include <asm/efi.h>
          |          ^~~~~~~~~~~
    
    Reported-by: Stephen Rothwell <sfr@canb.auug.org.au>
    Signed-off-by: Javier Martinez Canillas <javierm@redhat.com>
    Signed-off-by: Ard Biesheuvel <ardb@kernel.org>

commit 0f95ee9a0c579ebed0309657f6918673927189f2
Merge: b13baccc3850 dfa687bffc8a
Author: Daniel Vetter <daniel.vetter@ffwll.ch>
Date:   Wed Jun 15 19:12:17 2022 +0200

    Merge tag 'drm-misc-next-2022-06-08' of git://anongit.freedesktop.org/drm/drm-misc into drm-next
    
    drm-misc-next for 5.20:
    
    UAPI Changes:
    
     * connector: export bpc limits in debugfs
    
     * dma-buf: Print buffer name in debugfs
    
    Cross-subsystem Changes:
    
     * dma-buf: Improve dma-fence handling; Cleanups
    
     * fbdev: Device-unregistering fixes
    
    Core Changes:
    
     * client: Only use driver-validated modes to avoid blank screen
    
     * dp-aux: Make probing more reliable; Small fixes
    
     * edit: CEA data-block iterators; Introduce struct drm_edid; Many cleanups
    
     * gem: Don't use framebuffer format's non-exising color planes
    
     * probe-helper: Use 640x480 as DisplayPort fallback; Refactoring
    
     * scheduler: Don't kill jobs in interrupt context
    
    Driver Changes:
    
     * amdgpu: Use atomic fence helpers in DM; Fix VRAM address calculation;
       Export CRTC bpc settings via debugfs
    
     * bridge: Add TI-DLPC3433;  anx7625: Fixes;  fy07024di26a30d: Optional
       GPIO reset;  icn6211: Cleanups;  ldb: Add reg and reg-name properties
       to bindings, Kconfig fixes;  lt9611: Fix display sensing;  lt9611uxc:
       Fixes;  nwl-dsi: Fixes;  ps8640: Cleanups;  st7735r: Fixes;  tc358767:
       DSI/DPI refactoring and DSI-to-eDP support, Fixes; ti-sn65dsi83:
       Fixes;
    
     * gma500: Cleanup connector I2C handling
    
     * hyperv: Unify VRAM allocation of Gen1 and Gen2
    
     * i915: export CRTC bpc settings via debugfs
    
     * meson: Support YUV422 output; Refcount fixes
    
     * mgag200: Support damage clipping; Support gamma handling; Protect
       concurrent HW access; Fixes to connector; Store model-specific limits
       in device-info structure; Cleanups
    
     * nouveau: Fixes and Cleanups
    
     * panel: Kconfig fixes
    
     * panfrost: Valhall support
    
     * r128: Fix bit-shift overflow
    
     * rockchip: Locking fixes in error path; Minor cleanups
    
     * ssd130x: Fix built-in linkage
    
     * ttm: Cleanups
    
     * udl; Always advertize VGA connector
    
     * fbdev/vesa: Support COMPILE_TEST
    
    Signed-off-by: Daniel Vetter <daniel.vetter@ffwll.ch>
    From: Thomas Zimmermann <tzimmermann@suse.de>
    Link: https://patchwork.freedesktop.org/patch/msgid/YqBtumw05JZDEZE2@linux-uq9g

commit 795285ef242543bb636556b7225f20adb7d3795c
Author: Mark Brown <broonie@kernel.org>
Date:   Tue Jun 14 13:10:45 2022 +0100

    selftests: Fix clang cross compilation
    
    Unlike GCC clang uses a single compiler image to support multiple target
    architectures meaning that we can't simply rely on CROSS_COMPILE to select
    the output architecture. Instead we must pass --target to the compiler to
    tell it what to output, kselftest was not doing this so cross compilation
    of kselftest using clang resulted in kselftest being built for the host
    architecture.
    
    More work is required to fix tests using custom rules but this gets the
    bulk of things building.
    
    Signed-off-by: Mark Brown <broonie@kernel.org>
    Signed-off-by: Shuah Khan <skhan@linuxfoundation.org>

commit a7a41dd4730303bc9579f11090e88371d72662a2
Author: Pierre-Louis Bossart <pierre-louis.bossart@linux.intel.com>
Date:   Tue May 17 12:26:46 2022 -0500

    ASoC: max98357a: remove dependency on GPIOLIB
    
    [ Upstream commit 21ca3274333f5c1cbbf9d91e5b33f4f2463859b2 ]
    
    commit dcc2c012c7691 ("ASoC: Fix gpiolib dependencies") removed a
    series of unnecessary dependencies on GPIOLIB when the gpio was
    optional.
    
    A similar simplification seems valid for max98357a, so remove the
    dependency as well. This will avoid the following warning
    
       WARNING: unmet direct dependencies detected for SND_SOC_MAX98357A
         Depends on [n]: SOUND [=y] && !UML && SND [=y] && SND_SOC [=y] && GPIOLIB [=n]
         Selected by [y]:
         - SND_SOC_INTEL_SOF_CS42L42_MACH [=y] && SOUND [=y] && !UML &&
           SND [=y] && SND_SOC [=y] && SND_SOC_INTEL_MACH [=y] &&
           (SND_SOC_SOF_HDA_LINK [=y] || SND_SOC_SOF_BAYTRAIL [=n]) && I2C
           [=y] && ACPI [=y] && SND_HDA_CODEC_HDMI [=y] &&
           SND_SOC_SOF_HDA_AUDIO_CODEC [=y] && (MFD_INTEL_LPSS [=y] ||
           COMPILE_TEST [=n])
    
    Reported-by: kernel test robot <yujie.liu@intel.com>
    Signed-off-by: Pierre-Louis Bossart <pierre-louis.bossart@linux.intel.com>
    Reviewed-by: Pter Ujfalusi <peter.ujfalusi@linux.intel.com>
    Link: https://lore.kernel.org/r/20220517172647.468244-2-pierre-louis.bossart@linux.intel.com
    Signed-off-by: Mark Brown <broonie@kernel.org>
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit 0d4e57e5af39fef28de6c89b0b97741dedb4b72f
Author: Javier Martinez Canillas <javierm@redhat.com>
Date:   Fri Jun 10 10:54:50 2022 +0200

    Revert "fbdev: vesafb: Allow to be built if COMPILE_TEST is enabled"
    
    This reverts commit fa0e256450f27a7d85f65c63f05e6897954a1d53. The kernel
    test robot reported that attempting to build the vesafb driver fails on
    some architectures, because these don't define a `struct screen_info`.
    
    This leads to linking errors, for example on parisc with allyesconfig:
    
      hppa-linux-ld: drivers/video/fbdev/vesafb.o: in function `vesafb_probe':
    >> (.text+0x738): undefined reference to `screen_info'
    >> hppa-linux-ld: (.text+0x73c): undefined reference to `screen_info'
       hppa-linux-ld: drivers/firmware/sysfb.o: in function `sysfb_init':
    >> (.init.text+0x28): undefined reference to `screen_info'
    >> hppa-linux-ld: (.init.text+0x30): undefined reference to `screen_info'
       hppa-linux-ld: (.init.text+0x78): undefined reference to `screen_info'
    
    The goal of commit fa0e256450f2 ("fbdev: vesafb: Allow to be built if
    COMPILE_TEST is enabled") was to have more build coverage for the driver
    but it wrongly assumed that all architectures would define a screen_info.
    
    Reported-by: kernel test robot <lkp@intel.com>
    Signed-off-by: Javier Martinez Canillas <javierm@redhat.com>
    Acked-by: Daniel Vetter <daniel.vetter@ffwll.ch>
    Link: https://patchwork.freedesktop.org/patch/msgid/20220610085450.1341880-1-javierm@redhat.com

commit b13c9dfae75b24707a5a6326ae1f8a8a82763073
Author: Pierre-Louis Bossart <pierre-louis.bossart@linux.intel.com>
Date:   Tue May 17 12:26:47 2022 -0500

    ASoC: rt1015p: remove dependency on GPIOLIB
    
    [ Upstream commit b390c25c6757b9d56cecdfbf6d55f15fc89a6386 ]
    
    commit dcc2c012c7691 ("ASoC: Fix gpiolib dependencies") removed a
    series of unnecessary dependencies on GPIOLIB when the gpio was
    optional.
    
    A similar simplification seems valid for rt1015p, so remove the
    dependency as well. This will avoid the following warning
    
      WARNING: unmet direct dependencies detected for SND_SOC_RT1015P
    
         Depends on [n]: SOUND [=y] && !UML && SND [=y] && SND_SOC [=y] &&
         GPIOLIB [=n]
    
         Selected by [y]:
    
         - SND_SOC_INTEL_SOF_RT5682_MACH [=y] && SOUND [=y] && !UML && SND
           [=y] && SND_SOC [=y] && SND_SOC_INTEL_MACH [=y] &&
           (SND_SOC_SOF_HDA_LINK [=y] || SND_SOC_SOF_BAYTRAIL [=n]) && I2C
           [=y] && ACPI [=y] && (SND_HDA_CODEC_HDMI [=y] &&
           SND_SOC_SOF_HDA_AUDIO_CODEC [=y] && (MFD_INTEL_LPSS [=y] ||
           COMPILE_TEST [=y]) || SND_SOC_SOF_BAYTRAIL [=n] &&
           (X86_INTEL_LPSS [=n] || COMPILE_TEST [=y]))
    
    Reported-by: kernel test robot <yujie.liu@intel.com>
    Signed-off-by: Pierre-Louis Bossart <pierre-louis.bossart@linux.intel.com>
    Reviewed-by: Pter Ujfalusi <peter.ujfalusi@linux.intel.com>
    Link: https://lore.kernel.org/r/20220517172647.468244-3-pierre-louis.bossart@linux.intel.com
    Signed-off-by: Mark Brown <broonie@kernel.org>
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit 2b0b83e69839ea2208049c80a4efa33528836007
Author: Pierre-Louis Bossart <pierre-louis.bossart@linux.intel.com>
Date:   Tue May 17 12:26:46 2022 -0500

    ASoC: max98357a: remove dependency on GPIOLIB
    
    [ Upstream commit 21ca3274333f5c1cbbf9d91e5b33f4f2463859b2 ]
    
    commit dcc2c012c7691 ("ASoC: Fix gpiolib dependencies") removed a
    series of unnecessary dependencies on GPIOLIB when the gpio was
    optional.
    
    A similar simplification seems valid for max98357a, so remove the
    dependency as well. This will avoid the following warning
    
       WARNING: unmet direct dependencies detected for SND_SOC_MAX98357A
         Depends on [n]: SOUND [=y] && !UML && SND [=y] && SND_SOC [=y] && GPIOLIB [=n]
         Selected by [y]:
         - SND_SOC_INTEL_SOF_CS42L42_MACH [=y] && SOUND [=y] && !UML &&
           SND [=y] && SND_SOC [=y] && SND_SOC_INTEL_MACH [=y] &&
           (SND_SOC_SOF_HDA_LINK [=y] || SND_SOC_SOF_BAYTRAIL [=n]) && I2C
           [=y] && ACPI [=y] && SND_HDA_CODEC_HDMI [=y] &&
           SND_SOC_SOF_HDA_AUDIO_CODEC [=y] && (MFD_INTEL_LPSS [=y] ||
           COMPILE_TEST [=n])
    
    Reported-by: kernel test robot <yujie.liu@intel.com>
    Signed-off-by: Pierre-Louis Bossart <pierre-louis.bossart@linux.intel.com>
    Reviewed-by: Pter Ujfalusi <peter.ujfalusi@linux.intel.com>
    Link: https://lore.kernel.org/r/20220517172647.468244-2-pierre-louis.bossart@linux.intel.com
    Signed-off-by: Mark Brown <broonie@kernel.org>
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit 94ef12d77b729482d6063894fc4e61e26dd5967c
Author: Pierre-Louis Bossart <pierre-louis.bossart@linux.intel.com>
Date:   Tue May 17 12:26:47 2022 -0500

    ASoC: rt1015p: remove dependency on GPIOLIB
    
    [ Upstream commit b390c25c6757b9d56cecdfbf6d55f15fc89a6386 ]
    
    commit dcc2c012c7691 ("ASoC: Fix gpiolib dependencies") removed a
    series of unnecessary dependencies on GPIOLIB when the gpio was
    optional.
    
    A similar simplification seems valid for rt1015p, so remove the
    dependency as well. This will avoid the following warning
    
      WARNING: unmet direct dependencies detected for SND_SOC_RT1015P
    
         Depends on [n]: SOUND [=y] && !UML && SND [=y] && SND_SOC [=y] &&
         GPIOLIB [=n]
    
         Selected by [y]:
    
         - SND_SOC_INTEL_SOF_RT5682_MACH [=y] && SOUND [=y] && !UML && SND
           [=y] && SND_SOC [=y] && SND_SOC_INTEL_MACH [=y] &&
           (SND_SOC_SOF_HDA_LINK [=y] || SND_SOC_SOF_BAYTRAIL [=n]) && I2C
           [=y] && ACPI [=y] && (SND_HDA_CODEC_HDMI [=y] &&
           SND_SOC_SOF_HDA_AUDIO_CODEC [=y] && (MFD_INTEL_LPSS [=y] ||
           COMPILE_TEST [=y]) || SND_SOC_SOF_BAYTRAIL [=n] &&
           (X86_INTEL_LPSS [=n] || COMPILE_TEST [=y]))
    
    Reported-by: kernel test robot <yujie.liu@intel.com>
    Signed-off-by: Pierre-Louis Bossart <pierre-louis.bossart@linux.intel.com>
    Reviewed-by: Pter Ujfalusi <peter.ujfalusi@linux.intel.com>
    Link: https://lore.kernel.org/r/20220517172647.468244-3-pierre-louis.bossart@linux.intel.com
    Signed-off-by: Mark Brown <broonie@kernel.org>
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit 16b75af88b5bc4fca4042cb00fe177bf7b0a2025
Author: Pierre-Louis Bossart <pierre-louis.bossart@linux.intel.com>
Date:   Tue May 17 12:26:46 2022 -0500

    ASoC: max98357a: remove dependency on GPIOLIB
    
    [ Upstream commit 21ca3274333f5c1cbbf9d91e5b33f4f2463859b2 ]
    
    commit dcc2c012c7691 ("ASoC: Fix gpiolib dependencies") removed a
    series of unnecessary dependencies on GPIOLIB when the gpio was
    optional.
    
    A similar simplification seems valid for max98357a, so remove the
    dependency as well. This will avoid the following warning
    
       WARNING: unmet direct dependencies detected for SND_SOC_MAX98357A
         Depends on [n]: SOUND [=y] && !UML && SND [=y] && SND_SOC [=y] && GPIOLIB [=n]
         Selected by [y]:
         - SND_SOC_INTEL_SOF_CS42L42_MACH [=y] && SOUND [=y] && !UML &&
           SND [=y] && SND_SOC [=y] && SND_SOC_INTEL_MACH [=y] &&
           (SND_SOC_SOF_HDA_LINK [=y] || SND_SOC_SOF_BAYTRAIL [=n]) && I2C
           [=y] && ACPI [=y] && SND_HDA_CODEC_HDMI [=y] &&
           SND_SOC_SOF_HDA_AUDIO_CODEC [=y] && (MFD_INTEL_LPSS [=y] ||
           COMPILE_TEST [=n])
    
    Reported-by: kernel test robot <yujie.liu@intel.com>
    Signed-off-by: Pierre-Louis Bossart <pierre-louis.bossart@linux.intel.com>
    Reviewed-by: Pter Ujfalusi <peter.ujfalusi@linux.intel.com>
    Link: https://lore.kernel.org/r/20220517172647.468244-2-pierre-louis.bossart@linux.intel.com
    Signed-off-by: Mark Brown <broonie@kernel.org>
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit 649689f49ad95d19b121c21e74eaa1fabb140c24
Author: Pierre-Louis Bossart <pierre-louis.bossart@linux.intel.com>
Date:   Tue May 17 12:26:47 2022 -0500

    ASoC: rt1015p: remove dependency on GPIOLIB
    
    [ Upstream commit b390c25c6757b9d56cecdfbf6d55f15fc89a6386 ]
    
    commit dcc2c012c7691 ("ASoC: Fix gpiolib dependencies") removed a
    series of unnecessary dependencies on GPIOLIB when the gpio was
    optional.
    
    A similar simplification seems valid for rt1015p, so remove the
    dependency as well. This will avoid the following warning
    
      WARNING: unmet direct dependencies detected for SND_SOC_RT1015P
    
         Depends on [n]: SOUND [=y] && !UML && SND [=y] && SND_SOC [=y] &&
         GPIOLIB [=n]
    
         Selected by [y]:
    
         - SND_SOC_INTEL_SOF_RT5682_MACH [=y] && SOUND [=y] && !UML && SND
           [=y] && SND_SOC [=y] && SND_SOC_INTEL_MACH [=y] &&
           (SND_SOC_SOF_HDA_LINK [=y] || SND_SOC_SOF_BAYTRAIL [=n]) && I2C
           [=y] && ACPI [=y] && (SND_HDA_CODEC_HDMI [=y] &&
           SND_SOC_SOF_HDA_AUDIO_CODEC [=y] && (MFD_INTEL_LPSS [=y] ||
           COMPILE_TEST [=y]) || SND_SOC_SOF_BAYTRAIL [=n] &&
           (X86_INTEL_LPSS [=n] || COMPILE_TEST [=y]))
    
    Reported-by: kernel test robot <yujie.liu@intel.com>
    Signed-off-by: Pierre-Louis Bossart <pierre-louis.bossart@linux.intel.com>
    Reviewed-by: Pter Ujfalusi <peter.ujfalusi@linux.intel.com>
    Link: https://lore.kernel.org/r/20220517172647.468244-3-pierre-louis.bossart@linux.intel.com
    Signed-off-by: Mark Brown <broonie@kernel.org>
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit f8ceb9745ba71bac088b459b4689d77515cc2800
Author: Pierre-Louis Bossart <pierre-louis.bossart@linux.intel.com>
Date:   Tue May 17 12:26:46 2022 -0500

    ASoC: max98357a: remove dependency on GPIOLIB
    
    [ Upstream commit 21ca3274333f5c1cbbf9d91e5b33f4f2463859b2 ]
    
    commit dcc2c012c7691 ("ASoC: Fix gpiolib dependencies") removed a
    series of unnecessary dependencies on GPIOLIB when the gpio was
    optional.
    
    A similar simplification seems valid for max98357a, so remove the
    dependency as well. This will avoid the following warning
    
       WARNING: unmet direct dependencies detected for SND_SOC_MAX98357A
         Depends on [n]: SOUND [=y] && !UML && SND [=y] && SND_SOC [=y] && GPIOLIB [=n]
         Selected by [y]:
         - SND_SOC_INTEL_SOF_CS42L42_MACH [=y] && SOUND [=y] && !UML &&
           SND [=y] && SND_SOC [=y] && SND_SOC_INTEL_MACH [=y] &&
           (SND_SOC_SOF_HDA_LINK [=y] || SND_SOC_SOF_BAYTRAIL [=n]) && I2C
           [=y] && ACPI [=y] && SND_HDA_CODEC_HDMI [=y] &&
           SND_SOC_SOF_HDA_AUDIO_CODEC [=y] && (MFD_INTEL_LPSS [=y] ||
           COMPILE_TEST [=n])
    
    Reported-by: kernel test robot <yujie.liu@intel.com>
    Signed-off-by: Pierre-Louis Bossart <pierre-louis.bossart@linux.intel.com>
    Reviewed-by: Pter Ujfalusi <peter.ujfalusi@linux.intel.com>
    Link: https://lore.kernel.org/r/20220517172647.468244-2-pierre-louis.bossart@linux.intel.com
    Signed-off-by: Mark Brown <broonie@kernel.org>
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit ff383c18799d12f9583f7d824c70c2e78d7b832f
Author: Pierre-Louis Bossart <pierre-louis.bossart@linux.intel.com>
Date:   Tue May 17 12:26:47 2022 -0500

    ASoC: rt1015p: remove dependency on GPIOLIB
    
    [ Upstream commit b390c25c6757b9d56cecdfbf6d55f15fc89a6386 ]
    
    commit dcc2c012c7691 ("ASoC: Fix gpiolib dependencies") removed a
    series of unnecessary dependencies on GPIOLIB when the gpio was
    optional.
    
    A similar simplification seems valid for rt1015p, so remove the
    dependency as well. This will avoid the following warning
    
      WARNING: unmet direct dependencies detected for SND_SOC_RT1015P
    
         Depends on [n]: SOUND [=y] && !UML && SND [=y] && SND_SOC [=y] &&
         GPIOLIB [=n]
    
         Selected by [y]:
    
         - SND_SOC_INTEL_SOF_RT5682_MACH [=y] && SOUND [=y] && !UML && SND
           [=y] && SND_SOC [=y] && SND_SOC_INTEL_MACH [=y] &&
           (SND_SOC_SOF_HDA_LINK [=y] || SND_SOC_SOF_BAYTRAIL [=n]) && I2C
           [=y] && ACPI [=y] && (SND_HDA_CODEC_HDMI [=y] &&
           SND_SOC_SOF_HDA_AUDIO_CODEC [=y] && (MFD_INTEL_LPSS [=y] ||
           COMPILE_TEST [=y]) || SND_SOC_SOF_BAYTRAIL [=n] &&
           (X86_INTEL_LPSS [=n] || COMPILE_TEST [=y]))
    
    Reported-by: kernel test robot <yujie.liu@intel.com>
    Signed-off-by: Pierre-Louis Bossart <pierre-louis.bossart@linux.intel.com>
    Reviewed-by: Pter Ujfalusi <peter.ujfalusi@linux.intel.com>
    Link: https://lore.kernel.org/r/20220517172647.468244-3-pierre-louis.bossart@linux.intel.com
    Signed-off-by: Mark Brown <broonie@kernel.org>
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit c73aee194680523db642a180303978a04f41c21d
Author: Pierre-Louis Bossart <pierre-louis.bossart@linux.intel.com>
Date:   Tue May 17 12:26:46 2022 -0500

    ASoC: max98357a: remove dependency on GPIOLIB
    
    [ Upstream commit 21ca3274333f5c1cbbf9d91e5b33f4f2463859b2 ]
    
    commit dcc2c012c7691 ("ASoC: Fix gpiolib dependencies") removed a
    series of unnecessary dependencies on GPIOLIB when the gpio was
    optional.
    
    A similar simplification seems valid for max98357a, so remove the
    dependency as well. This will avoid the following warning
    
       WARNING: unmet direct dependencies detected for SND_SOC_MAX98357A
         Depends on [n]: SOUND [=y] && !UML && SND [=y] && SND_SOC [=y] && GPIOLIB [=n]
         Selected by [y]:
         - SND_SOC_INTEL_SOF_CS42L42_MACH [=y] && SOUND [=y] && !UML &&
           SND [=y] && SND_SOC [=y] && SND_SOC_INTEL_MACH [=y] &&
           (SND_SOC_SOF_HDA_LINK [=y] || SND_SOC_SOF_BAYTRAIL [=n]) && I2C
           [=y] && ACPI [=y] && SND_HDA_CODEC_HDMI [=y] &&
           SND_SOC_SOF_HDA_AUDIO_CODEC [=y] && (MFD_INTEL_LPSS [=y] ||
           COMPILE_TEST [=n])
    
    Reported-by: kernel test robot <yujie.liu@intel.com>
    Signed-off-by: Pierre-Louis Bossart <pierre-louis.bossart@linux.intel.com>
    Reviewed-by: Pter Ujfalusi <peter.ujfalusi@linux.intel.com>
    Link: https://lore.kernel.org/r/20220517172647.468244-2-pierre-louis.bossart@linux.intel.com
    Signed-off-by: Mark Brown <broonie@kernel.org>
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit 120f1d95efb1cdb6fe023c84e38ba06d8f78cd03
Author: Helge Deller <deller@gmx.de>
Date:   Tue May 31 22:09:27 2022 +0200

    scsi: mpt3sas: Fix out-of-bounds compiler warning
    
    I'm facing this warning when building for the parisc64 architecture:
    
    drivers/scsi/mpt3sas/mpt3sas_base.c: In function _base_make_ioc_operational:
    drivers/scsi/mpt3sas/mpt3sas_base.c:5396:40: warning: array subscript Mpi2SasIOUnitPage1_t {aka struct _MPI2_CONFIG_PAGE_SASIOUNIT_1}[0] is partly outside array bounds of unsigned char[20] [-Warray-bounds]
     5396 |             (le16_to_cpu(sas_iounit_pg1->SASWideMaxQueueDepth)) ?
    drivers/scsi/mpt3sas/mpt3sas_base.c:5382:26: note: referencing an object of size 20 allocated by kzalloc
     5382 |         sas_iounit_pg1 = kzalloc(sz, GFP_KERNEL);
          |                          ^~~~~~~~~~~~~~~~~~~~~~~
    
    The problem is, that only 20 bytes are allocated with kmalloc(), which is
    sufficient to hold the bytes which are needed.  Nevertheless, gcc complains
    because the whole Mpi2SasIOUnitPage1_t struct is 32 bytes in size and thus
    doesn't fit into those 20 bytes.
    
    This patch simply allocates all 32 bytes (instead of 20) and thus avoids
    the warning. There is no functional change introduced by this patch.
    
    While touching the code I cleaned up to calculation of max_wideport_qd,
    max_narrowport_qd and max_sata_qd to make it easier readable.
    
    Test successfully tested on a HP C8000 PA-RISC workstation with 64-bit
    kernel.
    
    Link: https://lore.kernel.org/r/YpZ197iZdDZSCzrT@p100
    Signed-off-by: Helge Deller <deller@gmx.de>
    Signed-off-by: Martin K. Petersen <martin.petersen@oracle.com>

commit ff979b2a9d9779382030023bfc4e3b1989c8c314
Author: Chengming Zhou <zhouchengming@bytedance.com>
Date:   Fri May 6 11:27:37 2022 +0800

    ftrace/fgraph: fix increased missing-prototypes warnings
    
    After commit e999995c84c3 ("ftrace: cleanup ftrace_graph_caller enable
    and disable") merged into the linux-next tree, the kernel test robot
    (lkp@intel.com) has send out report that there are increased missing-prototypes
    warnings caused by that commit.
    
    COMPILER_INSTALL_PATH=$HOME/0day COMPILER=gcc-11.3.0 make.cross W=1 \
            O=build_dir ARCH=sh SHELL=/bin/bash kernel/trace/
    warning: no previous prototype for 'ftrace_enable_ftrace_graph_caller' [-Wmissing-prototypes]
    warning: no previous prototype for 'ftrace_disable_ftrace_graph_caller' [-Wmissing-prototypes]
    warning: no previous prototype for 'ftrace_return_to_handler' [-Wmissing-prototypes]
    warning: no previous prototype for 'ftrace_graph_sleep_time_control' [-Wmissing-prototypes]
    
    BTW there are so many missing-prototypes warnings if build kernel with "W=1".
    
    The increased warnings for 'ftrace_[enable,disable]_ftrace_graph_caller'
    is caused by CONFIG_FUNCTION_GRAPH_TRACER && !CONFIG_DYNAMIC_FTRACE,
    so the declarations in <linux/ftrace.h> can't be seen in fgraph.c.
    
    And this warning can't reproduce on x86_64 since x86_64 select
    HAVE_FUNCTION_GRAPH_TRACER only when DYNAMIC_FTRACE, so fgraph.c will
    always see the declarations in <linux/ftrace.h>.
    
    This patch fix the increased warnings by put the definitions in
    CONFIG_DYNAMIC_FTRACE although there are no real problems exist.
    
    Signed-off-by: Chengming Zhou <zhouchengming@bytedance.com>
    Acked-by: Steven Rostedt (Google) <rostedt@goodmis.org>
    Link: https://lore.kernel.org/r/20220506032737.23375-1-zhouchengming@bytedance.com
    Signed-off-by: Catalin Marinas <catalin.marinas@arm.com>

commit d0789070a851d0d9a688bf8cbdc6b50805e21c41
Author: Dmitry Torokhov <dmitry.torokhov@gmail.com>
Date:   Wed May 25 13:24:01 2022 -0700

    Input: mtk-pmic-keys - allow compiling with COMPILE_TEST
    
    There are no hard architecture dependencies in the driver, so to improve
    compile test coverage let's enable the driver when COMPILE_TEST is
    selected.
    
    Reviewed-by: Mattijs Korpershoek <mkorpershoek@baylibre.com>
    Link: https://lore.kernel.org/r/YowG7BVsJTNd0ELi@google.com
    Signed-off-by: Dmitry Torokhov <dmitry.torokhov@gmail.com>

commit 534671e0ef5b652d6a983bc1c85c339f7dbfe6ce
Author: Masahiro Yamada <masahiroy@kernel.org>
Date:   Fri May 27 23:39:31 2022 +0900

    parisc: remove arch/parisc/nm
    
    Parisc overrides 'nm' with a shell script. I was hit by a false-positive
    error of $(NM) because this script returns the exit status of grep
    instead of ${CROSS_COMPILE}nm. (grep returns 1 if no lines were selected)
    
    I tried to fix it, but in the code review, Helge suggested to remove it
    entirely. [1]
    
    This script was added in 2003. [2]
    
    Presumably, it was a workaround for old toolchains (but even the parisc
    maintainer does not know the detail any more).
    
    Hopefully, recent tools should work fine.
    
    [1]: https://lore.kernel.org/all/1c12cd26-d8aa-4498-f4c0-29478b9578fe@gmx.de/
    [2]: https://git.kernel.org/pub/scm/linux/kernel/git/history/history.git/commit/?id=36eaa6e4c0e0b6950136b956b72fd08155b92ca3
    
    Suggested-by: Helge Deller <deller@gmx.de>
    Signed-off-by: Masahiro Yamada <masahiroy@kernel.org>
    Acked-by: Helge Deller <deller@gmx.de>

commit 7394d2ebb651a9f62e08c6ab864aac015d27c64d
Author: Cristian Ciocaltea <cristian.ciocaltea@collabora.com>
Date:   Tue May 17 02:46:46 2022 +0300

    scripts/tags.sh: Invoke 'realpath' via 'xargs'
    
    When COMPILED_SOURCE is set, running
    
      make ARCH=x86_64 COMPILED_SOURCE=1 cscope tags
    
    could throw the following errors:
    
    scripts/tags.sh: line 98: /usr/bin/realpath: Argument list too long
    cscope: no source files found
    scripts/tags.sh: line 98: /usr/bin/realpath: Argument list too long
    ctags: No files specified. Try "ctags --help".
    
    This is most likely to happen when the kernel is configured to build a
    large number of modules, which has the consequence of passing too many
    arguments when calling 'realpath' in 'all_compiled_sources()'.
    
    Let's improve this by invoking 'realpath' through 'xargs', which takes
    care of properly limiting the argument list.
    
    Signed-off-by: Cristian Ciocaltea <cristian.ciocaltea@collabora.com>
    Link: https://lore.kernel.org/r/20220516234646.531208-1-cristian.ciocaltea@collabora.com
    Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>

commit b390c25c6757b9d56cecdfbf6d55f15fc89a6386
Author: Pierre-Louis Bossart <pierre-louis.bossart@linux.intel.com>
Date:   Tue May 17 12:26:47 2022 -0500

    ASoC: rt1015p: remove dependency on GPIOLIB
    
    commit dcc2c012c7691 ("ASoC: Fix gpiolib dependencies") removed a
    series of unnecessary dependencies on GPIOLIB when the gpio was
    optional.
    
    A similar simplification seems valid for rt1015p, so remove the
    dependency as well. This will avoid the following warning
    
      WARNING: unmet direct dependencies detected for SND_SOC_RT1015P
    
         Depends on [n]: SOUND [=y] && !UML && SND [=y] && SND_SOC [=y] &&
         GPIOLIB [=n]
    
         Selected by [y]:
    
         - SND_SOC_INTEL_SOF_RT5682_MACH [=y] && SOUND [=y] && !UML && SND
           [=y] && SND_SOC [=y] && SND_SOC_INTEL_MACH [=y] &&
           (SND_SOC_SOF_HDA_LINK [=y] || SND_SOC_SOF_BAYTRAIL [=n]) && I2C
           [=y] && ACPI [=y] && (SND_HDA_CODEC_HDMI [=y] &&
           SND_SOC_SOF_HDA_AUDIO_CODEC [=y] && (MFD_INTEL_LPSS [=y] ||
           COMPILE_TEST [=y]) || SND_SOC_SOF_BAYTRAIL [=n] &&
           (X86_INTEL_LPSS [=n] || COMPILE_TEST [=y]))
    
    Reported-by: kernel test robot <yujie.liu@intel.com>
    Signed-off-by: Pierre-Louis Bossart <pierre-louis.bossart@linux.intel.com>
    Reviewed-by: Pter Ujfalusi <peter.ujfalusi@linux.intel.com>
    Link: https://lore.kernel.org/r/20220517172647.468244-3-pierre-louis.bossart@linux.intel.com
    Signed-off-by: Mark Brown <broonie@kernel.org>

commit 21ca3274333f5c1cbbf9d91e5b33f4f2463859b2
Author: Pierre-Louis Bossart <pierre-louis.bossart@linux.intel.com>
Date:   Tue May 17 12:26:46 2022 -0500

    ASoC: max98357a: remove dependency on GPIOLIB
    
    commit dcc2c012c7691 ("ASoC: Fix gpiolib dependencies") removed a
    series of unnecessary dependencies on GPIOLIB when the gpio was
    optional.
    
    A similar simplification seems valid for max98357a, so remove the
    dependency as well. This will avoid the following warning
    
       WARNING: unmet direct dependencies detected for SND_SOC_MAX98357A
         Depends on [n]: SOUND [=y] && !UML && SND [=y] && SND_SOC [=y] && GPIOLIB [=n]
         Selected by [y]:
         - SND_SOC_INTEL_SOF_CS42L42_MACH [=y] && SOUND [=y] && !UML &&
           SND [=y] && SND_SOC [=y] && SND_SOC_INTEL_MACH [=y] &&
           (SND_SOC_SOF_HDA_LINK [=y] || SND_SOC_SOF_BAYTRAIL [=n]) && I2C
           [=y] && ACPI [=y] && SND_HDA_CODEC_HDMI [=y] &&
           SND_SOC_SOF_HDA_AUDIO_CODEC [=y] && (MFD_INTEL_LPSS [=y] ||
           COMPILE_TEST [=n])
    
    Reported-by: kernel test robot <yujie.liu@intel.com>
    Signed-off-by: Pierre-Louis Bossart <pierre-louis.bossart@linux.intel.com>
    Reviewed-by: Pter Ujfalusi <peter.ujfalusi@linux.intel.com>
    Link: https://lore.kernel.org/r/20220517172647.468244-2-pierre-louis.bossart@linux.intel.com
    Signed-off-by: Mark Brown <broonie@kernel.org>

commit a71658c7db0b2be9fcab3522aeabe11792a4f481
Author: Dmitry Osipenko <digetx@gmail.com>
Date:   Wed Jan 20 23:58:44 2021 +0300

    regulator: consumer: Add missing stubs to regulator/consumer.h
    
    commit 51dfb6ca3728bd0a0a3c23776a12d2a15a1d2457 upstream.
    
    Add missing stubs to regulator/consumer.h in order to fix COMPILE_TEST
    of the kernel. In particular this should fix compile-testing of OPP core
    because of a missing stub for regulator_sync_voltage().
    
    Reported-by: kernel test robot <lkp@intel.com>
    Signed-off-by: Dmitry Osipenko <digetx@gmail.com>
    Link: https://lore.kernel.org/r/20210120205844.12658-1-digetx@gmail.com
    Signed-off-by: Mark Brown <broonie@kernel.org>
    Cc: Bjrn Mork <bjorn@mork.no>
    Cc: Sudip Mukherjee <sudipm.mukherjee@gmail.com>
    Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>

commit fa0e256450f27a7d85f65c63f05e6897954a1d53
Author: Javier Martinez Canillas <javierm@redhat.com>
Date:   Thu May 5 14:04:18 2022 +0200

    fbdev: vesafb: Allow to be built if COMPILE_TEST is enabled
    
    The driver has runtime but no build time dependency with X86, so it can
    be built for testing purposes if the COMPILE_TEST option is enabled.
    
    This is useful to have more build coverage and make sure that the driver
    is not affected by changes that could cause build regressions.
    
    Signed-off-by: Javier Martinez Canillas <javierm@redhat.com>
    Acked-by: Thomas Zimmermann <tzimmermann@suse.de>
    Link: https://patchwork.freedesktop.org/patch/msgid/20220505120419.314136-1-javierm@redhat.com

commit 827634531e344850106c7ac618a3acb5ac40f6e6
Merge: b3552d6a3b8b 0abb62b68252
Author: Paolo Abeni <pabeni@redhat.com>
Date:   Tue May 10 09:48:11 2022 +0200

    Merge branch 'ptp-support-hardware-clocks-with-additional-free-running-cycle-counter'
    
    Gerhard Engleder says:
    
    ====================
    ptp: Support hardware clocks with additional free running cycle counter
    
    ptp vclocks require a clock with free running time for the timecounter.
    Currently only a physical clock forced to free running is supported.
    If vclocks are used, then the physical clock cannot be synchronized
    anymore. The synchronized time is not available in hardware in this
    case. As a result, timed transmission with TAPRIO hardware support
    is not possible anymore.
    
    If hardware would support a free running time additionally to the
    physical clock, then the physical clock does not need to be forced to
    free running. Thus, the physical clocks can still be synchronized while
    vclocks are in use.
    
    The physical clock could be used to synchronize the time domain of the
    TSN network and trigger TAPRIO. In parallel vclocks can be used to
    synchronize other time domains.
    
    One year ago I thought for two time domains within a TSN network also
    two physical clocks are required. This would lead to new kernel
    interfaces for asking for the second clock, ... . But actually for a
    time triggered system like TSN there can be only one time domain that
    controls the system itself. All other time domains belong to other
    layers, but not to the time triggered system itself. So other time
    domains can be based on a free running counter if similar mechanisms
    like 2 step synchroisation are used.
    
    Synchronisation was tested with two time domains between two directly
    connected hosts. Each host run two ptp4l instances, the first used the
    physical clock and the second used the virtual clock. I used my FPGA
    based network controller as network device. ptp4l was used in
    combination with the virtual clock support patches from Miroslav
    Lichvar.
    
    v4:
    - if_index of 0 is invalid (Jonathan Lemon)
    - set if_index to 0 in the SOF_TIMESTAMPING_RAW_HARDWARE block (Jonathan
      Lemon)
    - add helper function for netdev_get_tstamp() call (Jonathan Lemon)
    - update SKBTX_ANY_TSTAMP (Paolo Abeni)
    - use separate bits for new tx_flags (Richard Cochran)
    
    v3:
    - optimize ptp_convert_timestamp (Richard Cochran)
    - call dev_get_by_napi_id() only if needed (Richard Cochran)
    - use non-negated logical test (Richard Cochran)
    - add comment for skipped output (Richard Cochran)
    - add comment for SKBTX_HW_TSTAMP_USE_CYCLES masking (Richard Cochran)
    
    v2:
    - rename ptp_clock cycles to has_cycles (Richard Cochran)
    - call it free running cycle counter (Richard Cochran)
    - update struct skb_shared_hwtstamps kdoc (Richard Cochran)
    - optimize timestamp address/cookie processing path (Richard Cochran,
      Vinicius Costa Gomes)
    
    v1:
    - complete rework based on suggestions (Richard Cochran)
    ====================
    
    Link: https://lore.kernel.org/r/20220506200142.3329-1-gerhard@engleder-embedded.com
    Signed-off-by: Paolo Abeni <pabeni@redhat.com>

commit 1901300bf356a74437117464e19fc5f278f88d9a
Merge: 68edb53a4f4b 2a21f9e6d9a4
Author: Arnd Bergmann <arnd@arndb.de>
Date:   Mon May 9 23:09:09 2022 +0200

    Merge tag 'ti-driver-soc-for-v5.19' of git://git.kernel.org/pub/scm/linux/kernel/git/ti/linux into arm/drivers
    
    TI Driver updates for v5.19
    
    * wkup_m3: io isolation, voltage scaling, vtt regulator and a debug option to stop m3 in suspend.
    * tisci: support for polled mode for system suspend, reset driver is now enabled for COMPILE_TEST
    * knav, dma.. misc cleanups for IS_ERR, pm_run_time*, and various other fixups.
    
    * tag 'ti-driver-soc-for-v5.19' of git://git.kernel.org/pub/scm/linux/kernel/git/ti/linux:
      soc: ti: wkup_m3_ipc: Add debug option to halt m3 in suspend
      soc: ti: wkup_m3_ipc: Add support for i2c voltage scaling
      soc: ti: wkup_m3_ipc: Add support for IO Isolation
      soc: ti: knav_qmss_queue: Use IS_ERR instead of IS_ERR_OR_NULL when checking knav_queue_open() result
      soc: ti: pm33xx: using pm_runtime_resume_and_get instead of pm_runtime_get_sync
      firmware: ti_sci: Switch transport to polled mode during system suspend
      soc: ti: wkup_m3_ipc: Add support for toggling VTT regulator
      soc: ti: knav_qmss_queue: Use pm_runtime_resume_and_get instead of pm_runtime_get_sync
      soc: ti: knav_dma: Use pm_runtime_resume_and_get instead of pm_runtime_get_sync
      reset: ti-sci: Allow building under COMPILE_TEST
      soc: ti: ti_sci_pm_domains: Check for null return of devm_kcalloc
      soc: ti: omap_prm: Use of_device_get_match_data()
      soc: ti: pruss: using pm_runtime_resume_and_get instead of pm_runtime_get_sync
      soc: ti: replace usage of found with dedicated list iterator variable
      soc: ti: wkup_m3_ipc: fix platform_get_irq.cocci warning
    
    Link: https://lore.kernel.org/r/20220507163424.pvqnwrxpoo73lmp2@debtless
    Signed-off-by: Arnd Bergmann <arnd@arndb.de>

commit 5c3b407bd1f3f6ae77876775c109380bb701e1b1
Author: Krzysztof Kozlowski <krzysztof.kozlowski@linaro.org>
Date:   Wed Apr 20 16:14:07 2022 +0200

    pinctrl: samsung: fix missing GPIOLIB on ARM64 Exynos config
    
    commit ac875df4d854ab13d9c4af682a1837a1214fecec upstream.
    
    The Samsung pinctrl drivers depend on OF_GPIO, which is part of GPIOLIB.
    ARMv7 Exynos platform selects GPIOLIB and Samsung pinctrl drivers. ARMv8
    Exynos selects only the latter leading to possible wrong configuration
    on ARMv8 build:
    
      WARNING: unmet direct dependencies detected for PINCTRL_EXYNOS
        Depends on [n]: PINCTRL [=y] && OF_GPIO [=n] && (ARCH_EXYNOS [=y] || ARCH_S5PV210 || COMPILE_TEST [=y])
        Selected by [y]:
        - ARCH_EXYNOS [=y]
    
    Always select the GPIOLIB from the Samsung pinctrl drivers to fix the
    issue.  This requires removing of OF_GPIO dependency (to avoid recursive
    dependency), so add dependency on OF for COMPILE_TEST cases.
    
    Reported-by: Necip Fazil Yildiran <fazilyildiran@gmail.com>
    Fixes: eed6b3eb20b9 ("arm64: Split out platform options to separate Kconfig")
    Cc: <stable@vger.kernel.org>
    Signed-off-by: Krzysztof Kozlowski <krzysztof.kozlowski@linaro.org>
    Reviewed-by: Arnd Bergmann <arnd@arndb.de>
    Link: https://lore.kernel.org/r/20220420141407.470955-1-krzysztof.kozlowski@linaro.org
    Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>

commit 41dee18326170fa82ba0d9f815e30660ddee36b6
Author: Krzysztof Kozlowski <krzysztof.kozlowski@linaro.org>
Date:   Wed Apr 20 16:14:07 2022 +0200

    pinctrl: samsung: fix missing GPIOLIB on ARM64 Exynos config
    
    commit ac875df4d854ab13d9c4af682a1837a1214fecec upstream.
    
    The Samsung pinctrl drivers depend on OF_GPIO, which is part of GPIOLIB.
    ARMv7 Exynos platform selects GPIOLIB and Samsung pinctrl drivers. ARMv8
    Exynos selects only the latter leading to possible wrong configuration
    on ARMv8 build:
    
      WARNING: unmet direct dependencies detected for PINCTRL_EXYNOS
        Depends on [n]: PINCTRL [=y] && OF_GPIO [=n] && (ARCH_EXYNOS [=y] || ARCH_S5PV210 || COMPILE_TEST [=y])
        Selected by [y]:
        - ARCH_EXYNOS [=y]
    
    Always select the GPIOLIB from the Samsung pinctrl drivers to fix the
    issue.  This requires removing of OF_GPIO dependency (to avoid recursive
    dependency), so add dependency on OF for COMPILE_TEST cases.
    
    Reported-by: Necip Fazil Yildiran <fazilyildiran@gmail.com>
    Fixes: eed6b3eb20b9 ("arm64: Split out platform options to separate Kconfig")
    Cc: <stable@vger.kernel.org>
    Signed-off-by: Krzysztof Kozlowski <krzysztof.kozlowski@linaro.org>
    Reviewed-by: Arnd Bergmann <arnd@arndb.de>
    Link: https://lore.kernel.org/r/20220420141407.470955-1-krzysztof.kozlowski@linaro.org
    Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>

commit 1633cb2d4a1d6cd2d84517b1cdff353cbf16853b
Author: Krzysztof Kozlowski <krzysztof.kozlowski@linaro.org>
Date:   Wed Apr 20 16:14:07 2022 +0200

    pinctrl: samsung: fix missing GPIOLIB on ARM64 Exynos config
    
    commit ac875df4d854ab13d9c4af682a1837a1214fecec upstream.
    
    The Samsung pinctrl drivers depend on OF_GPIO, which is part of GPIOLIB.
    ARMv7 Exynos platform selects GPIOLIB and Samsung pinctrl drivers. ARMv8
    Exynos selects only the latter leading to possible wrong configuration
    on ARMv8 build:
    
      WARNING: unmet direct dependencies detected for PINCTRL_EXYNOS
        Depends on [n]: PINCTRL [=y] && OF_GPIO [=n] && (ARCH_EXYNOS [=y] || ARCH_S5PV210 || COMPILE_TEST [=y])
        Selected by [y]:
        - ARCH_EXYNOS [=y]
    
    Always select the GPIOLIB from the Samsung pinctrl drivers to fix the
    issue.  This requires removing of OF_GPIO dependency (to avoid recursive
    dependency), so add dependency on OF for COMPILE_TEST cases.
    
    Reported-by: Necip Fazil Yildiran <fazilyildiran@gmail.com>
    Fixes: eed6b3eb20b9 ("arm64: Split out platform options to separate Kconfig")
    Cc: <stable@vger.kernel.org>
    Signed-off-by: Krzysztof Kozlowski <krzysztof.kozlowski@linaro.org>
    Reviewed-by: Arnd Bergmann <arnd@arndb.de>
    Link: https://lore.kernel.org/r/20220420141407.470955-1-krzysztof.kozlowski@linaro.org
    Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>

commit 25dfae684031f292034a0f42155090df6309f152
Author: Herbert Xu <herbert@gondor.apana.org.au>
Date:   Fri Apr 29 13:37:20 2022 +0800

    hwrng: cn10k - Enable compile testing
    
    This patch enables COMPILE_TEST for cn10k.
    
    Signed-off-by: Herbert Xu <herbert@gondor.apana.org.au>

commit a0912083086d7b6bd7f0f1b4c2ffa6c8283a9f98
Merge: c954531bc5d8 edc5601db664
Author: Linus Walleij <linus.walleij@linaro.org>
Date:   Wed May 4 23:15:21 2022 +0200

    Merge tag 'intel-gpio-v5.19-1' of git://git.kernel.org/pub/scm/linux/kernel/git/andy/linux-gpio-intel into devel
    
    intel-gpio for v5.19-1
    
    * Introduce helpers to iterate over GPIO chip nodes and covert some drivers
    
    The following is an automated git shortlog grouped by driver:
    
    gpiolib:
     -  Introduce a helper to get first GPIO controller node
     -  Introduce gpiochip_node_count() helper
     -  Introduce for_each_gpiochip_node() loop helper
    
    pinctrl:
     -  meson: Replace custom code by gpiochip_node_count() call
     -  meson: Enable COMPILE_TEST
     -  meson: Rename REG_* to MESON_REG_*
     -  armada-37xx: Reuse GPIO fwnode in armada_37xx_irqchip_register()
     -  armada-37xx: Switch to use fwnode instead of of_node
     -  samsung: Switch to use for_each_gpiochip_node() helper
     -  samsung: Drop redundant node parameter in samsung_banks_of_node_get()
     -  npcm7xx: Switch to use for_each_gpiochip_node() helper
     -  renesas: rza1: Switch to use for_each_gpiochip_node() helper
     -  renesas: rza1: Replace custom code by gpiochip_node_count() call
     -  stm32: Switch to use for_each_gpiochip_node() helper
     -  stm32: Replace custom code by gpiochip_node_count() call

commit 7dbd0dd8cde356d2a747d5c87dad7c2233dad8a4
Author: Sumit Saxena <sumit.saxena@broadcom.com>
Date:   Fri Apr 29 17:16:40 2022 -0400

    scsi: mpi3mr: Add support for NVMe passthrough
    
    Add support for management applications to send an MPI3 Encapsulated NVMe
    passthru command to the NVMe devices attached to an Avenger controller.
    Since the NVMe drives are exposed as SCSI devices by the controller, the
    standard NVMe applications cannot be used to interact with the drives and
    the command sets supported are also limited by the controller firmware.
    Special handling is required for MPI3 Encapsulated NVMe passthru commands
    for PRP/SGL setup in the commands.
    
    Link: https://lore.kernel.org/r/20220429211641.642010-8-sumit.saxena@broadcom.com
    Reviewed-by: Himanshu Madhani <himanshu.madhani@oracle.com>
    Signed-off-by: Sumit Saxena <sumit.saxena@broadcom.com>
    Signed-off-by: Martin K. Petersen <martin.petersen@oracle.com>

commit f3de4706c1e0c3b9fa39ec24a30c1996a33bc9e4
Author: Sumit Saxena <sumit.saxena@broadcom.com>
Date:   Fri Apr 29 17:16:36 2022 -0400

    scsi: mpi3mr: Move data structures/definitions from MPI headers to uapi header
    
    This patch moves the data structures/definitions which are used by
    userspace applications from MPI headers to uapi/scsi/scsi_bsg_mpi3mr.h
    
    Link: https://lore.kernel.org/r/20220429211641.642010-4-sumit.saxena@broadcom.com
    Reported by: Stephen Rothwell <sfr@canb.auug.org.au>
    Reviewed-by: Himanshu Madhani <himanshu.madhani@oracle.com>
    Signed-off-by: Sumit Saxena <sumit.saxena@broadcom.com>
    Signed-off-by: Martin K. Petersen <martin.petersen@oracle.com>

commit c85b2f15f59397cdb07f9efc625cf58033254242
Merge: 2e9cf8458d3f edc5601db664
Author: Bartosz Golaszewski <brgl@bgdev.pl>
Date:   Mon May 2 11:44:02 2022 +0200

    Merge tag 'intel-gpio-v5.19-1' of git://git.kernel.org/pub/scm/linux/kernel/git/andy/linux-gpio-intel into gpio/for-next
    
    intel-gpio for v5.19-1
    
    * Introduce helpers to iterate over GPIO chip nodes and covert some drivers
    
    gpiolib:
     -  Introduce a helper to get first GPIO controller node
     -  Introduce gpiochip_node_count() helper
     -  Introduce for_each_gpiochip_node() loop helper
    
    pinctrl:
     -  meson: Replace custom code by gpiochip_node_count() call
     -  meson: Enable COMPILE_TEST
     -  meson: Rename REG_* to MESON_REG_*
     -  armada-37xx: Reuse GPIO fwnode in armada_37xx_irqchip_register()
     -  armada-37xx: Switch to use fwnode instead of of_node
     -  samsung: Switch to use for_each_gpiochip_node() helper
     -  samsung: Drop redundant node parameter in samsung_banks_of_node_get()
     -  npcm7xx: Switch to use for_each_gpiochip_node() helper
     -  renesas: rza1: Switch to use for_each_gpiochip_node() helper
     -  renesas: rza1: Replace custom code by gpiochip_node_count() call
     -  stm32: Switch to use for_each_gpiochip_node() helper
     -  stm32: Replace custom code by gpiochip_node_count() call

commit cbb0f00131e48f38db9eda67e0f731504404567b
Author: Sven Peter <sven@svenpeter.dev>
Date:   Sun May 1 16:55:05 2022 +0200

    soc: apple: Always include Makefile
    
    We want to allow the code inside drivers/soc/apple to be compiled with
    COMPILE_TEST but this will currently result in linking errors because
    ARCH_APPLE is not set and make will never recurse into
    drivers/soc/apple.
    Let's just unconditionally recurse into apple/ since all drivers
    in there are guarded by config options anyways.
    
    Signed-off-by: Sven Peter <sven@svenpeter.dev>

commit add9f6f30e54b5c07e7a0260cda459ef1d9646b7
Author: Brian Norris <briannorris@chromium.org>
Date:   Mon Apr 25 18:45:44 2022 -0700

    soc: rockchip: Fix compile-testing SoC drivers
    
    Similar to commit 7f94b69ece51 ("ARM: ixp4xx: fix compile-testing soc
    drivers").
    
    drivers/soc/rockchip/Kconfig makes plenty of provision for configuring
    drivers either for ARCH_ROCKCHIP or for COMPILE_TEST. But
    drivers/soc/Makefile pulls the rug out from under us, by refusing to
    build anything if we specified COMPILE_TEST but not ARCH_ROCKCHIP.
    
    Currently, I'm not aware of anything that breaks without this patch, but
    it certainly makes for confusing builds (CONFIG_ROCKCHIP_PM_DOMAINS=y,
    but we didn't actually compile the driver?) and leaves room for future
    error (I have pending patches that break confusingly with COMPILE_TEST=y
    even though their Kconfig dependencies seem correct [1]).
    
    Defer to drivers/soc/rockchip/{Makefile,Kconfig} to do the right thing.
    
    [1] e.g.,
    https://lore.kernel.org/linux-rockchip/20220405184816.RFC.2.I2d73b403944f0b8b5871a77585b73f31ccc62999@changeid/
    [RFC PATCH 2/2] PM / devfreq: rk3399_dmc: Block PMU during transitions
    
    Signed-off-by: Brian Norris <briannorris@chromium.org>
    Reviewed-by: Guenter Roeck <linux@roeck-us.net>
    Link: https://lore.kernel.org/r/20220425184503.v3.3.Id5f16dec920f620120c0a143a97a12e16d401760@changeid
    Signed-off-by: Heiko Stuebner <heiko@sntech.de>

commit 2ca9e472c70f15de768ab200571e2f6634f66394
Author: Brian Norris <briannorris@chromium.org>
Date:   Mon Apr 25 18:45:43 2022 -0700

    soc: rockchip: power-domain: Replace dsb() with smb()
    
    It's unclear if these are really needed at all, but seemingly their
    purpose is only as a write barrier. Use the general macro instead of the
    ARM-specific one.
    
    This driver is partially marked for COMPILE_TEST'ing, but it doesn't
    build under non-ARM architectures. Fix this up before *really* enabling
    it for COMPILE_TEST.
    
    Signed-off-by: Brian Norris <briannorris@chromium.org>
    Reviewed-by: Guenter Roeck <linux@roeck-us.net>
    Link: https://lore.kernel.org/r/20220426014545.628100-2-briannorris@chromium.org
    Signed-off-by: Heiko Stuebner <heiko@sntech.de>

commit be34f45f0d4aa91c6b83d140f9ace1ca40a5f9dc
Author: Roger Quadros <rogerq@kernel.org>
Date:   Tue Apr 26 11:26:10 2022 +0300

    memory: omap-gpmc: Make OMAP_GPMC config visible and selectable
    
    So far for armv7 TI platforms, GPMC was being selected by
    arch/arm/mach-* architecture Kconfig files.
    
    For K3 platforms, GPMC is no longer required for basic boot and cannot
    be always enabled by default by mach- Kconfig.
    
    We need a way for user (or board defconfig) to enable it if required so
    make OMAP_GPMC Kconfig option always visible.
    
    Drop COMPILE_TEST as build fails if IRQ_DOMAIN is not enabled.
    
    Signed-off-by: Roger Quadros <rogerq@kernel.org>
    Link: https://lore.kernel.org/r/20220426082611.24427-2-rogerq@kernel.org
    Signed-off-by: Krzysztof Kozlowski <krzysztof.kozlowski@linaro.org>

commit 79fc62d6b2c278bffafc24a22fa4638edcae1aa9
Author: Amadeusz Sawiski <amadeuszx.slawinski@linux.intel.com>
Date:   Tue Apr 26 22:05:39 2022 +0200

    ASoC: Intel: avs: Drop direct ACPI dependency
    
    With previous patch this allows for building driver on architectures
    without ACPI support present, when building with COMPILE_TEST enabled.
    
    Fixes: 47a1886a610a ("ASoC: Intel: avs: Enable AVS driver only on x86 platforms")
    Reported-by: kernel test robot <lkp@intel.com>
    Reviewed-by: Cezary Rojewski <cezary.rojewski@intel.com>
    Signed-off-by: Amadeusz Sawiski <amadeuszx.slawinski@linux.intel.com>
    Link: https://lore.kernel.org/r/20220426200539.894010-2-amadeuszx.slawinski@linux.intel.com
    Signed-off-by: Mark Brown <broonie@kernel.org>

commit 2d3694fdeef599ef5a1352b699bdd493a51ab8cb
Author: Amadeusz Sawiski <amadeuszx.slawinski@linux.intel.com>
Date:   Tue Apr 26 22:05:38 2022 +0200

    ALSA: hda: intel-nhlt: Move structs out of #define block
    
    As functions prototypes regerdless of CONFIG options as well as some
    code depend on structures defined in sound/intel-nhlt.h header, move
    them out of #define block. This allows to compile code depending on
    mentioned header with "depends on ACPI || COMPILE_TEST" in Kconfig.
    
    Fixes: 47a1886a610a ("ASoC: Intel: avs: Enable AVS driver only on x86 platforms")
    Reported-by: kernel test robot <lkp@intel.com>
    Suggested-by: Pierre-Louis Bossart <pierre-louis.bossart@linux.intel.com>
    Reviewed-by: Cezary Rojewski <cezary.rojewski@intel.com>
    Signed-off-by: Amadeusz Sawiski <amadeuszx.slawinski@linux.intel.com>
    Link: https://lore.kernel.org/r/20220426200539.894010-1-amadeuszx.slawinski@linux.intel.com
    Signed-off-by: Mark Brown <broonie@kernel.org>

commit 0715372a06ce17a9ba69bbec306ddf30c4bad99e
Author: Guo Ren <guoren@linux.alibaba.com>
Date:   Tue Apr 5 15:13:10 2022 +0800

    riscv: compat: vdso: Add COMPAT_VDSO base code implementation
    
    There is no vgettimeofday supported in rv32 that makes simple to
    generate rv32 vdso code which only needs riscv64 compiler. Other
    architectures need change compiler or -m (machine parameter) to
    support vdso32 compiling. If rv32 support vgettimeofday (which
    cause C compile) in future, we would add CROSS_COMPILE to support
    that makes more requirement on compiler enviornment.
    
    linux-rv64/arch/riscv/kernel/compat_vdso/compat_vdso.so.dbg:
    file format elf64-littleriscv
    
    Disassembly of section .text:
    
    0000000000000800 <__vdso_rt_sigreturn>:
     800:   08b00893                li      a7,139
     804:   00000073                ecall
     808:   0000                    unimp
            ...
    
    000000000000080c <__vdso_getcpu>:
     80c:   0a800893                li      a7,168
     810:   00000073                ecall
     814:   8082                    ret
            ...
    
    0000000000000818 <__vdso_flush_icache>:
     818:   10300893                li      a7,259
     81c:   00000073                ecall
     820:   8082                    ret
    
    linux-rv32/arch/riscv/kernel/vdso/vdso.so.dbg:
    file format elf32-littleriscv
    
    Disassembly of section .text:
    
    00000800 <__vdso_rt_sigreturn>:
     800:   08b00893                li      a7,139
     804:   00000073                ecall
     808:   0000                    unimp
            ...
    
    0000080c <__vdso_getcpu>:
     80c:   0a800893                li      a7,168
     810:   00000073                ecall
     814:   8082                    ret
            ...
    
    00000818 <__vdso_flush_icache>:
     818:   10300893                li      a7,259
     81c:   00000073                ecall
     820:   8082                    ret
    
    Finally, reuse all *.S from vdso in compat_vdso that makes
    implementation clear and readable.
    
    Signed-off-by: Guo Ren <guoren@linux.alibaba.com>
    Signed-off-by: Guo Ren <guoren@kernel.org>
    Tested-by: Heiko Stuebner <heiko@sntech.de>
    Link: https://lore.kernel.org/r/20220405071314.3225832-17-guoren@kernel.org
    Signed-off-by: Palmer Dabbelt <palmer@rivosinc.com>

commit c6d3ffae0d3229e06097f2790f459c96fca5e367
Author: Herbert Xu <herbert@gondor.apana.org.au>
Date:   Tue Apr 26 17:42:36 2022 +0800

    Revert "hwrng: mpfs - Enable COMPILE_TEST"
    
    This reverts commit 6a71277ce91e4766ebe9a5f6725089c80d043ba2.
    
    The underlying option POLARFIRE_SOC_SYS_CTRL already supports
    COMPILE_TEST so there is no need for this.  What's more, if
    we force this option on without the underlying option it fails
    to build.
    
    Reported-by: kernel test robot <lkp@intel.com>
    Reported-by: Randy Dunlap <rdunlap@infradead.org>
    Signed-off-by: Herbert Xu <herbert@gondor.apana.org.au>

commit 273bc890a2a83ba8c7d8eee50b74138f5a5834d1
Author: Sumit Gupta <sumitg@nvidia.com>
Date:   Tue Apr 5 18:31:18 2022 +0530

    cpufreq: tegra194: Add support for Tegra234
    
    This patch adds driver support for Tegra234 cpufreq.
    Tegra234 has per core MMIO registers instead of system registers for
    cpu frequency requests and to read the counters for re-constructing
    the cpu frequency. Also, MPIDR affinity info in Tegra234 is different
    from Tegra194.
    Added ops hooks  and soc data for Tegra234. This will help to easily
    add variants of Tegra234 and future SoC's which use similar logic to
    {get|set} the cpu frequency.
    
    Signed-off-by: Sumit Gupta <sumitg@nvidia.com>
    Signed-off-by: Viresh Kumar <viresh.kumar@linaro.org>

commit 9423edfc5188c436f6df4356d0737bae09d35b82
Author: Randy Dunlap <rdunlap@infradead.org>
Date:   Fri Apr 22 20:25:17 2022 -0700

    sparc: cacheflush_32.h needs struct page
    
    Add a struct page forward declaration to cacheflush_32.h.
    Fixes this build warning:
    
        CC      drivers/crypto/xilinx/zynqmp-sha.o
      In file included from arch/sparc/include/asm/cacheflush.h:11,
                       from include/linux/cacheflush.h:5,
                       from drivers/crypto/xilinx/zynqmp-sha.c:6:
      arch/sparc/include/asm/cacheflush_32.h:38:37: warning: 'struct page' declared inside parameter list will not be visible outside of this definition or declaration
         38 | void sparc_flush_page_to_ram(struct page *page);
    
    Exposed by commit 0e03b8fd2936 ("crypto: xilinx - Turn SHA into a
    tristate and allow COMPILE_TEST") but not Fixes: that commit because the
    underlying problem is older.
    
    Signed-off-by: Randy Dunlap <rdunlap@infradead.org>
    Reported-by: kernel test robot <lkp@intel.com>
    Cc: Herbert Xu <herbert@gondor.apana.org.au>
    Cc: David S. Miller <davem@davemloft.net>
    Cc: Sam Ravnborg <sam@ravnborg.org>
    Cc: sparclinux@vger.kernel.org
    Acked-by: Sam Ravnborg <sam@ravnborg.org>
    Acked-by: Herbert Xu <herbert@gondor.apana.org.au>
    Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>

commit b3af85969e959872f21f0e6aaf5fbb9d37c5cb90
Merge: e74200ebf7c4 ac875df4d854
Author: Linus Walleij <linus.walleij@linaro.org>
Date:   Fri Apr 22 23:00:08 2022 +0200

    Merge tag 'samsung-pinctrl-fixes-5.18' of https://git.kernel.org/pub/scm/linux/kernel/git/pinctrl/samsung into fixes
    
    Samsung pinctrl drivers fixes for v5.18
    
    1. Fix sparse warning introduced in v5.18-rc1.
    2. Fix possible unmet Kconfig dependency with COMPILE_TEST, present
       since v4.3 or earlier.

commit e3e7b13bffae85e2806c73e3ccacd4447bcb19ed
Author: Jiri Slaby <jslaby@suse.cz>
Date:   Thu Apr 21 12:17:08 2022 +0200

    serial: allow COMPILE_TEST for some drivers
    
    Some more serial drivers can be compile-tested under certain
    circumstances (when building a specific architecture). So allow for
    that.
    
    This reduces the need of zillion mach/subarch-specific configs. And
    since the 0day bot has only allmodconfig's for some archs, this
    increases build coverage there too.
    
    Note that cpm needs a minor update in the header, so that it drags in
    at least some defines (CPM2 ones).
    
    Signed-off-by: Jiri Slaby <jslaby@suse.cz>
    Link: https://lore.kernel.org/r/20220421101708.5640-8-jslaby@suse.cz
    Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>

commit 6a71277ce91e4766ebe9a5f6725089c80d043ba2
Author: Herbert Xu <herbert@gondor.apana.org.au>
Date:   Fri Apr 15 16:37:47 2022 +0800

    hwrng: mpfs - Enable COMPILE_TEST
    
    The dependency on HW_RANDOM is redundant so this patch removes it.
    As this driver seems to cross-compile just fine we could also enable
    COMPILE_TEST.
    
    Signed-off-by: Herbert Xu <herbert@gondor.apana.org.au>
    Reviewed-by: Conor Dooley <conor.dooley@microchip.com
    Reviewed-by: Conor Dooley <conor.dooley@microchip.com>
    Signed-off-by: Herbert Xu <herbert@gondor.apana.org.au>

commit ac875df4d854ab13d9c4af682a1837a1214fecec
Author: Krzysztof Kozlowski <krzysztof.kozlowski@linaro.org>
Date:   Wed Apr 20 16:14:07 2022 +0200

    pinctrl: samsung: fix missing GPIOLIB on ARM64 Exynos config
    
    The Samsung pinctrl drivers depend on OF_GPIO, which is part of GPIOLIB.
    ARMv7 Exynos platform selects GPIOLIB and Samsung pinctrl drivers. ARMv8
    Exynos selects only the latter leading to possible wrong configuration
    on ARMv8 build:
    
      WARNING: unmet direct dependencies detected for PINCTRL_EXYNOS
        Depends on [n]: PINCTRL [=y] && OF_GPIO [=n] && (ARCH_EXYNOS [=y] || ARCH_S5PV210 || COMPILE_TEST [=y])
        Selected by [y]:
        - ARCH_EXYNOS [=y]
    
    Always select the GPIOLIB from the Samsung pinctrl drivers to fix the
    issue.  This requires removing of OF_GPIO dependency (to avoid recursive
    dependency), so add dependency on OF for COMPILE_TEST cases.
    
    Reported-by: Necip Fazil Yildiran <fazilyildiran@gmail.com>
    Fixes: eed6b3eb20b9 ("arm64: Split out platform options to separate Kconfig")
    Cc: <stable@vger.kernel.org>
    Signed-off-by: Krzysztof Kozlowski <krzysztof.kozlowski@linaro.org>
    Reviewed-by: Arnd Bergmann <arnd@arndb.de>
    Link: https://lore.kernel.org/r/20220420141407.470955-1-krzysztof.kozlowski@linaro.org

commit 4dee8eebcfc1a99d7550855ec40720503df4842b
Author: Zheng Bin <zhengbin13@huawei.com>
Date:   Mon Apr 11 10:43:25 2022 +0800

    drm/vc4: Fix build error when CONFIG_DRM_VC4=y && CONFIG_RASPBERRYPI_FIRMWARE=m
    
    If CONFIG_DRM_VC4=y, CONFIG_RASPBERRYPI_FIRMWARE=m, CONFIG_COMPILE_TEST=n,
    bulding fails:
    
    drivers/gpu/drm/vc4/vc4_drv.o: In function `vc4_drm_bind':
    vc4_drv.c:(.text+0x320): undefined reference to `rpi_firmware_get'
    vc4_drv.c:(.text+0x320): relocation truncated to fit: R_AARCH64_CALL26 against undefined symbol `rpi_firmware_get'
    vc4_drv.c:(.text+0x34c): undefined reference to `rpi_firmware_property'
    vc4_drv.c:(.text+0x34c): relocation truncated to fit: R_AARCH64_CALL26 against undefined symbol `rpi_firmware_property'
    vc4_drv.c:(.text+0x354): undefined reference to `rpi_firmware_put'
    vc4_drv.c:(.text+0x354): relocation truncated to fit: R_AARCH64_CALL26 against undefined symbol `rpi_firmware_put'
    
    Make DRM_VC4 depends on RASPBERRYPI_FIRMWARE || (COMPILE_TEST && !RASPBERRYPI_FIRMWARE) to fix this.
    
    Fixes: c406ad5e4a85 ("drm/vc4: Notify the firmware when DRM is in charge")
    Reported-by: Hulk Robot <hulkci@huawei.com>
    Signed-off-by: Zheng Bin <zhengbin13@huawei.com>
    Signed-off-by: Maxime Ripard <maxime@cerno.tech>
    Link: https://patchwork.freedesktop.org/patch/msgid/20220411024325.3968413-1-zhengbin13@huawei.com

commit 1eb86d6c57c27dadf99ae1c7addc4b160cc86589
Author: Ajish Koshy <Ajish.Koshy@microchip.com>
Date:   Mon Apr 11 12:16:03 2022 +0530

    scsi: pm80xx: Enable upper inbound, outbound queues
    
    [ Upstream commit bcd8a45223470e00b5f254018174d64a75db4bbe ]
    
    Executing driver on servers with more than 32 CPUs were faced with command
    timeouts. This is because we were not geting completions for commands
    submitted on IQ32 - IQ63.
    
    Set E64Q bit to enable upper inbound and outbound queues 32 to 63 in the
    MPI main configuration table.
    
    Added 500ms delay after successful MPI initialization as mentioned in
    controller datasheet.
    
    Link: https://lore.kernel.org/r/20220411064603.668448-3-Ajish.Koshy@microchip.com
    Fixes: 05c6c029a44d ("scsi: pm80xx: Increase number of supported queues")
    Reviewed-by: Damien Le Moal <damien.lemoal@opensource.wdc.com>
    Acked-by: Jack Wang <jinpu.wang@ionos.com>
    Signed-off-by: Ajish Koshy <Ajish.Koshy@microchip.com>
    Signed-off-by: Viswas G <Viswas.G@microchip.com>
    Signed-off-by: Martin K. Petersen <martin.petersen@oracle.com>
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit 74d23d422556040a9848323ee48c6e73880a2ba2
Author: Alex Elder <elder@linaro.org>
Date:   Fri Feb 25 14:15:30 2022 -0600

    net: ipa: fix a build dependency
    
    commit caef14b7530c065fb85d54492768fa48fdb5093e upstream.
    
    An IPA build problem arose in the linux-next tree the other day.
    The problem is that a recent commit adds a new dependency on some
    code, and the Kconfig file for IPA doesn't reflect that dependency.
    As a result, some configurations can fail to build (particularly
    when COMPILE_TEST is enabled).
    
    The recent patch adds calls to qmp_get(), qmp_put(), and qmp_send(),
    and those are built based on the QCOM_AOSS_QMP config option.  If
    that symbol is not defined, stubs are defined, so we just need to
    ensure QCOM_AOSS_QMP is compatible with QCOM_IPA, or it's not
    defined.
    
    Reported-by: Randy Dunlap <rdunlap@infradead.org>
    Fixes: 34a081761e4e3 ("net: ipa: request IPA register values be retained")
    Signed-off-by: Alex Elder <elder@linaro.org>
    Tested-by: Randy Dunlap <rdunlap@infradead.org>
    Acked-by: Randy Dunlap <rdunlap@infradead.org>
    Signed-off-by: David S. Miller <davem@davemloft.net>
    Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>

commit d6f6f945e8501e8b6fcfbcc2920a004221a2c473
Author: Ajish Koshy <Ajish.Koshy@microchip.com>
Date:   Mon Apr 11 12:16:03 2022 +0530

    scsi: pm80xx: Enable upper inbound, outbound queues
    
    [ Upstream commit bcd8a45223470e00b5f254018174d64a75db4bbe ]
    
    Executing driver on servers with more than 32 CPUs were faced with command
    timeouts. This is because we were not geting completions for commands
    submitted on IQ32 - IQ63.
    
    Set E64Q bit to enable upper inbound and outbound queues 32 to 63 in the
    MPI main configuration table.
    
    Added 500ms delay after successful MPI initialization as mentioned in
    controller datasheet.
    
    Link: https://lore.kernel.org/r/20220411064603.668448-3-Ajish.Koshy@microchip.com
    Fixes: 05c6c029a44d ("scsi: pm80xx: Increase number of supported queues")
    Reviewed-by: Damien Le Moal <damien.lemoal@opensource.wdc.com>
    Acked-by: Jack Wang <jinpu.wang@ionos.com>
    Signed-off-by: Ajish Koshy <Ajish.Koshy@microchip.com>
    Signed-off-by: Viswas G <Viswas.G@microchip.com>
    Signed-off-by: Martin K. Petersen <martin.petersen@oracle.com>
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit da9cf24aa739f48cdbf5b2624eacb4a6c81cf9e9
Author: Ajish Koshy <Ajish.Koshy@microchip.com>
Date:   Mon Apr 11 12:16:03 2022 +0530

    scsi: pm80xx: Enable upper inbound, outbound queues
    
    [ Upstream commit bcd8a45223470e00b5f254018174d64a75db4bbe ]
    
    Executing driver on servers with more than 32 CPUs were faced with command
    timeouts. This is because we were not geting completions for commands
    submitted on IQ32 - IQ63.
    
    Set E64Q bit to enable upper inbound and outbound queues 32 to 63 in the
    MPI main configuration table.
    
    Added 500ms delay after successful MPI initialization as mentioned in
    controller datasheet.
    
    Link: https://lore.kernel.org/r/20220411064603.668448-3-Ajish.Koshy@microchip.com
    Fixes: 05c6c029a44d ("scsi: pm80xx: Increase number of supported queues")
    Reviewed-by: Damien Le Moal <damien.lemoal@opensource.wdc.com>
    Acked-by: Jack Wang <jinpu.wang@ionos.com>
    Signed-off-by: Ajish Koshy <Ajish.Koshy@microchip.com>
    Signed-off-by: Viswas G <Viswas.G@microchip.com>
    Signed-off-by: Martin K. Petersen <martin.petersen@oracle.com>
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit add668be8f5e53f4471a075edaa70a7cb85fd036
Author: Willem de Bruijn <willemb@google.com>
Date:   Wed Apr 6 22:29:55 2022 +0300

    net: add missing SOF_TIMESTAMPING_OPT_ID support
    
    [ Upstream commit 8f932f762e7928d250e21006b00ff9b7718b0a64 ]
    
    SOF_TIMESTAMPING_OPT_ID is supported on TCP, UDP and RAW sockets.
    But it was missing on RAW with IPPROTO_IP, PF_PACKET and CAN.
    
    Add skb_setup_tx_timestamp that configures both tx_flags and tskey
    for these paths that do not need corking or use bytestream keys.
    
    Fixes: 09c2d251b707 ("net-timestamp: add key to disambiguate concurrent datagrams")
    Signed-off-by: Willem de Bruijn <willemb@google.com>
    Acked-by: Soheil Hassas Yeganeh <soheil@google.com>
    Signed-off-by: David S. Miller <davem@davemloft.net>
    Signed-off-by: Vladimir Oltean <vladimir.oltean@nxp.com>
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit 6671d0bc17866f71b8ca7ea3fb7e6dfc2a8069d2
Author: Andy Shevchenko <andriy.shevchenko@linux.intel.com>
Date:   Fri Apr 1 13:36:01 2022 +0300

    pinctrl: meson: Enable COMPILE_TEST
    
    Enable COMPILE_TEST for a better test coverage.
    
    Signed-off-by: Andy Shevchenko <andriy.shevchenko@linux.intel.com>
    Tested-by: Marek Szyprowski <m.szyprowski@samsung.com>
    Reviewed-by: Neil Armstrong <narmstrong@baylibre.com>

commit 2b2dce809920b3cf92df27a484c0649dda7270b8
Author: Andy Shevchenko <andriy.shevchenko@linux.intel.com>
Date:   Fri Apr 1 13:36:00 2022 +0300

    pinctrl: meson: Rename REG_* to MESON_REG_*
    
    Currently compilation test fails on x86 due to name collision. The usual
    way to fix that is to move both conflicting parts to their own namespaces.
    
    Rename REG_* to MESON_REG_* as a prerequisite for enabling COMPILE_TEST.
    
    Signed-off-by: Andy Shevchenko <andriy.shevchenko@linux.intel.com>
    Tested-by: Marek Szyprowski <m.szyprowski@samsung.com>
    Reviewed-by: Neil Armstrong <narmstrong@baylibre.com>

commit a6af504184c981efd253f986e6fc54db57b1d39f
Author: Philipp Zabel <p.zabel@pengutronix.de>
Date:   Mon Apr 4 11:45:00 2022 +0200

    reset: ti-sci: Allow building under COMPILE_TEST
    
    Since commit 043cfff99a18 ("firmware: ti_sci: Fix compilation failure
    when CONFIG_TI_SCI_PROTOCOL is not defined") it is possible to build
    reset-ti-sci under CONFIG_COMPILE_TEST.
    
    Signed-off-by: Philipp Zabel <p.zabel@pengutronix.de>
    Signed-off-by: Nishanth Menon <nm@ti.com>
    Link: https://lore.kernel.org/r/20220404094500.2708816-1-p.zabel@pengutronix.de

commit cd7295d0bea3f56a3f024f1b22d50a0f3fc727f1
Author: Willem de Bruijn <willemb@google.com>
Date:   Wed Apr 6 22:29:56 2022 +0300

    net: add missing SOF_TIMESTAMPING_OPT_ID support
    
    [ Upstream commit 8f932f762e7928d250e21006b00ff9b7718b0a64 ]
    
    SOF_TIMESTAMPING_OPT_ID is supported on TCP, UDP and RAW sockets.
    But it was missing on RAW with IPPROTO_IP, PF_PACKET and CAN.
    
    Add skb_setup_tx_timestamp that configures both tx_flags and tskey
    for these paths that do not need corking or use bytestream keys.
    
    Fixes: 09c2d251b707 ("net-timestamp: add key to disambiguate concurrent datagrams")
    Signed-off-by: Willem de Bruijn <willemb@google.com>
    Acked-by: Soheil Hassas Yeganeh <soheil@google.com>
    Signed-off-by: David S. Miller <davem@davemloft.net>
    Signed-off-by: Vladimir Oltean <vladimir.oltean@nxp.com>
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit 357ad4d898286b94aaae0cb7e3f573459e5b98b9
Author: Miles Chen <miles.chen@mediatek.com>
Date:   Thu Apr 14 17:19:38 2022 +0800

    sound/oss/dmasound: fix 'dmasound_setup' defined but not used
    
    We observed: 'dmasound_setup' defined but not used error with
    COMPILER=gcc ARCH=m68k DEFCONFIG=allmodconfig build.
    
    Fix it by adding __maybe_unused to dmasound_setup.
    
    Error(s):
    sound/oss/dmasound/dmasound_core.c:1431:12: error: 'dmasound_setup' defined but not used [-Werror=unused-function]
    
    Fixes: 9dd7c46346ca ("sound/oss/dmasound: fix build when drivers are mixed =y/=m")
    Signed-off-by: Miles Chen <miles.chen@mediatek.com>
    Acked-by: Randy Dunlap <rdunlap@infradead.org>
    Link: https://lore.kernel.org/r/20220414091940.2216-1-miles.chen@mediatek.com
    Signed-off-by: Takashi Iwai <tiwai@suse.de>

commit 5f54364ff6cfcd14cddf5441c4a490bb28dd69f7
Author: Douglas Miller <doug.miller@cornelisnetworks.com>
Date:   Fri Apr 8 09:35:23 2022 -0400

    RDMA/hfi1: Fix use-after-free bug for mm struct
    
    commit 2bbac98d0930e8161b1957dc0ec99de39ade1b3c upstream.
    
    Under certain conditions, such as MPI_Abort, the hfi1 cleanup code may
    represent the last reference held on the task mm.
    hfi1_mmu_rb_unregister() then drops the last reference and the mm is freed
    before the final use in hfi1_release_user_pages().  A new task may
    allocate the mm structure while it is still being used, resulting in
    problems. One manifestation is corruption of the mmap_sem counter leading
    to a hang in down_write().  Another is corruption of an mm struct that is
    in use by another task.
    
    Fixes: 3d2a9d642512 ("IB/hfi1: Ensure correct mm is used at all times")
    Link: https://lore.kernel.org/r/20220408133523.122165.72975.stgit@awfm-01.cornelisnetworks.com
    Cc: <stable@vger.kernel.org>
    Signed-off-by: Douglas Miller <doug.miller@cornelisnetworks.com>
    Signed-off-by: Dennis Dalessandro <dennis.dalessandro@cornelisnetworks.com>
    Signed-off-by: Jason Gunthorpe <jgg@nvidia.com>
    Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>

commit 9ca11bd8222a612de0d2f54d050bfcf61ae2883f
Author: Douglas Miller <doug.miller@cornelisnetworks.com>
Date:   Fri Apr 8 09:35:23 2022 -0400

    RDMA/hfi1: Fix use-after-free bug for mm struct
    
    commit 2bbac98d0930e8161b1957dc0ec99de39ade1b3c upstream.
    
    Under certain conditions, such as MPI_Abort, the hfi1 cleanup code may
    represent the last reference held on the task mm.
    hfi1_mmu_rb_unregister() then drops the last reference and the mm is freed
    before the final use in hfi1_release_user_pages().  A new task may
    allocate the mm structure while it is still being used, resulting in
    problems. One manifestation is corruption of the mmap_sem counter leading
    to a hang in down_write().  Another is corruption of an mm struct that is
    in use by another task.
    
    Fixes: 3d2a9d642512 ("IB/hfi1: Ensure correct mm is used at all times")
    Link: https://lore.kernel.org/r/20220408133523.122165.72975.stgit@awfm-01.cornelisnetworks.com
    Cc: <stable@vger.kernel.org>
    Signed-off-by: Douglas Miller <doug.miller@cornelisnetworks.com>
    Signed-off-by: Dennis Dalessandro <dennis.dalessandro@cornelisnetworks.com>
    Signed-off-by: Jason Gunthorpe <jgg@nvidia.com>
    Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>

commit 0b7186d657ee55e2cdefae498f07d5c1961e8023
Author: Douglas Miller <doug.miller@cornelisnetworks.com>
Date:   Fri Apr 8 09:35:23 2022 -0400

    RDMA/hfi1: Fix use-after-free bug for mm struct
    
    commit 2bbac98d0930e8161b1957dc0ec99de39ade1b3c upstream.
    
    Under certain conditions, such as MPI_Abort, the hfi1 cleanup code may
    represent the last reference held on the task mm.
    hfi1_mmu_rb_unregister() then drops the last reference and the mm is freed
    before the final use in hfi1_release_user_pages().  A new task may
    allocate the mm structure while it is still being used, resulting in
    problems. One manifestation is corruption of the mmap_sem counter leading
    to a hang in down_write().  Another is corruption of an mm struct that is
    in use by another task.
    
    Fixes: 3d2a9d642512 ("IB/hfi1: Ensure correct mm is used at all times")
    Link: https://lore.kernel.org/r/20220408133523.122165.72975.stgit@awfm-01.cornelisnetworks.com
    Cc: <stable@vger.kernel.org>
    Signed-off-by: Douglas Miller <doug.miller@cornelisnetworks.com>
    Signed-off-by: Dennis Dalessandro <dennis.dalessandro@cornelisnetworks.com>
    Signed-off-by: Jason Gunthorpe <jgg@nvidia.com>
    Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>

commit 5a9a1b24ddb510715f8f621263938186579a965c
Author: Douglas Miller <doug.miller@cornelisnetworks.com>
Date:   Fri Apr 8 09:35:23 2022 -0400

    RDMA/hfi1: Fix use-after-free bug for mm struct
    
    commit 2bbac98d0930e8161b1957dc0ec99de39ade1b3c upstream.
    
    Under certain conditions, such as MPI_Abort, the hfi1 cleanup code may
    represent the last reference held on the task mm.
    hfi1_mmu_rb_unregister() then drops the last reference and the mm is freed
    before the final use in hfi1_release_user_pages().  A new task may
    allocate the mm structure while it is still being used, resulting in
    problems. One manifestation is corruption of the mmap_sem counter leading
    to a hang in down_write().  Another is corruption of an mm struct that is
    in use by another task.
    
    Fixes: 3d2a9d642512 ("IB/hfi1: Ensure correct mm is used at all times")
    Link: https://lore.kernel.org/r/20220408133523.122165.72975.stgit@awfm-01.cornelisnetworks.com
    Cc: <stable@vger.kernel.org>
    Signed-off-by: Douglas Miller <doug.miller@cornelisnetworks.com>
    Signed-off-by: Dennis Dalessandro <dennis.dalessandro@cornelisnetworks.com>
    Signed-off-by: Jason Gunthorpe <jgg@nvidia.com>
    Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>

commit bcd8a45223470e00b5f254018174d64a75db4bbe
Author: Ajish Koshy <Ajish.Koshy@microchip.com>
Date:   Mon Apr 11 12:16:03 2022 +0530

    scsi: pm80xx: Enable upper inbound, outbound queues
    
    Executing driver on servers with more than 32 CPUs were faced with command
    timeouts. This is because we were not geting completions for commands
    submitted on IQ32 - IQ63.
    
    Set E64Q bit to enable upper inbound and outbound queues 32 to 63 in the
    MPI main configuration table.
    
    Added 500ms delay after successful MPI initialization as mentioned in
    controller datasheet.
    
    Link: https://lore.kernel.org/r/20220411064603.668448-3-Ajish.Koshy@microchip.com
    Fixes: 05c6c029a44d ("scsi: pm80xx: Increase number of supported queues")
    Reviewed-by: Damien Le Moal <damien.lemoal@opensource.wdc.com>
    Acked-by: Jack Wang <jinpu.wang@ionos.com>
    Signed-off-by: Ajish Koshy <Ajish.Koshy@microchip.com>
    Signed-off-by: Viswas G <Viswas.G@microchip.com>
    Signed-off-by: Martin K. Petersen <martin.petersen@oracle.com>

commit 2bbac98d0930e8161b1957dc0ec99de39ade1b3c
Author: Douglas Miller <doug.miller@cornelisnetworks.com>
Date:   Fri Apr 8 09:35:23 2022 -0400

    RDMA/hfi1: Fix use-after-free bug for mm struct
    
    Under certain conditions, such as MPI_Abort, the hfi1 cleanup code may
    represent the last reference held on the task mm.
    hfi1_mmu_rb_unregister() then drops the last reference and the mm is freed
    before the final use in hfi1_release_user_pages().  A new task may
    allocate the mm structure while it is still being used, resulting in
    problems. One manifestation is corruption of the mmap_sem counter leading
    to a hang in down_write().  Another is corruption of an mm struct that is
    in use by another task.
    
    Fixes: 3d2a9d642512 ("IB/hfi1: Ensure correct mm is used at all times")
    Link: https://lore.kernel.org/r/20220408133523.122165.72975.stgit@awfm-01.cornelisnetworks.com
    Cc: <stable@vger.kernel.org>
    Signed-off-by: Douglas Miller <doug.miller@cornelisnetworks.com>
    Signed-off-by: Dennis Dalessandro <dennis.dalessandro@cornelisnetworks.com>
    Signed-off-by: Jason Gunthorpe <jgg@nvidia.com>

commit 3eb92660e69a7ebdc40ddb29b1dd1c53a521fe5a
Author: Vladimir Oltean <vladimir.oltean@nxp.com>
Date:   Thu Mar 24 18:12:10 2022 +0200

    net: enetc: report software timestamping via SO_TIMESTAMPING
    
    [ Upstream commit feb13dcb1818b775fbd9191f797be67cd605f03e ]
    
    Let user space properly determine that the enetc driver provides
    software timestamps.
    
    Fixes: 4caefbce06d1 ("enetc: add software timestamping")
    Signed-off-by: Vladimir Oltean <vladimir.oltean@nxp.com>
    Reviewed-by: Claudiu Manoil <claudiu.manoil@nxp.com>
    Link: https://lore.kernel.org/r/20220324161210.4122281-1-vladimir.oltean@nxp.com
    Signed-off-by: Jakub Kicinski <kuba@kernel.org>
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit b02752d75300af193f59ce4d252cd5a14b543ef5
Author: Randy Dunlap <rdunlap@infradead.org>
Date:   Fri Mar 4 22:40:36 2022 -0800

    m68k: coldfire/device.c: only build for MCF_EDMA when h/w macros are defined
    
    [ Upstream commit e6e1e7b19fa132d23d09c465942aab4c110d3da9 ]
    
    When CONFIG_MCF_EDMA is set (due to COMPILE_TEST, not due to
    CONFIG_M5441x), coldfire/device.c has compile errors due to
    missing MCFEDMA_* symbols. In the .config file that was provided,
    CONFIG_M5206=y, not CONFIG_M5441x, so <asm/m5441xsim.h> is not
    included in coldfire/device.c.
    
    Only build the MCF_EDMA code in coldfire/device.c if the MCFEDMA_*
    hardware macros are defined.
    
    Fixes these build errors:
    
    ../arch/m68k/coldfire/device.c:512:35: error: 'MCFEDMA_BASE' undeclared here (not in a function); did you mean 'MCFDMA_BASE1'?
      512 |                 .start          = MCFEDMA_BASE,
    ../arch/m68k/coldfire/device.c:513:50: error: 'MCFEDMA_SIZE' undeclared here (not in a function)
      513 |                 .end            = MCFEDMA_BASE + MCFEDMA_SIZE - 1,
    ../arch/m68k/coldfire/device.c:517:35: error: 'MCFEDMA_IRQ_INTR0' undeclared here (not in a function)
      517 |                 .start          = MCFEDMA_IRQ_INTR0,
    ../arch/m68k/coldfire/device.c:523:35: error: 'MCFEDMA_IRQ_INTR16' undeclared here (not in a function)
      523 |                 .start          = MCFEDMA_IRQ_INTR16,
    ../arch/m68k/coldfire/device.c:529:35: error: 'MCFEDMA_IRQ_INTR56' undeclared here (not in a function)
      529 |                 .start          = MCFEDMA_IRQ_INTR56,
    ../arch/m68k/coldfire/device.c:535:35: error: 'MCFEDMA_IRQ_ERR' undeclared here (not in a function)
      535 |                 .start          = MCFEDMA_IRQ_ERR,
    
    Fixes: d7e9d01ac292 ("m68k: add ColdFire mcf5441x eDMA platform support")
    Signed-off-by: Randy Dunlap <rdunlap@infradead.org>
    Reported-by: kernel test robot <lkp@intel.com>
    Link: lore.kernel.org/r/202203030252.P752DK46-lkp@intel.com
    Cc: Angelo Dureghello <angelo@sysam.it>
    Cc: Greg Ungerer <gerg@kernel.org>
    Cc: Greg Ungerer <gerg@linux-m68k.org>
    Cc: Geert Uytterhoeven <geert@linux-m68k.org>
    Cc: linux-m68k@lists.linux-m68k.org
    Cc: uclinux-dev@uclinux.org
    Signed-off-by: Greg Ungerer <gerg@linux-m68k.org>
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit 0dff86aeb191651f4bec56d66fab4d3d74d039ac
Author: YueHaibing <yuehaibing@huawei.com>
Date:   Thu Dec 9 17:01:13 2021 +0800

    video: fbdev: controlfb: Fix COMPILE_TEST build
    
    [ Upstream commit 567e44fb51b4f909ae58038a7301352eecea8426 ]
    
    If PPC_BOOK3S, PPC_PMAC and PPC32 is n, COMPILE_TEST build fails:
    
    drivers/video/fbdev/controlfb.c:70:0: error: "pgprot_cached_wthru" redefined [-Werror]
     #define pgprot_cached_wthru(prot) (prot)
    
    In file included from ./arch/powerpc/include/asm/pgtable.h:20:0,
                     from ./include/linux/pgtable.h:6,
                     from ./include/linux/mm.h:33,
                     from drivers/video/fbdev/controlfb.c:37:
    ./arch/powerpc/include/asm/nohash/pgtable.h:243:0: note: this is the location of the previous definition
     #define pgprot_cached_wthru(prot) (__pgprot((pgprot_val(prot) & ~_PAGE_CACHE_CTL) | \
    
    Fixes: a07a63b0e24d ("video: fbdev: controlfb: add COMPILE_TEST support")
    Signed-off-by: YueHaibing <yuehaibing@huawei.com>
    Signed-off-by: Helge Deller <deller@gmx.de>
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit ec1c20b02ae0bdce82b54b1b8a1e72e86d45f672
Author: Sam Ravnborg <sam@ravnborg.org>
Date:   Sun Dec 6 20:02:46 2020 +0100

    video: fbdev: controlfb: Fix set but not used warnings
    
    [ Upstream commit 4aca4dbcac9d8eed8a8dc15b6883270a20a84218 ]
    
    The controlfb driver has a number of dummy defines for IO operations.
    They were introduced in commit a07a63b0e24d
    ("video: fbdev: controlfb: add COMPILE_TEST support").
    
    The write variants did not use their value parameter in the
    dummy versions, resulting in set but not used warnings.
    Fix this by adding "(void)val" to silence the compiler.
    
    Signed-off-by: Sam Ravnborg <sam@ravnborg.org>
    Acked-by: Thomas Zimmermann <tzimmermann@suse.de>
    Cc: Sam Ravnborg <sam@ravnborg.org>
    Cc: Bartlomiej Zolnierkiewicz <b.zolnierkie@samsung.com>
    Cc: "Gustavo A. R. Silva" <gustavoars@kernel.org>
    Cc: Michael Ellerman <mpe@ellerman.id.au>
    Link: https://patchwork.freedesktop.org/patch/msgid/20201206190247.1861316-13-sam@ravnborg.org
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit be6937a11b1c2c15fcb3d14a18304c6743fec43c
Author: Vladimir Oltean <vladimir.oltean@nxp.com>
Date:   Thu Mar 24 18:12:10 2022 +0200

    net: enetc: report software timestamping via SO_TIMESTAMPING
    
    [ Upstream commit feb13dcb1818b775fbd9191f797be67cd605f03e ]
    
    Let user space properly determine that the enetc driver provides
    software timestamps.
    
    Fixes: 4caefbce06d1 ("enetc: add software timestamping")
    Signed-off-by: Vladimir Oltean <vladimir.oltean@nxp.com>
    Reviewed-by: Claudiu Manoil <claudiu.manoil@nxp.com>
    Link: https://lore.kernel.org/r/20220324161210.4122281-1-vladimir.oltean@nxp.com
    Signed-off-by: Jakub Kicinski <kuba@kernel.org>
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit 7ad4f7729f0efcb72c04d5f852236d6c774842d3
Author: Gerhard Engleder <gerhard@engleder-embedded.com>
Date:   Sun Jan 30 10:54:22 2022 +0100

    selftests/net: timestamping: Fix bind_phc check
    
    [ Upstream commit 678dfd5280341d877ca646499bfdc82a3d8b4356 ]
    
    timestamping checks socket options during initialisation. For the field
    bind_phc of the socket option SO_TIMESTAMPING it expects the value -1 if
    PHC is not bound. Actually the value of bind_phc is 0 if PHC is not
    bound. This results in the following output:
    
    SIOCSHWTSTAMP: tx_type 0 requested, got 0; rx_filter 0 requested, got 0
    SO_TIMESTAMP 0
    SO_TIMESTAMPNS 0
    SO_TIMESTAMPING flags 0, bind phc 0
       not expected, flags 0, bind phc -1
    
    This is fixed by setting default value and expected value of bind_phc to
    0.
    
    Fixes: 2214d7032479 ("selftests/net: timestamping: support binding PHC")
    Signed-off-by: Gerhard Engleder <gerhard@engleder-embedded.com>
    Signed-off-by: David S. Miller <davem@davemloft.net>
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit ea2258664ffcde0d5c6836e70e685696f35af75a
Author: Randy Dunlap <rdunlap@infradead.org>
Date:   Fri Mar 4 22:40:36 2022 -0800

    m68k: coldfire/device.c: only build for MCF_EDMA when h/w macros are defined
    
    [ Upstream commit e6e1e7b19fa132d23d09c465942aab4c110d3da9 ]
    
    When CONFIG_MCF_EDMA is set (due to COMPILE_TEST, not due to
    CONFIG_M5441x), coldfire/device.c has compile errors due to
    missing MCFEDMA_* symbols. In the .config file that was provided,
    CONFIG_M5206=y, not CONFIG_M5441x, so <asm/m5441xsim.h> is not
    included in coldfire/device.c.
    
    Only build the MCF_EDMA code in coldfire/device.c if the MCFEDMA_*
    hardware macros are defined.
    
    Fixes these build errors:
    
    ../arch/m68k/coldfire/device.c:512:35: error: 'MCFEDMA_BASE' undeclared here (not in a function); did you mean 'MCFDMA_BASE1'?
      512 |                 .start          = MCFEDMA_BASE,
    ../arch/m68k/coldfire/device.c:513:50: error: 'MCFEDMA_SIZE' undeclared here (not in a function)
      513 |                 .end            = MCFEDMA_BASE + MCFEDMA_SIZE - 1,
    ../arch/m68k/coldfire/device.c:517:35: error: 'MCFEDMA_IRQ_INTR0' undeclared here (not in a function)
      517 |                 .start          = MCFEDMA_IRQ_INTR0,
    ../arch/m68k/coldfire/device.c:523:35: error: 'MCFEDMA_IRQ_INTR16' undeclared here (not in a function)
      523 |                 .start          = MCFEDMA_IRQ_INTR16,
    ../arch/m68k/coldfire/device.c:529:35: error: 'MCFEDMA_IRQ_INTR56' undeclared here (not in a function)
      529 |                 .start          = MCFEDMA_IRQ_INTR56,
    ../arch/m68k/coldfire/device.c:535:35: error: 'MCFEDMA_IRQ_ERR' undeclared here (not in a function)
      535 |                 .start          = MCFEDMA_IRQ_ERR,
    
    Fixes: d7e9d01ac292 ("m68k: add ColdFire mcf5441x eDMA platform support")
    Signed-off-by: Randy Dunlap <rdunlap@infradead.org>
    Reported-by: kernel test robot <lkp@intel.com>
    Link: lore.kernel.org/r/202203030252.P752DK46-lkp@intel.com
    Cc: Angelo Dureghello <angelo@sysam.it>
    Cc: Greg Ungerer <gerg@kernel.org>
    Cc: Greg Ungerer <gerg@linux-m68k.org>
    Cc: Geert Uytterhoeven <geert@linux-m68k.org>
    Cc: linux-m68k@lists.linux-m68k.org
    Cc: uclinux-dev@uclinux.org
    Signed-off-by: Greg Ungerer <gerg@linux-m68k.org>
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit 24cfeb466146ed325d08e1e27fab601ac94078fc
Author: YueHaibing <yuehaibing@huawei.com>
Date:   Thu Dec 9 17:01:13 2021 +0800

    video: fbdev: controlfb: Fix COMPILE_TEST build
    
    [ Upstream commit 567e44fb51b4f909ae58038a7301352eecea8426 ]
    
    If PPC_BOOK3S, PPC_PMAC and PPC32 is n, COMPILE_TEST build fails:
    
    drivers/video/fbdev/controlfb.c:70:0: error: "pgprot_cached_wthru" redefined [-Werror]
     #define pgprot_cached_wthru(prot) (prot)
    
    In file included from ./arch/powerpc/include/asm/pgtable.h:20:0,
                     from ./include/linux/pgtable.h:6,
                     from ./include/linux/mm.h:33,
                     from drivers/video/fbdev/controlfb.c:37:
    ./arch/powerpc/include/asm/nohash/pgtable.h:243:0: note: this is the location of the previous definition
     #define pgprot_cached_wthru(prot) (__pgprot((pgprot_val(prot) & ~_PAGE_CACHE_CTL) | \
    
    Fixes: a07a63b0e24d ("video: fbdev: controlfb: add COMPILE_TEST support")
    Signed-off-by: YueHaibing <yuehaibing@huawei.com>
    Signed-off-by: Helge Deller <deller@gmx.de>
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit 66bbdb5b29b91520eb123872af28aceb44d9c48c
Author: Vladimir Oltean <vladimir.oltean@nxp.com>
Date:   Thu Mar 24 18:12:10 2022 +0200

    net: enetc: report software timestamping via SO_TIMESTAMPING
    
    [ Upstream commit feb13dcb1818b775fbd9191f797be67cd605f03e ]
    
    Let user space properly determine that the enetc driver provides
    software timestamps.
    
    Fixes: 4caefbce06d1 ("enetc: add software timestamping")
    Signed-off-by: Vladimir Oltean <vladimir.oltean@nxp.com>
    Reviewed-by: Claudiu Manoil <claudiu.manoil@nxp.com>
    Link: https://lore.kernel.org/r/20220324161210.4122281-1-vladimir.oltean@nxp.com
    Signed-off-by: Jakub Kicinski <kuba@kernel.org>
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit 20e81143b4303e337141058762d9ae1365cb68ed
Author: Gerhard Engleder <gerhard@engleder-embedded.com>
Date:   Sun Jan 30 10:54:22 2022 +0100

    selftests/net: timestamping: Fix bind_phc check
    
    [ Upstream commit 678dfd5280341d877ca646499bfdc82a3d8b4356 ]
    
    timestamping checks socket options during initialisation. For the field
    bind_phc of the socket option SO_TIMESTAMPING it expects the value -1 if
    PHC is not bound. Actually the value of bind_phc is 0 if PHC is not
    bound. This results in the following output:
    
    SIOCSHWTSTAMP: tx_type 0 requested, got 0; rx_filter 0 requested, got 0
    SO_TIMESTAMP 0
    SO_TIMESTAMPNS 0
    SO_TIMESTAMPING flags 0, bind phc 0
       not expected, flags 0, bind phc -1
    
    This is fixed by setting default value and expected value of bind_phc to
    0.
    
    Fixes: 2214d7032479 ("selftests/net: timestamping: support binding PHC")
    Signed-off-by: Gerhard Engleder <gerhard@engleder-embedded.com>
    Signed-off-by: David S. Miller <davem@davemloft.net>
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit 39417ad6de7e96bcd596247fbcaea00d3f3e3c11
Author: Randy Dunlap <rdunlap@infradead.org>
Date:   Fri Mar 4 22:40:36 2022 -0800

    m68k: coldfire/device.c: only build for MCF_EDMA when h/w macros are defined
    
    [ Upstream commit e6e1e7b19fa132d23d09c465942aab4c110d3da9 ]
    
    When CONFIG_MCF_EDMA is set (due to COMPILE_TEST, not due to
    CONFIG_M5441x), coldfire/device.c has compile errors due to
    missing MCFEDMA_* symbols. In the .config file that was provided,
    CONFIG_M5206=y, not CONFIG_M5441x, so <asm/m5441xsim.h> is not
    included in coldfire/device.c.
    
    Only build the MCF_EDMA code in coldfire/device.c if the MCFEDMA_*
    hardware macros are defined.
    
    Fixes these build errors:
    
    ../arch/m68k/coldfire/device.c:512:35: error: 'MCFEDMA_BASE' undeclared here (not in a function); did you mean 'MCFDMA_BASE1'?
      512 |                 .start          = MCFEDMA_BASE,
    ../arch/m68k/coldfire/device.c:513:50: error: 'MCFEDMA_SIZE' undeclared here (not in a function)
      513 |                 .end            = MCFEDMA_BASE + MCFEDMA_SIZE - 1,
    ../arch/m68k/coldfire/device.c:517:35: error: 'MCFEDMA_IRQ_INTR0' undeclared here (not in a function)
      517 |                 .start          = MCFEDMA_IRQ_INTR0,
    ../arch/m68k/coldfire/device.c:523:35: error: 'MCFEDMA_IRQ_INTR16' undeclared here (not in a function)
      523 |                 .start          = MCFEDMA_IRQ_INTR16,
    ../arch/m68k/coldfire/device.c:529:35: error: 'MCFEDMA_IRQ_INTR56' undeclared here (not in a function)
      529 |                 .start          = MCFEDMA_IRQ_INTR56,
    ../arch/m68k/coldfire/device.c:535:35: error: 'MCFEDMA_IRQ_ERR' undeclared here (not in a function)
      535 |                 .start          = MCFEDMA_IRQ_ERR,
    
    Fixes: d7e9d01ac292 ("m68k: add ColdFire mcf5441x eDMA platform support")
    Signed-off-by: Randy Dunlap <rdunlap@infradead.org>
    Reported-by: kernel test robot <lkp@intel.com>
    Link: lore.kernel.org/r/202203030252.P752DK46-lkp@intel.com
    Cc: Angelo Dureghello <angelo@sysam.it>
    Cc: Greg Ungerer <gerg@kernel.org>
    Cc: Greg Ungerer <gerg@linux-m68k.org>
    Cc: Geert Uytterhoeven <geert@linux-m68k.org>
    Cc: linux-m68k@lists.linux-m68k.org
    Cc: uclinux-dev@uclinux.org
    Signed-off-by: Greg Ungerer <gerg@linux-m68k.org>
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit 546fba26b9054286ea24bf969e7e58e6e01280e8
Author: YueHaibing <yuehaibing@huawei.com>
Date:   Thu Dec 9 17:01:13 2021 +0800

    video: fbdev: controlfb: Fix COMPILE_TEST build
    
    [ Upstream commit 567e44fb51b4f909ae58038a7301352eecea8426 ]
    
    If PPC_BOOK3S, PPC_PMAC and PPC32 is n, COMPILE_TEST build fails:
    
    drivers/video/fbdev/controlfb.c:70:0: error: "pgprot_cached_wthru" redefined [-Werror]
     #define pgprot_cached_wthru(prot) (prot)
    
    In file included from ./arch/powerpc/include/asm/pgtable.h:20:0,
                     from ./include/linux/pgtable.h:6,
                     from ./include/linux/mm.h:33,
                     from drivers/video/fbdev/controlfb.c:37:
    ./arch/powerpc/include/asm/nohash/pgtable.h:243:0: note: this is the location of the previous definition
     #define pgprot_cached_wthru(prot) (__pgprot((pgprot_val(prot) & ~_PAGE_CACHE_CTL) | \
    
    Fixes: a07a63b0e24d ("video: fbdev: controlfb: add COMPILE_TEST support")
    Signed-off-by: YueHaibing <yuehaibing@huawei.com>
    Signed-off-by: Helge Deller <deller@gmx.de>
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit 7c285ea989009f90d759b30f41e22823bed30a2b
Author: Vladimir Oltean <vladimir.oltean@nxp.com>
Date:   Thu Mar 24 18:12:10 2022 +0200

    net: enetc: report software timestamping via SO_TIMESTAMPING
    
    [ Upstream commit feb13dcb1818b775fbd9191f797be67cd605f03e ]
    
    Let user space properly determine that the enetc driver provides
    software timestamps.
    
    Fixes: 4caefbce06d1 ("enetc: add software timestamping")
    Signed-off-by: Vladimir Oltean <vladimir.oltean@nxp.com>
    Reviewed-by: Claudiu Manoil <claudiu.manoil@nxp.com>
    Link: https://lore.kernel.org/r/20220324161210.4122281-1-vladimir.oltean@nxp.com
    Signed-off-by: Jakub Kicinski <kuba@kernel.org>
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit e1b5ddc06f1e27b49163b5e6c68b139774b088d0
Author: Gerhard Engleder <gerhard@engleder-embedded.com>
Date:   Sun Jan 30 10:54:22 2022 +0100

    selftests/net: timestamping: Fix bind_phc check
    
    [ Upstream commit 678dfd5280341d877ca646499bfdc82a3d8b4356 ]
    
    timestamping checks socket options during initialisation. For the field
    bind_phc of the socket option SO_TIMESTAMPING it expects the value -1 if
    PHC is not bound. Actually the value of bind_phc is 0 if PHC is not
    bound. This results in the following output:
    
    SIOCSHWTSTAMP: tx_type 0 requested, got 0; rx_filter 0 requested, got 0
    SO_TIMESTAMP 0
    SO_TIMESTAMPNS 0
    SO_TIMESTAMPING flags 0, bind phc 0
       not expected, flags 0, bind phc -1
    
    This is fixed by setting default value and expected value of bind_phc to
    0.
    
    Fixes: 2214d7032479 ("selftests/net: timestamping: support binding PHC")
    Signed-off-by: Gerhard Engleder <gerhard@engleder-embedded.com>
    Signed-off-by: David S. Miller <davem@davemloft.net>
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit 1df09885f8a02a59421a498cb06daa26cc9c66c7
Author: Randy Dunlap <rdunlap@infradead.org>
Date:   Fri Mar 4 22:40:36 2022 -0800

    m68k: coldfire/device.c: only build for MCF_EDMA when h/w macros are defined
    
    [ Upstream commit e6e1e7b19fa132d23d09c465942aab4c110d3da9 ]
    
    When CONFIG_MCF_EDMA is set (due to COMPILE_TEST, not due to
    CONFIG_M5441x), coldfire/device.c has compile errors due to
    missing MCFEDMA_* symbols. In the .config file that was provided,
    CONFIG_M5206=y, not CONFIG_M5441x, so <asm/m5441xsim.h> is not
    included in coldfire/device.c.
    
    Only build the MCF_EDMA code in coldfire/device.c if the MCFEDMA_*
    hardware macros are defined.
    
    Fixes these build errors:
    
    ../arch/m68k/coldfire/device.c:512:35: error: 'MCFEDMA_BASE' undeclared here (not in a function); did you mean 'MCFDMA_BASE1'?
      512 |                 .start          = MCFEDMA_BASE,
    ../arch/m68k/coldfire/device.c:513:50: error: 'MCFEDMA_SIZE' undeclared here (not in a function)
      513 |                 .end            = MCFEDMA_BASE + MCFEDMA_SIZE - 1,
    ../arch/m68k/coldfire/device.c:517:35: error: 'MCFEDMA_IRQ_INTR0' undeclared here (not in a function)
      517 |                 .start          = MCFEDMA_IRQ_INTR0,
    ../arch/m68k/coldfire/device.c:523:35: error: 'MCFEDMA_IRQ_INTR16' undeclared here (not in a function)
      523 |                 .start          = MCFEDMA_IRQ_INTR16,
    ../arch/m68k/coldfire/device.c:529:35: error: 'MCFEDMA_IRQ_INTR56' undeclared here (not in a function)
      529 |                 .start          = MCFEDMA_IRQ_INTR56,
    ../arch/m68k/coldfire/device.c:535:35: error: 'MCFEDMA_IRQ_ERR' undeclared here (not in a function)
      535 |                 .start          = MCFEDMA_IRQ_ERR,
    
    Fixes: d7e9d01ac292 ("m68k: add ColdFire mcf5441x eDMA platform support")
    Signed-off-by: Randy Dunlap <rdunlap@infradead.org>
    Reported-by: kernel test robot <lkp@intel.com>
    Link: lore.kernel.org/r/202203030252.P752DK46-lkp@intel.com
    Cc: Angelo Dureghello <angelo@sysam.it>
    Cc: Greg Ungerer <gerg@kernel.org>
    Cc: Greg Ungerer <gerg@linux-m68k.org>
    Cc: Geert Uytterhoeven <geert@linux-m68k.org>
    Cc: linux-m68k@lists.linux-m68k.org
    Cc: uclinux-dev@uclinux.org
    Signed-off-by: Greg Ungerer <gerg@linux-m68k.org>
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit 3a26a60807b6baa0d1f833f90fceaa8693cf66ac
Author: YueHaibing <yuehaibing@huawei.com>
Date:   Thu Dec 9 17:01:13 2021 +0800

    video: fbdev: controlfb: Fix COMPILE_TEST build
    
    [ Upstream commit 567e44fb51b4f909ae58038a7301352eecea8426 ]
    
    If PPC_BOOK3S, PPC_PMAC and PPC32 is n, COMPILE_TEST build fails:
    
    drivers/video/fbdev/controlfb.c:70:0: error: "pgprot_cached_wthru" redefined [-Werror]
     #define pgprot_cached_wthru(prot) (prot)
    
    In file included from ./arch/powerpc/include/asm/pgtable.h:20:0,
                     from ./include/linux/pgtable.h:6,
                     from ./include/linux/mm.h:33,
                     from drivers/video/fbdev/controlfb.c:37:
    ./arch/powerpc/include/asm/nohash/pgtable.h:243:0: note: this is the location of the previous definition
     #define pgprot_cached_wthru(prot) (__pgprot((pgprot_val(prot) & ~_PAGE_CACHE_CTL) | \
    
    Fixes: a07a63b0e24d ("video: fbdev: controlfb: add COMPILE_TEST support")
    Signed-off-by: YueHaibing <yuehaibing@huawei.com>
    Signed-off-by: Helge Deller <deller@gmx.de>
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit 1cd927ad6f62f27d8908498dcbf61395c5dd5fe2
Author: Steven Rostedt (Google) <rostedt@goodmis.org>
Date:   Fri Apr 1 14:39:03 2022 -0400

    tracing: mark user_events as BROKEN
    
    After being merged, user_events become more visible to a wider audience
    that have concerns with the current API.
    
    It is too late to fix this for this release, but instead of a full
    revert, just mark it as BROKEN (which prevents it from being selected in
    make config).  Then we can work finding a better API.  If that fails,
    then it will need to be completely reverted.
    
    To not have the code silently bitrot, still allow building it with
    COMPILE_TEST.
    
    And to prevent the uapi header from being installed, then later changed,
    and then have an old distro user space see the old version, move the
    header file out of the uapi directory.
    
    Surround the include with CONFIG_COMPILE_TEST to the current location,
    but when the BROKEN tag is taken off, it will use the uapi directory,
    and fail to compile.  This is a good way to remind us to move the header
    back.
    
    Link: https://lore.kernel.org/all/20220330155835.5e1f6669@gandalf.local.home
    Link: https://lkml.kernel.org/r/20220330201755.29319-1-mathieu.desnoyers@efficios.com
    Suggested-by: Mathieu Desnoyers <mathieu.desnoyers@efficios.com>
    Signed-off-by: Steven Rostedt (Google) <rostedt@goodmis.org>
    Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>

commit 5cfff569cab8bf544bab62c911c5d6efd5af5e05
Author: Steven Rostedt (Google) <rostedt@goodmis.org>
Date:   Fri Apr 1 14:39:03 2022 -0400

    tracing: Move user_events.h temporarily out of include/uapi
    
    While user_events API is under development and has been marked for broken
    to not let the API become fixed, move the header file out of the uapi
    directory. This is to prevent it from being installed, then later changed,
    and then have an old distro user space update with a new kernel, where
    applications see the user_events being available, but the old header is in
    place, and then they get compiled incorrectly.
    
    Also, surround the include with CONFIG_COMPILE_TEST to the current
    location, but when the BROKEN tag is taken off, it will use the uapi
    directory, and fail to compile. This is a good way to remind us to move
    the header back.
    
    Link: https://lore.kernel.org/all/20220330155835.5e1f6669@gandalf.local.home
    Link: https://lkml.kernel.org/r/20220330201755.29319-1-mathieu.desnoyers@efficios.com
    Link: https://lkml.kernel.org/r/20220401143903.188384f3@gandalf.local.home
    
    Suggested-by: Mathieu Desnoyers <mathieu.desnoyers@efficios.com>
    Signed-off-by: Steven Rostedt (Google) <rostedt@goodmis.org>

commit 4a13e559af0b177eb934c39338f100a9f692a37b
Merge: f21a35098422 26de0ab9841a 0b1be2c085ab fa3416509605
Author: Rafael J. Wysocki <rafael.j.wysocki@intel.com>
Date:   Thu Mar 31 18:42:07 2022 +0200

    Merge branches 'acpi-ipmi', 'acpi-tables' and 'acpi-apei'
    
    Merge IMPI driver changes, ACPI tables parsing code changes and
    additional APEI changes for v5.18-rc1:
    
     - Replace usage of found with dedicated list iterator variable
       in the ACPI IPMI driver (Jakob Koschel).
    
     - Make LAPIC_ADDR_OVR address readable in a message parsed during
       MADT parsing (Vasant Hegde).
    
     - Clean up variable name confusion in APEI (Jakob Koschel).
    
    * acpi-ipmi:
      ACPI: IPMI: replace usage of found with dedicated list iterator variable
    
    * acpi-tables:
      ACPI: tables: Make LAPIC_ADDR_OVR address readable in message
    
    * acpi-apei:
      ACPI, APEI: Use the correct variable for sizeof()

commit ed9794812b0a61f62317991c5c3e6c78749a0bdc
Author: Helge Deller <deller@gmx.de>
Date:   Mon Mar 21 22:02:01 2022 +0100

    parisc: Detect hppa-suse-linux-gcc compiler for cross-building
    
    Allow the system to find the SUSE hppa compiler and linker to set
    CROSS32_COMPILE and CROSS_COMPILE.
    
    Suggested-by: Jiri Slaby <jirislaby@kernel.org>
    Signed-off-by: Helge Deller <deller@gmx.de>

commit feb13dcb1818b775fbd9191f797be67cd605f03e
Author: Vladimir Oltean <vladimir.oltean@nxp.com>
Date:   Thu Mar 24 18:12:10 2022 +0200

    net: enetc: report software timestamping via SO_TIMESTAMPING
    
    Let user space properly determine that the enetc driver provides
    software timestamps.
    
    Fixes: 4caefbce06d1 ("enetc: add software timestamping")
    Signed-off-by: Vladimir Oltean <vladimir.oltean@nxp.com>
    Reviewed-by: Claudiu Manoil <claudiu.manoil@nxp.com>
    Link: https://lore.kernel.org/r/20220324161210.4122281-1-vladimir.oltean@nxp.com
    Signed-off-by: Jakub Kicinski <kuba@kernel.org>

commit f9b3cd24578401e7a392974b3353277286e49cee
Author: Kees Cook <keescook@chromium.org>
Date:   Wed Mar 23 16:05:38 2022 -0700

    Kconfig.debug: make DEBUG_INFO selectable from a choice
    
    Currently it's not possible to enable DEBUG_INFO for an all*config
    build, since it is marked as "depends on !COMPILE_TEST".
    
    This generally makes sense because a debug build of an all*config target
    ends up taking much longer and the output is much larger.  Having this
    be "default off" makes sense.
    
    However, there are cases where enabling DEBUG_INFO for such builds is
    useful for doing treewide A/B comparisons of build options, etc.
    
    Make DEBUG_INFO selectable from any of the DWARF version choice options,
    with DEBUG_INFO_NONE being the default for COMPILE_TEST.
    
    The mutually exclusive relationship between DWARF5 and BTF must be
    inverted, but the result remains the same.  Additionally moves
    DEBUG_KERNEL and DEBUG_MISC up to the top of the menu because they were
    enabling features _above_ it, making it weird to navigate menuconfig.
    
    [keescook@chromium.org: make DEBUG_INFO always default=n]
      Link: https://lkml.kernel.org/r/20220128214131.580131-1-keescook@chromium.org
      Link: https://lore.kernel.org/lkml/YfRY6+CaQxX7O8vF@dev-arch.archlinux-ax161
    
    Link: https://lkml.kernel.org/r/20220125075126.891825-1-keescook@chromium.org
    Signed-off-by: Kees Cook <keescook@chromium.org>
    Suggested-by: Arnd Bergmann <arnd@arndb.de>
    Reviewed-by: Arnd Bergmann <arnd@arndb.de>
    Reviewed-by: Nathan Chancellor <nathan@kernel.org>
    Reviewed-by: Nick Desaulniers <ndesaulniers@google.com>
    Tested-by: Nick Desaulniers <ndesaulniers@google.com>
    Reviewed-by: Masahiro Yamada <masahiroy@kernel.org>
    Cc: Nick Desaulniers <ndesaulniers@google.com>
    Cc: Tetsuo Handa <penguin-kernel@I-love.SAKURA.ne.jp>
    Signed-off-by: Andrew Morton <akpm@linux-foundation.org>
    Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>

commit 182966e1cd74ec0e326cd376de241803ee79741b
Merge: 9c4b86ebf5bf ba2c670ae84b
Author: Linus Torvalds <torvalds@linux-foundation.org>
Date:   Wed Mar 23 14:51:35 2022 -0700

    Merge tag 'media/v5.18-1' of git://git.kernel.org/pub/scm/linux/kernel/git/mchehab/linux-media
    
    Pull media updates from Mauro Carvalho Chehab:
    
     - a major reorg at platform Kconfig/Makefile files, organizing them per
       vendor. The other media Kconfig/Makefile files also sorted
    
     - New sensor drivers: hi847, isl7998x, ov08d10
    
     - New Amphion vpu decoder stateful driver
    
     - New Atmel microchip csi2dc driver
    
     - tegra-vde driver promoted from staging
    
     - atomisp: some fixes for it to work on BYT
    
     - imx7-mipi-csis driver promoted from staging and renamed
    
     - camss driver got initial support for VFE hardware version Titan 480
    
     - mtk-vcodec has gained support for MT8192
    
     - lots of driver changes, fixes and improvements
    
    * tag 'media/v5.18-1' of git://git.kernel.org/pub/scm/linux/kernel/git/mchehab/linux-media: (417 commits)
      media: nxp: Restrict VIDEO_IMX_MIPI_CSIS to ARCH_MXC or COMPILE_TEST
      media: amphion: cleanup media device if register it fail
      media: amphion: fix some issues to improve robust
      media: amphion: fix some error related with undefined reference to __divdi3
      media: amphion: fix an issue that using pm_runtime_get_sync incorrectly
      media: vidtv: use vfree() for memory allocated with vzalloc()
      media: m5mols/m5mols.h: document new reset field
      media: pixfmt-yuv-planar.rst: fix PIX_FMT labels
      media: platform: Remove unnecessary print function dev_err()
      media: amphion: Add missing of_node_put() in vpu_core_parse_dt()
      media: mtk-vcodec: Add missing of_node_put() in mtk_vdec_hw_prob_done()
      media: platform: amphion: Fix build error without MAILBOX
      media: spi: Kconfig: Place SPI drivers on a single menu
      media: i2c: Kconfig: move camera drivers to the top
      media: atomisp: fix bad usage at error handling logic
      media: platform: rename mediatek/mtk-jpeg/ to mediatek/jpeg/
      media: media/*/Kconfig: sort entries
      media: Kconfig: cleanup VIDEO_DEV dependencies
      media: platform/*/Kconfig: make manufacturer menus more uniform
      media: platform: Create vendor/{Makefile,Kconfig} files
      ...

commit 93e220a62da36f766b3188e76e234607e41488f9
Merge: 5628b8de1228 0e03b8fd2936
Author: Linus Torvalds <torvalds@linux-foundation.org>
Date:   Mon Mar 21 16:02:36 2022 -0700

    Merge branch 'linus' of git://git.kernel.org/pub/scm/linux/kernel/git/herbert/crypto-2.6
    
    Pull crypto updates from Herbert Xu:
     "API:
       - hwrng core now credits for low-quality RNG devices.
    
      Algorithms:
       - Optimisations for neon aes on arm/arm64.
       - Add accelerated crc32_be on arm64.
       - Add ffdheXYZ(dh) templates.
       - Disallow hmac keys < 112 bits in FIPS mode.
       - Add AVX assembly implementation for sm3 on x86.
    
      Drivers:
       - Add missing local_bh_disable calls for crypto_engine callback.
       - Ensure BH is disabled in crypto_engine callback path.
       - Fix zero length DMA mappings in ccree.
       - Add synchronization between mailbox accesses in octeontx2.
       - Add Xilinx SHA3 driver.
       - Add support for the TDES IP available on sama7g5 SoC in atmel"
    
    * 'linus' of git://git.kernel.org/pub/scm/linux/kernel/git/herbert/crypto-2.6: (137 commits)
      crypto: xilinx - Turn SHA into a tristate and allow COMPILE_TEST
      MAINTAINERS: update HPRE/SEC2/TRNG driver maintainers list
      crypto: dh - Remove the unused function dh_safe_prime_dh_alg()
      hwrng: nomadik - Change clk_disable to clk_disable_unprepare
      crypto: arm64 - cleanup comments
      crypto: qat - fix initialization of pfvf rts_map_msg structures
      crypto: qat - fix initialization of pfvf cap_msg structures
      crypto: qat - remove unneeded assignment
      crypto: qat - disable registration of algorithms
      crypto: hisilicon/qm - fix memset during queues clearing
      crypto: xilinx: prevent probing on non-xilinx hardware
      crypto: marvell/octeontx - Use swap() instead of open coding it
      crypto: ccree - Fix use after free in cc_cipher_exit()
      crypto: ccp - ccp_dmaengine_unregister release dma channels
      crypto: octeontx2 - fix missing unlock
      hwrng: cavium - fix NULL but dereferenced coccicheck error
      crypto: cavium/nitrox - don't cast parameter in bit operations
      crypto: vmx - add missing dependencies
      MAINTAINERS: Add maintainer for Xilinx ZynqMP SHA3 driver
      crypto: xilinx - Add Xilinx SHA3 driver
      ...

commit d56c9fe6a06820d5ef8188d96bf4345c7bdba249
Author: Joanne Koong <joannelkoong@gmail.com>
Date:   Mon Mar 21 11:58:02 2022 -0700

    bpf: Fix warning for cast from restricted gfp_t in verifier
    
    This fixes the sparse warning reported by the kernel test robot:
    
    kernel/bpf/verifier.c:13499:47: sparse: warning: cast from restricted gfp_t
    kernel/bpf/verifier.c:13501:47: sparse: warning: cast from restricted gfp_t
    
    This fix can be verified locally by running:
    1) wget
    https://raw.githubusercontent.com/intel/lkp-tests/master/sbin/make.cross
    -O make.cross
    
    2) chmod +x ~/bin/make.cross
    
    3) COMPILER_INSTALL_PATH=$HOME/0day COMPILER=gcc-11.2.0 ./make.cross
    C=1 CF='-fdiagnostic-prefix -D__CHECK_ENDIAN__'
    
    Fixes: b00fa38a9c1c ("bpf: Enable non-atomic allocations in local storage")
    Reported-by: kernel test robot <lkp@intel.com>
    Signed-off-by: Joanne Koong <joannelkoong@gmail.com>
    Signed-off-by: Alexei Starovoitov <ast@kernel.org>
    Link: https://lore.kernel.org/bpf/20220321185802.824223-1-joannekoong@fb.com

commit ba2c670ae84bad705ec023bfa7a48f7f8eab5e16
Author: Laurent Pinchart <laurent.pinchart@ideasonboard.com>
Date:   Fri Mar 18 21:37:35 2022 +0100

    media: nxp: Restrict VIDEO_IMX_MIPI_CSIS to ARCH_MXC or COMPILE_TEST
    
    The imx-mipi-csis driver is specific to NXP platforms. Restrict it to
    those by default, and enable compilation with COMPILE_TEST to keep a
    wide test coverage.
    
    Link: https://lore.kernel.org/linux-media/20220318203735.5923-1-laurent.pinchart+renesas@ideasonboard.com
    Signed-off-by: Laurent Pinchart <laurent.pinchart@ideasonboard.com>
    Reviewed-by: Rui Miguel Silva <rmfrfs@gmail.com>
    Reviewed-by: Kieran Bingham <kieran.bingham+renesas@ideasonboard.com>
    Signed-off-by: Mauro Carvalho Chehab <mchehab@kernel.org>

commit 95c211f03fc760329e2afcc58cec55556f07e1e9
Author: William Breathitt Gray <vilhelm.gray@gmail.com>
Date:   Tue Mar 15 15:38:52 2022 -0400

    counter: 104-quad-8: Add COMPILE_TEST depends
    
    104_QUAD_8 depends on X86, but compiles fine on ARCH=arm. This patch
    adds support for COMPILE_TEST which is useful for compile testing code
    changes to the driver and Counter subsystem.
    
    Link: https://lore.kernel.org/r/20220105094137.259111-1-vilhelm.gray@gmail.com
    Cc: Syed Nayyar Waris <syednwaris@gmail.com>
    Suggested-by: Uwe Kleine-Knig <u.kleine-koenig@pengutronix.de>
    Acked-by: Uwe Kleine-Knig <u.kleine-koenig@pengutronix.de>
    Acked-by: Syed Nayyar Waris <syednwaris@gmail.com>
    Signed-off-by: William Breathitt Gray <vilhelm.gray@gmail.com>
    Link: https://lore.kernel.org/r/3917721e792d362ee108b2f12cd2223675449d05.1647373009.git.vilhelm.gray@gmail.com
    Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>

commit f4a4f9a54b2c52b0c6f40d0f37a129e9909fa62d
Author: YueHaibing <yuehaibing@huawei.com>
Date:   Fri Mar 18 04:03:05 2022 +0100

    media: platform: amphion: Fix build error without MAILBOX
    
    while COMPILE_TEST is y and MAILBOX is n, build fails:
    
    ERROR: modpost: "mbox_request_channel_byname" [drivers/media/platform/amphion/amphion-vpu.ko] undefined!
    ERROR: modpost: "mbox_free_channel" [drivers/media/platform/amphion/amphion-vpu.ko] undefined!
    ERROR: modpost: "mbox_send_message" [drivers/media/platform/amphion/amphion-vpu.ko] undefined!
    
    Adding a MAILBOX dependency in VIDEO_AMPHION_VPU to fix this.
    
    Link: https://lore.kernel.org/linux-media/20220318030305.39120-1-yuehaibing@huawei.com
    Fixes: 52b3a219dd4a ("media: platform: amphion: move config to its own file")
    Signed-off-by: YueHaibing <yuehaibing@huawei.com>
    Signed-off-by: Mauro Carvalho Chehab <mchehab@kernel.org>

commit 0e03b8fd29363f2df44e2a7a176d486de550757a
Author: Herbert Xu <herbert@gondor.apana.org.au>
Date:   Wed Mar 9 15:20:01 2022 +1200

    crypto: xilinx - Turn SHA into a tristate and allow COMPILE_TEST
    
    This patch turns the new SHA driver into a tristate and also allows
    compile testing.
    
    Signed-off-by: Herbert Xu <herbert@gondor.apana.org.au>

commit b0de0cf4f57cbac41ef7fa382bcaef83288af1e7
Author: Eric Dumazet <edumazet@google.com>
Date:   Tue Mar 8 21:47:06 2022 -0800

    tcp: autocork: take MSG_EOR hint into consideration
    
    tcp_should_autocork() is evaluating if it makes senses
    to not immediately send current skb, hoping that
    user space will add more payload on it by the
    time TCP stack reacts to upcoming TX completions.
    
    If current skb got MSG_EOR mark, then we know
    that no further data will be added, it is therefore
    futile to wait.
    
    SOF_TIMESTAMPING_TX_ACK will become a bit more accurate,
    if prior packets are still in qdisc/device queues.
    
    Signed-off-by: Eric Dumazet <edumazet@google.com>
    Cc: Martin KaFai Lau <kafai@fb.com>
    Cc: Willem de Bruijn <willemb@google.com>
    Acked-by: Soheil Hassas Yeganeh <soheil@google.com>
    Link: https://lore.kernel.org/r/20220309054706.2857266-1-eric.dumazet@gmail.com
    Signed-off-by: Jakub Kicinski <kuba@kernel.org>

commit 65693acdebb29737eed6e6b0c95cdbab9c8ad2c1
Author: Alex Elder <elder@linaro.org>
Date:   Tue Mar 1 05:34:40 2022 -0600

    net: ipa: add an interconnect dependency
    
    commit 1dba41c9d2e2dc94b543394974f63d55aa195bfe upstream.
    
    In order to function, the IPA driver very clearly requires the
    interconnect framework to be enabled in the kernel configuration.
    State that dependency in the Kconfig file.
    
    This became a problem when CONFIG_COMPILE_TEST support was added.
    Non-Qualcomm platforms won't necessarily enable CONFIG_INTERCONNECT.
    
    Reported-by: kernel test robot <lkp@intel.com>
    Fixes: 38a4066f593c5 ("net: ipa: support COMPILE_TEST")
    Signed-off-by: Alex Elder <elder@linaro.org>
    Link: https://lore.kernel.org/r/20220301113440.257916-1-elder@linaro.org
    Signed-off-by: Jakub Kicinski <kuba@kernel.org>
    Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>

commit 37309331521133292d6fc37abc5bbf03998da091
Author: Alex Elder <elder@linaro.org>
Date:   Fri Feb 25 14:15:30 2022 -0600

    net: ipa: fix a build dependency
    
    commit caef14b7530c065fb85d54492768fa48fdb5093e upstream.
    
    An IPA build problem arose in the linux-next tree the other day.
    The problem is that a recent commit adds a new dependency on some
    code, and the Kconfig file for IPA doesn't reflect that dependency.
    As a result, some configurations can fail to build (particularly
    when COMPILE_TEST is enabled).
    
    The recent patch adds calls to qmp_get(), qmp_put(), and qmp_send(),
    and those are built based on the QCOM_AOSS_QMP config option.  If
    that symbol is not defined, stubs are defined, so we just need to
    ensure QCOM_AOSS_QMP is compatible with QCOM_IPA, or it's not
    defined.
    
    Reported-by: Randy Dunlap <rdunlap@infradead.org>
    Fixes: 34a081761e4e3 ("net: ipa: request IPA register values be retained")
    Signed-off-by: Alex Elder <elder@linaro.org>
    Tested-by: Randy Dunlap <rdunlap@infradead.org>
    Acked-by: Randy Dunlap <rdunlap@infradead.org>
    Signed-off-by: David S. Miller <davem@davemloft.net>
    Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>

commit 045fb3a4115c149fb319f09163f8d765bd033472
Author: Wolfram Sang <wsa@kernel.org>
Date:   Sat Feb 12 20:47:07 2022 +0100

    i2c: qup: allow COMPILE_TEST
    
    [ Upstream commit 5de717974005fcad2502281e9f82e139ca91f4bb ]
    
    Driver builds fine with COMPILE_TEST. Enable it for wider test coverage
    and easier maintenance.
    
    Signed-off-by: Wolfram Sang <wsa@kernel.org>
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit 038609bfbadf123f8f84d9bfe015c2be06b89bd5
Author: Wolfram Sang <wsa@kernel.org>
Date:   Sat Feb 12 20:46:57 2022 +0100

    i2c: imx: allow COMPILE_TEST
    
    [ Upstream commit 2ce4462f2724d1b3cedccea441c6d18bb360629a ]
    
    Driver builds fine with COMPILE_TEST. Enable it for wider test coverage
    and easier maintenance.
    
    Signed-off-by: Wolfram Sang <wsa@kernel.org>
    Acked-by: Oleksij Rempel <o.rempel@pengutronix.de>
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit af74f5b7a8d09c8cbdd5f1c2aa32c25e5717c822
Author: Wolfram Sang <wsa@kernel.org>
Date:   Sat Feb 12 20:45:48 2022 +0100

    i2c: cadence: allow COMPILE_TEST
    
    [ Upstream commit 0b0dcb3882c8f08bdeafa03adb4487e104d26050 ]
    
    Driver builds fine with COMPILE_TEST. Enable it for wider test coverage
    and easier maintenance.
    
    Signed-off-by: Wolfram Sang <wsa@kernel.org>
    Acked-by: Michal Simek <michal.simek@xilinx.com>
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit a559e0598ce68231b79b9c143303016216ec0fd1
Author: Alex Elder <elder@linaro.org>
Date:   Tue Mar 1 05:34:40 2022 -0600

    net: ipa: add an interconnect dependency
    
    commit 1dba41c9d2e2dc94b543394974f63d55aa195bfe upstream.
    
    In order to function, the IPA driver very clearly requires the
    interconnect framework to be enabled in the kernel configuration.
    State that dependency in the Kconfig file.
    
    This became a problem when CONFIG_COMPILE_TEST support was added.
    Non-Qualcomm platforms won't necessarily enable CONFIG_INTERCONNECT.
    
    Reported-by: kernel test robot <lkp@intel.com>
    Fixes: 38a4066f593c5 ("net: ipa: support COMPILE_TEST")
    Signed-off-by: Alex Elder <elder@linaro.org>
    Link: https://lore.kernel.org/r/20220301113440.257916-1-elder@linaro.org
    Signed-off-by: Jakub Kicinski <kuba@kernel.org>
    Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>

commit f6fbf18d156cf1b84d4b5cfb6d7bef306e39ce9f
Author: Wolfram Sang <wsa@kernel.org>
Date:   Sat Feb 12 20:47:07 2022 +0100

    i2c: qup: allow COMPILE_TEST
    
    [ Upstream commit 5de717974005fcad2502281e9f82e139ca91f4bb ]
    
    Driver builds fine with COMPILE_TEST. Enable it for wider test coverage
    and easier maintenance.
    
    Signed-off-by: Wolfram Sang <wsa@kernel.org>
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit d65d187b51b626595b2958f27cc432ce6ca5e3d1
Author: Wolfram Sang <wsa@kernel.org>
Date:   Sat Feb 12 20:46:57 2022 +0100

    i2c: imx: allow COMPILE_TEST
    
    [ Upstream commit 2ce4462f2724d1b3cedccea441c6d18bb360629a ]
    
    Driver builds fine with COMPILE_TEST. Enable it for wider test coverage
    and easier maintenance.
    
    Signed-off-by: Wolfram Sang <wsa@kernel.org>
    Acked-by: Oleksij Rempel <o.rempel@pengutronix.de>
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit d2327116861c214d6be2d0c30c0a604c526af5ba
Author: Wolfram Sang <wsa@kernel.org>
Date:   Sat Feb 12 20:45:48 2022 +0100

    i2c: cadence: allow COMPILE_TEST
    
    [ Upstream commit 0b0dcb3882c8f08bdeafa03adb4487e104d26050 ]
    
    Driver builds fine with COMPILE_TEST. Enable it for wider test coverage
    and easier maintenance.
    
    Signed-off-by: Wolfram Sang <wsa@kernel.org>
    Acked-by: Michal Simek <michal.simek@xilinx.com>
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit 16f903afbafb9f505606e19e6e36ac5d7be96910
Author: Wolfram Sang <wsa@kernel.org>
Date:   Sat Feb 12 20:47:07 2022 +0100

    i2c: qup: allow COMPILE_TEST
    
    [ Upstream commit 5de717974005fcad2502281e9f82e139ca91f4bb ]
    
    Driver builds fine with COMPILE_TEST. Enable it for wider test coverage
    and easier maintenance.
    
    Signed-off-by: Wolfram Sang <wsa@kernel.org>
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit 57c333ad8c2829cf92cf1a3edd5742038b021a83
Author: Wolfram Sang <wsa@kernel.org>
Date:   Sat Feb 12 20:45:48 2022 +0100

    i2c: cadence: allow COMPILE_TEST
    
    [ Upstream commit 0b0dcb3882c8f08bdeafa03adb4487e104d26050 ]
    
    Driver builds fine with COMPILE_TEST. Enable it for wider test coverage
    and easier maintenance.
    
    Signed-off-by: Wolfram Sang <wsa@kernel.org>
    Acked-by: Michal Simek <michal.simek@xilinx.com>
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit a7ef01d25a31b73890ee37d68c2858e96af64e5e
Author: Wolfram Sang <wsa@kernel.org>
Date:   Sat Feb 12 20:47:07 2022 +0100

    i2c: qup: allow COMPILE_TEST
    
    [ Upstream commit 5de717974005fcad2502281e9f82e139ca91f4bb ]
    
    Driver builds fine with COMPILE_TEST. Enable it for wider test coverage
    and easier maintenance.
    
    Signed-off-by: Wolfram Sang <wsa@kernel.org>
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit da9bf89344a678c8326b28ada0d604011ac5f6b6
Author: Wolfram Sang <wsa@kernel.org>
Date:   Sat Feb 12 20:45:48 2022 +0100

    i2c: cadence: allow COMPILE_TEST
    
    [ Upstream commit 0b0dcb3882c8f08bdeafa03adb4487e104d26050 ]
    
    Driver builds fine with COMPILE_TEST. Enable it for wider test coverage
    and easier maintenance.
    
    Signed-off-by: Wolfram Sang <wsa@kernel.org>
    Acked-by: Michal Simek <michal.simek@xilinx.com>
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit 2fc08382eaf502551ffae61ff5e48e062b30ecb6
Author: Wolfram Sang <wsa@kernel.org>
Date:   Sat Feb 12 20:47:07 2022 +0100

    i2c: qup: allow COMPILE_TEST
    
    [ Upstream commit 5de717974005fcad2502281e9f82e139ca91f4bb ]
    
    Driver builds fine with COMPILE_TEST. Enable it for wider test coverage
    and easier maintenance.
    
    Signed-off-by: Wolfram Sang <wsa@kernel.org>
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit 2ade8e36da84ab894592ee135f3734b78c714a8a
Author: Wolfram Sang <wsa@kernel.org>
Date:   Sat Feb 12 20:45:48 2022 +0100

    i2c: cadence: allow COMPILE_TEST
    
    [ Upstream commit 0b0dcb3882c8f08bdeafa03adb4487e104d26050 ]
    
    Driver builds fine with COMPILE_TEST. Enable it for wider test coverage
    and easier maintenance.
    
    Signed-off-by: Wolfram Sang <wsa@kernel.org>
    Acked-by: Michal Simek <michal.simek@xilinx.com>
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit b712c7514772c9e5f07279b6bdc2426b031c61ef
Author: Wolfram Sang <wsa@kernel.org>
Date:   Sat Feb 12 20:47:07 2022 +0100

    i2c: qup: allow COMPILE_TEST
    
    [ Upstream commit 5de717974005fcad2502281e9f82e139ca91f4bb ]
    
    Driver builds fine with COMPILE_TEST. Enable it for wider test coverage
    and easier maintenance.
    
    Signed-off-by: Wolfram Sang <wsa@kernel.org>
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit f44100d8feb618f5565e4358b880da78750ceeab
Author: Wolfram Sang <wsa@kernel.org>
Date:   Sat Feb 12 20:45:48 2022 +0100

    i2c: cadence: allow COMPILE_TEST
    
    [ Upstream commit 0b0dcb3882c8f08bdeafa03adb4487e104d26050 ]
    
    Driver builds fine with COMPILE_TEST. Enable it for wider test coverage
    and easier maintenance.
    
    Signed-off-by: Wolfram Sang <wsa@kernel.org>
    Acked-by: Michal Simek <michal.simek@xilinx.com>
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit 007050b46f6b6be4f311cf6e22e344b2a0860014
Author: Wolfram Sang <wsa@kernel.org>
Date:   Sat Feb 12 20:47:07 2022 +0100

    i2c: qup: allow COMPILE_TEST
    
    [ Upstream commit 5de717974005fcad2502281e9f82e139ca91f4bb ]
    
    Driver builds fine with COMPILE_TEST. Enable it for wider test coverage
    and easier maintenance.
    
    Signed-off-by: Wolfram Sang <wsa@kernel.org>
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit 6ed5dbba6c971fe644f5c2b4aae436b39da99f18
Author: Srinivas Kandagatla <srinivas.kandagatla@linaro.org>
Date:   Fri Mar 4 16:09:34 2022 +0000

    ASoC: qcom: select correct WCD938X config for SC7280
    
    SC7280 config selected WCD938X instead of WCD938X_SDW Soundwire codecs.
    WCD938X_SDW actually selects WCD938X, so directly selecting WCD938X results
    in unmet dependencies and below warning
    
    WARNING: unmet direct dependencies detected for SND_SOC_WCD938X
      Depends on [n]: SOUND [=y] && !UML && SND [=y] && SND_SOC [=m]
     && SND_SOC_WCD938X_SDW [=n] && (SOUNDWIRE [=n] || !SOUNDWIRE [=n])
      Selected by [m]:
      - SND_SOC_SC7280 [=m] && SOUND [=y] && !UML && SND [=y]
     && SND_SOC [=m] && SND_SOC_QCOM [=m] && (I2C [=y] && SOUNDWIRE [=n] ||
     COMPILE_TEST [=y])
    
    Fix this issue by selecting WCD SoundWire codecs instead of component driver.
    
    Fixes: 57350bd41c3a ("ASoC: qcom: SC7280: Add machine driver")
    Reported-by: Randy Dunlap <rdunlap@infradead.org>
    Signed-off-by: Srinivas Kandagatla <srinivas.kandagatla@linaro.org>
    Link: https://lore.kernel.org/r/20220304160934.32010-1-srinivas.kandagatla@linaro.org
    Signed-off-by: Mark Brown <broonie@kernel.org>

commit e6e1e7b19fa132d23d09c465942aab4c110d3da9
Author: Randy Dunlap <rdunlap@infradead.org>
Date:   Fri Mar 4 22:40:36 2022 -0800

    m68k: coldfire/device.c: only build for MCF_EDMA when h/w macros are defined
    
    When CONFIG_MCF_EDMA is set (due to COMPILE_TEST, not due to
    CONFIG_M5441x), coldfire/device.c has compile errors due to
    missing MCFEDMA_* symbols. In the .config file that was provided,
    CONFIG_M5206=y, not CONFIG_M5441x, so <asm/m5441xsim.h> is not
    included in coldfire/device.c.
    
    Only build the MCF_EDMA code in coldfire/device.c if the MCFEDMA_*
    hardware macros are defined.
    
    Fixes these build errors:
    
    ../arch/m68k/coldfire/device.c:512:35: error: 'MCFEDMA_BASE' undeclared here (not in a function); did you mean 'MCFDMA_BASE1'?
      512 |                 .start          = MCFEDMA_BASE,
    ../arch/m68k/coldfire/device.c:513:50: error: 'MCFEDMA_SIZE' undeclared here (not in a function)
      513 |                 .end            = MCFEDMA_BASE + MCFEDMA_SIZE - 1,
    ../arch/m68k/coldfire/device.c:517:35: error: 'MCFEDMA_IRQ_INTR0' undeclared here (not in a function)
      517 |                 .start          = MCFEDMA_IRQ_INTR0,
    ../arch/m68k/coldfire/device.c:523:35: error: 'MCFEDMA_IRQ_INTR16' undeclared here (not in a function)
      523 |                 .start          = MCFEDMA_IRQ_INTR16,
    ../arch/m68k/coldfire/device.c:529:35: error: 'MCFEDMA_IRQ_INTR56' undeclared here (not in a function)
      529 |                 .start          = MCFEDMA_IRQ_INTR56,
    ../arch/m68k/coldfire/device.c:535:35: error: 'MCFEDMA_IRQ_ERR' undeclared here (not in a function)
      535 |                 .start          = MCFEDMA_IRQ_ERR,
    
    Fixes: d7e9d01ac292 ("m68k: add ColdFire mcf5441x eDMA platform support")
    Signed-off-by: Randy Dunlap <rdunlap@infradead.org>
    Reported-by: kernel test robot <lkp@intel.com>
    Link: lore.kernel.org/r/202203030252.P752DK46-lkp@intel.com
    Cc: Angelo Dureghello <angelo@sysam.it>
    Cc: Greg Ungerer <gerg@kernel.org>
    Cc: Greg Ungerer <gerg@linux-m68k.org>
    Cc: Geert Uytterhoeven <geert@linux-m68k.org>
    Cc: linux-m68k@lists.linux-m68k.org
    Cc: uclinux-dev@uclinux.org
    Signed-off-by: Greg Ungerer <gerg@linux-m68k.org>

commit 1dba41c9d2e2dc94b543394974f63d55aa195bfe
Author: Alex Elder <elder@linaro.org>
Date:   Tue Mar 1 05:34:40 2022 -0600

    net: ipa: add an interconnect dependency
    
    In order to function, the IPA driver very clearly requires the
    interconnect framework to be enabled in the kernel configuration.
    State that dependency in the Kconfig file.
    
    This became a problem when CONFIG_COMPILE_TEST support was added.
    Non-Qualcomm platforms won't necessarily enable CONFIG_INTERCONNECT.
    
    Reported-by: kernel test robot <lkp@intel.com>
    Fixes: 38a4066f593c5 ("net: ipa: support COMPILE_TEST")
    Signed-off-by: Alex Elder <elder@linaro.org>
    Link: https://lore.kernel.org/r/20220301113440.257916-1-elder@linaro.org
    Signed-off-by: Jakub Kicinski <kuba@kernel.org>

commit 540e6a8114d012d09cf6d49ba5ea0b942a3988eb
Author: Greg Kroah-Hartman <gregkh@linuxfoundation.org>
Date:   Mon Feb 28 22:27:38 2022 +0100

    Revert "mfd: simple-mfd-i2c: Add Delta TN48M CPLD support"
    
    This reverts commit d0cac2434c8ecd4863e082d976f5db9405d14b80.  THe MFD
    maintainer has some remaining objections that need to be resolved before
    it can be accepted.
    
    Link: https://lore.kernel.org/r/20220228193928.3ec6ee98@canb.auug.org.au
    Reported-by: Lee Jones <lee.jones@linaro.org>
    Reported-by: Stephen Rothwell <sfr@canb.auug.org.au>
    Cc: Robert Marko <robert.marko@sartura.hr>
    Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>
    
    diff --git a/drivers/mfd/Kconfig b/drivers/mfd/Kconfig
    index ba0b3eb131f1..be1ad8ce54aa 100644
    --- a/drivers/mfd/Kconfig
    +++ b/drivers/mfd/Kconfig
    @@ -297,6 +297,17 @@ config MFD_ASIC3
              This driver supports the ASIC3 multifunction chip found on many
              PDAs (mainly iPAQ and HTC based ones)
    
    +config MFD_TN48M_CPLD
    +       tristate "Delta Networks TN48M switch CPLD driver"
    +       depends on I2C
    +       depends on ARCH_MVEBU || COMPILE_TEST
    +       select MFD_SIMPLE_MFD_I2C
    +       help
    +         Select this option to enable support for Delta Networks TN48M switch
    +         CPLD. It consists of reset and GPIO drivers. CPLD provides GPIOS-s
    +         for the SFP slots as well as power supply related information.
    +         SFP support depends on the GPIO driver being selected.
    +
     config PMIC_DA903X
            bool "Dialog Semiconductor DA9030/DA9034 PMIC Support"
            depends on I2C=y
    diff --git a/drivers/mfd/simple-mfd-i2c.c b/drivers/mfd/simple-mfd-i2c.c
    index 51536691ad9d..0d6a51ed6286 100644
    --- a/drivers/mfd/simple-mfd-i2c.c
    +++ b/drivers/mfd/simple-mfd-i2c.c
    @@ -64,6 +64,7 @@ static int simple_mfd_i2c_probe(struct i2c_client *i2c)
    
     static const struct of_device_id simple_mfd_i2c_of_match[] = {
            { .compatible = "kontron,sl28cpld" },
    +       { .compatible = "delta,tn48m-cpld" },
            {}
     };
     MODULE_DEVICE_TABLE(of, simple_mfd_i2c_of_match);

commit caef14b7530c065fb85d54492768fa48fdb5093e
Author: Alex Elder <elder@linaro.org>
Date:   Fri Feb 25 14:15:30 2022 -0600

    net: ipa: fix a build dependency
    
    An IPA build problem arose in the linux-next tree the other day.
    The problem is that a recent commit adds a new dependency on some
    code, and the Kconfig file for IPA doesn't reflect that dependency.
    As a result, some configurations can fail to build (particularly
    when COMPILE_TEST is enabled).
    
    The recent patch adds calls to qmp_get(), qmp_put(), and qmp_send(),
    and those are built based on the QCOM_AOSS_QMP config option.  If
    that symbol is not defined, stubs are defined, so we just need to
    ensure QCOM_AOSS_QMP is compatible with QCOM_IPA, or it's not
    defined.
    
    Reported-by: Randy Dunlap <rdunlap@infradead.org>
    Fixes: 34a081761e4e3 ("net: ipa: request IPA register values be retained")
    Signed-off-by: Alex Elder <elder@linaro.org>
    Tested-by: Randy Dunlap <rdunlap@infradead.org>
    Acked-by: Randy Dunlap <rdunlap@infradead.org>
    Signed-off-by: David S. Miller <davem@davemloft.net>

commit b83eb8be4f2ca9d6beb1a8b66f666ef7039b7a64
Author: Mark Brown <broonie@kernel.org>
Date:   Wed Feb 23 01:19:12 2022 +0000

    ASoC: sc7280: Really depends on SOUNDWIRE
    
    The sc7280 driver really does depend on SOUNDWIRE since it calls various
    sdw_ functions (eg, sdw_enable_stream(), sdw_prepare_stream()) which do
    not have stubs when that is disabled so we can't build with COMPILE_TEST.
    
    Signed-off-by: Mark Brown <broonie@kernel.org>
    Link: https://lore.kernel.org/r/20220223011913.2753938-1-broonie@kernel.org
    Signed-off-by: Mark Brown <broonie@kernel.org>

commit dacec3e7b9bc59275b4c41319a9a52b0a1cacfa9
Merge: 961af9dbe5d0 2428766e2015
Author: Linus Torvalds <torvalds@linux-foundation.org>
Date:   Sun Feb 20 11:23:48 2022 -0800

    Merge branch 'i2c/for-current' of git://git.kernel.org/pub/scm/linux/kernel/git/wsa/linux
    
    Pull i2c fixes from Wolfram Sang:
     "Some driver updates, a MAINTAINERS fix, and additions to COMPILE_TEST
      (so we won't miss build problems again)"
    
    * 'i2c/for-current' of git://git.kernel.org/pub/scm/linux/kernel/git/wsa/linux:
      MAINTAINERS: remove duplicate entry for i2c-qcom-geni
      i2c: brcmstb: fix support for DSL and CM variants
      i2c: qup: allow COMPILE_TEST
      i2c: imx: allow COMPILE_TEST
      i2c: cadence: allow COMPILE_TEST
      i2c: qcom-cci: don't put a device tree node before i2c_add_adapter()
      i2c: qcom-cci: don't delete an unregistered adapter
      i2c: bcm2835: Avoid clock stretching timeouts

commit 5de717974005fcad2502281e9f82e139ca91f4bb
Author: Wolfram Sang <wsa@kernel.org>
Date:   Sat Feb 12 20:47:07 2022 +0100

    i2c: qup: allow COMPILE_TEST
    
    Driver builds fine with COMPILE_TEST. Enable it for wider test coverage
    and easier maintenance.
    
    Signed-off-by: Wolfram Sang <wsa@kernel.org>

commit 2ce4462f2724d1b3cedccea441c6d18bb360629a
Author: Wolfram Sang <wsa@kernel.org>
Date:   Sat Feb 12 20:46:57 2022 +0100

    i2c: imx: allow COMPILE_TEST
    
    Driver builds fine with COMPILE_TEST. Enable it for wider test coverage
    and easier maintenance.
    
    Signed-off-by: Wolfram Sang <wsa@kernel.org>
    Acked-by: Oleksij Rempel <o.rempel@pengutronix.de>

commit 0b0dcb3882c8f08bdeafa03adb4487e104d26050
Author: Wolfram Sang <wsa@kernel.org>
Date:   Sat Feb 12 20:45:48 2022 +0100

    i2c: cadence: allow COMPILE_TEST
    
    Driver builds fine with COMPILE_TEST. Enable it for wider test coverage
    and easier maintenance.
    
    Signed-off-by: Wolfram Sang <wsa@kernel.org>
    Acked-by: Michal Simek <michal.simek@xilinx.com>

commit 04b27e538d509f4b8947343bdf6b1421dc721f14
Author: Sreekanth Reddy <sreekanth.reddy@broadcom.com>
Date:   Thu Feb 10 15:28:11 2022 +0530

    scsi: mpi3mr: Update MPI3 headers
    
    Update MPI3 headers.
    
    Link: https://lore.kernel.org/r/20220210095817.22828-4-sreekanth.reddy@broadcom.com
    Signed-off-by: Sreekanth Reddy <sreekanth.reddy@broadcom.com>
    Signed-off-by: Martin K. Petersen <martin.petersen@oracle.com>

commit c95aa2bab974394809edea28690f6504a15791b6
Author: Randy Dunlap <rdunlap@infradead.org>
Date:   Tue Feb 8 16:15:46 2022 -0800

    thermal: intel: hfi: INTEL_HFI_THERMAL depends on NET
    
    THERMAL_NETLINK depends on NET and since 'select' does not follow
    any dependency chain, INTEL_HFI_THERMAL also should depend on NET.
    
    Fix one Kconfig warning and 48 subsequent build errors:
    
    WARNING: unmet direct dependencies detected for THERMAL_NETLINK
      Depends on [n]: THERMAL [=y] && NET [=n]
      Selected by [y]:
      - INTEL_HFI_THERMAL [=y] && THERMAL [=y] && (X86 [=y] || X86_INTEL_QUARK [=n] || COMPILE_TEST [=y]) && CPU_SUP_INTEL [=y] && X86_THERMAL_VECTOR [=y]
    
    Fixes: bd30cdfd9bd7 ("thermal: intel: hfi: Notify user space for HFI events")
    Signed-off-by: Randy Dunlap <rdunlap@infradead.org>
    Reviewed-by: Srinivas Pandruvada <srinivas.pandruvada@linux.intel.com>
    Signed-off-by: Rafael J. Wysocki <rafael.j.wysocki@intel.com>

commit af6ca20591efce42535e1c870b7ae6eae98df1b3
Author: Jakub Kicinski <kuba@kernel.org>
Date:   Wed Feb 9 16:36:49 2022 -0800

    selftests: net: test standard socket cmsgs across UDP and ICMP sockets
    
    Test TIMESTAMPING and TXTIME across UDP / ICMP and IP versions.
    
    Before ICMPv6 support:
      # ./tools/testing/selftests/net/cmsg_time.sh
        Case ICMPv6  - ts cnt returned '0', expected '2'
        Case ICMPv6  - ts0 SCHED returned '', expected 'OK'
        Case ICMPv6  - ts0 SND returned '', expected 'OK'
        Case ICMPv6  - TXTIME abs returned '', expected 'OK'
        Case ICMPv6  - TXTIME rel returned '', expected 'OK'
      FAIL - 5/36 cases failed
    
    After:
      # ./tools/testing/selftests/net/cmsg_time.sh
      OK
    
    Signed-off-by: Jakub Kicinski <kuba@kernel.org>
    Signed-off-by: David S. Miller <davem@davemloft.net>

commit 3ebb0b1032e55614672af10c491302018bf34fd4
Author: Jakub Kicinski <kuba@kernel.org>
Date:   Wed Feb 9 16:36:41 2022 -0800

    net: ping6: support setting socket options via cmsg
    
    Minor reordering of the code and a call to sock_cmsg_send()
    gives us support for setting the common socket options via
    cmsg (the usual ones - SO_MARK, SO_TIMESTAMPING_OLD, SCM_TXTIME).
    
    Signed-off-by: Jakub Kicinski <kuba@kernel.org>
    Reviewed-by: David Ahern <dsahern@kernel.org>
    Signed-off-by: David S. Miller <davem@davemloft.net>

commit 66ada2907864cafa4578b92926cb8bc0a4bc8c9c
Author: Christophe Leroy <christophe.leroy@csgroup.eu>
Date:   Fri Sep 3 11:18:43 2021 +0000

    powerpc/corenet: Change criteria to set MPIC_ENABLE_COREINT
    
    Don't use ppc_md function comparison.
    
    Signed-off-by: Christophe Leroy <christophe.leroy@csgroup.eu>
    Signed-off-by: Michael Ellerman <mpe@ellerman.id.au>
    Link: https://lore.kernel.org/r/c8ef82ee5f2713f4c36eb5d2d49b0905c7472801.1630667612.git.christophe.leroy@csgroup.eu

commit f154066b61dfde618d98fdafc8cadde076c7f222
Author: Kees Cook <keescook@chromium.org>
Date:   Sun Feb 6 09:20:08 2022 -0800

    gcc-plugins/stackleak: Provide verbose mode
    
    In order to compare instrumentation between builds, make the verbose
    mode of the plugin available during the build. This is rarely needed
    (behind EXPERT) and very noisy (disabled for COMPILE_TEST).
    
    Cc: Alexander Popov <alex.popov@linux.com>
    Signed-off-by: Kees Cook <keescook@chromium.org>

commit b7892f7d5cb2b8187c603dd8ea3a7c44059ccfc2
Author: Jean-Philippe Brucker <jean-philippe@linaro.org>
Date:   Tue Feb 1 09:31:20 2022 +0000

    tools: Ignore errors from `which' when searching a GCC toolchain
    
    When cross-building tools with clang, we run `which $(CROSS_COMPILE)gcc`
    to detect whether a GCC toolchain provides the standard libraries. It is
    only a helper because some distros put libraries where LLVM does not
    automatically find them. On other systems, LLVM detects the libc
    automatically and does not need this. There, it is completely fine not
    to have a GCC at all, but some versions of `which' display an error when
    the command is not found:
    
      which: no aarch64-linux-gnu-gcc in ($PATH)
    
    Since the error can safely be ignored, throw it to /dev/null.
    
    Fixes: cebdb7374577 ("tools: Help cross-building with clang")
    Reported-by: Nathan Chancellor <nathan@kernel.org>
    Signed-off-by: Jean-Philippe Brucker <jean-philippe@linaro.org>
    Signed-off-by: Daniel Borkmann <daniel@iogearbox.net>
    Tested-by: Nathan Chancellor <nathan@kernel.org>
    Reviewed-by: Nathan Chancellor <nathan@kernel.org>
    Link: https://lore.kernel.org/bpf/20220201093119.1713207-1-jean-philippe@linaro.org

commit 0b59bc00a6936e8670b58d4307a2cfba341d40d0
Author: Krzysztof Kozlowski <krzysztof.kozlowski@canonical.com>
Date:   Sat Jan 29 18:34:07 2022 +0100

    clk: samsung: fix missing Tesla FSD dependency on Exynos
    
    The Tesla FSD clock controller driver uses shared parts from Exynos
    ARM64 clock drivers, so add proper dependency to fix COMPILE_TEST build
    errors like:
    
      /usr/bin/aarch64-linux-gnu-ld: drivers/clk/samsung/clk-fsd.o: in function `fsd_cmu_probe':
      clk-fsd.c:(.init.text+0x9c): undefined reference to `exynos_arm64_register_cmu'
    
    Reported-by: kernel test robot <lkp@intel.com>
    Fixes: e3f3dc3810d3 ("clk: samsung: fsd: Add cmu_peric block clock information")
    Signed-off-by: Krzysztof Kozlowski <krzysztof.kozlowski@canonical.com>
    Reviewed-by: Alim Akhtar <alim.akhtar@samsung.com>
    Link: https://lore.kernel.org/r/20220129173407.278591-1-krzysztof.kozlowski@canonical.com

commit 678dfd5280341d877ca646499bfdc82a3d8b4356
Author: Gerhard Engleder <gerhard@engleder-embedded.com>
Date:   Sun Jan 30 10:54:22 2022 +0100

    selftests/net: timestamping: Fix bind_phc check
    
    timestamping checks socket options during initialisation. For the field
    bind_phc of the socket option SO_TIMESTAMPING it expects the value -1 if
    PHC is not bound. Actually the value of bind_phc is 0 if PHC is not
    bound. This results in the following output:
    
    SIOCSHWTSTAMP: tx_type 0 requested, got 0; rx_filter 0 requested, got 0
    SO_TIMESTAMP 0
    SO_TIMESTAMPNS 0
    SO_TIMESTAMPING flags 0, bind phc 0
       not expected, flags 0, bind phc -1
    
    This is fixed by setting default value and expected value of bind_phc to
    0.
    
    Fixes: 2214d7032479 ("selftests/net: timestamping: support binding PHC")
    Signed-off-by: Gerhard Engleder <gerhard@engleder-embedded.com>
    Signed-off-by: David S. Miller <davem@davemloft.net>

commit 567e44fb51b4f909ae58038a7301352eecea8426
Author: YueHaibing <yuehaibing@huawei.com>
Date:   Thu Dec 9 17:01:13 2021 +0800

    video: fbdev: controlfb: Fix COMPILE_TEST build
    
    If PPC_BOOK3S, PPC_PMAC and PPC32 is n, COMPILE_TEST build fails:
    
    drivers/video/fbdev/controlfb.c:70:0: error: "pgprot_cached_wthru" redefined [-Werror]
     #define pgprot_cached_wthru(prot) (prot)
    
    In file included from ./arch/powerpc/include/asm/pgtable.h:20:0,
                     from ./include/linux/pgtable.h:6,
                     from ./include/linux/mm.h:33,
                     from drivers/video/fbdev/controlfb.c:37:
    ./arch/powerpc/include/asm/nohash/pgtable.h:243:0: note: this is the location of the previous definition
     #define pgprot_cached_wthru(prot) (__pgprot((pgprot_val(prot) & ~_PAGE_CACHE_CTL) | \
    
    Fixes: a07a63b0e24d ("video: fbdev: controlfb: add COMPILE_TEST support")
    Signed-off-by: YueHaibing <yuehaibing@huawei.com>
    Signed-off-by: Helge Deller <deller@gmx.de>

commit a0f25a6bb319aa05e04dcf51707c97c2881b4f47
Author: Javier Martinez Canillas <javierm@redhat.com>
Date:   Thu Dec 16 22:09:36 2021 +0100

    drm/hisilicon/hibmc: Allow to be built if COMPILE_TEST is enabled
    
    The commit feeb07d0ca5a ("drm/hisilicon/hibmc: Make CONFIG_DRM_HISI_HIBMC
    depend on ARM64") made the driver Kconfig symbol to depend on ARM64 since
    it only supports that architecture and loading the module on others would
    lead to incorrect video modes being used.
    
    But it also prevented the driver to be built on other architectures which
    is useful to have compile test coverage when doing subsystem wide changes.
    
    Make the dependency instead to be (ARM64 || COMPILE_TEST), so the driver
    is buildable when the CONFIG_COMPILE_TEST option is enabled.
    
    Signed-off-by: Javier Martinez Canillas <javierm@redhat.com>
    Acked-by: Thomas Zimmermann <tzimmermann@suse.de>
    Link: https://patchwork.freedesktop.org/patch/msgid/20211216210936.3329977-1-javierm@redhat.com

commit bd0f4a3eea2c856507fdd9003bcbe826affe3007
Author: Miroslav Lichvar <mlichvar@redhat.com>
Date:   Tue Jan 11 16:10:53 2022 +0100

    net: fix sock_timestamping_bind_phc() to release device
    
    commit 2a4d75bfe41232608f5596a6d1369f92ccb20817 upstream.
    
    Don't forget to release the device in sock_timestamping_bind_phc() after
    it was used to get the vclock indices.
    
    Fixes: d463126e23f1 ("net: sock: extend SO_TIMESTAMPING for PHC binding")
    Signed-off-by: Miroslav Lichvar <mlichvar@redhat.com>
    Cc: Yangbo Lu <yangbo.lu@nxp.com>
    Signed-off-by: David S. Miller <davem@davemloft.net>
    Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>

commit f23826a62d392bc133fa46a1fb6655e5ac8270cb
Author: Zizhuang Deng <sunsetdzz@gmail.com>
Date:   Thu Dec 30 15:03:31 2021 +0800

    lib/mpi: Add the return value check of kcalloc()
    
    [ Upstream commit dd827abe296fe4249b2f8c9b95f72f814ea8348c ]
    
    Add the return value check of kcalloc() to avoid potential
    NULL ptr dereference.
    
    Fixes: a8ea8bdd9df9 ("lib/mpi: Extend the MPI library")
    Signed-off-by: Zizhuang Deng <sunsetdzz@gmail.com>
    Reviewed-by: Tianjia Zhang <tianjia.zhang@linux.alibaba.com>
    Signed-off-by: Herbert Xu <herbert@gondor.apana.org.au>
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit 675bc9e8329de0f1c76d0b66358b1ba2cb5c6afd
Author: Miroslav Lichvar <mlichvar@redhat.com>
Date:   Wed Jan 5 11:33:26 2022 +0100

    net: fix SOF_TIMESTAMPING_BIND_PHC to work with multiple sockets
    
    [ Upstream commit 007747a984ea5e895b7d8b056b24ebf431e1e71d ]
    
    When multiple sockets using the SOF_TIMESTAMPING_BIND_PHC flag received
    a packet with a hardware timestamp (e.g. multiple PTP instances in
    different PTP domains using the UDPv4/v6 multicast or L2 transport),
    the timestamps received on some sockets were corrupted due to repeated
    conversion of the same timestamp (by the same or different vclocks).
    
    Fix ptp_convert_timestamp() to not modify the shared skb timestamp
    and return the converted timestamp as a ktime_t instead. If the
    conversion fails, return 0 to not confuse the application with
    timestamps corresponding to an unexpected PHC.
    
    Fixes: d7c088265588 ("net: socket: support hardware timestamp conversion to PHC bound")
    Signed-off-by: Miroslav Lichvar <mlichvar@redhat.com>
    Cc: Yangbo Lu <yangbo.lu@nxp.com>
    Cc: Richard Cochran <richardcochran@gmail.com>
    Acked-by: Richard Cochran <richardcochran@gmail.com>
    Signed-off-by: David S. Miller <davem@davemloft.net>
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit 62009fa50c1a70a291f8f72a66b08449a03ea50e
Author: Miroslav Lichvar <mlichvar@redhat.com>
Date:   Tue Jan 11 16:10:53 2022 +0100

    net: fix sock_timestamping_bind_phc() to release device
    
    commit 2a4d75bfe41232608f5596a6d1369f92ccb20817 upstream.
    
    Don't forget to release the device in sock_timestamping_bind_phc() after
    it was used to get the vclock indices.
    
    Fixes: d463126e23f1 ("net: sock: extend SO_TIMESTAMPING for PHC binding")
    Signed-off-by: Miroslav Lichvar <mlichvar@redhat.com>
    Cc: Yangbo Lu <yangbo.lu@nxp.com>
    Signed-off-by: David S. Miller <davem@davemloft.net>
    Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>

commit b918c668d2954461eeaa8f2409e61bca92dcb324
Author: Zizhuang Deng <sunsetdzz@gmail.com>
Date:   Thu Dec 30 15:03:31 2021 +0800

    lib/mpi: Add the return value check of kcalloc()
    
    [ Upstream commit dd827abe296fe4249b2f8c9b95f72f814ea8348c ]
    
    Add the return value check of kcalloc() to avoid potential
    NULL ptr dereference.
    
    Fixes: a8ea8bdd9df9 ("lib/mpi: Extend the MPI library")
    Signed-off-by: Zizhuang Deng <sunsetdzz@gmail.com>
    Reviewed-by: Tianjia Zhang <tianjia.zhang@linux.alibaba.com>
    Signed-off-by: Herbert Xu <herbert@gondor.apana.org.au>
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit ff53c861e97e89a19c1643b3e104d737eb02568d
Author: Miroslav Lichvar <mlichvar@redhat.com>
Date:   Wed Jan 5 11:33:26 2022 +0100

    net: fix SOF_TIMESTAMPING_BIND_PHC to work with multiple sockets
    
    [ Upstream commit 007747a984ea5e895b7d8b056b24ebf431e1e71d ]
    
    When multiple sockets using the SOF_TIMESTAMPING_BIND_PHC flag received
    a packet with a hardware timestamp (e.g. multiple PTP instances in
    different PTP domains using the UDPv4/v6 multicast or L2 transport),
    the timestamps received on some sockets were corrupted due to repeated
    conversion of the same timestamp (by the same or different vclocks).
    
    Fix ptp_convert_timestamp() to not modify the shared skb timestamp
    and return the converted timestamp as a ktime_t instead. If the
    conversion fails, return 0 to not confuse the application with
    timestamps corresponding to an unexpected PHC.
    
    Fixes: d7c088265588 ("net: socket: support hardware timestamp conversion to PHC bound")
    Signed-off-by: Miroslav Lichvar <mlichvar@redhat.com>
    Cc: Yangbo Lu <yangbo.lu@nxp.com>
    Cc: Richard Cochran <richardcochran@gmail.com>
    Acked-by: Richard Cochran <richardcochran@gmail.com>
    Signed-off-by: David S. Miller <davem@davemloft.net>
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit 9defd7d4c084091f8186361574fe6415cb13bbed
Author: Zizhuang Deng <sunsetdzz@gmail.com>
Date:   Thu Dec 30 15:03:31 2021 +0800

    lib/mpi: Add the return value check of kcalloc()
    
    [ Upstream commit dd827abe296fe4249b2f8c9b95f72f814ea8348c ]
    
    Add the return value check of kcalloc() to avoid potential
    NULL ptr dereference.
    
    Fixes: a8ea8bdd9df9 ("lib/mpi: Extend the MPI library")
    Signed-off-by: Zizhuang Deng <sunsetdzz@gmail.com>
    Reviewed-by: Tianjia Zhang <tianjia.zhang@linux.alibaba.com>
    Signed-off-by: Herbert Xu <herbert@gondor.apana.org.au>
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit d6905849f87596f94c2778c8337697df486de43c
Author: Ard Biesheuvel <ardb@kernel.org>
Date:   Mon Jan 24 19:16:58 2022 +0100

    ARM: assembler: define a Kconfig symbol for group relocation support
    
    Nathan reports the group relocations go out of range in pathological
    cases such as allyesconfig kernels, which have little chance of actually
    booting but are still used in validation.
    
    So add a Kconfig symbol for this feature, and make it depend on
    !COMPILE_TEST.
    
    Signed-off-by: Ard Biesheuvel <ardb@kernel.org>

commit d0a231f01e5b25bacd23e6edc7c979a18a517b2b
Merge: 88db8458086b 87c71931633b
Author: Linus Torvalds <torvalds@linux-foundation.org>
Date:   Sun Jan 16 08:08:11 2022 +0200

    Merge tag 'pci-v5.17-changes' of git://git.kernel.org/pub/scm/linux/kernel/git/helgaas/pci
    
    Pull pci updates from Bjorn Helgaas:
     "Enumeration:
       - Use pci_find_vsec_capability() instead of open-coding it (Andy
         Shevchenko)
       - Convert pci_dev_present() stub from macro to static inline to avoid
         'unused variable' errors (Hans de Goede)
       - Convert sysfs slot attributes from default_attrs to default_groups
         (Greg Kroah-Hartman)
       - Use DWORD accesses for LTR, L1 SS to avoid BayHub OZ711LV2 erratum
         (Rajat Jain)
       - Remove unnecessary initialization of static variables (Longji Guo)
    
      Resource management:
       - Always write Intel I210 ROM BAR on update to work around device
         defect (Bjorn Helgaas)
    
      PCIe native device hotplug:
       - Fix pciehp lockdep errors on Thunderbolt undock (Hans de Goede)
       - Fix infinite loop in pciehp IRQ handler on power fault (Lukas
         Wunner)
    
      Power management:
       - Convert amd64-agp, sis-agp, via-agp from legacy PCI power
         management to generic power management (Vaibhav Gupta)
    
      IOMMU:
       - Add function 1 DMA alias quirk for Marvell 88SE9125 SATA controller
         so it can work with an IOMMU (Yifeng Li)
    
      Error handling:
       - Add PCI_ERROR_RESPONSE and related definitions for signaling and
         checking for transaction errors on PCI (Naveen Naidu)
       - Fabricate PCI_ERROR_RESPONSE data (~0) in config read wrappers,
         instead of in host controller drivers, when transactions fail on
         PCI (Naveen Naidu)
       - Use PCI_POSSIBLE_ERROR() to check for possible failure of config
         reads (Naveen Naidu)
    
      Peer-to-peer DMA:
       - Add Logan Gunthorpe as P2PDMA maintainer (Bjorn Helgaas)
    
      ASPM:
       - Calculate link L0s and L1 exit latencies when needed instead of
         caching them (Saheed O. Bolarinwa)
       - Calculate device L0s and L1 acceptable exit latencies when needed
         instead of caching them (Saheed O. Bolarinwa)
       - Remove struct aspm_latency since it's no longer needed (Saheed O.
         Bolarinwa)
    
      APM X-Gene PCIe controller driver:
       - Fix IB window setup, which was broken by the fact that IB resources
         are now sorted in address order instead of DT dma-ranges order (Rob
         Herring)
    
      Apple PCIe controller driver:
       - Enable clock gating to save power (Hector Martin)
       - Fix REFCLK1 enable/poll logic (Hector Martin)
    
      Broadcom STB PCIe controller driver:
       - Declare bitmap correctly for use by bitmap interfaces (Christophe
         JAILLET)
       - Clean up computation of legacy and non-legacy MSI bitmasks (Florian
         Fainelli)
       - Update suspend/resume/remove error handling to warn about errors
         and not fail the operation (Jim Quinlan)
       - Correct the "pcie" and "msi" interrupt descriptions in DT binding
         (Jim Quinlan)
       - Add DT bindings for endpoint voltage regulators (Jim Quinlan)
       - Split brcm_pcie_setup() into two functions (Jim Quinlan)
       - Add mechanism for turning on voltage regulators for connected
         devices (Jim Quinlan)
       - Turn voltage regulators for connected devices on/off when bus is
         added or removed (Jim Quinlan)
       - When suspending, don't turn off voltage regulators for wakeup
         devices (Jim Quinlan)
    
      Freescale i.MX6 PCIe controller driver:
       - Add i.MX8MM support (Richard Zhu)
    
      Freescale Layerscape PCIe controller driver:
       - Use DWC common ops instead of layerscape-specific link-up functions
         (Hou Zhiqiang)
    
      Intel VMD host bridge driver:
       - Honor platform ACPI _OSC feature negotiation for Root Ports below
         VMD (Kai-Heng Feng)
       - Add support for Raptor Lake SKUs (Karthik L Gopalakrishnan)
       - Reset everything below VMD before enumerating to work around
         failure to enumerate NVMe devices when guest OS reboots (Nirmal
         Patel)
    
      Bridge emulation (used by Marvell Aardvark and MVEBU):
       - Make emulated ROM BAR read-only by default (Pali Rohr)
       - Make some emulated legacy PCI bits read-only for PCIe devices (Pali
         Rohr)
       - Update reserved bits in emulated PCIe Capability (Pali Rohr)
       - Allow drivers to emulate different PCIe Capability versions (Pali
         Rohr)
       - Set emulated Capabilities List bit for all PCIe devices, since they
         must have at least a PCIe Capability (Pali Rohr)
    
      Marvell Aardvark PCIe controller driver:
       - Add bridge emulation definitions for PCIe DEVCAP2, DEVCTL2,
         DEVSTA2, LNKCAP2, LNKCTL2, LNKSTA2, SLTCAP2, SLTCTL2, SLTSTA2 (Pali
         Rohr)
       - Add aardvark support for DEVCAP2, DEVCTL2, LNKCAP2 and LNKCTL2
         registers (Pali Rohr)
       - Clear all MSIs at setup to avoid spurious interrupts (Pali Rohr)
       - Disable bus mastering when unbinding host controller driver (Pali
         Rohr)
       - Mask all interrupts when unbinding host controller driver (Pali
         Rohr)
       - Fix memory leak in host controller unbind (Pali Rohr)
       - Assert PERST# when unbinding host controller driver (Pali Rohr)
       - Disable link training when unbinding host controller driver (Pali
         Rohr)
       - Disable common PHY when unbinding host controller driver (Pali
         Rohr)
       - Fix resource type checking to check only IORESOURCE_MEM, not
         IORESOURCE_MEM_64, which is a flavor of IORESOURCE_MEM (Pali Rohr)
    
      Marvell MVEBU PCIe controller driver:
       - Implement pci_remap_iospace() for ARM so mvebu can use
         devm_pci_remap_iospace() instead of the previous ARM-specific
         pci_ioremap_io() interface (Pali Rohr)
       - Use the standard pci_host_probe() instead of the device-specific
         mvebu_pci_host_probe() (Pali Rohr)
       - Replace all uses of ARM-specific pci_ioremap_io() with the ARM
         implementation of the standard pci_remap_iospace() interface and
         remove pci_ioremap_io() (Pali Rohr)
       - Skip initializing invalid Root Ports (Pali Rohr)
       - Check for errors from pci_bridge_emul_init() (Pali Rohr)
       - Ignore any bridges at non-zero function numbers (Pali Rohr)
       - Return ~0 data for invalid config read size (Pali Rohr)
       - Disallow mapping interrupts on emulated bridges (Pali Rohr)
       - Clear Root Port Memory & I/O Space Enable and Bus Master Enable at
         initialization (Pali Rohr)
       - Make type bits in Root Port I/O Base register read-only (Pali
         Rohr)
       - Disable Root Port windows when base/limit set to invalid values
         (Pali Rohr)
       - Set controller to Root Complex mode (Pali Rohr)
       - Set Root Port Class Code to PCI Bridge (Pali Rohr)
       - Update emulated Root Port secondary bus numbers to better reflect
         the actual topology (Pali Rohr)
       - Add PCI_BRIDGE_CTL_BUS_RESET support to emulated Root Ports so
         pci_reset_secondary_bus() can reset connected devices (Pali Rohr)
       - Add PCI_EXP_DEVCTL Error Reporting Enable support to emulated Root
         Ports (Pali Rohr)
       - Add PCI_EXP_RTSTA PME Status bit support to emulated Root Ports
         (Pali Rohr)
       - Add DEVCAP2, DEVCTL2 and LNKCTL2 support to emulated Root Ports on
         Armada XP and newer devices (Pali Rohr)
       - Export mvebu-mbus.c symbols to allow pci-mvebu.c to be a module
         (Pali Rohr)
       - Add support for compiling as a module (Pali Rohr)
    
      MediaTek PCIe controller driver:
       - Assert PERST# for 100ms to allow power and clock to stabilize
         (qizhong cheng)
    
      MediaTek PCIe Gen3 controller driver:
       - Disable Mediatek DVFSRC voltage request since lack of DVFSRC to
         respond to the request causes failure to exit L1 PM Substate
         (Jianjun Wang)
    
      MediaTek MT7621 PCIe controller driver:
       - Declare mt7621_pci_ops static (Sergio Paracuellos)
       - Give pcibios_root_bridge_prepare() access to host bridge windows
         (Sergio Paracuellos)
       - Move MIPS I/O coherency unit setup from driver to
         pcibios_root_bridge_prepare() (Sergio Paracuellos)
       - Add missing MODULE_LICENSE() (Sergio Paracuellos)
       - Allow COMPILE_TEST for all arches (Sergio Paracuellos)
    
      Microsoft Hyper-V host bridge driver:
       - Add hv-internal interfaces to encapsulate arch IRQ dependencies
         (Sunil Muthuswamy)
       - Add arm64 Hyper-V vPCI support (Sunil Muthuswamy)
    
      Qualcomm PCIe controller driver:
       - Undo PM setup in qcom_pcie_probe() error handling path (Christophe
         JAILLET)
       - Use __be16 type to store return value from cpu_to_be16()
         (Manivannan Sadhasivam)
       - Constify static dw_pcie_ep_ops (Rikard Falkeborn)
    
      Renesas R-Car PCIe controller driver:
       - Fix aarch32 abort handler so it doesn't check the wrong bus clock
         before accessing the host controller (Marek Vasut)
    
      TI Keystone PCIe controller driver:
       - Add register offset for ti,syscon-pcie-id and ti,syscon-pcie-mode
         DT properties (Kishon Vijay Abraham I)
    
      MicroSemi Switchtec management driver:
       - Add Gen4 automotive device IDs (Kelvin Cao)
       - Declare state_names[] as static so it's not allocated and
         initialized for every call (Kelvin Cao)
    
      Host controller driver cleanups:
       - Use of_device_get_match_data(), not of_match_device(), when we only
         need the device data in altera, artpec6, cadence, designware-plat,
         dra7xx, keystone, kirin (Fan Fei)
       - Drop pointless of_device_get_match_data() cast in j721e (Bjorn
         Helgaas)
       - Drop redundant struct device * from j721e since struct cdns_pcie
         already has one (Bjorn Helgaas)
       - Rename driver structs to *_pcie in intel-gw, iproc, ls-gen4,
         mediatek-gen3, microchip, mt7621, rcar-gen2, tegra194, uniphier,
         xgene, xilinx, xilinx-cpm for consistency across drivers (Fan Fei)
       - Fix invalid address space conversions in hisi, spear13xx (Bjorn
         Helgaas)
    
      Miscellaneous:
       - Sort Intel Device IDs by value (Andy Shevchenko)
       - Change Capability offsets to hex to match spec (Baruch Siach)
       - Correct misspellings (Krzysztof Wilczyski)
       - Terminate statement with semicolon in pci_endpoint_test.c (Ming
         Wang)"
    
    * tag 'pci-v5.17-changes' of git://git.kernel.org/pub/scm/linux/kernel/git/helgaas/pci: (151 commits)
      PCI: mt7621: Allow COMPILE_TEST for all arches
      PCI: mt7621: Add missing MODULE_LICENSE()
      PCI: mt7621: Move MIPS setup to pcibios_root_bridge_prepare()
      PCI: Let pcibios_root_bridge_prepare() access bridge->windows
      PCI: mt7621: Declare mt7621_pci_ops static
      PCI: brcmstb: Do not turn off WOL regulators on suspend
      PCI: brcmstb: Add control of subdevice voltage regulators
      PCI: brcmstb: Add mechanism to turn on subdev regulators
      PCI: brcmstb: Split brcm_pcie_setup() into two funcs
      dt-bindings: PCI: Add bindings for Brcmstb EP voltage regulators
      dt-bindings: PCI: Correct brcmstb interrupts, interrupt-map.
      PCI: brcmstb: Fix function return value handling
      PCI: brcmstb: Do not use __GENMASK
      PCI: brcmstb: Declare 'used' as bitmap, not unsigned long
      PCI: hv: Add arm64 Hyper-V vPCI support
      PCI: hv: Make the code arch neutral by adding arch specific interfaces
      PCI: pciehp: Use down_read/write_nested(reset_lock) to fix lockdep errors
      x86/PCI: Remove initialization of static variables to false
      PCI: Use DWORD accesses for LTR, L1 SS to avoid erratum
      misc: pci_endpoint_test: Terminate statement with semicolon
      ...

commit e1a7aa25ff45636a6c1930bf2430c8b802e93d9c
Merge: fb3b0673b7d5 c77b1f8a8fae
Author: Linus Torvalds <torvalds@linux-foundation.org>
Date:   Fri Jan 14 14:37:34 2022 +0100

    Merge tag 'scsi-misc' of git://git.kernel.org/pub/scm/linux/kernel/git/jejb/scsi
    
    Pull SCSI updates from James Bottomley:
     "This series consists of the usual driver updates (ufs, pm80xx, lpfc,
      mpi3mr, mpt3sas, hisi_sas, libsas) and minor updates and bug fixes.
    
      The most impactful change is likely the switch from GFP_DMA to
      GFP_KERNEL in a bunch of drivers, but even that shouldn't affect too
      many people"
    
    * tag 'scsi-misc' of git://git.kernel.org/pub/scm/linux/kernel/git/jejb/scsi: (121 commits)
      scsi: mpi3mr: Bump driver version to 8.0.0.61.0
      scsi: mpi3mr: Fixes around reply request queues
      scsi: mpi3mr: Enhanced Task Management Support Reply handling
      scsi: mpi3mr: Use TM response codes from MPI3 headers
      scsi: mpi3mr: Add io_uring interface support in I/O-polled mode
      scsi: mpi3mr: Print cable mngnt and temp threshold events
      scsi: mpi3mr: Support Prepare for Reset event
      scsi: mpi3mr: Add Event acknowledgment logic
      scsi: mpi3mr: Gracefully handle online FW update operation
      scsi: mpi3mr: Detect async reset that occurred in firmware
      scsi: mpi3mr: Add IOC reinit function
      scsi: mpi3mr: Handle offline FW activation in graceful manner
      scsi: mpi3mr: Code refactor of IOC init - part2
      scsi: mpi3mr: Code refactor of IOC init - part1
      scsi: mpi3mr: Fault IOC when internal command gets timeout
      scsi: mpi3mr: Display IOC firmware package version
      scsi: mpi3mr: Handle unaligned PLL in unmap cmnds
      scsi: mpi3mr: Increase internal cmnds timeout to 60s
      scsi: mpi3mr: Do access status validation before adding devices
      scsi: mpi3mr: Add support for PCIe Managed Switch SES device
      ...

commit b6a64a860e1319dfbabc55b351c8b6583bd67413
Author: Damien Le Moal <damien.lemoal@opensource.wdc.com>
Date:   Tue Jan 4 15:48:17 2022 +0900

    ata: pata_samsung_cf: add compile test support
    
    Add Kconfig dependendy on COMPILE_TEST to allow compile tests with
    configs that do not enable SAMSUNG_DEV_IDE.
    
    Signed-off-by: Damien Le Moal <damien.lemoal@opensource.wdc.com>
    Reviewed-by: Hannes Reinecke <hare@suse.de>

commit 7767c73a3565ae975e7f1de7900815be4267cc3c
Author: Damien Le Moal <damien.lemoal@opensource.wdc.com>
Date:   Tue Jan 4 15:35:57 2022 +0900

    ata: pata_pxa: add compile test support
    
    Add Kconfig dependendy on COMPILE_TEST to allow compile tests with
    configs that do not enable ARCH_PXA.
    
    Signed-off-by: Damien Le Moal <damien.lemoal@opensource.wdc.com>
    Reviewed-by: Hannes Reinecke <hare@suse.de>

commit 7dc3c053bddf735b305bacfc620aa5cf6874ffe6
Author: Damien Le Moal <damien.lemoal@opensource.wdc.com>
Date:   Tue Jan 4 15:31:34 2022 +0900

    ata: pata_imx: add compile test support
    
    Add Kconfig dependendy on COMPILE_TEST to allow compile tests with
    configs that do not enable ARCH_MXC.
    
    Signed-off-by: Damien Le Moal <damien.lemoal@opensource.wdc.com>
    Reviewed-by: Hannes Reinecke <hare@suse.de>

commit 2aa566716f43776aee1cb46b3bb40af67b080d06
Author: Damien Le Moal <damien.lemoal@opensource.wdc.com>
Date:   Tue Jan 4 15:24:52 2022 +0900

    ata: pata_ftide010: add compile test support
    
    Add Kconfig dependendy on COMPILE_TEST to allow compile tests with
    configs that do not enable ARM.
    
    Signed-off-by: Damien Le Moal <damien.lemoal@opensource.wdc.com>
    Reviewed-by: Hannes Reinecke <hare@suse.de>

commit dc5d7b3cfd7833d41c2e2fad5fd5af5c95d05d04
Author: Damien Le Moal <damien.lemoal@opensource.wdc.com>
Date:   Tue Jan 4 15:19:30 2022 +0900

    ata: pata_cs5535: add compile test support
    
    Add Kconfig dependendy on X86_64 && COMPILE_TEST to allow compile tests
    with configs that do not have X86_32 enabled on X86_64 hosts.
    
    Signed-off-by: Damien Le Moal <damien.lemoal@opensource.wdc.com>
    Reviewed-by: Hannes Reinecke <hare@suse.de>

commit a3d11c275b647b5b56b907011b432e00f7ddb683
Author: Damien Le Moal <damien.lemoal@opensource.wdc.com>
Date:   Tue Jan 4 15:17:42 2022 +0900

    ata: pata_bk3710: add compile test support
    
    Add Kconfig dependendy on COMPILE_TEST to allow compile tests with
    configs that do not enable ARCH_DAVINCI.
    
    Signed-off-by: Damien Le Moal <damien.lemoal@opensource.wdc.com>
    Reviewed-by: Hannes Reinecke <hare@suse.de>

commit a33a348d0aca38107c435eef20c449cf13dd9447
Author: Damien Le Moal <damien.lemoal@opensource.wdc.com>
Date:   Tue Jan 4 15:11:15 2022 +0900

    ata: ahci_seattle: add compile test support
    
    Add Kconfig dependendy on COMPILE_TEST to allow compile tests with
    configs that do not enable ARCH_SEATTLE.
    
    Signed-off-by: Damien Le Moal <damien.lemoal@opensource.wdc.com>
    Reviewed-by: Hannes Reinecke <hare@suse.de>

commit b7c9b00fb050c6b3fea6e32f1adbe0194296eb1f
Author: Damien Le Moal <damien.lemoal@opensource.wdc.com>
Date:   Tue Jan 4 15:09:23 2022 +0900

    ata: ahci_xgene: add compile test support
    
    Add Kconfig dependendy on COMPILE_TEST to allow compile tests with
    configs that do not enable PHY_XGENE.
    
    Signed-off-by: Damien Le Moal <damien.lemoal@opensource.wdc.com>
    Reviewed-by: Hannes Reinecke <hare@suse.de>

commit 3d98cbf7096ea50bbb4256c7781555bb69a07e52
Author: Damien Le Moal <damien.lemoal@opensource.wdc.com>
Date:   Tue Jan 4 15:08:01 2022 +0900

    ata: ahci_tegra: add compile test support
    
    Add Kconfig dependendy on COMPILE_TEST to allow compile tests with
    configs that do not enable ARCH_TEGRA.
    
    Signed-off-by: Damien Le Moal <damien.lemoal@opensource.wdc.com>
    Reviewed-by: Hannes Reinecke <hare@suse.de>

commit c05b911afffa6a1842dd3bb9d54a8db178722e40
Author: Damien Le Moal <damien.lemoal@opensource.wdc.com>
Date:   Tue Jan 4 15:06:12 2022 +0900

    ata: ahci_sunxi: add compile test support
    
    Add Kconfig dependendy on COMPILE_TEST to allow compile tests with
    configs that do not enable ARCH_SUNXI.
    
    Signed-off-by: Damien Le Moal <damien.lemoal@opensource.wdc.com>
    Reviewed-by: Hannes Reinecke <hare@suse.de>

commit 368c7edc15e5e505ab56d6caad60fd11ee2bc428
Author: Damien Le Moal <damien.lemoal@opensource.wdc.com>
Date:   Tue Jan 4 15:01:01 2022 +0900

    ata: ahci_mvebu: add compile test support
    
    Add Kconfig dependendy on COMPILE_TEST to allow compile tests with
    configs that do not enable ARCH_MVEBU.
    
    Signed-off-by: Damien Le Moal <damien.lemoal@opensource.wdc.com>
    Reviewed-by: Hannes Reinecke <hare@suse.de>

commit 28a53d3160acd7e44a39a146da20e3e672fb0d96
Author: Damien Le Moal <damien.lemoal@opensource.wdc.com>
Date:   Tue Jan 4 14:59:00 2022 +0900

    ata: ahci_mtk: add compile test support
    
    Add Kconfig dependendy on COMPILE_TEST to allow compile tests with
    configs that do not enable ARCH_MEDIATEK.
    
    Signed-off-by: Damien Le Moal <damien.lemoal@opensource.wdc.com>
    Reviewed-by: Hannes Reinecke <hare@suse.de>

commit 82977af93a0dc4e70f60ca2137b67f65ebe47fc7
Author: Masahiro Yamada <masahiroy@kernel.org>
Date:   Mon Jan 10 03:15:25 2022 +0900

    sh: rename suffix-y to suffix_y
    
    'export suffix-y' does not work reliably because hyphens are disallowed
    in shell variables.
    
    A similar issue was fixed by commit 2bfbe7881ee0 ("kbuild: Do not use
    hyphen in exported variable name").
    
    If I do similar in dash, ARCH=sh fails to build.
    
      $ mv linux linux~
      $ cd linux~
      $ dash
      $ make O=foo/bar ARCH=sh CROSS_COMPILE=sh4-linux-gnu- defconfig all
      make[1]: Entering directory '/home/masahiro/linux~/foo/bar'
        [ snip ]
      make[4]: *** No rule to make target 'arch/sh/boot/compressed/vmlinux.bin.', needed by 'arch/sh/boot/compressed/piggy.o'.  Stop.
      make[3]: *** [/home/masahiro/linux~/arch/sh/boot/Makefile:40: arch/sh/boot/compressed/vmlinux] Error 2
      make[2]: *** [/home/masahiro/linux~/arch/sh/Makefile:194: zImage] Error 2
      make[1]: *** [/home/masahiro/linux~/Makefile:350: __build_one_by_one] Error 2
      make[1]: Leaving directory '/home/masahiro/linux~/foo/bar'
      make: *** [Makefile:219: __sub-make] Error 2
    
    The maintainer of GNU Make stated that there is no consistent way to
    export variables that do not meet the shell's naming criteria.
    (https://savannah.gnu.org/bugs/?55719)
    
    Consequently, you cannot use hyphens in exported variables.
    
    Signed-off-by: Masahiro Yamada <masahiroy@kernel.org>
    Reviewed-by: Nicolas Schier <n.schier@avm.de>

commit fc10f9d6671a3aacf1161dcc52582c27e3585a64
Merge: 96fe57938406 44ddb791f8f4
Author: Bjorn Helgaas <bhelgaas@google.com>
Date:   Thu Jan 13 09:57:49 2022 -0600

    Merge branch 'pci/host/mt7621'
    
    - Declare mt7621_pci_ops static (Sergio Paracuellos)
    
    - Give pcibios_root_bridge_prepare() access to host bridge windows (Sergio
      Paracuellos)
    
    - Move MIPS I/O coherency unit setup from driver to
      pcibios_root_bridge_prepare() (Sergio Paracuellos)
    
    - Add missing MODULE_LICENSE() (Sergio Paracuellos)
    
    - Allow COMPILE_TEST for all arches (Sergio Paracuellos)
    
    * pci/host/mt7621:
      PCI: mt7621: Allow COMPILE_TEST for all arches
      PCI: mt7621: Add missing MODULE_LICENSE()
      PCI: mt7621: Move MIPS setup to pcibios_root_bridge_prepare()
      PCI: Let pcibios_root_bridge_prepare() access bridge->windows
      PCI: mt7621: Declare mt7621_pci_ops static

commit 44ddb791f8f41f5f9f2ab4280a27c179ca7a8aed
Author: Sergio Paracuellos <sergio.paracuellos@gmail.com>
Date:   Wed Jan 12 15:28:10 2022 -0600

    PCI: mt7621: Allow COMPILE_TEST for all arches
    
    Since all MIPS-specific code has been removed from driver, allow it to be
    enabled for COMPILE_TEST on all architectures.
    
    Mark it as tristate and remove MIPS the MIPS dependency.
    
    Signed-off-by: Sergio Paracuellos <sergio.paracuellos@gmail.com>
    Signed-off-by: Bjorn Helgaas <bhelgaas@google.com>

commit 2a4d75bfe41232608f5596a6d1369f92ccb20817
Author: Miroslav Lichvar <mlichvar@redhat.com>
Date:   Tue Jan 11 16:10:53 2022 +0100

    net: fix sock_timestamping_bind_phc() to release device
    
    Don't forget to release the device in sock_timestamping_bind_phc() after
    it was used to get the vclock indices.
    
    Fixes: d463126e23f1 ("net: sock: extend SO_TIMESTAMPING for PHC binding")
    Signed-off-by: Miroslav Lichvar <mlichvar@redhat.com>
    Cc: Yangbo Lu <yangbo.lu@nxp.com>
    Signed-off-by: David S. Miller <davem@davemloft.net>

commit dd827abe296fe4249b2f8c9b95f72f814ea8348c
Author: Zizhuang Deng <sunsetdzz@gmail.com>
Date:   Thu Dec 30 15:03:31 2021 +0800

    lib/mpi: Add the return value check of kcalloc()
    
    Add the return value check of kcalloc() to avoid potential
    NULL ptr dereference.
    
    Fixes: a8ea8bdd9df9 ("lib/mpi: Extend the MPI library")
    Signed-off-by: Zizhuang Deng <sunsetdzz@gmail.com>
    Reviewed-by: Tianjia Zhang <tianjia.zhang@linux.alibaba.com>
    Signed-off-by: Herbert Xu <herbert@gondor.apana.org.au>

commit 007747a984ea5e895b7d8b056b24ebf431e1e71d
Author: Miroslav Lichvar <mlichvar@redhat.com>
Date:   Wed Jan 5 11:33:26 2022 +0100

    net: fix SOF_TIMESTAMPING_BIND_PHC to work with multiple sockets
    
    When multiple sockets using the SOF_TIMESTAMPING_BIND_PHC flag received
    a packet with a hardware timestamp (e.g. multiple PTP instances in
    different PTP domains using the UDPv4/v6 multicast or L2 transport),
    the timestamps received on some sockets were corrupted due to repeated
    conversion of the same timestamp (by the same or different vclocks).
    
    Fix ptp_convert_timestamp() to not modify the shared skb timestamp
    and return the converted timestamp as a ktime_t instead. If the
    conversion fails, return 0 to not confuse the application with
    timestamps corresponding to an unexpected PHC.
    
    Fixes: d7c088265588 ("net: socket: support hardware timestamp conversion to PHC bound")
    Signed-off-by: Miroslav Lichvar <mlichvar@redhat.com>
    Cc: Yangbo Lu <yangbo.lu@nxp.com>
    Cc: Richard Cochran <richardcochran@gmail.com>
    Acked-by: Richard Cochran <richardcochran@gmail.com>
    Signed-off-by: David S. Miller <davem@davemloft.net>

commit 56e18702b0c240dc3c4fde0619e8a78f5f13be97
Author: Damien Le Moal <damien.lemoal@opensource.wdc.com>
Date:   Tue Jan 4 14:53:49 2022 +0900

    ata: ahci_dm816: add compile test support
    
    Add Kconfig dependendy on COMPILE_TEST to allow compile tests with
    configs that do not enable ARCH_OMAP2PLUS.
    
    Signed-off-by: Damien Le Moal <damien.lemoal@opensource.wdc.com>
    Reviewed-by: Hannes Reinecke <hare@suse.de>

commit e73d737894dc4a59f232e1a1b16d968569fa0ffd
Author: Damien Le Moal <damien.lemoal@opensource.wdc.com>
Date:   Tue Jan 4 14:51:43 2022 +0900

    ata: ahci_da850: add compile test support
    
    Add Kconfig dependendy on COMPILE_TEST to allow compile tests with
    configs that do not enable ARCH_DAVINCI_DA850.
    
    Signed-off-by: Damien Le Moal <damien.lemoal@opensource.wdc.com>
    Reviewed-by: Hannes Reinecke <hare@suse.de>

commit 641ba1a5e2f88039b0d62524b2eb668680c94ea9
Author: Damien Le Moal <damien.lemoal@opensource.wdc.com>
Date:   Tue Jan 4 14:48:17 2022 +0900

    ata: ahci_brcm: add compile test support
    
    Add Kconfig dependendy on COMPILE_TEST to allow compile tests with
    configs that do not enable ARCH_BRCMSTB, BMIPS_GENERIC or ARCH_BCM_XXX.
    
    Signed-off-by: Damien Le Moal <damien.lemoal@opensource.wdc.com>
    Reviewed-by: Hannes Reinecke <hare@suse.de>

commit 87924c5b4094f195507bebcab96e141e48c947d7
Author: Damien Le Moal <damien.lemoal@opensource.wdc.com>
Date:   Tue Jan 4 13:46:18 2022 +0900

    ata: sata_fsl: add compile test support
    
    Add dependendy on COMPILE_TEST to allow compile tests with configs that
    do not enable FSL_SOC.
    
    Signed-off-by: Damien Le Moal <damien.lemoal@opensource.wdc.com>
    Reviewed-by: Hannes Reinecke <hare@suse.de>

commit 7d608c33cb5843cc9a7f4d86d4cd6a8514cd04a7
Author: Andrej Picej <andrej.picej@norik.com>
Date:   Mon Nov 29 14:49:38 2021 +0100

    watchdog: da9063: Add hard dependency on I2C
    
    Commit 5ea29919c294 ("watchdog: da9063: use atomic safe i2c transfer in
    reset handler") implements atomic save i2c transfer which uses i2c
    functions directly. Add I2C hard dependency which overrides COMPILE_TEST.
    
    Reported-by: kernel test robot <lkp@intel.com>
    Fixes: 968011a291f3 ("watchdog: da9063: use atomic safe i2c transfer in reset handler")
    Signed-off-by: Andrej Picej <andrej.picej@norik.com>
    Reviewed-by: Guenter Roeck <linux@roeck-us.net>
    Link: https://lore.kernel.org/r/20211129134938.3273289-1-andrej.picej@norik.com
    Signed-off-by: Guenter Roeck <linux@roeck-us.net>
    Signed-off-by: Wim Van Sebroeck <wim@linux-watchdog.org>

commit 1d1c25233a29cd6c9b7c19ea725461f9dc180e63
Author: Nick Desaulniers <ndesaulniers@google.com>
Date:   Tue Oct 19 15:36:46 2021 -0700

    arm64: vdso32: require CROSS_COMPILE_COMPAT for gcc+bfd
    
    commit 3e6f8d1fa18457d54b20917bd9174d27daf09ab9 upstream.
    
    Similar to
    commit 231ad7f409f1 ("Makefile: infer --target from ARCH for CC=clang")
    There really is no point in setting --target based on
    $CROSS_COMPILE_COMPAT for clang when the integrated assembler is being
    used, since
    commit ef94340583ee ("arm64: vdso32: drop -no-integrated-as flag").
    
    Allows COMPAT_VDSO to be selected without setting $CROSS_COMPILE_COMPAT
    when using clang and lld together.
    
    Before:
    $ ARCH=arm64 CROSS_COMPILE_COMPAT=arm-linux-gnueabi- make -j72 LLVM=1 defconfig
    $ grep CONFIG_COMPAT_VDSO .config
    CONFIG_COMPAT_VDSO=y
    $ ARCH=arm64 make -j72 LLVM=1 defconfig
    $ grep CONFIG_COMPAT_VDSO .config
    $
    
    After:
    $ ARCH=arm64 CROSS_COMPILE_COMPAT=arm-linux-gnueabi- make -j72 LLVM=1 defconfig
    $ grep CONFIG_COMPAT_VDSO .config
    CONFIG_COMPAT_VDSO=y
    $ ARCH=arm64 make -j72 LLVM=1 defconfig
    $ grep CONFIG_COMPAT_VDSO .config
    CONFIG_COMPAT_VDSO=y
    
    Reviewed-by: Nathan Chancellor <nathan@kernel.org>
    Suggested-by: Nathan Chancellor <nathan@kernel.org>
    Tested-by: Nathan Chancellor <nathan@kernel.org>
    Signed-off-by: Nick Desaulniers <ndesaulniers@google.com>
    Reviewed-by: Vincenzo Frascino <vincenzo.frascino@arm.com>
    Link: https://lore.kernel.org/r/20211019223646.1146945-5-ndesaulniers@google.com
    Signed-off-by: Will Deacon <will@kernel.org>
    Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>

commit 8c0059a25cb1da1454354350ff1db5cb8e0ea326
Author: Nick Desaulniers <ndesaulniers@google.com>
Date:   Tue Oct 19 15:36:46 2021 -0700

    arm64: vdso32: require CROSS_COMPILE_COMPAT for gcc+bfd
    
    commit 3e6f8d1fa18457d54b20917bd9174d27daf09ab9 upstream.
    
    Similar to
    commit 231ad7f409f1 ("Makefile: infer --target from ARCH for CC=clang")
    There really is no point in setting --target based on
    $CROSS_COMPILE_COMPAT for clang when the integrated assembler is being
    used, since
    commit ef94340583ee ("arm64: vdso32: drop -no-integrated-as flag").
    
    Allows COMPAT_VDSO to be selected without setting $CROSS_COMPILE_COMPAT
    when using clang and lld together.
    
    Before:
    $ ARCH=arm64 CROSS_COMPILE_COMPAT=arm-linux-gnueabi- make -j72 LLVM=1 defconfig
    $ grep CONFIG_COMPAT_VDSO .config
    CONFIG_COMPAT_VDSO=y
    $ ARCH=arm64 make -j72 LLVM=1 defconfig
    $ grep CONFIG_COMPAT_VDSO .config
    $
    
    After:
    $ ARCH=arm64 CROSS_COMPILE_COMPAT=arm-linux-gnueabi- make -j72 LLVM=1 defconfig
    $ grep CONFIG_COMPAT_VDSO .config
    CONFIG_COMPAT_VDSO=y
    $ ARCH=arm64 make -j72 LLVM=1 defconfig
    $ grep CONFIG_COMPAT_VDSO .config
    CONFIG_COMPAT_VDSO=y
    
    Reviewed-by: Nathan Chancellor <nathan@kernel.org>
    Suggested-by: Nathan Chancellor <nathan@kernel.org>
    Tested-by: Nathan Chancellor <nathan@kernel.org>
    Signed-off-by: Nick Desaulniers <ndesaulniers@google.com>
    Reviewed-by: Vincenzo Frascino <vincenzo.frascino@arm.com>
    Link: https://lore.kernel.org/r/20211019223646.1146945-5-ndesaulniers@google.com
    Signed-off-by: Will Deacon <will@kernel.org>
    Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>

commit b16b124a42e0c1daeafbea01094558f6cacbe059
Author: Nick Desaulniers <ndesaulniers@google.com>
Date:   Tue Apr 20 10:44:25 2021 -0700

    arm64: vdso32: drop -no-integrated-as flag
    
    commit ef94340583eec5cb1544dc41a87baa4f684b3fe1 upstream.
    
    Clang can assemble these files just fine; this is a relic from the top
    level Makefile conditionally adding this. We no longer need --prefix,
    --gcc-toolchain, or -Qunused-arguments flags either with this change, so
    remove those too.
    
    To test building:
    $ ARCH=arm64 CROSS_COMPILE=aarch64-linux-gnu- \
      CROSS_COMPILE_COMPAT=arm-linux-gnueabi- make LLVM=1 LLVM_IAS=1 \
      defconfig arch/arm64/kernel/vdso32/
    
    Suggested-by: Nathan Chancellor <nathan@kernel.org>
    Signed-off-by: Nick Desaulniers <ndesaulniers@google.com>
    Reviewed-by: Nathan Chancellor <nathan@kernel.org>
    Reviewed-by: Vincenzo Frascino <vincenzo.frascino@arm.com>
    Tested-by: Stephen Boyd <swboyd@chromium.org>
    Acked-by: Will Deacon <will@kernel.org>
    Link: https://lore.kernel.org/r/20210420174427.230228-1-ndesaulniers@google.com
    Signed-off-by: Catalin Marinas <catalin.marinas@arm.com>
    Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>

commit a91603a5d504a81b5760aa4e25a46676a41395fc
Author: Sreekanth Reddy <sreekanth.reddy@broadcom.com>
Date:   Mon Dec 20 19:41:57 2021 +0530

    scsi: mpi3mr: Enhanced Task Management Support Reply handling
    
    Enhance driver to consider MPI3_IOCSTATUS_SCSI_IOC_TERMINATED as a success
    for TMs issued by it and check the pending I/Os to decide the success or
    failure of the task management requests instead of just considering the
    MPI3_IOCSTATUS_SCSI_IOC_TERMINATED as a failure of the task management
    request.
    
    Link: https://lore.kernel.org/r/20211220141159.16117-24-sreekanth.reddy@broadcom.com
    Signed-off-by: Sreekanth Reddy <sreekanth.reddy@broadcom.com>
    Signed-off-by: Martin K. Petersen <martin.petersen@oracle.com>

commit c86651345ca55be6670faffa4aba104616461243
Author: Sreekanth Reddy <sreekanth.reddy@broadcom.com>
Date:   Mon Dec 20 19:41:56 2021 +0530

    scsi: mpi3mr: Use TM response codes from MPI3 headers
    
    Remove locally defined TM response codes and use codes from MPI3 headers.
    
    Link: https://lore.kernel.org/r/20211220141159.16117-23-sreekanth.reddy@broadcom.com
    Signed-off-by: Sreekanth Reddy <sreekanth.reddy@broadcom.com>
    Signed-off-by: Martin K. Petersen <martin.petersen@oracle.com>

commit 95cca8d5542a4cde0d3dd685f4108295ca28b63d
Author: Sreekanth Reddy <sreekanth.reddy@broadcom.com>
Date:   Mon Dec 20 19:41:54 2021 +0530

    scsi: mpi3mr: Print cable mngnt and temp threshold events
    
    Print cable management & temperature threshold event data.
    
    Use vendor id & device id macro definitions from MPI3 headers.
    
    Link: https://lore.kernel.org/r/20211220141159.16117-21-sreekanth.reddy@broadcom.com
    Signed-off-by: Sreekanth Reddy <sreekanth.reddy@broadcom.com>
    Signed-off-by: Martin K. Petersen <martin.petersen@oracle.com>

commit 17d6b9cf89cfdb5a52298bb4abe7f1621f92ba93
Author: Sreekanth Reddy <sreekanth.reddy@broadcom.com>
Date:   Mon Dec 20 19:41:40 2021 +0530

    scsi: mpi3mr: Add support for PCIe Managed Switch SES device
    
    The SAS4 Controller firmware exposes the SES devices in Managed PCIe Switch
    as a PCIe Device Type SCSI Device
    (MPI3_DEVICE0_PCIE_DEVICE_INFO_TYPE_SCSI_DEVICE).
    
    Driver is enhanced to handle this device type by:
    
     - Exposing the device to the upper layers and
    
     - Not updating any hardware sectors & virtual boundary settings as these
       settings are needed only for NVMe devices.
    
    Link: https://lore.kernel.org/r/20211220141159.16117-7-sreekanth.reddy@broadcom.com
    Signed-off-by: Sreekanth Reddy <sreekanth.reddy@broadcom.com>
    Signed-off-by: Martin K. Petersen <martin.petersen@oracle.com>

commit ec5ebd2c14a9123c0a8e2ae29202adf0ac242565
Author: Sreekanth Reddy <sreekanth.reddy@broadcom.com>
Date:   Mon Dec 20 19:41:39 2021 +0530

    scsi: mpi3mr: Update MPI3 headers - part2
    
    Continued updating MPI3 headers.
    
    Link: https://lore.kernel.org/r/20211220141159.16117-6-sreekanth.reddy@broadcom.com
    Signed-off-by: Sreekanth Reddy <sreekanth.reddy@broadcom.com>
    Signed-off-by: Martin K. Petersen <martin.petersen@oracle.com>

commit d00ff7c31195e2f5098b2c034f547a83c30b8adb
Author: Sreekanth Reddy <sreekanth.reddy@broadcom.com>
Date:   Mon Dec 20 19:41:38 2021 +0530

    scsi: mpi3mr: Update MPI3 headers - part1
    
    Update MPI3 headers.
    
    Link: https://lore.kernel.org/r/20211220141159.16117-5-sreekanth.reddy@broadcom.com
    Signed-off-by: Sreekanth Reddy <sreekanth.reddy@broadcom.com>
    Signed-off-by: Martin K. Petersen <martin.petersen@oracle.com>

commit ce96a964682ac11a7f6823397dfdb5026d459f37
Author: Marek Szyprowski <m.szyprowski@samsung.com>
Date:   Mon Dec 20 17:50:04 2021 +0100

    arm64: exynos: Enable Exynos Multi-Core Timer driver
    
    Some ARM64 Exynos SoCs have MCT timer block, e.g. Exynos850 and
    Exynos5433. CLKSRC_EXYNOS_MCT option is not visible unless COMPILE_TEST
    is enabled. Select CLKSRC_EXYNOS_MCT option for ARM64 ARCH_EXYNOS like
    it's done in arch/arm/mach-exynos/Kconfig, to enable MCT timer support
    for ARM64 Exynos SoCs.
    
    Even though ARM architected timer is available on all ARM64 SoCs, and
    used for managing timer hardware and clock source events, MCT timer
    still can be used as a wakeup source, as stated in commitae460fd9164b
    ("clocksource/drivers/exynos_mct: Prioritise Arm arch timer on arm64").
    It's also nice to be able to test available MCT IP-core.
    
    Signed-off-by: Marek Szyprowski <m.szyprowski@samsung.com>
    Signed-off-by: Sam Protsenko <semen.protsenko@linaro.org>
    Signed-off-by: Krzysztof Kozlowski <krzysztof.kozlowski@canonical.com>
    Tested-by: Chanwoo Choi <cw00.choi@samsung.com>
    Reviewed-by: Krzysztof Kozlowski <krzk@kernel.org>
    Reviewed-by: Chanwoo Choi <cw00.choi@samsung.com>
    Link: https://lore.kernel.org/r/20211101193531.15078-3-semen.protsenko@linaro.org
    Link: https://lore.kernel.org/r/20211220165004.17005-2-krzysztof.kozlowski@canonical.com'
    Signed-off-by: Arnd Bergmann <arnd@arndb.de>

commit 1a6369ba624929c8bfa412045af79dbf7703b8c8
Merge: f97982398cc1 ea79020a2d9e
Author: Andrii Nakryiko <andrii@kernel.org>
Date:   Thu Dec 16 12:15:05 2021 -0800

    Merge branch 'tools/bpf: Enable cross-building with clang'
    
    Jean-Philippe Brucker says:
    
    ====================
    
    Since v1 [1], I added Quentin's acks and applied Andrii's suggestions:
    * Pass CFLAGS to libbpf link in patch 3
    * Substitute CLANG_CROSS_FLAGS whole in HOST_CFLAGS to avoid accidents,
      patch 4
    
    Add support for cross-building BPF tools and selftests with clang, by
    passing LLVM=1 or CC=clang to make, as well as CROSS_COMPILE. A single
    clang toolchain can generate binaries for multiple architectures, so
    instead of having prefixes such as aarch64-linux-gnu-gcc, clang uses the
    -target parameter: `clang -target aarch64-linux-gnu'.
    
    Patch 1 adds the parameter in Makefile.include so tools can easily
    support this. Patch 2 prepares for the libbpf change from patch 3 (keep
    building resolve_btfids's libbpf in the host arch, when cross-building
    the kernel with clang). Patches 3-6 enable cross-building BPF tools with
    clang.
    
    [1] https://lore.kernel.org/bpf/20211122192019.1277299-1-jean-philippe@linaro.org/
    ====================
    
    Signed-off-by: Andrii Nakryiko <andrii@kernel.org>

commit ea79020a2d9eea62b12d90f0c11b7d70fcadc172
Author: Jean-Philippe Brucker <jean-philippe@linaro.org>
Date:   Thu Dec 16 16:38:43 2021 +0000

    selftests/bpf: Enable cross-building with clang
    
    Cross building using clang requires passing the "-target" flag rather
    than using the CROSS_COMPILE prefix. Makefile.include transforms
    CROSS_COMPILE into CLANG_CROSS_FLAGS. Clear CROSS_COMPILE for bpftool
    and the host libbpf, and use the clang flags for urandom_read and bench.
    
    Signed-off-by: Jean-Philippe Brucker <jean-philippe@linaro.org>
    Signed-off-by: Andrii Nakryiko <andrii@kernel.org>
    Acked-by: Quentin Monnet <quentin@isovalent.com>
    Link: https://lore.kernel.org/bpf/20211216163842.829836-7-jean-philippe@linaro.org

commit bb7b75e860eec31aa67b83935849fdc46418c13e
Author: Jean-Philippe Brucker <jean-philippe@linaro.org>
Date:   Thu Dec 16 16:38:42 2021 +0000

    tools/runqslower: Enable cross-building with clang
    
    Cross-building using clang requires passing the "-target" flag rather
    than using the CROSS_COMPILE prefix. Makefile.include transforms
    CROSS_COMPILE into CLANG_CROSS_FLAGS. Add them to CFLAGS, and erase
    CROSS_COMPILE for the bpftool build, since it needs to be executed on
    the host.
    
    Signed-off-by: Jean-Philippe Brucker <jean-philippe@linaro.org>
    Signed-off-by: Andrii Nakryiko <andrii@kernel.org>
    Acked-by: Quentin Monnet <quentin@isovalent.com>
    Link: https://lore.kernel.org/bpf/20211216163842.829836-6-jean-philippe@linaro.org

commit bdadbb44c90aedaa74d46f1b113bd845774efa39
Author: Jean-Philippe Brucker <jean-philippe@linaro.org>
Date:   Thu Dec 16 16:38:41 2021 +0000

    bpftool: Enable cross-building with clang
    
    Cross-building using clang requires passing the "-target" flag rather
    than using the CROSS_COMPILE prefix. Makefile.include transforms
    CROSS_COMPILE into CLANG_CROSS_FLAGS, and adds that to CFLAGS. Remove
    the cross flags for the bootstrap bpftool, and erase the CROSS_COMPILE
    flag for the bootstrap libbpf.
    
    Signed-off-by: Jean-Philippe Brucker <jean-philippe@linaro.org>
    Signed-off-by: Andrii Nakryiko <andrii@kernel.org>
    Acked-by: Quentin Monnet <quentin@isovalent.com>
    Link: https://lore.kernel.org/bpf/20211216163842.829836-5-jean-philippe@linaro.org

commit 4980beb4cda2bc413a3a044e1851b0daaf137bf6
Author: Jean-Philippe Brucker <jean-philippe@linaro.org>
Date:   Thu Dec 16 16:38:40 2021 +0000

    tools/libbpf: Enable cross-building with clang
    
    Cross-building using clang requires passing the "-target" flag rather
    than using the CROSS_COMPILE prefix. Makefile.include transforms
    CROSS_COMPILE into CLANG_CROSS_FLAGS. Add them to the CFLAGS.
    
    Signed-off-by: Jean-Philippe Brucker <jean-philippe@linaro.org>
    Signed-off-by: Andrii Nakryiko <andrii@kernel.org>
    Acked-by: Quentin Monnet <quentin@isovalent.com>
    Link: https://lore.kernel.org/bpf/20211216163842.829836-4-jean-philippe@linaro.org

commit bf1be903461a404a9d1c720b0872501ca35abc89
Author: Jean-Philippe Brucker <jean-philippe@linaro.org>
Date:   Thu Dec 16 16:38:39 2021 +0000

    tools/resolve_btfids: Support cross-building the kernel with clang
    
    The CROSS_COMPILE variable may be present during resolve_btfids build if
    the kernel is being cross-built. Since resolve_btfids is always executed
    on the host, we set CC to HOSTCC in order to use the host toolchain when
    cross-building with GCC. But instead of a toolchain prefix, cross-build
    with clang uses a "-target" parameter, which Makefile.include deduces
    from the CROSS_COMPILE variable. In order to avoid cross-building
    libbpf, clear CROSS_COMPILE before building resolve_btfids.
    
    Signed-off-by: Jean-Philippe Brucker <jean-philippe@linaro.org>
    Signed-off-by: Andrii Nakryiko <andrii@kernel.org>
    Acked-by: Quentin Monnet <quentin@isovalent.com>
    Link: https://lore.kernel.org/bpf/20211216163842.829836-3-jean-philippe@linaro.org

commit cebdb7374577ac6e14afb11311af8c2c44a259fa
Author: Jean-Philippe Brucker <jean-philippe@linaro.org>
Date:   Thu Dec 16 16:38:38 2021 +0000

    tools: Help cross-building with clang
    
    Cross-compilation with clang uses the -target parameter rather than a
    toolchain prefix. Just like the kernel Makefile, add that parameter to
    CFLAGS when CROSS_COMPILE is set.
    
    Unlike the kernel Makefile, we use the --sysroot and --gcc-toolchain
    options because unlike the kernel, tools require standard libraries.
    Commit c91d4e47e10e ("Makefile: Remove '--gcc-toolchain' flag") provides
    some background about --gcc-toolchain. Normally clang finds on its own
    the additional utilities and libraries that it needs (for example GNU ld
    or glibc). On some systems however, this autodetection doesn't work.
    There, our only recourse is asking GCC directly, and pass the result to
    --sysroot and --gcc-toolchain. Of course that only works when a cross
    GCC is available.
    
    Autodetection worked fine on Debian, but to use the aarch64-linux-gnu
    toolchain from Archlinux I needed both --sysroot (for crt1.o) and
    --gcc-toolchain (for crtbegin.o, -lgcc). The --prefix parameter wasn't
    needed there, but it might be useful on other distributions.
    
    Use the CLANG_CROSS_FLAGS variable instead of CLANG_FLAGS because it
    allows tools such as bpftool, that need to build both host and target
    binaries, to easily filter out the cross-build flags from CFLAGS.
    
    Signed-off-by: Jean-Philippe Brucker <jean-philippe@linaro.org>
    Signed-off-by: Andrii Nakryiko <andrii@kernel.org>
    Acked-by: Quentin Monnet <quentin@isovalent.com>
    Acked-by: Nick Desaulniers <ndesaulniers@google.com>
    Link: https://lore.kernel.org/bpf/20211216163842.829836-2-jean-philippe@linaro.org

commit 54dd5a419f26e994d64754d5f009e36825dec0db
Author: Julian Braha <julianbraha@gmail.com>
Date:   Wed Dec 15 16:40:22 2021 -0500

    pinctrl: aspeed: fix unmet dependencies on MFD_SYSCON for PINCTRL_ASPEED
    
    When PINCTRL_ASPEED_G* is selected,
    and MFD_SYSCON is not selected,
    Kbuild gives the following warnings:
    
    WARNING: unmet direct dependencies detected for PINCTRL_ASPEED
      Depends on [n]: PINCTRL [=y] && (ARCH_ASPEED [=n] || COMPILE_TEST [=y]) && OF [=y] && MFD_SYSCON [=n]
      Selected by [y]:
      - PINCTRL_ASPEED_G4 [=y] && PINCTRL [=y] && (MACH_ASPEED_G4 [=n] || COMPILE_TEST [=y]) && OF [=y]
    
    WARNING: unmet direct dependencies detected for PINCTRL_ASPEED
      Depends on [n]: PINCTRL [=y] && (ARCH_ASPEED [=n] || COMPILE_TEST [=y]) && OF [=y] && MFD_S>
      Selected by [y]:
      - PINCTRL_ASPEED_G5 [=y] && PINCTRL [=y] && (MACH_ASPEED_G5 [=n] || COMPILE_TEST [=y]) && O>
    
    WARNING: unmet direct dependencies detected for PINCTRL_ASPEED
      Depends on [n]: PINCTRL [=y] && (ARCH_ASPEED [=n] || COMPILE_TEST [=y]) && OF [=y] && MFD_S>
      Selected by [y]:
      - PINCTRL_ASPEED_G6 [=y] && PINCTRL [=y] && (MACH_ASPEED_G6 [=n] || COMPILE_TEST [=y]) && O>
    
    This is because MACH_ASPEED_G* depend on (ARCH_ASPEED || COMPILE_TEST).
    ARCH_ASPEED enables the MFD_SYSCON dependency, but COMPILE_TEST doesn't.
    
    These unmet dependency bugs were detected by Kismet,
    a static analysis tool for Kconfig. Please advise
    if this is not the appropriate solution.
    
    Signed-off-by: Julian Braha <julianbraha@gmail.com>
    Reviewed-by: Andrew Jeffery <andrew@aj.id.au>
    Link: https://lore.kernel.org/r/20211215214022.146391-1-julianbraha@gmail.com
    Signed-off-by: Linus Walleij <linus.walleij@linaro.org>

commit 5b532920d74e2647d30a2a63647a99f19b6141bb
Merge: 0491871b63da 6df9d38f9146
Author: Arnd Bergmann <arnd@arndb.de>
Date:   Tue Dec 14 10:17:27 2021 +0100

    Merge tag 'asahi-soc-pmgr-5.17' of https://github.com/AsahiLinux/linux into arm/drivers
    
    Apple SoC PMGR driver for 5.17
    
    Adds the new PMGR driver. This includes the driver only; DT and
    MAINTAINERS changes are part of the DT pull.
    
    Minor change from v3: added `depends on PM` to the Kconfig to
    fix COMPILE_TEST randconfig failures.
    
    * tag 'asahi-soc-pmgr-5.17' of https://github.com/AsahiLinux/linux:
      soc: apple: Add driver for Apple PMGR power state controls
    
    Link: https://lore.kernel.org/r/049f4de9-51be-7be4-1f9a-a59756af88d7@marcan.st
    Signed-off-by: Arnd Bergmann <arnd@arndb.de>

commit a3c62a042237d1adeb0290dcb768e17edd6dcd25
Author: Lorenzo Bianconi <lorenzo@kernel.org>
Date:   Mon Dec 13 12:23:22 2021 +0100

    net: mtk_eth: add COMPILE_TEST support
    
    Improve the build testing of mtk_eth drivers by enabling them when
    COMPILE_TEST is selected. Moreover COMPILE_TEST will be useful
    for the driver development.
    
    Signed-off-by: Lorenzo Bianconi <lorenzo@kernel.org>
    Signed-off-by: David S. Miller <davem@davemloft.net>

commit aca091aadef40222ce8bad6a56f7a995de417edb
Author: Julian Braha <julianbraha@gmail.com>
Date:   Thu Oct 28 20:46:10 2021 -0400

    pinctrl: qcom: fix unmet dependencies on GPIOLIB for GPIOLIB_IRQCHIP
    
    [ Upstream commit 60430d4c4eddcdf8eac2bdbec9704f84a436eedf ]
    
    When PINCTRL_QCOM_SPMI_PMIC or PINCTRL_QCOM_SSBI_PMIC
    is selected, and GPIOLIB is not selected, Kbuild
    gives the following warnings:
    
    WARNING: unmet direct dependencies detected for GPIOLIB_IRQCHIP
      Depends on [n]: GPIOLIB [=n]
      Selected by [y]:
      - PINCTRL_QCOM_SPMI_PMIC [=y] && PINCTRL [=y] && (ARCH_QCOM [=n] || COMPILE_TEST [=y]) && OF [=y] && SPMI [=y]
    
    WARNING: unmet direct dependencies detected for GPIOLIB_IRQCHIP
      Depends on [n]: GPIOLIB [=n]
      Selected by [y]:
      - PINCTRL_QCOM_SSBI_PMIC [=y] && PINCTRL [=y] && (ARCH_QCOM [=n] || COMPILE_TEST [=y]) && OF [=y]
    
    This is because these config options enable GPIOLIB_IRQCHIP
    without selecting or depending on GPIOLIB, despite
    GPIOLIB_IRQCHIP depending on GPIOLIB.
    
    These unmet dependency bugs were detected by Kismet,
    a static analysis tool for Kconfig. Please advise if this
    is not the appropriate solution.
    
    Signed-off-by: Julian Braha <julianbraha@gmail.com>
    Link: https://lore.kernel.org/r/20211029004610.35131-1-julianbraha@gmail.com
    Signed-off-by: Linus Walleij <linus.walleij@linaro.org>
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit 8e7c364d1c07dbd9461c7d56e4feb8a1bd92b438
Author: Julian Braha <julianbraha@gmail.com>
Date:   Mon Nov 8 22:23:51 2021 -0500

    drm/sun4i: fix unmet dependency on RESET_CONTROLLER for PHY_SUN6I_MIPI_DPHY
    
    [ Upstream commit bb162bb2b4394108c8f055d1b115735331205e28 ]
    
    When PHY_SUN6I_MIPI_DPHY is selected, and RESET_CONTROLLER
    is not selected, Kbuild gives the following warning:
    
    WARNING: unmet direct dependencies detected for PHY_SUN6I_MIPI_DPHY
      Depends on [n]: (ARCH_SUNXI [=n] || COMPILE_TEST [=y]) && HAS_IOMEM [=y] && COMMON_CLK [=y] && RESET_CONTROLLER [=n]
      Selected by [y]:
      - DRM_SUN6I_DSI [=y] && HAS_IOMEM [=y] && DRM_SUN4I [=y]
    
    This is because DRM_SUN6I_DSI selects PHY_SUN6I_MIPI_DPHY
    without selecting or depending on RESET_CONTROLLER, despite
    PHY_SUN6I_MIPI_DPHY depending on RESET_CONTROLLER.
    
    These unmet dependency bugs were detected by Kismet,
    a static analysis tool for Kconfig. Please advise if this
    is not the appropriate solution.
    
    v2:
    Fixed indentation to match the rest of the file.
    
    Signed-off-by: Julian Braha <julianbraha@gmail.com>
    Acked-by: Jernej Skrabec <jernej.skrabec@gmail.com>
    Signed-off-by: Maxime Ripard <maxime@cerno.tech>
    Link: https://patchwork.freedesktop.org/patch/msgid/20211109032351.43322-1-julianbraha@gmail.com
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit c386d7aa59f5040dbcbc02499a31474859546d6d
Author: Julian Braha <julianbraha@gmail.com>
Date:   Mon Nov 8 22:23:51 2021 -0500

    drm/sun4i: fix unmet dependency on RESET_CONTROLLER for PHY_SUN6I_MIPI_DPHY
    
    [ Upstream commit bb162bb2b4394108c8f055d1b115735331205e28 ]
    
    When PHY_SUN6I_MIPI_DPHY is selected, and RESET_CONTROLLER
    is not selected, Kbuild gives the following warning:
    
    WARNING: unmet direct dependencies detected for PHY_SUN6I_MIPI_DPHY
      Depends on [n]: (ARCH_SUNXI [=n] || COMPILE_TEST [=y]) && HAS_IOMEM [=y] && COMMON_CLK [=y] && RESET_CONTROLLER [=n]
      Selected by [y]:
      - DRM_SUN6I_DSI [=y] && HAS_IOMEM [=y] && DRM_SUN4I [=y]
    
    This is because DRM_SUN6I_DSI selects PHY_SUN6I_MIPI_DPHY
    without selecting or depending on RESET_CONTROLLER, despite
    PHY_SUN6I_MIPI_DPHY depending on RESET_CONTROLLER.
    
    These unmet dependency bugs were detected by Kismet,
    a static analysis tool for Kconfig. Please advise if this
    is not the appropriate solution.
    
    v2:
    Fixed indentation to match the rest of the file.
    
    Signed-off-by: Julian Braha <julianbraha@gmail.com>
    Acked-by: Jernej Skrabec <jernej.skrabec@gmail.com>
    Signed-off-by: Maxime Ripard <maxime@cerno.tech>
    Link: https://patchwork.freedesktop.org/patch/msgid/20211109032351.43322-1-julianbraha@gmail.com
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit 3200cf7b9b7e3aa76b8bee90596f9450c58950ff
Author: Julian Braha <julianbraha@gmail.com>
Date:   Mon Nov 8 22:23:51 2021 -0500

    drm/sun4i: fix unmet dependency on RESET_CONTROLLER for PHY_SUN6I_MIPI_DPHY
    
    [ Upstream commit bb162bb2b4394108c8f055d1b115735331205e28 ]
    
    When PHY_SUN6I_MIPI_DPHY is selected, and RESET_CONTROLLER
    is not selected, Kbuild gives the following warning:
    
    WARNING: unmet direct dependencies detected for PHY_SUN6I_MIPI_DPHY
      Depends on [n]: (ARCH_SUNXI [=n] || COMPILE_TEST [=y]) && HAS_IOMEM [=y] && COMMON_CLK [=y] && RESET_CONTROLLER [=n]
      Selected by [y]:
      - DRM_SUN6I_DSI [=y] && HAS_IOMEM [=y] && DRM_SUN4I [=y]
    
    This is because DRM_SUN6I_DSI selects PHY_SUN6I_MIPI_DPHY
    without selecting or depending on RESET_CONTROLLER, despite
    PHY_SUN6I_MIPI_DPHY depending on RESET_CONTROLLER.
    
    These unmet dependency bugs were detected by Kismet,
    a static analysis tool for Kconfig. Please advise if this
    is not the appropriate solution.
    
    v2:
    Fixed indentation to match the rest of the file.
    
    Signed-off-by: Julian Braha <julianbraha@gmail.com>
    Acked-by: Jernej Skrabec <jernej.skrabec@gmail.com>
    Signed-off-by: Maxime Ripard <maxime@cerno.tech>
    Link: https://patchwork.freedesktop.org/patch/msgid/20211109032351.43322-1-julianbraha@gmail.com
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit d6e71a43b11c67cae3f3c595beef020899ec68e9
Author: Bart Van Assche <bvanassche@acm.org>
Date:   Mon Nov 29 11:46:07 2021 -0800

    scsi: pm8001: Fix kernel-doc warnings
    
    Fix the following kernel-doc warnings:
    
    drivers/scsi/pm8001/pm8001_ctl.c:900: warning: cannot understand function prototype: 'const char *const mpiStateText[] = '
    drivers/scsi/pm8001/pm8001_ctl.c:930: warning: Function parameter or member 'attr' not described in 'ctl_hmi_error_show'
    drivers/scsi/pm8001/pm8001_ctl.c:951: warning: Function parameter or member 'attr' not described in 'ctl_raae_count_show'
    drivers/scsi/pm8001/pm8001_ctl.c:972: warning: Function parameter or member 'attr' not described in 'ctl_iop0_count_show'
    drivers/scsi/pm8001/pm8001_ctl.c:993: warning: Function parameter or member 'attr' not described in 'ctl_iop1_count_show'
    
    Link: https://lore.kernel.org/r/20211129194609.3466071-11-bvanassche@acm.org
    Fixes: 4ddbea1b6f51 ("scsi: pm80xx: Add sysfs attribute to check MPI state")
    Acked-by: Jack Wang <jinpu.wang@ionos.com>
    Signed-off-by: Bart Van Assche <bvanassche@acm.org>
    Signed-off-by: Martin K. Petersen <martin.petersen@oracle.com>

commit e873ba1a01595d067d324040a5723c76f4d63259
Author: Jackie Liu <liuyun01@kylinos.cn>
Date:   Tue Sep 7 10:49:04 2021 +0800

    ar7: fix kernel builds for compiler test
    
    [ Upstream commit 28b7ee33a2122569ac065cad578bf23f50cc65c3 ]
    
    TI AR7 Watchdog Timer is only build for 32bit.
    
    Avoid error like:
    In file included from drivers/watchdog/ar7_wdt.c:29:
    ./arch/mips/include/asm/mach-ar7/ar7.h: In function ar7_is_titan:
    ./arch/mips/include/asm/mach-ar7/ar7.h:111:24: error: implicit declaration of function KSEG1ADDR; did you mean CKSEG1ADDR? [-Werror=implicit-function-declaration]
      111 |  return (readl((void *)KSEG1ADDR(AR7_REGS_GPIO + 0x24)) & 0xffff) ==
          |                        ^~~~~~~~~
          |                        CKSEG1ADDR
    
    Fixes: da2a68b3eb47 ("watchdog: Enable COMPILE_TEST where possible")
    Signed-off-by: Jackie Liu <liuyun01@kylinos.cn>
    Reviewed-by: Guenter Roeck <linux@roeck-us.net>
    Link: https://lore.kernel.org/r/20210907024904.4127611-1-liu.yun@linux.dev
    Signed-off-by: Guenter Roeck <linux@roeck-us.net>
    Signed-off-by: Wim Van Sebroeck <wim@linux-watchdog.org>
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit dcf53641d60b25e847a4d353b5e3ab2c78d833a0
Author: Jackie Liu <liuyun01@kylinos.cn>
Date:   Tue Sep 7 10:49:04 2021 +0800

    ar7: fix kernel builds for compiler test
    
    [ Upstream commit 28b7ee33a2122569ac065cad578bf23f50cc65c3 ]
    
    TI AR7 Watchdog Timer is only build for 32bit.
    
    Avoid error like:
    In file included from drivers/watchdog/ar7_wdt.c:29:
    ./arch/mips/include/asm/mach-ar7/ar7.h: In function ar7_is_titan:
    ./arch/mips/include/asm/mach-ar7/ar7.h:111:24: error: implicit declaration of function KSEG1ADDR; did you mean CKSEG1ADDR? [-Werror=implicit-function-declaration]
      111 |  return (readl((void *)KSEG1ADDR(AR7_REGS_GPIO + 0x24)) & 0xffff) ==
          |                        ^~~~~~~~~
          |                        CKSEG1ADDR
    
    Fixes: da2a68b3eb47 ("watchdog: Enable COMPILE_TEST where possible")
    Signed-off-by: Jackie Liu <liuyun01@kylinos.cn>
    Reviewed-by: Guenter Roeck <linux@roeck-us.net>
    Link: https://lore.kernel.org/r/20210907024904.4127611-1-liu.yun@linux.dev
    Signed-off-by: Guenter Roeck <linux@roeck-us.net>
    Signed-off-by: Wim Van Sebroeck <wim@linux-watchdog.org>
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit 7c8f778f0a3a21423278eea57d932d773c05e9b7
Author: Nick Desaulniers <ndesaulniers@google.com>
Date:   Tue Oct 19 15:36:45 2021 -0700

    arm64: vdso32: suppress error message for 'make mrproper'
    
    commit 14831fad73f5ac30ac61760487d95a538e6ab3cb upstream.
    
    When running the following command without arm-linux-gnueabi-gcc in
    one's $PATH, the following warning is observed:
    
    $ ARCH=arm64 CROSS_COMPILE_COMPAT=arm-linux-gnueabi- make -j72 LLVM=1 mrproper
    make[1]: arm-linux-gnueabi-gcc: No such file or directory
    
    This is because KCONFIG is not run for mrproper, so CONFIG_CC_IS_CLANG
    is not set, and we end up eagerly evaluating various variables that try
    to invoke CC_COMPAT.
    
    This is a similar problem to what was observed in
    commit dc960bfeedb0 ("h8300: suppress error messages for 'make clean'")
    
    Reported-by: Lucas Henneman <henneman@google.com>
    Suggested-by: Masahiro Yamada <masahiroy@kernel.org>
    Signed-off-by: Nick Desaulniers <ndesaulniers@google.com>
    Reviewed-by: Vincenzo Frascino <vincenzo.frascino@arm.com>
    Reviewed-by: Nathan Chancellor <nathan@kernel.org>
    Tested-by: Nathan Chancellor <nathan@kernel.org>
    Link: https://lore.kernel.org/r/20211019223646.1146945-4-ndesaulniers@google.com
    Signed-off-by: Will Deacon <will@kernel.org>
    Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>

commit af1d3c437eb526f9274e1bf2f8ff4a0484eb1c48
Author: Nick Desaulniers <ndesaulniers@google.com>
Date:   Tue Oct 19 15:36:45 2021 -0700

    arm64: vdso32: suppress error message for 'make mrproper'
    
    commit 14831fad73f5ac30ac61760487d95a538e6ab3cb upstream.
    
    When running the following command without arm-linux-gnueabi-gcc in
    one's $PATH, the following warning is observed:
    
    $ ARCH=arm64 CROSS_COMPILE_COMPAT=arm-linux-gnueabi- make -j72 LLVM=1 mrproper
    make[1]: arm-linux-gnueabi-gcc: No such file or directory
    
    This is because KCONFIG is not run for mrproper, so CONFIG_CC_IS_CLANG
    is not set, and we end up eagerly evaluating various variables that try
    to invoke CC_COMPAT.
    
    This is a similar problem to what was observed in
    commit dc960bfeedb0 ("h8300: suppress error messages for 'make clean'")
    
    Reported-by: Lucas Henneman <henneman@google.com>
    Suggested-by: Masahiro Yamada <masahiroy@kernel.org>
    Signed-off-by: Nick Desaulniers <ndesaulniers@google.com>
    Reviewed-by: Vincenzo Frascino <vincenzo.frascino@arm.com>
    Reviewed-by: Nathan Chancellor <nathan@kernel.org>
    Tested-by: Nathan Chancellor <nathan@kernel.org>
    Link: https://lore.kernel.org/r/20211019223646.1146945-4-ndesaulniers@google.com
    Signed-off-by: Will Deacon <will@kernel.org>
    Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>

commit d7921344234d15ce24a151d932aa0748797fc502
Author: Stephan Mller <smueller@chronox.de>
Date:   Fri Nov 19 07:58:44 2021 +0100

    security: DH - remove dead code for zero padding
    
    Remove the specific code that adds a zero padding that was intended
    to be invoked when the DH operation result was smaller than the
    modulus. However, this cannot occur any more these days because the
    function mpi_write_to_sgl is used in the code path that calculates the
    shared secret in dh_compute_value. This MPI service function guarantees
    that leading zeros are introduced as needed to ensure the resulting data
    is exactly as long as the modulus. This implies that the specific code
    to add zero padding is dead code which can be safely removed.
    
    Signed-off-by: Stephan Mueller <smueller@chronox.de>
    Acked-by: Mat Martineau <mathew.j.martineau@linux.intel.com>
    Signed-off-by: Herbert Xu <herbert@gondor.apana.org.au>

commit 9b1b68eaad2acc099c6d1ab00e8652de5b33dd15
Author: Masahiro Yamada <masahiroy@kernel.org>
Date:   Wed Nov 10 00:01:45 2021 +0900

    MIPS: fix *-pkg builds for loongson2ef platform
    
    commit 0706f74f719e6e72c3a862ab2990796578fa73cc upstream.
    
    Since commit 805b2e1d427a ("kbuild: include Makefile.compiler only when
    compiler is needed"), package builds for the loongson2f platform fail.
    
      $ make ARCH=mips CROSS_COMPILE=mips64-linux- lemote2f_defconfig bindeb-pkg
        [ snip ]
      sh ./scripts/package/builddeb
      arch/mips/loongson2ef//Platform:36: *** only binutils >= 2.20.2 have needed option -mfix-loongson2f-nop.  Stop.
      cp: cannot stat '': No such file or directory
      make[5]: *** [scripts/Makefile.package:87: intdeb-pkg] Error 1
      make[4]: *** [Makefile:1558: intdeb-pkg] Error 2
      make[3]: *** [debian/rules:13: binary-arch] Error 2
      dpkg-buildpackage: error: debian/rules binary subprocess returned exit status 2
      make[2]: *** [scripts/Makefile.package:83: bindeb-pkg] Error 2
      make[1]: *** [Makefile:1558: bindeb-pkg] Error 2
      make: *** [Makefile:350: __build_one_by_one] Error 2
    
    The reason is because "make image_name" fails.
    
      $ make ARCH=mips CROSS_COMPILE=mips64-linux- image_name
      arch/mips/loongson2ef//Platform:36: *** only binutils >= 2.20.2 have needed option -mfix-loongson2f-nop.  Stop.
    
    In general, adding $(error ...) in the parse stage is troublesome,
    and it is pointless to check toolchains even if we are not building
    anything. Do not include Kbuild.platform in such cases.
    
    Fixes: 805b2e1d427a ("kbuild: include Makefile.compiler only when compiler is needed")
    Reported-by: Jason Self <jason@bluehome.net>
    Signed-off-by: Masahiro Yamada <masahiroy@kernel.org>
    Signed-off-by: Thomas Bogendoerfer <tsbogend@alpha.franken.de>
    Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>

commit eb63b768afca85740b7918d8f87cd5c9add710fc
Author: Jackie Liu <liuyun01@kylinos.cn>
Date:   Tue Sep 7 10:49:04 2021 +0800

    ar7: fix kernel builds for compiler test
    
    [ Upstream commit 28b7ee33a2122569ac065cad578bf23f50cc65c3 ]
    
    TI AR7 Watchdog Timer is only build for 32bit.
    
    Avoid error like:
    In file included from drivers/watchdog/ar7_wdt.c:29:
    ./arch/mips/include/asm/mach-ar7/ar7.h: In function ar7_is_titan:
    ./arch/mips/include/asm/mach-ar7/ar7.h:111:24: error: implicit declaration of function KSEG1ADDR; did you mean CKSEG1ADDR? [-Werror=implicit-function-declaration]
      111 |  return (readl((void *)KSEG1ADDR(AR7_REGS_GPIO + 0x24)) & 0xffff) ==
          |                        ^~~~~~~~~
          |                        CKSEG1ADDR
    
    Fixes: da2a68b3eb47 ("watchdog: Enable COMPILE_TEST where possible")
    Signed-off-by: Jackie Liu <liuyun01@kylinos.cn>
    Reviewed-by: Guenter Roeck <linux@roeck-us.net>
    Link: https://lore.kernel.org/r/20210907024904.4127611-1-liu.yun@linux.dev
    Signed-off-by: Guenter Roeck <linux@roeck-us.net>
    Signed-off-by: Wim Van Sebroeck <wim@linux-watchdog.org>
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit 77aa339ea59f131eefd6b9c62368973b093a721f
Author: Nick Desaulniers <ndesaulniers@google.com>
Date:   Tue Oct 19 15:36:45 2021 -0700

    arm64: vdso32: suppress error message for 'make mrproper'
    
    [ Upstream commit 14831fad73f5ac30ac61760487d95a538e6ab3cb ]
    
    When running the following command without arm-linux-gnueabi-gcc in
    one's $PATH, the following warning is observed:
    
    $ ARCH=arm64 CROSS_COMPILE_COMPAT=arm-linux-gnueabi- make -j72 LLVM=1 mrproper
    make[1]: arm-linux-gnueabi-gcc: No such file or directory
    
    This is because KCONFIG is not run for mrproper, so CONFIG_CC_IS_CLANG
    is not set, and we end up eagerly evaluating various variables that try
    to invoke CC_COMPAT.
    
    This is a similar problem to what was observed in
    commit dc960bfeedb0 ("h8300: suppress error messages for 'make clean'")
    
    Reported-by: Lucas Henneman <henneman@google.com>
    Suggested-by: Masahiro Yamada <masahiroy@kernel.org>
    Signed-off-by: Nick Desaulniers <ndesaulniers@google.com>
    Reviewed-by: Vincenzo Frascino <vincenzo.frascino@arm.com>
    Reviewed-by: Nathan Chancellor <nathan@kernel.org>
    Tested-by: Nathan Chancellor <nathan@kernel.org>
    Link: https://lore.kernel.org/r/20211019223646.1146945-4-ndesaulniers@google.com
    Signed-off-by: Will Deacon <will@kernel.org>
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit ba5eb0e44346fa672a34e661e6678d2d244383ec
Author: Jackie Liu <liuyun01@kylinos.cn>
Date:   Tue Sep 7 10:49:04 2021 +0800

    ar7: fix kernel builds for compiler test
    
    [ Upstream commit 28b7ee33a2122569ac065cad578bf23f50cc65c3 ]
    
    TI AR7 Watchdog Timer is only build for 32bit.
    
    Avoid error like:
    In file included from drivers/watchdog/ar7_wdt.c:29:
    ./arch/mips/include/asm/mach-ar7/ar7.h: In function ar7_is_titan:
    ./arch/mips/include/asm/mach-ar7/ar7.h:111:24: error: implicit declaration of function KSEG1ADDR; did you mean CKSEG1ADDR? [-Werror=implicit-function-declaration]
      111 |  return (readl((void *)KSEG1ADDR(AR7_REGS_GPIO + 0x24)) & 0xffff) ==
          |                        ^~~~~~~~~
          |                        CKSEG1ADDR
    
    Fixes: da2a68b3eb47 ("watchdog: Enable COMPILE_TEST where possible")
    Signed-off-by: Jackie Liu <liuyun01@kylinos.cn>
    Reviewed-by: Guenter Roeck <linux@roeck-us.net>
    Link: https://lore.kernel.org/r/20210907024904.4127611-1-liu.yun@linux.dev
    Signed-off-by: Guenter Roeck <linux@roeck-us.net>
    Signed-off-by: Wim Van Sebroeck <wim@linux-watchdog.org>
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit 4017b230c960c9d6c6a19e52bf3df01222dc7737
Author: Helge Deller <deller@gmx.de>
Date:   Tue Nov 16 13:12:21 2021 +0100

    parisc: Wrap assembler related defines inside __ASSEMBLY__
    
    Building allmodconfig shows errors in the gpu/drm/msm snapdragon drivers,
    because a COND() define is used there which conflicts with the COND() for
    PA-RISC assembly.  Although the snapdragon driver isn't relevant for parisc, it
    is nevertheless compiled when CONFIG_COMPILE_TEST is defined.
    
    Move the COND() define and other PA-RISC mnemonics inside the #ifdef
    __ASSEMBLY__ part to avoid this conflict.
    
    Signed-off-by: Helge Deller <deller@gmx.de>
    Reported-by: kernel test robot <lkp@intel.com>

commit bac37c7433c5d88c669d29427f393d1489dd7af8
Author: Jackie Liu <liuyun01@kylinos.cn>
Date:   Tue Sep 7 10:49:04 2021 +0800

    ar7: fix kernel builds for compiler test
    
    [ Upstream commit 28b7ee33a2122569ac065cad578bf23f50cc65c3 ]
    
    TI AR7 Watchdog Timer is only build for 32bit.
    
    Avoid error like:
    In file included from drivers/watchdog/ar7_wdt.c:29:
    ./arch/mips/include/asm/mach-ar7/ar7.h: In function ar7_is_titan:
    ./arch/mips/include/asm/mach-ar7/ar7.h:111:24: error: implicit declaration of function KSEG1ADDR; did you mean CKSEG1ADDR? [-Werror=implicit-function-declaration]
      111 |  return (readl((void *)KSEG1ADDR(AR7_REGS_GPIO + 0x24)) & 0xffff) ==
          |                        ^~~~~~~~~
          |                        CKSEG1ADDR
    
    Fixes: da2a68b3eb47 ("watchdog: Enable COMPILE_TEST where possible")
    Signed-off-by: Jackie Liu <liuyun01@kylinos.cn>
    Reviewed-by: Guenter Roeck <linux@roeck-us.net>
    Link: https://lore.kernel.org/r/20210907024904.4127611-1-liu.yun@linux.dev
    Signed-off-by: Guenter Roeck <linux@roeck-us.net>
    Signed-off-by: Wim Van Sebroeck <wim@linux-watchdog.org>
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit cff152d77d9bd12de1adcdbe0b1320941d6003dd
Author: Nick Desaulniers <ndesaulniers@google.com>
Date:   Tue Oct 19 15:36:45 2021 -0700

    arm64: vdso32: suppress error message for 'make mrproper'
    
    [ Upstream commit 14831fad73f5ac30ac61760487d95a538e6ab3cb ]
    
    When running the following command without arm-linux-gnueabi-gcc in
    one's $PATH, the following warning is observed:
    
    $ ARCH=arm64 CROSS_COMPILE_COMPAT=arm-linux-gnueabi- make -j72 LLVM=1 mrproper
    make[1]: arm-linux-gnueabi-gcc: No such file or directory
    
    This is because KCONFIG is not run for mrproper, so CONFIG_CC_IS_CLANG
    is not set, and we end up eagerly evaluating various variables that try
    to invoke CC_COMPAT.
    
    This is a similar problem to what was observed in
    commit dc960bfeedb0 ("h8300: suppress error messages for 'make clean'")
    
    Reported-by: Lucas Henneman <henneman@google.com>
    Suggested-by: Masahiro Yamada <masahiroy@kernel.org>
    Signed-off-by: Nick Desaulniers <ndesaulniers@google.com>
    Reviewed-by: Vincenzo Frascino <vincenzo.frascino@arm.com>
    Reviewed-by: Nathan Chancellor <nathan@kernel.org>
    Tested-by: Nathan Chancellor <nathan@kernel.org>
    Link: https://lore.kernel.org/r/20211019223646.1146945-4-ndesaulniers@google.com
    Signed-off-by: Will Deacon <will@kernel.org>
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit 9b180f3c2d9233ee2785370baf25137bd43d1bb1
Author: Jackie Liu <liuyun01@kylinos.cn>
Date:   Tue Sep 7 10:49:04 2021 +0800

    ar7: fix kernel builds for compiler test
    
    [ Upstream commit 28b7ee33a2122569ac065cad578bf23f50cc65c3 ]
    
    TI AR7 Watchdog Timer is only build for 32bit.
    
    Avoid error like:
    In file included from drivers/watchdog/ar7_wdt.c:29:
    ./arch/mips/include/asm/mach-ar7/ar7.h: In function ar7_is_titan:
    ./arch/mips/include/asm/mach-ar7/ar7.h:111:24: error: implicit declaration of function KSEG1ADDR; did you mean CKSEG1ADDR? [-Werror=implicit-function-declaration]
      111 |  return (readl((void *)KSEG1ADDR(AR7_REGS_GPIO + 0x24)) & 0xffff) ==
          |                        ^~~~~~~~~
          |                        CKSEG1ADDR
    
    Fixes: da2a68b3eb47 ("watchdog: Enable COMPILE_TEST where possible")
    Signed-off-by: Jackie Liu <liuyun01@kylinos.cn>
    Reviewed-by: Guenter Roeck <linux@roeck-us.net>
    Link: https://lore.kernel.org/r/20210907024904.4127611-1-liu.yun@linux.dev
    Signed-off-by: Guenter Roeck <linux@roeck-us.net>
    Signed-off-by: Wim Van Sebroeck <wim@linux-watchdog.org>
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit 60430d4c4eddcdf8eac2bdbec9704f84a436eedf
Author: Julian Braha <julianbraha@gmail.com>
Date:   Thu Oct 28 20:46:10 2021 -0400

    pinctrl: qcom: fix unmet dependencies on GPIOLIB for GPIOLIB_IRQCHIP
    
    When PINCTRL_QCOM_SPMI_PMIC or PINCTRL_QCOM_SSBI_PMIC
    is selected, and GPIOLIB is not selected, Kbuild
    gives the following warnings:
    
    WARNING: unmet direct dependencies detected for GPIOLIB_IRQCHIP
      Depends on [n]: GPIOLIB [=n]
      Selected by [y]:
      - PINCTRL_QCOM_SPMI_PMIC [=y] && PINCTRL [=y] && (ARCH_QCOM [=n] || COMPILE_TEST [=y]) && OF [=y] && SPMI [=y]
    
    WARNING: unmet direct dependencies detected for GPIOLIB_IRQCHIP
      Depends on [n]: GPIOLIB [=n]
      Selected by [y]:
      - PINCTRL_QCOM_SSBI_PMIC [=y] && PINCTRL [=y] && (ARCH_QCOM [=n] || COMPILE_TEST [=y]) && OF [=y]
    
    This is because these config options enable GPIOLIB_IRQCHIP
    without selecting or depending on GPIOLIB, despite
    GPIOLIB_IRQCHIP depending on GPIOLIB.
    
    These unmet dependency bugs were detected by Kismet,
    a static analysis tool for Kconfig. Please advise if this
    is not the appropriate solution.
    
    Signed-off-by: Julian Braha <julianbraha@gmail.com>
    Link: https://lore.kernel.org/r/20211029004610.35131-1-julianbraha@gmail.com
    Signed-off-by: Linus Walleij <linus.walleij@linaro.org>

commit bb162bb2b4394108c8f055d1b115735331205e28
Author: Julian Braha <julianbraha@gmail.com>
Date:   Mon Nov 8 22:23:51 2021 -0500

    drm/sun4i: fix unmet dependency on RESET_CONTROLLER for PHY_SUN6I_MIPI_DPHY
    
    When PHY_SUN6I_MIPI_DPHY is selected, and RESET_CONTROLLER
    is not selected, Kbuild gives the following warning:
    
    WARNING: unmet direct dependencies detected for PHY_SUN6I_MIPI_DPHY
      Depends on [n]: (ARCH_SUNXI [=n] || COMPILE_TEST [=y]) && HAS_IOMEM [=y] && COMMON_CLK [=y] && RESET_CONTROLLER [=n]
      Selected by [y]:
      - DRM_SUN6I_DSI [=y] && HAS_IOMEM [=y] && DRM_SUN4I [=y]
    
    This is because DRM_SUN6I_DSI selects PHY_SUN6I_MIPI_DPHY
    without selecting or depending on RESET_CONTROLLER, despite
    PHY_SUN6I_MIPI_DPHY depending on RESET_CONTROLLER.
    
    These unmet dependency bugs were detected by Kismet,
    a static analysis tool for Kconfig. Please advise if this
    is not the appropriate solution.
    
    v2:
    Fixed indentation to match the rest of the file.
    
    Signed-off-by: Julian Braha <julianbraha@gmail.com>
    Acked-by: Jernej Skrabec <jernej.skrabec@gmail.com>
    Signed-off-by: Maxime Ripard <maxime@cerno.tech>
    Link: https://patchwork.freedesktop.org/patch/msgid/20211109032351.43322-1-julianbraha@gmail.com

commit e4ac80ef8198636a23866a59575917550328886f
Author: Jean-Philippe Brucker <jean-philippe@linaro.org>
Date:   Fri Nov 12 15:51:30 2021 +0000

    tools/runqslower: Fix cross-build
    
    Commit be79505caf3f ("tools/runqslower: Install libbpf headers when
    building") uses the target libbpf to build the host bpftool, which
    doesn't work when cross-building:
    
      make ARCH=arm64 CROSS_COMPILE=aarch64-linux-gnu- -C tools/bpf/runqslower O=/tmp/runqslower
      ...
        LINK    /tmp/runqslower/bpftool/bpftool
      /usr/bin/ld: /tmp/runqslower/libbpf/libbpf.a(libbpf-in.o): Relocations in generic ELF (EM: 183)
      /usr/bin/ld: /tmp/runqslower/libbpf/libbpf.a: error adding symbols: file in wrong format
      collect2: error: ld returned 1 exit status
    
    When cross-building, the target architecture differs from the host. The
    bpftool used for building runqslower is executed on the host, and thus
    must use a different libbpf than that used for runqslower itself.
    Remove the LIBBPF_OUTPUT and LIBBPF_DESTDIR parameters, so the bpftool
    build makes its own library if necessary.
    
    In the selftests, pass the host bpftool, already a prerequisite for the
    runqslower recipe, as BPFTOOL_OUTPUT. The runqslower Makefile will use
    the bpftool that's already built for selftests instead of making a new
    one.
    
    Fixes: be79505caf3f ("tools/runqslower: Install libbpf headers when building")
    Signed-off-by: Jean-Philippe Brucker <jean-philippe@linaro.org>
    Signed-off-by: Daniel Borkmann <daniel@iogearbox.net>
    Reviewed-by: Quentin Monnet <quentin@isovalent.com>
    Link: https://lore.kernel.org/bpf/20211112155128.565680-1-jean-philippe@linaro.org
    Signed-off-by: Alexei Starovoitov <ast@kernel.org>

commit 0706f74f719e6e72c3a862ab2990796578fa73cc
Author: Masahiro Yamada <masahiroy@kernel.org>
Date:   Wed Nov 10 00:01:45 2021 +0900

    MIPS: fix *-pkg builds for loongson2ef platform
    
    Since commit 805b2e1d427a ("kbuild: include Makefile.compiler only when
    compiler is needed"), package builds for the loongson2f platform fail.
    
      $ make ARCH=mips CROSS_COMPILE=mips64-linux- lemote2f_defconfig bindeb-pkg
        [ snip ]
      sh ./scripts/package/builddeb
      arch/mips/loongson2ef//Platform:36: *** only binutils >= 2.20.2 have needed option -mfix-loongson2f-nop.  Stop.
      cp: cannot stat '': No such file or directory
      make[5]: *** [scripts/Makefile.package:87: intdeb-pkg] Error 1
      make[4]: *** [Makefile:1558: intdeb-pkg] Error 2
      make[3]: *** [debian/rules:13: binary-arch] Error 2
      dpkg-buildpackage: error: debian/rules binary subprocess returned exit status 2
      make[2]: *** [scripts/Makefile.package:83: bindeb-pkg] Error 2
      make[1]: *** [Makefile:1558: bindeb-pkg] Error 2
      make: *** [Makefile:350: __build_one_by_one] Error 2
    
    The reason is because "make image_name" fails.
    
      $ make ARCH=mips CROSS_COMPILE=mips64-linux- image_name
      arch/mips/loongson2ef//Platform:36: *** only binutils >= 2.20.2 have needed option -mfix-loongson2f-nop.  Stop.
    
    In general, adding $(error ...) in the parse stage is troublesome,
    and it is pointless to check toolchains even if we are not building
    anything. Do not include Kbuild.platform in such cases.
    
    Fixes: 805b2e1d427a ("kbuild: include Makefile.compiler only when compiler is needed")
    Reported-by: Jason Self <jason@bluehome.net>
    Signed-off-by: Masahiro Yamada <masahiroy@kernel.org>
    Signed-off-by: Thomas Bogendoerfer <tsbogend@alpha.franken.de>

commit 75e2f715dffcf0cadedf49f2f3692bdd33fdd889
Author: weidonghui <weidonghui@allwinnertech.com>
Date:   Fri Nov 5 13:34:42 2021 -0700

    scripts/decodecode: fix faulting instruction no print when opps.file is DOS format
    
    If opps.file is in DOS format, faulting instruction cannot be printed:
    
      / # ARCH=arm64 CROSS_COMPILE=aarch64-linux-gnu-
      / # ./scripts/decodecode < oops.file
      [ 0.734345] Code: d0002881 912f9c21 94067e68 d2800001 (b900003f)
      aarch64-linux-gnu-strip: '/tmp/tmp.5Y9eybnnSi.o': No such file
      aarch64-linux-gnu-objdump: '/tmp/tmp.5Y9eybnnSi.o': No such file
      All code
      ========
         0:   d0002881        adrp    x1, 0x512000
         4:   912f9c21        add     x1, x1, #0xbe7
         8:   94067e68        bl      0x19f9a8
         c:   d2800001        mov     x1, #0x0                        // #0
        10:   b900003f        str     wzr, [x1]
    
      Code starting with the faulting instruction
      ===========================================
    
    Background: The compilation environment is Ubuntu, and the test
    environment is Windows.  Most logs are generated in the Windows
    environment.  In this way, CR (carriage return) will inevitably appear,
    which will affect the use of decodecode in the Ubuntu environment.
    
    The repaired effect is as follows:
    
      / # ARCH=arm64 CROSS_COMPILE=aarch64-linux-gnu-
      / # ./scripts/decodecode < oops.file
      [ 0.734345] Code: d0002881 912f9c21 94067e68 d2800001 (b900003f)
      All code
      ========
         0:   d0002881        adrp    x1, 0x512000
         4:   912f9c21        add     x1, x1, #0xbe7
         8:   94067e68        bl      0x19f9a8
         c:   d2800001        mov     x1, #0x0                        // #0
        10:*  b900003f        str     wzr, [x1]               <-- trapping instruction
    
      Code starting with the faulting instruction
      ===========================================
         0:   b900003f        str     wzr, [x1]
    
    Link: https://lkml.kernel.org/r/20211008064712.926-1-weidonghui@allwinnertech.com
    Signed-off-by: weidonghui <weidonghui@allwinnertech.com>
    Acked-by: Borislav Petkov <bp@suse.de>
    Cc: Marc Zyngier <maz@misterjones.org>
    Cc: Will Deacon <will@kernel.org>
    Cc: Rabin Vincent <rabin@rab.in>
    Signed-off-by: Andrew Morton <akpm@linux-foundation.org>
    Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>

commit 56d33754481fe0dc7436dc4ee4fbd44b3039361d
Merge: 464fddbba1df d9bd054177fb
Author: Linus Torvalds <torvalds@linux-foundation.org>
Date:   Tue Nov 2 16:47:49 2021 -0700

    Merge tag 'drm-next-2021-11-03' of git://anongit.freedesktop.org/drm/drm
    
    Pull drm updates from Dave Airlie:
     "Summary below. i915 starts to add support for DG2 GPUs, enables DG1
      and ADL-S support by default, lots of work to enable DisplayPort 2.0
      across drivers. Lots of documentation updates and fixes across the
      board.
    
      core:
       - improve dma_fence, lease and resv documentation
       - shmem-helpers: allocate WC pages on x86, use vmf_insert_pin
       - sched fixes/improvements
       - allow empty drm leases
       - add dma resv iterator
       - add more DP 2.0 headers
       - DP MST helper improvements for DP2.0
    
      dma-buf:
       - avoid warnings, remove fence trace macros
    
      bridge:
       - new helper to get rid of panels
       - probe improvements for it66121
       - enable DSI EOTP for anx7625
    
      fbdev:
       - efifb: release runtime PM on destroy
    
      ttm:
       - kerneldoc switch
       - helper to clear all DMA mappings
       - pool shrinker optimizaton
       - remove ttm_tt_destroy_common
       - update ttm_move_memcpy for async use
    
      panel:
       - add new panel-edp driver
    
      amdgpu:
       - Initial DP 2.0 support
       - Initial USB4 DP tunnelling support
       - Aldebaran MCE support
       - Modifier support for DCC image stores for GFX 10.3
       - Display rework for better FP code handling
       - Yellow Carp/Cyan Skillfish updates
       - Cyan Skillfish display support
       - convert vega/navi to IP discovery asic enumeration
       - validate IP discovery table
       - RAS improvements
       - Lots of fixes
    
      i915:
       - DG1 PCI IDs + LMEM discovery/placement
       - DG1 GuC submission by default
       - ADL-S PCI IDs updated + enabled by default
       - ADL-P (XE_LPD) fixed and updates
       - DG2 display fixes
       - PXP protected object support for Gen12 integrated
       - expose multi-LRC submission interface for GuC
       - export logical engine instance to user
       - Disable engine bonding on Gen12+
       - PSR cleanup
       - PSR2 selective fetch by default
       - DP 2.0 prep work
       - VESA vendor block + MSO use of it
       - FBC refactor
       - try again to fix fast-narrow vs slow-wide eDP training
       - use THP when IOMMU enabled
       - LMEM backup/restore for suspend/resume
       - locking simplification
       - GuC major reworking
       - async flip VT-D workaround changes
       - DP link training improvements
       - misc display refactorings
    
      bochs:
       - new PCI ID
    
      rcar-du:
       - Non-contiguious buffer import support for rcar-du
       - r8a779a0 support prep
    
      omapdrm:
       - COMPILE_TEST fixes
    
      sti:
       - COMPILE_TEST fixes
    
      msm:
       - fence ordering improvements
       - eDP support in DP sub-driver
       - dpu irq handling cleanup
       - CRC support for making igt happy
       - NO_CONNECTOR bridge support
       - dsi: 14nm phy support for msm8953
       - mdp5: msm8x53, sdm450, sdm632 support
    
      stm:
       - layer alpha + zpo support
    
      v3d:
       - fix Vulkan CTS failure
       - support multiple sync objects
    
      gud:
       - add R8/RGB332/RGB888 pixel formats
    
      vc4:
       - convert to new bridge helpers
    
      vgem:
       - use shmem helpers
    
      virtio:
       - support mapping exported vram
    
      zte:
       - remove obsolete driver
    
      rockchip:
       - use bridge attach no connector for LVDS/RGB"
    
    * tag 'drm-next-2021-11-03' of git://anongit.freedesktop.org/drm/drm: (1259 commits)
      drm/amdgpu/gmc6: fix DMA mask from 44 to 40 bits
      drm/amd/display: MST support for DPIA
      drm/amdgpu: Fix even more out of bound writes from debugfs
      drm/amdgpu/discovery: add SDMA IP instance info for soc15 parts
      drm/amdgpu/discovery: add UVD/VCN IP instance info for soc15 parts
      drm/amdgpu/UAPI: rearrange header to better align related items
      drm/amd/display: Enable dpia in dmub only for DCN31 B0
      drm/amd/display: Fix USB4 hot plug crash issue
      drm/amd/display: Fix deadlock when falling back to v2 from v3
      drm/amd/display: Fallback to clocks which meet requested voltage on DCN31
      drm/amd/display: move FPU associated DCN301 code to DML folder
      drm/amd/display: fix link training regression for 1 or 2 lane
      drm/amd/display: add two lane settings training options
      drm/amd/display: decouple hw_lane_settings from dpcd_lane_settings
      drm/amd/display: implement decide lane settings
      drm/amd/display: adopt DP2.0 LT SCR revision 8
      drm/amd/display: FEC configuration for dpia links in MST mode
      drm/amd/display: FEC configuration for dpia links
      drm/amd/display: Add workaround flag for EDID read on certain docks
      drm/amd/display: Set phy_mux_sel bit in dmub scratch register
      ...

commit 960f4a54b909c090c44a4dc7d487279fe7271a09
Author: Guenter Roeck <linux@roeck-us.net>
Date:   Wed Oct 20 12:11:16 2021 -0700

    nios2: Make NIOS2_DTB_SOURCE_BOOL depend on !COMPILE_TEST
    
    commit 4a089e95b4d6bb625044d47aed0c442a8f7bd093 upstream.
    
    nios2:allmodconfig builds fail with
    
    make[1]: *** No rule to make target 'arch/nios2/boot/dts/""',
            needed by 'arch/nios2/boot/dts/built-in.a'.  Stop.
    make: [Makefile:1868: arch/nios2/boot/dts] Error 2 (ignored)
    
    This is seen with compile tests since those enable NIOS2_DTB_SOURCE_BOOL,
    which in turn enables NIOS2_DTB_SOURCE. This causes the build error
    because the default value for NIOS2_DTB_SOURCE is an empty string.
    Disable NIOS2_DTB_SOURCE_BOOL for compile tests to avoid the error.
    
    Fixes: 2fc8483fdcde ("nios2: Build infrastructure")
    Signed-off-by: Guenter Roeck <linux@roeck-us.net>
    Reviewed-by: Randy Dunlap <rdunlap@infradead.org>
    Signed-off-by: Dinh Nguyen <dinguyen@kernel.org>
    Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>

commit 351d0f587b4c3346485dd7b5e0268d66ab59de27
Author: Arnd Bergmann <arnd@arndb.de>
Date:   Mon Oct 18 15:30:37 2021 +0100

    ARM: 9141/1: only warn about XIP address when not compile testing
    
    commit 48ccc8edf5b90622cdc4f8878e0042ab5883e2ca upstream.
    
    In randconfig builds, we sometimes come across this warning:
    
    arm-linux-gnueabi-ld: XIP start address may cause MPU programming issues
    
    While this is helpful for actual systems to figure out why it
    fails, the warning does not provide any benefit for build testing,
    so guard it in a check for CONFIG_COMPILE_TEST, which is usually
    set on randconfig builds.
    
    Fixes: 216218308cfb ("ARM: 8713/1: NOMMU: Support MPU in XIP configuration")
    Signed-off-by: Arnd Bergmann <arnd@arndb.de>
    Signed-off-by: Russell King (Oracle) <rmk+kernel@armlinux.org.uk>
    Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>

commit be98be1a17e9502321889b2142b5cba4aec7e087
Author: Guenter Roeck <linux@roeck-us.net>
Date:   Wed Oct 20 12:11:16 2021 -0700

    nios2: Make NIOS2_DTB_SOURCE_BOOL depend on !COMPILE_TEST
    
    commit 4a089e95b4d6bb625044d47aed0c442a8f7bd093 upstream.
    
    nios2:allmodconfig builds fail with
    
    make[1]: *** No rule to make target 'arch/nios2/boot/dts/""',
            needed by 'arch/nios2/boot/dts/built-in.a'.  Stop.
    make: [Makefile:1868: arch/nios2/boot/dts] Error 2 (ignored)
    
    This is seen with compile tests since those enable NIOS2_DTB_SOURCE_BOOL,
    which in turn enables NIOS2_DTB_SOURCE. This causes the build error
    because the default value for NIOS2_DTB_SOURCE is an empty string.
    Disable NIOS2_DTB_SOURCE_BOOL for compile tests to avoid the error.
    
    Fixes: 2fc8483fdcde ("nios2: Build infrastructure")
    Signed-off-by: Guenter Roeck <linux@roeck-us.net>
    Reviewed-by: Randy Dunlap <rdunlap@infradead.org>
    Signed-off-by: Dinh Nguyen <dinguyen@kernel.org>
    Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>

commit 5a768b4d3e1a3eda23b8c5690645fde2bcff910a
Author: Arnd Bergmann <arnd@arndb.de>
Date:   Mon Oct 18 15:30:37 2021 +0100

    ARM: 9141/1: only warn about XIP address when not compile testing
    
    commit 48ccc8edf5b90622cdc4f8878e0042ab5883e2ca upstream.
    
    In randconfig builds, we sometimes come across this warning:
    
    arm-linux-gnueabi-ld: XIP start address may cause MPU programming issues
    
    While this is helpful for actual systems to figure out why it
    fails, the warning does not provide any benefit for build testing,
    so guard it in a check for CONFIG_COMPILE_TEST, which is usually
    set on randconfig builds.
    
    Fixes: 216218308cfb ("ARM: 8713/1: NOMMU: Support MPU in XIP configuration")
    Signed-off-by: Arnd Bergmann <arnd@arndb.de>
    Signed-off-by: Russell King (Oracle) <rmk+kernel@armlinux.org.uk>
    Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>

commit 3708aa267d670e33124823d1c801c33588b2b9d9
Author: Guenter Roeck <linux@roeck-us.net>
Date:   Wed Oct 20 12:11:16 2021 -0700

    nios2: Make NIOS2_DTB_SOURCE_BOOL depend on !COMPILE_TEST
    
    commit 4a089e95b4d6bb625044d47aed0c442a8f7bd093 upstream.
    
    nios2:allmodconfig builds fail with
    
    make[1]: *** No rule to make target 'arch/nios2/boot/dts/""',
            needed by 'arch/nios2/boot/dts/built-in.a'.  Stop.
    make: [Makefile:1868: arch/nios2/boot/dts] Error 2 (ignored)
    
    This is seen with compile tests since those enable NIOS2_DTB_SOURCE_BOOL,
    which in turn enables NIOS2_DTB_SOURCE. This causes the build error
    because the default value for NIOS2_DTB_SOURCE is an empty string.
    Disable NIOS2_DTB_SOURCE_BOOL for compile tests to avoid the error.
    
    Fixes: 2fc8483fdcde ("nios2: Build infrastructure")
    Signed-off-by: Guenter Roeck <linux@roeck-us.net>
    Reviewed-by: Randy Dunlap <rdunlap@infradead.org>
    Signed-off-by: Dinh Nguyen <dinguyen@kernel.org>
    Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>

commit ca10ddbbabd0089916d7f43b49418e2d1f592d49
Author: Arnd Bergmann <arnd@arndb.de>
Date:   Mon Oct 18 15:30:37 2021 +0100

    ARM: 9141/1: only warn about XIP address when not compile testing
    
    commit 48ccc8edf5b90622cdc4f8878e0042ab5883e2ca upstream.
    
    In randconfig builds, we sometimes come across this warning:
    
    arm-linux-gnueabi-ld: XIP start address may cause MPU programming issues
    
    While this is helpful for actual systems to figure out why it
    fails, the warning does not provide any benefit for build testing,
    so guard it in a check for CONFIG_COMPILE_TEST, which is usually
    set on randconfig builds.
    
    Fixes: 216218308cfb ("ARM: 8713/1: NOMMU: Support MPU in XIP configuration")
    Signed-off-by: Arnd Bergmann <arnd@arndb.de>
    Signed-off-by: Russell King (Oracle) <rmk+kernel@armlinux.org.uk>
    Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>

commit 25d852a8adf017a478246d19c8b282e975521e8a
Author: Guenter Roeck <linux@roeck-us.net>
Date:   Wed Oct 20 12:11:16 2021 -0700

    nios2: Make NIOS2_DTB_SOURCE_BOOL depend on !COMPILE_TEST
    
    commit 4a089e95b4d6bb625044d47aed0c442a8f7bd093 upstream.
    
    nios2:allmodconfig builds fail with
    
    make[1]: *** No rule to make target 'arch/nios2/boot/dts/""',
            needed by 'arch/nios2/boot/dts/built-in.a'.  Stop.
    make: [Makefile:1868: arch/nios2/boot/dts] Error 2 (ignored)
    
    This is seen with compile tests since those enable NIOS2_DTB_SOURCE_BOOL,
    which in turn enables NIOS2_DTB_SOURCE. This causes the build error
    because the default value for NIOS2_DTB_SOURCE is an empty string.
    Disable NIOS2_DTB_SOURCE_BOOL for compile tests to avoid the error.
    
    Fixes: 2fc8483fdcde ("nios2: Build infrastructure")
    Signed-off-by: Guenter Roeck <linux@roeck-us.net>
    Reviewed-by: Randy Dunlap <rdunlap@infradead.org>
    Signed-off-by: Dinh Nguyen <dinguyen@kernel.org>
    Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>

commit 901741a53d7cf45be861e881c0e3cba5b4bd1f94
Author: Arnd Bergmann <arnd@arndb.de>
Date:   Mon Oct 18 15:30:37 2021 +0100

    ARM: 9141/1: only warn about XIP address when not compile testing
    
    commit 48ccc8edf5b90622cdc4f8878e0042ab5883e2ca upstream.
    
    In randconfig builds, we sometimes come across this warning:
    
    arm-linux-gnueabi-ld: XIP start address may cause MPU programming issues
    
    While this is helpful for actual systems to figure out why it
    fails, the warning does not provide any benefit for build testing,
    so guard it in a check for CONFIG_COMPILE_TEST, which is usually
    set on randconfig builds.
    
    Fixes: 216218308cfb ("ARM: 8713/1: NOMMU: Support MPU in XIP configuration")
    Signed-off-by: Arnd Bergmann <arnd@arndb.de>
    Signed-off-by: Russell King (Oracle) <rmk+kernel@armlinux.org.uk>
    Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>

commit f93ecbdf17cbf99d62dfdee9636fd3cdf9789487
Author: Guenter Roeck <linux@roeck-us.net>
Date:   Wed Oct 20 12:11:16 2021 -0700

    nios2: Make NIOS2_DTB_SOURCE_BOOL depend on !COMPILE_TEST
    
    commit 4a089e95b4d6bb625044d47aed0c442a8f7bd093 upstream.
    
    nios2:allmodconfig builds fail with
    
    make[1]: *** No rule to make target 'arch/nios2/boot/dts/""',
            needed by 'arch/nios2/boot/dts/built-in.a'.  Stop.
    make: [Makefile:1868: arch/nios2/boot/dts] Error 2 (ignored)
    
    This is seen with compile tests since those enable NIOS2_DTB_SOURCE_BOOL,
    which in turn enables NIOS2_DTB_SOURCE. This causes the build error
    because the default value for NIOS2_DTB_SOURCE is an empty string.
    Disable NIOS2_DTB_SOURCE_BOOL for compile tests to avoid the error.
    
    Fixes: 2fc8483fdcde ("nios2: Build infrastructure")
    Signed-off-by: Guenter Roeck <linux@roeck-us.net>
    Reviewed-by: Randy Dunlap <rdunlap@infradead.org>
    Signed-off-by: Dinh Nguyen <dinguyen@kernel.org>
    Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>

commit 06ccfe9b31ea0cd512d6da8bb45087986ae0f0f5
Author: Guenter Roeck <linux@roeck-us.net>
Date:   Wed Oct 20 12:11:16 2021 -0700

    nios2: Make NIOS2_DTB_SOURCE_BOOL depend on !COMPILE_TEST
    
    commit 4a089e95b4d6bb625044d47aed0c442a8f7bd093 upstream.
    
    nios2:allmodconfig builds fail with
    
    make[1]: *** No rule to make target 'arch/nios2/boot/dts/""',
            needed by 'arch/nios2/boot/dts/built-in.a'.  Stop.
    make: [Makefile:1868: arch/nios2/boot/dts] Error 2 (ignored)
    
    This is seen with compile tests since those enable NIOS2_DTB_SOURCE_BOOL,
    which in turn enables NIOS2_DTB_SOURCE. This causes the build error
    because the default value for NIOS2_DTB_SOURCE is an empty string.
    Disable NIOS2_DTB_SOURCE_BOOL for compile tests to avoid the error.
    
    Fixes: 2fc8483fdcde ("nios2: Build infrastructure")
    Signed-off-by: Guenter Roeck <linux@roeck-us.net>
    Reviewed-by: Randy Dunlap <rdunlap@infradead.org>
    Signed-off-by: Dinh Nguyen <dinguyen@kernel.org>
    Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>

commit d4ba730c0dcaa5f5baf27fd6d635719cc2134b4f
Author: Guenter Roeck <linux@roeck-us.net>
Date:   Wed Oct 20 12:11:16 2021 -0700

    nios2: Make NIOS2_DTB_SOURCE_BOOL depend on !COMPILE_TEST
    
    commit 4a089e95b4d6bb625044d47aed0c442a8f7bd093 upstream.
    
    nios2:allmodconfig builds fail with
    
    make[1]: *** No rule to make target 'arch/nios2/boot/dts/""',
            needed by 'arch/nios2/boot/dts/built-in.a'.  Stop.
    make: [Makefile:1868: arch/nios2/boot/dts] Error 2 (ignored)
    
    This is seen with compile tests since those enable NIOS2_DTB_SOURCE_BOOL,
    which in turn enables NIOS2_DTB_SOURCE. This causes the build error
    because the default value for NIOS2_DTB_SOURCE is an empty string.
    Disable NIOS2_DTB_SOURCE_BOOL for compile tests to avoid the error.
    
    Fixes: 2fc8483fdcde ("nios2: Build infrastructure")
    Signed-off-by: Guenter Roeck <linux@roeck-us.net>
    Reviewed-by: Randy Dunlap <rdunlap@infradead.org>
    Signed-off-by: Dinh Nguyen <dinguyen@kernel.org>
    Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>

commit ad98a9246616e736504d1ebc2f3f35c2c0dcb806
Merge: 49f8275c7d92 7eba41fe8c7b
Author: Linus Torvalds <torvalds@linux-foundation.org>
Date:   Mon Nov 1 09:02:15 2021 -0700

    Merge tag 'tpmdd-next-v5.16' of git://git.kernel.org/pub/scm/linux/kernel/git/jarkko/linux-tpmdd
    
    Pull tpm updates from Jarkko Sakkinen:
     "Only bug fixes"
    
    * tag 'tpmdd-next-v5.16' of git://git.kernel.org/pub/scm/linux/kernel/git/jarkko/linux-tpmdd:
      tpm_tis_spi: Add missing SPI ID
      tpm: fix Atmel TPM crash caused by too frequent queries
      tpm: Check for integer overflow in tpm2_map_response_body()
      tpm: tis: Kconfig: Add helper dependency on COMPILE_TEST

commit 61a9f252c1c026f84129a7bfa476e880b75e80eb
Author: Martin K. Petersen <martin.petersen@oracle.com>
Date:   Wed Oct 27 23:42:02 2021 -0400

    scsi: mpt3sas: Fix reference tag handling for WRITE_INSERT
    
    Testing revealed a problem with how the reference tag was handled for
    a WRITE_INSERT operation. The SCSI_PROT_REF_CHECK flag is not set when
    the controller is asked to generate the protection information
    (i.e. not DIX). And as a result the initial reference tag would not be
    set in the WRITE_INSERT case.
    
    Separate handling of the REF_CHECK and REF_INCREMENT flags to align
    with both the DIX spec and the MPI implementation.
    
    Link: https://lore.kernel.org/r/20211028034202.24225-1-martin.petersen@oracle.com
    Fixes: b3e2c72af1d5 ("scsi: mpt3sas: Use the proper SCSI midlayer interfaces for PI")
    Signed-off-by: Martin K. Petersen <martin.petersen@oracle.com>

commit b2909a447ec3f3713b142bf8592733f51e4661fc
Merge: e5f521021279 3e6f8d1fa184
Author: Will Deacon <will@kernel.org>
Date:   Fri Oct 29 12:25:38 2021 +0100

    Merge branch 'for-next/vdso' into for-next/core
    
    * for-next/vdso:
      arm64: vdso32: require CROSS_COMPILE_COMPAT for gcc+bfd
      arm64: vdso32: suppress error message for 'make mrproper'
      arm64: vdso32: drop test for -march=armv8-a
      arm64: vdso32: drop the test for dmb ishld

commit 11e45471abea1a69dc3a92b1d1632c4d628b3b98
Merge: 5f5739d5f736 837d7a8fe852
Author: Marc Zyngier <maz@kernel.org>
Date:   Thu Oct 28 21:11:34 2021 +0100

    Merge branch irq/misc-5.16 into irq/irqchip-next
    
    * irq/misc-5.16:
      : .
      : Misc irqchip fixes for 5.16:
      : - MAINTAINERS update for the ARM VIC DT binding
      : - Allow drivers using the IRQCHIP_PLATFORM_DRIVER_BEGIN/END
      :   infrastructure to use COMPILE_TEST without CONFIG_OF
      : - DT updates
      : - Detangle h8300 linux/irqchip.h inclusion
      : .
      h8300: Fix linux/irqchip.h include mess
      dt-bindings: irqchip: renesas-irqc: Document r8a774e1 bindings
      irqchip: Fix compile-testing without CONFIG_OF
      MAINTAINERS: update arm,vic.yaml reference
    
    Signed-off-by: Marc Zyngier <maz@kernel.org>

commit 561ced0bb90a4be298b7db5fb54f29731d74a3f6
Author: Suzuki K Poulose <suzuki.poulose@arm.com>
Date:   Tue Oct 19 17:31:53 2021 +0100

    arm64: errata: Enable TRBE workaround for write to out-of-range address
    
    With the TRBE driver workaround available, enable the config symbols
    to be built without COMPILE_TEST
    
    Cc: Catalin Marinas <catalin.marinas@arm.com>
    Cc: Will Deacon <will@kernel.org>
    Reviewed-by: Anshuman Khandual <anshuman.khandual@arm.com>
    Acked-by: Will Deacon <will@kernel.org>
    Signed-off-by: Suzuki K Poulose <suzuki.poulose@arm.com>
    Link: https://lore.kernel.org/r/20211019163153.3692640-16-suzuki.poulose@arm.com
    Signed-off-by: Mathieu Poirier <mathieu.poirier@linaro.org>

commit 74b2740f57cc161297b800ecb0e1e549d13c3bb9
Author: Suzuki K Poulose <suzuki.poulose@arm.com>
Date:   Tue Oct 19 17:31:52 2021 +0100

    arm64: errata: Enable workaround for TRBE overwrite in FILL mode
    
    With the workaround enabled in TRBE, enable the config entries
    to be built without COMPILE_TEST
    
    Cc: Catalin Marinas <catalin.marinas@arm.com>
    Cc: Will Deacon <will@kernel.org>
    Reviewed-by: Anshuman Khandual <anshuman.khandual@arm.com>
    Acked-by: Will Deacon <will@kernel.org>
    Signed-off-by: Suzuki K Poulose <suzuki.poulose@arm.com>
    Link: https://lore.kernel.org/r/20211019163153.3692640-15-suzuki.poulose@arm.com
    Signed-off-by: Mathieu Poirier <mathieu.poirier@linaro.org>

commit 646b0de5fe32306eaf5399647adf2177d4417021
Merge: ab2aa486f48c 4a089e95b4d6
Author: Linus Torvalds <torvalds@linux-foundation.org>
Date:   Wed Oct 27 10:19:43 2021 -0700

    Merge tag 'nios2_fixes_for_v5.15_part3' of git://git.kernel.org/pub/scm/linux/kernel/git/dinguyen/linux
    
    Pull nios2 fix from Dinh Nguyen:
     "Fix a build error for allmodconfig"
    
    * tag 'nios2_fixes_for_v5.15_part3' of git://git.kernel.org/pub/scm/linux/kernel/git/dinguyen/linux:
      nios2: Make NIOS2_DTB_SOURCE_BOOL depend on !COMPILE_TEST

commit 4a089e95b4d6bb625044d47aed0c442a8f7bd093
Author: Guenter Roeck <linux@roeck-us.net>
Date:   Wed Oct 20 12:11:16 2021 -0700

    nios2: Make NIOS2_DTB_SOURCE_BOOL depend on !COMPILE_TEST
    
    nios2:allmodconfig builds fail with
    
    make[1]: *** No rule to make target 'arch/nios2/boot/dts/""',
            needed by 'arch/nios2/boot/dts/built-in.a'.  Stop.
    make: [Makefile:1868: arch/nios2/boot/dts] Error 2 (ignored)
    
    This is seen with compile tests since those enable NIOS2_DTB_SOURCE_BOOL,
    which in turn enables NIOS2_DTB_SOURCE. This causes the build error
    because the default value for NIOS2_DTB_SOURCE is an empty string.
    Disable NIOS2_DTB_SOURCE_BOOL for compile tests to avoid the error.
    
    Fixes: 2fc8483fdcde ("nios2: Build infrastructure")
    Signed-off-by: Guenter Roeck <linux@roeck-us.net>
    Reviewed-by: Randy Dunlap <rdunlap@infradead.org>
    Signed-off-by: Dinh Nguyen <dinguyen@kernel.org>

commit 28b7ee33a2122569ac065cad578bf23f50cc65c3
Author: Jackie Liu <liuyun01@kylinos.cn>
Date:   Tue Sep 7 10:49:04 2021 +0800

    ar7: fix kernel builds for compiler test
    
    TI AR7 Watchdog Timer is only build for 32bit.
    
    Avoid error like:
    In file included from drivers/watchdog/ar7_wdt.c:29:
    ./arch/mips/include/asm/mach-ar7/ar7.h: In function ar7_is_titan:
    ./arch/mips/include/asm/mach-ar7/ar7.h:111:24: error: implicit declaration of function KSEG1ADDR; did you mean CKSEG1ADDR? [-Werror=implicit-function-declaration]
      111 |  return (readl((void *)KSEG1ADDR(AR7_REGS_GPIO + 0x24)) & 0xffff) ==
          |                        ^~~~~~~~~
          |                        CKSEG1ADDR
    
    Fixes: da2a68b3eb47 ("watchdog: Enable COMPILE_TEST where possible")
    Signed-off-by: Jackie Liu <liuyun01@kylinos.cn>
    Reviewed-by: Guenter Roeck <linux@roeck-us.net>
    Link: https://lore.kernel.org/r/20210907024904.4127611-1-liu.yun@linux.dev
    Signed-off-by: Guenter Roeck <linux@roeck-us.net>
    Signed-off-by: Wim Van Sebroeck <wim@linux-watchdog.org>

commit 4f22aa4569e55131d69dae87e76869070d62c392
Author: Arnd Bergmann <arnd@arndb.de>
Date:   Tue Oct 19 17:42:02 2021 +0200

    qcom: spm: allow compile-testing
    
    ARM_QCOM_SPM_CPUIDLE can be selected when compile-testing on
    other architectures, but this causes a Kconfig warning
    for QCOM_SPM:
    
    WARNING: unmet direct dependencies detected for QCOM_SPM
      Depends on [n]: ARCH_QCOM [=n]
      Selected by [y]:
      - ARM_QCOM_SPM_CPUIDLE [=y] && CPU_IDLE [=y] && (ARM [=y] || ARM64) && (ARCH_QCOM [=n] || COMPILE_TEST [=y]) && !ARM64 && MMU [=y]
    
    Make it possible to also compile-test this one, which can
    be done now that v5.15-rc5 lets you select QCOM_SCM everywhere.
    
    Fixes: a871be6b8eee ("cpuidle: Convert Qualcomm SPM driver to a generic CPUidle driver")
    Fixes: 498ba2a8a275 ("cpuidle: Fix ARM_QCOM_SPM_CPUIDLE configuration")
    Reviewed-by: Stephen Boyd <swboyd@chromium.org>
    Signed-off-by: Arnd Bergmann <arnd@arndb.de>

commit 4091c004283bc65d2478fbfc9f2521fcb5af1f96
Author: Cai Huoqing <caihuoqing@baidu.com>
Date:   Thu Aug 26 09:10:12 2021 +0800

    tpm: tis: Kconfig: Add helper dependency on COMPILE_TEST
    
    COMPILE_TEST is helpful to find compilation errors in other platform(e.g.X86).
    In this case, the support of COMPILE_TEST is added, so this module could
    be compiled in other platform(e.g.X86), without ARCH_SYNQUACER configuration.
    
    Signed-off-by: Cai Huoqing <caihuoqing@baidu.com>
    Reviewed-by: Jarkko Sakkinen <jarkko@kernel.org>
    Signed-off-by: Jarkko Sakkinen <jarkko@kernel.org>

commit c50031f03dfe1c1462f326973ddc5f0db839fb68
Author: Bjorn Andersson <bjorn.andersson@linaro.org>
Date:   Sun Oct 24 19:58:16 2021 -0700

    firmware: qcom: scm: Don't break compile test on non-ARM platforms
    
    The introduction of __qcom_scm_set_boot_addr_mc() relies on
    cpu_logical_map() and MPIDR_AFFINITY_LEVEL() from smp_plat.h, but only
    ARM and ARM64 has this include file, so the introduction of this
    dependency broke compile testing on e.g. x86_64.
    
    Make the inclusion of smp_plat.h and the affected function depend on
    ARM || ARM64 to allow the code to still be compiled.
    
    Fixes: 55845f46df03 ("firmware: qcom: scm: Add support for MC boot address API")
    Signed-off-by: Bjorn Andersson <bjorn.andersson@linaro.org>
    Link: https://lore.kernel.org/r/20211025025816.2937465-1-bjorn.andersson@linaro.org

commit 336fe1d6c218502af526819507bb710504e0a993
Author: Arnd Bergmann <arnd@arndb.de>
Date:   Mon Oct 18 15:30:10 2021 +0100

    ARM: 9140/1: allow compile-testing without machine record
    
    A lot of randconfig builds end up not selecting any machine type at
    all. This is generally fine for the purpose of compile testing, but
    of course it means that the kernel is not usable on actual hardware,
    and it causes a warning about this fact.
    
    As most of the build bots now force-enable CONFIG_COMPILE_TEST for
    randconfig builds, use that as a guard to control whether we warn
    on this type of broken configuration.
    
    We could do the same for the missing-cpu-type warning, but those
    configurations fail to build much earlier.
    
    Signed-off-by: Arnd Bergmann <arnd@arndb.de>
    Signed-off-by: Russell King (Oracle) <rmk+kernel@armlinux.org.uk>

commit 3e701151feefc58c5194e1d9eb5af98568574f2d
Author: Julian Braha <julianbraha@gmail.com>
Date:   Sun Oct 24 21:06:15 2021 -0400

    ASoC: fix unmet dependency on GPIOLIB for SND_SOC_MAX98357A
    
    When SND_SOC_INTEL_KBL_DA7219_MAX98357A_MACH is selected,
    and GPIOLIB is not selected, Kbuild gives the
    following warnings:
    
    WARNING: unmet direct dependencies detected for SND_SOC_MAX98357A
      Depends on [n]: SOUND [=y] && !UML && SND [=y] && SND_SOC [=y] && GPIOLIB [=n]
      Selected by [y]:
      - SND_SOC_INTEL_DA7219_MAX98357A_GENERIC [=y] && SOUND [=y] && !UML && SND [=y] && SND_SOC [=y] && SND_SOC_INTEL_MACH [=y]
    
    WARNING: unmet direct dependencies detected for SND_SOC_DMIC
      Depends on [n]: SOUND [=y] && !UML && SND [=y] && SND_SOC [=y] && GPIOLIB [=n]
      Selected by [y]:
      - SND_SOC_INTEL_DA7219_MAX98357A_GENERIC [=y] && SOUND [=y] && !UML && SND [=y] && SND_SOC [=y] && SND_SOC_INTEL_MACH [=y]
    
    WARNING: unmet direct dependencies detected for SND_SOC_INTEL_DA7219_MAX98357A_GENERIC
      Depends on [n]: SOUND [=y] && !UML && SND [=y] && SND_SOC [=y] && SND_SOC_INTEL_MACH [=y] && GPIOLIB [=n]
      Selected by [y]:
      - SND_SOC_INTEL_KBL_DA7219_MAX98357A_MACH [=y] && SOUND [=y] && !UML && SND [=y] && SND_SOC [=y] && SND_SOC_INTEL_MACH [=y] && SND_SOC_INTEL_KBL [=y] && I2C [=y] && ACPI [=y] && (MFD_INTEL_LPSS [=y] || COMPILE_TEST [=n])
    
    This is because SND_SOC_DMIC and SND_SOC_MAX98357A are
    selected by SND_SOC_INTEL_DA7219_MAX98357A_GENERIC, which
    is also selected by SND_SOC_INTEL_KBL_DA7219_MAX98357A_MACH.
    However, the selectors do not depend on or select GPIOLIB,
    despite SND_SOC_DMIC and SND_SOC_MAX98357A depending on GPIOLIB.
    
    These unmet dependency bugs were detected by Kismet,
    a static analysis tool for Kconfig. Please advise if this
    is not the appropriate solution.
    
    Signed-off-by: Julian Braha <julianbraha@gmail.com>
    Link: https://lore.kernel.org/r/20211025010615.10070-1-julianbraha@gmail.com
    Signed-off-by: Mark Brown <broonie@kernel.org>

commit b4d89579ccb1ad5ffcdb3430933ce1e31a009ec7
Author: Kees Cook <keescook@chromium.org>
Date:   Wed Oct 20 10:35:54 2021 -0700

    gcc-plugins: Remove cyc_complexity
    
    This plugin has no impact on the resulting binary, is disabled
    under COMPILE_TEST, and is not enabled on any builds I'm aware of.
    Additionally, given the clarified purpose of GCC plugins in the kernel,
    remove cyc_complexity.
    
    Cc: Masahiro Yamada <masahiroy@kernel.org>
    Cc: Michal Marek <michal.lkml@markovi.net>
    Cc: Nick Desaulniers <ndesaulniers@google.com>
    Cc: Jonathan Corbet <corbet@lwn.net>
    Cc: linux-hardening@vger.kernel.org
    Cc: linux-kbuild@vger.kernel.org
    Cc: linux-doc@vger.kernel.org
    Signed-off-by: Kees Cook <keescook@chromium.org>
    Reviewed-by: Miguel Ojeda <ojeda@kernel.org>
    Reviewed-by: Nathan Chancellor <nathan@kernel.org>
    Acked-by: Nick Desaulniers <ndesaulniers@google.com>
    Acked-by: Ard Biesheuvel <ardb@kernel.org>
    Link: https://lore.kernel.org/r/20211020173554.38122-3-keescook@chromium.org

commit 3e6f8d1fa18457d54b20917bd9174d27daf09ab9
Author: Nick Desaulniers <ndesaulniers@google.com>
Date:   Tue Oct 19 15:36:46 2021 -0700

    arm64: vdso32: require CROSS_COMPILE_COMPAT for gcc+bfd
    
    Similar to
    commit 231ad7f409f1 ("Makefile: infer --target from ARCH for CC=clang")
    There really is no point in setting --target based on
    $CROSS_COMPILE_COMPAT for clang when the integrated assembler is being
    used, since
    commit ef94340583ee ("arm64: vdso32: drop -no-integrated-as flag").
    
    Allows COMPAT_VDSO to be selected without setting $CROSS_COMPILE_COMPAT
    when using clang and lld together.
    
    Before:
    $ ARCH=arm64 CROSS_COMPILE_COMPAT=arm-linux-gnueabi- make -j72 LLVM=1 defconfig
    $ grep CONFIG_COMPAT_VDSO .config
    CONFIG_COMPAT_VDSO=y
    $ ARCH=arm64 make -j72 LLVM=1 defconfig
    $ grep CONFIG_COMPAT_VDSO .config
    $
    
    After:
    $ ARCH=arm64 CROSS_COMPILE_COMPAT=arm-linux-gnueabi- make -j72 LLVM=1 defconfig
    $ grep CONFIG_COMPAT_VDSO .config
    CONFIG_COMPAT_VDSO=y
    $ ARCH=arm64 make -j72 LLVM=1 defconfig
    $ grep CONFIG_COMPAT_VDSO .config
    CONFIG_COMPAT_VDSO=y
    
    Reviewed-by: Nathan Chancellor <nathan@kernel.org>
    Suggested-by: Nathan Chancellor <nathan@kernel.org>
    Tested-by: Nathan Chancellor <nathan@kernel.org>
    Signed-off-by: Nick Desaulniers <ndesaulniers@google.com>
    Reviewed-by: Vincenzo Frascino <vincenzo.frascino@arm.com>
    Link: https://lore.kernel.org/r/20211019223646.1146945-5-ndesaulniers@google.com
    Signed-off-by: Will Deacon <will@kernel.org>

commit 14831fad73f5ac30ac61760487d95a538e6ab3cb
Author: Nick Desaulniers <ndesaulniers@google.com>
Date:   Tue Oct 19 15:36:45 2021 -0700

    arm64: vdso32: suppress error message for 'make mrproper'
    
    When running the following command without arm-linux-gnueabi-gcc in
    one's $PATH, the following warning is observed:
    
    $ ARCH=arm64 CROSS_COMPILE_COMPAT=arm-linux-gnueabi- make -j72 LLVM=1 mrproper
    make[1]: arm-linux-gnueabi-gcc: No such file or directory
    
    This is because KCONFIG is not run for mrproper, so CONFIG_CC_IS_CLANG
    is not set, and we end up eagerly evaluating various variables that try
    to invoke CC_COMPAT.
    
    This is a similar problem to what was observed in
    commit dc960bfeedb0 ("h8300: suppress error messages for 'make clean'")
    
    Reported-by: Lucas Henneman <henneman@google.com>
    Suggested-by: Masahiro Yamada <masahiroy@kernel.org>
    Signed-off-by: Nick Desaulniers <ndesaulniers@google.com>
    Reviewed-by: Vincenzo Frascino <vincenzo.frascino@arm.com>
    Reviewed-by: Nathan Chancellor <nathan@kernel.org>
    Tested-by: Nathan Chancellor <nathan@kernel.org>
    Link: https://lore.kernel.org/r/20211019223646.1146945-4-ndesaulniers@google.com
    Signed-off-by: Will Deacon <will@kernel.org>

commit 6bce28cb49320f403ab075ecdc2feb6cee24c416
Merge: f5245a5fdf75 0336d605daee
Author: Greg Kroah-Hartman <gregkh@linuxfoundation.org>
Date:   Tue Oct 19 11:44:28 2021 +0200

    Merge tag 'iio-for-5.16a-split-take4' of https://git.kernel.org/pub/scm/linux/kernel/git/jic23/iio into char-misc-next
    
    Jonathan writes:
    
    First set of IIO new device and feature support for the 5.16 cycle
    
    Counter subsystem changes now sent separately.
    
    This has been a busy cycle, so lots here and a few more stragglers to
    come next week.
    
    Big new feature in this cycle is probably output buffer support.
    This has been in the works for a very long time so it's great to see
    Mihail pick up the challenge and build upon his predecessors work to finally
    bring this feature to mainline.
    
    New device support
    ------------------
    
    * adi,adxl313
      - New driver and dt bindings for this low power accelerometer.
    * adi,adxl355
      - New driver and dt bindings for this accelerometer.
      - Later series adds buffer support.
    * asahi-kasei,ak8975
      - Minor additions to driver to support ak09916
    * aspeed,aspeed-adc
      - Substantial rework plus feature additions to add support for the
        ast2600 including a new dt bindings doc.
    * atmel,at91_sama5d2
      - Rework and support introduced for the sama7g5 parts.
    * maxim,max31865
      - New driver and bindings for this RTD temperature sensor chip.
    * nxp,imx8qxp
      - New driver and bindings for the ADC found on the i.MX 8QuadXPlus Soc.
    * senseair,sunrise
      - New driver and bindings for this family of carbon dioxide gas sensors.
    * sensiron,scd4x
      - New driver and bindings for this carbon dioxide gas sensor.
    
    New features
    ------------
    
    * Output buffer support.  Works in a similar fashion to input buffers, but
      in this case userspace pushes data into the kfifo which is then drained
      to the device when a trigger occurs.  Support added to the ad5766 DAC
      driver.
    * Core, devm_iio_map_array_register() to avoid need for
      devm_add_action_or_reset() based cleanup in fully managed allocation
      drivers.
    * Core iio_push_to_buffers_with_ts_unaligned() function to safely handle a
      few drivers where it really hard to ensure the correct data alignment in
      an iio_push_to_buffers_with_timestamp() call. Note this uses a bounce
      buffer so should be avoided whenever possible.  Used in the ti,adc108s102,
      invense,mpu3050 and adi,adis16400.  This closes the last   known set
      of drivers with alignment issues at this interface.
    * maxim,max1027
      - Substantial rework to this driver main target of which was supporting
        use of other triggers than it's own EOC interrupt.
      - Transfer optimization.
    * nxp,fxls8962af
      - Threshold even support including using it as a wakeup source.
    
    Cleanups, minor fixes etc
    -------------------------
    
    Chances of a common type to multiple drivers:
    
    * devm_ conversion and drop of .remove() callbacks in:
      - adi,ad5064
      - adi,ad7291
      - adi,ad7303
      - adi,ad7746
      - adi,ad9832
      - adi,adis16080
      - dialog,da9150-gpadc
      - intel,mrfld_adc
      - marvell,berlin2
      - maxim,max1363
      - maxim,max44000
      - nuvoton,nau7802
      - st_sensors (includes a lot of rework!)
      - ti,ads8344
      - ti,lp8788
    
    * devm_platform_ioremap_resource() used to reduce boilerplate
      - cirrus,ep93xx
      - rockchip,saradc
      - stm,stm32-dac
    
    * Use dev_err_probe() in more places to both not print on deferred probe and
      ensure a reason for the deferral is available for debug purposes.
      - adi,ad8801
      - capella,cm36651
      - linear,ltc1660
      - maxim,ds4424
      - maxim,max5821
      - microchip,mcp4922
      - nxp,lpc18xx
      - onnn,noa1305
      - st,lsm9ds0
      - st,st_sensors
      - st,stm32-dac
      - ti,afe4403
      - ti,afe4404
      - ti,dac7311
    
    * Drop error returns in SPI and I2C remove() functions as they are ignored and
      long term plan is to change these all over to returning void. In some cases
      these patches just make it 'obvious' they always return 0 where it was the
      case before but not easy to tell.
      - adi,ad5380
      - adi,ad5446
      - adi,ad5686
      - adi,ad5592r
      - bosch,bma400
      - bosch,bmc150
      - fsl,mma7455
      - honeywell,hmc5843
      - kionix,kxsd9
      - maxim,max5487
      - meas,ms5611
      - ti,afe4403
    
    Driver specific changes
    
    * adi,ad5770r
      - Bring driver inline with documented bindings.
    * adi,ad7746
      - Trivial style fix
    * adi,ad7949
      - Express some magic values as the underlying parts via new #defines.
      - Make it work with SPI controllers that don't support 14 or 16 bit messages
      - Support selection of voltage reference from dt including expanding the
        dt-bindings to cover this new functionality.
    * adi,ad799x
      - Implement selection of external reference voltage on AD7991, AD7995 and
        AD7999.
      - Add missing dt-bindings doc for devices supported by this driver.
    * adi,adislib
      - Move interrupt startup to better location in startup flow.
      - Handle devices that cannot mask/unmask the drdy pin and must instead mask
        at the interrupt controller.  Applies to the adis16460 and adis16475 from
        which we then drop equivalent code.
    * adi,ltc2983
      - Add support for optional reset pin.
      - Fail to probe if no channels specified in dt binding.
    * asahi-kasei,ak8975
      - dt-binding additions of missing vid-supply regulator.
    * aspeed,aspeed-adc
      - Typo fix.
    * fsl,mma7660
      - Mark acpi_device_id table __maybe_unused to avoid build warning.
    * fsl,imx25-gcq
      - Avoid initializing regulators that aren't used.
    * invensense,mpu3050
      - Drop a dead protection against a clash with the old input driver.
    * invensense,mpu6050
      - Rework code to not use strcpy() and hence avoid possibility of wrong sized
        buffers. Note this wasn't a bug, but the new code is a lot more readable.
      - Mark acpi_device_id table __maybe_unused to avoid build warning.
    * kionix,kxcjk1013
      - dt-binding addition to note it supports interrupts.
    * marvell,berlin2-adc
      - Enable COMPILE_TEST building.
    * maxim,max1027
      - Avoid returning success in an error path.
    * nxp,imx8qxp
      - Fix warning when runtime pm not enabled via __maybe_unused.
    * ricoh,rn5t618
      - Use the new devm_iio_map_array_register() instead of open coding the same.
    * samsung,exynos_adc
      - Improve kconfig help text.
    * st,lsm6dsx
      - Move max_fifo_size into the fifo_ops structure where the other configuration
        parameters are found.
    * st,st_sensors:
      - Reorder to ensure we turn the power off after removing userspace interfaces.
    * senseair,sunrise
      - Add missing I2C dependency.
    * ti,twl6030
      - Small code tidy up.
    
    * tag 'iio-for-5.16a-split-take4' of https://git.kernel.org/pub/scm/linux/kernel/git/jic23/iio: (148 commits)
      iio: imx8qxp-adc: mark PM functions as __maybe_unused
      iio: pressure: ms5611: Make ms5611_remove() return void
      iio: potentiometer: max5487: Don't return an error in .remove()
      iio: magn: hmc5843: Make hmc5843_common_remove() return void
      iio: health: afe4403: Don't return an error in .remove()
      iio: dac: ad5686: Make ad5686_remove() return void
      iio: dac: ad5592r: Make ad5592r_remove() return void
      iio: dac: ad5446: Make ad5446_remove() return void
      iio: dac: ad5380: Make ad5380_remove() return void
      iio: accel: mma7455: Make mma7455_core_remove() return void
      iio: accel: kxsd9: Make kxsd9_common_remove() return void
      iio: accel: bmi088: Make bmi088_accel_core_remove() return void
      iio: accel: bmc150: Make bmc150_accel_core_remove() return void
      iio: accel: bma400: Make bma400_remove() return void
      drivers:iio:dac:ad5766.c: Add trigger buffer
      iio: triggered-buffer: extend support to configure output buffers
      iio: kfifo-buffer: Add output buffer support
      iio: Add output buffer support
      iio: documentation: Document scd4x calibration use
      drivers: iio: chemical: Add support for Sensirion SCD4x CO2 sensor
      ...

commit 48ccc8edf5b90622cdc4f8878e0042ab5883e2ca
Author: Arnd Bergmann <arnd@arndb.de>
Date:   Mon Oct 18 15:30:37 2021 +0100

    ARM: 9141/1: only warn about XIP address when not compile testing
    
    In randconfig builds, we sometimes come across this warning:
    
    arm-linux-gnueabi-ld: XIP start address may cause MPU programming issues
    
    While this is helpful for actual systems to figure out why it
    fails, the warning does not provide any benefit for build testing,
    so guard it in a check for CONFIG_COMPILE_TEST, which is usually
    set on randconfig builds.
    
    Fixes: 216218308cfb ("ARM: 8713/1: NOMMU: Support MPU in XIP configuration")
    Signed-off-by: Arnd Bergmann <arnd@arndb.de>
    Signed-off-by: Russell King (Oracle) <rmk+kernel@armlinux.org.uk>

commit 8ee724ee4ebcb53f109c5d144f1b9eac966cc6f9
Author: Alexandru Ardelean <aardelean@deviqon.com>
Date:   Sun Sep 26 22:26:42 2021 +0300

    iio: adc: Kconfig: add COMPILE_TEST dep for berlin2-adc
    
    Otherwise most build checks will omit this driver from a compile-test due
    to it's dependency only on the BERLIN_ARCH symbol.
    
    Signed-off-by: Alexandru Ardelean <aardelean@deviqon.com>
    Link: https://lore.kernel.org/r/20210926192642.4051329-2-aardelean@deviqon.com
    Signed-off-by: Jonathan Cameron <Jonathan.Cameron@huawei.com>

commit c13f946bf1ef0eef49748b1824a0bdfb3487fe8c
Merge: 5fd01b726399 e21e52ad1e01
Author: Linus Torvalds <torvalds@linux-foundation.org>
Date:   Sat Oct 16 09:12:18 2021 -0700

    Merge tag 'csky-for-linus-5.15-rc6' of git://github.com/c-sky/csky-linux
    
    Pull csky fixes from Guo Ren:
     "Only 5 fixups:
    
       - Make HAVE_TCM depend on !COMPILE_TEST
    
       - bitops: Remove duplicate __clear_bit define
    
       - Select ARCH_WANT_FRAME_POINTERS only if compiler supports it
    
       - Fixup regs.sr broken in ptrace
    
       - don't let sigreturn play with priveleged bits of status register"
    
    * tag 'csky-for-linus-5.15-rc6' of git://github.com/c-sky/csky-linux:
      csky: Make HAVE_TCM depend on !COMPILE_TEST
      csky: bitops: Remove duplicate __clear_bit define
      csky: Select ARCH_WANT_FRAME_POINTERS only if compiler supports it
      csky: Fixup regs.sr broken in ptrace
      csky: don't let sigreturn play with priveleged bits of status register

commit e21e52ad1e0126e2a5e2013084ac3f47cf1e887a
Author: Guenter Roeck <linux@roeck-us.net>
Date:   Thu Sep 16 21:38:38 2021 -0700

    csky: Make HAVE_TCM depend on !COMPILE_TEST
    
    Building csky:allmodconfig results in the following build errors.
    
    arch/csky/mm/tcm.c:9:2: error:
                    #error "You should define ITCM_RAM_BASE"
        9 | #error "You should define ITCM_RAM_BASE"
          |  ^~~~~
    arch/csky/mm/tcm.c:14:2: error:
                    #error "You should define DTCM_RAM_BASE"
       14 | #error "You should define DTCM_RAM_BASE"
          |  ^~~~~
    arch/csky/mm/tcm.c:18:2: error:
                    #error "You should define correct DTCM_RAM_BASE"
       18 | #error "You should define correct DTCM_RAM_BASE"
    
    This is seen with compile tests since those enable HAVE_TCM,
    but do not provide useful default values for ITCM_RAM_BASE or
    DTCM_RAM_BASE. Disable HAVE_TCM for commpile tests to avoid
    the error.
    
    Signed-off-by: Guenter Roeck <linux@roeck-us.net>
    Signed-off-by: Guo Ren <guoren@kernel.org>

commit cb7e651879839eae28a373b49a1e06b432c82a62
Author: Mark Brown <broonie@kernel.org>
Date:   Tue Sep 21 22:21:02 2021 +0100

    video: fbdev: gbefb: Only instantiate device when built for IP32
    
    [ Upstream commit 11b8e2bb986d23157e82e267fb8cc6b281dfdee9 ]
    
    The gbefb driver not only registers a driver but also the device for that
    driver. This is all well and good when run on the IP32 machines that are
    supported by the driver but since the driver supports building with
    COMPILE_TEST we might also be building on other platforms which do not have
    this hardware and will crash instantiating the driver. Add an IS_ENABLED()
    check so we compile out the device registration if we don't have the Kconfig
    option for the machine enabled.
    
    Fixes: 552ccf6b259d290c0c ("video: fbdev: gbefb: add COMPILE_TEST support")
    Signed-off-by: Mark Brown <broonie@kernel.org>
    Cc: Bartlomiej Zolnierkiewicz <b.zolnierkie@samsung.com>
    Signed-off-by: Daniel Vetter <daniel.vetter@ffwll.ch>
    Link: https://patchwork.freedesktop.org/patch/msgid/20210921212102.30803-1-broonie@kernel.org
    Signed-off-by: Maarten Lankhorst <maarten.lankhorst@linux.intel.com>
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit 008224cdc12628d21a3eb92259fa3aa3ea5b22a1
Author: Mark Brown <broonie@kernel.org>
Date:   Tue Sep 21 22:21:02 2021 +0100

    video: fbdev: gbefb: Only instantiate device when built for IP32
    
    [ Upstream commit 11b8e2bb986d23157e82e267fb8cc6b281dfdee9 ]
    
    The gbefb driver not only registers a driver but also the device for that
    driver. This is all well and good when run on the IP32 machines that are
    supported by the driver but since the driver supports building with
    COMPILE_TEST we might also be building on other platforms which do not have
    this hardware and will crash instantiating the driver. Add an IS_ENABLED()
    check so we compile out the device registration if we don't have the Kconfig
    option for the machine enabled.
    
    Fixes: 552ccf6b259d290c0c ("video: fbdev: gbefb: add COMPILE_TEST support")
    Signed-off-by: Mark Brown <broonie@kernel.org>
    Cc: Bartlomiej Zolnierkiewicz <b.zolnierkie@samsung.com>
    Signed-off-by: Daniel Vetter <daniel.vetter@ffwll.ch>
    Link: https://patchwork.freedesktop.org/patch/msgid/20210921212102.30803-1-broonie@kernel.org
    Signed-off-by: Maarten Lankhorst <maarten.lankhorst@linux.intel.com>
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit 23514c752f9bc53f02ea34a0ad1e3a636cc02865
Author: Mark Brown <broonie@kernel.org>
Date:   Tue Sep 21 22:21:02 2021 +0100

    video: fbdev: gbefb: Only instantiate device when built for IP32
    
    [ Upstream commit 11b8e2bb986d23157e82e267fb8cc6b281dfdee9 ]
    
    The gbefb driver not only registers a driver but also the device for that
    driver. This is all well and good when run on the IP32 machines that are
    supported by the driver but since the driver supports building with
    COMPILE_TEST we might also be building on other platforms which do not have
    this hardware and will crash instantiating the driver. Add an IS_ENABLED()
    check so we compile out the device registration if we don't have the Kconfig
    option for the machine enabled.
    
    Fixes: 552ccf6b259d290c0c ("video: fbdev: gbefb: add COMPILE_TEST support")
    Signed-off-by: Mark Brown <broonie@kernel.org>
    Cc: Bartlomiej Zolnierkiewicz <b.zolnierkie@samsung.com>
    Signed-off-by: Daniel Vetter <daniel.vetter@ffwll.ch>
    Link: https://patchwork.freedesktop.org/patch/msgid/20210921212102.30803-1-broonie@kernel.org
    Signed-off-by: Maarten Lankhorst <maarten.lankhorst@linux.intel.com>
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit 0dcf60d0014001a2dcae61169c8f72b775c2e48a
Merge: cdc726fb35ed 2fbc349911e4
Author: Linus Torvalds <torvalds@linux-foundation.org>
Date:   Fri Oct 8 11:57:54 2021 -0700

    Merge tag 'asm-generic-fixes-5.15' of git://git.kernel.org/pub/scm/linux/kernel/git/arnd/asm-generic
    
    Pull asm-generic fixes from Arnd Bergmann:
     "There is one build fix for Arm platforms that ended up impacting most
      architectures because of the way the drivers/firmware Kconfig file is
      wired up:
    
      The CONFIG_QCOM_SCM dependency have caused a number of randconfig
      regressions over time, and some still remain in v5.15-rc4. The fix we
      agreed on in the end is to make this symbol selected by any driver
      using it, and then building it even for non-Arm platforms with
      CONFIG_COMPILE_TEST.
    
      To make this work on all architectures, the drivers/firmware/Kconfig
      file needs to be included for all architectures to make the symbol
      itself visible.
    
      In a separate discussion, we found that a sound driver patch that is
      pending for v5.16 needs the same change to include this Kconfig file,
      so the easiest solution seems to have my Kconfig rework included in
      v5.15.
    
      Finally, the branch also includes a small unrelated build fix for
      NOMMU architectures"
    
    Link: https://lore.kernel.org/all/20210928153508.101208f8@canb.auug.org.au/
    Link: https://lore.kernel.org/all/20210928075216.4193128-1-arnd@kernel.org/
    Link: https://lore.kernel.org/all/20211007151010.333516-1-arnd@kernel.org/
    
    * tag 'asm-generic-fixes-5.15' of git://git.kernel.org/pub/scm/linux/kernel/git/arnd/asm-generic:
      asm-generic/io.h: give stub iounmap() on !MMU same prototype as elsewhere
      qcom_scm: hide Kconfig symbol
      firmware: include drivers/firmware/Kconfig unconditionally

commit 0068dc8c96688b72cc99470530b384429129950c
Merge: 1da38549dd64 bf79045e0ef5
Author: Linus Torvalds <torvalds@linux-foundation.org>
Date:   Fri Oct 8 09:58:50 2021 -0700

    Merge tag 'drm-fixes-2021-10-08' of git://anongit.freedesktop.org/drm/drm
    
    Pull drm fixes from Dave Airlie:
     "I've returned from my tropical island retreat, even managed to bring
      one of my kids on a dive with some turtles. Thanks to Daniel for doing
      last week's work.
    
      Otherwise this is the weekly fixes pull, it's a bit bigger because the
      vc4 reverts in your tree caused some problems with fixes in the
      drm-misc tree so it got left out last week, so this week has the misc
      fixes rebased without the vc4 pieces.
    
      Otherwise it's i915, amdgpu with the usual fixes and a scattering over
      other drivers.
    
      I expect things should calm down a bit more next week.
    
      core:
       - Kconfig fix for fb_simple vs simpledrm.
    
      i915:
       - Fix RKL HDMI audio
       - Fix runtime pm imbalance on i915_gem_shrink() error path
       - Fix Type-C port access before hw/sw state sync
       - Fix VBT backlight struct version/size check
       - Fix VT-d async flip on SKL/BXT with plane stretch workaround
    
      amdgpu:
       - DCN 3.1 DP alt mode fixes
       - S0ix gfxoff fix
       - Fix DRM_AMD_DC_SI dependencies
       - PCIe DPC handling fix
       - DCN 3.1 scaling fix
       - Documentation fix
    
      amdkfd:
       - Fix potential memory leak
       - IOMMUv2 init fixes
    
      vc4 (there were some hdmi fixes but things got reverted, sort it out
           later):
       - compiler fix
    
      nouveau:
       - Cursor fix
       - Fix ttm buffer moves for ampere gpu's by adding minimal
         acceleration support.
       - memory leak fixes
    
      rockchip:
       - crtc/clk fixup
    
      panel:
       - ili9341 Fix DT bindings indent
       - y030xx067a - yellow tint init seq fix
    
      gbefb:
       - Fix gbefb when built with COMPILE_TEST"
    
    * tag 'drm-fixes-2021-10-08' of git://anongit.freedesktop.org/drm/drm: (33 commits)
      drm/amd/display: Fix detection of 4 lane for DPALT
      drm/amd/display: Limit display scaling to up to 4k for DCN 3.1
      drm/amd/display: Skip override for preferred link settings during link training
      drm/nouveau/debugfs: fix file release memory leak
      drm/nouveau/kms/nv50-: fix file release memory leak
      drm/nouveau: avoid a use-after-free when BO init fails
      DRM: delete DRM IRQ legacy midlayer docs
      video: fbdev: gbefb: Only instantiate device when built for IP32
      fbdev: simplefb: fix Kconfig dependencies
      drm/panel: abt-y030xx067a: yellow tint fix
      dt-bindings: panel: ili9341: correct indentation
      drm/nouveau/fifo/ga102: initialise chid on return from channel creation
      drm/rockchip: Update crtc fixup to account for fractional clk change
      drm/nouveau/ga102-: support ttm buffer moves via copy engine
      drm/nouveau/kms/tu102-: delay enabling cursor until after assign_windows
      drm/sun4i: dw-hdmi: Fix HDMI PHY clock setup
      drm/vc4: hdmi: Remove unused struct
      drm/kmb: Enable alpha blended second plane
      drm/amdgpu: handle the case of pci_channel_io_frozen only in amdgpu_pci_resume
      drm/amdgpu: init iommu after amdkfd device init
      ...

commit 407baae3e6f3824c8211c19076c89b0796028e83
Merge: 1e3944578b74 b291fdcf5114
Author: Dave Airlie <airlied@redhat.com>
Date:   Fri Oct 8 12:26:45 2021 +1000

    Merge tag 'du-next-20211007' of git://linuxtv.org/pinchartl/media into drm-next
    
    R-Car DU improvements & enhancements to misc drivers
    
    Most notably,
    
    - Non-contiguous buffer import support for rcar-du
    - r8a779a0 support preparation for rcar-du
    - COMPILE_TEST fixes for omapdrm and sti
    
    Signed-off-by: Dave Airlie <airlied@redhat.com>
    
    From: Laurent Pinchart <laurent.pinchart@ideasonboard.com>
    Link: https://patchwork.freedesktop.org/patch/msgid/YV5jfi+/qjTJKeb3@pendragon.ideasonboard.com

commit b28a130f0bc6e79ba9b02fcc639bca2abd3b8361
Merge: 7d80cc702f04 f5a8703a9c41
Author: Dave Airlie <airlied@redhat.com>
Date:   Fri Oct 8 11:34:31 2021 +1000

    Merge tag 'drm-misc-fixes-2021-10-06' of git://anongit.freedesktop.org/drm/drm-misc into drm-fixes
    
    Rebased drm-misc-fixes for v5.15-rc5:
    - Dropped vc4 patches.
    - Compiler fix for vc4.
    - Cursor fix for nouveau.
    - Fix ttm buffer moves for ampere gpu's by adding minimal acceleration support.
    - Small rockchip fixes.
    - Fix DT bindings indent for ili9341.
    - Fix y030xx067a init sequence to not get a yellow tint.
    - Kconfig fix for fb_simple vs simpledrm.
    - Assorted nouvaeu memory leaks.
    - Fix gbefb when built with COMPILE_TEST.
    
    Signed-off-by: Dave Airlie <airlied@redhat.com>
    
    From: Maarten Lankhorst <maarten.lankhorst@linux.intel.com>
    Link: https://patchwork.freedesktop.org/patch/msgid/3272bf72-2c37-31eb-404e-cf7edd485c7d@linux.intel.com

commit 25011c9ec8e7c9ebb52c345528b22d2ea133191b
Author: Nick Desaulniers <ndesaulniers@google.com>
Date:   Mon Sep 20 16:25:33 2021 -0700

    nbd: use shifts rather than multiplies
    
    commit 41e76c6a3c83c85e849f10754b8632ea763d9be4 upstream.
    
    commit fad7cd3310db ("nbd: add the check to prevent overflow in
    __nbd_ioctl()") raised an issue from the fallback helpers added in
    commit f0907827a8a9 ("compiler.h: enable builtin overflow checkers and
    add fallback code")
    
    ERROR: modpost: "__divdi3" [drivers/block/nbd.ko] undefined!
    
    As Stephen Rothwell notes:
      The added check_mul_overflow() call is being passed 64 bit values.
      COMPILER_HAS_GENERIC_BUILTIN_OVERFLOW is not set for this build (see
      include/linux/overflow.h).
    
    Specifically, the helpers for checking whether the results of a
    multiplication overflowed (__unsigned_mul_overflow,
    __signed_add_overflow) use the division operator when
    !COMPILER_HAS_GENERIC_BUILTIN_OVERFLOW.  This is problematic for 64b
    operands on 32b hosts.
    
    This was fixed upstream by
    commit 76ae847497bc ("Documentation: raise minimum supported version of
    GCC to 5.1")
    which is not suitable to be backported to stable.
    
    Further, __builtin_mul_overflow() would emit a libcall to a
    compiler-rt-only symbol when compiling with clang < 14 for 32b targets.
    
    ld.lld: error: undefined symbol: __mulodi4
    
    In order to keep stable buildable with GCC 4.9 and clang < 14, modify
    struct nbd_config to instead track the number of bits of the block size;
    reconstructing the block size using runtime checked shifts that are not
    problematic for those compilers and in a ways that can be backported to
    stable.
    
    In nbd_set_size, we do validate that the value of blksize must be a
    power of two (POT) and is in the range of [512, PAGE_SIZE] (both
    inclusive).
    
    This does modify the debugfs interface.
    
    Cc: stable@vger.kernel.org
    Cc: Arnd Bergmann <arnd@kernel.org>
    Cc: Rasmus Villemoes <linux@rasmusvillemoes.dk>
    Link: https://github.com/ClangBuiltLinux/linux/issues/1438
    Link: https://lore.kernel.org/all/20210909182525.372ee687@canb.auug.org.au/
    Link: https://lore.kernel.org/stable/CAHk-=whiQBofgis_rkniz8GBP9wZtSZdcDEffgSLO62BUGV3gg@mail.gmail.com/
    Reported-by: Naresh Kamboju <naresh.kamboju@linaro.org>
    Reported-by: Nathan Chancellor <nathan@kernel.org>
    Reported-by: Stephen Rothwell <sfr@canb.auug.org.au>
    Suggested-by: Kees Cook <keescook@chromium.org>
    Suggested-by: Linus Torvalds <torvalds@linux-foundation.org>
    Suggested-by: Pavel Machek <pavel@ucw.cz>
    Signed-off-by: Nick Desaulniers <ndesaulniers@google.com>
    Reviewed-by: Josef Bacik <josef@toxicpanda.com>
    Link: https://lore.kernel.org/r/20210920232533.4092046-1-ndesaulniers@google.com
    Signed-off-by: Jens Axboe <axboe@kernel.dk>
    Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>

commit 7be199764d46aafcbe2e0bb90997cc4de312bfa8
Author: Jackie Liu <liuyun01@kylinos.cn>
Date:   Mon Sep 13 15:32:20 2021 +0800

    watchdog/sb_watchdog: fix compilation problem due to COMPILE_TEST
    
    [ Upstream commit c388a18957efdf31db8e97ec4d2d4b7dc1ca9a44 ]
    
    Compiling sb_watchdog needs to clearly define SIBYTE_HDR_FEATURES.
    In arch/mips/sibyte/Platform like:
    
      cflags-$(CONFIG_SIBYTE_BCM112X) +=                                      \
                    -I$(srctree)/arch/mips/include/asm/mach-sibyte          \
                    -DSIBYTE_HDR_FEATURES=SIBYTE_HDR_FMASK_1250_112x_ALL
    
    Otherwise, SIBYTE_HDR_FEATURES is SIBYTE_HDR_FMASK_ALL.
    SIBYTE_HDR_FMASK_ALL is mean:
    
     #define SIBYTE_HDR_FMASK_ALL  SIBYTE_HDR_FMASK_1250_ALL | SIBYTE_HDR_FMASK_112x_ALL \
                                         | SIBYTE_HDR_FMASK_1480_ALL)
    
    So, If not limited to CPU_SB1, we will get such an error:
    
      arch/mips/include/asm/sibyte/bcm1480_scd.h:261: error: "M_SPC_CFG_CLEAR" redefined [-Werror]
      arch/mips/include/asm/sibyte/bcm1480_scd.h:262: error: "M_SPC_CFG_ENABLE" redefined [-Werror]
    
    Fixes: da2a68b3eb47 ("watchdog: Enable COMPILE_TEST where possible")
    Signed-off-by: Jackie Liu <liuyun01@kylinos.cn>
    Reviewed-by: Guenter Roeck <linux@roeck-us.net>
    Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit 11b8e2bb986d23157e82e267fb8cc6b281dfdee9
Author: Mark Brown <broonie@kernel.org>
Date:   Tue Sep 21 22:21:02 2021 +0100

    video: fbdev: gbefb: Only instantiate device when built for IP32
    
    The gbefb driver not only registers a driver but also the device for that
    driver. This is all well and good when run on the IP32 machines that are
    supported by the driver but since the driver supports building with
    COMPILE_TEST we might also be building on other platforms which do not have
    this hardware and will crash instantiating the driver. Add an IS_ENABLED()
    check so we compile out the device registration if we don't have the Kconfig
    option for the machine enabled.
    
    Fixes: 552ccf6b259d290c0c ("video: fbdev: gbefb: add COMPILE_TEST support")
    Signed-off-by: Mark Brown <broonie@kernel.org>
    Cc: Bartlomiej Zolnierkiewicz <b.zolnierkie@samsung.com>
    Signed-off-by: Daniel Vetter <daniel.vetter@ffwll.ch>
    Link: https://patchwork.freedesktop.org/patch/msgid/20210921212102.30803-1-broonie@kernel.org
    Signed-off-by: Maarten Lankhorst <maarten.lankhorst@linux.intel.com>

commit cb2282213e84f04ab7e93fd4537815da5db2f010
Author: Johan Hovold <johan@kernel.org>
Date:   Fri Sep 24 16:12:32 2021 +0200

    serial: 8250: allow disabling of Freescale 16550 compile test
    
    The SERIAL_8250_FSL option is used to enable a workaround for a
    break-detection erratum for Freescale 16550 UARTs in the 8250 driver and
    is currently also used to enable support for ACPI enumeration.
    
    It is enabled on PPC, ARM and ARM64 whenever 8250 console support is
    enabled (since the quirk is needed for sysrq handling).
    
    Commit b1442c55ce89 ("serial: 8250: extend compile-test coverage")
    enabled compile testing of the code in question but did not provide a
    means to disable the option when COMPILE_TEST is enabled.
    
    Add a conditional input prompt instead so that SERIAL_8250_FSL is no
    longer enabled by default when compile testing while continuing to
    always enable the quirk for platforms that may need it.
    
    Fixes: b1442c55ce89 ("serial: 8250: extend compile-test coverage")
    Reported-by: Geert Uytterhoeven <geert+renesas@glider.be>
    Signed-off-by: Johan Hovold <johan@kernel.org>
    Reviewed-by: Geert Uytterhoeven <geert+renesas@glider.be>
    Link: https://lore.kernel.org/r/20210924141232.4419-1-johan@kernel.org
    Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>

commit e656972b69864348a747954ea187576808000c5a
Author: John Garry <john.garry@huawei.com>
Date:   Fri Oct 1 18:48:46 2021 +0800

    drivers/perf: Improve build test coverage
    
    Improve build test cover by allowing some drivers to build under
    COMPILE_TEST where possible.
    
    Some notes:
    - Mostly a dependency on CONFIG_ACPI is not really required for only
      building (but left untouched), but is required for TX2 which uses ACPI
      functions which have no stubs
    - XGENE required 64b dependency as it relies on some unsigned long perf
      struct fields being 64b
    - I don't see why TX2 requires NUMA to build, but left untouched
    - Added an explicit dependency on GENERIC_MSI_IRQ_DOMAIN for
      ARM_SMMU_V3_PMU, which is required for platform MSI functions
    
    Signed-off-by: John Garry <john.garry@huawei.com>
    Link: https://lore.kernel.org/r/1633085326-156653-3-git-send-email-john.garry@huawei.com
    Signed-off-by: Will Deacon <will@kernel.org>

commit 7073b5a8bd6ea641b41568e2899b0977f79134e3
Author: Michael Tretter <m.tretter@pengutronix.de>
Date:   Thu Aug 26 11:47:38 2021 +0200

    dmaengine: zynqmp_dma: enable COMPILE_TEST
    
    The driver doesn't use anything architecture specific. Allow the
    compilation on other architectures as well.
    
    Signed-off-by: Michael Tretter <m.tretter@pengutronix.de>
    Link: https://lore.kernel.org/r/20210826094742.1302009-4-m.tretter@pengutronix.de
    Signed-off-by: Vinod Koul <vkoul@kernel.org>

commit a466530b3a1ef20de12b2e2c062a1a84006ced36
Author: Jackie Liu <liuyun01@kylinos.cn>
Date:   Mon Sep 13 15:32:20 2021 +0800

    watchdog/sb_watchdog: fix compilation problem due to COMPILE_TEST
    
    Compiling sb_watchdog needs to clearly define SIBYTE_HDR_FEATURES.
    In arch/mips/sibyte/Platform like:
    
      cflags-$(CONFIG_SIBYTE_BCM112X) +=                                      \
                    -I$(srctree)/arch/mips/include/asm/mach-sibyte          \
                    -DSIBYTE_HDR_FEATURES=SIBYTE_HDR_FMASK_1250_112x_ALL
    
    Otherwise, SIBYTE_HDR_FEATURES is SIBYTE_HDR_FMASK_ALL.
    SIBYTE_HDR_FMASK_ALL is mean:
    
     #define SIBYTE_HDR_FMASK_ALL  SIBYTE_HDR_FMASK_1250_ALL | SIBYTE_HDR_FMASK_112x_ALL \
                                         | SIBYTE_HDR_FMASK_1480_ALL)
    
    So, If not limited to CPU_SB1, we will get such an error:
    
      arch/mips/include/asm/sibyte/bcm1480_scd.h:261: error: "M_SPC_CFG_CLEAR" redefined [-Werror]
      arch/mips/include/asm/sibyte/bcm1480_scd.h:262: error: "M_SPC_CFG_ENABLE" redefined [-Werror]
    
    Fixes: da2a68b3eb47 ("watchdog: Enable COMPILE_TEST where possible")
    Signed-off-by: Jackie Liu <liuyun01@kylinos.cn>
    Reviewed-by: Guenter Roeck <linux@roeck-us.net>
    Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>

commit 41e76c6a3c83c85e849f10754b8632ea763d9be4
Author: Nick Desaulniers <ndesaulniers@google.com>
Date:   Mon Sep 20 16:25:33 2021 -0700

    nbd: use shifts rather than multiplies
    
    commit fad7cd3310db ("nbd: add the check to prevent overflow in
    __nbd_ioctl()") raised an issue from the fallback helpers added in
    commit f0907827a8a9 ("compiler.h: enable builtin overflow checkers and
    add fallback code")
    
    ERROR: modpost: "__divdi3" [drivers/block/nbd.ko] undefined!
    
    As Stephen Rothwell notes:
      The added check_mul_overflow() call is being passed 64 bit values.
      COMPILER_HAS_GENERIC_BUILTIN_OVERFLOW is not set for this build (see
      include/linux/overflow.h).
    
    Specifically, the helpers for checking whether the results of a
    multiplication overflowed (__unsigned_mul_overflow,
    __signed_add_overflow) use the division operator when
    !COMPILER_HAS_GENERIC_BUILTIN_OVERFLOW.  This is problematic for 64b
    operands on 32b hosts.
    
    This was fixed upstream by
    commit 76ae847497bc ("Documentation: raise minimum supported version of
    GCC to 5.1")
    which is not suitable to be backported to stable.
    
    Further, __builtin_mul_overflow() would emit a libcall to a
    compiler-rt-only symbol when compiling with clang < 14 for 32b targets.
    
    ld.lld: error: undefined symbol: __mulodi4
    
    In order to keep stable buildable with GCC 4.9 and clang < 14, modify
    struct nbd_config to instead track the number of bits of the block size;
    reconstructing the block size using runtime checked shifts that are not
    problematic for those compilers and in a ways that can be backported to
    stable.
    
    In nbd_set_size, we do validate that the value of blksize must be a
    power of two (POT) and is in the range of [512, PAGE_SIZE] (both
    inclusive).
    
    This does modify the debugfs interface.
    
    Cc: stable@vger.kernel.org
    Cc: Arnd Bergmann <arnd@kernel.org>
    Cc: Rasmus Villemoes <linux@rasmusvillemoes.dk>
    Link: https://github.com/ClangBuiltLinux/linux/issues/1438
    Link: https://lore.kernel.org/all/20210909182525.372ee687@canb.auug.org.au/
    Link: https://lore.kernel.org/stable/CAHk-=whiQBofgis_rkniz8GBP9wZtSZdcDEffgSLO62BUGV3gg@mail.gmail.com/
    Reported-by: Naresh Kamboju <naresh.kamboju@linaro.org>
    Reported-by: Nathan Chancellor <nathan@kernel.org>
    Reported-by: Stephen Rothwell <sfr@canb.auug.org.au>
    Suggested-by: Kees Cook <keescook@chromium.org>
    Suggested-by: Linus Torvalds <torvalds@linux-foundation.org>
    Suggested-by: Pavel Machek <pavel@ucw.cz>
    Signed-off-by: Nick Desaulniers <ndesaulniers@google.com>
    Reviewed-by: Josef Bacik <josef@toxicpanda.com>
    Link: https://lore.kernel.org/r/20210920232533.4092046-1-ndesaulniers@google.com
    Signed-off-by: Jens Axboe <axboe@kernel.dk>

commit c388a18957efdf31db8e97ec4d2d4b7dc1ca9a44
Author: Jackie Liu <liuyun01@kylinos.cn>
Date:   Mon Sep 13 15:32:20 2021 +0800

    watchdog/sb_watchdog: fix compilation problem due to COMPILE_TEST
    
    Compiling sb_watchdog needs to clearly define SIBYTE_HDR_FEATURES.
    In arch/mips/sibyte/Platform like:
    
      cflags-$(CONFIG_SIBYTE_BCM112X) +=                                      \
                    -I$(srctree)/arch/mips/include/asm/mach-sibyte          \
                    -DSIBYTE_HDR_FEATURES=SIBYTE_HDR_FMASK_1250_112x_ALL
    
    Otherwise, SIBYTE_HDR_FEATURES is SIBYTE_HDR_FMASK_ALL.
    SIBYTE_HDR_FMASK_ALL is mean:
    
     #define SIBYTE_HDR_FMASK_ALL  SIBYTE_HDR_FMASK_1250_ALL | SIBYTE_HDR_FMASK_112x_ALL \
                                         | SIBYTE_HDR_FMASK_1480_ALL)
    
    So, If not limited to CPU_SB1, we will get such an error:
    
      arch/mips/include/asm/sibyte/bcm1480_scd.h:261: error: "M_SPC_CFG_CLEAR" redefined [-Werror]
      arch/mips/include/asm/sibyte/bcm1480_scd.h:262: error: "M_SPC_CFG_ENABLE" redefined [-Werror]
    
    Fixes: da2a68b3eb47 ("watchdog: Enable COMPILE_TEST where possible")
    Signed-off-by: Jackie Liu <liuyun01@kylinos.cn>
    Reviewed-by: Guenter Roeck <linux@roeck-us.net>
    Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>

commit 53a72858bcae7eaa7df8d167dbf60682d70f82a6
Author: Arnd Bergmann <arnd@arndb.de>
Date:   Mon Aug 9 18:01:31 2021 +1000

    m68knommu: only set CONFIG_ISA_DMA_API for ColdFire sub-arch
    
    [ Upstream commit db87db65c1059f3be04506d122f8ec9b2fa3b05e ]
    
    > Hi Arnd,
    >
    > First bad commit (maybe != root cause):
    >
    > tree:   https://git.kernel.org/pub/scm/linux/kernel/git/next/linux-next.git master
    > head:   2f73937c9aa561e2082839bc1a8efaac75d6e244
    > commit: 47fd22f2b84765a2f7e3f150282497b902624547 [4771/5318] cs89x0: rework driver configuration
    > config: m68k-randconfig-c003-20210804 (attached as .config)
    > compiler: m68k-linux-gcc (GCC) 10.3.0
    > reproduce (this is a W=1 build):
    >         wget https://raw.githubusercontent.com/intel/lkp-tests/master/sbin/make.cross -O ~/bin/make.cross
    >         chmod +x ~/bin/make.cross
    >         # https://git.kernel.org/pub/scm/linux/kernel/git/next/linux-next.git/commit/?id=47fd22f2b84765a2f7e3f150282497b902624547
    >         git remote add linux-next https://git.kernel.org/pub/scm/linux/kernel/git/next/linux-next.git
    >         git fetch --no-tags linux-next master
    >         git checkout 47fd22f2b84765a2f7e3f150282497b902624547
    >         # save the attached .config to linux build tree
    >         COMPILER_INSTALL_PATH=$HOME/0day COMPILER=gcc-10.3.0 make.cross ARCH=m68k
    >
    > If you fix the issue, kindly add following tag as appropriate
    > Reported-by: kernel test robot <lkp@intel.com>
    >
    > All errors (new ones prefixed by >>):
    >
    >    In file included from include/linux/kernel.h:19,
    >                     from include/linux/list.h:9,
    >                     from include/linux/module.h:12,
    >                     from drivers/net/ethernet/cirrus/cs89x0.c:51:
    >    drivers/net/ethernet/cirrus/cs89x0.c: In function 'net_open':
    >    drivers/net/ethernet/cirrus/cs89x0.c:897:20: error: implicit declaration of function 'isa_virt_to_bus'; did you mean 'virt_to_bus'? [-Werror=implicit-function-declaration]
    >      897 |     (unsigned long)isa_virt_to_bus(lp->dma_buff));
    >          |                    ^~~~~~~~~~~~~~~
    >    include/linux/printk.h:141:17: note: in definition of macro 'no_printk'
    >      141 |   printk(fmt, ##__VA_ARGS__);  \
    >          |                 ^~~~~~~~~~~
    >    drivers/net/ethernet/cirrus/cs89x0.c:86:3: note: in expansion of macro 'pr_debug'
    >       86 |   pr_##level(fmt, ##__VA_ARGS__);   \
    >          |   ^~~
    >    drivers/net/ethernet/cirrus/cs89x0.c:894:3: note: in expansion of macro 'cs89_dbg'
    >      894 |   cs89_dbg(1, debug, "%s: dma %lx %lx\n",
    >          |   ^~~~~~~~
    > >> drivers/net/ethernet/cirrus/cs89x0.c:914:3: error: implicit declaration of function 'disable_dma'; did you mean 'disable_irq'? [-Werror=implicit-function-declaration]
    
    As far as I can tell, this is a bug with the m68kmmu architecture, not
    with my driver:
    The CONFIG_ISA_DMA_API option is provided for coldfire, which implements it,
    but dragonball also sets the option as a side-effect, without actually
    implementing
    the interfaces. The patch below should fix it.
    
    Signed-off-by: Arnd Bergmann <arnd@arndb.de>
    Signed-off-by: Greg Ungerer <gerg@linux-m68k.org>
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit 4cab14bcff2585ec636e6e325210e8118b517859
Author: Randy Dunlap <rdunlap@infradead.org>
Date:   Wed Jul 7 14:47:52 2021 -0700

    ASoC: atmel: ATMEL drivers don't need HAS_DMA
    
    [ Upstream commit 6c5c659dfe3f02e08054a6c20019e3886618b512 ]
    
    On a config (such as arch/sh/) which does not set HAS_DMA when MMU
    is not set, several ATMEL ASoC drivers select symbols that cause
    kconfig warnings. There is one "depends on HAS_DMA" which is no longer
    needed. Dropping it eliminates the kconfig warnings and still builds
    with no problems reported.
    
    Fix the following kconfig warnings:
    
    WARNING: unmet direct dependencies detected for SND_ATMEL_SOC_PDC
      Depends on [n]: SOUND [=m] && !UML && SND [=m] && SND_SOC [=m] && SND_ATMEL_SOC [=m] && HAS_DMA [=n]
      Selected by [m]:
      - SND_ATMEL_SOC_SSC [=m] && SOUND [=m] && !UML && SND [=m] && SND_SOC [=m] && SND_ATMEL_SOC [=m]
      - SND_ATMEL_SOC_SSC_PDC [=m] && SOUND [=m] && !UML && SND [=m] && SND_SOC [=m] && SND_ATMEL_SOC [=m] && ATMEL_SSC [=m]
    
    WARNING: unmet direct dependencies detected for SND_ATMEL_SOC_SSC_PDC
      Depends on [n]: SOUND [=m] && !UML && SND [=m] && SND_SOC [=m] && SND_ATMEL_SOC [=m] && ATMEL_SSC [=m] && HAS_DMA [=n]
      Selected by [m]:
      - SND_AT91_SOC_SAM9G20_WM8731 [=m] && SOUND [=m] && !UML && SND [=m] && SND_SOC [=m] && SND_ATMEL_SOC [=m] && (ARCH_AT91 || COMPILE_TEST [=y]) && ATMEL_SSC [=m] && SND_SOC_I2C_AND_SPI [=m]
    
    WARNING: unmet direct dependencies detected for SND_ATMEL_SOC_SSC
      Depends on [n]: SOUND [=m] && !UML && SND [=m] && SND_SOC [=m] && SND_ATMEL_SOC [=m] && HAS_DMA [=n]
      Selected by [m]:
      - SND_ATMEL_SOC_SSC_DMA [=m] && SOUND [=m] && !UML && SND [=m] && SND_SOC [=m] && SND_ATMEL_SOC [=m] && ATMEL_SSC [=m]
    
    WARNING: unmet direct dependencies detected for SND_ATMEL_SOC_SSC_DMA
      Depends on [n]: SOUND [=m] && !UML && SND [=m] && SND_SOC [=m] && SND_ATMEL_SOC [=m] && ATMEL_SSC [=m] && HAS_DMA [=n]
      Selected by [m]:
      - SND_ATMEL_SOC_WM8904 [=m] && SOUND [=m] && !UML && SND [=m] && SND_SOC [=m] && SND_ATMEL_SOC [=m] && (ARCH_AT91 || COMPILE_TEST [=y]) && ATMEL_SSC [=m] && I2C [=m]
      - SND_AT91_SOC_SAM9X5_WM8731 [=m] && SOUND [=m] && !UML && SND [=m] && SND_SOC [=m] && SND_ATMEL_SOC [=m] && (ARCH_AT91 || COMPILE_TEST [=y]) && ATMEL_SSC [=m] && SND_SOC_I2C_AND_SPI [=m]
    
    Signed-off-by: Randy Dunlap <rdunlap@infradead.org>
    Reviewed-by: Codrin Ciubotariu <codrin.ciubotariu@microchip.com>
    Acked-by: Alexandre Belloni <alexandre.belloni@bootlin.com>
    Link: https://lore.kernel.org/r/20210707214752.3831-1-rdunlap@infradead.org
    Signed-off-by: Mark Brown <broonie@kernel.org>
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit 01db625eb1b03f12bfaa198a460a939ab62ef64e
Author: Geert Uytterhoeven <geert+renesas@glider.be>
Date:   Mon Feb 8 15:38:55 2021 +0100

    soc: rockchip: ROCKCHIP_GRF should not default to y, unconditionally
    
    [ Upstream commit 2a1c55d4762dd34a8b0f2e36fb01b7b16b60735b ]
    
    Merely enabling CONFIG_COMPILE_TEST should not enable additional code.
    To fix this, restrict the automatic enabling of ROCKCHIP_GRF to
    ARCH_ROCKCHIP, and ask the user in case of compile-testing.
    
    Fixes: 4c58063d4258f6be ("soc: rockchip: add driver handling grf setup")
    Signed-off-by: Geert Uytterhoeven <geert+renesas@glider.be>
    Link: https://lore.kernel.org/r/20210208143855.418374-1-geert+renesas@glider.be
    Signed-off-by: Heiko Stuebner <heiko@sntech.de>
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit ab642cd7bf1859569dc93a67db980bf883096ab5
Author: Hongbo Li <herberthbli@tencent.com>
Date:   Thu Aug 5 16:53:32 2021 +0800

    lib/mpi: use kcalloc in mpi_resize
    
    [ Upstream commit b6f756726e4dfe75be1883f6a0202dcecdc801ab ]
    
    We should set the additional space to 0 in mpi_resize().
    So use kcalloc() instead of kmalloc_array().
    
    In lib/mpi/ec.c:
    /****************
     * Resize the array of A to NLIMBS. the additional space is cleared
     * (set to 0) [done by m_realloc()]
     */
    int mpi_resize(MPI a, unsigned nlimbs)
    
    Like the comment of kernel's mpi_resize() said, the additional space
    need to be set to 0, but when a->d is not NULL, it does not set.
    
    The kernel's mpi lib is from libgcrypt, the mpi resize in libgcrypt
    is _gcry_mpi_resize() which set the additional space to 0.
    
    This bug may cause mpi api which use mpi_resize() get wrong result
    under the condition of using the additional space without initiation.
    If this condition is not met, the bug would not be triggered.
    Currently in kernel, rsa, sm2 and dh use mpi lib, and they works well,
    so the bug is not triggered in these cases.
    
    add_points_edwards() use the additional space directly, so it will
    get a wrong result.
    
    Fixes: cdec9cb5167a ("crypto: GnuPG based MPI lib - source files (part 1)")
    Signed-off-by: Hongbo Li <herberthbli@tencent.com>
    Signed-off-by: Herbert Xu <herbert@gondor.apana.org.au>
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit 7441a768c741fd74465b176e722d163bb8f2d074
Author: Geert Uytterhoeven <geert+renesas@glider.be>
Date:   Mon Feb 8 15:38:55 2021 +0100

    soc: rockchip: ROCKCHIP_GRF should not default to y, unconditionally
    
    [ Upstream commit 2a1c55d4762dd34a8b0f2e36fb01b7b16b60735b ]
    
    Merely enabling CONFIG_COMPILE_TEST should not enable additional code.
    To fix this, restrict the automatic enabling of ROCKCHIP_GRF to
    ARCH_ROCKCHIP, and ask the user in case of compile-testing.
    
    Fixes: 4c58063d4258f6be ("soc: rockchip: add driver handling grf setup")
    Signed-off-by: Geert Uytterhoeven <geert+renesas@glider.be>
    Link: https://lore.kernel.org/r/20210208143855.418374-1-geert+renesas@glider.be
    Signed-off-by: Heiko Stuebner <heiko@sntech.de>
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit d4d016caa4b85b9aa98d7ec8c84e928621a614bc
Author: Linus Torvalds <torvalds@linux-foundation.org>
Date:   Sat Sep 18 14:45:48 2021 -0700

    alpha: move __udiv_qrnnd library function to arch/alpha/lib/
    
    We already had the implementation for __udiv_qrnnd (unsigned divide for
    multi-precision arithmetic) as part of the alpha math emulation code.
    
    But you can disable the math emulation code - even if you shouldn't -
    and then the MPI code that actually wants this functionality (and is
    needed by various crypto functions) will fail to build.
    
    So move the extended-precision divide code to be a regular library
    function, just like all the regular division code is.  That way ie is
    available regardless of math-emulation.
    
    Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>

commit cd395d529faf46bd7fd799852a659ca1bd650a27
Author: Linus Torvalds <torvalds@linux-foundation.org>
Date:   Sat Sep 18 11:15:01 2021 -0700

    tgafb: clarify dependencies
    
    The TGA boards were based on the DECchip 21030 PCI graphics accelerator
    used mainly for alpha, and existed in a TURBOchannel (TC) version for
    the DECstation (MIPS) workstations.
    
    However, the config option for the TGA code is a bit confused, and says
    
            depends on FB && (ALPHA || TC)
    
    because people didn't really want to enable the option for random PCI
    environments, so the "ALPHA" stands in for that case (while the TC case
    is then the MIPS DECstation case).
    
    So that config dependency is kind of a mixture of architecture and bus
    choices.  But it's incorrect, in that there were non-PCI-based alpha
    hardware, and then the driver just causes warnings:
    
      drivers/video/fbdev/tgafb.c:1532:13: error: tgafb_unregister defined but not used [-Werror=unused-function]
       1532 | static void tgafb_unregister(struct device *dev)
            |             ^~~~~~~~~~~~~~~~
      drivers/video/fbdev/tgafb.c:1387:12: error: tgafb_register defined but not used [-Werror=unused-function]
       1387 | static int tgafb_register(struct device *dev)
            |            ^~~~~~~~~~~~~~
    
    so let's make the config option dependencies a bit more explict:
    
            depends on FB
            depends on PCI || TC
            depends on ALPHA || TC
    
    where that first "FB" is the software configuration dependency, the
    second "PCI || TC" is the hardware bus dependency, while that final
    "ALPHA || TC" dependency is the "don't bother asking except for these
    situations.
    
    We could make that third case have "COMPILE_TEST" as an option, and mark
    the register/unregister functions as __maybe_unused, but I'm not sure
    it's really worth it.
    
    Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>

commit 3afd2af53a59327caf21aaadbf5c9b6f3fc0117b
Author: Arnd Bergmann <arnd@arndb.de>
Date:   Mon Aug 9 18:01:31 2021 +1000

    m68knommu: only set CONFIG_ISA_DMA_API for ColdFire sub-arch
    
    [ Upstream commit db87db65c1059f3be04506d122f8ec9b2fa3b05e ]
    
    > Hi Arnd,
    >
    > First bad commit (maybe != root cause):
    >
    > tree:   https://git.kernel.org/pub/scm/linux/kernel/git/next/linux-next.git master
    > head:   2f73937c9aa561e2082839bc1a8efaac75d6e244
    > commit: 47fd22f2b84765a2f7e3f150282497b902624547 [4771/5318] cs89x0: rework driver configuration
    > config: m68k-randconfig-c003-20210804 (attached as .config)
    > compiler: m68k-linux-gcc (GCC) 10.3.0
    > reproduce (this is a W=1 build):
    >         wget https://raw.githubusercontent.com/intel/lkp-tests/master/sbin/make.cross -O ~/bin/make.cross
    >         chmod +x ~/bin/make.cross
    >         # https://git.kernel.org/pub/scm/linux/kernel/git/next/linux-next.git/commit/?id=47fd22f2b84765a2f7e3f150282497b902624547
    >         git remote add linux-next https://git.kernel.org/pub/scm/linux/kernel/git/next/linux-next.git
    >         git fetch --no-tags linux-next master
    >         git checkout 47fd22f2b84765a2f7e3f150282497b902624547
    >         # save the attached .config to linux build tree
    >         COMPILER_INSTALL_PATH=$HOME/0day COMPILER=gcc-10.3.0 make.cross ARCH=m68k
    >
    > If you fix the issue, kindly add following tag as appropriate
    > Reported-by: kernel test robot <lkp@intel.com>
    >
    > All errors (new ones prefixed by >>):
    >
    >    In file included from include/linux/kernel.h:19,
    >                     from include/linux/list.h:9,
    >                     from include/linux/module.h:12,
    >                     from drivers/net/ethernet/cirrus/cs89x0.c:51:
    >    drivers/net/ethernet/cirrus/cs89x0.c: In function 'net_open':
    >    drivers/net/ethernet/cirrus/cs89x0.c:897:20: error: implicit declaration of function 'isa_virt_to_bus'; did you mean 'virt_to_bus'? [-Werror=implicit-function-declaration]
    >      897 |     (unsigned long)isa_virt_to_bus(lp->dma_buff));
    >          |                    ^~~~~~~~~~~~~~~
    >    include/linux/printk.h:141:17: note: in definition of macro 'no_printk'
    >      141 |   printk(fmt, ##__VA_ARGS__);  \
    >          |                 ^~~~~~~~~~~
    >    drivers/net/ethernet/cirrus/cs89x0.c:86:3: note: in expansion of macro 'pr_debug'
    >       86 |   pr_##level(fmt, ##__VA_ARGS__);   \
    >          |   ^~~
    >    drivers/net/ethernet/cirrus/cs89x0.c:894:3: note: in expansion of macro 'cs89_dbg'
    >      894 |   cs89_dbg(1, debug, "%s: dma %lx %lx\n",
    >          |   ^~~~~~~~
    > >> drivers/net/ethernet/cirrus/cs89x0.c:914:3: error: implicit declaration of function 'disable_dma'; did you mean 'disable_irq'? [-Werror=implicit-function-declaration]
    
    As far as I can tell, this is a bug with the m68kmmu architecture, not
    with my driver:
    The CONFIG_ISA_DMA_API option is provided for coldfire, which implements it,
    but dragonball also sets the option as a side-effect, without actually
    implementing
    the interfaces. The patch below should fix it.
    
    Signed-off-by: Arnd Bergmann <arnd@arndb.de>
    Signed-off-by: Greg Ungerer <gerg@linux-m68k.org>
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit 9cfd0da89e81254302463a0da67c88e961aca151
Author: Randy Dunlap <rdunlap@infradead.org>
Date:   Wed Jul 7 14:47:52 2021 -0700

    ASoC: atmel: ATMEL drivers don't need HAS_DMA
    
    [ Upstream commit 6c5c659dfe3f02e08054a6c20019e3886618b512 ]
    
    On a config (such as arch/sh/) which does not set HAS_DMA when MMU
    is not set, several ATMEL ASoC drivers select symbols that cause
    kconfig warnings. There is one "depends on HAS_DMA" which is no longer
    needed. Dropping it eliminates the kconfig warnings and still builds
    with no problems reported.
    
    Fix the following kconfig warnings:
    
    WARNING: unmet direct dependencies detected for SND_ATMEL_SOC_PDC
      Depends on [n]: SOUND [=m] && !UML && SND [=m] && SND_SOC [=m] && SND_ATMEL_SOC [=m] && HAS_DMA [=n]
      Selected by [m]:
      - SND_ATMEL_SOC_SSC [=m] && SOUND [=m] && !UML && SND [=m] && SND_SOC [=m] && SND_ATMEL_SOC [=m]
      - SND_ATMEL_SOC_SSC_PDC [=m] && SOUND [=m] && !UML && SND [=m] && SND_SOC [=m] && SND_ATMEL_SOC [=m] && ATMEL_SSC [=m]
    
    WARNING: unmet direct dependencies detected for SND_ATMEL_SOC_SSC_PDC
      Depends on [n]: SOUND [=m] && !UML && SND [=m] && SND_SOC [=m] && SND_ATMEL_SOC [=m] && ATMEL_SSC [=m] && HAS_DMA [=n]
      Selected by [m]:
      - SND_AT91_SOC_SAM9G20_WM8731 [=m] && SOUND [=m] && !UML && SND [=m] && SND_SOC [=m] && SND_ATMEL_SOC [=m] && (ARCH_AT91 || COMPILE_TEST [=y]) && ATMEL_SSC [=m] && SND_SOC_I2C_AND_SPI [=m]
    
    WARNING: unmet direct dependencies detected for SND_ATMEL_SOC_SSC
      Depends on [n]: SOUND [=m] && !UML && SND [=m] && SND_SOC [=m] && SND_ATMEL_SOC [=m] && HAS_DMA [=n]
      Selected by [m]:
      - SND_ATMEL_SOC_SSC_DMA [=m] && SOUND [=m] && !UML && SND [=m] && SND_SOC [=m] && SND_ATMEL_SOC [=m] && ATMEL_SSC [=m]
    
    WARNING: unmet direct dependencies detected for SND_ATMEL_SOC_SSC_DMA
      Depends on [n]: SOUND [=m] && !UML && SND [=m] && SND_SOC [=m] && SND_ATMEL_SOC [=m] && ATMEL_SSC [=m] && HAS_DMA [=n]
      Selected by [m]:
      - SND_ATMEL_SOC_WM8904 [=m] && SOUND [=m] && !UML && SND [=m] && SND_SOC [=m] && SND_ATMEL_SOC [=m] && (ARCH_AT91 || COMPILE_TEST [=y]) && ATMEL_SSC [=m] && I2C [=m]
      - SND_AT91_SOC_SAM9X5_WM8731 [=m] && SOUND [=m] && !UML && SND [=m] && SND_SOC [=m] && SND_ATMEL_SOC [=m] && (ARCH_AT91 || COMPILE_TEST [=y]) && ATMEL_SSC [=m] && SND_SOC_I2C_AND_SPI [=m]
    
    Signed-off-by: Randy Dunlap <rdunlap@infradead.org>
    Reviewed-by: Codrin Ciubotariu <codrin.ciubotariu@microchip.com>
    Acked-by: Alexandre Belloni <alexandre.belloni@bootlin.com>
    Link: https://lore.kernel.org/r/20210707214752.3831-1-rdunlap@infradead.org
    Signed-off-by: Mark Brown <broonie@kernel.org>
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit 6e57056734e02bd31be43bb15ed3311b36d69da7
Author: Arnd Bergmann <arnd@arndb.de>
Date:   Mon Aug 9 18:01:31 2021 +1000

    m68knommu: only set CONFIG_ISA_DMA_API for ColdFire sub-arch
    
    [ Upstream commit db87db65c1059f3be04506d122f8ec9b2fa3b05e ]
    
    > Hi Arnd,
    >
    > First bad commit (maybe != root cause):
    >
    > tree:   https://git.kernel.org/pub/scm/linux/kernel/git/next/linux-next.git master
    > head:   2f73937c9aa561e2082839bc1a8efaac75d6e244
    > commit: 47fd22f2b84765a2f7e3f150282497b902624547 [4771/5318] cs89x0: rework driver configuration
    > config: m68k-randconfig-c003-20210804 (attached as .config)
    > compiler: m68k-linux-gcc (GCC) 10.3.0
    > reproduce (this is a W=1 build):
    >         wget https://raw.githubusercontent.com/intel/lkp-tests/master/sbin/make.cross -O ~/bin/make.cross
    >         chmod +x ~/bin/make.cross
    >         # https://git.kernel.org/pub/scm/linux/kernel/git/next/linux-next.git/commit/?id=47fd22f2b84765a2f7e3f150282497b902624547
    >         git remote add linux-next https://git.kernel.org/pub/scm/linux/kernel/git/next/linux-next.git
    >         git fetch --no-tags linux-next master
    >         git checkout 47fd22f2b84765a2f7e3f150282497b902624547
    >         # save the attached .config to linux build tree
    >         COMPILER_INSTALL_PATH=$HOME/0day COMPILER=gcc-10.3.0 make.cross ARCH=m68k
    >
    > If you fix the issue, kindly add following tag as appropriate
    > Reported-by: kernel test robot <lkp@intel.com>
    >
    > All errors (new ones prefixed by >>):
    >
    >    In file included from include/linux/kernel.h:19,
    >                     from include/linux/list.h:9,
    >                     from include/linux/module.h:12,
    >                     from drivers/net/ethernet/cirrus/cs89x0.c:51:
    >    drivers/net/ethernet/cirrus/cs89x0.c: In function 'net_open':
    >    drivers/net/ethernet/cirrus/cs89x0.c:897:20: error: implicit declaration of function 'isa_virt_to_bus'; did you mean 'virt_to_bus'? [-Werror=implicit-function-declaration]
    >      897 |     (unsigned long)isa_virt_to_bus(lp->dma_buff));
    >          |                    ^~~~~~~~~~~~~~~
    >    include/linux/printk.h:141:17: note: in definition of macro 'no_printk'
    >      141 |   printk(fmt, ##__VA_ARGS__);  \
    >          |                 ^~~~~~~~~~~
    >    drivers/net/ethernet/cirrus/cs89x0.c:86:3: note: in expansion of macro 'pr_debug'
    >       86 |   pr_##level(fmt, ##__VA_ARGS__);   \
    >          |   ^~~
    >    drivers/net/ethernet/cirrus/cs89x0.c:894:3: note: in expansion of macro 'cs89_dbg'
    >      894 |   cs89_dbg(1, debug, "%s: dma %lx %lx\n",
    >          |   ^~~~~~~~
    > >> drivers/net/ethernet/cirrus/cs89x0.c:914:3: error: implicit declaration of function 'disable_dma'; did you mean 'disable_irq'? [-Werror=implicit-function-declaration]
    
    As far as I can tell, this is a bug with the m68kmmu architecture, not
    with my driver:
    The CONFIG_ISA_DMA_API option is provided for coldfire, which implements it,
    but dragonball also sets the option as a side-effect, without actually
    implementing
    the interfaces. The patch below should fix it.
    
    Signed-off-by: Arnd Bergmann <arnd@arndb.de>
    Signed-off-by: Greg Ungerer <gerg@linux-m68k.org>
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit f62786b221fb6c87adda90ced0c1eeaaed981ca6
Author: Randy Dunlap <rdunlap@infradead.org>
Date:   Wed Jul 7 14:47:52 2021 -0700

    ASoC: atmel: ATMEL drivers don't need HAS_DMA
    
    [ Upstream commit 6c5c659dfe3f02e08054a6c20019e3886618b512 ]
    
    On a config (such as arch/sh/) which does not set HAS_DMA when MMU
    is not set, several ATMEL ASoC drivers select symbols that cause
    kconfig warnings. There is one "depends on HAS_DMA" which is no longer
    needed. Dropping it eliminates the kconfig warnings and still builds
    with no problems reported.
    
    Fix the following kconfig warnings:
    
    WARNING: unmet direct dependencies detected for SND_ATMEL_SOC_PDC
      Depends on [n]: SOUND [=m] && !UML && SND [=m] && SND_SOC [=m] && SND_ATMEL_SOC [=m] && HAS_DMA [=n]
      Selected by [m]:
      - SND_ATMEL_SOC_SSC [=m] && SOUND [=m] && !UML && SND [=m] && SND_SOC [=m] && SND_ATMEL_SOC [=m]
      - SND_ATMEL_SOC_SSC_PDC [=m] && SOUND [=m] && !UML && SND [=m] && SND_SOC [=m] && SND_ATMEL_SOC [=m] && ATMEL_SSC [=m]
    
    WARNING: unmet direct dependencies detected for SND_ATMEL_SOC_SSC_PDC
      Depends on [n]: SOUND [=m] && !UML && SND [=m] && SND_SOC [=m] && SND_ATMEL_SOC [=m] && ATMEL_SSC [=m] && HAS_DMA [=n]
      Selected by [m]:
      - SND_AT91_SOC_SAM9G20_WM8731 [=m] && SOUND [=m] && !UML && SND [=m] && SND_SOC [=m] && SND_ATMEL_SOC [=m] && (ARCH_AT91 || COMPILE_TEST [=y]) && ATMEL_SSC [=m] && SND_SOC_I2C_AND_SPI [=m]
    
    WARNING: unmet direct dependencies detected for SND_ATMEL_SOC_SSC
      Depends on [n]: SOUND [=m] && !UML && SND [=m] && SND_SOC [=m] && SND_ATMEL_SOC [=m] && HAS_DMA [=n]
      Selected by [m]:
      - SND_ATMEL_SOC_SSC_DMA [=m] && SOUND [=m] && !UML && SND [=m] && SND_SOC [=m] && SND_ATMEL_SOC [=m] && ATMEL_SSC [=m]
    
    WARNING: unmet direct dependencies detected for SND_ATMEL_SOC_SSC_DMA
      Depends on [n]: SOUND [=m] && !UML && SND [=m] && SND_SOC [=m] && SND_ATMEL_SOC [=m] && ATMEL_SSC [=m] && HAS_DMA [=n]
      Selected by [m]:
      - SND_ATMEL_SOC_WM8904 [=m] && SOUND [=m] && !UML && SND [=m] && SND_SOC [=m] && SND_ATMEL_SOC [=m] && (ARCH_AT91 || COMPILE_TEST [=y]) && ATMEL_SSC [=m] && I2C [=m]
      - SND_AT91_SOC_SAM9X5_WM8731 [=m] && SOUND [=m] && !UML && SND [=m] && SND_SOC [=m] && SND_ATMEL_SOC [=m] && (ARCH_AT91 || COMPILE_TEST [=y]) && ATMEL_SSC [=m] && SND_SOC_I2C_AND_SPI [=m]
    
    Signed-off-by: Randy Dunlap <rdunlap@infradead.org>
    Reviewed-by: Codrin Ciubotariu <codrin.ciubotariu@microchip.com>
    Acked-by: Alexandre Belloni <alexandre.belloni@bootlin.com>
    Link: https://lore.kernel.org/r/20210707214752.3831-1-rdunlap@infradead.org
    Signed-off-by: Mark Brown <broonie@kernel.org>
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit 87ae522e467e17a13b796e2cb595f9c3943e4d5e
Author: Arnd Bergmann <arnd@arndb.de>
Date:   Mon Aug 9 18:01:31 2021 +1000

    m68knommu: only set CONFIG_ISA_DMA_API for ColdFire sub-arch
    
    [ Upstream commit db87db65c1059f3be04506d122f8ec9b2fa3b05e ]
    
    > Hi Arnd,
    >
    > First bad commit (maybe != root cause):
    >
    > tree:   https://git.kernel.org/pub/scm/linux/kernel/git/next/linux-next.git master
    > head:   2f73937c9aa561e2082839bc1a8efaac75d6e244
    > commit: 47fd22f2b84765a2f7e3f150282497b902624547 [4771/5318] cs89x0: rework driver configuration
    > config: m68k-randconfig-c003-20210804 (attached as .config)
    > compiler: m68k-linux-gcc (GCC) 10.3.0
    > reproduce (this is a W=1 build):
    >         wget https://raw.githubusercontent.com/intel/lkp-tests/master/sbin/make.cross -O ~/bin/make.cross
    >         chmod +x ~/bin/make.cross
    >         # https://git.kernel.org/pub/scm/linux/kernel/git/next/linux-next.git/commit/?id=47fd22f2b84765a2f7e3f150282497b902624547
    >         git remote add linux-next https://git.kernel.org/pub/scm/linux/kernel/git/next/linux-next.git
    >         git fetch --no-tags linux-next master
    >         git checkout 47fd22f2b84765a2f7e3f150282497b902624547
    >         # save the attached .config to linux build tree
    >         COMPILER_INSTALL_PATH=$HOME/0day COMPILER=gcc-10.3.0 make.cross ARCH=m68k
    >
    > If you fix the issue, kindly add following tag as appropriate
    > Reported-by: kernel test robot <lkp@intel.com>
    >
    > All errors (new ones prefixed by >>):
    >
    >    In file included from include/linux/kernel.h:19,
    >                     from include/linux/list.h:9,
    >                     from include/linux/module.h:12,
    >                     from drivers/net/ethernet/cirrus/cs89x0.c:51:
    >    drivers/net/ethernet/cirrus/cs89x0.c: In function 'net_open':
    >    drivers/net/ethernet/cirrus/cs89x0.c:897:20: error: implicit declaration of function 'isa_virt_to_bus'; did you mean 'virt_to_bus'? [-Werror=implicit-function-declaration]
    >      897 |     (unsigned long)isa_virt_to_bus(lp->dma_buff));
    >          |                    ^~~~~~~~~~~~~~~
    >    include/linux/printk.h:141:17: note: in definition of macro 'no_printk'
    >      141 |   printk(fmt, ##__VA_ARGS__);  \
    >          |                 ^~~~~~~~~~~
    >    drivers/net/ethernet/cirrus/cs89x0.c:86:3: note: in expansion of macro 'pr_debug'
    >       86 |   pr_##level(fmt, ##__VA_ARGS__);   \
    >          |   ^~~
    >    drivers/net/ethernet/cirrus/cs89x0.c:894:3: note: in expansion of macro 'cs89_dbg'
    >      894 |   cs89_dbg(1, debug, "%s: dma %lx %lx\n",
    >          |   ^~~~~~~~
    > >> drivers/net/ethernet/cirrus/cs89x0.c:914:3: error: implicit declaration of function 'disable_dma'; did you mean 'disable_irq'? [-Werror=implicit-function-declaration]
    
    As far as I can tell, this is a bug with the m68kmmu architecture, not
    with my driver:
    The CONFIG_ISA_DMA_API option is provided for coldfire, which implements it,
    but dragonball also sets the option as a side-effect, without actually
    implementing
    the interfaces. The patch below should fix it.
    
    Signed-off-by: Arnd Bergmann <arnd@arndb.de>
    Signed-off-by: Greg Ungerer <gerg@linux-m68k.org>
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit 2048907d8cb7b295a9efd86b18f6f11e3d602b92
Author: Randy Dunlap <rdunlap@infradead.org>
Date:   Wed Jul 7 14:47:52 2021 -0700

    ASoC: atmel: ATMEL drivers don't need HAS_DMA
    
    [ Upstream commit 6c5c659dfe3f02e08054a6c20019e3886618b512 ]
    
    On a config (such as arch/sh/) which does not set HAS_DMA when MMU
    is not set, several ATMEL ASoC drivers select symbols that cause
    kconfig warnings. There is one "depends on HAS_DMA" which is no longer
    needed. Dropping it eliminates the kconfig warnings and still builds
    with no problems reported.
    
    Fix the following kconfig warnings:
    
    WARNING: unmet direct dependencies detected for SND_ATMEL_SOC_PDC
      Depends on [n]: SOUND [=m] && !UML && SND [=m] && SND_SOC [=m] && SND_ATMEL_SOC [=m] && HAS_DMA [=n]
      Selected by [m]:
      - SND_ATMEL_SOC_SSC [=m] && SOUND [=m] && !UML && SND [=m] && SND_SOC [=m] && SND_ATMEL_SOC [=m]
      - SND_ATMEL_SOC_SSC_PDC [=m] && SOUND [=m] && !UML && SND [=m] && SND_SOC [=m] && SND_ATMEL_SOC [=m] && ATMEL_SSC [=m]
    
    WARNING: unmet direct dependencies detected for SND_ATMEL_SOC_SSC_PDC
      Depends on [n]: SOUND [=m] && !UML && SND [=m] && SND_SOC [=m] && SND_ATMEL_SOC [=m] && ATMEL_SSC [=m] && HAS_DMA [=n]
      Selected by [m]:
      - SND_AT91_SOC_SAM9G20_WM8731 [=m] && SOUND [=m] && !UML && SND [=m] && SND_SOC [=m] && SND_ATMEL_SOC [=m] && (ARCH_AT91 || COMPILE_TEST [=y]) && ATMEL_SSC [=m] && SND_SOC_I2C_AND_SPI [=m]
    
    WARNING: unmet direct dependencies detected for SND_ATMEL_SOC_SSC
      Depends on [n]: SOUND [=m] && !UML && SND [=m] && SND_SOC [=m] && SND_ATMEL_SOC [=m] && HAS_DMA [=n]
      Selected by [m]:
      - SND_ATMEL_SOC_SSC_DMA [=m] && SOUND [=m] && !UML && SND [=m] && SND_SOC [=m] && SND_ATMEL_SOC [=m] && ATMEL_SSC [=m]
    
    WARNING: unmet direct dependencies detected for SND_ATMEL_SOC_SSC_DMA
      Depends on [n]: SOUND [=m] && !UML && SND [=m] && SND_SOC [=m] && SND_ATMEL_SOC [=m] && ATMEL_SSC [=m] && HAS_DMA [=n]
      Selected by [m]:
      - SND_ATMEL_SOC_WM8904 [=m] && SOUND [=m] && !UML && SND [=m] && SND_SOC [=m] && SND_ATMEL_SOC [=m] && (ARCH_AT91 || COMPILE_TEST [=y]) && ATMEL_SSC [=m] && I2C [=m]
      - SND_AT91_SOC_SAM9X5_WM8731 [=m] && SOUND [=m] && !UML && SND [=m] && SND_SOC [=m] && SND_ATMEL_SOC [=m] && (ARCH_AT91 || COMPILE_TEST [=y]) && ATMEL_SSC [=m] && SND_SOC_I2C_AND_SPI [=m]
    
    Signed-off-by: Randy Dunlap <rdunlap@infradead.org>
    Reviewed-by: Codrin Ciubotariu <codrin.ciubotariu@microchip.com>
    Acked-by: Alexandre Belloni <alexandre.belloni@bootlin.com>
    Link: https://lore.kernel.org/r/20210707214752.3831-1-rdunlap@infradead.org
    Signed-off-by: Mark Brown <broonie@kernel.org>
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit d5e93b3374e465700fb8c11c955a4433cad5b17e
Author: Cai Huoqing <caihuoqing@baidu.com>
Date:   Wed Aug 25 12:05:52 2021 +0800

    hwrng: Kconfig - Add helper dependency on COMPILE_TEST
    
    it's helpful to do a complie test in other platform(e.g.X86)
    
    Signed-off-by: Cai Huoqing <caihuoqing@baidu.com>
    Signed-off-by: Herbert Xu <herbert@gondor.apana.org.au>

commit fc0c0548c1a2e676d3a928aaed70f2d4d254e395
Merge: 3c0d2a46c014 ee8a9600b539
Author: Linus Torvalds <torvalds@linux-foundation.org>
Date:   Thu Sep 16 13:05:42 2021 -0700

    Merge tag 'net-5.15-rc2' of git://git.kernel.org/pub/scm/linux/kernel/git/netdev/net
    
    Pull networking fixes from Jakub Kicinski:
     "Including fixes from bpf.
    
      Current release - regressions:
    
       - vhost_net: fix OoB on sendmsg() failure
    
       - mlx5: bridge, fix uninitialized variable usage
    
       - bnxt_en: fix error recovery regression
    
      Current release - new code bugs:
    
       - bpf, mm: fix lockdep warning triggered by stack_map_get_build_id_offset()
    
      Previous releases - regressions:
    
       - r6040: restore MDIO clock frequency after MAC reset
    
       - tcp: fix tp->undo_retrans accounting in tcp_sacktag_one()
    
       - dsa: flush switchdev workqueue before tearing down CPU/DSA ports
    
      Previous releases - always broken:
    
       - ptp: dp83640: don't define PAGE0, avoid compiler warning
    
       - igc: fix tunnel segmentation offloads
    
       - phylink: update SFP selected interface on advertising changes
    
       - stmmac: fix system hang caused by eee_ctrl_timer during suspend/resume
    
       - mlx5e: fix mutual exclusion between CQE compression and HW TS
    
      Misc:
    
       - bpf, cgroups: fix cgroup v2 fallback on v1/v2 mixed mode
    
       - sfc: fallback for lack of xdp tx queues
    
       - hns3: add option to turn off page pool feature"
    
    * tag 'net-5.15-rc2' of git://git.kernel.org/pub/scm/linux/kernel/git/netdev/net: (67 commits)
      mlxbf_gige: clear valid_polarity upon open
      igc: fix tunnel offloading
      net/{mlx5|nfp|bnxt}: Remove unnecessary RTNL lock assert
      net: wan: wanxl: define CROSS_COMPILE_M68K
      selftests: nci: replace unsigned int with int
      net: dsa: flush switchdev workqueue before tearing down CPU/DSA ports
      Revert "net: phy: Uniform PHY driver access"
      net: dsa: destroy the phylink instance on any error in dsa_slave_phy_setup
      ptp: dp83640: don't define PAGE0
      bnx2x: Fix enabling network interfaces without VFs
      Revert "Revert "ipv4: fix memory leaks in ip_cmsg_send() callers""
      tcp: fix tp->undo_retrans accounting in tcp_sacktag_one()
      net-caif: avoid user-triggerable WARN_ON(1)
      bpf, selftests: Add test case for mixed cgroup v1/v2
      bpf, selftests: Add cgroup v1 net_cls classid helpers
      bpf, cgroups: Fix cgroup v2 fallback on v1/v2 mixed mode
      bpf: Add oversize check before call kvcalloc()
      net: hns3: fix the timing issue of VF clearing interrupt sources
      net: hns3: fix the exception when query imp info
      net: hns3: disable mac in flr process
      ...

commit 84fb7dfc7463afcba61281f36535576a7f7b0626
Author: Adam Borowski <kilobyte@angband.pl>
Date:   Sun Sep 12 23:23:21 2021 +0200

    net: wan: wanxl: define CROSS_COMPILE_M68K
    
    It was used but never set.  The hardcoded value from before the dawn of
    time was non-standard; the usual name for cross-tools is $TRIPLET-$TOOL
    
    Signed-off-by: Adam Borowski <kilobyte@angband.pl>
    Signed-off-by: David S. Miller <davem@davemloft.net>

commit a2696604850dabc0116e065461a1bf6c77001a83
Author: Geert Uytterhoeven <geert+renesas@glider.be>
Date:   Mon Feb 8 15:38:55 2021 +0100

    soc: rockchip: ROCKCHIP_GRF should not default to y, unconditionally
    
    [ Upstream commit 2a1c55d4762dd34a8b0f2e36fb01b7b16b60735b ]
    
    Merely enabling CONFIG_COMPILE_TEST should not enable additional code.
    To fix this, restrict the automatic enabling of ROCKCHIP_GRF to
    ARCH_ROCKCHIP, and ask the user in case of compile-testing.
    
    Fixes: 4c58063d4258f6be ("soc: rockchip: add driver handling grf setup")
    Signed-off-by: Geert Uytterhoeven <geert+renesas@glider.be>
    Link: https://lore.kernel.org/r/20210208143855.418374-1-geert+renesas@glider.be
    Signed-off-by: Heiko Stuebner <heiko@sntech.de>
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit 1351a4663c14321ce31dfb604e5aadee25ac717d
Author: Hongbo Li <herberthbli@tencent.com>
Date:   Thu Aug 5 16:53:32 2021 +0800

    lib/mpi: use kcalloc in mpi_resize
    
    [ Upstream commit b6f756726e4dfe75be1883f6a0202dcecdc801ab ]
    
    We should set the additional space to 0 in mpi_resize().
    So use kcalloc() instead of kmalloc_array().
    
    In lib/mpi/ec.c:
    /****************
     * Resize the array of A to NLIMBS. the additional space is cleared
     * (set to 0) [done by m_realloc()]
     */
    int mpi_resize(MPI a, unsigned nlimbs)
    
    Like the comment of kernel's mpi_resize() said, the additional space
    need to be set to 0, but when a->d is not NULL, it does not set.
    
    The kernel's mpi lib is from libgcrypt, the mpi resize in libgcrypt
    is _gcry_mpi_resize() which set the additional space to 0.
    
    This bug may cause mpi api which use mpi_resize() get wrong result
    under the condition of using the additional space without initiation.
    If this condition is not met, the bug would not be triggered.
    Currently in kernel, rsa, sm2 and dh use mpi lib, and they works well,
    so the bug is not triggered in these cases.
    
    add_points_edwards() use the additional space directly, so it will
    get a wrong result.
    
    Fixes: cdec9cb5167a ("crypto: GnuPG based MPI lib - source files (part 1)")
    Signed-off-by: Hongbo Li <herberthbli@tencent.com>
    Signed-off-by: Herbert Xu <herbert@gondor.apana.org.au>
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit 65b799eb3b5acad34b2cffaa50959678a41b1b17
Author: Geert Uytterhoeven <geert+renesas@glider.be>
Date:   Mon Feb 8 15:38:55 2021 +0100

    soc: rockchip: ROCKCHIP_GRF should not default to y, unconditionally
    
    [ Upstream commit 2a1c55d4762dd34a8b0f2e36fb01b7b16b60735b ]
    
    Merely enabling CONFIG_COMPILE_TEST should not enable additional code.
    To fix this, restrict the automatic enabling of ROCKCHIP_GRF to
    ARCH_ROCKCHIP, and ask the user in case of compile-testing.
    
    Fixes: 4c58063d4258f6be ("soc: rockchip: add driver handling grf setup")
    Signed-off-by: Geert Uytterhoeven <geert+renesas@glider.be>
    Link: https://lore.kernel.org/r/20210208143855.418374-1-geert+renesas@glider.be
    Signed-off-by: Heiko Stuebner <heiko@sntech.de>
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit 37e392af22c656eda041d66e8e85f52cf04efbdf
Author: Hongbo Li <herberthbli@tencent.com>
Date:   Thu Aug 5 16:53:32 2021 +0800

    lib/mpi: use kcalloc in mpi_resize
    
    [ Upstream commit b6f756726e4dfe75be1883f6a0202dcecdc801ab ]
    
    We should set the additional space to 0 in mpi_resize().
    So use kcalloc() instead of kmalloc_array().
    
    In lib/mpi/ec.c:
    /****************
     * Resize the array of A to NLIMBS. the additional space is cleared
     * (set to 0) [done by m_realloc()]
     */
    int mpi_resize(MPI a, unsigned nlimbs)
    
    Like the comment of kernel's mpi_resize() said, the additional space
    need to be set to 0, but when a->d is not NULL, it does not set.
    
    The kernel's mpi lib is from libgcrypt, the mpi resize in libgcrypt
    is _gcry_mpi_resize() which set the additional space to 0.
    
    This bug may cause mpi api which use mpi_resize() get wrong result
    under the condition of using the additional space without initiation.
    If this condition is not met, the bug would not be triggered.
    Currently in kernel, rsa, sm2 and dh use mpi lib, and they works well,
    so the bug is not triggered in these cases.
    
    add_points_edwards() use the additional space directly, so it will
    get a wrong result.
    
    Fixes: cdec9cb5167a ("crypto: GnuPG based MPI lib - source files (part 1)")
    Signed-off-by: Hongbo Li <herberthbli@tencent.com>
    Signed-off-by: Herbert Xu <herbert@gondor.apana.org.au>
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit 25fbfc31ceec99cec4e3284d911d6c975d8561e7
Author: Geert Uytterhoeven <geert+renesas@glider.be>
Date:   Mon Feb 8 15:38:55 2021 +0100

    soc: rockchip: ROCKCHIP_GRF should not default to y, unconditionally
    
    [ Upstream commit 2a1c55d4762dd34a8b0f2e36fb01b7b16b60735b ]
    
    Merely enabling CONFIG_COMPILE_TEST should not enable additional code.
    To fix this, restrict the automatic enabling of ROCKCHIP_GRF to
    ARCH_ROCKCHIP, and ask the user in case of compile-testing.
    
    Fixes: 4c58063d4258f6be ("soc: rockchip: add driver handling grf setup")
    Signed-off-by: Geert Uytterhoeven <geert+renesas@glider.be>
    Link: https://lore.kernel.org/r/20210208143855.418374-1-geert+renesas@glider.be
    Signed-off-by: Heiko Stuebner <heiko@sntech.de>
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit dde7ff1c197757f03d11dbfb2ef302d412e5ba61
Author: Hongbo Li <herberthbli@tencent.com>
Date:   Thu Aug 5 16:53:32 2021 +0800

    lib/mpi: use kcalloc in mpi_resize
    
    [ Upstream commit b6f756726e4dfe75be1883f6a0202dcecdc801ab ]
    
    We should set the additional space to 0 in mpi_resize().
    So use kcalloc() instead of kmalloc_array().
    
    In lib/mpi/ec.c:
    /****************
     * Resize the array of A to NLIMBS. the additional space is cleared
     * (set to 0) [done by m_realloc()]
     */
    int mpi_resize(MPI a, unsigned nlimbs)
    
    Like the comment of kernel's mpi_resize() said, the additional space
    need to be set to 0, but when a->d is not NULL, it does not set.
    
    The kernel's mpi lib is from libgcrypt, the mpi resize in libgcrypt
    is _gcry_mpi_resize() which set the additional space to 0.
    
    This bug may cause mpi api which use mpi_resize() get wrong result
    under the condition of using the additional space without initiation.
    If this condition is not met, the bug would not be triggered.
    Currently in kernel, rsa, sm2 and dh use mpi lib, and they works well,
    so the bug is not triggered in these cases.
    
    add_points_edwards() use the additional space directly, so it will
    get a wrong result.
    
    Fixes: cdec9cb5167a ("crypto: GnuPG based MPI lib - source files (part 1)")
    Signed-off-by: Hongbo Li <herberthbli@tencent.com>
    Signed-off-by: Herbert Xu <herbert@gondor.apana.org.au>
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit 34106f5260158dea7c6044fdcdf1b64973d7a3f5
Author: Geert Uytterhoeven <geert+renesas@glider.be>
Date:   Mon Feb 8 15:38:55 2021 +0100

    soc: rockchip: ROCKCHIP_GRF should not default to y, unconditionally
    
    [ Upstream commit 2a1c55d4762dd34a8b0f2e36fb01b7b16b60735b ]
    
    Merely enabling CONFIG_COMPILE_TEST should not enable additional code.
    To fix this, restrict the automatic enabling of ROCKCHIP_GRF to
    ARCH_ROCKCHIP, and ask the user in case of compile-testing.
    
    Fixes: 4c58063d4258f6be ("soc: rockchip: add driver handling grf setup")
    Signed-off-by: Geert Uytterhoeven <geert+renesas@glider.be>
    Link: https://lore.kernel.org/r/20210208143855.418374-1-geert+renesas@glider.be
    Signed-off-by: Heiko Stuebner <heiko@sntech.de>
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit 6b10d3d3a9ff260d734e0072a3b3792e4f1bbea5
Author: Hongbo Li <herberthbli@tencent.com>
Date:   Thu Aug 5 16:53:32 2021 +0800

    lib/mpi: use kcalloc in mpi_resize
    
    [ Upstream commit b6f756726e4dfe75be1883f6a0202dcecdc801ab ]
    
    We should set the additional space to 0 in mpi_resize().
    So use kcalloc() instead of kmalloc_array().
    
    In lib/mpi/ec.c:
    /****************
     * Resize the array of A to NLIMBS. the additional space is cleared
     * (set to 0) [done by m_realloc()]
     */
    int mpi_resize(MPI a, unsigned nlimbs)
    
    Like the comment of kernel's mpi_resize() said, the additional space
    need to be set to 0, but when a->d is not NULL, it does not set.
    
    The kernel's mpi lib is from libgcrypt, the mpi resize in libgcrypt
    is _gcry_mpi_resize() which set the additional space to 0.
    
    This bug may cause mpi api which use mpi_resize() get wrong result
    under the condition of using the additional space without initiation.
    If this condition is not met, the bug would not be triggered.
    Currently in kernel, rsa, sm2 and dh use mpi lib, and they works well,
    so the bug is not triggered in these cases.
    
    add_points_edwards() use the additional space directly, so it will
    get a wrong result.
    
    Fixes: cdec9cb5167a ("crypto: GnuPG based MPI lib - source files (part 1)")
    Signed-off-by: Hongbo Li <herberthbli@tencent.com>
    Signed-off-by: Herbert Xu <herbert@gondor.apana.org.au>
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit 3771449bc80fa494c15f366ce1fa9e3168332b6a
Author: John Clements <john.clements@amd.com>
Date:   Thu Sep 9 16:05:12 2021 +0800

    drm/amdgpu: Update RAS trigger error block support
    
    Added trigger error support for MP0/MP1/MPIO blocks
    
    Reviewed-by: Hawking Zhang <Hawking.Zhang@amd.com>
    Signed-off-by: John Clements <john.clements@amd.com>
    Signed-off-by: Alex Deucher <alexander.deucher@amd.com>

commit 4eb6bd55cfb22ffc20652732340c4962f3ac9a91
Author: Nick Desaulniers <ndesaulniers@google.com>
Date:   Fri Sep 10 16:40:39 2021 -0700

    compiler.h: drop fallback overflow checkers
    
    Once upgrading the minimum supported version of GCC to 5.1, we can drop
    the fallback code for !COMPILER_HAS_GENERIC_BUILTIN_OVERFLOW.
    
    This is effectively a revert of commit f0907827a8a9 ("compiler.h: enable
    builtin overflow checkers and add fallback code")
    
    Link: https://github.com/ClangBuiltLinux/linux/issues/1438#issuecomment-916745801
    Suggested-by: Rasmus Villemoes <linux@rasmusvillemoes.dk>
    Signed-off-by: Nick Desaulniers <ndesaulniers@google.com>
    Acked-by: Kees Cook <keescook@chromium.org>
    Reviewed-by: Nathan Chancellor <nathan@kernel.org>
    Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>

commit 76ae847497bc5207c479de5e2ac487270008b19b
Author: Nick Desaulniers <ndesaulniers@google.com>
Date:   Fri Sep 10 16:40:38 2021 -0700

    Documentation: raise minimum supported version of GCC to 5.1
    
    commit fad7cd3310db ("nbd: add the check to prevent overflow in
    __nbd_ioctl()") raised an issue from the fallback helpers added in
    commit f0907827a8a9 ("compiler.h: enable builtin overflow checkers and
    add fallback code")
    
    Specifically, the helpers for checking whether the results of a
    multiplication overflowed (__unsigned_mul_overflow,
    __signed_add_overflow) use the division operator when
    !COMPILER_HAS_GENERIC_BUILTIN_OVERFLOW.  This is problematic for 64b
    operands on 32b hosts.
    
    Also, because the macro is type agnostic, it is very difficult to write
    a similarly type generic macro that dispatches to one of:
     * div64_s64
     * div64_u64
     * div_s64
     * div_u64
    
    Raising the minimum supported versions allows us to remove all of the
    fallback helpers for !COMPILER_HAS_GENERIC_BUILTIN_OVERFLOW, instead
    dispatching the compiler builtins.
    
    arm64 has already raised the minimum supported GCC version to 5.1, do
    this for all targets now.  See the link below for the previous
    discussion.
    
    Link: https://lore.kernel.org/all/20210909182525.372ee687@canb.auug.org.au/
    Link: https://lore.kernel.org/lkml/CAK7LNASs6dvU6D3jL2GG3jW58fXfaj6VNOe55NJnTB8UPuk2pA@mail.gmail.com/
    Link: https://github.com/ClangBuiltLinux/linux/issues/1438
    Reported-by: Stephen Rothwell <sfr@canb.auug.org.au>
    Reported-by: Nathan Chancellor <nathan@kernel.org>
    Suggested-by: Rasmus Villemoes <linux@rasmusvillemoes.dk>
    Signed-off-by: Nick Desaulniers <ndesaulniers@google.com>
    Reviewed-by: Kees Cook <keescook@chromium.org>
    Reviewed-by: Nathan Chancellor <nathan@kernel.org>
    Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>

commit b36061c2ea5bdacf51305f8bc79f29595b343eb6
Author: Cai Huoqing <caihuoqing@baidu.com>
Date:   Wed Sep 8 18:57:37 2021 +0800

    regulator: ti-abb: Kconfig: Add helper dependency on COMPILE_TEST
    
    COMPILE_TEST is helpful to find compilation errors in other platform(e.g.X86).
    In this case, the support of COMPILE_TEST is added, so this module could
    be compiled in other platform(e.g.X86), without ARCH_SYNQUACER configuration.
    
    Signed-off-by: Cai Huoqing <caihuoqing@baidu.com>
    Link: https://lore.kernel.org/r/20210908105738.1933-1-caihuoqing@baidu.com
    Signed-off-by: Mark Brown <broonie@kernel.org>

commit dd4703876ea83b5fb5f4f0a1ec58f786143f5064
Merge: 765092e4cdaa 70ee251ded6b
Author: Linus Torvalds <torvalds@linux-foundation.org>
Date:   Sat Sep 11 09:20:57 2021 -0700

    Merge tag 'thermal-v5.15-rc1' of git://git.kernel.org/pub/scm/linux/kernel/git/thermal/linux
    
    Pull thermal updates from Daniel Lezcano:
    
     - Add the tegra3 thermal sensor and fix the compilation testing on
       tegra by adding a dependency on ARCH_TEGRA along with COMPILE_TEST
       (Dmitry Osipenko)
    
     - Fix the error code for the exynos when devm_get_clk() fails (Dan
       Carpenter)
    
     - Add the TCC cooling support for AlderLake platform (Sumeet Pawnikar)
    
     - Add support for hardware trip points for the rcar gen3 thermal driver
       and store TSC id as unsigned int (Niklas Sderlund)
    
     - Replace the deprecated CPU-hotplug functions get_online_cpus() and
       put_online_cpus (Sebastian Andrzej Siewior)
    
     - Add the thermal tools directory in the MAINTAINERS file (Daniel
       Lezcano)
    
     - Fix the Makefile and the cross compilation flags for the userspace
       'tmon' tool (Rolf Eike Beer)
    
     - Allow to use the IMOK independently from the GDDV on Int340x (Sumeet
       Pawnikar)
    
     - Fix the stub thermal_cooling_device_register() function prototype
       which does not match the real function (Arnd Bergmann)
    
     - Make the thermal trip point optional in the DT bindings (Maxime
       Ripard)
    
     - Fix a typo in a comment in the core code (Geert Uytterhoeven)
    
     - Reduce the verbosity of the trace in the SoC thermal tegra driver
       (Dmitry Osipenko)
    
     - Add the support for the LMh (Limit Management hardware) driver on the
       QCom platforms (Thara Gopinath)
    
     - Allow processing of HWP interrupt by adding a weak function in the
       Intel driver (Srinivas Pandruvada)
    
     - Prevent an abort of the sensor probe is a channel is not used
       (Matthias Kaehlcke)
    
    * tag 'thermal-v5.15-rc1' of git://git.kernel.org/pub/scm/linux/kernel/git/thermal/linux:
      thermal/drivers/qcom/spmi-adc-tm5: Don't abort probing if a sensor is not used
      thermal/drivers/intel: Allow processing of HWP interrupt
      dt-bindings: thermal: Add dt binding for QCOM LMh
      thermal/drivers/qcom: Add support for LMh driver
      firmware: qcom_scm: Introduce SCM calls to access LMh
      thermal/drivers/tegra-soctherm: Silence message about clamped temperature
      thermal: Spelling s/scallbacks/callbacks/
      dt-bindings: thermal: Make trips node optional
      thermal/core: Fix thermal_cooling_device_register() prototype
      thermal/drivers/int340x: Use IMOK independently
      tools/thermal/tmon: Add cross compiling support
      thermal/tools/tmon: Improve the Makefile
      MAINTAINERS: Add missing userspace thermal tools to the thermal section
      thermal/drivers/intel_powerclamp: Replace deprecated CPU-hotplug functions.
      thermal/drivers/rcar_gen3_thermal: Store TSC id as unsigned int
      thermal/drivers/rcar_gen3_thermal: Add support for hardware trip points
      drivers/thermal/intel: Add TCC cooling support for AlderLake platform
      thermal/drivers/exynos: Fix an error code in exynos_tmu_probe()
      thermal/drivers/tegra: Correct compile-testing of drivers
      thermal/drivers/tegra: Add driver for Tegra30 thermal sensor

commit 5a80dea93191d55840f42252ed3e4565a125a514
Author: Trevor Wu <trevor.wu@mediatek.com>
Date:   Thu Sep 9 14:55:33 2021 +0800

    ASoC: mediatek: add required config dependency
    
    Because SND_SOC_MT8195 depends on COMPILE_TEST, it's possible to build
    MT8195 driver in many different config combinations.
    Add all dependent config for SND_SOC_MT8195 in case some errors happen
    when COMPILE_TEST is enabled.
    
    Signed-off-by: Trevor Wu <trevor.wu@mediatek.com>
    Reported-by: Randy Dunlap <rdunlap@infradead.org>
    Link: https://lore.kernel.org/r/20210909065533.2114-1-trevor.wu@mediatek.com
    Signed-off-by: Mark Brown <broonie@kernel.org>

commit b339ec9c229aaf399296a120d7be0e34fbc355ca
Author: Marco Elver <elver@google.com>
Date:   Tue Sep 7 23:12:08 2021 +0200

    kbuild: Only default to -Werror if COMPILE_TEST
    
    The cross-product of the kernel's supported toolchains, architectures,
    and configuration options is large. So large, that it's generally
    accepted to be infeasible to enumerate and build+test them all
    (many compile-testers rely on randomly generated configs).
    
    Without the possibility to enumerate all possible combinations of
    toolchains, architectures, and configuration options, it is inevitable
    that compiler warnings in this space exist.
    
    With -Werror, this means that an innumerable set of kernels are now
    broken, yet had been perfectly usable before (confused compilers, code
    with warnings unused, or luck).
    
    Distributors will necessarily pick a point in the toolchain X arch X
    config space, and if unlucky, will have a broken build. Granted, those
    will likely disable CONFIG_WERROR and move on.
    
    The kernel's default configuration is unlikely to be suitable for all
    users, but it's inappropriate to force many users to set CONFIG_WERROR=n.
    
    This also holds for CI systems which are focused on runtime testing,
    where the odd warning in some subsystem will disrupt testing of the rest
    of the kernel. Many of those runtime-focused CI systems run tests or
    fuzz the kernel using runtime debugging tools. Runtime testing of
    different subsystems can proceed in parallel, and potentially uncover
    serious bugs; halting runtime testing of the entire kernel because of
    the odd warning (now error) in a subsystem or driver is simply
    inappropriate.
    
    Therefore, runtime-focused CI systems will likely choose CONFIG_WERROR=n
    as well.
    
    The appropriate usecase for -Werror is therefore compile-test focused
    builds (often done by developers or CI systems).
    
    Reflect this in the Kconfig option by making the default value of WERROR
    match COMPILE_TEST.
    
    Signed-off-by: Marco Elver <elver@google.com>
    Acked-by: Guenter Roeck <linux@roeck-us.net>
    Acked-by: Randy Dunlap <rdunlap@infradead.org>
    Reviwed-by: Mark Brown <broonie@kernel.org>
    Reviewed-by: Nathan Chancellor <nathan@kernel.org>
    Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>

commit 54d7a47a008b89fce5a669528274194ca092634d
Author: Marc Kleine-Budde <mkl@pengutronix.de>
Date:   Sat Sep 4 14:35:26 2021 +0200

    can: rcar_canfd: add __maybe_unused annotation to silence warning
    
    Since commit
    
    | dd3bd23eb438 ("can: rcar_canfd: Add Renesas R-Car CAN FD driver")
    
    the rcar_canfd driver can be compile tested on all architectures. On
    non OF enabled archs, or archs where OF is optional (and disabled in
    the .config) the compilation throws the following warning:
    
    | drivers/net/can/rcar/rcar_canfd.c:2020:34: warning: unused variable 'rcar_canfd_of_table' [-Wunused-const-variable]
    | static const struct of_device_id rcar_canfd_of_table[] = {
    |                                  ^
    
    This patch fixes the warning by marking the variable
    rcar_canfd_of_table as __maybe_unused.
    
    Fixes: ac4224087312 ("can: rcar: Kconfig: Add helper dependency on COMPILE_TEST")
    Fixes: dd3bd23eb438 ("can: rcar_canfd: Add Renesas R-Car CAN FD driver")
    Link: https://lore.kernel.org/all/20210907064537.1054268-1-mkl@pengutronix.de
    Cc: linux-renesas-soc@vger.kernel.org
    Cc: Cai Huoqing <caihuoqing@baidu.com>
    Reported-by: kernel test robot <lkp@intel.com>
    Signed-off-by: Marc Kleine-Budde <mkl@pengutronix.de>

commit b250e6d141ce4f0d0ada60e4b5db577050e5feb0
Merge: 4e71add02821 bc7cd2dd1f8e
Author: Linus Torvalds <torvalds@linux-foundation.org>
Date:   Fri Sep 3 15:33:47 2021 -0700

    Merge tag 'kbuild-v5.15' of git://git.kernel.org/pub/scm/linux/kernel/git/masahiroy/linux-kbuild
    
    Pull Kbuild updates from Masahiro Yamada:
    
     - Add -s option (strict mode) to merge_config.sh to make it fail when
       any symbol is redefined.
    
     - Show a warning if a different compiler is used for building external
       modules.
    
     - Infer --target from ARCH for CC=clang to let you cross-compile the
       kernel without CROSS_COMPILE.
    
     - Make the integrated assembler default (LLVM_IAS=1) for CC=clang.
    
     - Add <linux/stdarg.h> to the kernel source instead of borrowing
       <stdarg.h> from the compiler.
    
     - Add Nick Desaulniers as a Kbuild reviewer.
    
     - Drop stale cc-option tests.
    
     - Fix the combination of CONFIG_TRIM_UNUSED_KSYMS and CONFIG_LTO_CLANG
       to handle symbols in inline assembly.
    
     - Show a warning if 'FORCE' is missing for if_changed rules.
    
     - Various cleanups
    
    * tag 'kbuild-v5.15' of git://git.kernel.org/pub/scm/linux/kernel/git/masahiroy/linux-kbuild: (39 commits)
      kbuild: redo fake deps at include/ksym/*.h
      kbuild: clean up objtool_args slightly
      modpost: get the *.mod file path more simply
      checkkconfigsymbols.py: Fix the '--ignore' option
      kbuild: merge vmlinux_link() between ARCH=um and other architectures
      kbuild: do not remove 'linux' link in scripts/link-vmlinux.sh
      kbuild: merge vmlinux_link() between the ordinary link and Clang LTO
      kbuild: remove stale *.symversions
      kbuild: remove unused quiet_cmd_update_lto_symversions
      gen_compile_commands: extract compiler command from a series of commands
      x86: remove cc-option-yn test for -mtune=
      arc: replace cc-option-yn uses with cc-option
      s390: replace cc-option-yn uses with cc-option
      ia64: move core-y in arch/ia64/Makefile to arch/ia64/Kbuild
      sparc: move the install rule to arch/sparc/Makefile
      security: remove unneeded subdir-$(CONFIG_...)
      kbuild: sh: remove unused install script
      kbuild: Fix 'no symbols' warning when CONFIG_TRIM_UNUSD_KSYMS=y
      kbuild: Switch to 'f' variants of integrated assembler flag
      kbuild: Shuffle blank line to improve comment meaning
      ...

commit d6742212c0c6ccee2351499db80acba71fa36052
Merge: 603eefda5fcf bea6a94a279b
Author: Linus Torvalds <torvalds@linux-foundation.org>
Date:   Fri Sep 3 11:11:54 2021 -0700

    Merge tag 'mips_5.15' of git://git.kernel.org/pub/scm/linux/kernel/git/mips/linux
    
    Pull MIPS updates from Thomas Bogendoerfer:
    
     - converted Pistachio platform to use MIPS generic kernel
    
     - fixes and cleanups
    
    * tag 'mips_5.15' of git://git.kernel.org/pub/scm/linux/kernel/git/mips/linux: (29 commits)
      MIPS: Malta: fix alignment of the devicetree buffer
      MIPS: ingenic: Unconditionally enable clock of CPU #0
      MIPS: mscc: ocelot: mark the phy-mode for internal PHY ports
      MIPS: mscc: ocelot: disable all switch ports by default
      MAINTAINERS: adjust PISTACHIO SOC SUPPORT after its retirement
      MIPS: Return true/false (not 1/0) from bool functions
      MIPS: generic: Return true/false (not 1/0) from bool functions
      MIPS: Make a alias for pistachio_defconfig
      MIPS: Retire MACH_PISTACHIO
      MIPS: config: generic: Add config for Marduk board
      pinctrl: pistachio: Make it as an option
      phy: pistachio-usb: Depend on MIPS || COMPILE_TEST
      clocksource/drivers/pistachio: Make it selectable for MIPS
      clk: pistachio: Make it selectable for generic MIPS kernel
      MIPS: DTS: Pistachio add missing cpc and cdmm
      MIPS: generic: Allow generating FIT image for Marduk board
      MIPS: locking/atomic: Fix atomic{_64,}_sub_if_positive
      MIPS: loongson2ef: don't build serial.o unconditionally
      MIPS: Replace deprecated CPU-hotplug functions.
      MIPS: Alchemy: Fix spelling contraction "cant" -> "can't"
      ...

commit a0a2f7bb220945e369de77ea004d96236e9463a6
Author: Candice Li <candice.li@amd.com>
Date:   Fri Aug 27 19:14:36 2021 +0800

    drm/amd/amdgpu: add mpio to ras block
    
    Add MPIO to RAS block
    
    Signed-off-by: Candice Li <candice.li@amd.com>
    Reviewed-by: John Clements <john.clements@amd.com>
    Signed-off-by: Alex Deucher <alexander.deucher@amd.com>

commit 6c35ca06974105d929f25f487c6ae7a47fffa128
Merge: e22ce8eb631b ed104ca4bd9c
Author: Arnd Bergmann <arnd@arndb.de>
Date:   Mon Aug 23 23:41:27 2021 +0200

    Merge tag 'reset-fixes-for-v5.14' of git://git.pengutronix.de/pza/linux into arm/fixes
    
    Reset controller fixes for v5.14
    
    Hide the Sparx5 reset driver unless the ARCH_SPARX5 or COMPILE_TEST
    options are enabled, to avoid unnecessarily asking users about this
    driver. Fix a return value argument type in the ZynqMP reset driver.
    
    * tag 'reset-fixes-for-v5.14' of git://git.pengutronix.de/pza/linux:
      reset: reset-zynqmp: Fixed the argument data type
      reset: RESET_MCHP_SPARX5 should depend on ARCH_SPARX5
    
    Link: https://lore.kernel.org/r/e543959c5b5ee7b25686f81049bf187d602daeda.camel@pengutronix.de
    Signed-off-by: Arnd Bergmann <arnd@arndb.de>

commit fbcf8a340150abd20bf44fc706362b0827157fe8
Author: Cai Huoqing <caihuoqing@baidu.com>
Date:   Wed Aug 25 14:25:13 2021 +0800

    net: ethernet: actions: Add helper dependency on COMPILE_TEST
    
    it's helpful for complie test in other platform(e.g.X86)
    
    Signed-off-by: Cai Huoqing <caihuoqing@baidu.com>
    Signed-off-by: David S. Miller <davem@davemloft.net>

commit 45bc6125d1429b6d9db8595c794b5d71a09fef7d
Merge: b87a542c5bb4 cbe8cd7d83e2
Author: David S. Miller <davem@davemloft.net>
Date:   Wed Aug 25 11:19:38 2021 +0100

    Merge tag 'linux-can-next-for-5.15-20210825' of git://git.kernel.org/pub/scm/linux/kernel/git/mkl/linux-can-next
    
    Marc Kleine says:
    
    ====================
    pull-request: can-next 2021-08-25
    
    this is a pull request of 4 patches for net-next/master.
    
    The first patch is by Cai Huoqing, and enables COMPILE_TEST for the
    rcar CAN drivers.
    
    Lad Prabhakar contributes a patch for the rcar_canfd driver, fixing a
    redundant assignment.
    
    The last 2 patches are by Tang Bin, target the mscan driver, and clean
    up the driver by converting it to of_device_get_match_data() and
    removing a useless BUG_ON.
    ====================
    
    Signed-off-by: David S. Miller <davem@davemloft.net>

commit ac4224087312d7212bd3411f1e393f4b7cb1ff15
Author: Cai Huoqing <caihuoqing@baidu.com>
Date:   Wed Aug 25 14:23:41 2021 +0800

    can: rcar: Kconfig: Add helper dependency on COMPILE_TEST
    
    it's helpful for complie test in other platform(e.g.X86)
    
    Link: https://lore.kernel.org/r/20210825062341.2332-1-caihuoqing@baidu.com
    Signed-off-by: Cai Huoqing <caihuoqing@baidu.com>
    Signed-off-by: Marc Kleine-Budde <mkl@pengutronix.de>

commit db87db65c1059f3be04506d122f8ec9b2fa3b05e
Author: Arnd Bergmann <arnd@arndb.de>
Date:   Mon Aug 9 18:01:31 2021 +1000

    m68knommu: only set CONFIG_ISA_DMA_API for ColdFire sub-arch
    
    > Hi Arnd,
    >
    > First bad commit (maybe != root cause):
    >
    > tree:   https://git.kernel.org/pub/scm/linux/kernel/git/next/linux-next.git master
    > head:   2f73937c9aa561e2082839bc1a8efaac75d6e244
    > commit: 47fd22f2b84765a2f7e3f150282497b902624547 [4771/5318] cs89x0: rework driver configuration
    > config: m68k-randconfig-c003-20210804 (attached as .config)
    > compiler: m68k-linux-gcc (GCC) 10.3.0
    > reproduce (this is a W=1 build):
    >         wget https://raw.githubusercontent.com/intel/lkp-tests/master/sbin/make.cross -O ~/bin/make.cross
    >         chmod +x ~/bin/make.cross
    >         # https://git.kernel.org/pub/scm/linux/kernel/git/next/linux-next.git/commit/?id=47fd22f2b84765a2f7e3f150282497b902624547
    >         git remote add linux-next https://git.kernel.org/pub/scm/linux/kernel/git/next/linux-next.git
    >         git fetch --no-tags linux-next master
    >         git checkout 47fd22f2b84765a2f7e3f150282497b902624547
    >         # save the attached .config to linux build tree
    >         COMPILER_INSTALL_PATH=$HOME/0day COMPILER=gcc-10.3.0 make.cross ARCH=m68k
    >
    > If you fix the issue, kindly add following tag as appropriate
    > Reported-by: kernel test robot <lkp@intel.com>
    >
    > All errors (new ones prefixed by >>):
    >
    >    In file included from include/linux/kernel.h:19,
    >                     from include/linux/list.h:9,
    >                     from include/linux/module.h:12,
    >                     from drivers/net/ethernet/cirrus/cs89x0.c:51:
    >    drivers/net/ethernet/cirrus/cs89x0.c: In function 'net_open':
    >    drivers/net/ethernet/cirrus/cs89x0.c:897:20: error: implicit declaration of function 'isa_virt_to_bus'; did you mean 'virt_to_bus'? [-Werror=implicit-function-declaration]
    >      897 |     (unsigned long)isa_virt_to_bus(lp->dma_buff));
    >          |                    ^~~~~~~~~~~~~~~
    >    include/linux/printk.h:141:17: note: in definition of macro 'no_printk'
    >      141 |   printk(fmt, ##__VA_ARGS__);  \
    >          |                 ^~~~~~~~~~~
    >    drivers/net/ethernet/cirrus/cs89x0.c:86:3: note: in expansion of macro 'pr_debug'
    >       86 |   pr_##level(fmt, ##__VA_ARGS__);   \
    >          |   ^~~
    >    drivers/net/ethernet/cirrus/cs89x0.c:894:3: note: in expansion of macro 'cs89_dbg'
    >      894 |   cs89_dbg(1, debug, "%s: dma %lx %lx\n",
    >          |   ^~~~~~~~
    > >> drivers/net/ethernet/cirrus/cs89x0.c:914:3: error: implicit declaration of function 'disable_dma'; did you mean 'disable_irq'? [-Werror=implicit-function-declaration]
    
    As far as I can tell, this is a bug with the m68kmmu architecture, not
    with my driver:
    The CONFIG_ISA_DMA_API option is provided for coldfire, which implements it,
    but dragonball also sets the option as a side-effect, without actually
    implementing
    the interfaces. The patch below should fix it.
    
    Signed-off-by: Arnd Bergmann <arnd@arndb.de>
    Signed-off-by: Greg Ungerer <gerg@linux-m68k.org>

commit e10ecb4d6c0761ca545b3946df1707a41f9f845e
Author: Oliver Upton <oupton@google.com>
Date:   Wed Aug 18 20:21:32 2021 +0000

    KVM: arm64: Enforce reserved bits for PSCI target affinities
    
    According to the PSCI specification, ARM DEN 0022D, 5.1.4 "CPU_ON", the
    CPU_ON function takes a target_cpu argument that is bit-compatible with
    the affinity fields in MPIDR_EL1. All other bits in the argument are
    RES0. Note that the same constraints apply to the target_affinity
    argument for the AFFINITY_INFO call.
    
    Enforce the spec by returning INVALID_PARAMS if a guest incorrectly sets
    a RES0 bit.
    
    Signed-off-by: Oliver Upton <oupton@google.com>
    Signed-off-by: Marc Zyngier <maz@kernel.org>
    Link: https://lore.kernel.org/r/20210818202133.1106786-4-oupton@google.com

commit 8f8d8b0334cc4e7908b78e73936a7673bbef0411
Author: Dmitry Osipenko <digetx@gmail.com>
Date:   Thu Jun 17 10:24:03 2021 +0300

    thermal/drivers/tegra: Correct compile-testing of drivers
    
    All Tegra thermal drivers support compile-testing, but the drivers are
    not available for compile-testing because the whole Kconfig meny entry
    depends on ARCH_TEGRA, missing the alternative COMPILE_TEST dependency
    option. Correct the Kconfig entry.
    
    Signed-off-by: Dmitry Osipenko <digetx@gmail.com>
    Signed-off-by: Daniel Lezcano <daniel.lezcano@linaro.org>
    Link: https://lore.kernel.org/r/20210617072403.3487-1-digetx@gmail.com

commit e238f10d8606ddb9a1728628a218c3f740b940be
Author: Jiaxun Yang <jiaxun.yang@flygoat.com>
Date:   Fri Jul 23 10:25:39 2021 +0800

    phy: pistachio-usb: Depend on MIPS || COMPILE_TEST
    
    So it will be avilable for generic MIPS kernel.
    
    Signed-off-by: Jiaxun Yang <jiaxun.yang@flygoat.com>
    Acked-By: Vinod Koul <vkoul@kernel.org>
    Signed-off-by: Thomas Bogendoerfer <tsbogend@alpha.franken.de>

commit b6f756726e4dfe75be1883f6a0202dcecdc801ab
Author: Hongbo Li <herberthbli@tencent.com>
Date:   Thu Aug 5 16:53:32 2021 +0800

    lib/mpi: use kcalloc in mpi_resize
    
    We should set the additional space to 0 in mpi_resize().
    So use kcalloc() instead of kmalloc_array().
    
    In lib/mpi/ec.c:
    /****************
     * Resize the array of A to NLIMBS. the additional space is cleared
     * (set to 0) [done by m_realloc()]
     */
    int mpi_resize(MPI a, unsigned nlimbs)
    
    Like the comment of kernel's mpi_resize() said, the additional space
    need to be set to 0, but when a->d is not NULL, it does not set.
    
    The kernel's mpi lib is from libgcrypt, the mpi resize in libgcrypt
    is _gcry_mpi_resize() which set the additional space to 0.
    
    This bug may cause mpi api which use mpi_resize() get wrong result
    under the condition of using the additional space without initiation.
    If this condition is not met, the bug would not be triggered.
    Currently in kernel, rsa, sm2 and dh use mpi lib, and they works well,
    so the bug is not triggered in these cases.
    
    add_points_edwards() use the additional space directly, so it will
    get a wrong result.
    
    Fixes: cdec9cb5167a ("crypto: GnuPG based MPI lib - source files (part 1)")
    Signed-off-by: Hongbo Li <herberthbli@tencent.com>
    Signed-off-by: Herbert Xu <herbert@gondor.apana.org.au>

commit 4c15442d9c06ae6ce0a03fd69c4869f343d67473
Author: Arun Easi <aeasi@marvell.com>
Date:   Mon Aug 9 21:37:07 2021 -0700

    scsi: qla2xxx: Add host attribute to trigger MPI hang
    
    Add a mechanism to trigger MPI pause for debugging purposes.
    
    Link: https://lore.kernel.org/r/20210810043720.1137-2-njavali@marvell.com
    Reviewed-by: Himanshu Madhani <himanshu.madhani@oracle.com>
    Signed-off-by: Arun Easi <aeasi@marvell.com>
    Signed-off-by: Nilesh Javali <njavali@marvell.com>
    Signed-off-by: Martin K. Petersen <martin.petersen@oracle.com>

commit e08831baa032e62786d88b68e26c54389e2486b6
Author: Nick Desaulniers <ndesaulniers@google.com>
Date:   Mon Aug 2 11:39:10 2021 -0700

    Documentation/llvm: update CROSS_COMPILE inferencing
    
    As noted by Masahiro, document how we can generally infer CROSS_COMPILE
    (and the more specific details about --target and --prefix) based on
    ARCH.
    
    Change use of env vars to command line parameters.
    
    Suggested-by: Masahiro Yamada <masahiroy@kernel.org>
    Reviewed-by: Fangrui Song <maskray@google.com>
    Signed-off-by: Nick Desaulniers <ndesaulniers@google.com>
    Reviewed-by: Nathan Chancellor <nathan@kernel.org>
    Signed-off-by: Masahiro Yamada <masahiroy@kernel.org>

commit 231ad7f409f16b9f9505f69e058dff488a7e6bde
Author: Nick Desaulniers <ndesaulniers@google.com>
Date:   Mon Aug 2 11:39:09 2021 -0700

    Makefile: infer --target from ARCH for CC=clang
    
    We get constant feedback that the command line invocation of make is too
    long when compiling with LLVM. CROSS_COMPILE is helpful when a toolchain
    has a prefix of the target triple, or is an absolute path outside of
    $PATH.
    
    Since a Clang binary is generally multi-targeted, we can infer a given
    target from SRCARCH/ARCH.  If CROSS_COMPILE is not set, simply set
    --target= for CLANG_FLAGS, KBUILD_CFLAGS, and KBUILD_AFLAGS based on
    $SRCARCH.
    
    Previously, we'd cross compile via:
    $ ARCH=arm64 CROSS_COMPILE=aarch64-linux-gnu- make LLVM=1 LLVM_IAS=1
    Now:
    $ ARCH=arm64 make LLVM=1 LLVM_IAS=1
    
    For native builds (not involving cross compilation) we now explicitly
    specify a target triple rather than rely on the implicit host triple.
    
    Link: https://github.com/ClangBuiltLinux/linux/issues/1399
    Suggested-by: Arnd Bergmann <arnd@kernel.org>
    Suggested-by: Linus Torvalds <torvalds@linux-foundation.org>
    Suggested-by: Masahiro Yamada <masahiroy@kernel.org>
    Suggested-by: Nathan Chancellor <nathan@kernel.org>
    Acked-by: Arnd Bergmann <arnd@kernel.org>
    Reviewed-by: Nathan Chancellor <nathan@kernel.org>
    Signed-off-by: Nick Desaulniers <ndesaulniers@google.com>
    Acked-by: Miguel Ojeda <ojeda@kernel.org>
    Signed-off-by: Masahiro Yamada <masahiroy@kernel.org>

commit 6f5b41a2f5a6314614e286274eb8e985248aac60
Author: Nick Desaulniers <ndesaulniers@google.com>
Date:   Mon Aug 2 11:39:08 2021 -0700

    Makefile: move initial clang flag handling into scripts/Makefile.clang
    
    With some of the changes we'd like to make to CROSS_COMPILE, the initial
    block of clang flag handling which controls things like the target triple,
    whether or not to use the integrated assembler and how to find GAS,
    and erroring on unknown warnings is becoming unwieldy. Move it into its
    own file under scripts/.
    
    Reviewed-by: Nathan Chancellor <nathan@kernel.org>
    Signed-off-by: Nick Desaulniers <ndesaulniers@google.com>
    Signed-off-by: Masahiro Yamada <masahiroy@kernel.org>

commit 5b9272e93f2efe3f6cda60cc2c26817b2ce49386
Author: Oleksij Rempel <o.rempel@pengutronix.de>
Date:   Wed Jul 7 11:48:54 2021 +0200

    can: j1939: extend UAPI to notify about RX status
    
    To be able to create applications with user friendly feedback, we need be
    able to provide receive status information.
    
    Typical ETP transfer may take seconds or even hours. To give user some
    clue or show a progress bar, the stack should push status updates.
    Same as for the TX information, the socket error queue will be used with
    following new signals:
    - J1939_EE_INFO_RX_RTS   - received and accepted request to send signal.
    - J1939_EE_INFO_RX_DPO   - received data package offset signal
    - J1939_EE_INFO_RX_ABORT - RX session was aborted
    
    Instead of completion signal, user will get data package.
    To activate this signals, application should set
    SOF_TIMESTAMPING_RX_SOFTWARE to the SO_TIMESTAMPING socket option. This
    will avoid unpredictable application behavior for the old software.
    
    Link: https://lore.kernel.org/r/20210707094854.30781-3-o.rempel@pengutronix.de
    Signed-off-by: Oleksij Rempel <o.rempel@pengutronix.de>
    Signed-off-by: Marc Kleine-Budde <mkl@pengutronix.de>

commit 64ee84c75b5f75132eec97f2c7a201a056d53698
Author: Masahiro Yamada <masahiroy@kernel.org>
Date:   Sun Aug 1 14:35:25 2021 +0900

    arm64: move warning about toolchains to archprepare
    
    Commit 987fdfec2410 ("arm64: move --fix-cortex-a53-843419 linker test to
    Kconfig") fixed the false-positive warning in the installation step.
    
    Yet, there are some cases where this false-positive is shown. For example,
    you can see it when you cross 987fdfec2410 during git-bisect.
    
      $ git checkout 987fdfec2410^
        [ snip ]
      $ make ARCH=arm64 CROSS_COMPILE=aarch64-linux-gnu- defconfig all
        [ snip ]
      $ git checkout v5.13
        [ snip]
      $ make ARCH=arm64 CROSS_COMPILE=aarch64-linux-gnu- defconfig all
        [ snip ]
      arch/arm64/Makefile:25: ld does not support --fix-cortex-a53-843419; kernel may be susceptible to erratum
    
    In the stale include/config/auto.config, CONFIG_ARM64_ERRATUM_843419=y
    is set without CONFIG_ARM64_LD_HAS_FIX_ERRATUM_843419, so the warning
    is displayed while parsing the Makefiles.
    
    Make will restart with the updated include/config/auto.config, hence
    CONFIG_ARM64_LD_HAS_FIX_ERRATUM_843419 will be set eventually, but
    this warning is a surprise for users.
    
    Commit 25896d073d8a ("x86/build: Fix compiler support check for
    CONFIG_RETPOLINE") addressed a similar issue.
    
    Move $(warning ...) out of the parse stage of Makefiles.
    
    The same applies to CONFIG_ARM64_USE_LSE_ATOMICS.
    
    Signed-off-by: Masahiro Yamada <masahiroy@kernel.org>
    Link: https://lore.kernel.org/r/20210801053525.105235-1-masahiroy@kernel.org
    Signed-off-by: Will Deacon <will@kernel.org>

commit 7f94b69ece515ac82defa60ef7cba2cf26180216
Author: Arnd Bergmann <arnd@arndb.de>
Date:   Wed Jul 21 23:13:43 2021 +0200

    ARM: ixp4xx: fix compile-testing soc drivers
    
    Randconfig builds on the ixp4xx ethernet driver showed that the qmgr and
    npe drivers are not actually built even when compile testing is enabled:
    
    ERROR: modpost: "qmgr_stat_empty" [drivers/net/ethernet/xscale/ixp4xx_eth.ko] undefined!
    ERROR: modpost: "qmgr_enable_irq" [drivers/net/ethernet/xscale/ixp4xx_eth.ko] undefined!
    ERROR: modpost: "qmgr_set_irq" [drivers/net/ethernet/xscale/ixp4xx_eth.ko] undefined!
    ERROR: modpost: "__qmgr_request_queue" [drivers/net/ethernet/xscale/ixp4xx_eth.ko] undefined!
    ERROR: modpost: "npe_send_recv_message" [drivers/net/ethernet/xscale/ixp4xx_eth.ko] undefined!
    ERROR: modpost: "npe_recv_message" [drivers/net/ethernet/xscale/ixp4xx_eth.ko] undefined!
    ERROR: modpost: "npe_load_firmware" [drivers/net/ethernet/xscale/ixp4xx_eth.ko] undefined!
    ERROR: modpost: "npe_running" [drivers/net/ethernet/xscale/ixp4xx_eth.ko] undefined!
    ERROR: modpost: "qmgr_disable_irq" [drivers/net/ethernet/xscale/ixp4xx_eth.ko] undefined!
    ERROR: modpost: "qmgr_stat_below_low_watermark" [drivers/net/ethernet/xscale/ixp4xx_eth.ko] undefined!
    
    Fix it by always entering the drivers/soc/ixp4xx/ directory, and fix the
    resulting compile test failures by removing the #include statements
    that prevent building on most other platforms.
    
    Fixes: 7a6c9dbb36a4 ("soc: ixp4xx: Protect IXP4xx SoC drivers by ARCH_IXP4XX || COMPILE_TEST")
    Fixes: fcf2d8978cd5 ("ARM: ixp4xx: Move NPE and QMGR to drivers/soc")
    Signed-off-by: Arnd Bergmann <arnd@arndb.de>
    Reviewed-by: Linus Walleij <linus.walleij@linaro.org>
    Link: https://lore.kernel.org/r/20210721211412.3537004-1-arnd@kernel.org'
    Signed-off-by: Arnd Bergmann <arnd@arndb.de>

commit 71260b9a7020751623bcda2a5377834a100dfb30
Author: Javier Martinez Canillas <javierm@redhat.com>
Date:   Tue Jul 27 11:30:15 2021 +0200

    drivers/firmware: fix SYSFB depends to prevent build failures
    
    The Generic System Framebuffers support is built when the COMPILE_TEST
    option is enabled. But this wrongly assumes that all the architectures
    declare a struct screen_info.
    
    This is true for most architectures, but at least the following do not:
    arc, m68k, microblaze, openrisc, parisc and s390.
    
    By attempting to make this compile testeable on all architectures, it
    leads to linking errors as reported by the kernel test robot for parisc:
    
      All errors (new ones prefixed by >>):
    
         hppa-linux-ld: drivers/firmware/sysfb.o: in function `sysfb_init':
         (.init.text+0x24): undefined reference to `screen_info'
      >> hppa-linux-ld: (.init.text+0x28): undefined reference to `screen_info'
    
    To prevent these errors only allow sysfb to be built on systems that are
    going to need it, which are x86 BIOS and EFI.
    
    The EFI Kconfig symbol is used instead of (ARM || ARM64 || RISC) because
    some of these architectures only declare a struct screen_info if EFI is
    enabled. And also, because the SYSFB code is only used for EFI on these
    architectures. For !EFI the "simple-framebuffer" device is registered by
    OF when parsing the Device Tree Blob (if a DT node for this was defined).
    
    Fixes: d391c5827107 ("drivers/firmware: move x86 Generic System Framebuffers support")
    Reported-by: kernel test robot <lkp@intel.com>
    Signed-off-by: Javier Martinez Canillas <javierm@redhat.com>
    Signed-off-by: Daniel Vetter <daniel.vetter@ffwll.ch>
    Link: https://patchwork.freedesktop.org/patch/msgid/20210727093015.1225107-1-javierm@redhat.com

commit 32ec3960175e58a914fc242b66dfe33e9059568f
Author: Arnd Bergmann <arnd@arndb.de>
Date:   Fri Jul 23 11:13:52 2021 +0200

    pinctrl: qcom: fix GPIOLIB dependencies
    
    Enabling the PINCTRL_SM8350 symbol without GPIOLIB or SCM causes a build
    failure:
    
    WARNING: unmet direct dependencies detected for PINCTRL_MSM
      Depends on [m]: PINCTRL [=y] && (ARCH_QCOM [=y] || COMPILE_TEST [=y]) && GPIOLIB [=y] && (QCOM_SCM [=m] || !QCOM_SCM [=m])
      Selected by [y]:
      - PINCTRL_SM8350 [=y] && PINCTRL [=y] && (ARCH_QCOM [=y] || COMPILE_TEST [=y]) && GPIOLIB [=y] && OF [=y]
    aarch64-linux-ld: drivers/pinctrl/qcom/pinctrl-msm.o: in function `msm_gpio_irq_set_type':
    pinctrl-msm.c:(.text.msm_gpio_irq_set_type+0x1c8): undefined reference to `qcom_scm_io_readl'
    
    The main problem here is the 'select PINCTRL_MSM', which needs to be a
    'depends on' as it is for all the other front-ends. As the GPIOLIB
    dependency is now implied by that, symbol, remove the duplicate
    dependencies in the process.
    
    Fixes: d5d348a3271f ("pinctrl: qcom: Add SM8350 pinctrl driver")
    Fixes: 376f9e34c10f ("drivers: pinctrl: qcom: fix Kconfig dependency on GPIOLIB")
    Signed-off-by: Arnd Bergmann <arnd@arndb.de>
    Link: https://lore.kernel.org/r/20210723091400.1669716-1-arnd@kernel.org
    Signed-off-by: Linus Walleij <linus.walleij@linaro.org>

commit 98c5b13f3a878066741a907a9d0f1f388556ed5c
Author: Randy Dunlap <rdunlap@infradead.org>
Date:   Wed Jul 21 15:33:36 2021 -0700

    net: sparx5: fix unmet dependencies warning
    
    WARNING: unmet direct dependencies detected for PHY_SPARX5_SERDES
      Depends on [n]: (ARCH_SPARX5 || COMPILE_TEST [=n]) && OF [=y] && HAS_IOMEM [=y]
      Selected by [y]:
      - SPARX5_SWITCH [=y] && NETDEVICES [=y] && ETHERNET [=y] && NET_VENDOR_MICROCHIP [=y] && NET_SWITCHDEV [=y] && HAS_IOMEM [=y] && OF [=y]
    
    Signed-off-by: Randy Dunlap <rdunlap@infradead.org>
    Cc: Lars Povlsen <lars.povlsen@microchip.com>
    Cc: Steen Hegelund <Steen.Hegelund@microchip.com>
    Cc: UNGLinuxDriver@microchip.com
    Cc: "David S. Miller" <davem@davemloft.net>
    Cc: Jakub Kicinski <kuba@kernel.org>
    Signed-off-by: David S. Miller <davem@davemloft.net>

commit dabb5db17c06d25accc3c3b8417b3a0428ba0731
Author: Joakim Zhang <qiangqing.zhang@nxp.com>
Date:   Wed Jul 21 18:12:20 2021 +0800

    ARM: dts: imx6qdl: move phy properties into phy device node
    
    This patch fixes issues found by dtbs_check:
    make ARCH=arm CROSS_COMPILE=arm-linux-gnueabihf- dtbs_check DT_SCHEMA_FILES=Documentation/devicetree/bindings/net/fsl,fec.yaml
    
    According to the Micrel PHY dt-binding:
    Documentation/devicetree/bindings/net/micrel-ksz90x1.txt,
    Add clock delay in an Ethernet OF device node is deprecated, so move
    these properties to PHY OF device node.
    
    Suggested-by: Rob Herring <robh@kernel.org>
    Signed-off-by: Joakim Zhang <qiangqing.zhang@nxp.com>
    Signed-off-by: David S. Miller <davem@davemloft.net>

commit 41667a933c8ad141d0ba79d98e5f6458e7e66864
Author: Joakim Zhang <qiangqing.zhang@nxp.com>
Date:   Mon Jul 19 15:18:21 2021 +0800

    arm64: dts: imx8mp: change interrupt order per dt-binding
    
    This patch changs interrupt order which found by dtbs_check.
    
    $ make ARCH=arm64 CROSS_COMPILE=aarch64-linux-gnu- dtbs_check DT_SCHEMA_FILES=Documentation/devicetree/bindings/net/nxp,dwmac-imx.yaml
    arch/arm64/boot/dts/freescale/imx8mp-evk.dt.yaml: ethernet@30bf0000: interrupt-names:0: 'macirq' was expected
    arch/arm64/boot/dts/freescale/imx8mp-evk.dt.yaml: ethernet@30bf0000: interrupt-names:1: 'eth_wake_irq' was expected
    
    According to Documentation/devicetree/bindings/net/snps,dwmac.yaml, we
    should list interrupt in it's order.
    
    Signed-off-by: Joakim Zhang <qiangqing.zhang@nxp.com>
    Signed-off-by: David S. Miller <davem@davemloft.net>

commit 03e85b17030a6516fb76d853d6c74f0181c03180
Author: Joakim Zhang <qiangqing.zhang@nxp.com>
Date:   Mon Jul 19 15:18:20 2021 +0800

    dt-bindings: net: imx-dwmac: convert imx-dwmac bindings to yaml
    
    In order to automate the verification of DT nodes covert imx-dwmac to
    nxp,dwmac-imx.yaml, and pass below checking.
    
    $ make ARCH=arm64 CROSS_COMPILE=aarch64-linux-gnu- dt_binding_check DT_SCHEMA_FILES=Documentation/devicetree/bindings/net/nxp,dwmac-imx.yaml
    $ make ARCH=arm64 CROSS_COMPILE=aarch64-linux-gnu- dtbs_check DT_SCHEMA_FILES=Documentation/devicetree/bindings/net/nxp,dwmac-imx.yaml
    
    Signed-off-by: Joakim Zhang <qiangqing.zhang@nxp.com>
    Signed-off-by: David S. Miller <davem@davemloft.net>

commit bc71d3ef59b95cae509a1fc3da3162065be0b256
Author: Joakim Zhang <qiangqing.zhang@nxp.com>
Date:   Mon Jul 19 15:18:19 2021 +0800

    dt-bindings: net: snps,dwmac: add missing DWMAC IP version
    
    Add missing DWMAC IP version in snps,dwmac.yaml which found by below
    command, as NXP i.MX8 families support SNPS DWMAC 5.10a IP.
    
    $ make ARCH=arm64 CROSS_COMPILE=aarch64-linux-gnu- dt_binding_check DT_SCHEMA_FILES=Documentation/devicetree/bindings/net/nxp,dwmac-imx.yaml
    Documentation/devicetree/bindings/net/nxp,dwmac-imx.example.dt.yaml:
    ethernet@30bf0000: compatible: None of ['nxp,imx8mp-dwmac-eqos', 'snps,dwmac-5.10a'] are valid under the given schema
    
    Signed-off-by: Joakim Zhang <qiangqing.zhang@nxp.com>
    Signed-off-by: David S. Miller <davem@davemloft.net>

commit 2ca912471db43c39b0e3450c05deccb6bf46b565
Author: Geert Uytterhoeven <geert+renesas@glider.be>
Date:   Tue Mar 16 14:37:33 2021 +0100

    reset: RESET_BRCMSTB_RESCAL should depend on ARCH_BRCMSTB
    
    [ Upstream commit 42f6a76fbe85e5243f83a3ed76809b1ebbb7087e ]
    
    The Broadcom STB RESCAL reset controller is only present on Broadcom
    BCM7216 platforms.  Hence add a dependency on ARCH_BRCMSTB, to prevent
    asking the user about this driver when configuring a kernel without
    BCM7216 support.
    
    Also, merely enabling CONFIG_COMPILE_TEST should not enable additional
    code, and thus should not enable this driver by default.
    
    Fixes: 4cf176e52397853e ("reset: Add Broadcom STB RESCAL reset controller")
    Signed-off-by: Geert Uytterhoeven <geert+renesas@glider.be>
    Acked-by: Florian Fainelli <f.fainelli@gmail.com>
    Signed-off-by: Philipp Zabel <p.zabel@pengutronix.de>
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit f7121692795c654b52b460a11107a87285bb1dcd
Author: Nathan Chancellor <nathan@kernel.org>
Date:   Wed Jul 7 18:07:38 2021 -0700

    hexagon: handle {,SOFT}IRQENTRY_TEXT in linker script
    
    [ Upstream commit 6fef087d0d37ba7dba8f3d75566eb4c256cd6742 ]
    
    Patch series "hexagon: Fix build error with CONFIG_STACKDEPOT and select CONFIG_ARCH_WANT_LD_ORPHAN_WARN".
    
    This series fixes an error with ARCH=hexagon that was pointed out by the
    patch "mm/slub: use stackdepot to save stack trace in objects".
    
    The first patch fixes that error by handling the '.irqentry.text' and
    '.softirqentry.text' sections.
    
    The second patch switches Hexagon over to the common DISCARDS macro, which
    should have been done when Hexagon was merged into the tree to match
    commit 023bf6f1b8bf ("linker script: unify usage of discard definition").
    
    The third patch selects CONFIG_ARCH_WANT_LD_ORPHAN_WARN so that something
    like this does not happen again.
    
    This patch (of 3):
    
    Patch "mm/slub: use stackdepot to save stack trace in objects" in -mm
    selects CONFIG_STACKDEPOT when CONFIG_STACKTRACE_SUPPORT is selected and
    CONFIG_STACKDEPOT requires IRQENTRY_TEXT and SOFTIRQENTRY_TEXT to be
    handled after commit 505a0ef15f96 ("kasan: stackdepot: move
    filter_irq_stacks() to stackdepot.c") due to the use of the
    __{,soft}irqentry_text_{start,end} section symbols.  If those sections are
    not handled, the build is broken.
    
    $ make ARCH=hexagon CROSS_COMPILE=hexagon-linux- LLVM=1 LLVM_IAS=1 defconfig all
    ...
    ld.lld: error: undefined symbol: __irqentry_text_start
    >>> referenced by stackdepot.c
    >>>               stackdepot.o:(filter_irq_stacks) in archive lib/built-in.a
    >>> referenced by stackdepot.c
    >>>               stackdepot.o:(filter_irq_stacks) in archive lib/built-in.a
    
    ld.lld: error: undefined symbol: __irqentry_text_end
    >>> referenced by stackdepot.c
    >>>               stackdepot.o:(filter_irq_stacks) in archive lib/built-in.a
    >>> referenced by stackdepot.c
    >>>               stackdepot.o:(filter_irq_stacks) in archive lib/built-in.a
    
    ld.lld: error: undefined symbol: __softirqentry_text_start
    >>> referenced by stackdepot.c
    >>>               stackdepot.o:(filter_irq_stacks) in archive lib/built-in.a
    >>> referenced by stackdepot.c
    >>>               stackdepot.o:(filter_irq_stacks) in archive lib/built-in.a
    
    ld.lld: error: undefined symbol: __softirqentry_text_end
    >>> referenced by stackdepot.c
    >>>               stackdepot.o:(filter_irq_stacks) in archive lib/built-in.a
    >>> referenced by stackdepot.c
    >>>               stackdepot.o:(filter_irq_stacks) in archive lib/built-in.a
    ...
    
    Add these sections to the Hexagon linker script so the build continues to
    work.  ld.lld's orphan section warning would have caught this prior to the
    -mm commit mentioned above:
    
    ld.lld: warning: kernel/built-in.a(softirq.o):(.softirqentry.text) is being placed in '.softirqentry.text'
    ld.lld: warning: kernel/built-in.a(softirq.o):(.softirqentry.text) is being placed in '.softirqentry.text'
    ld.lld: warning: kernel/built-in.a(softirq.o):(.softirqentry.text) is being placed in '.softirqentry.text'
    
    Link: https://lkml.kernel.org/r/20210521011239.1332345-1-nathan@kernel.org
    Link: https://lkml.kernel.org/r/20210521011239.1332345-2-nathan@kernel.org
    Link: https://github.com/ClangBuiltLinux/linux/issues/1381
    Fixes: 505a0ef15f96 ("kasan: stackdepot: move filter_irq_stacks() to stackdepot.c")
    Signed-off-by: Nathan Chancellor <nathan@kernel.org>
    Reviewed-by: Nick Desaulniers <ndesaulniers@google.com>
    Acked-by: Brian Cain <bcain@codeaurora.org>
    Cc: Oliver Glitta <glittao@gmail.com>
    Cc: Vlastimil Babka <vbabka@suse.cz>
    Cc: David Rientjes <rientjes@google.com>
    Signed-off-by: Andrew Morton <akpm@linux-foundation.org>
    Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit 9e5b0805f80f485ff1076c313100a33e7f06cac2
Author: Geert Uytterhoeven <geert+renesas@glider.be>
Date:   Tue Mar 16 14:37:33 2021 +0100

    reset: RESET_BRCMSTB_RESCAL should depend on ARCH_BRCMSTB
    
    [ Upstream commit 42f6a76fbe85e5243f83a3ed76809b1ebbb7087e ]
    
    The Broadcom STB RESCAL reset controller is only present on Broadcom
    BCM7216 platforms.  Hence add a dependency on ARCH_BRCMSTB, to prevent
    asking the user about this driver when configuring a kernel without
    BCM7216 support.
    
    Also, merely enabling CONFIG_COMPILE_TEST should not enable additional
    code, and thus should not enable this driver by default.
    
    Fixes: 4cf176e52397853e ("reset: Add Broadcom STB RESCAL reset controller")
    Signed-off-by: Geert Uytterhoeven <geert+renesas@glider.be>
    Acked-by: Florian Fainelli <f.fainelli@gmail.com>
    Signed-off-by: Philipp Zabel <p.zabel@pengutronix.de>
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit 2cdd0d6229dbb397fca1448b4fc26e51a6a945e2
Author: Nathan Chancellor <nathan@kernel.org>
Date:   Wed Jul 7 18:07:38 2021 -0700

    hexagon: handle {,SOFT}IRQENTRY_TEXT in linker script
    
    [ Upstream commit 6fef087d0d37ba7dba8f3d75566eb4c256cd6742 ]
    
    Patch series "hexagon: Fix build error with CONFIG_STACKDEPOT and select CONFIG_ARCH_WANT_LD_ORPHAN_WARN".
    
    This series fixes an error with ARCH=hexagon that was pointed out by the
    patch "mm/slub: use stackdepot to save stack trace in objects".
    
    The first patch fixes that error by handling the '.irqentry.text' and
    '.softirqentry.text' sections.
    
    The second patch switches Hexagon over to the common DISCARDS macro, which
    should have been done when Hexagon was merged into the tree to match
    commit 023bf6f1b8bf ("linker script: unify usage of discard definition").
    
    The third patch selects CONFIG_ARCH_WANT_LD_ORPHAN_WARN so that something
    like this does not happen again.
    
    This patch (of 3):
    
    Patch "mm/slub: use stackdepot to save stack trace in objects" in -mm
    selects CONFIG_STACKDEPOT when CONFIG_STACKTRACE_SUPPORT is selected and
    CONFIG_STACKDEPOT requires IRQENTRY_TEXT and SOFTIRQENTRY_TEXT to be
    handled after commit 505a0ef15f96 ("kasan: stackdepot: move
    filter_irq_stacks() to stackdepot.c") due to the use of the
    __{,soft}irqentry_text_{start,end} section symbols.  If those sections are
    not handled, the build is broken.
    
    $ make ARCH=hexagon CROSS_COMPILE=hexagon-linux- LLVM=1 LLVM_IAS=1 defconfig all
    ...
    ld.lld: error: undefined symbol: __irqentry_text_start
    >>> referenced by stackdepot.c
    >>>               stackdepot.o:(filter_irq_stacks) in archive lib/built-in.a
    >>> referenced by stackdepot.c
    >>>               stackdepot.o:(filter_irq_stacks) in archive lib/built-in.a
    
    ld.lld: error: undefined symbol: __irqentry_text_end
    >>> referenced by stackdepot.c
    >>>               stackdepot.o:(filter_irq_stacks) in archive lib/built-in.a
    >>> referenced by stackdepot.c
    >>>               stackdepot.o:(filter_irq_stacks) in archive lib/built-in.a
    
    ld.lld: error: undefined symbol: __softirqentry_text_start
    >>> referenced by stackdepot.c
    >>>               stackdepot.o:(filter_irq_stacks) in archive lib/built-in.a
    >>> referenced by stackdepot.c
    >>>               stackdepot.o:(filter_irq_stacks) in archive lib/built-in.a
    
    ld.lld: error: undefined symbol: __softirqentry_text_end
    >>> referenced by stackdepot.c
    >>>               stackdepot.o:(filter_irq_stacks) in archive lib/built-in.a
    >>> referenced by stackdepot.c
    >>>               stackdepot.o:(filter_irq_stacks) in archive lib/built-in.a
    ...
    
    Add these sections to the Hexagon linker script so the build continues to
    work.  ld.lld's orphan section warning would have caught this prior to the
    -mm commit mentioned above:
    
    ld.lld: warning: kernel/built-in.a(softirq.o):(.softirqentry.text) is being placed in '.softirqentry.text'
    ld.lld: warning: kernel/built-in.a(softirq.o):(.softirqentry.text) is being placed in '.softirqentry.text'
    ld.lld: warning: kernel/built-in.a(softirq.o):(.softirqentry.text) is being placed in '.softirqentry.text'
    
    Link: https://lkml.kernel.org/r/20210521011239.1332345-1-nathan@kernel.org
    Link: https://lkml.kernel.org/r/20210521011239.1332345-2-nathan@kernel.org
    Link: https://github.com/ClangBuiltLinux/linux/issues/1381
    Fixes: 505a0ef15f96 ("kasan: stackdepot: move filter_irq_stacks() to stackdepot.c")
    Signed-off-by: Nathan Chancellor <nathan@kernel.org>
    Reviewed-by: Nick Desaulniers <ndesaulniers@google.com>
    Acked-by: Brian Cain <bcain@codeaurora.org>
    Cc: Oliver Glitta <glittao@gmail.com>
    Cc: Vlastimil Babka <vbabka@suse.cz>
    Cc: David Rientjes <rientjes@google.com>
    Signed-off-by: Andrew Morton <akpm@linux-foundation.org>
    Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit 1347d04d66f7bb201a24a7d1b7560174ad8cdefd
Author: Geert Uytterhoeven <geert+renesas@glider.be>
Date:   Tue Mar 16 14:37:33 2021 +0100

    reset: RESET_BRCMSTB_RESCAL should depend on ARCH_BRCMSTB
    
    [ Upstream commit 42f6a76fbe85e5243f83a3ed76809b1ebbb7087e ]
    
    The Broadcom STB RESCAL reset controller is only present on Broadcom
    BCM7216 platforms.  Hence add a dependency on ARCH_BRCMSTB, to prevent
    asking the user about this driver when configuring a kernel without
    BCM7216 support.
    
    Also, merely enabling CONFIG_COMPILE_TEST should not enable additional
    code, and thus should not enable this driver by default.
    
    Fixes: 4cf176e52397853e ("reset: Add Broadcom STB RESCAL reset controller")
    Signed-off-by: Geert Uytterhoeven <geert+renesas@glider.be>
    Acked-by: Florian Fainelli <f.fainelli@gmail.com>
    Signed-off-by: Philipp Zabel <p.zabel@pengutronix.de>
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit 91a711977033168e7a7abe06637558169ee7ab7d
Author: Nathan Chancellor <nathan@kernel.org>
Date:   Wed Jul 7 18:07:38 2021 -0700

    hexagon: handle {,SOFT}IRQENTRY_TEXT in linker script
    
    [ Upstream commit 6fef087d0d37ba7dba8f3d75566eb4c256cd6742 ]
    
    Patch series "hexagon: Fix build error with CONFIG_STACKDEPOT and select CONFIG_ARCH_WANT_LD_ORPHAN_WARN".
    
    This series fixes an error with ARCH=hexagon that was pointed out by the
    patch "mm/slub: use stackdepot to save stack trace in objects".
    
    The first patch fixes that error by handling the '.irqentry.text' and
    '.softirqentry.text' sections.
    
    The second patch switches Hexagon over to the common DISCARDS macro, which
    should have been done when Hexagon was merged into the tree to match
    commit 023bf6f1b8bf ("linker script: unify usage of discard definition").
    
    The third patch selects CONFIG_ARCH_WANT_LD_ORPHAN_WARN so that something
    like this does not happen again.
    
    This patch (of 3):
    
    Patch "mm/slub: use stackdepot to save stack trace in objects" in -mm
    selects CONFIG_STACKDEPOT when CONFIG_STACKTRACE_SUPPORT is selected and
    CONFIG_STACKDEPOT requires IRQENTRY_TEXT and SOFTIRQENTRY_TEXT to be
    handled after commit 505a0ef15f96 ("kasan: stackdepot: move
    filter_irq_stacks() to stackdepot.c") due to the use of the
    __{,soft}irqentry_text_{start,end} section symbols.  If those sections are
    not handled, the build is broken.
    
    $ make ARCH=hexagon CROSS_COMPILE=hexagon-linux- LLVM=1 LLVM_IAS=1 defconfig all
    ...
    ld.lld: error: undefined symbol: __irqentry_text_start
    >>> referenced by stackdepot.c
    >>>               stackdepot.o:(filter_irq_stacks) in archive lib/built-in.a
    >>> referenced by stackdepot.c
    >>>               stackdepot.o:(filter_irq_stacks) in archive lib/built-in.a
    
    ld.lld: error: undefined symbol: __irqentry_text_end
    >>> referenced by stackdepot.c
    >>>               stackdepot.o:(filter_irq_stacks) in archive lib/built-in.a
    >>> referenced by stackdepot.c
    >>>               stackdepot.o:(filter_irq_stacks) in archive lib/built-in.a
    
    ld.lld: error: undefined symbol: __softirqentry_text_start
    >>> referenced by stackdepot.c
    >>>               stackdepot.o:(filter_irq_stacks) in archive lib/built-in.a
    >>> referenced by stackdepot.c
    >>>               stackdepot.o:(filter_irq_stacks) in archive lib/built-in.a
    
    ld.lld: error: undefined symbol: __softirqentry_text_end
    >>> referenced by stackdepot.c
    >>>               stackdepot.o:(filter_irq_stacks) in archive lib/built-in.a
    >>> referenced by stackdepot.c
    >>>               stackdepot.o:(filter_irq_stacks) in archive lib/built-in.a
    ...
    
    Add these sections to the Hexagon linker script so the build continues to
    work.  ld.lld's orphan section warning would have caught this prior to the
    -mm commit mentioned above:
    
    ld.lld: warning: kernel/built-in.a(softirq.o):(.softirqentry.text) is being placed in '.softirqentry.text'
    ld.lld: warning: kernel/built-in.a(softirq.o):(.softirqentry.text) is being placed in '.softirqentry.text'
    ld.lld: warning: kernel/built-in.a(softirq.o):(.softirqentry.text) is being placed in '.softirqentry.text'
    
    Link: https://lkml.kernel.org/r/20210521011239.1332345-1-nathan@kernel.org
    Link: https://lkml.kernel.org/r/20210521011239.1332345-2-nathan@kernel.org
    Link: https://github.com/ClangBuiltLinux/linux/issues/1381
    Fixes: 505a0ef15f96 ("kasan: stackdepot: move filter_irq_stacks() to stackdepot.c")
    Signed-off-by: Nathan Chancellor <nathan@kernel.org>
    Reviewed-by: Nick Desaulniers <ndesaulniers@google.com>
    Acked-by: Brian Cain <bcain@codeaurora.org>
    Cc: Oliver Glitta <glittao@gmail.com>
    Cc: Vlastimil Babka <vbabka@suse.cz>
    Cc: David Rientjes <rientjes@google.com>
    Signed-off-by: Andrew Morton <akpm@linux-foundation.org>
    Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit 77e5253deadf7fae59207330e3a639e592ee7892
Author: Joakim Zhang <qiangqing.zhang@nxp.com>
Date:   Mon Jul 19 15:18:21 2021 +0800

    arm64: dts: imx8mp: change interrupt order per dt-binding
    
    This patch changs interrupt order which found by dtbs_check.
    
    $ make ARCH=arm64 CROSS_COMPILE=aarch64-linux-gnu- dtbs_check DT_SCHEMA_FILES=Documentation/devicetree/bindings/net/nxp,dwmac-imx.yaml
    arch/arm64/boot/dts/freescale/imx8mp-evk.dt.yaml: ethernet@30bf0000: interrupt-names:0: 'macirq' was expected
    arch/arm64/boot/dts/freescale/imx8mp-evk.dt.yaml: ethernet@30bf0000: interrupt-names:1: 'eth_wake_irq' was expected
    
    According to Documentation/devicetree/bindings/net/snps,dwmac.yaml, we
    should list interrupt in it's order.
    
    Signed-off-by: Joakim Zhang <qiangqing.zhang@nxp.com>
    Signed-off-by: David S. Miller <davem@davemloft.net>

commit e314a07ef263916f761b736ded7a30894709dfd7
Author: Joakim Zhang <qiangqing.zhang@nxp.com>
Date:   Mon Jul 19 15:18:20 2021 +0800

    dt-bindings: net: imx-dwmac: convert imx-dwmac bindings to yaml
    
    In order to automate the verification of DT nodes covert imx-dwmac to
    nxp,dwmac-imx.yaml, and pass below checking.
    
    $ make ARCH=arm64 CROSS_COMPILE=aarch64-linux-gnu- dt_binding_check DT_SCHEMA_FILES=Documentation/devicetree/bindings/net/nxp,dwmac-imx.yaml
    $ make ARCH=arm64 CROSS_COMPILE=aarch64-linux-gnu- dtbs_check DT_SCHEMA_FILES=Documentation/devicetree/bindings/net/nxp,dwmac-imx.yaml
    
    Signed-off-by: Joakim Zhang <qiangqing.zhang@nxp.com>
    Signed-off-by: David S. Miller <davem@davemloft.net>

commit bdad810eb97875813a067504424a483aaa309bad
Author: Joakim Zhang <qiangqing.zhang@nxp.com>
Date:   Mon Jul 19 15:18:19 2021 +0800

    dt-bindings: net: snps,dwmac: add missing DWMAC IP version
    
    Add missing DWMAC IP version in snps,dwmac.yaml which found by below
    command, as NXP i.MX8 families support SNPS DWMAC 5.10a IP.
    
    $ make ARCH=arm64 CROSS_COMPILE=aarch64-linux-gnu- dt_binding_check DT_SCHEMA_FILES=Documentation/devicetree/bindings/net/nxp,dwmac-imx.yaml
    Documentation/devicetree/bindings/net/nxp,dwmac-imx.example.dt.yaml:
    ethernet@30bf0000: compatible: None of ['nxp,imx8mp-dwmac-eqos', 'snps,dwmac-5.10a'] are valid under the given schema
    
    Signed-off-by: Joakim Zhang <qiangqing.zhang@nxp.com>
    Signed-off-by: David S. Miller <davem@davemloft.net>

commit 86a176f485b535d05f211dbf86df22dcc2eba6ee
Author: Joakim Zhang <qiangqing.zhang@nxp.com>
Date:   Fri Jul 16 18:29:11 2021 +0800

    ARM: dts: imx7-mba7: remove un-used "phy-reset-delay" property
    
    Remove un-used "phy-reset-delay" property which found when do dtbs_check
    (set additionalProperties: false in fsl,fec.yaml).
    Double check current driver and commit history, "phy-reset-delay" never comes
    up, so it should be safe to remove it.
    
    $ make ARCH=arm CROSS_COMPILE=arm-linux-gnueabihf- dtbs_check DT_SCHEMA_FILES=Documentation/devicetree/bindings/net/fsl,fec.yaml
    arch/arm/boot/dts/imx7d-mba7.dt.yaml: ethernet@30be0000: 'phy-reset-delay' does not match any of the regexes: 'pinctrl-[0-9]+'
    arch/arm/boot/dts/imx7d-mba7.dt.yaml: ethernet@30bf0000: 'phy-reset-delay' does not match any of the regexes: 'pinctrl-[0-9]+'
    /arch/arm/boot/dts/imx7s-mba7.dt.yaml: ethernet@30be0000: 'phy-reset-delay' does not match any of the regexes: 'pinctrl-[0-9]+'
    
    Signed-off-by: Joakim Zhang <qiangqing.zhang@nxp.com>
    Signed-off-by: David S. Miller <davem@davemloft.net>

commit 95740a9a3ad94301e79f586da48f708028d3c91c
Author: Joakim Zhang <qiangqing.zhang@nxp.com>
Date:   Fri Jul 16 18:29:10 2021 +0800

    ARM: dts: imx35: correct node name for FEC
    
    Correct node name for FEC which found when do dtbs_check.
    
    $ make ARCH=arm CROSS_COMPILE=arm-linux-gnueabihf- dtbs_check DT_SCHEMA_FILES=Documentation/devicetree/bindings/net/fsl,fec.yaml
    arch/arm/boot/dts/imx35-eukrea-mbimxsd35-baseboard.dt.yaml: fec@50038000: $nodename:0: 'fec@50038000' does not match '^ethernet(@.*)?$'
    arch/arm/boot/dts/imx35-pdk.dt.yaml: fec@50038000: $nodename:0: 'fec@50038000' does not match '^ethernet(@.*)?$'
    
    Signed-off-by: Joakim Zhang <qiangqing.zhang@nxp.com>
    Signed-off-by: David S. Miller <davem@davemloft.net>

commit 96e4781b3d9399ab75c4d2d8b5833c7e8d60ff6b
Author: Joakim Zhang <qiangqing.zhang@nxp.com>
Date:   Fri Jul 16 18:29:09 2021 +0800

    dt-bindings: net: fec: convert fsl,*fec bindings to yaml
    
    In order to automate the verification of DT nodes convert fsl-fec.txt to
    fsl,fec.yaml, and pass binding check with below command.
    
    $ make ARCH=arm CROSS_COMPILE=arm-linux-gnueabihf- dt_binding_check DT_SCHEMA_FILES=Documentation/devicetree/bindings/net/fsl,fec.yaml
      DTEX    Documentation/devicetree/bindings/net/fsl,fec.example.dts
      DTC     Documentation/devicetree/bindings/net/fsl,fec.example.dt.yaml
      CHECK   Documentation/devicetree/bindings/net/fsl,fec.example.dt.yaml
    
    Signed-off-by: Joakim Zhang <qiangqing.zhang@nxp.com>
    Signed-off-by: David S. Miller <davem@davemloft.net>

commit 2a1c55d4762dd34a8b0f2e36fb01b7b16b60735b
Author: Geert Uytterhoeven <geert+renesas@glider.be>
Date:   Mon Feb 8 15:38:55 2021 +0100

    soc: rockchip: ROCKCHIP_GRF should not default to y, unconditionally
    
    Merely enabling CONFIG_COMPILE_TEST should not enable additional code.
    To fix this, restrict the automatic enabling of ROCKCHIP_GRF to
    ARCH_ROCKCHIP, and ask the user in case of compile-testing.
    
    Fixes: 4c58063d4258f6be ("soc: rockchip: add driver handling grf setup")
    Signed-off-by: Geert Uytterhoeven <geert+renesas@glider.be>
    Link: https://lore.kernel.org/r/20210208143855.418374-1-geert+renesas@glider.be
    Signed-off-by: Heiko Stuebner <heiko@sntech.de>

commit 6c5c659dfe3f02e08054a6c20019e3886618b512
Author: Randy Dunlap <rdunlap@infradead.org>
Date:   Wed Jul 7 14:47:52 2021 -0700

    ASoC: atmel: ATMEL drivers don't need HAS_DMA
    
    On a config (such as arch/sh/) which does not set HAS_DMA when MMU
    is not set, several ATMEL ASoC drivers select symbols that cause
    kconfig warnings. There is one "depends on HAS_DMA" which is no longer
    needed. Dropping it eliminates the kconfig warnings and still builds
    with no problems reported.
    
    Fix the following kconfig warnings:
    
    WARNING: unmet direct dependencies detected for SND_ATMEL_SOC_PDC
      Depends on [n]: SOUND [=m] && !UML && SND [=m] && SND_SOC [=m] && SND_ATMEL_SOC [=m] && HAS_DMA [=n]
      Selected by [m]:
      - SND_ATMEL_SOC_SSC [=m] && SOUND [=m] && !UML && SND [=m] && SND_SOC [=m] && SND_ATMEL_SOC [=m]
      - SND_ATMEL_SOC_SSC_PDC [=m] && SOUND [=m] && !UML && SND [=m] && SND_SOC [=m] && SND_ATMEL_SOC [=m] && ATMEL_SSC [=m]
    
    WARNING: unmet direct dependencies detected for SND_ATMEL_SOC_SSC_PDC
      Depends on [n]: SOUND [=m] && !UML && SND [=m] && SND_SOC [=m] && SND_ATMEL_SOC [=m] && ATMEL_SSC [=m] && HAS_DMA [=n]
      Selected by [m]:
      - SND_AT91_SOC_SAM9G20_WM8731 [=m] && SOUND [=m] && !UML && SND [=m] && SND_SOC [=m] && SND_ATMEL_SOC [=m] && (ARCH_AT91 || COMPILE_TEST [=y]) && ATMEL_SSC [=m] && SND_SOC_I2C_AND_SPI [=m]
    
    WARNING: unmet direct dependencies detected for SND_ATMEL_SOC_SSC
      Depends on [n]: SOUND [=m] && !UML && SND [=m] && SND_SOC [=m] && SND_ATMEL_SOC [=m] && HAS_DMA [=n]
      Selected by [m]:
      - SND_ATMEL_SOC_SSC_DMA [=m] && SOUND [=m] && !UML && SND [=m] && SND_SOC [=m] && SND_ATMEL_SOC [=m] && ATMEL_SSC [=m]
    
    WARNING: unmet direct dependencies detected for SND_ATMEL_SOC_SSC_DMA
      Depends on [n]: SOUND [=m] && !UML && SND [=m] && SND_SOC [=m] && SND_ATMEL_SOC [=m] && ATMEL_SSC [=m] && HAS_DMA [=n]
      Selected by [m]:
      - SND_ATMEL_SOC_WM8904 [=m] && SOUND [=m] && !UML && SND [=m] && SND_SOC [=m] && SND_ATMEL_SOC [=m] && (ARCH_AT91 || COMPILE_TEST [=y]) && ATMEL_SSC [=m] && I2C [=m]
      - SND_AT91_SOC_SAM9X5_WM8731 [=m] && SOUND [=m] && !UML && SND [=m] && SND_SOC [=m] && SND_ATMEL_SOC [=m] && (ARCH_AT91 || COMPILE_TEST [=y]) && ATMEL_SSC [=m] && SND_SOC_I2C_AND_SPI [=m]
    
    Signed-off-by: Randy Dunlap <rdunlap@infradead.org>
    Reviewed-by: Codrin Ciubotariu <codrin.ciubotariu@microchip.com>
    Acked-by: Alexandre Belloni <alexandre.belloni@bootlin.com>
    Link: https://lore.kernel.org/r/20210707214752.3831-1-rdunlap@infradead.org
    Signed-off-by: Mark Brown <broonie@kernel.org>

commit 96248d6da65744e1baaa29e5c4e5dc233e29838b
Author: Randy Dunlap <rdunlap@infradead.org>
Date:   Thu Jul 8 10:33:10 2021 -0700

    net: microchip: sparx5: fix kconfig warning
    
    PHY_SPARX5_SERDES depends on OF so SPARX5_SWITCH should also depend
    on OF since 'select' does not follow any dependencies.
    
    WARNING: unmet direct dependencies detected for PHY_SPARX5_SERDES
      Depends on [n]: (ARCH_SPARX5 || COMPILE_TEST [=n]) && OF [=n] && HAS_IOMEM [=y]
      Selected by [y]:
      - SPARX5_SWITCH [=y] && NETDEVICES [=y] && ETHERNET [=y] && NET_VENDOR_MICROCHIP [=y] && NET_SWITCHDEV [=y] && HAS_IOMEM [=y]
    
    Fixes: 3cfa11bac9bb ("net: sparx5: add the basic sparx5 driver")
    Signed-off-by: Randy Dunlap <rdunlap@infradead.org>
    Cc: Lars Povlsen <lars.povlsen@microchip.com>
    Cc: Steen Hegelund <Steen.Hegelund@microchip.com>
    Cc: UNGLinuxDriver@microchip.com
    Cc: linux-arm-kernel@lists.infradead.org
    Cc: "David S. Miller" <davem@davemloft.net>
    Cc: Jakub Kicinski <kuba@kernel.org>
    Cc: netdev@vger.kernel.org
    Signed-off-by: David S. Miller <davem@davemloft.net>

commit 6fef087d0d37ba7dba8f3d75566eb4c256cd6742
Author: Nathan Chancellor <nathan@kernel.org>
Date:   Wed Jul 7 18:07:38 2021 -0700

    hexagon: handle {,SOFT}IRQENTRY_TEXT in linker script
    
    Patch series "hexagon: Fix build error with CONFIG_STACKDEPOT and select CONFIG_ARCH_WANT_LD_ORPHAN_WARN".
    
    This series fixes an error with ARCH=hexagon that was pointed out by the
    patch "mm/slub: use stackdepot to save stack trace in objects".
    
    The first patch fixes that error by handling the '.irqentry.text' and
    '.softirqentry.text' sections.
    
    The second patch switches Hexagon over to the common DISCARDS macro, which
    should have been done when Hexagon was merged into the tree to match
    commit 023bf6f1b8bf ("linker script: unify usage of discard definition").
    
    The third patch selects CONFIG_ARCH_WANT_LD_ORPHAN_WARN so that something
    like this does not happen again.
    
    This patch (of 3):
    
    Patch "mm/slub: use stackdepot to save stack trace in objects" in -mm
    selects CONFIG_STACKDEPOT when CONFIG_STACKTRACE_SUPPORT is selected and
    CONFIG_STACKDEPOT requires IRQENTRY_TEXT and SOFTIRQENTRY_TEXT to be
    handled after commit 505a0ef15f96 ("kasan: stackdepot: move
    filter_irq_stacks() to stackdepot.c") due to the use of the
    __{,soft}irqentry_text_{start,end} section symbols.  If those sections are
    not handled, the build is broken.
    
    $ make ARCH=hexagon CROSS_COMPILE=hexagon-linux- LLVM=1 LLVM_IAS=1 defconfig all
    ...
    ld.lld: error: undefined symbol: __irqentry_text_start
    >>> referenced by stackdepot.c
    >>>               stackdepot.o:(filter_irq_stacks) in archive lib/built-in.a
    >>> referenced by stackdepot.c
    >>>               stackdepot.o:(filter_irq_stacks) in archive lib/built-in.a
    
    ld.lld: error: undefined symbol: __irqentry_text_end
    >>> referenced by stackdepot.c
    >>>               stackdepot.o:(filter_irq_stacks) in archive lib/built-in.a
    >>> referenced by stackdepot.c
    >>>               stackdepot.o:(filter_irq_stacks) in archive lib/built-in.a
    
    ld.lld: error: undefined symbol: __softirqentry_text_start
    >>> referenced by stackdepot.c
    >>>               stackdepot.o:(filter_irq_stacks) in archive lib/built-in.a
    >>> referenced by stackdepot.c
    >>>               stackdepot.o:(filter_irq_stacks) in archive lib/built-in.a
    
    ld.lld: error: undefined symbol: __softirqentry_text_end
    >>> referenced by stackdepot.c
    >>>               stackdepot.o:(filter_irq_stacks) in archive lib/built-in.a
    >>> referenced by stackdepot.c
    >>>               stackdepot.o:(filter_irq_stacks) in archive lib/built-in.a
    ...
    
    Add these sections to the Hexagon linker script so the build continues to
    work.  ld.lld's orphan section warning would have caught this prior to the
    -mm commit mentioned above:
    
    ld.lld: warning: kernel/built-in.a(softirq.o):(.softirqentry.text) is being placed in '.softirqentry.text'
    ld.lld: warning: kernel/built-in.a(softirq.o):(.softirqentry.text) is being placed in '.softirqentry.text'
    ld.lld: warning: kernel/built-in.a(softirq.o):(.softirqentry.text) is being placed in '.softirqentry.text'
    
    Link: https://lkml.kernel.org/r/20210521011239.1332345-1-nathan@kernel.org
    Link: https://lkml.kernel.org/r/20210521011239.1332345-2-nathan@kernel.org
    Link: https://github.com/ClangBuiltLinux/linux/issues/1381
    Fixes: 505a0ef15f96 ("kasan: stackdepot: move filter_irq_stacks() to stackdepot.c")
    Signed-off-by: Nathan Chancellor <nathan@kernel.org>
    Reviewed-by: Nick Desaulniers <ndesaulniers@google.com>
    Acked-by: Brian Cain <bcain@codeaurora.org>
    Cc: Oliver Glitta <glittao@gmail.com>
    Cc: Vlastimil Babka <vbabka@suse.cz>
    Cc: David Rientjes <rientjes@google.com>
    Signed-off-by: Andrew Morton <akpm@linux-foundation.org>
    Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>

commit 271dbc31843244e5192f0f8a8be0da26995f944a
Author: Dan Carpenter <dan.carpenter@oracle.com>
Date:   Wed Jul 7 13:01:00 2021 +0300

    sock: unlock on error in sock_setsockopt()
    
    If copy_from_sockptr() then we need to unlock before returning.
    
    Fixes: d463126e23f1 ("net: sock: extend SO_TIMESTAMPING for PHC binding")
    Signed-off-by: Dan Carpenter <dan.carpenter@oracle.com>
    Signed-off-by: David S. Miller <davem@davemloft.net>

commit c5fb49e12f2c3c7ea04a343fdba4af265e91b61e
Author: Johannes Berg <johannes.berg@intel.com>
Date:   Fri Jun 25 10:37:34 2021 +0200

    gpio: AMD8111 and TQMX86 require HAS_IOPORT_MAP
    
    [ Upstream commit c6414e1a2bd26b0071e2b9d6034621f705dfd4c0 ]
    
    Both of these drivers use ioport_map(), so they need to
    depend on HAS_IOPORT_MAP. Otherwise, they cannot be built
    even with COMPILE_TEST on architectures without an ioport
    implementation, such as ARCH=um.
    
    Reported-by: kernel test robot <lkp@intel.com>
    Signed-off-by: Johannes Berg <johannes.berg@intel.com>
    Signed-off-by: Bartosz Golaszewski <bgolaszewski@baylibre.com>
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit 348143a38012656f914cc7d3f016849e08a76d82
Author: Johannes Berg <johannes.berg@intel.com>
Date:   Fri Jun 25 10:37:34 2021 +0200

    gpio: AMD8111 and TQMX86 require HAS_IOPORT_MAP
    
    [ Upstream commit c6414e1a2bd26b0071e2b9d6034621f705dfd4c0 ]
    
    Both of these drivers use ioport_map(), so they need to
    depend on HAS_IOPORT_MAP. Otherwise, they cannot be built
    even with COMPILE_TEST on architectures without an ioport
    implementation, such as ARCH=um.
    
    Reported-by: kernel test robot <lkp@intel.com>
    Signed-off-by: Johannes Berg <johannes.berg@intel.com>
    Signed-off-by: Bartosz Golaszewski <bgolaszewski@baylibre.com>
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit 533c5bd68164dd78f7bf0749b7971782c0a6558a
Author: Johannes Berg <johannes.berg@intel.com>
Date:   Fri Jun 25 10:37:34 2021 +0200

    gpio: AMD8111 and TQMX86 require HAS_IOPORT_MAP
    
    [ Upstream commit c6414e1a2bd26b0071e2b9d6034621f705dfd4c0 ]
    
    Both of these drivers use ioport_map(), so they need to
    depend on HAS_IOPORT_MAP. Otherwise, they cannot be built
    even with COMPILE_TEST on architectures without an ioport
    implementation, such as ARCH=um.
    
    Reported-by: kernel test robot <lkp@intel.com>
    Signed-off-by: Johannes Berg <johannes.berg@intel.com>
    Signed-off-by: Bartosz Golaszewski <bgolaszewski@baylibre.com>
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit b2bc81481750b8457c51c2e48e7af9143663c093
Merge: 88827353c696 5ce15f278333
Author: David S. Miller <davem@davemloft.net>
Date:   Thu Jul 1 13:08:19 2021 -0700

    Merge branch 'ptp-virtual-clocks-and-timestamping'
    
    Yangbo Lu says:
    
    ====================
    ptp: support virtual clocks and timestamping
    
    Current PTP driver exposes one PTP device to user which binds network
    interface/interfaces to provide timestamping. Actually we have a way
    utilizing timecounter/cyclecounter to virtualize any number of PTP
    clocks based on a same free running physical clock for using.
    The purpose of having multiple PTP virtual clocks is for user space
    to directly/easily use them for multiple domains synchronization.
    
    user
    space:     ^                                  ^
               | SO_TIMESTAMPING new flag:        | Packets with
               | SOF_TIMESTAMPING_BIND_PHC        | TX/RX HW timestamps
               v                                  v
             +--------------------------------------------+
    sock:    |     sock (new member sk_bind_phc)          |
             +--------------------------------------------+
               ^                                  ^
               | ethtool_get_phc_vclocks          | Convert HW timestamps
               |                                  | to sk_bind_phc
               v                                  v
             +--------------+--------------+--------------+
    vclock:  | ptp1         | ptp2         | ptpN         |
             +--------------+--------------+--------------+
    pclock:  |             ptp0 free running              |
             +--------------------------------------------+
    
    The block diagram may explain how it works. Besides the PTP virtual
    clocks, the packet HW timestamp converting to the bound PHC is also
    done in sock driver. For user space, PTP virtual clocks can be
    created via sysfs, and extended SO_TIMESTAMPING API (new flag
    SOF_TIMESTAMPING_BIND_PHC) can be used to bind one PTP virtual clock
    for timestamping.
    
    The test tool timestamping.c (together with linuxptp phc_ctl tool) can
    be used to verify:
    
      # echo 4 > /sys/class/ptp/ptp0/n_vclocks
      [  129.399472] ptp ptp0: new virtual clock ptp2
      [  129.404234] ptp ptp0: new virtual clock ptp3
      [  129.409532] ptp ptp0: new virtual clock ptp4
      [  129.413942] ptp ptp0: new virtual clock ptp5
      [  129.418257] ptp ptp0: guarantee physical clock free running
      #
      # phc_ctl /dev/ptp2 set 10000
      # phc_ctl /dev/ptp3 set 20000
      #
      # timestamping eno0 2 SOF_TIMESTAMPING_TX_HARDWARE SOF_TIMESTAMPING_RAW_HARDWARE SOF_TIMESTAMPING_BIND_PHC
      # timestamping eno0 2 SOF_TIMESTAMPING_RX_HARDWARE SOF_TIMESTAMPING_RAW_HARDWARE SOF_TIMESTAMPING_BIND_PHC
      # timestamping eno0 3 SOF_TIMESTAMPING_TX_HARDWARE SOF_TIMESTAMPING_RAW_HARDWARE SOF_TIMESTAMPING_BIND_PHC
      # timestamping eno0 3 SOF_TIMESTAMPING_RX_HARDWARE SOF_TIMESTAMPING_RAW_HARDWARE SOF_TIMESTAMPING_BIND_PHC
    
    Changes for v2:
            - Converted to num_vclocks for creating virtual clocks.
            - Guranteed physical clock free running when using virtual
              clocks.
            - Fixed build warning.
            - Updated copyright.
    Changes for v3:
            - Supported PTP virtual clock in default in PTP driver.
            - Protected concurrency of ptp->num_vclocks accessing.
            - Supported PHC vclocks query via ethtool.
            - Extended SO_TIMESTAMPING API for PHC binding.
            - Converted HW timestamps to PHC bound, instead of previous
              binding domain value to PHC idea.
            - Other minor fixes.
    Changes for v4:
            - Used do_aux_work callback for vclock refreshing instead.
            - Used unsigned int for vclocks number, and max_vclocks
              for limitiation.
            - Fixed mutex locking.
            - Dynamically allocated memory for vclock index storage.
            - Removed ethtool ioctl command for vclocks getting.
            - Updated doc for ethtool phc vclocks get.
            - Converted to mptcp_setsockopt_sol_socket_timestamping().
            - Passed so_timestamping for sock_set_timestamping.
            - Fixed checkpatch/build.
            - Other minor fixed.
    Changes for v5:
            - Fixed checkpatch/build/bug reported by test robot.
    ====================
    
    Signed-off-by: David S. Miller <davem@davemloft.net>

commit d463126e23f112629edb01594141ca437a92a108
Author: Yangbo Lu <yangbo.lu@nxp.com>
Date:   Wed Jun 30 16:11:59 2021 +0800

    net: sock: extend SO_TIMESTAMPING for PHC binding
    
    Since PTP virtual clock support is added, there can be
    several PTP virtual clocks based on one PTP physical
    clock for timestamping.
    
    This patch is to extend SO_TIMESTAMPING API to support
    PHC (PTP Hardware Clock) binding by adding a new flag
    SOF_TIMESTAMPING_BIND_PHC. When PTP virtual clocks are
    in use, user space can configure to bind one for
    timestamping, but PTP physical clock is not supported
    and not needed to bind.
    
    This patch is preparation for timestamp conversion from
    raw timestamp to a specific PTP virtual clock time in
    core net.
    
    Signed-off-by: Yangbo Lu <yangbo.lu@nxp.com>
    Signed-off-by: David S. Miller <davem@davemloft.net>

commit 6c9a0a0f2333b1e3c29fef47a8b12131fce4905b
Author: Yangbo Lu <yangbo.lu@nxp.com>
Date:   Wed Jun 30 16:11:58 2021 +0800

    mptcp: setsockopt: convert to mptcp_setsockopt_sol_socket_timestamping()
    
    Split timestamping handling into a new function
    mptcp_setsockopt_sol_socket_timestamping().
    This is preparation for extending SO_TIMESTAMPING
    for PHC binding, since optval will no longer be
    integer.
    
    Signed-off-by: Yangbo Lu <yangbo.lu@nxp.com>
    Signed-off-by: David S. Miller <davem@davemloft.net>

commit c6414e1a2bd26b0071e2b9d6034621f705dfd4c0
Author: Johannes Berg <johannes.berg@intel.com>
Date:   Fri Jun 25 10:37:34 2021 +0200

    gpio: AMD8111 and TQMX86 require HAS_IOPORT_MAP
    
    Both of these drivers use ioport_map(), so they need to
    depend on HAS_IOPORT_MAP. Otherwise, they cannot be built
    even with COMPILE_TEST on architectures without an ioport
    implementation, such as ARCH=um.
    
    Reported-by: kernel test robot <lkp@intel.com>
    Signed-off-by: Johannes Berg <johannes.berg@intel.com>
    Signed-off-by: Bartosz Golaszewski <bgolaszewski@baylibre.com>

commit ffaacd97fd37b9f4e825d8107f5cba5470458f0e
Author: Michael Ellerman <mpe@ellerman.id.au>
Date:   Mon Jun 21 16:49:38 2021 +1000

    powerpc/prom_init: Pass linux_banner to firmware via option vector 7
    
    Pass the value of linux_banner to firmware via option vector 7.
    
    Option vector 7 is described in "LoPAR" Linux on Power Architecture
    Reference v2.9, in table B.7 on page 824:
    
      An ASCII character formatted null terminated string that describes
      the client operating system. The string shall be human readable and
      may be displayed on the console.
    
    The string can be up to 256 bytes total, including the nul terminator.
    
    linux_banner contains lots of information, and should make it possible
    to identify the exact kernel version that is running:
    
      const char linux_banner[] =
      "Linux version " UTS_RELEASE " (" LINUX_COMPILE_BY "@"
      LINUX_COMPILE_HOST ") (" LINUX_COMPILER ") " UTS_VERSION "\n";
    
    For example:
      Linux version 4.15.0-144-generic (buildd@bos02-ppc64el-018) (gcc
      version 7.5.0 (Ubuntu 7.5.0-3ubuntu1~18.04)) #148-Ubuntu SMP Sat May 8
      02:32:13 UTC 2021 (Ubuntu 4.15.0-144.148-generic 4.15.18)
    
    It's also printed at boot to the console/dmesg, which should make it
    possible to correlate what firmware receives with the console/dmesg on
    the machine.
    
    Signed-off-by: Michael Ellerman <mpe@ellerman.id.au>
    Link: https://lore.kernel.org/r/20210621064938.2021419-2-mpe@ellerman.id.au

commit 76215889be9d2cd388207545424bbbe3bf80e1ea
Author: Randy Dunlap <rdunlap@infradead.org>
Date:   Sun May 16 14:17:03 2021 -0700

    watchdog: mtx-1: drop au1000.h header file
    
    The mtx-1_wdt driver does not need the au1000.h header file.
    Instead, the header file causes build errors, so drop it.
    
    This change fixes multiple build errors, all in au1000.h. E.g.:
    
    In file included from ../drivers/watchdog/mtx-1_wdt.c:44:
    ../arch/mips/include/asm/mach-au1x00/au1000.h: In function 'alchemy_rdsys':
    ../arch/mips/include/asm/mach-au1x00/au1000.h:603:36: error: implicit declaration of function 'KSEG1ADDR'; did you mean 'CKSEG1ADDR'? [-Werror=implicit-function-declaration]
      603 |  void __iomem *b = (void __iomem *)KSEG1ADDR(AU1000_SYS_PHYS_ADDR);
    ../arch/mips/include/asm/mach-au1x00/au1000.h:603:20: warning: cast to pointer from integer of different size [-Wint-to-pointer-cast]
      603 |  void __iomem *b = (void __iomem *)KSEG1ADDR(AU1000_SYS_PHYS_ADDR);
    
    Fixes: da2a68b3eb47 ("watchdog: Enable COMPILE_TEST where possible")
    Signed-off-by: Randy Dunlap <rdunlap@infradead.org>
    Cc: Wim Van Sebroeck <wim@linux-watchdog.org>
    Cc: Guenter Roeck <linux@roeck-us.net>
    Cc: linux-watchdog@vger.kernel.org
    Cc: Florian Fainelli <f.fainelli@gmail.com>
    Reviewed-by: Guenter Roeck <linux@roeck-us.net>
    Acked-by: Florian Fainelli <f.fainelli@gmail.com>
    Link: https://lore.kernel.org/r/20210516211703.25349-1-rdunlap@infradead.org
    Signed-off-by: Guenter Roeck <linux@roeck-us.net>
    Signed-off-by: Wim Van Sebroeck <wim@linux-watchdog.org>

commit 975f62626790dca9c085db0f47885bfef558f547
Merge: 3e6dc7b65025 3264f599c1a8
Author: David S. Miller <davem@davemloft.net>
Date:   Fri Jun 11 13:08:53 2021 -0700

    Merge branch 'dpaa2-ACPI'
    
    Ioana Ciornei says:
    
    ====================
    ACPI support for dpaa2 driver
    
    This patch set provides ACPI support to DPAA2 network drivers.
    
    It also introduces new fwnode based APIs to support phylink and phy
    layers
        Following functions are defined:
          phylink_fwnode_phy_connect()
          fwnode_mdiobus_register_phy()
          fwnode_get_phy_id()
          fwnode_phy_find_device()
          device_phy_find_device()
          fwnode_get_phy_node()
          fwnode_mdio_find_device()
          acpi_get_local_address()
    
        First one helps in connecting phy to phylink instance.
        Next three helps in getting phy_id and registering phy to mdiobus
        Next two help in finding a phy on a mdiobus.
        Next one helps in getting phy_node from a fwnode.
        Last one is used to get local address from _ADR object.
    
        Corresponding OF functions are refactored.
    
    Tested-on: LX2160ARDB
    
    Changes in v9:
     - merged some minimal changes requested in the wording of the commit
       messages
     - fixed some build problems in patch 8/15 by moving the removal of
       of_find_mii_timestamper from patch 8/15 to 9/15.
    
    Changes in v8:
     - fixed some checkpatch warnings/checks
     - included linux/fwnode_mdio.h in fwnode_mdio.c (fixed the build warnings)
     - added fwnode_find_mii_timestamper() and
       fwnode_mdiobus_phy_device_register() in order to get rid of the cycle
       dependency.
     - change to 'depends on (ACPI || OF) || COMPILE_TEST (for FWNODE_MDIO)
     - remove the fwnode_mdiobus_register from fwnode_mdio.c since it
       introduces a cycle of dependencies.
    
    Changes in v7:
    - correct fwnode_mdio_find_device() description
    - check NULL in unregister_mii_timestamper()
    - Call unregister_mii_timestamper() without NULL check
    - Create fwnode_mdio.c and move fwnode_mdiobus_register_phy()
    - include fwnode_mdio.h
    - Include headers directly used in acpi_mdio.c
    - Move fwnode_mdiobus_register() to fwnode_mdio.c
    - Include fwnode_mdio.h
    - Alphabetically sort header inclusions
    - remove unnecassary checks
    
    Changes in v6:
    - Minor cleanup
    - fix warning for function parameter of fwnode_mdio_find_device()
    - Initialize mii_ts to NULL
    - use GENMASK() and ACPI_COMPANION_SET()
    - some cleanup
    - remove unwanted header inclusion
    - remove OF check for fixed-link
    - use dev_fwnode()
    - remove useless else
    - replace of_device_is_available() to fwnode_device_is_available()
    
    Changes in v5:
    - More cleanup
    - Replace fwnode_get_id() with acpi_get_local_address()
    - add missing MODULE_LICENSE()
    - replace fwnode_get_id() with OF and ACPI function calls
    - replace fwnode_get_id() with OF and ACPI function calls
    
    Changes in v4:
    - More cleanup
    - Improve code structure to handle all cases
    - Remove redundant else from fwnode_mdiobus_register()
    - Cleanup xgmac_mdio_probe()
    - call phy_device_free() before returning
    
    Changes in v3:
    - Add more info on legacy DT properties "phy" and "phy-device"
    - Redefine fwnode_phy_find_device() to follow of_phy_find_device()
    - Use traditional comparison pattern
    - Use GENMASK
    - Modified to retrieve reg property value for ACPI as well
    - Resolved compilation issue with CONFIG_ACPI = n
    - Added more info into documentation
    - Use acpi_mdiobus_register()
    - Avoid unnecessary line removal
    - Remove unused inclusion of acpi.h
    
    Changes in v2:
    - Updated with more description in document
    - use reverse christmas tree ordering for local variables
    - Refactor OF functions to use fwnode functions
    ====================
    
    Signed-off-by: David S. Miller <davem@davemloft.net>

commit e0e8b6abe8c862229ba00cdd806e8598cdef00bb
Author: Joel Stanley <joel@jms.id.au>
Date:   Thu Jun 10 13:19:57 2021 +0930

    usb: gadget: fsl: Re-enable driver for ARM SoCs
    
    The commit a390bef7db1f ("usb: gadget: fsl_mxc_udc: Remove the driver")
    dropped the ARCH_MXC dependency from USB_FSL_USB2, leaving it depending
    solely on FSL_SOC.
    
    FSL_SOC is powerpc only; it was briefly available on ARM in 2014 but was
    removed by commit cfd074ad8600 ("ARM: imx: temporarily remove
    CONFIG_SOC_FSL from LS1021A"). Therefore the driver can no longer be
    enabled on ARM platforms.
    
    This appears to be a mistake as arm64's ARCH_LAYERSCAPE and arm32
    SOC_LS1021A SoCs use this symbol. It's enabled in these defconfigs:
    
    arch/arm/configs/imx_v6_v7_defconfig:CONFIG_USB_FSL_USB2=y
    arch/arm/configs/multi_v7_defconfig:CONFIG_USB_FSL_USB2=y
    arch/powerpc/configs/mgcoge_defconfig:CONFIG_USB_FSL_USB2=y
    arch/powerpc/configs/mpc512x_defconfig:CONFIG_USB_FSL_USB2=y
    
    To fix, expand the dependencies so USB_FSL_USB2 can be enabled on the
    ARM platforms, and with COMPILE_TEST.
    
    Fixes: a390bef7db1f ("usb: gadget: fsl_mxc_udc: Remove the driver")
    Signed-off-by: Joel Stanley <joel@jms.id.au>
    Link: https://lore.kernel.org/r/20210610034957.93376-1-joel@jms.id.au
    Cc: stable <stable@vger.kernel.org>
    Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>

commit 47b0e3728f47b9babe0beadf25f77c24063decf6
Author: Javier Martinez Canillas <javierm@redhat.com>
Date:   Wed May 26 23:52:28 2021 +0200

    kbuild: Quote OBJCOPY var to avoid a pahole call break the build
    
    [ Upstream commit ff2e6efda0d5c51b33e2bcc0b0b981ac0a0ef214 ]
    
    The ccache tool can be used to speed up cross-compilation, by calling the
    compiler and binutils through ccache. For example, following should work:
    
        $ export ARCH=arm64 CROSS_COMPILE="ccache aarch64-linux-gnu-"
    
        $ make M=drivers/gpu/drm/rockchip/
    
    but pahole fails to extract the BTF info from DWARF, breaking the build:
    
          CC [M]  drivers/gpu/drm/rockchip//rockchipdrm.mod.o
          LD [M]  drivers/gpu/drm/rockchip//rockchipdrm.ko
          BTF [M] drivers/gpu/drm/rockchip//rockchipdrm.ko
        aarch64-linux-gnu-objcopy: invalid option -- 'J'
        Usage: aarch64-linux-gnu-objcopy [option(s)] in-file [out-file]
         Copies a binary file, possibly transforming it in the process
        ...
        make[1]: *** [scripts/Makefile.modpost:156: __modpost] Error 2
        make: *** [Makefile:1866: modules] Error 2
    
    this fails because OBJCOPY is set to "ccache aarch64-linux-gnu-copy" and
    later pahole is executed with the following command line:
    
        LLVM_OBJCOPY=$(OBJCOPY) $(PAHOLE) -J --btf_base vmlinux $@
    
    which gets expanded to:
    
        LLVM_OBJCOPY=ccache aarch64-linux-gnu-objcopy pahole -J ...
    
    instead of:
    
        LLVM_OBJCOPY="ccache aarch64-linux-gnu-objcopy" pahole -J ...
    
    Fixes: 5f9ae91f7c0d ("kbuild: Build kernel module BTFs if BTF is enabled and pahole supports it")
    Signed-off-by: Javier Martinez Canillas <javierm@redhat.com>
    Signed-off-by: Andrii Nakryiko <andrii@kernel.org>
    Acked-by: Andrii Nakryiko <andrii@kernel.org>
    Acked-by: Arnaldo Carvalho de Melo <acme@redhat.com>
    Link: https://lore.kernel.org/bpf/20210526215228.3729875-1-javierm@redhat.com
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit 48a74b1147f7db4623eaed591cc01eb740b871c0
Author: Thierry Reding <treding@nvidia.com>
Date:   Wed Jun 9 13:28:06 2021 +0200

    reset: Add compile-test stubs
    
    Add stubs for the reset controller registration functions to allow
    building reset controller provider drivers with the COMPILE_TEST
    Kconfig option enabled.
    
    Reported-by: Krzysztof Kozlowski <krzysztof.kozlowski@canonical.com>
    Suggested-by: Dmitry Osipenko <digetx@gmail.com>
    Signed-off-by: Thierry Reding <treding@nvidia.com>
    Link: https://lore.kernel.org/r/20210609112806.3565057-3-thierry.reding@gmail.com
    Signed-off-by: Philipp Zabel <p.zabel@pengutronix.de>

commit 0779890fed7817725f399d6ec85730e08ebfdeee
Author: Jean-Philippe Brucker <jean-philippe@linaro.org>
Date:   Thu Jun 3 19:05:16 2021 +0200

    tools/bpftool: Fix cross-build
    
    When the bootstrap and final bpftool have different architectures, we
    need to build two distinct disasm.o objects. Add a recipe for the
    bootstrap disasm.o.
    
    After commit d510296d331a ("bpftool: Use syscall/loader program in
    "prog load" and "gen skeleton" command.") cross-building bpftool didn't
    work anymore, because the bootstrap bpftool was linked using objects
    from different architectures:
    
      $ make O=/tmp/bpftool ARCH=arm64 CROSS_COMPILE=aarch64-linux-gnu- -C tools/bpf/bpftool/ V=1
      [...]
      aarch64-linux-gnu-gcc ... -c -MMD -o /tmp/bpftool/disasm.o /home/z/src/linux/kernel/bpf/disasm.c
      gcc ... -c -MMD -o /tmp/bpftool//bootstrap/main.o main.c
      gcc ... -o /tmp/bpftool//bootstrap/bpftool /tmp/bpftool//bootstrap/main.o ... /tmp/bpftool/disasm.o
      /usr/bin/ld: /tmp/bpftool/disasm.o: Relocations in generic ELF (EM: 183)
      /usr/bin/ld: /tmp/bpftool/disasm.o: Relocations in generic ELF (EM: 183)
      /usr/bin/ld: /tmp/bpftool/disasm.o: Relocations in generic ELF (EM: 183)
      /usr/bin/ld: /tmp/bpftool/disasm.o: error adding symbols: file in wrong format
      collect2: error: ld returned 1 exit status
      [...]
    
    The final bpftool was built for e.g. arm64, while the bootstrap bpftool,
    executed on the host, was built for x86. The problem here was that disasm.o
    linked into the bootstrap bpftool was arm64 rather than x86. With the fix
    we build two disasm.o, one for the target bpftool in arm64, and one for
    the bootstrap bpftool in x86.
    
    Fixes: d510296d331a ("bpftool: Use syscall/loader program in "prog load" and "gen skeleton" command.")
    Signed-off-by: Jean-Philippe Brucker <jean-philippe@linaro.org>
    Signed-off-by: Andrii Nakryiko <andrii@kernel.org>
    Signed-off-by: Daniel Borkmann <daniel@iogearbox.net>
    Acked-by: Andrii Nakryiko <andrii@kernel.org>
    Link: https://lore.kernel.org/bpf/20210603170515.1854642-1-jean-philippe@linaro.org

commit d15fd7359ab18a46c5fefc36be45b36205f1acfc
Merge: ebbf5fcb94a7 5e6af0a729b6
Author: David S. Miller <davem@davemloft.net>
Date:   Fri Jun 4 14:08:09 2021 -0700

    Merge branch 'mptcp-timestamps'
    
    Mat Martineau says:
    
    ====================
    mptcp: Add timestamp support
    
    Enable the SO_TIMESTAMP and SO_TIMESTAMPING socket options for MPTCP
    sockets and add receive path cmsg support for timestamps.
    
    Patches 1, 2, and 5 expose existing sock and tcp helpers for timestamps
    (no new EXPORT_SYMBOLS()s).
    
    Patch 3 propagates timestamp options to subflows.
    
    Patch 4 cleans up MPTCP handling of SOL_SOCKET options.
    
    Patch 6 adds timestamp csmg data when receiving on sockets that have
    been configured for timestamps.
    
    Patch 7 adds self test coverage for timestamps.
    ====================
    
    Signed-off-by: David S. Miller <davem@davemloft.net>

commit ced122d90f52eb6ff37272e32941845d46ac64c6
Author: Florian Westphal <fw@strlen.de>
Date:   Thu Jun 3 16:24:28 2021 -0700

    sock: expose so_timestamping options for mptcp
    
    Similar to previous patch: expose SO_TIMESTAMPING helper so we do not
    have to copy & paste this into the mptcp core.
    
    Acked-by: Paolo Abeni <pabeni@redhat.com>
    Signed-off-by: Florian Westphal <fw@strlen.de>
    Signed-off-by: Mat Martineau <mathew.j.martineau@linux.intel.com>
    Signed-off-by: David S. Miller <davem@davemloft.net>

commit 51c8b49762e497b6f72185af951b192e7678c61d
Author: Stephen Boyd <sboyd@kernel.org>
Date:   Fri Jun 4 12:20:22 2021 -0700

    clk: versatile: Depend on HAS_IOMEM
    
    kbuild robot reports that s390 fails to build this driver with
    COMPILE_TEST. Let's depend on HAS_IOMEM so that s390 doesn't try to
    build it.
    
    Cc: Lee Jones <lee.jones@linaro.org>
    Acked-by: Linus Walleij <linus.walleij@linaro.org>
    Reported-by: kernel test robot <lkp@intel.com>
    Fixes: 419b3ab6987f ("clk: versatile: remove dependency on ARCH_*")
    Link: https://lore.kernel.org/r/20210604192321.2594519-1-sboyd@kernel.org
    Signed-off-by: Stephen Boyd <sboyd@kernel.org>

commit e36710dc06e3994c9abe78b957a07cfd9243a674
Author: Kashyap Desai <kashyap.desai@broadcom.com>
Date:   Thu May 20 20:55:29 2021 +0530

    scsi: mpi3mr: Additional event handling
    
    Implement support for handling the following MPI events:
    
     - MPI3_EVENT_SAS_BROADCAST_PRIMITIVE
     - MPI3_EVENT_CABLE_MGMT
     - MPI3_EVENT_ENERGY_PACK_CHANGE
    
    Link: https://lore.kernel.org/r/20210520152545.2710479-9-kashyap.desai@broadcom.com
    Cc: sathya.prakash@broadcom.com
    Reviewed-by: Hannes Reinecke <hare@suse.de>
    Reviewed-by: Tomas Henzl <thenzl@redhat.com>
    Reviewed-by: Himanshu Madhani <himanshu.madhani@oracle.com>
    Signed-off-by: Kashyap Desai <kashyap.desai@broadcom.com>
    Signed-off-by: Martin K. Petersen <martin.petersen@oracle.com>

commit 8e653455547a471d464cdcfe07f925903cb6f2dd
Author: Kashyap Desai <kashyap.desai@broadcom.com>
Date:   Thu May 20 20:55:28 2021 +0530

    scsi: mpi3mr: Add support for PCIe device event handling
    
    Implement support for the following PCIe-related MPI events:
    
     - MPI3_EVENT_PCIE_TOPOLOGY_CHANGE_LIST
     - MPI3_EVENT_PCIE_ENUMERATION
    
    Link: https://lore.kernel.org/r/20210520152545.2710479-8-kashyap.desai@broadcom.com
    Cc: sathya.prakash@broadcom.com
    Reviewed-by: Hannes Reinecke <hare@suse.de>
    Reviewed-by: Tomas Henzl <thenzl@redhat.com>
    Reviewed-by: Himanshu Madhani <himanshu.madhani@oracle.com>
    Signed-off-by: Kashyap Desai <kashyap.desai@broadcom.com>
    Signed-off-by: Martin K. Petersen <martin.petersen@oracle.com>

commit 13ef29ea4aa0655feab2462966f83e17df5cdad1
Author: Kashyap Desai <kashyap.desai@broadcom.com>
Date:   Thu May 20 20:55:27 2021 +0530

    scsi: mpi3mr: Add support for device add/remove event handling
    
    Firmware can report various MPI Events. Enable support for processing the
    following events related to device addition/removal to the driver:
    
     - MPI3_EVENT_DEVICE_ADDED
     - MPI3_EVENT_DEVICE_INFO_CHANGED
     - MPI3_EVENT_DEVICE_STATUS_CHANGE
     - MPI3_EVENT_ENCL_DEVICE_STATUS_CHANGE
     - MPI3_EVENT_SAS_TOPOLOGY_CHANGE_LIST
     - MPI3_EVENT_SAS_DISCOVERY
     - MPI3_EVENT_SAS_DEVICE_DISCOVERY_ERROR
    
    Link: https://lore.kernel.org/r/20210520152545.2710479-7-kashyap.desai@broadcom.com
    Cc: sathya.prakash@broadcom.com
    Reported-by: kernel test robot <lkp@intel.com>
    Reviewed-by: Tomas Henzl <thenzl@redhat.com>
    Reviewed-by: Himanshu Madhani <himanshu.madhani@oracle.com>
    Reviewed-by: Hannes Reinecke <hare@suse.de>
    Signed-off-by: Kashyap Desai <kashyap.desai@broadcom.com>
    Signed-off-by: Martin K. Petersen <martin.petersen@oracle.com>

commit c9566231cfaf448dd281cd7c516012a7e1c7e448
Author: Kashyap Desai <kashyap.desai@broadcom.com>
Date:   Thu May 20 20:55:24 2021 +0530

    scsi: mpi3mr: Create operational request and reply queue pair
    
    Create operational request and reply queue pair.
    
    The MPI3 transport interface consists of an Administrative Request Queue,
    an Administrative Reply Queue, and Operational Messaging Queues.  The
    Operational Messaging Queues are the primary communication mechanism
    between the host and the I/O Controller (IOC).  Request messages, allocated
    in host memory, identify I/O operations to be performed by the IOC. These
    operations are queued on an Operational Request Queue by the host driver.
    Reply descriptors track I/O operations as they complete.  The IOC queues
    these completions in an Operational Reply Queue.
    
    To fulfil large contiguous memory requirement, driver creates multiple
    segments and provide the list of segments. Each segment size should be 4K
    which is a hardware requirement. An element array is contiguous or
    segmented.  A contiguous element array is located in contiguous physical
    memory.  A contiguous element array must be aligned on an element size
    boundary.  An element's physical address within the array may be directly
    calculated from the base address, the Producer/Consumer index, and the
    element size.
    
    Expected phased identifier bit is used to find out valid entry on reply
    queue. Driver sets <ephase> bit and IOC inverts the value of this bit on
    each pass.
    
    Link: https://lore.kernel.org/r/20210520152545.2710479-4-kashyap.desai@broadcom.com
    Cc: sathya.prakash@broadcom.com
    Reviewed-by: Hannes Reinecke <hare@suse.de>
    Reviewed-by: Tomas Henzl <thenzl@redhat.com>
    Reviewed-by: Himanshu Madhani <himanshu.madhani@oracle.com>
    Signed-off-by: Kashyap Desai <kashyap.desai@broadcom.com>
    Signed-off-by: Martin K. Petersen <martin.petersen@oracle.com>

commit ff2e6efda0d5c51b33e2bcc0b0b981ac0a0ef214
Author: Javier Martinez Canillas <javierm@redhat.com>
Date:   Wed May 26 23:52:28 2021 +0200

    kbuild: Quote OBJCOPY var to avoid a pahole call break the build
    
    The ccache tool can be used to speed up cross-compilation, by calling the
    compiler and binutils through ccache. For example, following should work:
    
        $ export ARCH=arm64 CROSS_COMPILE="ccache aarch64-linux-gnu-"
    
        $ make M=drivers/gpu/drm/rockchip/
    
    but pahole fails to extract the BTF info from DWARF, breaking the build:
    
          CC [M]  drivers/gpu/drm/rockchip//rockchipdrm.mod.o
          LD [M]  drivers/gpu/drm/rockchip//rockchipdrm.ko
          BTF [M] drivers/gpu/drm/rockchip//rockchipdrm.ko
        aarch64-linux-gnu-objcopy: invalid option -- 'J'
        Usage: aarch64-linux-gnu-objcopy [option(s)] in-file [out-file]
         Copies a binary file, possibly transforming it in the process
        ...
        make[1]: *** [scripts/Makefile.modpost:156: __modpost] Error 2
        make: *** [Makefile:1866: modules] Error 2
    
    this fails because OBJCOPY is set to "ccache aarch64-linux-gnu-copy" and
    later pahole is executed with the following command line:
    
        LLVM_OBJCOPY=$(OBJCOPY) $(PAHOLE) -J --btf_base vmlinux $@
    
    which gets expanded to:
    
        LLVM_OBJCOPY=ccache aarch64-linux-gnu-objcopy pahole -J ...
    
    instead of:
    
        LLVM_OBJCOPY="ccache aarch64-linux-gnu-objcopy" pahole -J ...
    
    Fixes: 5f9ae91f7c0d ("kbuild: Build kernel module BTFs if BTF is enabled and pahole supports it")
    Signed-off-by: Javier Martinez Canillas <javierm@redhat.com>
    Signed-off-by: Andrii Nakryiko <andrii@kernel.org>
    Acked-by: Andrii Nakryiko <andrii@kernel.org>
    Acked-by: Arnaldo Carvalho de Melo <acme@redhat.com>
    Link: https://lore.kernel.org/bpf/20210526215228.3729875-1-javierm@redhat.com

commit fa9fe0e0f6e224585728bafdfb9901ce8439d02e
Author: Nathan Chancellor <nathan@kernel.org>
Date:   Thu Mar 25 14:51:56 2021 -0700

    riscv: Use $(LD) instead of $(CC) to link vDSO
    
    [ Upstream commit 7f3d349065d0c643f7f7013fbf9bc9f2c90b675f ]
    
    Currently, the VDSO is being linked through $(CC). This does not match
    how the rest of the kernel links objects, which is through the $(LD)
    variable.
    
    When linking with clang, there are a couple of warnings about flags that
    will not be used during the link:
    
    clang-12: warning: argument unused during compilation: '-no-pie' [-Wunused-command-line-argument]
    clang-12: warning: argument unused during compilation: '-pg' [-Wunused-command-line-argument]
    
    '-no-pie' was added in commit 85602bea297f ("RISC-V: build vdso-dummy.o
    with -no-pie") to override '-pie' getting added to the ld command from
    distribution versions of GCC that enable PIE by default. It is
    technically no longer needed after commit c2c81bb2f691 ("RISC-V: Fix the
    VDSO symbol generaton for binutils-2.35+"), which removed vdso-dummy.o
    in favor of generating vdso-syms.S from vdso.so with $(NM) but this also
    resolves the issue in case it ever comes back due to having full control
    over the $(LD) command. '-pg' is for function tracing, it is not used
    during linking as clang states.
    
    These flags could be removed/filtered to fix the warnings but it is
    easier to just match the rest of the kernel and use $(LD) directly for
    linking. See commits
    
      fe00e50b2db8 ("ARM: 8858/1: vdso: use $(LD) instead of $(CC) to link VDSO")
      691efbedc60d ("arm64: vdso: use $(LD) instead of $(CC) to link VDSO")
      2ff906994b6c ("MIPS: VDSO: Use $(LD) instead of $(CC) to link VDSO")
      2b2a25845d53 ("s390/vdso: Use $(LD) instead of $(CC) to link vDSO")
    
    for more information.
    
    The flags are converted to linker flags and '--eh-frame-hdr' is added to
    match what is added by GCC implicitly, which can be seen by adding '-v'
    to GCC's invocation.
    
    Additionally, since this area is being modified, use the $(OBJCOPY)
    variable instead of an open coded $(CROSS_COMPILE)objcopy so that the
    user's choice of objcopy binary is respected.
    
    Link: https://github.com/ClangBuiltLinux/linux/issues/803
    Link: https://github.com/ClangBuiltLinux/linux/issues/970
    Signed-off-by: Nathan Chancellor <nathan@kernel.org>
    Reviewed-by: Fangrui Song <maskray@google.com>
    Signed-off-by: Palmer Dabbelt <palmerdabbelt@google.com>
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit b6b7f7ed7f96912c2dd96ab3151be765692b78ba
Author: Nathan Chancellor <nathan@kernel.org>
Date:   Thu Mar 25 14:51:56 2021 -0700

    riscv: Use $(LD) instead of $(CC) to link vDSO
    
    [ Upstream commit 7f3d349065d0c643f7f7013fbf9bc9f2c90b675f ]
    
    Currently, the VDSO is being linked through $(CC). This does not match
    how the rest of the kernel links objects, which is through the $(LD)
    variable.
    
    When linking with clang, there are a couple of warnings about flags that
    will not be used during the link:
    
    clang-12: warning: argument unused during compilation: '-no-pie' [-Wunused-command-line-argument]
    clang-12: warning: argument unused during compilation: '-pg' [-Wunused-command-line-argument]
    
    '-no-pie' was added in commit 85602bea297f ("RISC-V: build vdso-dummy.o
    with -no-pie") to override '-pie' getting added to the ld command from
    distribution versions of GCC that enable PIE by default. It is
    technically no longer needed after commit c2c81bb2f691 ("RISC-V: Fix the
    VDSO symbol generaton for binutils-2.35+"), which removed vdso-dummy.o
    in favor of generating vdso-syms.S from vdso.so with $(NM) but this also
    resolves the issue in case it ever comes back due to having full control
    over the $(LD) command. '-pg' is for function tracing, it is not used
    during linking as clang states.
    
    These flags could be removed/filtered to fix the warnings but it is
    easier to just match the rest of the kernel and use $(LD) directly for
    linking. See commits
    
      fe00e50b2db8 ("ARM: 8858/1: vdso: use $(LD) instead of $(CC) to link VDSO")
      691efbedc60d ("arm64: vdso: use $(LD) instead of $(CC) to link VDSO")
      2ff906994b6c ("MIPS: VDSO: Use $(LD) instead of $(CC) to link VDSO")
      2b2a25845d53 ("s390/vdso: Use $(LD) instead of $(CC) to link vDSO")
    
    for more information.
    
    The flags are converted to linker flags and '--eh-frame-hdr' is added to
    match what is added by GCC implicitly, which can be seen by adding '-v'
    to GCC's invocation.
    
    Additionally, since this area is being modified, use the $(OBJCOPY)
    variable instead of an open coded $(CROSS_COMPILE)objcopy so that the
    user's choice of objcopy binary is respected.
    
    Link: https://github.com/ClangBuiltLinux/linux/issues/803
    Link: https://github.com/ClangBuiltLinux/linux/issues/970
    Signed-off-by: Nathan Chancellor <nathan@kernel.org>
    Reviewed-by: Fangrui Song <maskray@google.com>
    Signed-off-by: Palmer Dabbelt <palmerdabbelt@google.com>
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit 16827618b6eb981a0a3de32fcf0914fcf6a9a67e
Author: Geert Uytterhoeven <geert+renesas@glider.be>
Date:   Mon Feb 8 16:02:52 2021 +0100

    phy: marvell: ARMADA375_USBCLUSTER_PHY should not default to y, unconditionally
    
    [ Upstream commit 6cb17707aad869de163d7bf42c253caf501be4e2 ]
    
    Merely enabling CONFIG_COMPILE_TEST should not enable additional code.
    To fix this, restrict the automatic enabling of ARMADA375_USBCLUSTER_PHY
    to MACH_ARMADA_375, and ask the user in case of compile-testing.
    
    Fixes: eee47538ec1f2619 ("phy: add support for USB cluster on the Armada 375 SoC")
    Signed-off-by: Geert Uytterhoeven <geert+renesas@glider.be>
    Link: https://lore.kernel.org/r/20210208150252.424706-1-geert+renesas@glider.be
    Signed-off-by: Vinod Koul <vkoul@kernel.org>
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit b52f081fcb424adb73c306a0f74a6137d47bc8ff
Author: Julian Braha <julianbraha@gmail.com>
Date:   Thu Feb 25 09:06:58 2021 +0100

    media: drivers: media: pci: sta2x11: fix Kconfig dependency on GPIOLIB
    
    [ Upstream commit 24df8b74c8b2fb42c49ffe8585562da0c96446ff ]
    
    When STA2X11_VIP is enabled, and GPIOLIB is disabled,
    Kbuild gives the following warning:
    
    WARNING: unmet direct dependencies detected for VIDEO_ADV7180
      Depends on [n]: MEDIA_SUPPORT [=y] && GPIOLIB [=n] && VIDEO_V4L2 [=y] && I2C [=y]
      Selected by [y]:
      - STA2X11_VIP [=y] && MEDIA_SUPPORT [=y] && MEDIA_PCI_SUPPORT [=y] && MEDIA_CAMERA_SUPPORT [=y] && PCI [=y] && VIDEO_V4L2 [=y] && VIRT_TO_BUS [=y] && I2C [=y] && (STA2X11 [=n] || COMPILE_TEST [=y]) && MEDIA_SUBDRV_AUTOSELECT [=y]
    
    This is because STA2X11_VIP selects VIDEO_ADV7180
    without selecting or depending on GPIOLIB,
    despite VIDEO_ADV7180 depending on GPIOLIB.
    
    Signed-off-by: Julian Braha <julianbraha@gmail.com>
    Signed-off-by: Hans Verkuil <hverkuil-cisco@xs4all.nl>
    Signed-off-by: Mauro Carvalho Chehab <mchehab+huawei@kernel.org>
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit a95dc6c2e4b5e259f38e495b1cf3070179e31cc9
Author: Geert Uytterhoeven <geert+renesas@glider.be>
Date:   Mon Feb 8 16:02:52 2021 +0100

    phy: marvell: ARMADA375_USBCLUSTER_PHY should not default to y, unconditionally
    
    [ Upstream commit 6cb17707aad869de163d7bf42c253caf501be4e2 ]
    
    Merely enabling CONFIG_COMPILE_TEST should not enable additional code.
    To fix this, restrict the automatic enabling of ARMADA375_USBCLUSTER_PHY
    to MACH_ARMADA_375, and ask the user in case of compile-testing.
    
    Fixes: eee47538ec1f2619 ("phy: add support for USB cluster on the Armada 375 SoC")
    Signed-off-by: Geert Uytterhoeven <geert+renesas@glider.be>
    Link: https://lore.kernel.org/r/20210208150252.424706-1-geert+renesas@glider.be
    Signed-off-by: Vinod Koul <vkoul@kernel.org>
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit 33e6b1674f339c5d3be56ec9b4921d1ddd14327d
Author: Markus Bloechl <markus.bloechl@ipetronik.com>
Date:   Tue May 18 11:54:11 2021 +0200

    net: lan78xx: advertise tx software timestamping support
    
    lan78xx already calls skb_tx_timestamp() in its lan78xx_start_xmit().
    Override .get_ts_info to also advertise this capability
    (SOF_TIMESTAMPING_TX_SOFTWARE) via ethtool.
    
    Signed-off-by: Markus Blchl <markus.bloechl@ipetronik.com>
    Signed-off-by: David S. Miller <davem@davemloft.net>

commit 28dcfba1a0d622b0330ae3f4a9d7c7f2c245de7a
Author: Sergio Paracuellos <sergio.paracuellos@gmail.com>
Date:   Sat May 8 09:09:28 2021 +0200

    phy: ralink: Kconfig: enable COMPILE_TEST on mt7621-pci-phy driver
    
    After use the clock apis and avoid custom architecture
    code this driver can properly be enabled for COMPILE_TEST.
    
    Signed-off-by: Sergio Paracuellos <sergio.paracuellos@gmail.com>
    Link: https://lore.kernel.org/r/20210508070930.5290-5-sergio.paracuellos@gmail.com
    Signed-off-by: Vinod Koul <vkoul@kernel.org>

commit fd5378456e4ec1a9a1cebd4d1d7f4502115341bd
Author: Geert Uytterhoeven <geert+renesas@glider.be>
Date:   Mon Feb 8 16:02:52 2021 +0100

    phy: marvell: ARMADA375_USBCLUSTER_PHY should not default to y, unconditionally
    
    [ Upstream commit 6cb17707aad869de163d7bf42c253caf501be4e2 ]
    
    Merely enabling CONFIG_COMPILE_TEST should not enable additional code.
    To fix this, restrict the automatic enabling of ARMADA375_USBCLUSTER_PHY
    to MACH_ARMADA_375, and ask the user in case of compile-testing.
    
    Fixes: eee47538ec1f2619 ("phy: add support for USB cluster on the Armada 375 SoC")
    Signed-off-by: Geert Uytterhoeven <geert+renesas@glider.be>
    Link: https://lore.kernel.org/r/20210208150252.424706-1-geert+renesas@glider.be
    Signed-off-by: Vinod Koul <vkoul@kernel.org>
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit 08ff8952e6989cb1b3f6ddd28b55b891ca06257d
Author: Geert Uytterhoeven <geert+renesas@glider.be>
Date:   Mon Feb 8 16:02:52 2021 +0100

    phy: marvell: ARMADA375_USBCLUSTER_PHY should not default to y, unconditionally
    
    [ Upstream commit 6cb17707aad869de163d7bf42c253caf501be4e2 ]
    
    Merely enabling CONFIG_COMPILE_TEST should not enable additional code.
    To fix this, restrict the automatic enabling of ARMADA375_USBCLUSTER_PHY
    to MACH_ARMADA_375, and ask the user in case of compile-testing.
    
    Fixes: eee47538ec1f2619 ("phy: add support for USB cluster on the Armada 375 SoC")
    Signed-off-by: Geert Uytterhoeven <geert+renesas@glider.be>
    Link: https://lore.kernel.org/r/20210208150252.424706-1-geert+renesas@glider.be
    Signed-off-by: Vinod Koul <vkoul@kernel.org>
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit 53191c1d78b1b6c8f0ff730a286a3e1e5e8a1e47
Author: Geert Uytterhoeven <geert+renesas@glider.be>
Date:   Mon Feb 8 16:02:52 2021 +0100

    phy: marvell: ARMADA375_USBCLUSTER_PHY should not default to y, unconditionally
    
    [ Upstream commit 6cb17707aad869de163d7bf42c253caf501be4e2 ]
    
    Merely enabling CONFIG_COMPILE_TEST should not enable additional code.
    To fix this, restrict the automatic enabling of ARMADA375_USBCLUSTER_PHY
    to MACH_ARMADA_375, and ask the user in case of compile-testing.
    
    Fixes: eee47538ec1f2619 ("phy: add support for USB cluster on the Armada 375 SoC")
    Signed-off-by: Geert Uytterhoeven <geert+renesas@glider.be>
    Link: https://lore.kernel.org/r/20210208150252.424706-1-geert+renesas@glider.be
    Signed-off-by: Vinod Koul <vkoul@kernel.org>
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit f3685a9ef29daa745d9c384d9ac5d600a6a6cee9
Author: Geert Uytterhoeven <geert+renesas@glider.be>
Date:   Mon Feb 8 16:02:52 2021 +0100

    phy: marvell: ARMADA375_USBCLUSTER_PHY should not default to y, unconditionally
    
    [ Upstream commit 6cb17707aad869de163d7bf42c253caf501be4e2 ]
    
    Merely enabling CONFIG_COMPILE_TEST should not enable additional code.
    To fix this, restrict the automatic enabling of ARMADA375_USBCLUSTER_PHY
    to MACH_ARMADA_375, and ask the user in case of compile-testing.
    
    Fixes: eee47538ec1f2619 ("phy: add support for USB cluster on the Armada 375 SoC")
    Signed-off-by: Geert Uytterhoeven <geert+renesas@glider.be>
    Link: https://lore.kernel.org/r/20210208150252.424706-1-geert+renesas@glider.be
    Signed-off-by: Vinod Koul <vkoul@kernel.org>
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit 6802047d607edfc0c40be9f99dcfddeb7b23152c
Author: Julian Braha <julianbraha@gmail.com>
Date:   Thu Feb 25 09:06:58 2021 +0100

    media: drivers: media: pci: sta2x11: fix Kconfig dependency on GPIOLIB
    
    [ Upstream commit 24df8b74c8b2fb42c49ffe8585562da0c96446ff ]
    
    When STA2X11_VIP is enabled, and GPIOLIB is disabled,
    Kbuild gives the following warning:
    
    WARNING: unmet direct dependencies detected for VIDEO_ADV7180
      Depends on [n]: MEDIA_SUPPORT [=y] && GPIOLIB [=n] && VIDEO_V4L2 [=y] && I2C [=y]
      Selected by [y]:
      - STA2X11_VIP [=y] && MEDIA_SUPPORT [=y] && MEDIA_PCI_SUPPORT [=y] && MEDIA_CAMERA_SUPPORT [=y] && PCI [=y] && VIDEO_V4L2 [=y] && VIRT_TO_BUS [=y] && I2C [=y] && (STA2X11 [=n] || COMPILE_TEST [=y]) && MEDIA_SUBDRV_AUTOSELECT [=y]
    
    This is because STA2X11_VIP selects VIDEO_ADV7180
    without selecting or depending on GPIOLIB,
    despite VIDEO_ADV7180 depending on GPIOLIB.
    
    Signed-off-by: Julian Braha <julianbraha@gmail.com>
    Signed-off-by: Hans Verkuil <hverkuil-cisco@xs4all.nl>
    Signed-off-by: Mauro Carvalho Chehab <mchehab+huawei@kernel.org>
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit 45c7c85ca3ae7f2f684ae1aed048d1e9e5b41b47
Author: Julian Braha <julianbraha@gmail.com>
Date:   Thu Feb 25 09:06:58 2021 +0100

    media: drivers: media: pci: sta2x11: fix Kconfig dependency on GPIOLIB
    
    [ Upstream commit 24df8b74c8b2fb42c49ffe8585562da0c96446ff ]
    
    When STA2X11_VIP is enabled, and GPIOLIB is disabled,
    Kbuild gives the following warning:
    
    WARNING: unmet direct dependencies detected for VIDEO_ADV7180
      Depends on [n]: MEDIA_SUPPORT [=y] && GPIOLIB [=n] && VIDEO_V4L2 [=y] && I2C [=y]
      Selected by [y]:
      - STA2X11_VIP [=y] && MEDIA_SUPPORT [=y] && MEDIA_PCI_SUPPORT [=y] && MEDIA_CAMERA_SUPPORT [=y] && PCI [=y] && VIDEO_V4L2 [=y] && VIRT_TO_BUS [=y] && I2C [=y] && (STA2X11 [=n] || COMPILE_TEST [=y]) && MEDIA_SUBDRV_AUTOSELECT [=y]
    
    This is because STA2X11_VIP selects VIDEO_ADV7180
    without selecting or depending on GPIOLIB,
    despite VIDEO_ADV7180 depending on GPIOLIB.
    
    Signed-off-by: Julian Braha <julianbraha@gmail.com>
    Signed-off-by: Hans Verkuil <hverkuil-cisco@xs4all.nl>
    Signed-off-by: Mauro Carvalho Chehab <mchehab+huawei@kernel.org>
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit f3dd6c47c4939d4945cbf8b05d642c7c9eca2e0d
Author: Julian Braha <julianbraha@gmail.com>
Date:   Thu Feb 25 09:06:58 2021 +0100

    media: drivers: media: pci: sta2x11: fix Kconfig dependency on GPIOLIB
    
    [ Upstream commit 24df8b74c8b2fb42c49ffe8585562da0c96446ff ]
    
    When STA2X11_VIP is enabled, and GPIOLIB is disabled,
    Kbuild gives the following warning:
    
    WARNING: unmet direct dependencies detected for VIDEO_ADV7180
      Depends on [n]: MEDIA_SUPPORT [=y] && GPIOLIB [=n] && VIDEO_V4L2 [=y] && I2C [=y]
      Selected by [y]:
      - STA2X11_VIP [=y] && MEDIA_SUPPORT [=y] && MEDIA_PCI_SUPPORT [=y] && MEDIA_CAMERA_SUPPORT [=y] && PCI [=y] && VIDEO_V4L2 [=y] && VIRT_TO_BUS [=y] && I2C [=y] && (STA2X11 [=n] || COMPILE_TEST [=y]) && MEDIA_SUBDRV_AUTOSELECT [=y]
    
    This is because STA2X11_VIP selects VIDEO_ADV7180
    without selecting or depending on GPIOLIB,
    despite VIDEO_ADV7180 depending on GPIOLIB.
    
    Signed-off-by: Julian Braha <julianbraha@gmail.com>
    Signed-off-by: Hans Verkuil <hverkuil-cisco@xs4all.nl>
    Signed-off-by: Mauro Carvalho Chehab <mchehab+huawei@kernel.org>
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit e18cee768a6ebb16b7ae9bfb908e05a786485c61
Author: Julian Braha <julianbraha@gmail.com>
Date:   Thu Feb 25 09:06:58 2021 +0100

    media: drivers: media: pci: sta2x11: fix Kconfig dependency on GPIOLIB
    
    [ Upstream commit 24df8b74c8b2fb42c49ffe8585562da0c96446ff ]
    
    When STA2X11_VIP is enabled, and GPIOLIB is disabled,
    Kbuild gives the following warning:
    
    WARNING: unmet direct dependencies detected for VIDEO_ADV7180
      Depends on [n]: MEDIA_SUPPORT [=y] && GPIOLIB [=n] && VIDEO_V4L2 [=y] && I2C [=y]
      Selected by [y]:
      - STA2X11_VIP [=y] && MEDIA_SUPPORT [=y] && MEDIA_PCI_SUPPORT [=y] && MEDIA_CAMERA_SUPPORT [=y] && PCI [=y] && VIDEO_V4L2 [=y] && VIRT_TO_BUS [=y] && I2C [=y] && (STA2X11 [=n] || COMPILE_TEST [=y]) && MEDIA_SUBDRV_AUTOSELECT [=y]
    
    This is because STA2X11_VIP selects VIDEO_ADV7180
    without selecting or depending on GPIOLIB,
    despite VIDEO_ADV7180 depending on GPIOLIB.
    
    Signed-off-by: Julian Braha <julianbraha@gmail.com>
    Signed-off-by: Hans Verkuil <hverkuil-cisco@xs4all.nl>
    Signed-off-by: Mauro Carvalho Chehab <mchehab+huawei@kernel.org>
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit 42f6a76fbe85e5243f83a3ed76809b1ebbb7087e
Author: Geert Uytterhoeven <geert+renesas@glider.be>
Date:   Tue Mar 16 14:37:33 2021 +0100

    reset: RESET_BRCMSTB_RESCAL should depend on ARCH_BRCMSTB
    
    The Broadcom STB RESCAL reset controller is only present on Broadcom
    BCM7216 platforms.  Hence add a dependency on ARCH_BRCMSTB, to prevent
    asking the user about this driver when configuring a kernel without
    BCM7216 support.
    
    Also, merely enabling CONFIG_COMPILE_TEST should not enable additional
    code, and thus should not enable this driver by default.
    
    Fixes: 4cf176e52397853e ("reset: Add Broadcom STB RESCAL reset controller")
    Signed-off-by: Geert Uytterhoeven <geert+renesas@glider.be>
    Acked-by: Florian Fainelli <f.fainelli@gmail.com>
    Signed-off-by: Philipp Zabel <p.zabel@pengutronix.de>

commit 71cf76d451ef40ff700320069fe58ae239f6f5aa
Author: Randy Dunlap <rdunlap@infradead.org>
Date:   Fri Apr 2 09:17:51 2021 -0700

    gpio: sch: depends on LPC_SCH
    
    Since LPC_SCH provides GPIO functionality, GPIO_SCH should depend on
    LPC_SCH to prevent kconfig warning and build errors:
    
    WARNING: unmet direct dependencies detected for LPC_SCH
      Depends on [n]: HAS_IOMEM [=y] && PCI [=n]
      Selected by [y]:
      - GPIO_SCH [=y] && GPIOLIB [=y] && X86 [=y] && (X86 [=y] || COMPILE_TEST [=n]) && ACPI [=y]
    
    and
    
    ../drivers/mfd/lpc_sch.c:204:1: warning: data definition has no type or storage class
     module_pci_driver(lpc_sch_driver);
     ^~~~~~~~~~~~~~~~~
    ../drivers/mfd/lpc_sch.c:204:1: error: type defaults to int in declaration of module_pci_driver [-Werror=implicit-int]
    ../drivers/mfd/lpc_sch.c:204:1: warning: parameter names (without types) in function declaration
    ../drivers/mfd/lpc_sch.c:197:26: warning: lpc_sch_driver defined but not used [-Wunused-variable]
     static struct pci_driver lpc_sch_driver = {
                              ^~~~~~~~~~~~~~
    
    Fixes: 6c46215d6b62 ("gpio: sch: Hook into ACPI GPE handler to catch GPIO edge events")
    Signed-off-by: Randy Dunlap <rdunlap@infradead.org>
    Cc: Linus Walleij <linus.walleij@linaro.org>
    Cc: linux-gpio@vger.kernel.org
    Cc: Bartosz Golaszewski <bgolaszewski@baylibre.com>
    Cc: Denis Turischev <denis@compulab.co.il>
    Signed-off-by: Andy Shevchenko <andriy.shevchenko@linux.intel.com>

commit bbc3b403b096220850b82e245a1e5f09b8b216a2
Merge: c3ad321932ed 5c55197cbf9b fdac035ed0ea 394cdb69a3c3 89bf9bb75e5b f6b1340dc751
Author: Stephen Boyd <sboyd@kernel.org>
Date:   Tue Apr 27 16:34:44 2021 -0700

    Merge branches 'clk-imx', 'clk-samsung', 'clk-zynq', 'clk-rockchip' and 'clk-uniphier' into clk-next
    
     - Simplify Zynq Kconfig dependencies
    
    * clk-imx:
      clk: imx: Reference preceded by free
      clk: imx8mq: Correct the pcie1 sels
      clk: imx8mp: Remove the none exist pcie clocks
      clk: imx: Fix reparenting of UARTs not associated with stdout
    
    * clk-samsung:
      clk: samsung: Remove redundant dev_err calls
      clk: exynos7: Mark aclk_fsys1_200 as critical
    
    * clk-zynq:
      clk: zynqmp: pll: add set_pll_mode to check condition in zynqmp_pll_enable
      clk: zynqmp: move zynqmp_pll_set_mode out of round_rate callback
      clk: zynqmp: Drop dependency on ARCH_ZYNQMP
      clk: zynqmp: Enable the driver if ZYNQMP_FIRMWARE is selected
    
    * clk-rockchip:
      clk: rockchip: drop MODULE_ALIAS from rk3399 clock controller
      clk: rockchip: drop parenthesis from ARM || COMPILE_TEST depends
      clk: rockchip: add clock controller for rk3568
      clk: rockchip: support more core div setting
      dt-binding: clock: Document rockchip, rk3568-cru bindings
      clk: rockchip: add dt-binding header for rk3568
    
    * clk-uniphier:
      clk: uniphier: Fix potential infinite loop

commit 91552ab8ffb81317656214daafd9a7bcf09ab0a0
Merge: 3b671bf4a706 765822e1569a
Author: Linus Torvalds <torvalds@linux-foundation.org>
Date:   Mon Apr 26 09:43:16 2021 -0700

    Merge tag 'irq-core-2021-04-26' of git://git.kernel.org/pub/scm/linux/kernel/git/tip/tip
    
    Pull irq updates from Thomas Gleixner:
     "The usual updates from the irq departement:
    
      Core changes:
    
       - Provide IRQF_NO_AUTOEN as a flag for request*_irq() so drivers can
         be cleaned up which either use a seperate mechanism to prevent
         auto-enable at request time or have a racy mechanism which disables
         the interrupt right after request.
    
       - Get rid of the last usage of irq_create_identity_mapping() and
         remove the interface.
    
       - An overhaul of tasklet_disable().
    
         Most usage sites of tasklet_disable() are in task context and
         usually in cleanup, teardown code pathes. tasklet_disable()
         spinwaits for a tasklet which is currently executed. That's not
         only a problem for PREEMPT_RT where this can lead to a live lock
         when the disabling task preempts the softirq thread. It's also
         problematic in context of virtualization when the vCPU which runs
         the tasklet is scheduled out and the disabling code has to spin
         wait until it's scheduled back in.
    
         There are a few code pathes which invoke tasklet_disable() from
         non-sleepable context. For these a new disable variant which still
         spinwaits is provided which allows to switch tasklet_disable() to a
         sleep wait mechanism. For the atomic use cases this does not solve
         the live lock issue on PREEMPT_RT. That is mitigated by blocking on
         the RT specific softirq lock.
    
       - The PREEMPT_RT specific implementation of softirq processing and
         local_bh_disable/enable().
    
         On RT enabled kernels soft interrupt processing happens always in
         task context and all interrupt handlers, which are not explicitly
         marked to be invoked in hard interrupt context are forced into task
         context as well. This allows to protect against softirq processing
         with a per CPU lock, which in turn allows to make BH disabled
         regions preemptible.
    
         Most of the softirq handling code is still shared. The RT/non-RT
         specific differences are addressed with a set of inline functions
         which provide the context specific functionality. The
         local_bh_disable() / local_bh_enable() mechanism are obviously
         seperate.
    
       - The usual set of small improvements and cleanups
    
      Driver changes:
    
       - New drivers for Nuvoton WPCM450 and DT 79rc3243x interrupt
         controllers
    
       - Extended functionality for MStar, STM32 and SC7280 irq chips
    
       - Enhanced robustness for ARM GICv3/4.1 drivers
    
       - The usual set of cleanups and improvements all over the place"
    
    * tag 'irq-core-2021-04-26' of git://git.kernel.org/pub/scm/linux/kernel/git/tip/tip: (53 commits)
      irqchip/xilinx: Expose Kconfig option for Zynq/ZynqMP
      irqchip/gic-v3: Do not enable irqs when handling spurious interrups
      dt-bindings: interrupt-controller: Add IDT 79RC3243x Interrupt Controller
      irqchip: Add support for IDT 79rc3243x interrupt controller
      irqdomain: Drop references to recusive irqdomain setup
      irqdomain: Get rid of irq_create_strict_mappings()
      irqchip/jcore-aic: Kill use of irq_create_strict_mappings()
      ARM: PXA: Kill use of irq_create_strict_mappings()
      irqchip/gic-v4.1: Disable vSGI upon (GIC CPUIF < v4.1) detection
      irqchip/tb10x: Use 'fallthrough' to eliminate a warning
      genirq: Reduce irqdebug cacheline bouncing
      kernel: Initialize cpumask before parsing
      irqchip/wpcm450: Drop COMPILE_TEST
      irqchip/irq-mst: Support polarity configuration
      irqchip: Add driver for WPCM450 interrupt controller
      dt-bindings: interrupt-controller: Add nuvoton, wpcm450-aic
      dt-bindings: qcom,pdc: Add compatible for sc7280
      irqchip/stm32: Add usart instances exti direct event support
      irqchip/gic-v3: Fix OF_BAD_ADDR error handling
      irqchip/sifive-plic: Mark two global variables __ro_after_init
      ...

commit 7f3d349065d0c643f7f7013fbf9bc9f2c90b675f
Author: Nathan Chancellor <nathan@kernel.org>
Date:   Thu Mar 25 14:51:56 2021 -0700

    riscv: Use $(LD) instead of $(CC) to link vDSO
    
    Currently, the VDSO is being linked through $(CC). This does not match
    how the rest of the kernel links objects, which is through the $(LD)
    variable.
    
    When linking with clang, there are a couple of warnings about flags that
    will not be used during the link:
    
    clang-12: warning: argument unused during compilation: '-no-pie' [-Wunused-command-line-argument]
    clang-12: warning: argument unused during compilation: '-pg' [-Wunused-command-line-argument]
    
    '-no-pie' was added in commit 85602bea297f ("RISC-V: build vdso-dummy.o
    with -no-pie") to override '-pie' getting added to the ld command from
    distribution versions of GCC that enable PIE by default. It is
    technically no longer needed after commit c2c81bb2f691 ("RISC-V: Fix the
    VDSO symbol generaton for binutils-2.35+"), which removed vdso-dummy.o
    in favor of generating vdso-syms.S from vdso.so with $(NM) but this also
    resolves the issue in case it ever comes back due to having full control
    over the $(LD) command. '-pg' is for function tracing, it is not used
    during linking as clang states.
    
    These flags could be removed/filtered to fix the warnings but it is
    easier to just match the rest of the kernel and use $(LD) directly for
    linking. See commits
    
      fe00e50b2db8 ("ARM: 8858/1: vdso: use $(LD) instead of $(CC) to link VDSO")
      691efbedc60d ("arm64: vdso: use $(LD) instead of $(CC) to link VDSO")
      2ff906994b6c ("MIPS: VDSO: Use $(LD) instead of $(CC) to link VDSO")
      2b2a25845d53 ("s390/vdso: Use $(LD) instead of $(CC) to link vDSO")
    
    for more information.
    
    The flags are converted to linker flags and '--eh-frame-hdr' is added to
    match what is added by GCC implicitly, which can be seen by adding '-v'
    to GCC's invocation.
    
    Additionally, since this area is being modified, use the $(OBJCOPY)
    variable instead of an open coded $(CROSS_COMPILE)objcopy so that the
    user's choice of objcopy binary is respected.
    
    Link: https://github.com/ClangBuiltLinux/linux/issues/803
    Link: https://github.com/ClangBuiltLinux/linux/issues/970
    Signed-off-by: Nathan Chancellor <nathan@kernel.org>
    Reviewed-by: Fangrui Song <maskray@google.com>
    Signed-off-by: Palmer Dabbelt <palmerdabbelt@google.com>

commit ef94340583eec5cb1544dc41a87baa4f684b3fe1
Author: Nick Desaulniers <ndesaulniers@google.com>
Date:   Tue Apr 20 10:44:25 2021 -0700

    arm64: vdso32: drop -no-integrated-as flag
    
    Clang can assemble these files just fine; this is a relic from the top
    level Makefile conditionally adding this. We no longer need --prefix,
    --gcc-toolchain, or -Qunused-arguments flags either with this change, so
    remove those too.
    
    To test building:
    $ ARCH=arm64 CROSS_COMPILE=aarch64-linux-gnu- \
      CROSS_COMPILE_COMPAT=arm-linux-gnueabi- make LLVM=1 LLVM_IAS=1 \
      defconfig arch/arm64/kernel/vdso32/
    
    Suggested-by: Nathan Chancellor <nathan@kernel.org>
    Signed-off-by: Nick Desaulniers <ndesaulniers@google.com>
    Reviewed-by: Nathan Chancellor <nathan@kernel.org>
    Reviewed-by: Vincenzo Frascino <vincenzo.frascino@arm.com>
    Tested-by: Stephen Boyd <swboyd@chromium.org>
    Acked-by: Will Deacon <will@kernel.org>
    Link: https://lore.kernel.org/r/20210420174427.230228-1-ndesaulniers@google.com
    Signed-off-by: Catalin Marinas <catalin.marinas@arm.com>

commit 79ebfb11fe0848e916950787bb105f1c0559a577
Author: Hans Westgaard Ry <hans.westgaard.ry@oracle.com>
Date:   Thu Apr 22 08:21:40 2021 +0200

    net/mlx4: Treat VFs fair when handling comm_channel_events
    
    Handling comm_channel_event in mlx4_master_comm_channel uses a double
    loop to determine which slaves have requested work. The search is
    always started at lowest slave. This leads to unfairness; lower VFs
    tends to be prioritized over higher VFs.
    
    The patch uses find_next_bit to determine which slaves to handle.
    Fairness is implemented by always starting at the next to the last
    start.
    
    An MPI program has been used to measure improvements. It runs 500
    ibv_reg_mr, synchronizes with all other instances and then runs 500
    ibv_dereg_mr.
    
    The results running 500 processes, time reported is for running 500
    calls:
    
    ibv_reg_mr:
                 Mod.   Org.
    mlx4_1    403.356ms 424.674ms
    mlx4_2    403.355ms 424.674ms
    mlx4_3    403.354ms 424.674ms
    mlx4_4    403.355ms 424.674ms
    mlx4_5    403.357ms 424.677ms
    mlx4_6    403.354ms 424.676ms
    mlx4_7    403.357ms 424.675ms
    mlx4_8    403.355ms 424.675ms
    
    ibv_dereg_mr:
                 Mod.   Org.
    mlx4_1    116.408ms 142.818ms
    mlx4_2    116.434ms 142.793ms
    mlx4_3    116.488ms 143.247ms
    mlx4_4    116.679ms 143.230ms
    mlx4_5    112.017ms 107.204ms
    mlx4_6    112.032ms 107.516ms
    mlx4_7    112.083ms 184.195ms
    mlx4_8    115.089ms 190.618ms
    
    Suggested-by: Hkon Bugge <haakon.bugge@oracle.com>
    Signed-off-by: Hans Westgaard Ry <hans.westgaard.ry@oracle.com>
    Reviewed-by: Tariq Toukan <tariqt@nvidia.com>
    Signed-off-by: David S. Miller <davem@davemloft.net>

commit 6ef92063bf94cd8a6fa9fea3a82596955eb25424
Author: Thomas Bogendoerfer <tsbogend@alpha.franken.de>
Date:   Mon Apr 19 00:19:47 2021 +0200

    net: korina: Make driver COMPILE_TESTable
    
    Move structs/defines for ethernet/dma register into driver, since they
    are only used for this driver and remove any MIPS specific includes.
    This makes it possible to COMPILE_TEST the driver.
    
    Signed-off-by: Thomas Bogendoerfer <tsbogend@alpha.franken.de>
    Signed-off-by: David S. Miller <davem@davemloft.net>

commit a4c55e16c50022825966864cf1f08b9efa3ebb86
Author: Vishakha Channapattan <vishakhavc@google.com>
Date:   Thu Apr 15 16:03:46 2021 +0530

    scsi: pm80xx: Add sysfs attribute to check controller hmi error
    
    A new sysfs variable 'ctl_hmi_error' is being introduced to give the error
    details if the MPI initialization fails
    
    Using the 'ctl_hmi_error' sysfs variable we can check the error details:
    
        linux-2dq0:~# cat /sys/class/scsi_host/host*/ctl_hmi_error
        0x00000000
        0x00000000
        0x00000000
    
    Link: https://lore.kernel.org/r/20210415103352.3580-3-Viswas.G@microchip.com
    Signed-off-by: Vishakha Channapattan <vishakhavc@google.com>
    Signed-off-by: Viswas G <Viswas.G@microchip.com>
    Signed-off-by: Ruksar Devadi <Ruksar.devadi@microchip.com>
    Signed-off-by: Martin K. Petersen <martin.petersen@oracle.com>

commit 4ddbea1b6f51a2ac07c4b80b3c3f50ea37367828
Author: Vishakha Channapattan <vishakhavc@google.com>
Date:   Thu Apr 15 16:03:45 2021 +0530

    scsi: pm80xx: Add sysfs attribute to check MPI state
    
    A new sysfs variable 'ctl_mpi_state' is being introduced to check the state
    of MPI.
    
    Using the 'ctl_mpi_state' sysfs variable we can check the MPI state:
    
        linux-2dq0:~# cat /sys/class/scsi_host/host*/ctl_mpi_state
        MPI is successfully initialized
    
    Link: https://lore.kernel.org/r/20210415103352.3580-2-Viswas.G@microchip.com
    Reported-by: kernel test robot <lkp@intel.com>
    Reported-by: Dan Carpenter <dan.carpenter@oracle.com>
    Signed-off-by: Vishakha Channapattan <vishakhavc@google.com>
    Signed-off-by: Viswas G <Viswas.G@microchip.com>
    Signed-off-by: Ruksar Devadi <Ruksar.devadi@microchip.com>
    Signed-off-by: Ashokkumar N <Ashokkumar.N@microchip.com>
    Signed-off-by: Radha Ramachandran <radha@google.com>
    Signed-off-by: kernel test robot <lkp@intel.com>
    Signed-off-by: Martin K. Petersen <martin.petersen@oracle.com>

commit 0cab0aa14928ddf626d9e55944b59a3520187ac7
Author: Geert Uytterhoeven <geert+renesas@glider.be>
Date:   Tue Mar 16 14:37:00 2021 +0100

    mfd: Kconfig: ABX500_CORE should depend on ARCH_U8500
    
    The ST-Ericsson ABX500 Mixed Signal IC family chips are only present on
    ST-Ericsson U8500 Series platforms.  Hence add a dependency on
    ARCH_U8500, to prevent asking the user about this driver when
    configuring a kernel without U8500 support.
    
    Also, merely enabling CONFIG_COMPILE_TEST should not enable additional
    code, and thus should not enable this driver by default.
    
    Signed-off-by: Geert Uytterhoeven <geert+renesas@glider.be>
    Reviewed-by: Linus Walleij <linus.walleij@linaro.org>
    Signed-off-by: Lee Jones <lee.jones@linaro.org>

commit 376f9e34c10faa3e94b881088b160cfda540ae5f
Author: Julian Braha <julianbraha@gmail.com>
Date:   Tue Apr 13 22:51:38 2021 -0400

    drivers: pinctrl: qcom: fix Kconfig dependency on GPIOLIB
    
    When PINCTRL_MSM is enabled, and GPIOLIB is disabled,
    Kbuild gives the following warning:
    
    WARNING: unmet direct dependencies detected for GPIOLIB_IRQCHIP
      Depends on [n]: GPIOLIB [=n]
      Selected by [y]:
      - PINCTRL_MSM [=y] && PINCTRL [=y] && (ARCH_QCOM || COMPILE_TEST [=y])
    
    This is because PINCTRL_MSM selects GPIOLIB_IRQCHIP,
    without selecting or depending on GPIOLIB, despite
    GPIOLIB_IRQCHIP depending on GPIOLIB. Having PINCTRL_MSM
    select GPIOLIB will cause a recursive dependency error.
    
    Signed-off-by: Julian Braha <julianbraha@gmail.com>
    Reviewed-by: Bjorn Andersson <bjorn.andersson@linaro.org>
    Link: https://lore.kernel.org/r/20210414025138.480085-1-julianbraha@gmail.com
    Signed-off-by: Linus Walleij <linus.walleij@linaro.org>

commit da79a5b1f0141ec5ec7438643bebaa221c4ad073
Author: Viswas G <Viswas.G@microchip.com>
Date:   Fri Apr 2 11:12:12 2021 +0530

    scsi: pm80xx: Fix chip initialization failure
    
    commit 65df7d1986a1909a0869419919e7d9c78d70407e upstream.
    
    Inbound and outbound queues were not properly configured and that lead to
    MPI configuration failure.
    
    Fixes: 05c6c029a44d ("scsi: pm80xx: Increase number of supported queues")
    Cc: stable@vger.kernel.org # 5.10+
    Link: https://lore.kernel.org/r/20210402054212.17834-1-Viswas.G@microchip.com.com
    Reported-and-tested-by: Ash Izat <ash@ai0.uk>
    Signed-off-by: Viswas G <Viswas.G@microchip.com>
    Signed-off-by: Martin K. Petersen <martin.petersen@oracle.com>
    Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>

commit d8e7fa8509d7ff335acfe2b1764dae7dd272ec77
Author: Viswas G <Viswas.G@microchip.com>
Date:   Fri Apr 2 11:12:12 2021 +0530

    scsi: pm80xx: Fix chip initialization failure
    
    commit 65df7d1986a1909a0869419919e7d9c78d70407e upstream.
    
    Inbound and outbound queues were not properly configured and that lead to
    MPI configuration failure.
    
    Fixes: 05c6c029a44d ("scsi: pm80xx: Increase number of supported queues")
    Cc: stable@vger.kernel.org # 5.10+
    Link: https://lore.kernel.org/r/20210402054212.17834-1-Viswas.G@microchip.com.com
    Reported-and-tested-by: Ash Izat <ash@ai0.uk>
    Signed-off-by: Viswas G <Viswas.G@microchip.com>
    Signed-off-by: Martin K. Petersen <martin.petersen@oracle.com>
    Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>

commit 6f305bf699fe233ef27d80cc29fd1650423c8e74
Author: Igor Pylypiv <ipylypiv@google.com>
Date:   Tue Apr 6 11:05:34 2021 -0700

    scsi: pm80xx: Remove busy wait from mpi_uninit_check()
    
    mpi_uninit_check() is not being called in an atomic context.  The only
    caller of mpi_uninit_check() is pm80xx_chip_soft_rst().
    
    Callers of pm80xx_chip_soft_rst():
    
     - pm8001_ioctl_soft_reset()
     - pm8001_pci_probe()
     - pm8001_pci_remove()
     - pm8001_pci_suspend()
     - pm8001_pci_resume()
    
    There was a similar fix for mpi_init_check() in commit
    d71023af4bec ("scsi: pm80xx: Do not busy wait in MPI init check")
    
    Link: https://lore.kernel.org/r/20210406180534.1924345-3-ipylypiv@google.com
    Reviewed-by: Vishakha Channapattan <vishakhavc@google.com>
    Acked-by: Jack Wang <jinpu.wang@ionos.com>
    Signed-off-by: Igor Pylypiv <ipylypiv@google.com>
    Signed-off-by: Martin K. Petersen <martin.petersen@oracle.com>

commit 89bf9bb75e5b561585cd08b308f5064ede6e2b4c
Merge: a38fd8748464 40f29839d8be
Author: Stephen Boyd <sboyd@kernel.org>
Date:   Mon Apr 12 12:40:32 2021 -0700

    Merge tag 'v5.13-rockchip-clocks' of git://git.kernel.org/pub/scm/linux/kernel/git/mmind/linux-rockchip into clk-rockchip
    
    Pull Rockchip clk driver updates from Heiko Stuebner:
    
     - Support for the clock controller on the new rk3568
     - Some cleanups for rk3399 modularization
    
    * tag 'v5.13-rockchip-clocks' of git://git.kernel.org/pub/scm/linux/kernel/git/mmind/linux-rockchip:
      clk: rockchip: drop MODULE_ALIAS from rk3399 clock controller
      clk: rockchip: drop parenthesis from ARM || COMPILE_TEST depends
      clk: rockchip: add clock controller for rk3568
      clk: rockchip: support more core div setting
      dt-binding: clock: Document rockchip, rk3568-cru bindings
      clk: rockchip: add dt-binding header for rk3568

commit eb87e4e90bca55ab581dcb0bf1be278cd1c27c96
Author: Chaitanya Kulkarni <chaitanya.kulkarni@wdc.com>
Date:   Sun Apr 11 15:43:30 2021 -0700

    gdrom: fix compilation error
    
    Use the right name for the struct request variable that removes the
    following compilation error :-
    
    make --silent --keep-going --jobs=8
    O=/home/tuxbuild/.cache/tuxmake/builds/1/tmp ARCH=sh
    CROSS_COMPILE=sh4-linux-gnu- 'CC=sccache sh4-linux-gnu-gcc'
    'HOSTCC=sccache gcc'
    
    In file included from /builds/linux/include/linux/scatterlist.h:9,
                     from /builds/linux/include/linux/dma-mapping.h:10,
                     from /builds/linux/drivers/cdrom/gdrom.c:16:
    /builds/linux/drivers/cdrom/gdrom.c: In function 'gdrom_readdisk_dma':
    /builds/linux/drivers/cdrom/gdrom.c:586:61: error: 'rq' undeclared
    (first use in this function)
      586 |  __raw_writel(page_to_phys(bio_page(req->bio)) + bio_offset(rq->bio),
          |                                                             ^~
    
    Fixes: 1d2c82001a5f ("gdrom: support highmem")
    Reported-by: Naresh Kamboju <naresh.kamboju@linaro.org>
    Tested-by: Naresh Kamboju <naresh.kamboju@linaro.org>
    Signed-off-by: Chaitanya Kulkarni <chaitanya.kulkarni@wdc.com>
    Signed-off-by: Jens Axboe <axboe@kernel.dk>

commit d0dfb9d3f250ddc9804448de02ceb02d4d34d3f7
Author: Masahiro Yamada <masahiroy@kernel.org>
Date:   Fri Mar 12 21:07:08 2021 -0800

    init/Kconfig: make COMPILE_TEST depend on HAS_IOMEM
    
    commit ea29b20a828511de3348334e529a3d046a180416 upstream.
    
    I read the commit log of the following two:
    
    - bc083a64b6c0 ("init/Kconfig: make COMPILE_TEST depend on !UML")
    - 334ef6ed06fa ("init/Kconfig: make COMPILE_TEST depend on !S390")
    
    Both are talking about HAS_IOMEM dependency missing in many drivers.
    
    So, 'depends on HAS_IOMEM' seems the direct, sensible solution to me.
    
    This does not change the behavior of UML. UML still cannot enable
    COMPILE_TEST because it does not provide HAS_IOMEM.
    
    The current dependency for S390 is too strong. Under the condition of
    CONFIG_PCI=y, S390 provides HAS_IOMEM, hence can enable COMPILE_TEST.
    
    I also removed the meaningless 'default n'.
    
    Link: https://lkml.kernel.org/r/20210224140809.1067582-1-masahiroy@kernel.org
    Signed-off-by: Masahiro Yamada <masahiroy@kernel.org>
    Cc: Heiko Carstens <hca@linux.ibm.com>
    Cc: Guenter Roeck <linux@roeck-us.net>
    Cc: Arnd Bergmann <arnd@kernel.org>
    Cc: Kees Cook <keescook@chromium.org>
    Cc: Daniel Borkmann <daniel@iogearbox.net>
    Cc: Johannes Weiner <hannes@cmpxchg.org>
    Cc: KP Singh <kpsingh@google.com>
    Cc: Nathan Chancellor <nathan@kernel.org>
    Cc: Nick Terrell <terrelln@fb.com>
    Cc: Quentin Perret <qperret@google.com>
    Cc: Valentin Schneider <valentin.schneider@arm.com>
    Cc: "Enrico Weigelt, metux IT consult" <lkml@metux.net>
    Signed-off-by: Andrew Morton <akpm@linux-foundation.org>
    Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>
    Cc: Guenter Roeck <linux@roeck-us.net>
    Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>

commit cef13a04376b44b71196f74b29941678c18bc7ec
Author: Masahiro Yamada <masahiroy@kernel.org>
Date:   Fri Mar 12 21:07:08 2021 -0800

    init/Kconfig: make COMPILE_TEST depend on HAS_IOMEM
    
    commit ea29b20a828511de3348334e529a3d046a180416 upstream.
    
    I read the commit log of the following two:
    
    - bc083a64b6c0 ("init/Kconfig: make COMPILE_TEST depend on !UML")
    - 334ef6ed06fa ("init/Kconfig: make COMPILE_TEST depend on !S390")
    
    Both are talking about HAS_IOMEM dependency missing in many drivers.
    
    So, 'depends on HAS_IOMEM' seems the direct, sensible solution to me.
    
    This does not change the behavior of UML. UML still cannot enable
    COMPILE_TEST because it does not provide HAS_IOMEM.
    
    The current dependency for S390 is too strong. Under the condition of
    CONFIG_PCI=y, S390 provides HAS_IOMEM, hence can enable COMPILE_TEST.
    
    I also removed the meaningless 'default n'.
    
    Link: https://lkml.kernel.org/r/20210224140809.1067582-1-masahiroy@kernel.org
    Signed-off-by: Masahiro Yamada <masahiroy@kernel.org>
    Cc: Heiko Carstens <hca@linux.ibm.com>
    Cc: Guenter Roeck <linux@roeck-us.net>
    Cc: Arnd Bergmann <arnd@kernel.org>
    Cc: Kees Cook <keescook@chromium.org>
    Cc: Daniel Borkmann <daniel@iogearbox.net>
    Cc: Johannes Weiner <hannes@cmpxchg.org>
    Cc: KP Singh <kpsingh@google.com>
    Cc: Nathan Chancellor <nathan@kernel.org>
    Cc: Nick Terrell <terrelln@fb.com>
    Cc: Quentin Perret <qperret@google.com>
    Cc: Valentin Schneider <valentin.schneider@arm.com>
    Cc: "Enrico Weigelt, metux IT consult" <lkml@metux.net>
    Signed-off-by: Andrew Morton <akpm@linux-foundation.org>
    Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>
    Cc: Guenter Roeck <linux@roeck-us.net>
    Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>

commit ba02635769f18a9231aba6e032d65f1fa6c537b4
Author: Heiko Carstens <hca@linux.ibm.com>
Date:   Wed Nov 18 21:32:33 2020 +0100

    init/Kconfig: make COMPILE_TEST depend on !S390
    
    commit 334ef6ed06fa1a54e35296b77b693bcf6d63ee9e upstream.
    
    While allmodconfig and allyesconfig build for s390 there are also
    various bots running compile tests with randconfig, where PCI is
    disabled. This reveals that a lot of drivers should actually depend on
    HAS_IOMEM.
    Adding this to each device driver would be a never ending story,
    therefore just disable COMPILE_TEST for s390.
    
    The reasoning is more or less the same as described in
    commit bc083a64b6c0 ("init/Kconfig: make COMPILE_TEST depend on !UML").
    
    Reported-by: kernel test robot <lkp@intel.com>
    Suggested-by: Arnd Bergmann <arnd@kernel.org>
    Signed-off-by: Heiko Carstens <hca@linux.ibm.com>
    Cc: Guenter Roeck <linux@roeck-us.net>
    Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>

commit 45f540622d5b5cfc68a2a577e48b061c865bd313
Author: Masahiro Yamada <masahiroy@kernel.org>
Date:   Fri Mar 12 21:07:08 2021 -0800

    init/Kconfig: make COMPILE_TEST depend on HAS_IOMEM
    
    commit ea29b20a828511de3348334e529a3d046a180416 upstream.
    
    I read the commit log of the following two:
    
    - bc083a64b6c0 ("init/Kconfig: make COMPILE_TEST depend on !UML")
    - 334ef6ed06fa ("init/Kconfig: make COMPILE_TEST depend on !S390")
    
    Both are talking about HAS_IOMEM dependency missing in many drivers.
    
    So, 'depends on HAS_IOMEM' seems the direct, sensible solution to me.
    
    This does not change the behavior of UML. UML still cannot enable
    COMPILE_TEST because it does not provide HAS_IOMEM.
    
    The current dependency for S390 is too strong. Under the condition of
    CONFIG_PCI=y, S390 provides HAS_IOMEM, hence can enable COMPILE_TEST.
    
    I also removed the meaningless 'default n'.
    
    Link: https://lkml.kernel.org/r/20210224140809.1067582-1-masahiroy@kernel.org
    Signed-off-by: Masahiro Yamada <masahiroy@kernel.org>
    Cc: Heiko Carstens <hca@linux.ibm.com>
    Cc: Guenter Roeck <linux@roeck-us.net>
    Cc: Arnd Bergmann <arnd@kernel.org>
    Cc: Kees Cook <keescook@chromium.org>
    Cc: Daniel Borkmann <daniel@iogearbox.net>
    Cc: Johannes Weiner <hannes@cmpxchg.org>
    Cc: KP Singh <kpsingh@google.com>
    Cc: Nathan Chancellor <nathan@kernel.org>
    Cc: Nick Terrell <terrelln@fb.com>
    Cc: Quentin Perret <qperret@google.com>
    Cc: Valentin Schneider <valentin.schneider@arm.com>
    Cc: "Enrico Weigelt, metux IT consult" <lkml@metux.net>
    Signed-off-by: Andrew Morton <akpm@linux-foundation.org>
    Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>
    Cc: Guenter Roeck <linux@roeck-us.net>
    Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>

commit 43dd03f088191e6c85529e649ebb5c54994486ee
Author: Heiko Carstens <hca@linux.ibm.com>
Date:   Wed Nov 18 21:32:33 2020 +0100

    init/Kconfig: make COMPILE_TEST depend on !S390
    
    commit 334ef6ed06fa1a54e35296b77b693bcf6d63ee9e upstream.
    
    While allmodconfig and allyesconfig build for s390 there are also
    various bots running compile tests with randconfig, where PCI is
    disabled. This reveals that a lot of drivers should actually depend on
    HAS_IOMEM.
    Adding this to each device driver would be a never ending story,
    therefore just disable COMPILE_TEST for s390.
    
    The reasoning is more or less the same as described in
    commit bc083a64b6c0 ("init/Kconfig: make COMPILE_TEST depend on !UML").
    
    Reported-by: kernel test robot <lkp@intel.com>
    Suggested-by: Arnd Bergmann <arnd@kernel.org>
    Signed-off-by: Heiko Carstens <hca@linux.ibm.com>
    Cc: Guenter Roeck <linux@roeck-us.net>
    Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>

commit afee927e8276d19ac913cee1fb03e6f26e75802c
Author: Masahiro Yamada <masahiroy@kernel.org>
Date:   Fri Mar 12 21:07:08 2021 -0800

    init/Kconfig: make COMPILE_TEST depend on HAS_IOMEM
    
    commit ea29b20a828511de3348334e529a3d046a180416 upstream.
    
    I read the commit log of the following two:
    
    - bc083a64b6c0 ("init/Kconfig: make COMPILE_TEST depend on !UML")
    - 334ef6ed06fa ("init/Kconfig: make COMPILE_TEST depend on !S390")
    
    Both are talking about HAS_IOMEM dependency missing in many drivers.
    
    So, 'depends on HAS_IOMEM' seems the direct, sensible solution to me.
    
    This does not change the behavior of UML. UML still cannot enable
    COMPILE_TEST because it does not provide HAS_IOMEM.
    
    The current dependency for S390 is too strong. Under the condition of
    CONFIG_PCI=y, S390 provides HAS_IOMEM, hence can enable COMPILE_TEST.
    
    I also removed the meaningless 'default n'.
    
    Link: https://lkml.kernel.org/r/20210224140809.1067582-1-masahiroy@kernel.org
    Signed-off-by: Masahiro Yamada <masahiroy@kernel.org>
    Cc: Heiko Carstens <hca@linux.ibm.com>
    Cc: Guenter Roeck <linux@roeck-us.net>
    Cc: Arnd Bergmann <arnd@kernel.org>
    Cc: Kees Cook <keescook@chromium.org>
    Cc: Daniel Borkmann <daniel@iogearbox.net>
    Cc: Johannes Weiner <hannes@cmpxchg.org>
    Cc: KP Singh <kpsingh@google.com>
    Cc: Nathan Chancellor <nathan@kernel.org>
    Cc: Nick Terrell <terrelln@fb.com>
    Cc: Quentin Perret <qperret@google.com>
    Cc: Valentin Schneider <valentin.schneider@arm.com>
    Cc: "Enrico Weigelt, metux IT consult" <lkml@metux.net>
    Signed-off-by: Andrew Morton <akpm@linux-foundation.org>
    Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>
    Cc: Guenter Roeck <linux@roeck-us.net>
    Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>

commit b97ed64cf80b072cb765c3b9389a7f19df2dd595
Author: Heiko Carstens <hca@linux.ibm.com>
Date:   Wed Nov 18 21:32:33 2020 +0100

    init/Kconfig: make COMPILE_TEST depend on !S390
    
    commit 334ef6ed06fa1a54e35296b77b693bcf6d63ee9e upstream.
    
    While allmodconfig and allyesconfig build for s390 there are also
    various bots running compile tests with randconfig, where PCI is
    disabled. This reveals that a lot of drivers should actually depend on
    HAS_IOMEM.
    Adding this to each device driver would be a never ending story,
    therefore just disable COMPILE_TEST for s390.
    
    The reasoning is more or less the same as described in
    commit bc083a64b6c0 ("init/Kconfig: make COMPILE_TEST depend on !UML").
    
    Reported-by: kernel test robot <lkp@intel.com>
    Suggested-by: Arnd Bergmann <arnd@kernel.org>
    Signed-off-by: Heiko Carstens <hca@linux.ibm.com>
    Cc: Guenter Roeck <linux@roeck-us.net>
    Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>

commit 4086850f794d3790fc1b29dde88e82d52cedbc2e
Author: Masahiro Yamada <masahiroy@kernel.org>
Date:   Fri Mar 12 21:07:08 2021 -0800

    init/Kconfig: make COMPILE_TEST depend on HAS_IOMEM
    
    commit ea29b20a828511de3348334e529a3d046a180416 upstream.
    
    I read the commit log of the following two:
    
    - bc083a64b6c0 ("init/Kconfig: make COMPILE_TEST depend on !UML")
    - 334ef6ed06fa ("init/Kconfig: make COMPILE_TEST depend on !S390")
    
    Both are talking about HAS_IOMEM dependency missing in many drivers.
    
    So, 'depends on HAS_IOMEM' seems the direct, sensible solution to me.
    
    This does not change the behavior of UML. UML still cannot enable
    COMPILE_TEST because it does not provide HAS_IOMEM.
    
    The current dependency for S390 is too strong. Under the condition of
    CONFIG_PCI=y, S390 provides HAS_IOMEM, hence can enable COMPILE_TEST.
    
    I also removed the meaningless 'default n'.
    
    Link: https://lkml.kernel.org/r/20210224140809.1067582-1-masahiroy@kernel.org
    Signed-off-by: Masahiro Yamada <masahiroy@kernel.org>
    Cc: Heiko Carstens <hca@linux.ibm.com>
    Cc: Guenter Roeck <linux@roeck-us.net>
    Cc: Arnd Bergmann <arnd@kernel.org>
    Cc: Kees Cook <keescook@chromium.org>
    Cc: Daniel Borkmann <daniel@iogearbox.net>
    Cc: Johannes Weiner <hannes@cmpxchg.org>
    Cc: KP Singh <kpsingh@google.com>
    Cc: Nathan Chancellor <nathan@kernel.org>
    Cc: Nick Terrell <terrelln@fb.com>
    Cc: Quentin Perret <qperret@google.com>
    Cc: Valentin Schneider <valentin.schneider@arm.com>
    Cc: "Enrico Weigelt, metux IT consult" <lkml@metux.net>
    Signed-off-by: Andrew Morton <akpm@linux-foundation.org>
    Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>
    Cc: Guenter Roeck <linux@roeck-us.net>
    Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>

commit fa4261496d3265009449723859f50f68a27881c1
Author: Heiko Carstens <hca@linux.ibm.com>
Date:   Wed Nov 18 21:32:33 2020 +0100

    init/Kconfig: make COMPILE_TEST depend on !S390
    
    commit 334ef6ed06fa1a54e35296b77b693bcf6d63ee9e upstream.
    
    While allmodconfig and allyesconfig build for s390 there are also
    various bots running compile tests with randconfig, where PCI is
    disabled. This reveals that a lot of drivers should actually depend on
    HAS_IOMEM.
    Adding this to each device driver would be a never ending story,
    therefore just disable COMPILE_TEST for s390.
    
    The reasoning is more or less the same as described in
    commit bc083a64b6c0 ("init/Kconfig: make COMPILE_TEST depend on !UML").
    
    Reported-by: kernel test robot <lkp@intel.com>
    Suggested-by: Arnd Bergmann <arnd@kernel.org>
    Signed-off-by: Heiko Carstens <hca@linux.ibm.com>
    Cc: Guenter Roeck <linux@roeck-us.net>
    Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>

commit eb9e7f08c08d7fea83ccb3adfbe263563b354147
Author: Masahiro Yamada <masahiroy@kernel.org>
Date:   Fri Mar 12 21:07:08 2021 -0800

    init/Kconfig: make COMPILE_TEST depend on HAS_IOMEM
    
    commit ea29b20a828511de3348334e529a3d046a180416 upstream.
    
    I read the commit log of the following two:
    
    - bc083a64b6c0 ("init/Kconfig: make COMPILE_TEST depend on !UML")
    - 334ef6ed06fa ("init/Kconfig: make COMPILE_TEST depend on !S390")
    
    Both are talking about HAS_IOMEM dependency missing in many drivers.
    
    So, 'depends on HAS_IOMEM' seems the direct, sensible solution to me.
    
    This does not change the behavior of UML. UML still cannot enable
    COMPILE_TEST because it does not provide HAS_IOMEM.
    
    The current dependency for S390 is too strong. Under the condition of
    CONFIG_PCI=y, S390 provides HAS_IOMEM, hence can enable COMPILE_TEST.
    
    I also removed the meaningless 'default n'.
    
    Link: https://lkml.kernel.org/r/20210224140809.1067582-1-masahiroy@kernel.org
    Signed-off-by: Masahiro Yamada <masahiroy@kernel.org>
    Cc: Heiko Carstens <hca@linux.ibm.com>
    Cc: Guenter Roeck <linux@roeck-us.net>
    Cc: Arnd Bergmann <arnd@kernel.org>
    Cc: Kees Cook <keescook@chromium.org>
    Cc: Daniel Borkmann <daniel@iogearbox.net>
    Cc: Johannes Weiner <hannes@cmpxchg.org>
    Cc: KP Singh <kpsingh@google.com>
    Cc: Nathan Chancellor <nathan@kernel.org>
    Cc: Nick Terrell <terrelln@fb.com>
    Cc: Quentin Perret <qperret@google.com>
    Cc: Valentin Schneider <valentin.schneider@arm.com>
    Cc: "Enrico Weigelt, metux IT consult" <lkml@metux.net>
    Signed-off-by: Andrew Morton <akpm@linux-foundation.org>
    Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>
    Cc: Guenter Roeck <linux@roeck-us.net>
    Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>

commit aeeb58019ef157459f561b5e122064a058e862f2
Author: Heiko Carstens <hca@linux.ibm.com>
Date:   Wed Nov 18 21:32:33 2020 +0100

    init/Kconfig: make COMPILE_TEST depend on !S390
    
    commit 334ef6ed06fa1a54e35296b77b693bcf6d63ee9e upstream.
    
    While allmodconfig and allyesconfig build for s390 there are also
    various bots running compile tests with randconfig, where PCI is
    disabled. This reveals that a lot of drivers should actually depend on
    HAS_IOMEM.
    Adding this to each device driver would be a never ending story,
    therefore just disable COMPILE_TEST for s390.
    
    The reasoning is more or less the same as described in
    commit bc083a64b6c0 ("init/Kconfig: make COMPILE_TEST depend on !UML").
    
    Reported-by: kernel test robot <lkp@intel.com>
    Suggested-by: Arnd Bergmann <arnd@kernel.org>
    Signed-off-by: Heiko Carstens <hca@linux.ibm.com>
    Cc: Guenter Roeck <linux@roeck-us.net>
    Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>

commit 485ff03ae96816b2f98ab3bc824fbf112528d071
Author: Masahiro Yamada <masahiroy@kernel.org>
Date:   Fri Mar 12 21:07:08 2021 -0800

    init/Kconfig: make COMPILE_TEST depend on HAS_IOMEM
    
    commit ea29b20a828511de3348334e529a3d046a180416 upstream.
    
    I read the commit log of the following two:
    
    - bc083a64b6c0 ("init/Kconfig: make COMPILE_TEST depend on !UML")
    - 334ef6ed06fa ("init/Kconfig: make COMPILE_TEST depend on !S390")
    
    Both are talking about HAS_IOMEM dependency missing in many drivers.
    
    So, 'depends on HAS_IOMEM' seems the direct, sensible solution to me.
    
    This does not change the behavior of UML. UML still cannot enable
    COMPILE_TEST because it does not provide HAS_IOMEM.
    
    The current dependency for S390 is too strong. Under the condition of
    CONFIG_PCI=y, S390 provides HAS_IOMEM, hence can enable COMPILE_TEST.
    
    I also removed the meaningless 'default n'.
    
    Link: https://lkml.kernel.org/r/20210224140809.1067582-1-masahiroy@kernel.org
    Signed-off-by: Masahiro Yamada <masahiroy@kernel.org>
    Cc: Heiko Carstens <hca@linux.ibm.com>
    Cc: Guenter Roeck <linux@roeck-us.net>
    Cc: Arnd Bergmann <arnd@kernel.org>
    Cc: Kees Cook <keescook@chromium.org>
    Cc: Daniel Borkmann <daniel@iogearbox.net>
    Cc: Johannes Weiner <hannes@cmpxchg.org>
    Cc: KP Singh <kpsingh@google.com>
    Cc: Nathan Chancellor <nathan@kernel.org>
    Cc: Nick Terrell <terrelln@fb.com>
    Cc: Quentin Perret <qperret@google.com>
    Cc: Valentin Schneider <valentin.schneider@arm.com>
    Cc: "Enrico Weigelt, metux IT consult" <lkml@metux.net>
    Signed-off-by: Andrew Morton <akpm@linux-foundation.org>
    Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>
    Cc: Guenter Roeck <linux@roeck-us.net>
    Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>

commit 7341a937fa885da89b3c1cfc6a53a0f5a1c05ea5
Author: Heiko Carstens <hca@linux.ibm.com>
Date:   Wed Nov 18 21:32:33 2020 +0100

    init/Kconfig: make COMPILE_TEST depend on !S390
    
    commit 334ef6ed06fa1a54e35296b77b693bcf6d63ee9e upstream.
    
    While allmodconfig and allyesconfig build for s390 there are also
    various bots running compile tests with randconfig, where PCI is
    disabled. This reveals that a lot of drivers should actually depend on
    HAS_IOMEM.
    Adding this to each device driver would be a never ending story,
    therefore just disable COMPILE_TEST for s390.
    
    The reasoning is more or less the same as described in
    commit bc083a64b6c0 ("init/Kconfig: make COMPILE_TEST depend on !UML").
    
    Reported-by: kernel test robot <lkp@intel.com>
    Suggested-by: Arnd Bergmann <arnd@kernel.org>
    Signed-off-by: Heiko Carstens <hca@linux.ibm.com>
    Cc: Guenter Roeck <linux@roeck-us.net>
    Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>

commit b017d5b1abf5a7ab20e18a9e9663f691f2e2fce9
Author: Richard Weinberger <richard@nod.at>
Date:   Tue Aug 2 14:03:27 2016 -0700

    init/Kconfig: make COMPILE_TEST depend on !UML
    
    commit bc083a64b6c035135c0f80718f9e9192cc0867c6 upstream.
    
    UML is a bit special since it does not have iomem nor dma.  That means a
    lot of drivers will not build if they miss a dependency on HAS_IOMEM.
    s390 used to have the same issues but since it gained PCI support UML is
    the only stranger.
    
    We are tired of patching dozens of new drivers after every merge window
    just to un-break allmod/yesconfig UML builds.  One could argue that a
    decent driver has to know on what it depends and therefore a missing
    HAS_IOMEM dependency is a clear driver bug.  But the dependency not
    obvious and not everyone does UML builds with COMPILE_TEST enabled when
    developing a device driver.
    
    A possible solution to make these builds succeed on UML would be
    providing stub functions for ioremap() and friends which fail upon
    runtime.  Another one is simply disabling COMPILE_TEST for UML.  Since
    it is the least hassle and does not force use to fake iomem support
    let's do the latter.
    
    Link: http://lkml.kernel.org/r/1466152995-28367-1-git-send-email-richard@nod.at
    Signed-off-by: Richard Weinberger <richard@nod.at>
    Acked-by: Arnd Bergmann <arnd@arndb.de>
    Cc: Al Viro <viro@zeniv.linux.org.uk>
    Signed-off-by: Andrew Morton <akpm@linux-foundation.org>
    Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>
    Cc: Guenter Roeck <linux@roeck-us.net>
    Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>

commit 94bc94209a66f05532c065279f4a719058d447e4
Author: Marc Zyngier <maz@kernel.org>
Date:   Thu Apr 8 08:56:27 2021 +0100

    irqchip/wpcm450: Drop COMPILE_TEST
    
    This driver is (for now) ARM specific, and currently doesn't
    build with a variety of architectures (ia64, RISC-V, x86_64
    at the very least).
    
    Drop COMPILE_TEST from Kconfig until it gets sorted out.
    
    Reviewed-by: Jonathan Neuschfer <j.neuschaefer@gmx.net>
    Reported-by: Stephen Rothwell <sfr@canb.auug.org.au>
    Signed-off-by: Marc Zyngier <maz@kernel.org>

commit 4cd15d84ca3e9be4db121b067c9739268c5e9b91
Author: Geert Uytterhoeven <geert+renesas@glider.be>
Date:   Tue Apr 6 11:32:26 2021 +0200

    media: VIDEO_IMX8_JPEG should depend on ARCH_MXC and not default to m
    
    The i.MX8 QXP/QM integrated JPEG encoder/decoder is only present on
    Freescale/NXP i.MX8 QXP and QM SoCs.  Hence add a dependency on
    ARCH_MXC, to prevent asking the user about this driver when configuring
    a kernel without i.MX8 support.
    
    Drop the "default m" (which means "default y" if CONFIG_MODULES is not
    enabled), as merely enabling CONFIG_COMPILE_TEST should not enable
    additional code.
    
    Fixes: 2db16c6ed72ce644 ("media: imx-jpeg: Add V4L2 driver for i.MX8 JPEG Encoder/Decoder")
    Signed-off-by: Geert Uytterhoeven <geert+renesas@glider.be>
    Signed-off-by: Hans Verkuil <hverkuil-cisco@xs4all.nl>
    Signed-off-by: Mauro Carvalho Chehab <mchehab+huawei@kernel.org>

commit 65df7d1986a1909a0869419919e7d9c78d70407e
Author: Viswas G <Viswas.G@microchip.com>
Date:   Fri Apr 2 11:12:12 2021 +0530

    scsi: pm80xx: Fix chip initialization failure
    
    Inbound and outbound queues were not properly configured and that lead to
    MPI configuration failure.
    
    Fixes: 05c6c029a44d ("scsi: pm80xx: Increase number of supported queues")
    Cc: stable@vger.kernel.org # 5.10+
    Link: https://lore.kernel.org/r/20210402054212.17834-1-Viswas.G@microchip.com.com
    Reported-and-tested-by: Ash Izat <ash@ai0.uk>
    Signed-off-by: Viswas G <Viswas.G@microchip.com>
    Signed-off-by: Martin K. Petersen <martin.petersen@oracle.com>

commit 6cb17707aad869de163d7bf42c253caf501be4e2
Author: Geert Uytterhoeven <geert+renesas@glider.be>
Date:   Mon Feb 8 16:02:52 2021 +0100

    phy: marvell: ARMADA375_USBCLUSTER_PHY should not default to y, unconditionally
    
    Merely enabling CONFIG_COMPILE_TEST should not enable additional code.
    To fix this, restrict the automatic enabling of ARMADA375_USBCLUSTER_PHY
    to MACH_ARMADA_375, and ask the user in case of compile-testing.
    
    Fixes: eee47538ec1f2619 ("phy: add support for USB cluster on the Armada 375 SoC")
    Signed-off-by: Geert Uytterhoeven <geert+renesas@glider.be>
    Link: https://lore.kernel.org/r/20210208150252.424706-1-geert+renesas@glider.be
    Signed-off-by: Vinod Koul <vkoul@kernel.org>

commit e87f69a5187d9414c3c2dae9539649e3823ee32c
Author: Julian Braha <julianbraha@gmail.com>
Date:   Fri Mar 26 01:20:33 2021 -0400

    arch: mips: fix unmet dependency for DEBUG_INFO
    
    When SB1XXX_CORELIS is enabled, COMPILE_TEST is disabled,
    and DEBUG_KERNEL is disabled, Kbuild gives the
    following warning:
    
    WARNING: unmet direct dependencies detected for DEBUG_INFO
      Depends on [n]: DEBUG_KERNEL [=n] && !COMPILE_TEST [=n]
      Selected by [y]:
      - SB1XXX_CORELIS [=y] && SIBYTE_SB1xxx_SOC [=y] && !COMPILE_TEST [=n]
    
    This is because SB1XXX_CORELIS selects DEBUG_INFO without
    selecting or depending on DEBUG_KERNEL, despite DEBUG_INFO
    depending on DEBUG_KERNEL.
    
    Signed-off-by: Julian Braha <julianbraha@gmail.com>
    Signed-off-by: Thomas Bogendoerfer <tsbogend@alpha.franken.de>

commit 1b60280834683dddf4975bbf9662a74f123ba770
Author: Xu Yihang <xuyihang@huawei.com>
Date:   Tue Mar 23 10:50:13 2021 +0800

    x86/hyperv: Fix unused variable 'hi' warning in hv_apic_read
    
    Fixes the following W=1 kernel build warning(s):
    arch/x86/hyperv/hv_apic.c:58:15: warning: variable hi set but not used [-Wunused-but-set-variable]
    
    Compiled with CONFIG_HYPERV enabled:
    make allmodconfig ARCH=x86_64 CROSS_COMPILE=x86_64-linux-gnu-
    make W=1 arch/x86/hyperv/hv_apic.o ARCH=x86_64 CROSS_COMPILE=x86_64-linux-gnu-
    
    HV_X64_MSR_EOI occupies bit 31:0 and HV_X64_MSR_TPR occupies bit 7:0,
    which means the higher 32 bits are not really used. Cast the variable hi
    to void to silence this warning.
    
    Reported-by: Hulk Robot <hulkci@huawei.com>
    Signed-off-by: Xu Yihang <xuyihang@huawei.com>
    Link: https://lore.kernel.org/r/20210323025013.191533-1-xuyihang@huawei.com
    Signed-off-by: Wei Liu <wei.liu@kernel.org>

commit e8c51b90f22031bf3f24d1f06d23bafac250bb62
Author: Heiko Stuebner <heiko@sntech.de>
Date:   Mon Mar 15 12:25:01 2021 +0100

    clk: rockchip: drop parenthesis from ARM || COMPILE_TEST depends
    
    As suggested by Stephen in the series adding the rk3568 clock controller
    the depends works just as well without the parenthesis around the depends.
    
    So to make everything look the same, drop them from existing entries too.
    
    Suggested-by: Stephen Boyd <sboyd@kernel.org>
    Signed-off-by: Heiko Stuebner <heiko@sntech.de>
    Reviewed-by: Stephen Boyd <sboyd@kernel.org>
    Link: https://lore.kernel.org/r/20210315112502.343699-1-heiko@sntech.de

commit c569de899bb41b7e8302636a76bf73bbdb80075a
Author: Suganath Prabu S <suganath-prabu.subramani@broadcom.com>
Date:   Fri Mar 5 15:59:03 2021 +0530

    scsi: mpt3sas: Force reply post array allocations to be within same 4 GB region
    
    According to the MPI specification, reply post array buffers can not cross
    a 4 GB boundary.
    
    While allocating, if any buffer crosses the 4 GB boundary, then:
    
     - Release the already allocated memory pools; and
    
     - Reallocate them by changing the DMA coherent mask to 32-bit
    
    Link: https://lore.kernel.org/r/20210305102904.7560-7-suganath-prabu.subramani@broadcom.com
    Signed-off-by: Suganath Prabu S <suganath-prabu.subramani@broadcom.com>
    Signed-off-by: Martin K. Petersen <martin.petersen@oracle.com>

commit 2e4e8587327b37431e3205d09f541420d9d19266
Author: Suganath Prabu S <suganath-prabu.subramani@broadcom.com>
Date:   Fri Mar 5 15:59:02 2021 +0530

    scsi: mpt3sas: Force reply post buffer allocations to be within same 4 GB region
    
    According to the MPI specification, reply post buffers can not cross a 4 GB
    boundary.
    
    While allocating, if any buffer crosses the 4 GB boundary, then:
    
     - Release the already allocated memory pools; and
    
     - Reallocate them by changing the DMA coherent mask to 32-bit
    
    Link: https://lore.kernel.org/r/20210305102904.7560-6-suganath-prabu.subramani@broadcom.com
    Signed-off-by: Suganath Prabu S <suganath-prabu.subramani@broadcom.com>
    Signed-off-by: Martin K. Petersen <martin.petersen@oracle.com>

commit 58501fd9375f76369c602a0b751a95d3376878e2
Author: Suganath Prabu S <suganath-prabu.subramani@broadcom.com>
Date:   Fri Mar 5 15:59:01 2021 +0530

    scsi: mpt3sas: Force reply buffer allocations to be within same 4 GB region
    
    According to the MPI specification, reply buffers can not cross a 4 GB
    boundary.
    
    While allocating, if any buffer crosses the 4 GB boundary, then:
    
     - Release the already allocated memory pools; and
    
     - Reallocate them by changing the DMA coherent mask to 32-bit
    
    Link: https://lore.kernel.org/r/20210305102904.7560-5-suganath-prabu.subramani@broadcom.com
    Signed-off-by: Suganath Prabu S <suganath-prabu.subramani@broadcom.com>
    Signed-off-by: Martin K. Petersen <martin.petersen@oracle.com>

commit 970ac2bb70e79a90eeb75496a523b8f1705d7a8c
Author: Suganath Prabu S <suganath-prabu.subramani@broadcom.com>
Date:   Fri Mar 5 15:59:00 2021 +0530

    scsi: mpt3sas: Force sense buffer allocations to be within same 4 GB region
    
    According to the MPI specification, sense buffers can not cross a 4 GB
    boundary.
    
    While allocating, if any buffer crosses the 4 GB boundary, then:
    
     - Release the already allocated memory pools; and
    
     - Reallocate them by changing the DMA coherent mask to 32-bit
    
    Link: https://lore.kernel.org/r/20210305102904.7560-4-suganath-prabu.subramani@broadcom.com
    Signed-off-by: Suganath Prabu S <suganath-prabu.subramani@broadcom.com>
    Signed-off-by: Martin K. Petersen <martin.petersen@oracle.com>

commit 7dd847dae1c48f4a58f3ba672ed9141a2a774805
Author: Suganath Prabu S <suganath-prabu.subramani@broadcom.com>
Date:   Fri Mar 5 15:58:59 2021 +0530

    scsi: mpt3sas: Force chain buffer allocations to be within same 4 GB region
    
    According to the MPI specification, chain buffers can not cross a 4 GB
    boundary.
    
    While allocating, if any buffer crosses the 4 GB boundary, then:
    
     - Release the already allocated memory pools; and
    
     - Reallocate them by changing the DMA coherent mask to 32-bit
    
    Link: https://lore.kernel.org/r/20210305102904.7560-3-suganath-prabu.subramani@broadcom.com
    Signed-off-by: Suganath Prabu S <suganath-prabu.subramani@broadcom.com>
    Signed-off-by: Martin K. Petersen <martin.petersen@oracle.com>

commit dc0337999d87a5e749ef1ac0bcc1a06d2a3f9ec0
Merge: c73891c922f5 4ab4fcfce5b5
Author: Linus Torvalds <torvalds@linux-foundation.org>
Date:   Thu Mar 18 12:37:05 2021 -0700

    Merge tag 'vfio-v5.12-rc4' of git://github.com/awilliam/linux-vfio
    
    Pull VFIO fixes from Alex Williamson:
    
     - Fix 32-bit issue with new unmap-all flag (Steve Sistare)
    
     - Various Kconfig changes for better coverage (Jason Gunthorpe)
    
     - Fix to batch pinning support (Daniel Jordan)
    
    * tag 'vfio-v5.12-rc4' of git://github.com/awilliam/linux-vfio:
      vfio/type1: fix vaddr_get_pfns() return in vfio_pin_page_external()
      vfio: Depend on MMU
      ARM: amba: Allow some ARM_AMBA users to compile with COMPILE_TEST
      vfio-platform: Add COMPILE_TEST to VFIO_PLATFORM
      vfio: IOMMU_API should be selected
      vfio/type1: fix unmap all on ILP32

commit d6adc251dd2fede6aaaf6c39f7e4ad799eda3758
Author: Suganath Prabu S <suganath-prabu.subramani@broadcom.com>
Date:   Fri Mar 5 15:58:58 2021 +0530

    scsi: mpt3sas: Force PCIe scatterlist allocations to be within same 4 GB region
    
    According to the MPI specification, PCIe SGL buffers can not cross a 4 GB
    boundary.
    
    While allocating, if any buffer crosses the 4 GB boundary, then:
    
     - Release the already allocated memory pools; and
    
     - Reallocate them by changing the DMA coherent mask to 32-bit
    
    Link: https://lore.kernel.org/r/20210305102904.7560-2-suganath-prabu.subramani@broadcom.com
    Signed-off-by: Suganath Prabu S <suganath-prabu.subramani@broadcom.com>
    Signed-off-by: Martin K. Petersen <martin.petersen@oracle.com>

commit 3b49dfb08c750d4745ad42ec042288aba932b9d5
Author: Jason Gunthorpe <jgg@nvidia.com>
Date:   Tue Feb 23 15:17:48 2021 -0400

    ARM: amba: Allow some ARM_AMBA users to compile with COMPILE_TEST
    
    CONFIG_VFIO_AMBA has a light use of AMBA, adding some inline fallbacks
    when AMBA is disabled will allow it to be compiled under COMPILE_TEST and
    make VFIO easier to maintain.
    
    Signed-off-by: Jason Gunthorpe <jgg@nvidia.com>
    Message-Id: <3-v1-df057e0f92c3+91-vfio_arm_compile_test_jgg@nvidia.com>
    Reviewed-by: Eric Auger <eric.auger@redhat.com>
    Signed-off-by: Alex Williamson <alex.williamson@redhat.com>

commit d3d72a6dfffd3fcaac969786118162b596227f70
Author: Jason Gunthorpe <jgg@nvidia.com>
Date:   Tue Feb 23 15:17:47 2021 -0400

    vfio-platform: Add COMPILE_TEST to VFIO_PLATFORM
    
    x86 can build platform bus code too, so vfio-platform and all the platform
    reset implementations compile successfully on x86.
    
    Signed-off-by: Jason Gunthorpe <jgg@nvidia.com>
    Message-Id: <2-v1-df057e0f92c3+91-vfio_arm_compile_test_jgg@nvidia.com>
    Signed-off-by: Alex Williamson <alex.williamson@redhat.com>

commit ea29b20a828511de3348334e529a3d046a180416
Author: Masahiro Yamada <masahiroy@kernel.org>
Date:   Fri Mar 12 21:07:08 2021 -0800

    init/Kconfig: make COMPILE_TEST depend on HAS_IOMEM
    
    I read the commit log of the following two:
    
    - bc083a64b6c0 ("init/Kconfig: make COMPILE_TEST depend on !UML")
    - 334ef6ed06fa ("init/Kconfig: make COMPILE_TEST depend on !S390")
    
    Both are talking about HAS_IOMEM dependency missing in many drivers.
    
    So, 'depends on HAS_IOMEM' seems the direct, sensible solution to me.
    
    This does not change the behavior of UML. UML still cannot enable
    COMPILE_TEST because it does not provide HAS_IOMEM.
    
    The current dependency for S390 is too strong. Under the condition of
    CONFIG_PCI=y, S390 provides HAS_IOMEM, hence can enable COMPILE_TEST.
    
    I also removed the meaningless 'default n'.
    
    Link: https://lkml.kernel.org/r/20210224140809.1067582-1-masahiroy@kernel.org
    Signed-off-by: Masahiro Yamada <masahiroy@kernel.org>
    Cc: Heiko Carstens <hca@linux.ibm.com>
    Cc: Guenter Roeck <linux@roeck-us.net>
    Cc: Arnd Bergmann <arnd@kernel.org>
    Cc: Kees Cook <keescook@chromium.org>
    Cc: Daniel Borkmann <daniel@iogearbox.net>
    Cc: Johannes Weiner <hannes@cmpxchg.org>
    Cc: KP Singh <kpsingh@google.com>
    Cc: Nathan Chancellor <nathan@kernel.org>
    Cc: Nick Terrell <terrelln@fb.com>
    Cc: Quentin Perret <qperret@google.com>
    Cc: Valentin Schneider <valentin.schneider@arm.com>
    Cc: "Enrico Weigelt, metux IT consult" <lkml@metux.net>
    Signed-off-by: Andrew Morton <akpm@linux-foundation.org>
    Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>

commit de26d073a4b7c4d36c0f6fd47a942145053a6a0f
Author: Helge Deller <deller@gmx.de>
Date:   Tue Mar 2 21:07:07 2021 +0100

    parisc: Enable -mlong-calls gcc option with CONFIG_COMPILE_TEST
    
    commit 778e45d7720d663811352943dd515b41f6849637 upstream
    
    The kernel test robot reported multiple linkage problems like this:
    
        hppa64-linux-ld: init/main.o(.init.text+0x56c): cannot reach printk
        init/main.o: in function `unknown_bootoption':
        (.init.text+0x56c): relocation truncated to fit: R_PARISC_PCREL22F against
            symbol `printk' defined in .text.unlikely section in kernel/printk/printk.o
    
    There are two ways to solve it:
    a) Enable the -mlong-call compiler option (CONFIG_MLONGCALLS),
    b) Add long branch stub support in 64-bit linker.
    
    While b) is the long-term solution, this patch works around the issue by
    automatically enabling the CONFIG_MLONGCALLS option when
    CONFIG_COMPILE_TEST is set, which indicates that a non-production kernel
    (e.g. 0-day kernel) is built.
    
    Signed-off-by: Helge Deller <deller@gmx.de>
    Reported-by: kernel test robot <lkp@intel.com>
    Fixes: 00e35f2b0e8a ("parisc: Enable -mlong-calls gcc option by default when !CONFIG_MODULES")
    Cc: stable@vger.kernel.org # v5.6+
    Signed-off-by: Sudip Mukherjee <sudipm.mukherjee@gmail.com>
    Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>

commit a6425142f522d7e8ac5244ff94cf6cd844ddc818
Author: Helge Deller <deller@gmx.de>
Date:   Tue Mar 2 21:07:07 2021 +0100

    parisc: Enable -mlong-calls gcc option with CONFIG_COMPILE_TEST
    
    commit 778e45d7720d663811352943dd515b41f6849637 upstream
    
    The kernel test robot reported multiple linkage problems like this:
    
        hppa64-linux-ld: init/main.o(.init.text+0x56c): cannot reach printk
        init/main.o: in function `unknown_bootoption':
        (.init.text+0x56c): relocation truncated to fit: R_PARISC_PCREL22F against
            symbol `printk' defined in .text.unlikely section in kernel/printk/printk.o
    
    There are two ways to solve it:
    a) Enable the -mlong-call compiler option (CONFIG_MLONGCALLS),
    b) Add long branch stub support in 64-bit linker.
    
    While b) is the long-term solution, this patch works around the issue by
    automatically enabling the CONFIG_MLONGCALLS option when
    CONFIG_COMPILE_TEST is set, which indicates that a non-production kernel
    (e.g. 0-day kernel) is built.
    
    Signed-off-by: Helge Deller <deller@gmx.de>
    Reported-by: kernel test robot <lkp@intel.com>
    Fixes: 00e35f2b0e8a ("parisc: Enable -mlong-calls gcc option by default when !CONFIG_MODULES")
    Cc: stable@vger.kernel.org # v5.6+
    Signed-off-by: Sudip Mukherjee <sudipm.mukherjee@gmail.com>
    Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>

commit 24df8b74c8b2fb42c49ffe8585562da0c96446ff
Author: Julian Braha <julianbraha@gmail.com>
Date:   Thu Feb 25 09:06:58 2021 +0100

    media: drivers: media: pci: sta2x11: fix Kconfig dependency on GPIOLIB
    
    When STA2X11_VIP is enabled, and GPIOLIB is disabled,
    Kbuild gives the following warning:
    
    WARNING: unmet direct dependencies detected for VIDEO_ADV7180
      Depends on [n]: MEDIA_SUPPORT [=y] && GPIOLIB [=n] && VIDEO_V4L2 [=y] && I2C [=y]
      Selected by [y]:
      - STA2X11_VIP [=y] && MEDIA_SUPPORT [=y] && MEDIA_PCI_SUPPORT [=y] && MEDIA_CAMERA_SUPPORT [=y] && PCI [=y] && VIDEO_V4L2 [=y] && VIRT_TO_BUS [=y] && I2C [=y] && (STA2X11 [=n] || COMPILE_TEST [=y]) && MEDIA_SUBDRV_AUTOSELECT [=y]
    
    This is because STA2X11_VIP selects VIDEO_ADV7180
    without selecting or depending on GPIOLIB,
    despite VIDEO_ADV7180 depending on GPIOLIB.
    
    Signed-off-by: Julian Braha <julianbraha@gmail.com>
    Signed-off-by: Hans Verkuil <hverkuil-cisco@xs4all.nl>
    Signed-off-by: Mauro Carvalho Chehab <mchehab+huawei@kernel.org>

commit f9bc754be475582e2cc44296f7de0aaedbdbefeb
Author: Masahiro Yamada <masahiroy@kernel.org>
Date:   Wed Mar 10 01:25:45 2021 +0900

    kbuild: dummy-tools: adjust to scripts/cc-version.sh
    
    Commit aec6c60a01d3 ("kbuild: check the minimum compiler version in
    Kconfig") changed how the script detects the compiler version.
    
    Get 'make CROSS_COMPILE=scripts/dummy-tools/' back working again.
    
    Fixes: aec6c60a01d3 ("kbuild: check the minimum compiler version in Kconfig")
    Signed-off-by: Masahiro Yamada <masahiroy@kernel.org>
    Reviewed-by: Nathan Chancellor <nathan@kernel.org>
    Tested-by: Nathan Chancellor <nathan@kernel.org>
    Acked-by: Miguel Ojeda <ojeda@kernel.org>

commit 196ebe5c000afbfe67b8561f716e365174552bd7
Author: Julian Braha <julianbraha@gmail.com>
Date:   Wed Feb 24 23:42:48 2021 -0500

    drivers: tty: serial: IMX_EARLYCON: fix Kconfig dependency on SERIAL_CORE
    
    When SERIAL_IMX_EARLYCON is enabled, and SERIAL_CORE is disabled,
    Kbuild gives the following warning:
    
    WARNING: unmet direct dependencies detected for SERIAL_EARLYCON
      Depends on [n]: TTY [=y] && HAS_IOMEM [=y] && SERIAL_CORE [=n]
      Selected by [y]:
      - SERIAL_IMX_EARLYCON [=y] && TTY [=y] && HAS_IOMEM [=y] && (ARCH_MXC [=y] || COMPILE_TEST [=n]) && OF [=y]
    
    This is because SERIAL_IMX_EARLYCON selects SERIAL_EARLYCON,
    without selecting SERIAL_CORE, despite that config option depending
    on SERIAL_CORE.
    
    Signed-off-by: Julian Braha <julianbraha@gmail.com>
    Link: https://lore.kernel.org/r/20210225044248.4745-1-julianbraha@gmail.com
    Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>

commit 3bb48a8506275f4d9e4593acf9f2fc0880a42f73
Merge: fbda79043024 460c9f1c944b
Author: Linus Torvalds <torvalds@linux-foundation.org>
Date:   Sun Mar 7 13:28:31 2021 -0800

    Merge branch 'parisc-5.12-2' of git://git.kernel.org/pub/scm/linux/kernel/git/deller/parisc-linux
    
    Pull parisc fixes from Helge Deller:
     "Two small parisc architecture fixes: fix a linking failure reported by
      the kernel test robot and remove a duplicate include"
    
    * 'parisc-5.12-2' of git://git.kernel.org/pub/scm/linux/kernel/git/deller/parisc-linux:
      arch/parisc/kernel: remove duplicate include in ptrace
      parisc: Enable -mlong-calls gcc option with CONFIG_COMPILE_TEST

commit 665a38726bcd44d3e9f8c6452638ae263412bfac
Author: Dmitry Torokhov <dmitry.torokhov@gmail.com>
Date:   Fri Dec 18 10:03:12 2020 -0800

    Input: imx_keypad - add dependency on HAS_IOMEM
    
    [ Upstream commit f5cace4b93d736cef348211ae0814cabdd26d86a ]
    
    devm_platform_ioremap_resource() depends on CONFIG_HAS_IOMEM, so let's add
    it to the dependencies when COMPILE_TEST is enabled.
    
    Reported-by: kernel test robot <lkp@intel.com>
    Fixes: c8834032ffe2 ("Input: imx_keypad - add COMPILE_TEST support")
    Link: https://lore.kernel.org/r/X9llpA3w1zlZCHXU@google.com
    Signed-off-by: Dmitry Torokhov <dmitry.torokhov@gmail.com>
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit ad5b15a68f9a19136969672ebe7183cb89f1e1bd
Author: Geert Uytterhoeven <geert+renesas@glider.be>
Date:   Mon Feb 8 15:56:05 2021 +0100

    irqchip/imx: IMX_INTMUX should not default to y, unconditionally
    
    [ Upstream commit a890caeb2ba40ca183969230e204ab144f258357 ]
    
    Merely enabling CONFIG_COMPILE_TEST should not enable additional code.
    To fix this, restrict the automatic enabling of IMX_INTMUX to ARCH_MXC,
    and ask the user in case of compile-testing.
    
    Fixes: 66968d7dfc3f5451 ("irqchip: Add COMPILE_TEST support for IMX_INTMUX")
    Signed-off-by: Geert Uytterhoeven <geert+renesas@glider.be>
    Signed-off-by: Marc Zyngier <maz@kernel.org>
    Link: https://lore.kernel.org/r/20210208145605.422943-1-geert+renesas@glider.be
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit cdde346705e6beeb34ccd44ba3520a44feb8138c
Author: Andy Shevchenko <andriy.shevchenko@linux.intel.com>
Date:   Mon Dec 14 16:28:32 2020 +0100

    media: ipu3-cio2: Build only for x86
    
    [ Upstream commit 3ef5e42d281ea108f4ccdca186de4ce20a346326 ]
    
    According to the original code in the driver it was never assumed to work
    with big page sizes: unsigned short type followed by PAGE_SHIFT and
    PAGE_MASK which may be different on non-x86 architectures.
    
    Recently LKP found an issue on non-x86 architectures due to above
    mentioned limitations. Since Sakari acknowledges that it's not really
    useful to be able to compile this elsewhere, mark it x86 only.
    
    Fixes: a31d19f88932 ("media: ipu3: allow building it with COMPILE_TEST on non-x86 archs")
    Reported-by: kernel test robot <lkp@intel.com>
    Suggested-by: Sakari Ailus <sakari.ailus@linux.intel.com>
    Signed-off-by: Andy Shevchenko <andriy.shevchenko@linux.intel.com>
    Signed-off-by: Sakari Ailus <sakari.ailus@linux.intel.com>
    Signed-off-by: Mauro Carvalho Chehab <mchehab+huawei@kernel.org>
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit 3e7387af5a508bc5d8791e897f35777e50d1877f
Author: Geert Uytterhoeven <geert+renesas@glider.be>
Date:   Mon Feb 8 15:56:05 2021 +0100

    irqchip/imx: IMX_INTMUX should not default to y, unconditionally
    
    [ Upstream commit a890caeb2ba40ca183969230e204ab144f258357 ]
    
    Merely enabling CONFIG_COMPILE_TEST should not enable additional code.
    To fix this, restrict the automatic enabling of IMX_INTMUX to ARCH_MXC,
    and ask the user in case of compile-testing.
    
    Fixes: 66968d7dfc3f5451 ("irqchip: Add COMPILE_TEST support for IMX_INTMUX")
    Signed-off-by: Geert Uytterhoeven <geert+renesas@glider.be>
    Signed-off-by: Marc Zyngier <maz@kernel.org>
    Link: https://lore.kernel.org/r/20210208145605.422943-1-geert+renesas@glider.be
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit c271cb89897c4c446c046b15696b0dedecd15d6e
Author: Andy Shevchenko <andriy.shevchenko@linux.intel.com>
Date:   Mon Dec 14 16:28:32 2020 +0100

    media: ipu3-cio2: Build only for x86
    
    [ Upstream commit 3ef5e42d281ea108f4ccdca186de4ce20a346326 ]
    
    According to the original code in the driver it was never assumed to work
    with big page sizes: unsigned short type followed by PAGE_SHIFT and
    PAGE_MASK which may be different on non-x86 architectures.
    
    Recently LKP found an issue on non-x86 architectures due to above
    mentioned limitations. Since Sakari acknowledges that it's not really
    useful to be able to compile this elsewhere, mark it x86 only.
    
    Fixes: a31d19f88932 ("media: ipu3: allow building it with COMPILE_TEST on non-x86 archs")
    Reported-by: kernel test robot <lkp@intel.com>
    Suggested-by: Sakari Ailus <sakari.ailus@linux.intel.com>
    Signed-off-by: Andy Shevchenko <andriy.shevchenko@linux.intel.com>
    Signed-off-by: Sakari Ailus <sakari.ailus@linux.intel.com>
    Signed-off-by: Mauro Carvalho Chehab <mchehab+huawei@kernel.org>
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit 778e45d7720d663811352943dd515b41f6849637
Author: Helge Deller <deller@gmx.de>
Date:   Tue Mar 2 21:07:07 2021 +0100

    parisc: Enable -mlong-calls gcc option with CONFIG_COMPILE_TEST
    
    The kernel test robot reported multiple linkage problems like this:
    
        hppa64-linux-ld: init/main.o(.init.text+0x56c): cannot reach printk
        init/main.o: in function `unknown_bootoption':
        (.init.text+0x56c): relocation truncated to fit: R_PARISC_PCREL22F against
            symbol `printk' defined in .text.unlikely section in kernel/printk/printk.o
    
    There are two ways to solve it:
    a) Enable the -mlong-call compiler option (CONFIG_MLONGCALLS),
    b) Add long branch stub support in 64-bit linker.
    
    While b) is the long-term solution, this patch works around the issue by
    automatically enabling the CONFIG_MLONGCALLS option when
    CONFIG_COMPILE_TEST is set, which indicates that a non-production kernel
    (e.g. 0-day kernel) is built.
    
    Signed-off-by: Helge Deller <deller@gmx.de>
    Reported-by: kernel test robot <lkp@intel.com>
    Fixes: 00e35f2b0e8a ("parisc: Enable -mlong-calls gcc option by default when !CONFIG_MODULES")
    Cc: stable@vger.kernel.org # v5.6+

commit 01c2c1ad8f45e0c191bfd961dc41cd77df0d7a2f
Author: Arnd Bergmann <arnd@arndb.de>
Date:   Thu Feb 25 15:38:32 2021 +0100

    net: dsa: tag_ocelot_8021q: fix driver dependency
    
    When the ocelot driver code is in a library, the dsa tag
    code cannot be built-in:
    
    ld.lld: error: undefined symbol: ocelot_can_inject
    >>> referenced by tag_ocelot_8021q.c
    >>>               dsa/tag_ocelot_8021q.o:(ocelot_xmit) in archive net/built-in.a
    
    ld.lld: error: undefined symbol: ocelot_port_inject_frame
    >>> referenced by tag_ocelot_8021q.c
    >>>               dsa/tag_ocelot_8021q.o:(ocelot_xmit) in archive net/built-in.a
    
    Building the tag support only really makes sense for compile-testing
    when the driver is available, so add a Kconfig dependency that prevents
    the broken configuration while allowing COMPILE_TEST alternative when
    MSCC_OCELOT_SWITCH_LIB is disabled entirely.  This case is handled
    through the #ifdef check in include/soc/mscc/ocelot.h.
    
    Fixes: 0a6f17c6ae21 ("net: dsa: tag_ocelot_8021q: add support for PTP timestamping")
    Signed-off-by: Arnd Bergmann <arnd@arndb.de>
    Acked-by: Vladimir Oltean <vladimir.oltean@nxp.com>
    Link: https://lore.kernel.org/r/20210225143910.3964364-2-arnd@kernel.org
    Signed-off-by: Jakub Kicinski <kuba@kernel.org>

commit 6c15f9e805f22566d7547551f359aba04b611f9d
Merge: 29c395c77a9a 40e0dd851e7b
Author: Linus Torvalds <torvalds@linux-foundation.org>
Date:   Thu Feb 25 09:50:36 2021 -0800

    Merge tag 'nds32-for-linux-5.12' of git://git.kernel.org/pub/scm/linux/kernel/git/greentime/linux
    
    Pull nds32 updates from Greentime Hu:
     "Code clean-up and refinement"
    
    * tag 'nds32-for-linux-5.12' of git://git.kernel.org/pub/scm/linux/kernel/git/greentime/linux:
      nds32: Fix bogus reference to <asm/procinfo.h>
      nds32: use get_kernel_nofault in dump_mem
      nds32: remove dump_instr
      nds32: configs: Cleanup CONFIG_CROSS_COMPILE
      nds32: Replace <linux/clk-provider.h> by <linux/of_clk.h>

commit e99da8af9cbc8f68e27c28ddeb57a40ee1006081
Author: Krzysztof Kozlowski <krzk@kernel.org>
Date:   Mon Feb 17 17:49:18 2020 +0100

    nds32: configs: Cleanup CONFIG_CROSS_COMPILE
    
    CONFIG_CROSS_COMPILE is gone since commit f1089c92da79 ("kbuild: remove
    CONFIG_CROSS_COMPILE support").
    
    Signed-off-by: Krzysztof Kozlowski <krzk@kernel.org>
    Acked-by: Greentime Hu <green.hu@gmail.com>
    Signed-off-by: Greentime Hu <green.hu@gmail.com>

commit a555bdd0c58ce368fb1324f0e93d17f7c4babece
Author: Linus Torvalds <torvalds@linux-foundation.org>
Date:   Wed Feb 24 08:57:06 2021 -0800

    Kbuild: enable TRIM_UNUSED_KSYMS again, with some guarding
    
    In commit 5cf0fd591f2e ("Kbuild: disable TRIM_UNUSED_KSYMS option") I
    disabled this option because it's hugely expensive at build time, and I
    questioned how much use it gets.
    
    Several people piped up and convinced me it's actually useful, so
    instead of disabling it entirely, it now depends on EXPERT and gets
    disabled by COMPILE_TEST builds so that 'allmodconfig' style things
    don't enable it.
    
    I still hope somebody will take a look at the build time issue, because
    as Arnd also noted:
    
     "However, the combination of thinlto and trim indeed has a steep cost
      in compile time, taking almost twice as long as a normal defconfig
      (gc-sections makes it slightly faster)"
    
    Cc: Masahiro Yamada <masahiroy@kernel.org>
    Cc: Arnd Bergmann <arnd@kernel.org>
    Cc: Jessica Yu <jeyu@kernel.org>
    Cc: Cristoph Hellwig <hch@lst.de>,
    Cc: Miroslav Benes <mbenes@suse.cz>
    Cc: Emil Velikov <emil.l.velikov@gmail.com>
    Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>

commit 5cf0fd591f2e7833405bdc7ce2176c3502e8a11e
Author: Linus Torvalds <torvalds@linux-foundation.org>
Date:   Tue Feb 23 12:21:58 2021 -0800

    Kbuild: disable TRIM_UNUSED_KSYMS option
    
    The removal of EXPORT_UNUSED_SYMBOL() in commit 367948220fce looks like
    (and was sold as) a no-op, but it actually had a rather serious and
    subtle side effect: the UNUSED_SYMBOLS option not only enabled the
    removed (unused) functionality, it also _disabled_ the TRIM_UNUSED_KSYMS
    functionality.
    
    And it turns out that TRIM_UNUSED_KSYMS is a huge time waste, and takes
    up a third of the kernel build time for me.  For no actual upside, since
    no distro is likely to ever be able to enable it (because they all
    support external kernel modules).
    
    Rather than re-enable EXPORT_UNUSED_SYMBOL, this just disables the
    TRIM_UNUSED_KSYMS option by marking it broken.  I'm tempted to just
    remove the support entirely, but maybe somebody has a use-case and can
    fix the behavior of it.
    
    I could have just disabled it for COMPILE_TEST, but it really smells
    like the TRIM_UNUSED_KSYMS option is badly done and not really useful,
    so this takes the more direct approach - let's see if anybody ever
    actually notices or complains.
    
    Cc: Miroslav Benes <mbenes@suse.cz>
    Cc: Emil Velikov <emil.l.velikov@gmail.com>
    Cc: Christoph Hellwig <hch@lst.de>
    Cc: Jessica Yu <jeyu@kernel.org>
    Fixes: 367948220fce ("module: remove EXPORT_UNUSED_SYMBOL*")
    Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>

commit 79db4d2293eba2ce6265a341bedf6caecad5eeb3
Merge: 3b9cdafb5358 2b8689520520
Author: Linus Torvalds <torvalds@linux-foundation.org>
Date:   Tue Feb 23 09:28:51 2021 -0800

    Merge tag 'clang-lto-v5.12-rc1' of git://git.kernel.org/pub/scm/linux/kernel/git/kees/linux
    
    Pull clang LTO updates from Kees Cook:
     "Clang Link Time Optimization.
    
      This is built on the work done preparing for LTO by arm64 folks,
      tracing folks, etc. This includes the core changes as well as the
      remaining pieces for arm64 (LTO has been the default build method on
      Android for about 3 years now, as it is the prerequisite for the
      Control Flow Integrity protections).
    
      While x86 LTO enablement is done, it depends on some pending objtool
      clean-ups. It's possible that I'll send a "part 2" pull request for
      LTO that includes x86 support.
    
      For merge log posterity, and as detailed in commit dc5723b02e52
      ("kbuild: add support for Clang LTO"), here is the lt;dr to do an LTO
      build:
    
            make LLVM=1 LLVM_IAS=1 defconfig
            scripts/config -e LTO_CLANG_THIN
            make LLVM=1 LLVM_IAS=1
    
      (To do a cross-compile of arm64, add "CROSS_COMPILE=aarch64-linux-gnu-"
      and "ARCH=arm64" to the "make" command lines.)
    
      Summary:
    
       - Clang LTO build infrastructure and arm64-specific enablement (Sami
         Tolvanen)
    
       - Recursive build CC_FLAGS_LTO fix (Alexander Lobakin)"
    
    * tag 'clang-lto-v5.12-rc1' of git://git.kernel.org/pub/scm/linux/kernel/git/kees/linux:
      kbuild: prevent CC_FLAGS_LTO self-bloating on recursive rebuilds
      arm64: allow LTO to be selected
      arm64: disable recordmcount with DYNAMIC_FTRACE_WITH_REGS
      arm64: vdso: disable LTO
      drivers/misc/lkdtm: disable LTO for rodata.o
      efi/libstub: disable LTO
      scripts/mod: disable LTO for empty.c
      modpost: lto: strip .lto from module names
      PCI: Fix PREL32 relocations for LTO
      init: lto: fix PREL32 relocations
      init: lto: ensure initcall ordering
      kbuild: lto: add a default list of used symbols
      kbuild: lto: merge module sections
      kbuild: lto: limit inlining
      kbuild: lto: fix module versioning
      kbuild: add support for Clang LTO
      tracing: move function tracer options to Kconfig

commit 3b9cdafb5358eb9f3790de2f728f765fef100731
Merge: f81f213850ca b40b760aa2a9
Author: Linus Torvalds <torvalds@linux-foundation.org>
Date:   Mon Feb 22 18:39:11 2021 -0800

    Merge tag 'pinctrl-v5.12-1' of git://git.kernel.org/pub/scm/linux/kernel/git/linusw/linux-pinctrl
    
    Pull pin control updates from Linus Walleij:
     "This is the bulk of pin control changes for the v5.12 kernel.
    
      This time a calm set with no core changes.
    
      New drivers/subdrivers:
    
       - Renesas R8A7790A0 pin controller.
    
       - Allwinner H616 and H616-R pin controllers.
    
       - Qualcomm SM8350 and SC8180x pin controllers.
    
      Improvements:
    
       - Redo the DT bindings for Ralink RT2880.
    
       - A common Qualcomm TLMM DT binding in YAML.
    
       - Delete the unused drivers for U300, COH901, Sirf Atlas, and ZTE ZX"
    
    * tag 'pinctrl-v5.12-1' of git://git.kernel.org/pub/scm/linux/kernel/git/linusw/linux-pinctrl: (71 commits)
      pinctrl: mediatek: Fix trigger type setting follow for unexpected interrupt
      dt-bindings: pinctrl: Group tuples in pin control properties
      pinctrl: nuvoton: npcm7xx: Fix alignment of table header comment
      pinctrl: at91-pio4: fix "Prefer 'unsigned int' to bare use of 'unsigned'"
      pinctrl: at91-pio4: add support for slew-rate
      dt-bindings: pinctrl: at91-pio4: add slew-rate
      pinctrl: actions: Add depends on || COMPILE_TEST
      pinctrl: single: set function name when adding function
      pinctrl: qcom: Add sc8180x TLMM driver
      dt-bindings: pinctrl: qcom: Add sc8180x binding
      dt-bindings: pinctrl: qcom: Define common TLMM binding
      pinctrl: qcom: Add SM8350 pinctrl driver
      dt-bindings: pinctrl: qcom: Add SM8350 pinctrl bindings
      pinctrl: samsung: use raw_spinlock for s3c64xx
      dt-bindings: mediatek: mt8192: Fix dt_binding_check warning
      pinctrl: qcom: spmi-mpp: Add PM8019 compatible
      pinctrl: pinmux: add function selector to pinmux-functions
      pinctrl: samsung: use raw_spinlock for locking
      pinctrl: clarify #pinctrl-cells for pinctrl-single,pins
      pinctrl: actions: Add the platform dependency to drivers
      ...

commit e072d454faa45847a1544b47e88a1377a36ac720
Author: Geert Uytterhoeven <geert+renesas@glider.be>
Date:   Mon Feb 8 15:51:53 2021 +0100

    gpio: mxs: GPIO_MXS should not default to y unconditionally
    
    commit 97c6e28d388a5000d780d2a63c32f422827f5aa3 upstream.
    
    Merely enabling CONFIG_COMPILE_TEST should not enable additional code.
    To fix this, restrict the automatic enabling of GPIO_MXS to ARCH_MXS,
    and ask the user in case of compile-testing.
    
    Fixes: 6876ca311bfca5d7 ("gpio: mxs: add COMPILE_TEST support for GPIO_MXS")
    Cc: <stable@vger.kernel.org>
    Signed-off-by: Geert Uytterhoeven <geert+renesas@glider.be>
    Signed-off-by: Bartosz Golaszewski <bgolaszewski@baylibre.com>
    Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>

commit 93c89f03cb1d734630597cb0acf0b2af309f8e62
Author: Daniel Palmer <daniel@0x0f.com>
Date:   Mon Feb 15 20:57:09 2021 +0900

    clk: mstar: Allow MStar clk drivers to be compile tested
    
    Allow COMPILE_TEST to also build the MStar clk drivers
    instead of only building them when ARCH_MSTARV7 is selected.
    
    Signed-off-by: Daniel Palmer <daniel@0x0f.com>
    Suggested-by: Stephen Boyd <sboyd@kernel.org>
    Link: https://lore.kernel.org/r/20210215115710.3762276-1-daniel@0x0f.com
    [sboyd@kernel.org: Drop regmap select too]
    Signed-off-by: Stephen Boyd <sboyd@kernel.org>

commit a890caeb2ba40ca183969230e204ab144f258357
Author: Geert Uytterhoeven <geert+renesas@glider.be>
Date:   Mon Feb 8 15:56:05 2021 +0100

    irqchip/imx: IMX_INTMUX should not default to y, unconditionally
    
    Merely enabling CONFIG_COMPILE_TEST should not enable additional code.
    To fix this, restrict the automatic enabling of IMX_INTMUX to ARCH_MXC,
    and ask the user in case of compile-testing.
    
    Fixes: 66968d7dfc3f5451 ("irqchip: Add COMPILE_TEST support for IMX_INTMUX")
    Signed-off-by: Geert Uytterhoeven <geert+renesas@glider.be>
    Signed-off-by: Marc Zyngier <maz@kernel.org>
    Link: https://lore.kernel.org/r/20210208145605.422943-1-geert+renesas@glider.be

commit d3171b6882be50e3bd6ae4cd4c86f9d90a2d8e7a
Author: Linus Walleij <linus.walleij@linaro.org>
Date:   Fri Feb 12 09:11:48 2021 +0100

    pinctrl: actions: Add depends on || COMPILE_TEST
    
    I happened to apply the v1 of the patch restriction the
    selection to ARM or ARM64, sorry for my sloppiness.
    Fixing up the mistake as I can't back the patch out now.
    
    Fixes: 5784921f7b6c ("pinctrl: actions: Add the platform dependency to drivers")
    Reviewed-by: Manivannan Sadhasivam <manivannan.sadhasivam@linaro.org>
    Signed-off-by: Linus Walleij <linus.walleij@linaro.org>

commit c05263df6c1ab82277cc3b2778b183b469a71a60
Merge: 291009f656e8 28dc10eb77a2
Author: Linus Torvalds <torvalds@linux-foundation.org>
Date:   Thu Feb 11 11:21:08 2021 -0800

    Merge tag 'gpio-fixes-for-v5.11' of git://git.kernel.org/pub/scm/linux/kernel/git/brgl/linux
    
    Pull gpio fixes from Bartosz Golaszewski:
     "This is hopefully the last batch of fixes for this release cycle. We
      have a minor fix for a Kconfig regression as well as fixes for older
      bugs in gpio-ep93xx:
    
       - don't build gpio-mxs unconditionally with COMPILE_TEST enabled
    
       - fix two problems with interrupt handling in gpio-ep93xx"
    
    * tag 'gpio-fixes-for-v5.11' of git://git.kernel.org/pub/scm/linux/kernel/git/brgl/linux:
      gpio: ep93xx: Fix single irqchip with multi gpiochips
      gpio: ep93xx: fix BUG_ON port F usage
      gpio: mxs: GPIO_MXS should not default to y unconditionally

commit 97c6e28d388a5000d780d2a63c32f422827f5aa3
Author: Geert Uytterhoeven <geert+renesas@glider.be>
Date:   Mon Feb 8 15:51:53 2021 +0100

    gpio: mxs: GPIO_MXS should not default to y unconditionally
    
    Merely enabling CONFIG_COMPILE_TEST should not enable additional code.
    To fix this, restrict the automatic enabling of GPIO_MXS to ARCH_MXS,
    and ask the user in case of compile-testing.
    
    Fixes: 6876ca311bfca5d7 ("gpio: mxs: add COMPILE_TEST support for GPIO_MXS")
    Cc: <stable@vger.kernel.org>
    Signed-off-by: Geert Uytterhoeven <geert+renesas@glider.be>
    Signed-off-by: Bartosz Golaszewski <bgolaszewski@baylibre.com>

commit c143ab5556797e746a8913b782135b2bae3a744d
Author: Arnd Bergmann <arnd@arndb.de>
Date:   Wed Dec 30 16:52:25 2020 +0100

    clk: imx: fix Kconfig warning for i.MX SCU clk
    
    commit 73f6b7ed9835ad9f953aebd60dd720aabc487b81 upstream.
    
    A previous patch introduced a harmless randconfig warning:
    
    WARNING: unmet direct dependencies detected for MXC_CLK_SCU
      Depends on [n]: COMMON_CLK [=y] && ARCH_MXC [=n] && IMX_SCU [=y] && HAVE_ARM_SMCCC [=y]
      Selected by [m]:
      - CLK_IMX8QXP [=m] && COMMON_CLK [=y] && (ARCH_MXC [=n] && ARM64 [=y] || COMPILE_TEST [=y]) && IMX_SCU [=y] && HAVE_ARM_SMCCC [=y]
    
    Since the symbol is now hidden and only selected by other symbols,
    just remove the dependencies and require the other drivers to
    get it right.
    
    Fixes: 6247e31b7530 ("clk: imx: scu: fix MXC_CLK_SCU module build break")
    Reported-by: Anders Roxell <anders.roxell@linaro.org>
    Signed-off-by: Arnd Bergmann <arnd@arndb.de>
    Link: https://lore.kernel.org/r/20201230155244.981757-1-arnd@kernel.org
    Signed-off-by: Stephen Boyd <sboyd@kernel.org>
    Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>

commit cd0f00c39ff48006cb0523b09b22842d21f70e72
Author: Sia Jee Heng <jee.heng.sia@intel.com>
Date:   Mon Jan 25 09:32:50 2021 +0800

    dmaengine: drivers: Kconfig: add HAS_IOMEM dependency to DW_AXI_DMAC
    
    If HAS_IOMEM is not defined and DW_AXI_DMAC is enabled under COMPILE_TEST,
    the build fails with the following error:
    dw-axi-dmac-platform.c:(.text+0xc4): undefined reference to
    `devm_ioremap_resource'
    Link: https://www.spinics.net/lists/dmaengine/msg25188.html
    
    Reported-by: kernel test robot <lkp@intel.com>
    Signed-off-by: Sia Jee Heng <jee.heng.sia@intel.com>
    Link: https://lore.kernel.org/r/20210125013255.25799-13-jee.heng.sia@intel.com
    Signed-off-by: Vinod Koul <vkoul@kernel.org>

commit 2352cf40fb7c8c1407534767551f9ead6a736f20
Author: Coiby Xu <coiby.xu@gmail.com>
Date:   Sat Jan 23 18:46:10 2021 +0800

    staging: qlge: support force_coredump option for devlink health dump
    
    With force_coredump module parameter set, devlink health dump will
    reset the MPI RISC first which takes 5 secs to be finished.
    
    Note that only NIC function that owns the firmware can do the
    force_dumping. Otherwise devlink will receive an EPERM error.
    
    Signed-off-by: Coiby Xu <coiby.xu@gmail.com>
    Link: https://lore.kernel.org/r/20210123104613.38359-6-coiby.xu@gmail.com
    Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>

commit 6bc83cce3e7fdd3e39121e8ffff3cfe893cf7fac
Author: Damien Le Moal <damien.lemoal@wdc.com>
Date:   Sun Dec 13 22:50:36 2020 +0900

    riscv: Enable interrupts during syscalls with M-Mode
    
    [ Upstream commit 643437b996bac9267785e0bd528332e2d5811067 ]
    
    When running is M-Mode (no MMU config), MPIE does not get set. This
    results in all syscalls being executed with interrupts disabled as
    handle_exception never sets SR_IE as it always sees SR_PIE being
    cleared. Fix this by always force enabling interrupts in
    handle_syscall when CONFIG_RISCV_M_MODE is enabled.
    
    Signed-off-by: Damien Le Moal <damien.lemoal@wdc.com>
    Reviewed-by: Palmer Dabbelt <palmerdabbelt@google.com>
    Signed-off-by: Palmer Dabbelt <palmerdabbelt@google.com>
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit 692347a93178a3635da13f41e29d40e3ee1b1808
Merge: e7b76db36240 04cbb740ce1b
Author: Jakub Kicinski <kuba@kernel.org>
Date:   Sat Jan 23 13:21:39 2021 -0800

    Merge branch 'remove-unneeded-phy-time-stamping-option'
    
    Richard Cochran says:
    
    ====================
    Remove unneeded PHY time stamping option.
    
    The NETWORK_PHY_TIMESTAMPING configuration option adds additional
    checks into the networking hot path, and it is only needed by two
    rather esoteric devices, namely the TI DP83640 PHYTER and the ZHAW
    InES 1588 IP core.  Very few end users have these devices, and those
    that do have them are building specialized embedded systems.
    
    Unfortunately two unrelated drivers depend on this option, and two
    defconfigs enable it.  It is probably my fault for not paying enough
    attention in reviews.
    
    This series corrects the gratuitous use of NETWORK_PHY_TIMESTAMPING.
    ====================
    
    Link: https://lore.kernel.org/r/cover.1611198584.git.richardcochran@gmail.com
    Signed-off-by: Jakub Kicinski <kuba@kernel.org>

commit 974efba82da2782370abc513181ae0378c5b9aed
Author: Masahiro Yamada <masahiroy@kernel.org>
Date:   Sun Nov 22 04:36:54 2020 +0900

    ARC: build: add boot_targets to PHONY
    
    [ Upstream commit 0cfccb3c04934cdef42ae26042139f16e805b5f7 ]
    
    The top-level boot_targets (uImage and uImage.*) should be phony
    targets. They just let Kbuild descend into arch/arc/boot/ and create
    files there.
    
    If a file exists in the top directory with the same name, the boot
    image will not be created.
    
    You can confirm it by the following steps:
    
      $ export CROSS_COMPILE=<your-arc-compiler-prefix>
      $ make -s ARCH=arc defconfig all   # vmlinux will be built
      $ touch uImage.gz
      $ make ARCH=arc uImage.gz
      CALL    scripts/atomic/check-atomics.sh
      CALL    scripts/checksyscalls.sh
      CHK     include/generated/compile.h
      # arch/arc/boot/uImage.gz is not created
    
    Specify the targets as PHONY to fix this.
    
    Signed-off-by: Masahiro Yamada <masahiroy@kernel.org>
    Signed-off-by: Vineet Gupta <vgupta@synopsys.com>
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit 4c8e76fc73cb20db8b2bf26d3ecb26d51f5287c9
Author: Masahiro Yamada <masahiroy@kernel.org>
Date:   Sun Nov 22 04:36:52 2020 +0900

    ARC: build: remove non-existing bootpImage from KBUILD_IMAGE
    
    [ Upstream commit 9836720911cfec25d3fbdead1c438bf87e0f2841 ]
    
    The deb-pkg builds for ARCH=arc fail.
    
      $ export CROSS_COMPILE=<your-arc-compiler-prefix>
      $ make -s ARCH=arc defconfig
      $ make ARCH=arc bindeb-pkg
      SORTTAB vmlinux
      SYSMAP  System.map
      MODPOST Module.symvers
      make KERNELRELEASE=5.10.0-rc4 ARCH=arc KBUILD_BUILD_VERSION=2 -f ./Makefile intdeb-pkg
      sh ./scripts/package/builddeb
      cp: cannot stat 'arch/arc/boot/bootpImage': No such file or directory
      make[4]: *** [scripts/Makefile.package:87: intdeb-pkg] Error 1
      make[3]: *** [Makefile:1527: intdeb-pkg] Error 2
      make[2]: *** [debian/rules:13: binary-arch] Error 2
      dpkg-buildpackage: error: debian/rules binary subprocess returned exit status 2
      make[1]: *** [scripts/Makefile.package:83: bindeb-pkg] Error 2
      make: *** [Makefile:1527: bindeb-pkg] Error 2
    
    The reason is obvious; arch/arc/Makefile sets $(boot)/bootpImage as
    the default image, but there is no rule to build it.
    
    Remove the meaningless KBUILD_IMAGE assignment so it will fallback
    to the default vmlinux. With this change, you can build the deb package.
    
    I removed the 'bootpImage' target as well. At best, it provides
    'make bootpImage' as an alias of 'make vmlinux', but I do not see
    much sense in doing so.
    
    Signed-off-by: Masahiro Yamada <masahiroy@kernel.org>
    Signed-off-by: Vineet Gupta <vgupta@synopsys.com>
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit c321869fbe7b773d278e6bff6523862b61eb92f5
Author: Masahiro Yamada <masahiroy@kernel.org>
Date:   Sun Nov 22 04:36:54 2020 +0900

    ARC: build: add boot_targets to PHONY
    
    [ Upstream commit 0cfccb3c04934cdef42ae26042139f16e805b5f7 ]
    
    The top-level boot_targets (uImage and uImage.*) should be phony
    targets. They just let Kbuild descend into arch/arc/boot/ and create
    files there.
    
    If a file exists in the top directory with the same name, the boot
    image will not be created.
    
    You can confirm it by the following steps:
    
      $ export CROSS_COMPILE=<your-arc-compiler-prefix>
      $ make -s ARCH=arc defconfig all   # vmlinux will be built
      $ touch uImage.gz
      $ make ARCH=arc uImage.gz
      CALL    scripts/atomic/check-atomics.sh
      CALL    scripts/checksyscalls.sh
      CHK     include/generated/compile.h
      # arch/arc/boot/uImage.gz is not created
    
    Specify the targets as PHONY to fix this.
    
    Signed-off-by: Masahiro Yamada <masahiroy@kernel.org>
    Signed-off-by: Vineet Gupta <vgupta@synopsys.com>
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit 7028baed7ebabf298f08866d9d3b7b5c3b47e641
Author: Masahiro Yamada <masahiroy@kernel.org>
Date:   Sun Nov 22 04:36:54 2020 +0900

    ARC: build: add boot_targets to PHONY
    
    [ Upstream commit 0cfccb3c04934cdef42ae26042139f16e805b5f7 ]
    
    The top-level boot_targets (uImage and uImage.*) should be phony
    targets. They just let Kbuild descend into arch/arc/boot/ and create
    files there.
    
    If a file exists in the top directory with the same name, the boot
    image will not be created.
    
    You can confirm it by the following steps:
    
      $ export CROSS_COMPILE=<your-arc-compiler-prefix>
      $ make -s ARCH=arc defconfig all   # vmlinux will be built
      $ touch uImage.gz
      $ make ARCH=arc uImage.gz
      CALL    scripts/atomic/check-atomics.sh
      CALL    scripts/checksyscalls.sh
      CHK     include/generated/compile.h
      # arch/arc/boot/uImage.gz is not created
    
    Specify the targets as PHONY to fix this.
    
    Signed-off-by: Masahiro Yamada <masahiroy@kernel.org>
    Signed-off-by: Vineet Gupta <vgupta@synopsys.com>
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit e7ed11ee945438b737e2ae2370e35591e16ec371
Author: Yousuk Seung <ysseung@google.com>
Date:   Wed Jan 20 12:41:55 2021 -0800

    tcp: add TTL to SCM_TIMESTAMPING_OPT_STATS
    
    This patch adds TCP_NLA_TTL to SCM_TIMESTAMPING_OPT_STATS that exports
    the time-to-live or hop limit of the latest incoming packet with
    SCM_TSTAMP_ACK. The value exported may not be from the packet that acks
    the sequence when incoming packets are aggregated. Exporting the
    time-to-live or hop limit value of incoming packets helps to estimate
    the hop count of the path of the flow that may change over time.
    
    Signed-off-by: Yousuk Seung <ysseung@google.com>
    Signed-off-by: Eric Dumazet <edumazet@google.com>
    Signed-off-by: Neal Cardwell <ncardwell@google.com>
    Link: https://lore.kernel.org/r/20210120204155.552275-1-ysseung@google.com
    Signed-off-by: Jakub Kicinski <kuba@kernel.org>

commit 51dfb6ca3728bd0a0a3c23776a12d2a15a1d2457
Author: Dmitry Osipenko <digetx@gmail.com>
Date:   Wed Jan 20 23:58:44 2021 +0300

    regulator: consumer: Add missing stubs to regulator/consumer.h
    
    Add missing stubs to regulator/consumer.h in order to fix COMPILE_TEST
    of the kernel. In particular this should fix compile-testing of OPP core
    because of a missing stub for regulator_sync_voltage().
    
    Reported-by: kernel test robot <lkp@intel.com>
    Signed-off-by: Dmitry Osipenko <digetx@gmail.com>
    Link: https://lore.kernel.org/r/20210120205844.12658-1-digetx@gmail.com
    Signed-off-by: Mark Brown <broonie@kernel.org>

commit 6169a5cfaacc8294cd360d9b864a212f545bca95
Author: Masahiro Yamada <masahiroy@kernel.org>
Date:   Sun Nov 22 04:36:55 2020 +0900

    ARC: build: move symlink creation to arch/arc/Makefile to avoid race
    
    [ Upstream commit c5e6ae563c802c4d828d42e134af64004db2e58c ]
    
    If you run 'make uImage uImage.gz' with the parallel option, uImage.gz
    will be created by two threads simultaneously.
    
    This is because arch/arc/Makefile does not specify the dependency
    between uImage and uImage.gz. Hence, GNU Make assumes they can be
    built in parallel. One thread descends into arch/arc/boot/ to create
    uImage, and another to create uImage.gz.
    
    Please notice the same log is displayed twice in the following steps:
    
      $ export CROSS_COMPILE=<your-arc-compiler-prefix>
      $ make -s ARCH=arc defconfig
      $ make -j$(nproc) ARCH=arc uImage uImage.gz
      [ snip ]
        LD      vmlinux
        SORTTAB vmlinux
        SYSMAP  System.map
        OBJCOPY arch/arc/boot/vmlinux.bin
        OBJCOPY arch/arc/boot/vmlinux.bin
        GZIP    arch/arc/boot/vmlinux.bin.gz
        GZIP    arch/arc/boot/vmlinux.bin.gz
        UIMAGE  arch/arc/boot/uImage.gz
        UIMAGE  arch/arc/boot/uImage.gz
      Image Name:   Linux-5.10.0-rc4-00003-g62f23044
      Created:      Sun Nov 22 02:52:26 2020
      Image Type:   ARC Linux Kernel Image (gzip compressed)
      Data Size:    2109376 Bytes = 2059.94 KiB = 2.01 MiB
      Load Address: 80000000
      Entry Point:  80004000
        Image arch/arc/boot/uImage is ready
      Image Name:   Linux-5.10.0-rc4-00003-g62f23044
      Created:      Sun Nov 22 02:52:26 2020
      Image Type:   ARC Linux Kernel Image (gzip compressed)
      Data Size:    2815455 Bytes = 2749.47 KiB = 2.69 MiB
      Load Address: 80000000
      Entry Point:  80004000
    
    This is a race between the two threads trying to write to the same file
    arch/arc/boot/uImage.gz. This is a potential problem that can generate
    a broken file.
    
    I fixed a similar problem for ARM by commit 3939f3345050 ("ARM: 8418/1:
    add boot image dependencies to not generate invalid images").
    
    I highly recommend to avoid such build rules that cause a race condition.
    
    Move the uImage rule to arch/arc/Makefile.
    
    Another strangeness is that arch/arc/boot/Makefile compares the
    timestamps between $(obj)/uImage and $(obj)/uImage.*:
    
      $(obj)/uImage: $(obj)/uImage.$(suffix-y)
              @ln -sf $(notdir $<) $@
              @echo '  Image $@ is ready'
    
    This does not work as expected since $(obj)/uImage is a symlink.
    The symlink should be created in a phony target rule.
    
    I used $(kecho) instead of echo to suppress the message
    'Image arch/arc/boot/uImage is ready' when the -s option is given.
    
    Signed-off-by: Masahiro Yamada <masahiroy@kernel.org>
    Signed-off-by: Vineet Gupta <vgupta@synopsys.com>
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit 443fb88d6dea55e7262923fb9f76213bc089ae45
Author: Masahiro Yamada <masahiroy@kernel.org>
Date:   Sun Nov 22 04:36:54 2020 +0900

    ARC: build: add boot_targets to PHONY
    
    [ Upstream commit 0cfccb3c04934cdef42ae26042139f16e805b5f7 ]
    
    The top-level boot_targets (uImage and uImage.*) should be phony
    targets. They just let Kbuild descend into arch/arc/boot/ and create
    files there.
    
    If a file exists in the top directory with the same name, the boot
    image will not be created.
    
    You can confirm it by the following steps:
    
      $ export CROSS_COMPILE=<your-arc-compiler-prefix>
      $ make -s ARCH=arc defconfig all   # vmlinux will be built
      $ touch uImage.gz
      $ make ARCH=arc uImage.gz
      CALL    scripts/atomic/check-atomics.sh
      CALL    scripts/checksyscalls.sh
      CHK     include/generated/compile.h
      # arch/arc/boot/uImage.gz is not created
    
    Specify the targets as PHONY to fix this.
    
    Signed-off-by: Masahiro Yamada <masahiroy@kernel.org>
    Signed-off-by: Vineet Gupta <vgupta@synopsys.com>
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit cf4592a2d740a4eb6f663290fdf77d792bb23834
Author: Masahiro Yamada <masahiroy@kernel.org>
Date:   Sun Nov 22 04:36:52 2020 +0900

    ARC: build: remove non-existing bootpImage from KBUILD_IMAGE
    
    [ Upstream commit 9836720911cfec25d3fbdead1c438bf87e0f2841 ]
    
    The deb-pkg builds for ARCH=arc fail.
    
      $ export CROSS_COMPILE=<your-arc-compiler-prefix>
      $ make -s ARCH=arc defconfig
      $ make ARCH=arc bindeb-pkg
      SORTTAB vmlinux
      SYSMAP  System.map
      MODPOST Module.symvers
      make KERNELRELEASE=5.10.0-rc4 ARCH=arc KBUILD_BUILD_VERSION=2 -f ./Makefile intdeb-pkg
      sh ./scripts/package/builddeb
      cp: cannot stat 'arch/arc/boot/bootpImage': No such file or directory
      make[4]: *** [scripts/Makefile.package:87: intdeb-pkg] Error 1
      make[3]: *** [Makefile:1527: intdeb-pkg] Error 2
      make[2]: *** [debian/rules:13: binary-arch] Error 2
      dpkg-buildpackage: error: debian/rules binary subprocess returned exit status 2
      make[1]: *** [scripts/Makefile.package:83: bindeb-pkg] Error 2
      make: *** [Makefile:1527: bindeb-pkg] Error 2
    
    The reason is obvious; arch/arc/Makefile sets $(boot)/bootpImage as
    the default image, but there is no rule to build it.
    
    Remove the meaningless KBUILD_IMAGE assignment so it will fallback
    to the default vmlinux. With this change, you can build the deb package.
    
    I removed the 'bootpImage' target as well. At best, it provides
    'make bootpImage' as an alias of 'make vmlinux', but I do not see
    much sense in doing so.
    
    Signed-off-by: Masahiro Yamada <masahiroy@kernel.org>
    Signed-off-by: Vineet Gupta <vgupta@synopsys.com>
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit ca2fc0dc1cec3860c4a997c53b39a26f2ac1f102
Author: Masahiro Yamada <masahiroy@kernel.org>
Date:   Sun Nov 22 04:36:55 2020 +0900

    ARC: build: move symlink creation to arch/arc/Makefile to avoid race
    
    [ Upstream commit c5e6ae563c802c4d828d42e134af64004db2e58c ]
    
    If you run 'make uImage uImage.gz' with the parallel option, uImage.gz
    will be created by two threads simultaneously.
    
    This is because arch/arc/Makefile does not specify the dependency
    between uImage and uImage.gz. Hence, GNU Make assumes they can be
    built in parallel. One thread descends into arch/arc/boot/ to create
    uImage, and another to create uImage.gz.
    
    Please notice the same log is displayed twice in the following steps:
    
      $ export CROSS_COMPILE=<your-arc-compiler-prefix>
      $ make -s ARCH=arc defconfig
      $ make -j$(nproc) ARCH=arc uImage uImage.gz
      [ snip ]
        LD      vmlinux
        SORTTAB vmlinux
        SYSMAP  System.map
        OBJCOPY arch/arc/boot/vmlinux.bin
        OBJCOPY arch/arc/boot/vmlinux.bin
        GZIP    arch/arc/boot/vmlinux.bin.gz
        GZIP    arch/arc/boot/vmlinux.bin.gz
        UIMAGE  arch/arc/boot/uImage.gz
        UIMAGE  arch/arc/boot/uImage.gz
      Image Name:   Linux-5.10.0-rc4-00003-g62f23044
      Created:      Sun Nov 22 02:52:26 2020
      Image Type:   ARC Linux Kernel Image (gzip compressed)
      Data Size:    2109376 Bytes = 2059.94 KiB = 2.01 MiB
      Load Address: 80000000
      Entry Point:  80004000
        Image arch/arc/boot/uImage is ready
      Image Name:   Linux-5.10.0-rc4-00003-g62f23044
      Created:      Sun Nov 22 02:52:26 2020
      Image Type:   ARC Linux Kernel Image (gzip compressed)
      Data Size:    2815455 Bytes = 2749.47 KiB = 2.69 MiB
      Load Address: 80000000
      Entry Point:  80004000
    
    This is a race between the two threads trying to write to the same file
    arch/arc/boot/uImage.gz. This is a potential problem that can generate
    a broken file.
    
    I fixed a similar problem for ARM by commit 3939f3345050 ("ARM: 8418/1:
    add boot image dependencies to not generate invalid images").
    
    I highly recommend to avoid such build rules that cause a race condition.
    
    Move the uImage rule to arch/arc/Makefile.
    
    Another strangeness is that arch/arc/boot/Makefile compares the
    timestamps between $(obj)/uImage and $(obj)/uImage.*:
    
      $(obj)/uImage: $(obj)/uImage.$(suffix-y)
              @ln -sf $(notdir $<) $@
              @echo '  Image $@ is ready'
    
    This does not work as expected since $(obj)/uImage is a symlink.
    The symlink should be created in a phony target rule.
    
    I used $(kecho) instead of echo to suppress the message
    'Image arch/arc/boot/uImage is ready' when the -s option is given.
    
    Signed-off-by: Masahiro Yamada <masahiroy@kernel.org>
    Signed-off-by: Vineet Gupta <vgupta@synopsys.com>
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit 6265a0f2410fce381a2a84f1b69992f204deecb9
Author: Masahiro Yamada <masahiroy@kernel.org>
Date:   Sun Nov 22 04:36:54 2020 +0900

    ARC: build: add boot_targets to PHONY
    
    [ Upstream commit 0cfccb3c04934cdef42ae26042139f16e805b5f7 ]
    
    The top-level boot_targets (uImage and uImage.*) should be phony
    targets. They just let Kbuild descend into arch/arc/boot/ and create
    files there.
    
    If a file exists in the top directory with the same name, the boot
    image will not be created.
    
    You can confirm it by the following steps:
    
      $ export CROSS_COMPILE=<your-arc-compiler-prefix>
      $ make -s ARCH=arc defconfig all   # vmlinux will be built
      $ touch uImage.gz
      $ make ARCH=arc uImage.gz
      CALL    scripts/atomic/check-atomics.sh
      CALL    scripts/checksyscalls.sh
      CHK     include/generated/compile.h
      # arch/arc/boot/uImage.gz is not created
    
    Specify the targets as PHONY to fix this.
    
    Signed-off-by: Masahiro Yamada <masahiroy@kernel.org>
    Signed-off-by: Vineet Gupta <vgupta@synopsys.com>
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit b9128252b9ee6de9fe960b75f76c06e86921b9e3
Author: Masahiro Yamada <masahiroy@kernel.org>
Date:   Sun Nov 22 04:36:52 2020 +0900

    ARC: build: remove non-existing bootpImage from KBUILD_IMAGE
    
    [ Upstream commit 9836720911cfec25d3fbdead1c438bf87e0f2841 ]
    
    The deb-pkg builds for ARCH=arc fail.
    
      $ export CROSS_COMPILE=<your-arc-compiler-prefix>
      $ make -s ARCH=arc defconfig
      $ make ARCH=arc bindeb-pkg
      SORTTAB vmlinux
      SYSMAP  System.map
      MODPOST Module.symvers
      make KERNELRELEASE=5.10.0-rc4 ARCH=arc KBUILD_BUILD_VERSION=2 -f ./Makefile intdeb-pkg
      sh ./scripts/package/builddeb
      cp: cannot stat 'arch/arc/boot/bootpImage': No such file or directory
      make[4]: *** [scripts/Makefile.package:87: intdeb-pkg] Error 1
      make[3]: *** [Makefile:1527: intdeb-pkg] Error 2
      make[2]: *** [debian/rules:13: binary-arch] Error 2
      dpkg-buildpackage: error: debian/rules binary subprocess returned exit status 2
      make[1]: *** [scripts/Makefile.package:83: bindeb-pkg] Error 2
      make: *** [Makefile:1527: bindeb-pkg] Error 2
    
    The reason is obvious; arch/arc/Makefile sets $(boot)/bootpImage as
    the default image, but there is no rule to build it.
    
    Remove the meaningless KBUILD_IMAGE assignment so it will fallback
    to the default vmlinux. With this change, you can build the deb package.
    
    I removed the 'bootpImage' target as well. At best, it provides
    'make bootpImage' as an alias of 'make vmlinux', but I do not see
    much sense in doing so.
    
    Signed-off-by: Masahiro Yamada <masahiroy@kernel.org>
    Signed-off-by: Vineet Gupta <vgupta@synopsys.com>
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit 14791a7216775dc8b0f7265cfdf5a2ff6d0cc51c
Author: Masahiro Yamada <masahiroy@kernel.org>
Date:   Sun Nov 22 04:36:54 2020 +0900

    ARC: build: add boot_targets to PHONY
    
    [ Upstream commit 0cfccb3c04934cdef42ae26042139f16e805b5f7 ]
    
    The top-level boot_targets (uImage and uImage.*) should be phony
    targets. They just let Kbuild descend into arch/arc/boot/ and create
    files there.
    
    If a file exists in the top directory with the same name, the boot
    image will not be created.
    
    You can confirm it by the following steps:
    
      $ export CROSS_COMPILE=<your-arc-compiler-prefix>
      $ make -s ARCH=arc defconfig all   # vmlinux will be built
      $ touch uImage.gz
      $ make ARCH=arc uImage.gz
      CALL    scripts/atomic/check-atomics.sh
      CALL    scripts/checksyscalls.sh
      CHK     include/generated/compile.h
      # arch/arc/boot/uImage.gz is not created
    
    Specify the targets as PHONY to fix this.
    
    Signed-off-by: Masahiro Yamada <masahiroy@kernel.org>
    Signed-off-by: Vineet Gupta <vgupta@synopsys.com>
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit 7d66065ef68b1d4953571d423652afaf67bb07c9
Author: Masahiro Yamada <masahiroy@kernel.org>
Date:   Sun Nov 22 04:36:52 2020 +0900

    ARC: build: remove non-existing bootpImage from KBUILD_IMAGE
    
    [ Upstream commit 9836720911cfec25d3fbdead1c438bf87e0f2841 ]
    
    The deb-pkg builds for ARCH=arc fail.
    
      $ export CROSS_COMPILE=<your-arc-compiler-prefix>
      $ make -s ARCH=arc defconfig
      $ make ARCH=arc bindeb-pkg
      SORTTAB vmlinux
      SYSMAP  System.map
      MODPOST Module.symvers
      make KERNELRELEASE=5.10.0-rc4 ARCH=arc KBUILD_BUILD_VERSION=2 -f ./Makefile intdeb-pkg
      sh ./scripts/package/builddeb
      cp: cannot stat 'arch/arc/boot/bootpImage': No such file or directory
      make[4]: *** [scripts/Makefile.package:87: intdeb-pkg] Error 1
      make[3]: *** [Makefile:1527: intdeb-pkg] Error 2
      make[2]: *** [debian/rules:13: binary-arch] Error 2
      dpkg-buildpackage: error: debian/rules binary subprocess returned exit status 2
      make[1]: *** [scripts/Makefile.package:83: bindeb-pkg] Error 2
      make: *** [Makefile:1527: bindeb-pkg] Error 2
    
    The reason is obvious; arch/arc/Makefile sets $(boot)/bootpImage as
    the default image, but there is no rule to build it.
    
    Remove the meaningless KBUILD_IMAGE assignment so it will fallback
    to the default vmlinux. With this change, you can build the deb package.
    
    I removed the 'bootpImage' target as well. At best, it provides
    'make bootpImage' as an alias of 'make vmlinux', but I do not see
    much sense in doing so.
    
    Signed-off-by: Masahiro Yamada <masahiroy@kernel.org>
    Signed-off-by: Vineet Gupta <vgupta@synopsys.com>
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit fcd04aa9b52c6749624976f5ae016a515cd2e505
Author: Arnd Bergmann <arnd@arndb.de>
Date:   Mon Dec 28 14:03:02 2020 +0200

    interconnect: qcom: fix rpmh link failures
    
    commit 512d4a26abdbd11c6ffa03032740e5ab3c62c55b upstream.
    
    When CONFIG_COMPILE_TEST is set, it is possible to build some
    of the interconnect drivers into the kernel while their dependencies
    are loadable modules, which is bad:
    
    arm-linux-gnueabi-ld: drivers/interconnect/qcom/bcm-voter.o: in function `qcom_icc_bcm_voter_commit':
    (.text+0x1f8): undefined reference to `rpmh_invalidate'
    arm-linux-gnueabi-ld: (.text+0x20c): undefined reference to `rpmh_write_batch'
    arm-linux-gnueabi-ld: (.text+0x2b0): undefined reference to `rpmh_write_batch'
    arm-linux-gnueabi-ld: (.text+0x2e8): undefined reference to `rpmh_write_batch'
    arm-linux-gnueabi-ld: drivers/interconnect/qcom/icc-rpmh.o: in function `qcom_icc_bcm_init':
    (.text+0x2ac): undefined reference to `cmd_db_read_addr'
    arm-linux-gnueabi-ld: (.text+0x2c8): undefined reference to `cmd_db_read_aux_data'
    
    The exact dependencies are a bit complicated, so split them out into a
    hidden Kconfig symbol that all drivers can in turn depend on to get it
    right.
    
    Fixes: 976daac4a1c5 ("interconnect: qcom: Consolidate interconnect RPMh support")
    Signed-off-by: Arnd Bergmann <arnd@arndb.de>
    Reviewed-by: Bjorn Andersson <bjorn.andersson@linaro.org>
    Link: https://lore.kernel.org/r/20201204165030.3747484-1-arnd@kernel.org
    Signed-off-by: Georgi Djakov <georgi.djakov@linaro.org>
    Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>

commit acda701bf1e8233f982164c8ddbedc055427212d
Merge: 9348b73c2e1b e557793799c5
Author: Linus Torvalds <torvalds@linux-foundation.org>
Date:   Sat Jan 16 11:00:08 2021 -0800

    Merge tag 'riscv-for-linus-5.11-rc4' of git://git.kernel.org/pub/scm/linux/kernel/git/riscv/linux
    
    Pull RISC-V fixes from Palmer Dabbelt:
     "There are a few more fixes than a normal rc4, largely due to the
      bubble introduced by the holiday break:
    
       - return -ENOSYS for syscall number -1, which previously returned an
         uninitialized value.
    
       - ensure of_clk_init() has been called in time_init(), without which
         clock drivers may not be initialized.
    
       - fix sifive,uart0 driver to properly display the baud rate. A fix to
         initialize MPIE that allows interrupts to be processed during
         system calls.
    
       - avoid erronously begin tracing IRQs when interrupts are disabled,
         which at least triggers suprious lockdep failures.
    
       - workaround for a warning related to calling smp_processor_id()
         while preemptible. The warning itself is suprious on currently
         availiable systems.
    
       - properly include the generic time VDSO calls. A fix to our kasan
         address mapping. A fix to the HiFive Unleashed device tree, which
         allows the Ethernet PHY to be properly initialized by Linux (as
         opposed to relying on the bootloader).
    
       - defconfig update to include SiFive's GPIO driver, which is present
         on the HiFive Unleashed and necessary to initialize the PHY.
    
       - avoid allocating memory while initializing reserved memory.
    
       - avoid allocating the last 4K of memory, as pointers there alias
         with syscall errors.
    
      There are also two cleanups that should have no functional effect but
      do fix build warnings:
    
       - drop a duplicated definition of PAGE_KERNEL_EXEC.
    
       - properly declare the asm register SP shim.
    
       - cleanup the rv32 memory size Kconfig entry, to reflect the actual
         size of memory availiable"
    
    * tag 'riscv-for-linus-5.11-rc4' of git://git.kernel.org/pub/scm/linux/kernel/git/riscv/linux:
      RISC-V: Fix maximum allowed phsyical memory for RV32
      RISC-V: Set current memblock limit
      RISC-V: Do not allocate memblock while iterating reserved memblocks
      riscv: stacktrace: Move register keyword to beginning of declaration
      riscv: defconfig: enable gpio support for HiFive Unleashed
      dts: phy: add GPIO number and active state used for phy reset
      dts: phy: fix missing mdio device and probe failure of vsc8541-01 device
      riscv: Fix KASAN memory mapping.
      riscv: Fixup CONFIG_GENERIC_TIME_VSYSCALL
      riscv: cacheinfo: Fix using smp_processor_id() in preemptible
      riscv: Trace irq on only interrupt is enabled
      riscv: Drop a duplicated PAGE_KERNEL_EXEC
      riscv: Enable interrupts during syscalls with M-Mode
      riscv: Fix sifive serial driver
      riscv: Fix kernel time_init()
      riscv: return -ENOSYS for syscall -1

commit 1777b185f5cc0c6470f429b5a3f5f2766dc62f7a
Merge: fb5cfcaa2efb 82581fcf070b
Author: Dave Airlie <airlied@redhat.com>
Date:   Fri Jan 15 15:14:33 2021 +1000

    Merge tag 'imx-drm-next-2021-01-08' of git://git.pengutronix.de/git/pza/linux into drm-next
    
    drm/imx: compile test fixes
    
    - Fix COMPILE_TEST builds with CONFIG_OF disabled.
    
    Signed-off-by: Dave Airlie <airlied@redhat.com>
    
    From: Philipp Zabel <p.zabel@pengutronix.de>
    Link: https://patchwork.freedesktop.org/patch/msgid/8c048f3677f706de306c19ecf6868c4109c1c40d.camel@pengutronix.de

commit 741b91f1b0ea34f00f6a7d4539b767c409291fcf
Author: Vincent Mailhol <mailhol.vincent@wanadoo.fr>
Date:   Tue Jan 12 18:54:37 2021 +0900

    can: dev: can_put_echo_skb(): add software tx timestamps
    
    Call skb_tx_timestamp() within can_put_echo_skb() so that a software tx
    timestamp gets attached to the skb.
    
    There two main reasons to include this call in can_put_echo_skb():
    
      * It easily allow to enable the tx timestamp on all devices with
        just one small change.
    
      * According to Documentation/networking/timestamping.rst, the tx
        timestamps should be generated in the device driver as close as possible,
        but always prior to passing the packet to the network interface. During the
        call to can_put_echo_skb(), the skb gets cloned meaning that the driver
        should not dereference the skb variable anymore after can_put_echo_skb()
        returns. This makes can_put_echo_skb() the very last place we can use the
        skb without having to access the echo_skb[] array.
    
    Remark: by default, skb_tx_timestamp() does nothing. It needs to be activated
    by passing the SOF_TIMESTAMPING_TX_SOFTWARE flag either through socket options
    or control messages.
    
    References:
    
     * Support for the error queue in CAN RAW sockets (which is needed for
       tx timestamps) was introduced in:
       https://git.kernel.org//torvalds/c/eb88531bdbfaafb827192d1fc6c5a3fcc4fadd96
    
      * Put the call to skb_tx_timestamp() just before adding it to the
        array:
        https://lore.kernel.org/r/043c3ea1-6bdd-59c0-0269-27b2b5b36cec@victronenergy.com
    
      * About Tx hardware timestamps
        https://lore.kernel.org/r/20210111171152.GB11715@hoboy.vegasvil.org
    
    Signed-off-by: Vincent Mailhol <mailhol.vincent@wanadoo.fr>
    Link: https://lore.kernel.org/r/20210112095437.6488-2-mailhol.vincent@wanadoo.fr
    Signed-off-by: Marc Kleine-Budde <mkl@pengutronix.de>

commit e6dc077b7dffdc01d9c45a5a1f4caf1e51c756a3
Author: Stafford Horne <shorne@gmail.com>
Date:   Tue Jan 12 21:29:24 2021 +0900

    soc: litex: Fix compile warning when device tree is not configured
    
    The test robot reported:
    
       drivers/soc/litex/litex_soc_ctrl.c:143:34: warning: unused variable 'litex_soc_ctrl_of_match' [-Wunused-const-variable]
       static const struct of_device_id litex_soc_ctrl_of_match[] = {
                                        ^
       1 warning generated.
    
    As per the random config device tree is not configured causing the
    litex_soc_ctrl_of_match match list to not be used.  This would usually
    mean that we cannot even use this driver as it depends on device tree,
    but as we also have COMPILE_TEST configured we allow it.
    
    Fix the warning by surrounding the unused variable with an ifdef
    CONFIG_OF.
    
    Reported-by: kernel test robot <lkp@intel.com>
    Signed-off-by: Stafford Horne <shorne@gmail.com>

commit 95652f98b1daf0c483932ee70ae00a526f205aa9
Author: akshatzen <akshatzen@google.com>
Date:   Sat Jan 9 18:08:44 2021 +0530

    scsi: pm80xx: Check main config table address
    
    The driver initializes main configuration, general status, inbound queue
    and outbound queue table addresses based on a value read from
    MSGU_SCRATCH_PAD_0 register.
    
    We should validate these addresses before dereferencing them.
    
    Adds two validations:
    
     1. Check if main configuration table offset lies within the pcibar
        mapped
    
     2. Check if first dword of main configuration table reads "PMCS"
    
    There are two calls to init_pci_device_addresses() done during
    pm8001_pci_probe() in this sequence:
    
     1. First inside chip_soft_rst, where if init_pci_device_addresses fails we
        will go ahead assuming MPI state is not ready and reset the device as
        long as bootloader is okay.  This gives chance to second call of
        init_pci_device_addresses to set up the addresses after reset.
    
     2. The second call is via pm80xx_chip_init, after soft reset is done and
        firmware is checked to be ready. Once that is done we are safe to go
        ahead and initialize default table values and use them.
    
    Tests:
    
     1. Enabled debugging logs and observed no issues during initialization,
        with a controller with no issues:
    
        pm80xx0:: pm8001_setup_msix 1034: pci_alloc_irq_vectors request ret:64 no of intr 64
        pm80xx0:: init_pci_device_addresses 917: Scratchpad 0 Offset: 0x2000 value 0x40002000
        pm80xx0:: init_pci_device_addresses 925: Scratchpad 0 PCI BAR: 0
        pm80xx0:: init_pci_device_addresses 952: VALID main config signature 0x53434d50
        pm80xx0:: init_pci_device_addresses 975: GST OFFSET 0xc4
        pm80xx0:: init_pci_device_addresses 978: INBND OFFSET 0x20000128
        pm80xx0:: init_pci_device_addresses 981: OBND OFFSET 0x24000928
        pm80xx0:: init_pci_device_addresses 984: IVT OFFSET 0x8001408
        pm80xx0:: init_pci_device_addresses 987: PSPA OFFSET 0x8001608
        pm80xx0:: init_pci_device_addresses 991: addr - main cfg (ptrval) general status (ptrval)
        pm80xx0:: init_pci_device_addresses 995: addr - inbnd (ptrval) obnd (ptrval)
        pm80xx0:: init_pci_device_addresses 999: addr - pspa (ptrval) ivt (ptrval)
        pm80xx0:: pm80xx_chip_soft_rst 1446: reset register before write : 0x0
        pm80xx0:: pm80xx_chip_soft_rst 1478: reset register after write 0x40
        pm80xx0:: pm80xx_chip_soft_rst 1544: SPCv soft reset Complete
        pm80xx0:: init_pci_device_addresses 917: Scratchpad 0 Offset: 0x2000 value 0x40002000
        pm80xx0:: init_pci_device_addresses 925: Scratchpad 0 PCI BAR: 0
        pm80xx0:: init_pci_device_addresses 952: VALID main config signature 0x53434d50
        pm80xx0:: init_pci_device_addresses 975: GST OFFSET 0xc4
        pm80xx0:: init_pci_device_addresses 978: INBND OFFSET 0x20000128
        pm80xx0:: init_pci_device_addresses 981: OBND OFFSET 0x24000928
        pm80xx0:: init_pci_device_addresses 984: IVT OFFSET 0x8001408
        pm80xx0:: init_pci_device_addresses 987: PSPA OFFSET 0x8001608
        pm80xx0:: init_pci_device_addresses 991: addr - main cfg (ptrval) general status (ptrval)
        pm80xx0:: init_pci_device_addresses 995: addr - inbnd (ptrval) obnd (ptrval)
        pm80xx0:: init_pci_device_addresses 999: addr - pspa (ptrval) ivt (ptrval)
        pm80xx0:: pm80xx_chip_init 1329: MPI initialize successful!
    
     2. Tested controller with firmware known to have initialization issue and
        observed no crashes with this fix:
    
        pm80xx 0000:01:00.0: pm80xx: driver version 0.1.38
        pm80xx 0000:01:00.0: Removing from 1:1 domain
        pm80xx 0000:01:00.0: Requesting non-1:1 mappings
        pm80xx0:: init_pci_device_addresses 948: BAD main config signature 0x0
        pm80xx0:: mpi_uninit_check 1365: Failed to init pci addresses
        pm80xx0:: pm80xx_chip_soft_rst 1435: MPI state is not ready scratch:0:8:62a01000:0
        pm80xx0:: pm80xx_chip_soft_rst 1518: Firmware is not ready!
        pm80xx0:: pm80xx_chip_soft_rst 1532: iButton Feature is not Available!!!
        pm80xx0:: pm80xx_chip_init 1301: Firmware is not ready!
        pm80xx0:: pm8001_pci_probe 1215: chip_init failed [ret: -16]
        pm80xx: probe of 0000:01:00.0 failed with error -16
        pm80xx 0000:07:00.0: pm80xx: driver version 0.1.38
        pm80xx 0000:07:00.0: Removing from 1:1 domain
        pm80xx 0000:07:00.0: Requesting non-1:1 mappings
        scsi host6: pm80xx
        pm80xx1:: pm8001_setup_sgpio 5568: failed sgpio_req timeout
        pm80xx1:: mpi_phy_start_resp 3447: phy start resp status:0x0, phyid:0x0
        pm80xx 0000:08:00.0: pm80xx: driver version 0.1.38
        pm80xx 0000:08:00.0: Removing from 1:1 domain
        pm80xx 0000:08:00.0: Requesting non-1:1 mappings
    
     3. Without this fix we observe crash on the same controller:
    
        pm80xx 0000:01:00.0: pm80xx: driver version 0.1.38
        pm80xx 0000:01:00.0: Removing from 1:1 domain
        pm80xx 0000:01:00.0: Requesting non-1:1 mappings
        [<ffffffffc0451b3b>] pm80xx_chip_soft_rst+0x6b/0x4c0 [pm80xx]
        [<ffffffffc043a933>] pm8001_pci_probe+0xa43/0x1630 [pm80xx]
        RIP: 0010:pm80xx_chip_soft_rst+0x71/0x4c0 [pm80xx]
        [<ffffffffc0451b3b>] ? pm80xx_chip_soft_rst+0x6b/0x4c0 [pm80xx]
        [<ffffffffc043a933>] pm8001_pci_probe+0xa43/0x1630 [pm80xx]
        pm80xx0:: mpi_uninit_check 1339: TIMEOUT:IBDB value/=2
        pm80xx0:: pm80xx_chip_soft_rst 1387: MPI state is not ready scratch:0:8:62a01000:0
        pm80xx0:: pm80xx_chip_soft_rst 1470: Firmware is not ready!
        pm80xx0:: pm80xx_chip_soft_rst 1484: iButton Feature is not Available!!!
        pm80xx0:: pm80xx_chip_init 1266: Firmware is not ready!
        pm80xx0:: pm8001_pci_probe 1207: chip_init failed [ret: -16]
        pm80xx: probe of 0000:01:00.0 failed with error -16
    
    Link: https://lore.kernel.org/r/20210109123849.17098-4-Viswas.G@microchip.com
    Acked-by: Jack Wang <jinpu.wang@cloud.ionos.com>
    Signed-off-by: akshatzen <akshatzen@google.com>
    Signed-off-by: Viswas G <Viswas.G@microchip.com>
    Signed-off-by: Ruksar Devadi <Ruksar.devadi@microchip.com>
    Signed-off-by: Radha Ramachandran <radha@google.com>
    Signed-off-by: Martin K. Petersen <martin.petersen@oracle.com>

commit d71023af4bec0ebccc377bb47beeb1b07e472c36
Author: akshatzen <akshatzen@google.com>
Date:   Sat Jan 9 18:08:42 2021 +0530

    scsi: pm80xx: Do not busy wait in MPI init check
    
    We do not need to busy wait during mpi_init_check() since it is not being
    invoked in atomic context. mpi_init_check() is being called from
    pm8001_pci_resume(), pm8001_pci_probe(). Hence we are replacing udelay with
    msleep.
    
    Link: https://lore.kernel.org/r/20210109123849.17098-2-Viswas.G@microchip.com
    Acked-by: Jack Wang <jinpu.wang@cloud.ionos.com>
    Signed-off-by: akshatzen <akshatzen@google.com>
    Signed-off-by: Viswas G <Viswas.G@microchip.com>
    Signed-off-by: Ruksar Devadi <Ruksar.devadi@microchip.com>
    Signed-off-by: Radha Ramachandran <radha@google.com>
    Signed-off-by: Martin K. Petersen <martin.petersen@oracle.com>

commit 46e05e1df628ab054486eafcc06a3c6512b338a1
Author: Alex Elder <elder@linaro.org>
Date:   Tue Jan 12 13:21:34 2021 -0600

    net: ipa: add config dependency on QCOM_SMEM
    
    The IPA driver depends on some SMEM functionality (qcom_smem_init(),
    qcom_smem_alloc(), and qcom_smem_virt_to_phys()), but this is not
    reflected in the configuration dependencies.  Add a dependency on
    QCOM_SMEM to avoid attempts to build the IPA driver without SMEM.
    This avoids a link error for certain configurations.
    
    Reported-by: Randy Dunlap <rdunlap@infradead.org>
    Fixes: 38a4066f593c5 ("net: ipa: support COMPILE_TEST")
    Signed-off-by: Alex Elder <elder@linaro.org>
    Acked-by: Randy Dunlap <rdunlap@infradead.org> # build-tested
    Reviewed-by: Bjorn Andersson <bjorn.andersson@linaro.org>
    Link: https://lore.kernel.org/r/20210112192134.493-1-elder@linaro.org
    Signed-off-by: Jakub Kicinski <kuba@kernel.org>

commit 73f6b7ed9835ad9f953aebd60dd720aabc487b81
Author: Arnd Bergmann <arnd@arndb.de>
Date:   Wed Dec 30 16:52:25 2020 +0100

    clk: imx: fix Kconfig warning for i.MX SCU clk
    
    A previous patch introduced a harmless randconfig warning:
    
    WARNING: unmet direct dependencies detected for MXC_CLK_SCU
      Depends on [n]: COMMON_CLK [=y] && ARCH_MXC [=n] && IMX_SCU [=y] && HAVE_ARM_SMCCC [=y]
      Selected by [m]:
      - CLK_IMX8QXP [=m] && COMMON_CLK [=y] && (ARCH_MXC [=n] && ARM64 [=y] || COMPILE_TEST [=y]) && IMX_SCU [=y] && HAVE_ARM_SMCCC [=y]
    
    Since the symbol is now hidden and only selected by other symbols,
    just remove the dependencies and require the other drivers to
    get it right.
    
    Fixes: 6247e31b7530 ("clk: imx: scu: fix MXC_CLK_SCU module build break")
    Reported-by: Anders Roxell <anders.roxell@linaro.org>
    Signed-off-by: Arnd Bergmann <arnd@arndb.de>
    Link: https://lore.kernel.org/r/20201230155244.981757-1-arnd@kernel.org
    Signed-off-by: Stephen Boyd <sboyd@kernel.org>

commit cb5a170e979e7d1b15185c9943c546bda2bc6445
Author: Nathan Chancellor <natechancellor@gmail.com>
Date:   Mon Jan 4 13:59:53 2021 -0700

    powerpc: Handle .text.{hot,unlikely}.* in linker script
    
    commit 3ce47d95b7346dcafd9bed3556a8d072cb2b8571 upstream.
    
    Commit eff8728fe698 ("vmlinux.lds.h: Add PGO and AutoFDO input
    sections") added ".text.unlikely.*" and ".text.hot.*" due to an LLVM
    change [1].
    
    After another LLVM change [2], these sections are seen in some PowerPC
    builds, where there is a orphan section warning then build failure:
    
    $ make -skj"$(nproc)" \
           ARCH=powerpc CROSS_COMPILE=powerpc64le-linux-gnu- LLVM=1 O=out \
           distclean powernv_defconfig zImage.epapr
    ld.lld: warning: kernel/built-in.a(panic.o):(.text.unlikely.) is being placed in '.text.unlikely.'
    ...
    ld.lld: warning: address (0xc000000000009314) of section .text is not a multiple of alignment (256)
    ...
    ERROR: start_text address is c000000000009400, should be c000000000008000
    ERROR: try to enable LD_HEAD_STUB_CATCH config option
    ERROR: see comments in arch/powerpc/tools/head_check.sh
    ...
    
    Explicitly handle these sections like in the main linker script so
    there is no more build failure.
    
    [1]: https://reviews.llvm.org/D79600
    [2]: https://reviews.llvm.org/D92493
    
    Fixes: 83a092cf95f2 ("powerpc: Link warning for orphan sections")
    Cc: stable@vger.kernel.org
    Signed-off-by: Nathan Chancellor <natechancellor@gmail.com>
    Signed-off-by: Michael Ellerman <mpe@ellerman.id.au>
    Link: https://github.com/ClangBuiltLinux/linux/issues/1218
    Link: https://lore.kernel.org/r/20210104205952.1399409-1-natechancellor@gmail.com
    Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>

commit c511f27e130e801e9f5e58d2865bb6f3a5ab5e7c
Author: Nathan Chancellor <natechancellor@gmail.com>
Date:   Mon Jan 4 13:59:53 2021 -0700

    powerpc: Handle .text.{hot,unlikely}.* in linker script
    
    commit 3ce47d95b7346dcafd9bed3556a8d072cb2b8571 upstream.
    
    Commit eff8728fe698 ("vmlinux.lds.h: Add PGO and AutoFDO input
    sections") added ".text.unlikely.*" and ".text.hot.*" due to an LLVM
    change [1].
    
    After another LLVM change [2], these sections are seen in some PowerPC
    builds, where there is a orphan section warning then build failure:
    
    $ make -skj"$(nproc)" \
           ARCH=powerpc CROSS_COMPILE=powerpc64le-linux-gnu- LLVM=1 O=out \
           distclean powernv_defconfig zImage.epapr
    ld.lld: warning: kernel/built-in.a(panic.o):(.text.unlikely.) is being placed in '.text.unlikely.'
    ...
    ld.lld: warning: address (0xc000000000009314) of section .text is not a multiple of alignment (256)
    ...
    ERROR: start_text address is c000000000009400, should be c000000000008000
    ERROR: try to enable LD_HEAD_STUB_CATCH config option
    ERROR: see comments in arch/powerpc/tools/head_check.sh
    ...
    
    Explicitly handle these sections like in the main linker script so
    there is no more build failure.
    
    [1]: https://reviews.llvm.org/D79600
    [2]: https://reviews.llvm.org/D92493
    
    Fixes: 83a092cf95f2 ("powerpc: Link warning for orphan sections")
    Cc: stable@vger.kernel.org
    Signed-off-by: Nathan Chancellor <natechancellor@gmail.com>
    Signed-off-by: Michael Ellerman <mpe@ellerman.id.au>
    Link: https://github.com/ClangBuiltLinux/linux/issues/1218
    Link: https://lore.kernel.org/r/20210104205952.1399409-1-natechancellor@gmail.com
    Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>

commit 3ef5e42d281ea108f4ccdca186de4ce20a346326
Author: Andy Shevchenko <andriy.shevchenko@linux.intel.com>
Date:   Mon Dec 14 16:28:32 2020 +0100

    media: ipu3-cio2: Build only for x86
    
    According to the original code in the driver it was never assumed to work
    with big page sizes: unsigned short type followed by PAGE_SHIFT and
    PAGE_MASK which may be different on non-x86 architectures.
    
    Recently LKP found an issue on non-x86 architectures due to above
    mentioned limitations. Since Sakari acknowledges that it's not really
    useful to be able to compile this elsewhere, mark it x86 only.
    
    Fixes: a31d19f88932 ("media: ipu3: allow building it with COMPILE_TEST on non-x86 archs")
    Reported-by: kernel test robot <lkp@intel.com>
    Suggested-by: Sakari Ailus <sakari.ailus@linux.intel.com>
    Signed-off-by: Andy Shevchenko <andriy.shevchenko@linux.intel.com>
    Signed-off-by: Sakari Ailus <sakari.ailus@linux.intel.com>
    Signed-off-by: Mauro Carvalho Chehab <mchehab+huawei@kernel.org>

commit 7e34984cc6f5c04166fa92005ba8759fc849c6c1
Merge: 3f5ec374ae3f 38a4066f593c
Author: Jakub Kicinski <kuba@kernel.org>
Date:   Sat Jan 9 13:51:39 2021 -0800

    Merge branch 'net-ipa-support-compile_test'
    
    Alex Elder says:
    
    ====================
    net: ipa: support COMPILE_TEST
    
    This series adds the IPA driver as a possible target when
    the COMPILE_TEST configuration is enabled.  Two small changes to
    dependent subsystems needed to be made for this to work.
    
    Version 2 of this series adds one more patch, which adds the
    declation of struct page to "gsi_trans.h".  The Intel kernel test
    robot reported that this was a problem for the alpha build.
    ====================
    
    Link: https://lore.kernel.org/r/20210107233404.17030-1-elder@linaro.org
    Signed-off-by: Jakub Kicinski <kuba@kernel.org>

commit 38a4066f593c594c3b6cca14f6df4a80e0f8f320
Author: Alex Elder <elder@linaro.org>
Date:   Thu Jan 7 17:34:04 2021 -0600

    net: ipa: support COMPILE_TEST
    
    Arrange for the IPA driver to be built when COMPILE_TEST is enabled.
    
    Update the help text to reflect that we support two Qualcomm SoCs.
    
    Suggested-by: Jakub Kicinski <kuba@kernel.org>
    Signed-off-by: Alex Elder <elder@linaro.org>
    Reviewed-by: Bjorn Andersson <bjorn.andersson@linaro.org>
    Signed-off-by: Jakub Kicinski <kuba@kernel.org>

commit ce2ceb9b1cff777c7d8beb368eddc3b8e45381f6
Author: Alex Elder <elder@linaro.org>
Date:   Thu Jan 7 17:34:02 2021 -0600

    soc: qcom: mdt_loader: define stubs for COMPILE_TEST
    
    Define stub functions for the exposed MDT functions in case
    QCOM_MDT_LOADER is not configured.  This allows users of these
    functions to link correctly for COMPILE_TEST builds without
    QCOM_SCM enabled.
    
    Reviewed-by: Bjorn Andersson <bjorn.andersson@linaro.org>
    Signed-off-by: Alex Elder <elder@linaro.org>
    Signed-off-by: Jakub Kicinski <kuba@kernel.org>

commit 994122211665301080cd232c06ae219b681dcb57
Author: Alex Elder <elder@linaro.org>
Date:   Thu Jan 7 17:34:01 2021 -0600

    remoteproc: qcom: expose types for COMPILE_TEST
    
    Stub functions are defined for SSR notifier registration in case
    QCOM_RPROC_COMMON is not configured.  As a result, code that uses
    these functions can link successfully even if the common remoteproc
    code is not built.
    
    Code that registers an SSR notifier function likely needs the
    types defined in "qcom_rproc.h", but those are only exposed if
    QCOM_RPROC_COMMON is enabled.
    
    Rearrange the conditional definition so the qcom_ssr_notify_data
    structure and qcom_ssr_notify_type enumerated type are defined
    whether or not QCOM_RPROC_COMMON is enabled.
    
    Reviewed-by: Bjorn Andersson <bjorn.andersson@linaro.org>
    Signed-off-by: Alex Elder <elder@linaro.org>
    Signed-off-by: Jakub Kicinski <kuba@kernel.org>

commit 643437b996bac9267785e0bd528332e2d5811067
Author: Damien Le Moal <damien.lemoal@wdc.com>
Date:   Sun Dec 13 22:50:36 2020 +0900

    riscv: Enable interrupts during syscalls with M-Mode
    
    When running is M-Mode (no MMU config), MPIE does not get set. This
    results in all syscalls being executed with interrupts disabled as
    handle_exception never sets SR_IE as it always sees SR_PIE being
    cleared. Fix this by always force enabling interrupts in
    handle_syscall when CONFIG_RISCV_M_MODE is enabled.
    
    Signed-off-by: Damien Le Moal <damien.lemoal@wdc.com>
    Reviewed-by: Palmer Dabbelt <palmerdabbelt@google.com>
    Signed-off-by: Palmer Dabbelt <palmerdabbelt@google.com>

commit ddb4d32ed6609ab310b947a875771c6fe187d976
Author: Florian Fainelli <f.fainelli@gmail.com>
Date:   Wed Jan 6 11:15:45 2021 -0800

    net: broadcom: Drop OF dependency from BGMAC_PLATFORM
    
    All of the OF code that is used has stubbed and will compile and link
    just fine, keeping COMPILE_TEST is enough.
    
    Signed-off-by: Florian Fainelli <f.fainelli@gmail.com>
    Acked-by: Randy Dunlap <rdunlap@infradead.org>
    Link: https://lore.kernel.org/r/20210106191546.1358324-1-f.fainelli@gmail.com
    Signed-off-by: Jakub Kicinski <kuba@kernel.org>

commit 3ce47d95b7346dcafd9bed3556a8d072cb2b8571
Author: Nathan Chancellor <natechancellor@gmail.com>
Date:   Mon Jan 4 13:59:53 2021 -0700

    powerpc: Handle .text.{hot,unlikely}.* in linker script
    
    Commit eff8728fe698 ("vmlinux.lds.h: Add PGO and AutoFDO input
    sections") added ".text.unlikely.*" and ".text.hot.*" due to an LLVM
    change [1].
    
    After another LLVM change [2], these sections are seen in some PowerPC
    builds, where there is a orphan section warning then build failure:
    
    $ make -skj"$(nproc)" \
           ARCH=powerpc CROSS_COMPILE=powerpc64le-linux-gnu- LLVM=1 O=out \
           distclean powernv_defconfig zImage.epapr
    ld.lld: warning: kernel/built-in.a(panic.o):(.text.unlikely.) is being placed in '.text.unlikely.'
    ...
    ld.lld: warning: address (0xc000000000009314) of section .text is not a multiple of alignment (256)
    ...
    ERROR: start_text address is c000000000009400, should be c000000000008000
    ERROR: try to enable LD_HEAD_STUB_CATCH config option
    ERROR: see comments in arch/powerpc/tools/head_check.sh
    ...
    
    Explicitly handle these sections like in the main linker script so
    there is no more build failure.
    
    [1]: https://reviews.llvm.org/D79600
    [2]: https://reviews.llvm.org/D92493
    
    Fixes: 83a092cf95f2 ("powerpc: Link warning for orphan sections")
    Cc: stable@vger.kernel.org
    Signed-off-by: Nathan Chancellor <natechancellor@gmail.com>
    Signed-off-by: Michael Ellerman <mpe@ellerman.id.au>
    Link: https://github.com/ClangBuiltLinux/linux/issues/1218
    Link: https://lore.kernel.org/r/20210104205952.1399409-1-natechancellor@gmail.com

commit d092bd9110494de3372722b317510b3692f1b2fe
Author: Arnd Bergmann <arnd@arndb.de>
Date:   Sun Jan 3 14:55:17 2021 +0100

    phy: mediatek: allow compile-testing the dsi phy
    
    Randconfig builds show another broken dependency:
    
    WARNING: unmet direct dependencies detected for PHY_MTK_MIPI_DSI
      Depends on [n]: ARCH_MEDIATEK [=n] && OF [=y]
      Selected by [m]:
      - DRM_MEDIATEK [=m] && HAS_IOMEM [=y] && DRM [=m] && (ARCH_MEDIATEK [=n] || ARM [=y] && COMPILE_TEST [=y]) && COMMON_CLK [=y] &&
    HAVE_ARM_SMCCC [=y] && OF [=y] && MTK_MMSYS [=y]
    
    This is similar to the hdmi driver I fixed earlier, and I guess the
    common-clk bug would sooner or later also manifest here, so just use
    the exact same solution I chose for the other driver, and hope that
    any future drivers just copy it from here.
    
    Fixes: 90f80d95992f ("phy: mediatek: Move mtk_mipi_dsi_phy driver into drivers/phy/mediatek folder")
    Fixes: f5f6e01f9164 ("phy: mediatek: allow compile-testing the hdmi phy")
    Signed-off-by: Arnd Bergmann <arnd@arndb.de>
    Link: https://lore.kernel.org/r/20210103135524.3678664-1-arnd@kernel.org
    Signed-off-by: Vinod Koul <vkoul@kernel.org>

commit 43fc2d3a4a84f111dc6284d2ad2fce12525eeb23
Author: Arnd Bergmann <arnd@arndb.de>
Date:   Thu Dec 3 23:33:42 2020 +0100

    watchdog: coh901327: add COMMON_CLK dependency
    
    [ Upstream commit 36c47df85ee8e1f8a35366ac11324f8875de00eb ]
    
    clang produces a build failure in configurations without COMMON_CLK
    when a timeout calculation goes wrong:
    
    arm-linux-gnueabi-ld: drivers/watchdog/coh901327_wdt.o: in function `coh901327_enable':
    coh901327_wdt.c:(.text+0x50): undefined reference to `__bad_udelay'
    
    Add a Kconfig dependency to only do build testing when COMMON_CLK
    is enabled.
    
    Fixes: da2a68b3eb47 ("watchdog: Enable COMPILE_TEST where possible")
    Signed-off-by: Arnd Bergmann <arnd@arndb.de>
    Reviewed-by: Guenter Roeck <linux@roeck-us.net>
    Link: https://lore.kernel.org/r/20201203223358.1269372-1-arnd@kernel.org
    Signed-off-by: Guenter Roeck <linux@roeck-us.net>
    Signed-off-by: Wim Van Sebroeck <wim@linux-watchdog.org>
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit 2d42e0354db18d2c7a3d7bb7793db04720c6d00b
Author: Guenter Roeck <linux@roeck-us.net>
Date:   Sun Nov 8 08:25:50 2020 -0800

    watchdog: sirfsoc: Add missing dependency on HAS_IOMEM
    
    [ Upstream commit 8ae2511112d2e18bc7d324b77f965d34083a25a2 ]
    
    If HAS_IOMEM is not defined and SIRFSOC_WATCHDOG is enabled,
    the build fails with the following error.
    
    drivers/watchdog/sirfsoc_wdt.o: in function `sirfsoc_wdt_probe':
    sirfsoc_wdt.c:(.text+0x112):
            undefined reference to `devm_platform_ioremap_resource'
    
    Reported-by: Necip Fazil Yildiran <fazilyildiran@gmail.com>
    Fixes: da2a68b3eb47 ("watchdog: Enable COMPILE_TEST where possible")
    Link: https://lore.kernel.org/r/20201108162550.27660-2-linux@roeck-us.net
    Signed-off-by: Guenter Roeck <linux@roeck-us.net>
    Signed-off-by: Wim Van Sebroeck <wim@linux-watchdog.org>
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit 118a8b7e4d575282e3b30d89391e48553bdbe6e3
Author: Guenter Roeck <linux@roeck-us.net>
Date:   Sun Nov 8 08:25:49 2020 -0800

    watchdog: armada_37xx: Add missing dependency on HAS_IOMEM
    
    [ Upstream commit 7f6f1dfb2dcbe5d2bfa213f2df5d74c147cd5954 ]
    
    The following kbuild warning is seen on a system without HAS_IOMEM.
    
    WARNING: unmet direct dependencies detected for MFD_SYSCON
      Depends on [n]: HAS_IOMEM [=n]
      Selected by [y]:
      - ARMADA_37XX_WATCHDOG [=y] && WATCHDOG [=y] && (ARCH_MVEBU || COMPILE_TEST
    
    This results in a subsequent compile error.
    
    drivers/watchdog/armada_37xx_wdt.o: in function `armada_37xx_wdt_probe':
    armada_37xx_wdt.c:(.text+0xdc): undefined reference to `devm_ioremap'
    
    Add the missing dependency.
    
    Reported-by: Necip Fazil Yildiran <fazilyildiran@gmail.com>
    Fixes: 54e3d9b518c8 ("watchdog: Add support for Armada 37xx CPU watchdog")
    Link: https://lore.kernel.org/r/20201108162550.27660-1-linux@roeck-us.net
    Signed-off-by: Guenter Roeck <linux@roeck-us.net>
    Signed-off-by: Wim Van Sebroeck <wim@linux-watchdog.org>
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit 01e2c27b8a30e5fc2211d28fc9133d8eca37adc8
Author: Alexandre Courbot <acourbot@chromium.org>
Date:   Mon Nov 2 16:40:07 2020 +0900

    remoteproc/mtk_scp: surround DT device IDs with CONFIG_OF
    
    [ Upstream commit e59aef4edc45133ccb10b8e962cb74dcf1e3240b ]
    
    Now that this driver can be compiled with COMPILE_TEST, we have no
    guarantee that CONFIG_OF will also be defined. When that happens, a
    warning about mtk_scp_of_match being defined but unused will be reported
    so make sure this variable is only defined if of_match_ptr() actually
    uses it.
    
    Fixes: cbd2dca74926c0e4610c40923cc786b732c9e8ef remoteproc: scp: add COMPILE_TEST dependency
    Reported-by: kernel test robot <lkp@intel.com>
    Signed-off-by: Alexandre Courbot <acourbot@chromium.org>
    Link: https://lore.kernel.org/r/20201102074007.299222-1-acourbot@chromium.org
    Signed-off-by: Bjorn Andersson <bjorn.andersson@linaro.org>
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit d806ffec27b1786d453e84fdddc647219941f103
Author: Arnd Bergmann <arnd@arndb.de>
Date:   Thu Dec 3 23:53:32 2020 +0100

    cpufreq: imx: fix NVMEM_IMX_OCOTP dependency
    
    [ Upstream commit fc928b901dc68481ba3e524860a641fe13e25dfe ]
    
    A driver should not 'select' drivers from another subsystem.
    If NVMEM is disabled, this one results in a warning:
    
    WARNING: unmet direct dependencies detected for NVMEM_IMX_OCOTP
      Depends on [n]: NVMEM [=n] && (ARCH_MXC [=y] || COMPILE_TEST [=y]) && HAS_IOMEM [=y]
      Selected by [y]:
      - ARM_IMX6Q_CPUFREQ [=y] && CPU_FREQ [=y] && (ARM || ARM64 [=y]) && ARCH_MXC [=y] && REGULATOR_ANATOP [=y]
    
    Change the 'select' to 'depends on' to prevent it from going wrong,
    and allow compile-testing without that driver, since it is only
    a runtime dependency.
    
    Fixes: 2782ef34ed23 ("cpufreq: imx: Select NVMEM_IMX_OCOTP")
    Signed-off-by: Arnd Bergmann <arnd@arndb.de>
    Signed-off-by: Viresh Kumar <viresh.kumar@linaro.org>
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit 5acad354237daf59e3d418c7cf51db620b64ba09
Author: Arnd Bergmann <arnd@arndb.de>
Date:   Fri Dec 4 00:13:38 2020 +0100

    drm/msm: add IOMMU_SUPPORT dependency
    
    [ Upstream commit e319a1b956f785f618611857cd946dca2bb68542 ]
    
    The iommu pgtable support is only available when IOMMU support
    is built into the kernel:
    
    WARNING: unmet direct dependencies detected for IOMMU_IO_PGTABLE
      Depends on [n]: IOMMU_SUPPORT [=n]
      Selected by [y]:
      - DRM_MSM [=y] && HAS_IOMEM [=y] && DRM [=y] && (ARCH_QCOM [=y] || SOC_IMX5 || ARM && COMPILE_TEST [=y]) && OF [=y] && COMMON_CLK [=y] && MMU [=y] && (QCOM_OCMEM [=y] || QCOM_OCMEM [=y]=n)
    
    Fix the dependency accordingly. There is no need for depending on
    CONFIG_MMU any more, as that is implied by the iommu support.
    
    Fixes: b145c6e65eb0 ("drm/msm: Add support to create a local pagetable")
    Signed-off-by: Arnd Bergmann <arnd@arndb.de>
    Signed-off-by: Rob Clark <robdclark@chromium.org>
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit 8178c539e4dff95bc38626f795f04e9f75f83a88
Author: Arnd Bergmann <arnd@arndb.de>
Date:   Fri Dec 4 14:56:43 2020 +0100

    phy: mediatek: allow compile-testing the hdmi phy
    
    [ Upstream commit f5f6e01f9164040ba120f30522efdb4deceb529a ]
    
    Compile-testing the DRM_MEDIATEK_HDMI driver shows two missing
    dependencies, one results in a link failure:
    
    arm-linux-gnueabi-ld: drivers/phy/mediatek/phy-mtk-hdmi.o: in function `mtk_hdmi_phy_probe':
    phy-mtk-hdmi.c:(.text+0xd8): undefined reference to `__clk_get_name'
    arm-linux-gnueabi-ld: phy-mtk-hdmi.c:(.text+0x12c): undefined reference to `devm_clk_register'
    arm-linux-gnueabi-ld: phy-mtk-hdmi.c:(.text+0x250): undefined reference to `of_clk_add_provider'
    arm-linux-gnueabi-ld: phy-mtk-hdmi.c:(.text+0x298): undefined reference to `of_clk_src_simple_get'
    
    The other one is a harmless warning:
    
    WARNING: unmet direct dependencies detected for PHY_MTK_HDMI
      Depends on [n]: ARCH_MEDIATEK [=n] && OF [=y]
      Selected by [y]:
      - DRM_MEDIATEK_HDMI [=y] && HAS_IOMEM [=y] && DRM_MEDIATEK [=y]
    
    Fix these by adding dependencies on CONFIG_OF and CONFIG_COMMON_CLK.
    With that done, there is also no reason against adding
    CONFIG_COMPILE_TEST.
    
    Fixes: b28be59a2e26 ("phy: mediatek: Move mtk_hdmi_phy driver into drivers/phy/mediatek folder")
    Signed-off-by: Arnd Bergmann <arnd@arndb.de>
    Link: https://lore.kernel.org/r/20201204135650.2744481-1-arnd@kernel.org
    Signed-off-by: Vinod Koul <vkoul@kernel.org>
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit 7a5333fb175b1eda63f0f114f18ad1237d42f4c1
Author: Jerome Brunet <jbrunet@baylibre.com>
Date:   Mon Nov 16 18:24:23 2020 +0100

    ASoC: meson: fix COMPILE_TEST error
    
    [ Upstream commit 299fe9937dbd1a4d9a1da6a2b6f222298534ca57 ]
    
    When compiled with CONFIG_HAVE_CLK, the kernel need to get provider for the
    clock API. This is usually selected by the platform and the sound drivers
    should not really care about this. However COMPILE_TEST is special and the
    platform required may not have been selected, leading to this type of
    error:
    
    > aiu-encoder-spdif.c:(.text+0x3a0): undefined reference to `clk_set_parent'
    
    Since we need a sane provider of the API with COMPILE_TEST, depends on
    COMMON_CLK.
    
    Fixes: 6dc4fa179fb8 ("ASoC: meson: add axg fifo base driver")
    Reported-by: kernel test robot <lkp@intel.com>
    Signed-off-by: Jerome Brunet <jbrunet@baylibre.com>
    Link: https://lore.kernel.org/r/20201116172423.546855-1-jbrunet@baylibre.com
    Signed-off-by: Mark Brown <broonie@kernel.org>
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit cc797be0e38cbadd62b58e7d8164ee6aed32d91f
Author: Randy Dunlap <rdunlap@infradead.org>
Date:   Sun Oct 11 16:01:31 2020 -0700

    drm/aspeed: Fix Kconfig warning & subsequent build errors
    
    [ Upstream commit bf296b35489b46780b73b74ad984d06750ed5479 ]
    
    Kernel test robot reported build errors (undefined references)
    that didn't make much sense. After reproducing them, there is also
    a Kconfig warning that is the root cause of the build errors, so
    fix that Kconfig problem.
    
    Fixes this Kconfig warning:
    WARNING: unmet direct dependencies detected for CMA
      Depends on [n]: MMU [=n]
      Selected by [m]:
      - DRM_ASPEED_GFX [=m] && HAS_IOMEM [=y] && DRM [=m] && OF [=y] && (COMPILE_TEST [=y] || ARCH_ASPEED) && HAVE_DMA_CONTIGUOUS [=y]
    
    and these dependent build errors:
    (.text+0x10c8c): undefined reference to `start_isolate_page_range'
    microblaze-linux-ld: (.text+0x10f14): undefined reference to `test_pages_isolated'
    microblaze-linux-ld: (.text+0x10fd0): undefined reference to `undo_isolate_page_range'
    
    Fixes: 76356a966e33 ("drm: aspeed: Clean up Kconfig options")
    Reported-by: kernel test robot <lkp@intel.com>
    Signed-off-by: Randy Dunlap <rdunlap@infradead.org>
    Reviewed-by: Joel Stanley <joel@jms.id.au>
    Cc: Joel Stanley <joel@jms.id.au>
    Cc: Andrew Jeffery <andrew@aj.id.au>
    Cc: Daniel Vetter <daniel.vetter@ffwll.ch>
    Cc: Michal Simek <monstr@monstr.eu>
    Cc: Andrew Morton <akpm@linux-foundation.org>
    Cc: Mike Rapoport <rppt@linux.ibm.com>
    Cc: linux-mm@kvack.org
    Cc: linux-aspeed@lists.ozlabs.org
    Cc: linux-arm-kernel@lists.infradead.org
    Cc: David Airlie <airlied@linux.ie>
    Cc: dri-devel@lists.freedesktop.org
    Signed-off-by: Joel Stanley <joel@jms.id.au>
    Link: https://patchwork.freedesktop.org/patch/msgid/20201011230131.4922-1-rdunlap@infradead.org
    Signed-off-by: Joel Stanley <joel@jms.id.au>
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit e8c27b95869d72af9db579414b77730d93352c8c
Author: Alexandru Ardelean <alexandru.ardelean@analog.com>
Date:   Wed Sep 30 16:50:47 2020 +0300

    iio: adc: at91_adc: add Kconfig dep on the OF symbol and remove of_match_ptr()
    
    [ Upstream commit f091d7c5fe6cc39e916b50f90e3cac67a032d0be ]
    
    This tries to solve a warning reported by the lkp bot:
    
    >> drivers/iio/adc/at91_adc.c:1439:34: warning: unused variable
    >> 'at91_adc_dt_ids' [-Wunused-const-variable]
       static const struct of_device_id at91_adc_dt_ids[] = {
                                        ^
       1 warning generated.
    
    This warning has appeared after the AT91_ADC driver compilation has been
    enabled via the COMPILE_TEST symbol dependency.
    
    The warning is caused by the 'of_match_ptr()' helper which returns NULL if
    OF is undefined. This driver should build only for device-tree context, so
    a dependency on the OF Kconfig symbol has been added.
    Also, the usage of of_match_ptr() helper has been removed since it
    shouldn't ever return NULL (because the driver should not be built for the
    non-OF context).
    
    Fixes: 4027860dcc4c ("iio: Kconfig: at91_adc: add COMPILE_TEST dependency to driver")
    Reported-by: kernel test robot <lkp@intel.com>
    Signed-off-by: Alexandru Ardelean <alexandru.ardelean@analog.com>
    Reviewed-by: Alexandre Belloni <alexandre.belloni@bootlin.com>
    Link: https://lore.kernel.org/r/20200930135048.11530-4-alexandru.ardelean@analog.com
    Signed-off-by: Jonathan Cameron <Jonathan.Cameron@huawei.com>
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit 572eba1ce574bf72153bec7858028b8473d9d3ac
Author: Arnd Bergmann <arnd@arndb.de>
Date:   Thu Dec 3 23:33:42 2020 +0100

    watchdog: coh901327: add COMMON_CLK dependency
    
    [ Upstream commit 36c47df85ee8e1f8a35366ac11324f8875de00eb ]
    
    clang produces a build failure in configurations without COMMON_CLK
    when a timeout calculation goes wrong:
    
    arm-linux-gnueabi-ld: drivers/watchdog/coh901327_wdt.o: in function `coh901327_enable':
    coh901327_wdt.c:(.text+0x50): undefined reference to `__bad_udelay'
    
    Add a Kconfig dependency to only do build testing when COMMON_CLK
    is enabled.
    
    Fixes: da2a68b3eb47 ("watchdog: Enable COMPILE_TEST where possible")
    Signed-off-by: Arnd Bergmann <arnd@arndb.de>
    Reviewed-by: Guenter Roeck <linux@roeck-us.net>
    Link: https://lore.kernel.org/r/20201203223358.1269372-1-arnd@kernel.org
    Signed-off-by: Guenter Roeck <linux@roeck-us.net>
    Signed-off-by: Wim Van Sebroeck <wim@linux-watchdog.org>
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit 4a4b31e8b5a73fd5e0527d929f66ee83005b77ad
Author: Guenter Roeck <linux@roeck-us.net>
Date:   Sun Nov 8 08:25:50 2020 -0800

    watchdog: sirfsoc: Add missing dependency on HAS_IOMEM
    
    [ Upstream commit 8ae2511112d2e18bc7d324b77f965d34083a25a2 ]
    
    If HAS_IOMEM is not defined and SIRFSOC_WATCHDOG is enabled,
    the build fails with the following error.
    
    drivers/watchdog/sirfsoc_wdt.o: in function `sirfsoc_wdt_probe':
    sirfsoc_wdt.c:(.text+0x112):
            undefined reference to `devm_platform_ioremap_resource'
    
    Reported-by: Necip Fazil Yildiran <fazilyildiran@gmail.com>
    Fixes: da2a68b3eb47 ("watchdog: Enable COMPILE_TEST where possible")
    Link: https://lore.kernel.org/r/20201108162550.27660-2-linux@roeck-us.net
    Signed-off-by: Guenter Roeck <linux@roeck-us.net>
    Signed-off-by: Wim Van Sebroeck <wim@linux-watchdog.org>
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit 4d5aea30c1cdb76f9a37555842c7399129f52632
Author: Guenter Roeck <linux@roeck-us.net>
Date:   Sun Nov 8 08:25:49 2020 -0800

    watchdog: armada_37xx: Add missing dependency on HAS_IOMEM
    
    [ Upstream commit 7f6f1dfb2dcbe5d2bfa213f2df5d74c147cd5954 ]
    
    The following kbuild warning is seen on a system without HAS_IOMEM.
    
    WARNING: unmet direct dependencies detected for MFD_SYSCON
      Depends on [n]: HAS_IOMEM [=n]
      Selected by [y]:
      - ARMADA_37XX_WATCHDOG [=y] && WATCHDOG [=y] && (ARCH_MVEBU || COMPILE_TEST
    
    This results in a subsequent compile error.
    
    drivers/watchdog/armada_37xx_wdt.o: in function `armada_37xx_wdt_probe':
    armada_37xx_wdt.c:(.text+0xdc): undefined reference to `devm_ioremap'
    
    Add the missing dependency.
    
    Reported-by: Necip Fazil Yildiran <fazilyildiran@gmail.com>
    Fixes: 54e3d9b518c8 ("watchdog: Add support for Armada 37xx CPU watchdog")
    Link: https://lore.kernel.org/r/20201108162550.27660-1-linux@roeck-us.net
    Signed-off-by: Guenter Roeck <linux@roeck-us.net>
    Signed-off-by: Wim Van Sebroeck <wim@linux-watchdog.org>
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit efb57c87d8d81bc86ff46ef300096831dccba7ad
Author: Jerome Brunet <jbrunet@baylibre.com>
Date:   Mon Nov 16 18:24:23 2020 +0100

    ASoC: meson: fix COMPILE_TEST error
    
    [ Upstream commit 299fe9937dbd1a4d9a1da6a2b6f222298534ca57 ]
    
    When compiled with CONFIG_HAVE_CLK, the kernel need to get provider for the
    clock API. This is usually selected by the platform and the sound drivers
    should not really care about this. However COMPILE_TEST is special and the
    platform required may not have been selected, leading to this type of
    error:
    
    > aiu-encoder-spdif.c:(.text+0x3a0): undefined reference to `clk_set_parent'
    
    Since we need a sane provider of the API with COMPILE_TEST, depends on
    COMMON_CLK.
    
    Fixes: 6dc4fa179fb8 ("ASoC: meson: add axg fifo base driver")
    Reported-by: kernel test robot <lkp@intel.com>
    Signed-off-by: Jerome Brunet <jbrunet@baylibre.com>
    Link: https://lore.kernel.org/r/20201116172423.546855-1-jbrunet@baylibre.com
    Signed-off-by: Mark Brown <broonie@kernel.org>
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit 29f34feb3860c1f93a20daa8e787acd5ba2cfa98
Author: Randy Dunlap <rdunlap@infradead.org>
Date:   Sun Oct 11 16:01:31 2020 -0700

    drm/aspeed: Fix Kconfig warning & subsequent build errors
    
    [ Upstream commit bf296b35489b46780b73b74ad984d06750ed5479 ]
    
    Kernel test robot reported build errors (undefined references)
    that didn't make much sense. After reproducing them, there is also
    a Kconfig warning that is the root cause of the build errors, so
    fix that Kconfig problem.
    
    Fixes this Kconfig warning:
    WARNING: unmet direct dependencies detected for CMA
      Depends on [n]: MMU [=n]
      Selected by [m]:
      - DRM_ASPEED_GFX [=m] && HAS_IOMEM [=y] && DRM [=m] && OF [=y] && (COMPILE_TEST [=y] || ARCH_ASPEED) && HAVE_DMA_CONTIGUOUS [=y]
    
    and these dependent build errors:
    (.text+0x10c8c): undefined reference to `start_isolate_page_range'
    microblaze-linux-ld: (.text+0x10f14): undefined reference to `test_pages_isolated'
    microblaze-linux-ld: (.text+0x10fd0): undefined reference to `undo_isolate_page_range'
    
    Fixes: 76356a966e33 ("drm: aspeed: Clean up Kconfig options")
    Reported-by: kernel test robot <lkp@intel.com>
    Signed-off-by: Randy Dunlap <rdunlap@infradead.org>
    Reviewed-by: Joel Stanley <joel@jms.id.au>
    Cc: Joel Stanley <joel@jms.id.au>
    Cc: Andrew Jeffery <andrew@aj.id.au>
    Cc: Daniel Vetter <daniel.vetter@ffwll.ch>
    Cc: Michal Simek <monstr@monstr.eu>
    Cc: Andrew Morton <akpm@linux-foundation.org>
    Cc: Mike Rapoport <rppt@linux.ibm.com>
    Cc: linux-mm@kvack.org
    Cc: linux-aspeed@lists.ozlabs.org
    Cc: linux-arm-kernel@lists.infradead.org
    Cc: David Airlie <airlied@linux.ie>
    Cc: dri-devel@lists.freedesktop.org
    Signed-off-by: Joel Stanley <joel@jms.id.au>
    Link: https://patchwork.freedesktop.org/patch/msgid/20201011230131.4922-1-rdunlap@infradead.org
    Signed-off-by: Joel Stanley <joel@jms.id.au>
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit 18a78798b29cdb4ef7ef0abbdfbe469404da947b
Author: Arnd Bergmann <arnd@arndb.de>
Date:   Thu Dec 3 23:33:42 2020 +0100

    watchdog: coh901327: add COMMON_CLK dependency
    
    [ Upstream commit 36c47df85ee8e1f8a35366ac11324f8875de00eb ]
    
    clang produces a build failure in configurations without COMMON_CLK
    when a timeout calculation goes wrong:
    
    arm-linux-gnueabi-ld: drivers/watchdog/coh901327_wdt.o: in function `coh901327_enable':
    coh901327_wdt.c:(.text+0x50): undefined reference to `__bad_udelay'
    
    Add a Kconfig dependency to only do build testing when COMMON_CLK
    is enabled.
    
    Fixes: da2a68b3eb47 ("watchdog: Enable COMPILE_TEST where possible")
    Signed-off-by: Arnd Bergmann <arnd@arndb.de>
    Reviewed-by: Guenter Roeck <linux@roeck-us.net>
    Link: https://lore.kernel.org/r/20201203223358.1269372-1-arnd@kernel.org
    Signed-off-by: Guenter Roeck <linux@roeck-us.net>
    Signed-off-by: Wim Van Sebroeck <wim@linux-watchdog.org>
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit f85922a3e6bae5aa1446be9f02f87bb0e98f5e4b
Author: Guenter Roeck <linux@roeck-us.net>
Date:   Sun Nov 8 08:25:50 2020 -0800

    watchdog: sirfsoc: Add missing dependency on HAS_IOMEM
    
    [ Upstream commit 8ae2511112d2e18bc7d324b77f965d34083a25a2 ]
    
    If HAS_IOMEM is not defined and SIRFSOC_WATCHDOG is enabled,
    the build fails with the following error.
    
    drivers/watchdog/sirfsoc_wdt.o: in function `sirfsoc_wdt_probe':
    sirfsoc_wdt.c:(.text+0x112):
            undefined reference to `devm_platform_ioremap_resource'
    
    Reported-by: Necip Fazil Yildiran <fazilyildiran@gmail.com>
    Fixes: da2a68b3eb47 ("watchdog: Enable COMPILE_TEST where possible")
    Link: https://lore.kernel.org/r/20201108162550.27660-2-linux@roeck-us.net
    Signed-off-by: Guenter Roeck <linux@roeck-us.net>
    Signed-off-by: Wim Van Sebroeck <wim@linux-watchdog.org>
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit 48222d98be9b58513c2cb8f2c49c808449fbe113
Author: Jerome Brunet <jbrunet@baylibre.com>
Date:   Mon Nov 16 18:24:23 2020 +0100

    ASoC: meson: fix COMPILE_TEST error
    
    [ Upstream commit 299fe9937dbd1a4d9a1da6a2b6f222298534ca57 ]
    
    When compiled with CONFIG_HAVE_CLK, the kernel need to get provider for the
    clock API. This is usually selected by the platform and the sound drivers
    should not really care about this. However COMPILE_TEST is special and the
    platform required may not have been selected, leading to this type of
    error:
    
    > aiu-encoder-spdif.c:(.text+0x3a0): undefined reference to `clk_set_parent'
    
    Since we need a sane provider of the API with COMPILE_TEST, depends on
    COMMON_CLK.
    
    Fixes: 6dc4fa179fb8 ("ASoC: meson: add axg fifo base driver")
    Reported-by: kernel test robot <lkp@intel.com>
    Signed-off-by: Jerome Brunet <jbrunet@baylibre.com>
    Link: https://lore.kernel.org/r/20201116172423.546855-1-jbrunet@baylibre.com
    Signed-off-by: Mark Brown <broonie@kernel.org>
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit 06995f950e2713ec4b428371030893aa638bb278
Author: Arnd Bergmann <arnd@arndb.de>
Date:   Thu Dec 3 23:33:42 2020 +0100

    watchdog: coh901327: add COMMON_CLK dependency
    
    [ Upstream commit 36c47df85ee8e1f8a35366ac11324f8875de00eb ]
    
    clang produces a build failure in configurations without COMMON_CLK
    when a timeout calculation goes wrong:
    
    arm-linux-gnueabi-ld: drivers/watchdog/coh901327_wdt.o: in function `coh901327_enable':
    coh901327_wdt.c:(.text+0x50): undefined reference to `__bad_udelay'
    
    Add a Kconfig dependency to only do build testing when COMMON_CLK
    is enabled.
    
    Fixes: da2a68b3eb47 ("watchdog: Enable COMPILE_TEST where possible")
    Signed-off-by: Arnd Bergmann <arnd@arndb.de>
    Reviewed-by: Guenter Roeck <linux@roeck-us.net>
    Link: https://lore.kernel.org/r/20201203223358.1269372-1-arnd@kernel.org
    Signed-off-by: Guenter Roeck <linux@roeck-us.net>
    Signed-off-by: Wim Van Sebroeck <wim@linux-watchdog.org>
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit ba4231d5acf213e3769eff504c237ef2f9b2a5fa
Author: Guenter Roeck <linux@roeck-us.net>
Date:   Sun Nov 8 08:25:50 2020 -0800

    watchdog: sirfsoc: Add missing dependency on HAS_IOMEM
    
    [ Upstream commit 8ae2511112d2e18bc7d324b77f965d34083a25a2 ]
    
    If HAS_IOMEM is not defined and SIRFSOC_WATCHDOG is enabled,
    the build fails with the following error.
    
    drivers/watchdog/sirfsoc_wdt.o: in function `sirfsoc_wdt_probe':
    sirfsoc_wdt.c:(.text+0x112):
            undefined reference to `devm_platform_ioremap_resource'
    
    Reported-by: Necip Fazil Yildiran <fazilyildiran@gmail.com>
    Fixes: da2a68b3eb47 ("watchdog: Enable COMPILE_TEST where possible")
    Link: https://lore.kernel.org/r/20201108162550.27660-2-linux@roeck-us.net
    Signed-off-by: Guenter Roeck <linux@roeck-us.net>
    Signed-off-by: Wim Van Sebroeck <wim@linux-watchdog.org>
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit 512d4a26abdbd11c6ffa03032740e5ab3c62c55b
Author: Arnd Bergmann <arnd@arndb.de>
Date:   Mon Dec 28 14:03:02 2020 +0200

    interconnect: qcom: fix rpmh link failures
    
    When CONFIG_COMPILE_TEST is set, it is possible to build some
    of the interconnect drivers into the kernel while their dependencies
    are loadable modules, which is bad:
    
    arm-linux-gnueabi-ld: drivers/interconnect/qcom/bcm-voter.o: in function `qcom_icc_bcm_voter_commit':
    (.text+0x1f8): undefined reference to `rpmh_invalidate'
    arm-linux-gnueabi-ld: (.text+0x20c): undefined reference to `rpmh_write_batch'
    arm-linux-gnueabi-ld: (.text+0x2b0): undefined reference to `rpmh_write_batch'
    arm-linux-gnueabi-ld: (.text+0x2e8): undefined reference to `rpmh_write_batch'
    arm-linux-gnueabi-ld: drivers/interconnect/qcom/icc-rpmh.o: in function `qcom_icc_bcm_init':
    (.text+0x2ac): undefined reference to `cmd_db_read_addr'
    arm-linux-gnueabi-ld: (.text+0x2c8): undefined reference to `cmd_db_read_aux_data'
    
    The exact dependencies are a bit complicated, so split them out into a
    hidden Kconfig symbol that all drivers can in turn depend on to get it
    right.
    
    Fixes: 976daac4a1c5 ("interconnect: qcom: Consolidate interconnect RPMh support")
    Signed-off-by: Arnd Bergmann <arnd@arndb.de>
    Reviewed-by: Bjorn Andersson <bjorn.andersson@linaro.org>
    Link: https://lore.kernel.org/r/20201204165030.3747484-1-arnd@kernel.org
    Signed-off-by: Georgi Djakov <georgi.djakov@linaro.org>

commit 7b95f0563ab5a8f75195cdd4b2c3325c0c1df319
Merge: 1375b9803e00 18084e435ff6
Author: Linus Torvalds <torvalds@linux-foundation.org>
Date:   Tue Dec 22 14:02:39 2020 -0800

    Merge tag 'kbuild-v5.11' of git://git.kernel.org/pub/scm/linux/kernel/git/masahiroy/linux-kbuild
    
    Pull Kbuild updates from Masahiro Yamada:
    
     - Use /usr/bin/env for shebang lines in scripts
    
     - Remove useless -Wnested-externs warning flag
    
     - Update documents
    
     - Refactor log handling in modpost
    
     - Stop building modules without MODULE_LICENSE() tag
    
     - Make the insane combination of 'static' and EXPORT_SYMBOL an error
    
     - Improve genksyms to handle _Static_assert()
    
    * tag 'kbuild-v5.11' of git://git.kernel.org/pub/scm/linux/kernel/git/masahiroy/linux-kbuild:
      Documentation/kbuild: Document platform dependency practises
      Documentation/kbuild: Document COMPILE_TEST dependencies
      genksyms: Ignore module scoped _Static_assert()
      modpost: turn static exports into error
      modpost: turn section mismatches to error from fatal()
      modpost: change license incompatibility to error() from fatal()
      modpost: turn missing MODULE_LICENSE() into error
      modpost: refactor error handling and clarify error/fatal difference
      modpost: rename merror() to error()
      kbuild: don't hardcode depmod path
      kbuild: doc: document subdir-y syntax
      kbuild: doc: clarify the difference between extra-y and always-y
      kbuild: doc: split if_changed explanation to a separate section
      kbuild: doc: merge 'Special Rules' and 'Custom kbuild commands' sections
      kbuild: doc: fix 'List directories to visit when descending' section
      kbuild: doc: replace arch/$(ARCH)/ with arch/$(SRCARCH)/
      kbuild: doc: update the description about kbuild Makefiles
      Makefile.extrawarn: remove -Wnested-externs warning
      tweewide: Fix most Shebang lines

commit 0cda9bc15dfc459bd178d6ba93389df52dd57957
Author: Nathan Chancellor <natechancellor@gmail.com>
Date:   Tue Dec 8 01:34:16 2020 +0100

    ARM: 9038/1: Link with '-z norelro'
    
    When linking a multi_v7_defconfig + CONFIG_KASAN=y kernel with
    LD=ld.lld, the following error occurs:
    
    $ make ARCH=arm CROSS_COMPILE=arm-linux-gnueabi- LLVM=1 zImage
    ld.lld: error: section: .exit.data is not contiguous with other relro sections
    
    LLD defaults to '-z relro', which is unneeded for the kernel because
    program headers are not used nor is there any position independent code
    generation or linking for ARM. Add '-z norelro' to LDFLAGS_vmlinux to
    avoid this error.
    
    Link: https://github.com/ClangBuiltLinux/linux/issues/1189
    
    Reviewed-by: Nick Desaulniers <ndesaulniers@google.com>
    Tested-by: Nick Desaulniers <ndesaulniers@google.com>
    Signed-off-by: Nathan Chancellor <natechancellor@gmail.com>
    Signed-off-by: Russell King <rmk+kernel@armlinux.org.uk>

commit c613583b6a87434123fc6714acbec6522859185e
Author: Geert Uytterhoeven <geert+renesas@glider.be>
Date:   Tue Dec 8 16:28:56 2020 +0100

    Documentation/kbuild: Document COMPILE_TEST dependencies
    
    Document best practises for using COMPILE_TEST dependencies.
    
    Signed-off-by: Geert Uytterhoeven <geert+renesas@glider.be>
    Acked-by: Arnd Bergmann <arnd@arndb.de>
    Signed-off-by: Masahiro Yamada <masahiroy@kernel.org>

commit f4a2f7866faaf89ea1595b136e01fcb336b46aab
Merge: 7703f46f2caf 71ac13457d9d
Author: Linus Torvalds <torvalds@linux-foundation.org>
Date:   Sun Dec 20 10:12:06 2020 -0800

    Merge tag 'rtc-5.11' of git://git.kernel.org/pub/scm/linux/kernel/git/abelloni/linux
    
    Pull RTC updates from Alexandre Belloni:
     "Subsystem:
    
       - Remove nvram ABI. There was no complaints about the deprecation for
         the last 3 years.
    
       - Improve RTC device allocation and registration
    
       - Now available for ARCH=um
    
      Drivers:
    
       - at91rm9200: correction and sam9x60 support
    
       - ds1307: improve ACPI support
    
       - mxc: now DT only
    
       - pcf2127: watchdog support now needs the reset-source property
    
       - pcf8523: set range
    
       - rx6110: i2c support"
    
    * tag 'rtc-5.11' of git://git.kernel.org/pub/scm/linux/kernel/git/abelloni/linux: (43 commits)
      rtc: pcf2127: only use watchdog when explicitly available
      dt-bindings: rtc: add reset-source property
      rtc: fix RTC removal
      rtc: s3c: Remove dead code related to periodic tick handling
      rtc: s3c: Disable all enable (RTC, tick) bits in the probe
      rtc: ep93xx: Fix NULL pointer dereference in ep93xx_rtc_read_time
      rtc: test: remove debug message
      rtc: mxc{,_v2}: enable COMPILE_TEST
      rtc: enable RTC framework on ARCH=um
      rtc: pcf8523: use BIT
      rtc: pcf8523: set range
      rtc: pcf8523: switch to devm_rtc_allocate_device
      rtc: destroy mutex when releasing the device
      rtc: shrink devm_rtc_allocate_device()
      rtc: rework rtc_register_device() resource management
      rtc: nvmem: emit an error message when nvmem registration fails
      rtc: add devm_ prefix to rtc_nvmem_register()
      rtc: nvmem: remove nvram ABI
      Documentation: list RTC devres helpers in devres.rst
      rtc: omap: use devm_pinctrl_register()
      ...

commit d56154c7e8ba090126a5a2cb76098628bc2216a2
Merge: 1db98bcf56b1 6eefb79d6f5b
Author: Linus Torvalds <torvalds@linux-foundation.org>
Date:   Sat Dec 19 11:51:32 2020 -0800

    Merge tag 'pwm/for-5.11-rc1' of git://git.kernel.org/pub/scm/linux/kernel/git/thierry.reding/linux-pwm
    
    Pull pwm updates from Thierry Reding:
     "This is a fairly big release cycle from the PWM framework's point of
      view.
    
      There's a large patcheset here which converts drivers to use the new
      devm_platform_ioremap_resource() helper and a bunch of minor fixes to
      existing drivers. Some of the existing drivers also add support for
      more hardware, such as Atmel SAMA 5D2 and Mediatek MT8183.
    
      Finally there's a couple of new drivers for Intel Keem Bay and LGM
      SoCs as well as the DesignWare PWM controller"
    
    * tag 'pwm/for-5.11-rc1' of git://git.kernel.org/pub/scm/linux/kernel/git/thierry.reding/linux-pwm: (66 commits)
      pwm: sun4i: Remove erroneous else branch
      pwm: sl28cpld: Set driver data before registering the PWM chip
      pwm: Remove unused function pwmchip_add_inversed()
      pwm: imx27: Fix overflow for bigger periods
      pwm: bcm2835: Support apply function for atomic configuration
      pwm: keembay: Fix build failure with -Os
      pwm: core: Use octal permission
      pwm: lpss: Make compilable with COMPILE_TEST
      pwm: Fix dependencies on HAS_IOMEM
      pwm: Use -EINVAL for unsupported polarity
      pwm: sti: Remove unnecessary blank line
      pwm: sti: Avoid conditional gotos
      pwm: Add PWM fan controller driver for LGM SoC
      Add DT bindings YAML schema for PWM fan controller of LGM SoC
      pwm: Add DesignWare PWM Controller Driver
      dt-bindings: pwm: mtk-disp: add MT8167 SoC binding
      pwm: mediatek: Add MT8183 SoC support
      pwm: mediatek: Always use bus clock
      dt-bindings: pwm: pwm-mediatek: Add documentation for MT8183 SoC
      pwm: Add PWM driver for Intel Keem Bay
      ...

commit f5cace4b93d736cef348211ae0814cabdd26d86a
Author: Dmitry Torokhov <dmitry.torokhov@gmail.com>
Date:   Fri Dec 18 10:03:12 2020 -0800

    Input: imx_keypad - add dependency on HAS_IOMEM
    
    devm_platform_ioremap_resource() depends on CONFIG_HAS_IOMEM, so let's add
    it to the dependencies when COMPILE_TEST is enabled.
    
    Reported-by: kernel test robot <lkp@intel.com>
    Fixes: c8834032ffe2 ("Input: imx_keypad - add COMPILE_TEST support")
    Link: https://lore.kernel.org/r/X9llpA3w1zlZCHXU@google.com
    Signed-off-by: Dmitry Torokhov <dmitry.torokhov@gmail.com>

commit a409ed156a90093a03fe6a93721ddf4c591eac87
Merge: 345b17acb1aa 7ac554888233
Author: Linus Torvalds <torvalds@linux-foundation.org>
Date:   Thu Dec 17 18:07:20 2020 -0800

    Merge tag 'gpio-v5.11-1' of git://git.kernel.org/pub/scm/linux/kernel/git/linusw/linux-gpio
    
    Pull GPIO updates from Linus Walleij:
     "This is the bulk of the GPIO changes for the v5.11 kernel cycle:
    
      Core changes:
    
       - Retired the old set-up function for GPIO IRQ chips. All chips now
         use the template struct gpio_irq_chip and pass that to the core to
         be set up alongside the gpio_chip. We can finally get rid of the
         old cruft.
    
       - Some refactoring and clean up of the core code.
    
       - Support edge event timestamps to be stamped using REALTIME (wall
         clock) timestamps. We have found solid use cases for this, so we
         support it.
    
      New drivers:
    
       - MStar MSC313 GPIO driver.
    
       - HiSilicon GPIO driver.
    
      Driver improvements:
    
       - The PCA953x driver now also supports the NXP PCAL9554B/C chips.
    
       - The mockup driver can now be probed from the device tree which is
         pretty useful for virtual prototyping of devices.
    
       - The Rcar driver now supports .get_multiple()
    
       - The MXC driver dropped some legacy and became a pure device tree
         client.
    
       - The Exar driver was moved over to the IDA interface for
         enumerating, and also switched over to using regmap for register
         access"
    
    * tag 'gpio-v5.11-1' of git://git.kernel.org/pub/scm/linux/kernel/git/linusw/linux-gpio: (87 commits)
      MAINTAINERS: Remove reference to non-existing file
      gpio: hisi: Do not require ACPI for COMPILE_TEST
      MAINTAINERS: Add maintainer for HiSilicon GPIO driver
      gpio: gpio-hisi: Add HiSilicon GPIO support
      gpio: cs5535: Simplify the return expression of cs5535_gpio_probe()
      gpiolib: irq hooks: fix recursion in gpiochip_irq_unmask
      dt-bindings: mt7621-gpio: convert bindings to YAML format
      gpiolib: cdev: Flag invalid GPIOs as used
      gpio: put virtual gpio device into their own submenu
      drivers: gpio: amd8111: use SPDX-License-Identifier
      drivers: gpio: amd8111: prefer dev_err()/dev_info() over raw printk
      drivers: gpio: bt8xx: prefer dev_err()/dev_warn() over of raw printk
      gpio: Add TODO item for debugfs interface
      gpio: just plain warning when nonexisting gpio requested
      tools: gpio: add option to report wall-clock time to gpio-event-mon
      tools: gpio: add support for reporting realtime event clock to lsgpio
      gpiolib: cdev: allow edge event timestamps to be configured as REALTIME
      gpio: msc313: MStar MSC313 GPIO driver
      dt-bindings: gpio: Binding for MStar MSC313 GPIO controller
      dt-bindings: gpio: Add a binding header for the MSC313 GPIO driver
      ...

commit 83005cd6bc76eef7bbf46b55bbb00ccc9534c38c
Merge: 74f602dc96dd 5a6338cce9f4
Author: Linus Torvalds <torvalds@linux-foundation.org>
Date:   Thu Dec 17 12:39:39 2020 -0800

    Merge tag 'mailbox-v5.11' of git://git.linaro.org/landing-teams/working/fujitsu/integration
    
    Pull mailbox updates from Jassi Brar:
    
     - arm: added mhu-v2 controller driver
    
     - arm_mhu_db: fix kfree by using devm_ variant
    
     - stm32-ipcc: misc cleanup
    
    * tag 'mailbox-v5.11' of git://git.linaro.org/landing-teams/working/fujitsu/integration:
      mailbox: arm_mhuv2: Add driver
      dt-bindings: mailbox : arm,mhuv2: Add bindings
      mailbox: stm32-ipcc: cast void pointers to unsigned long
      mailbox: stm32-ipcc: remove duplicate error message
      mailbox: stm32-ipcc: add COMPILE_TEST dependency
      mailbox: arm_mhu_db: Fix mhu_db_shutdown by replacing kfree with devm_kfree

commit aa43edcbc898afffb061f560d928d43bd55f4dc3
Author: Uwe Kleine-Knig <u.kleine-koenig@pengutronix.de>
Date:   Wed Nov 18 10:45:09 2020 +0100

    pwm: lpss: Make compilable with COMPILE_TEST
    
    All used ACPI functions have dummy implementations, and there is no hard
    dependency on x86.
    
    Signed-off-by: Uwe Kleine-Knig <u.kleine-koenig@pengutronix.de>
    Signed-off-by: Thierry Reding <thierry.reding@gmail.com>

commit 36c47df85ee8e1f8a35366ac11324f8875de00eb
Author: Arnd Bergmann <arnd@arndb.de>
Date:   Thu Dec 3 23:33:42 2020 +0100

    watchdog: coh901327: add COMMON_CLK dependency
    
    clang produces a build failure in configurations without COMMON_CLK
    when a timeout calculation goes wrong:
    
    arm-linux-gnueabi-ld: drivers/watchdog/coh901327_wdt.o: in function `coh901327_enable':
    coh901327_wdt.c:(.text+0x50): undefined reference to `__bad_udelay'
    
    Add a Kconfig dependency to only do build testing when COMMON_CLK
    is enabled.
    
    Fixes: da2a68b3eb47 ("watchdog: Enable COMPILE_TEST where possible")
    Signed-off-by: Arnd Bergmann <arnd@arndb.de>
    Reviewed-by: Guenter Roeck <linux@roeck-us.net>
    Link: https://lore.kernel.org/r/20201203223358.1269372-1-arnd@kernel.org
    Signed-off-by: Guenter Roeck <linux@roeck-us.net>
    Signed-off-by: Wim Van Sebroeck <wim@linux-watchdog.org>

commit 60f7c503d971a731ee3c4f884a9f2e80d476730d
Merge: 69f637c33560 be1b50021254
Author: Linus Torvalds <torvalds@linux-foundation.org>
Date:   Wed Dec 16 13:34:31 2020 -0800

    Merge tag 'scsi-misc' of git://git.kernel.org/pub/scm/linux/kernel/git/jejb/scsi
    
    Pull SCSI updates from James Bottomley:
     "This consists of the usual driver updates (ufs, qla2xxx, smartpqi,
      target, zfcp, fnic, mpt3sas, ibmvfc) plus a load of cleanups, a major
      power management rework and a load of assorted minor updates.
    
      There are a few core updates (formatting fixes being the big one) but
      nothing major this cycle"
    
    * tag 'scsi-misc' of git://git.kernel.org/pub/scm/linux/kernel/git/jejb/scsi: (279 commits)
      scsi: mpt3sas: Update driver version to 36.100.00.00
      scsi: mpt3sas: Handle trigger page after firmware update
      scsi: mpt3sas: Add persistent MPI trigger page
      scsi: mpt3sas: Add persistent SCSI sense trigger page
      scsi: mpt3sas: Add persistent Event trigger page
      scsi: mpt3sas: Add persistent Master trigger page
      scsi: mpt3sas: Add persistent trigger pages support
      scsi: mpt3sas: Sync time periodically between driver and firmware
      scsi: qla2xxx: Update version to 10.02.00.104-k
      scsi: qla2xxx: Fix device loss on 4G and older HBAs
      scsi: qla2xxx: If fcport is undergoing deletion complete I/O with retry
      scsi: qla2xxx: Fix the call trace for flush workqueue
      scsi: qla2xxx: Fix flash update in 28XX adapters on big endian machines
      scsi: qla2xxx: Handle aborts correctly for port undergoing deletion
      scsi: qla2xxx: Fix N2N and NVMe connect retry failure
      scsi: qla2xxx: Fix FW initialization error on big endian machines
      scsi: qla2xxx: Fix crash during driver load on big endian machines
      scsi: qla2xxx: Fix compilation issue in PPC systems
      scsi: qla2xxx: Don't check for fw_started while posting NVMe command
      scsi: qla2xxx: Tear down session if FW say it is down
      ...

commit 72db5d54d76300fb4153874b8466c0ebbb10208f
Author: Andy Shevchenko <andriy.shevchenko@linux.intel.com>
Date:   Mon Dec 14 18:55:23 2020 +0200

    gpio: hisi: Do not require ACPI for COMPILE_TEST
    
    Make it clear that ACPI needs to be present only to get driver functional.
    It is not required for compilation.
    
    Fixes: 356b01a986a5 ("gpio: gpio-hisi: Add HiSilicon GPIO support")
    Signed-off-by: Andy Shevchenko <andriy.shevchenko@linux.intel.com>
    Link: https://lore.kernel.org/r/20201214165524.43843-1-andriy.shevchenko@linux.intel.com
    Signed-off-by: Linus Walleij <linus.walleij@linaro.org>

commit d0a3ac549f389c1511a4df0d7638536305205d20
Author: Kees Cook <keescook@chromium.org>
Date:   Tue Dec 15 20:46:35 2020 -0800

    ubsan: enable for all*config builds
    
    With UBSAN_OBJECT_SIZE disabled for GCC, only UBSAN_ALIGNMENT remained a
    noisy UBSAN option.  Disable it for COMPILE_TEST so the rest of UBSAN can
    be used for full all*config builds or other large combinations.
    
    [sfr@canb.auug.org.au: add .data..Lubsan_data*/.data..Lubsan_type* sections explicitly]
      Link: https://lkml.kernel.org/r/20201208230157.42c42789@canb.auug.org.au
    
    Link: https://lore.kernel.org/lkml/CAHk-=wgXW=YLxGN0QVpp-1w5GDd2pf1W-FqY15poKzoVfik2qA@mail.gmail.com/
    Link: https://lkml.kernel.org/r/20201203004437.389959-6-keescook@chromium.org
    Signed-off-by: Kees Cook <keescook@chromium.org>
    Signed-off-by: Stephen Rothwell <sfr@canb.auug.org.au>
    Cc: Andrey Ryabinin <aryabinin@virtuozzo.com>
    Cc: Ard Biesheuvel <ardb@kernel.org>
    Cc: Arnd Bergmann <arnd@arndb.de>
    Cc: Dmitry Vyukov <dvyukov@google.com>
    Cc: George Popescu <georgepope@android.com>
    Cc: Herbert Xu <herbert@gondor.apana.org.au>
    Cc: Linus Torvalds <torvalds@linux-foundation.org>
    Cc: Marco Elver <elver@google.com>
    Cc: Masahiro Yamada <masahiroy@kernel.org>
    Cc: Michal Marek <michal.lkml@markovi.net>
    Cc: Nathan Chancellor <natechancellor@gmail.com>
    Cc: Nick Desaulniers <ndesaulniers@google.com>
    Cc: Peter Oberparleiter <oberpar@linux.ibm.com>
    Cc: Randy Dunlap <rdunlap@infradead.org>
    Signed-off-by: Andrew Morton <akpm@linux-foundation.org>
    Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>

commit 79791378a1bc9e218462211742e48e375371e8c5
Author: Kees Cook <keescook@chromium.org>
Date:   Tue Dec 15 20:46:31 2020 -0800

    ubsan: disable UBSAN_TRAP for all*config
    
    Doing all*config builds attempts to build as much as possible. UBSAN_TRAP
    effectively short-circuits lib/usban.c, so it should be disabled for
    COMPILE_TEST so that the lib/ubsan.c code gets built.
    
    Link: https://lkml.kernel.org/r/20201203004437.389959-5-keescook@chromium.org
    Signed-off-by: Kees Cook <keescook@chromium.org>
    Reviewed-by: Nathan Chancellor <natechancellor@gmail.com>
    Cc: Andrey Ryabinin <aryabinin@virtuozzo.com>
    Cc: Ard Biesheuvel <ardb@kernel.org>
    Cc: Arnd Bergmann <arnd@arndb.de>
    Cc: Dmitry Vyukov <dvyukov@google.com>
    Cc: George Popescu <georgepope@android.com>
    Cc: Herbert Xu <herbert@gondor.apana.org.au>
    Cc: Linus Torvalds <torvalds@linux-foundation.org>
    Cc: Marco Elver <elver@google.com>
    Cc: Masahiro Yamada <masahiroy@kernel.org>
    Cc: Michal Marek <michal.lkml@markovi.net>
    Cc: Nick Desaulniers <ndesaulniers@google.com>
    Cc: Peter Oberparleiter <oberpar@linux.ibm.com>
    Cc: Randy Dunlap <rdunlap@infradead.org>
    Signed-off-by: Andrew Morton <akpm@linux-foundation.org>
    Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>

commit d8a7f62b6eec198e85b8602e062c00e199f5c328
Author: Kees Cook <keescook@chromium.org>
Date:   Tue Dec 15 20:46:20 2020 -0800

    ubsan: remove redundant -Wno-maybe-uninitialized
    
    Patch series "Clean up UBSAN Makefile", v2.
    
    This series attempts to address the issues seen with UBSAN's object-size
    sanitizer causing problems under GCC.  In the process, the Kconfig and
    Makefile are refactored to do all the cc-option calls in the Kconfig.
    Additionally start to detangle -Wno-maybe-uninitialized, disable
    UBSAN_TRAP under COMPILE_TEST for wider build coverage, and expand the
    libusan tests.
    
    This patch (of 7):
    
    In commit 78a5255ffb6a ("Stop the ad-hoc games with
    -Wno-maybe-initialized") -Wmaybe-uninitialized was disabled globally, so
    keeping the disabling logic here too doesn't make sense.
    
    Link: https://lkml.kernel.org/r/20201203004437.389959-1-keescook@chromium.org
    Link: https://lkml.kernel.org/r/20201203004437.389959-2-keescook@chromium.org
    Signed-off-by: Kees Cook <keescook@chromium.org>
    Cc: Linus Torvalds <torvalds@linux-foundation.org>
    Cc: Ard Biesheuvel <ardb@kernel.org>
    Cc: Arnd Bergmann <arnd@arndb.de>
    Cc: Masahiro Yamada <masahiroy@kernel.org>
    Cc: Michal Marek <michal.lkml@markovi.net>
    Cc: Nathan Chancellor <natechancellor@gmail.com>
    Cc: Nick Desaulniers <ndesaulniers@google.com>
    Cc: Marco Elver <elver@google.com>
    Cc: Randy Dunlap <rdunlap@infradead.org>
    Cc: Dmitry Vyukov <dvyukov@google.com>
    Cc: George Popescu <georgepope@android.com>
    Cc: Herbert Xu <herbert@gondor.apana.org.au>
    Cc: Peter Oberparleiter <oberpar@linux.ibm.com>
    Cc: Andrey Ryabinin <aryabinin@virtuozzo.com>
    Signed-off-by: Andrew Morton <akpm@linux-foundation.org>
    Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>

commit ee249d30fadec7677364063648f5547e243bf93f
Merge: 61f914256c56 4b4193256c8d
Author: Linus Torvalds <torvalds@linux-foundation.org>
Date:   Tue Dec 15 16:18:23 2020 -0800

    Merge branch 'for-linus' of git://git.kernel.org/pub/scm/linux/kernel/git/dtor/input
    
    Pull input updates from Dmitry Torokhov:
    
     - support for inhibiting input devices at request from userspace. If a
       device implements open/close methods, it can also put device into low
       power state. This is needed, for example, to disable keyboard and
       touchpad on convertibles when they are transitioned into tablet mode
    
     - now that ordinary input devices can be configured for polling mode,
       dedicated input polling device implementation has been removed
    
     - GTCO tablet driver has been removed, as it used problematic custom
       HID parser, devices are EOL, and there is no interest from the
       manufacturer
    
     - a new driver for Dialog DA7280 haptic chips has been introduced
    
     - a new driver for power button on Dell Wyse 3020
    
     - support for eKTF2132 in ektf2127 driver
    
     - support for SC2721 and SC2730 in sc27xx-vibra driver
    
     - enhancements for Atmel touchscreens, AD7846 touchscreens, Elan
       touchpads, ADP5589, ST1232 touchscreen, TM2 touchkey drivers
    
     - fixes and cleanups to allow clean builds with W=1
    
    * 'for-linus' of git://git.kernel.org/pub/scm/linux/kernel/git/dtor/input: (86 commits)
      Input: da7280 - fix spelling mistake "sequemce" -> "sequence"
      Input: cyapa_gen6 - fix out-of-bounds stack access
      Input: sc27xx - add support for sc2730 and sc2721
      dt-bindings: input: Add compatible string for SC2721 and SC2730
      dt-bindings: input: Convert sc27xx-vibra.txt to json-schema
      Input: stmpe - add axis inversion and swapping capability
      Input: adp5589-keys - do not explicitly control IRQ for wakeup
      Input: adp5589-keys - do not unconditionally configure as wakeup source
      Input: ipx4xx-beeper - convert comma to semicolon
      Input: parkbd - convert comma to semicolon
      Input: new da7280 haptic driver
      dt-bindings: input: Add document bindings for DA7280
      MAINTAINERS: da7280 updates to the Dialog Semiconductor search terms
      Input: elantech - fix protocol errors for some trackpoints in SMBus mode
      Input: elan_i2c - add new trackpoint report type 0x5F
      Input: elants - document some registers and values
      Input: atmel_mxt_ts - simplify the return expression of mxt_send_bootloader_cmd()
      Input: imx_keypad - add COMPILE_TEST support
      Input: applespi - use new structure for SPI transfer delays
      Input: synaptics-rmi4 - use new structure for SPI transfer delays
      ...

commit 8ae2511112d2e18bc7d324b77f965d34083a25a2
Author: Guenter Roeck <linux@roeck-us.net>
Date:   Sun Nov 8 08:25:50 2020 -0800

    watchdog: sirfsoc: Add missing dependency on HAS_IOMEM
    
    If HAS_IOMEM is not defined and SIRFSOC_WATCHDOG is enabled,
    the build fails with the following error.
    
    drivers/watchdog/sirfsoc_wdt.o: in function `sirfsoc_wdt_probe':
    sirfsoc_wdt.c:(.text+0x112):
            undefined reference to `devm_platform_ioremap_resource'
    
    Reported-by: Necip Fazil Yildiran <fazilyildiran@gmail.com>
    Fixes: da2a68b3eb47 ("watchdog: Enable COMPILE_TEST where possible")
    Link: https://lore.kernel.org/r/20201108162550.27660-2-linux@roeck-us.net
    Signed-off-by: Guenter Roeck <linux@roeck-us.net>
    Signed-off-by: Wim Van Sebroeck <wim@linux-watchdog.org>

commit 7f6f1dfb2dcbe5d2bfa213f2df5d74c147cd5954
Author: Guenter Roeck <linux@roeck-us.net>
Date:   Sun Nov 8 08:25:49 2020 -0800

    watchdog: armada_37xx: Add missing dependency on HAS_IOMEM
    
    The following kbuild warning is seen on a system without HAS_IOMEM.
    
    WARNING: unmet direct dependencies detected for MFD_SYSCON
      Depends on [n]: HAS_IOMEM [=n]
      Selected by [y]:
      - ARMADA_37XX_WATCHDOG [=y] && WATCHDOG [=y] && (ARCH_MVEBU || COMPILE_TEST
    
    This results in a subsequent compile error.
    
    drivers/watchdog/armada_37xx_wdt.o: in function `armada_37xx_wdt_probe':
    armada_37xx_wdt.c:(.text+0xdc): undefined reference to `devm_ioremap'
    
    Add the missing dependency.
    
    Reported-by: Necip Fazil Yildiran <fazilyildiran@gmail.com>
    Fixes: 54e3d9b518c8 ("watchdog: Add support for Armada 37xx CPU watchdog")
    Link: https://lore.kernel.org/r/20201108162550.27660-1-linux@roeck-us.net
    Signed-off-by: Guenter Roeck <linux@roeck-us.net>
    Signed-off-by: Wim Van Sebroeck <wim@linux-watchdog.org>

commit c8834032ffe249a2a1b9702359ff29a28b8fcf1e
Author: Anson Huang <Anson.Huang@nxp.com>
Date:   Thu Dec 10 22:01:38 2020 -0800

    Input: imx_keypad - add COMPILE_TEST support
    
    Add COMPILE_TEST support to imx_keypad driver for better compile
    testing coverage.
    
    Signed-off-by: Anson Huang <Anson.Huang@nxp.com>
    Link: https://lore.kernel.org/r/1583137573-16628-1-git-send-email-Anson.Huang@nxp.com
    Signed-off-by: Dmitry Torokhov <dmitry.torokhov@gmail.com>

commit e59aef4edc45133ccb10b8e962cb74dcf1e3240b
Author: Alexandre Courbot <acourbot@chromium.org>
Date:   Mon Nov 2 16:40:07 2020 +0900

    remoteproc/mtk_scp: surround DT device IDs with CONFIG_OF
    
    Now that this driver can be compiled with COMPILE_TEST, we have no
    guarantee that CONFIG_OF will also be defined. When that happens, a
    warning about mtk_scp_of_match being defined but unused will be reported
    so make sure this variable is only defined if of_match_ptr() actually
    uses it.
    
    Fixes: cbd2dca74926c0e4610c40923cc786b732c9e8ef remoteproc: scp: add COMPILE_TEST dependency
    Reported-by: kernel test robot <lkp@intel.com>
    Signed-off-by: Alexandre Courbot <acourbot@chromium.org>
    Link: https://lore.kernel.org/r/20201102074007.299222-1-acourbot@chromium.org
    Signed-off-by: Bjorn Andersson <bjorn.andersson@linaro.org>

commit 0e17a87c5950b91aa5ed11ba569b46dea13b1e0d
Author: Suganath Prabu S <suganath-prabu.subramani@broadcom.com>
Date:   Thu Nov 26 15:13:09 2020 +0530

    scsi: mpt3sas: Add persistent MPI trigger page
    
    This page is used to store information about MPI (IOC Status & LogInfo)
    triggers.
    
     Driver Persistent Trigger Page-4 format:
     -------------------------------------------------------
     | 31       24 23           16 15         8 7          0|  Byte
     -------------------------------------------------------
     | PageType   | PageNumber    | Reserved  | PageVersion |  0x00
     --------------------------------------------------------
     | Reserved   | ExtPageType   |      ExtPageLength      |  0x04
     --------------------------------------------------------
     |          Reserved          | NumMpiTriggerEntries    |  0x08
     --------------------------------------------------------
     |             MPITriggerEntry[0]                       |  0x0C
     --------------------------------------------------------
     |                                                     |
     --------------------------------------------------------
     |            MPITriggerEntry[19]                       |  0xA4
     --------------------------------------------------------
    
    NumMpiTriggerEntries:
    
    This field indicates number of MPI (IOC Status & LogInfo) trigger entries
    stored in this page. Currently driver is supporting a maximum of 20-MPI
    trigger entries.
    
    MPITriggerEntry:
    
     -----------------------------------------------------
     | 31                    16 15                     0 |
     -----------------------------------------------------
     |        Reserved         |      IOCStatus          |
     -----------------------------------------------------
     |                   IOCLogInfo                      |
     -----------------------------------------------------
    
    IOCStatus  => Status value from the IOC
    IOCLogInfo => Specific value that supplements the IOCStatus.
    
    Link: https://lore.kernel.org/r/20201126094311.8686-7-suganath-prabu.subramani@broadcom.com
    Reported-by: kernel test robot <lkp@intel.com>
    Signed-off-by: Suganath Prabu S <suganath-prabu.subramani@broadcom.com>
    Signed-off-by: Martin K. Petersen <martin.petersen@oracle.com>

commit 71b3fb8fe6dd6e8e8c296653e45ed6f1817e6dfc
Author: Suganath Prabu S <suganath-prabu.subramani@broadcom.com>
Date:   Thu Nov 26 15:13:07 2020 +0530

    scsi: mpt3sas: Add persistent Event trigger page
    
    Trigger Page2 is used to store information about Event triggers:
    
      31     24 23        16 15      8 7         0   Byte
     -----------------------------------------------
     |PageType  |PageNumber  |Reserved |PageVersion| 0x00
     -----------------------------------------------
     |Reserved  |ExtPageType |   ExtPageLength     | 0x04
     -----------------------------------------------
     |     Reserved          | NumMPIEventTriggers | 0x08
     -----------------------------------------------
     |                 MPIEventTriggerEntries      | 0x0C
     |                                             | 0xFC
     -----------------------------------------------
    
    Number of MPI Event Trigger Entries currently stored in this page.  If this
    is set to zero, there are no valid MPI-Event-Trigger entries available in
    this page.
    
    MPIEventTriggerEntry:
    
     - MPIEventCode [15:00]
       MPI Event code specified in MPI-Spec
    
     - MPIEventCodeSpecific [16:31]
       For Event Code MPI2_EVENT_LOG_ENTRY_ADDED (0x0021),
       this field specifies the Log-Entry-Qualifier.
       For all other Event Codes, this field is reserved and not used
    
    Maximum of 20-event trigger entries can be stored in this page.
    
    Link: https://lore.kernel.org/r/20201126094311.8686-5-suganath-prabu.subramani@broadcom.com
    Reported-by: kernel test robot <lkp@intel.com>
    Signed-off-by: Suganath Prabu S <suganath-prabu.subramani@broadcom.com>
    Signed-off-by: Martin K. Petersen <martin.petersen@oracle.com>

commit aec93e8e238512689885c20c1af6e67747850341
Author: Suganath Prabu S <suganath-prabu.subramani@broadcom.com>
Date:   Thu Nov 26 15:13:05 2020 +0530

    scsi: mpt3sas: Add persistent trigger pages support
    
    The user can set trigger values in order to collect the IOC's host trace
    buffer automatically upon detecting certain conditions. However, the
    trigger values that the user sets are not persistent across system reboot
    or reload of the driver.
    
    In order to make the user trigger settings persistent, these trigger values
    need to be saved in the IOC's NVRAM pages:
    
     - Driver Persistent Trigger Page 0:
         This page is used to store list of trigger types that are enabled
    
     - Driver Persistent Trigger Page 1:
         This page stores the list of Master triggers that are enabled
    
     - Driver Persistent Trigger Page 2:
         This page stores the list of MPI Event Triggers that are enabled
    
     - Driver Persistent Trigger Page 3:
         This page stores the list of SCSI Sense Triggers that are enabled
    
     - Driver Persistent Trigger Page 4:
         This page stores the list of IOCStatus-LogInfo Triggers that are
         enabled.
    
    Whenever user configures triggers, the driver persists the values in the
    corresponding trigger pages. When the driver is subsequently reloaded, the
    driver reads the values from the trigger pages and configures the triggers
    accordingly.
    
    During firmware upload operation, if the newer firmware supports the
    trigger page feature, then driver persists the configured diag trigger
    values to NVRAM.
    
    Link: https://lore.kernel.org/r/20201126094311.8686-3-suganath-prabu.subramani@broadcom.com
    Reported-by: kernel test robot <lkp@intel.com>
    Signed-off-by: Suganath Prabu S <suganath-prabu.subramani@broadcom.com>
    Signed-off-by: Martin K. Petersen <martin.petersen@oracle.com>

commit 54bf54c859ec1e7c9c3152a2ec53c5fe4078eb1f
Merge: e72550928ff0 b097efba9580
Author: Greg Kroah-Hartman <gregkh@linuxfoundation.org>
Date:   Wed Dec 9 14:26:40 2020 +0100

    Merge tag 'phy-for-5.11' of git://git.kernel.org/pub/scm/linux/kernel/git/phy/linux-phy into char-misc-next
    
    Vinod writes:
    
    phy-for-5.11
    
     - New phy drivers:
       - Mediatek MT7621 PCIe PHY (promoted from staging)
       - Ingenic USB phy driver supporting JZ4775 and X2000
       - Intel Keem Bay USB PHY driver
       - Marvell USB HSIC PHY driver supporting MMP3 SoC
       - AXG MIPI D-PHY driver
    
     - Updates:
       - Conversion to YAML binding for:
            - Broadcom SATA PHY
            - Cadence Sierra PHY bindings
            - STM32 USBC Phy
       - Support for Exynos5433 PCIe PHY
       - Support for Qualcomm SM8250 PCIe QMP PHY
       - Support for Exynos5420 USB2 phy
       - devm_platform_ioremap_resource conversion for bunch of drivers
    
    * tag 'phy-for-5.11' of git://git.kernel.org/pub/scm/linux/kernel/git/phy/linux-phy: (72 commits)
      drm/mediatek: avoid dereferencing a null hdmi_phy on an error message
      phy: ingenic: depend on HAS_IOMEM
      phy: mediatek: statify mtk_hdmi_phy_driver
      dt-bindings: phy: Convert Broadcom SATA PHY to YAML
      devicetree: phy: rockchip-emmc add output-tapdelay-select
      phy: rockchip-emmc: output tap delay dt property
      PHY: Ingenic: Add USB PHY driver using generic PHY framework.
      dt-bindings: USB: Add bindings for Ingenic JZ4775 and X2000.
      USB: PHY: JZ4770: Remove unnecessary function calls.
      devicetree: phy: rockchip-emmc: pulldown property
      phy: rockchip: set pulldown for strobe line in dts
      phy: renesas: rcar-gen3-usb2: disable runtime pm in case of failure
      phy: mediatek: allow compile-testing the hdmi phy
      phy/rockchip: Make PHY_ROCKCHIP_INNO_HDMI depend on HAS_IOMEM to fix build error
      phy: samsung: Merge Kconfig for Exynos5420 and Exynos5250
      phy: ralink: phy-mt7621-pci: set correct name in MODULE_DEVICE_TABLE macro
      phy: ralink: phy-mt7621-pci: drop 'COMPILE_TEST' from Kconfig
      phy: mediatek: Make PHY_MTK_{XSPHY, TPHY} depend on HAS_IOMEM and OF_ADDRESS to fix build errors
      phy: tegra: xusb: Fix usb_phy device driver field
      phy: amlogic: replace devm_reset_control_array_get()
      ...

commit e0839f3ea404138f0a48d861bb30d66d5cc7a6e2
Merge: 2bd87914b295 e00e70a4dae4
Author: Arnd Bergmann <arnd@arndb.de>
Date:   Wed Dec 9 00:24:20 2020 +0100

    Merge tag 'imx-drivers-5.11' of git://git.kernel.org/pub/scm/linux/kernel/git/shawnguo/linux into arm/drivers
    
    i.MX drivers change for 5.11:
    
    - A series from Daniel Baluta to update imx-dsp driver and export
      functions for on demand channel request/free.
    - A number of patches to add power domains for i.MX8qxp DC0, LVDS1,
      MIPI1 and JPEG subsystems.
    - Add dummy functions for i.MX firmware drivers to avoid build failure
      seen with COMPILE_TEST.
    
    * tag 'imx-drivers-5.11' of git://git.kernel.org/pub/scm/linux/kernel/git/shawnguo/linux:
      firmware: imx: scu-pd: Add some power domains support for i.MX8qxp MIPI1 subsystem
      firmware: imx: scu-pd: Add main power domain support for i.MX8qxp LVDS1 subsystem
      firmware: imx: scu-pd: Add video0/1 power domains support for i.MX8qxp DC0 subsystem
      firmware: imx-dsp: Export functions to request/free channels
      firmware: imx: Save channel name for further use
      firmware: imx: Introduce imx_dsp_setup_channels
      firmware: imx: scu-pd: Add power domains for imx-jpeg
      firmware: imx: add dummy functions
    
    Link: https://lore.kernel.org/r/20201202142717.9262-1-shawnguo@kernel.org
    Signed-off-by: Arnd Bergmann <arnd@arndb.de>

commit 4aca4dbcac9d8eed8a8dc15b6883270a20a84218
Author: Sam Ravnborg <sam@ravnborg.org>
Date:   Sun Dec 6 20:02:46 2020 +0100

    video: fbdev: controlfb: Fix set but not used warnings
    
    The controlfb driver has a number of dummy defines for IO operations.
    They were introduced in commit a07a63b0e24d
    ("video: fbdev: controlfb: add COMPILE_TEST support").
    
    The write variants did not use their value parameter in the
    dummy versions, resulting in set but not used warnings.
    Fix this by adding "(void)val" to silence the compiler.
    
    Signed-off-by: Sam Ravnborg <sam@ravnborg.org>
    Acked-by: Thomas Zimmermann <tzimmermann@suse.de>
    Cc: Sam Ravnborg <sam@ravnborg.org>
    Cc: Bartlomiej Zolnierkiewicz <b.zolnierkie@samsung.com>
    Cc: "Gustavo A. R. Silva" <gustavoars@kernel.org>
    Cc: Michael Ellerman <mpe@ellerman.id.au>
    Link: https://patchwork.freedesktop.org/patch/msgid/20201206190247.1861316-13-sam@ravnborg.org

commit 6247e31b75308c51476e157c9964823aeefbf5dc
Author: Dong Aisheng <aisheng.dong@nxp.com>
Date:   Mon Nov 30 16:46:24 2020 +0800

    clk: imx: scu: fix MXC_CLK_SCU module build break
    
    This issue can be reproduced by having a kernel config with
    CONFIG_IMX_MBOX=m and CONFIG_MXC_CLK_SCU=m.  It's caused by the Makefile
    wanting to build clk-scu.o and clk-imx8qxp.o as different targets but
    that doesn't work (e.g. MXC_CLK_SCU = y while CLK_IMX8QXP = n)
    
    "obj-$(CONFIG_MXC_CLK_SCU) += clk-imx-scu.o clk-imx-lpcg-scu.o
    clk-imx-scu-$(CONFIG_CLK_IMX8QXP) += clk-scu.o clk-imx8qxp.o"
    
    Having MXC_CLK_SCU=y/m while CLK_IMX8QXP=n will cause a linker problem
    like below:
    
      LD [M]  drivers/clk/imx/clk-imx-scu.o
      arm-poky-linux-gnueabi-ld: no input files
    
    Make MXC_CLK_SCU be un-selectable by users so it can only be selected by
    the CLK_IMX8QXP option, ensuring the two symbols are built together.
    Drop COMPILE_TEST too because this option isn't selectable anymore. We
    can remove it from MXC_CLK_SCU because CLK_IMX8QXP selects MXC_CLK_SCU
    which already has COMPILE_TEST.
    
    Fixes: e0d0d4d86c766 ("clk: imx8qxp: Support building i.MX8QXP clock driver as module")
    Acked-by: Sebastian Andrzej Siewior <bigeasy@linutronix.de>
    Signed-off-by: Dong Aisheng <aisheng.dong@nxp.com>
    Link: https://lore.kernel.org/r/20201130084624.21113-1-aisheng.dong@nxp.com
    [sboyd@kernel.org: Rework commit text]
    Signed-off-by: Stephen Boyd <sboyd@kernel.org>

commit fc928b901dc68481ba3e524860a641fe13e25dfe
Author: Arnd Bergmann <arnd@arndb.de>
Date:   Thu Dec 3 23:53:32 2020 +0100

    cpufreq: imx: fix NVMEM_IMX_OCOTP dependency
    
    A driver should not 'select' drivers from another subsystem.
    If NVMEM is disabled, this one results in a warning:
    
    WARNING: unmet direct dependencies detected for NVMEM_IMX_OCOTP
      Depends on [n]: NVMEM [=n] && (ARCH_MXC [=y] || COMPILE_TEST [=y]) && HAS_IOMEM [=y]
      Selected by [y]:
      - ARM_IMX6Q_CPUFREQ [=y] && CPU_FREQ [=y] && (ARM || ARM64 [=y]) && ARCH_MXC [=y] && REGULATOR_ANATOP [=y]
    
    Change the 'select' to 'depends on' to prevent it from going wrong,
    and allow compile-testing without that driver, since it is only
    a runtime dependency.
    
    Fixes: 2782ef34ed23 ("cpufreq: imx: Select NVMEM_IMX_OCOTP")
    Signed-off-by: Arnd Bergmann <arnd@arndb.de>
    Signed-off-by: Viresh Kumar <viresh.kumar@linaro.org>

commit e319a1b956f785f618611857cd946dca2bb68542
Author: Arnd Bergmann <arnd@arndb.de>
Date:   Fri Dec 4 00:13:38 2020 +0100

    drm/msm: add IOMMU_SUPPORT dependency
    
    The iommu pgtable support is only available when IOMMU support
    is built into the kernel:
    
    WARNING: unmet direct dependencies detected for IOMMU_IO_PGTABLE
      Depends on [n]: IOMMU_SUPPORT [=n]
      Selected by [y]:
      - DRM_MSM [=y] && HAS_IOMEM [=y] && DRM [=y] && (ARCH_QCOM [=y] || SOC_IMX5 || ARM && COMPILE_TEST [=y]) && OF [=y] && COMMON_CLK [=y] && MMU [=y] && (QCOM_OCMEM [=y] || QCOM_OCMEM [=y]=n)
    
    Fix the dependency accordingly. There is no need for depending on
    CONFIG_MMU any more, as that is implied by the iommu support.
    
    Fixes: b145c6e65eb0 ("drm/msm: Add support to create a local pagetable")
    Signed-off-by: Arnd Bergmann <arnd@arndb.de>
    Signed-off-by: Rob Clark <robdclark@chromium.org>

commit f5f6e01f9164040ba120f30522efdb4deceb529a
Author: Arnd Bergmann <arnd@arndb.de>
Date:   Fri Dec 4 14:56:43 2020 +0100

    phy: mediatek: allow compile-testing the hdmi phy
    
    Compile-testing the DRM_MEDIATEK_HDMI driver shows two missing
    dependencies, one results in a link failure:
    
    arm-linux-gnueabi-ld: drivers/phy/mediatek/phy-mtk-hdmi.o: in function `mtk_hdmi_phy_probe':
    phy-mtk-hdmi.c:(.text+0xd8): undefined reference to `__clk_get_name'
    arm-linux-gnueabi-ld: phy-mtk-hdmi.c:(.text+0x12c): undefined reference to `devm_clk_register'
    arm-linux-gnueabi-ld: phy-mtk-hdmi.c:(.text+0x250): undefined reference to `of_clk_add_provider'
    arm-linux-gnueabi-ld: phy-mtk-hdmi.c:(.text+0x298): undefined reference to `of_clk_src_simple_get'
    
    The other one is a harmless warning:
    
    WARNING: unmet direct dependencies detected for PHY_MTK_HDMI
      Depends on [n]: ARCH_MEDIATEK [=n] && OF [=y]
      Selected by [y]:
      - DRM_MEDIATEK_HDMI [=y] && HAS_IOMEM [=y] && DRM_MEDIATEK [=y]
    
    Fix these by adding dependencies on CONFIG_OF and CONFIG_COMMON_CLK.
    With that done, there is also no reason against adding
    CONFIG_COMPILE_TEST.
    
    Fixes: b28be59a2e26 ("phy: mediatek: Move mtk_hdmi_phy driver into drivers/phy/mediatek folder")
    Signed-off-by: Arnd Bergmann <arnd@arndb.de>
    Link: https://lore.kernel.org/r/20201204135650.2744481-1-arnd@kernel.org
    Signed-off-by: Vinod Koul <vkoul@kernel.org>

commit cdf367192766ad11a03e8d5098556be43b8eb6b0
Author: David Brazdil <dbrazdil@google.com>
Date:   Wed Dec 2 18:41:17 2020 +0000

    KVM: arm64: Intercept host's CPU_ON SMCs
    
    Add a handler of the CPU_ON PSCI call from host. When invoked, it looks
    up the logical CPU ID corresponding to the provided MPIDR and populates
    the state struct of the target CPU with the provided x0, pc. It then
    calls CPU_ON itself, with an entry point in hyp that initializes EL2
    state before returning ERET to the provided PC in EL1.
    
    There is a simple atomic lock around the boot args struct. If it is
    already locked, CPU_ON will return PENDING_ON error code.
    
    Signed-off-by: David Brazdil <dbrazdil@google.com>
    Signed-off-by: Marc Zyngier <maz@kernel.org>
    Link: https://lore.kernel.org/r/20201202184122.26046-22-dbrazdil@google.com

commit 94f5e8a4642aedb19ca73f534372d7ed65e1c84e
Author: David Brazdil <dbrazdil@google.com>
Date:   Wed Dec 2 18:41:10 2020 +0000

    KVM: arm64: Create nVHE copy of cpu_logical_map
    
    When KVM starts validating host's PSCI requests, it will need to map
    MPIDR back to the CPU ID. To this end, copy cpu_logical_map into nVHE
    hyp memory when KVM is initialized.
    
    Only copy the information for CPUs that are online at the point of KVM
    initialization so that KVM rejects CPUs whose features were not checked
    against the finalized capabilities.
    
    Signed-off-by: David Brazdil <dbrazdil@google.com>
    Signed-off-by: Marc Zyngier <maz@kernel.org>
    Link: https://lore.kernel.org/r/20201202184122.26046-15-dbrazdil@google.com

commit 0a03658d222a99b192a7f84e41e8af197a87259e
Author: Tiezhu Yang <yangtiezhu@loongson.cn>
Date:   Tue Nov 24 17:17:03 2020 +0800

    pinctrl: at91-pio4: Make PINCTRL_AT91PIO4 depend on HAS_IOMEM to fix build error
    
    If CONFIG_HAS_IOMEM is not set, devm_platform_ioremap_resource() will
    be not built in drivers/base/platform.c and then there exists a build
    error about undefined reference to "devm_platform_ioremap_resource"
    in pinctrl-at91-pio4.c under COMPILE_TEST and CONFIG_PINCTRL_AT91PIO4,
    make PINCTRL_AT91PIO4 depend on HAS_IOMEM to fix it.
    
    Reported-by: kernel test robot <lkp@intel.com>
    Signed-off-by: Tiezhu Yang <yangtiezhu@loongson.cn>
    Link: https://lore.kernel.org/r/1606209423-4742-1-git-send-email-yangtiezhu@loongson.cn
    Signed-off-by: Linus Walleij <linus.walleij@linaro.org>

commit a1315dcb7b6a7d3a78df848eed5b331a4b3ec28a
Author: Herbert Xu <herbert@gondor.apana.org.au>
Date:   Fri Nov 27 16:49:40 2020 +1100

    hwrng: ks-sa - Add dependency on IOMEM and OF
    
    This patch adds a dependency for KEYSTONE on HAS_IOMEM and OF to
    prevent COMPILE_TEST build failures.
    
    Reported-by: kernel test robot <lkp@intel.com>
    Signed-off-by: Herbert Xu <herbert@gondor.apana.org.au>

commit 0020868f2a7037e87d6b3b196526de2fb885830d
Author: Alexandre Belloni <alexandre.belloni@bootlin.com>
Date:   Sat Nov 21 23:45:29 2020 +0100

    rtc: mxc{,_v2}: enable COMPILE_TEST
    
    Extend code coverage for the rtc-mxc and rtc-mxc-v2 drivers.
    
    Signed-off-by: Alexandre Belloni <alexandre.belloni@bootlin.com>
    Reviewed-by: Fabio Estevam <festevam@gmail.com>
    Link: https://lore.kernel.org/r/20201121224529.568237-1-alexandre.belloni@bootlin.com

commit 8e06053d339af3caae1c68435cfdb9ac95b0ff25
Author: Fabio Estevam <festevam@gmail.com>
Date:   Wed Nov 25 13:04:47 2020 +0100

    media: fsl-viu: Use the ioread/write32be() accessors
    
    Since commit 29d750686331 ("media: fsl-viu: allow building it with
    COMPILE_TEST") there were several attempts to fix build failures on
    PPC, MICROBLAZE and M68K.
    
    However, such errors are still present as reported by kbuild robot.
    
    Fix the problem by using the ioread/write32be() accessors, which build
    fine on all platforms.
    
    Reported-by: kernel test robot <lkp@intel.com>
    Suggested-by: Michael Ellerman <mpe@ellerman.id.au>
    Signed-off-by: Fabio Estevam <festevam@gmail.com>
    Reviewed-by: Michael Ellerman <mpe@ellerman.id.au>
    Signed-off-by: Hans Verkuil <hverkuil-cisco@xs4all.nl>
    Signed-off-by: Mauro Carvalho Chehab <mchehab+huawei@kernel.org>

commit ab7dd2008b29e48cff216aa984902d59b583d36d
Author: Tiezhu Yang <yangtiezhu@loongson.cn>
Date:   Tue Nov 24 19:11:27 2020 +0800

    phy/rockchip: Make PHY_ROCKCHIP_INNO_HDMI depend on HAS_IOMEM to fix build error
    
    devm_ioremap_resource() will be not built in lib/devres.c if
    CONFIG_HAS_IOMEM is not set, and then there exists a build
    error about undefined reference to "devm_ioremap_resource"
    in the file phy-rockchip-inno-hdmi.c under COMPILE_TEST and
    CONFIG_PHY_ROCKCHIP_INNO_HDMI, make PHY_ROCKCHIP_INNO_HDMI
    depend on HAS_IOMEM to fix it.
    
    Reported-by: kernel test robot <lkp@intel.com>
    Signed-off-by: Tiezhu Yang <yangtiezhu@loongson.cn>
    Reviewed-by: Heiko Stuebner <heiko@sntech.de>
    Link: https://lore.kernel.org/r/1606216287-14648-1-git-send-email-yangtiezhu@loongson.cn
    Signed-off-by: Vinod Koul <vkoul@kernel.org>

commit c5e6ae563c802c4d828d42e134af64004db2e58c
Author: Masahiro Yamada <masahiroy@kernel.org>
Date:   Sun Nov 22 04:36:55 2020 +0900

    ARC: build: move symlink creation to arch/arc/Makefile to avoid race
    
    If you run 'make uImage uImage.gz' with the parallel option, uImage.gz
    will be created by two threads simultaneously.
    
    This is because arch/arc/Makefile does not specify the dependency
    between uImage and uImage.gz. Hence, GNU Make assumes they can be
    built in parallel. One thread descends into arch/arc/boot/ to create
    uImage, and another to create uImage.gz.
    
    Please notice the same log is displayed twice in the following steps:
    
      $ export CROSS_COMPILE=<your-arc-compiler-prefix>
      $ make -s ARCH=arc defconfig
      $ make -j$(nproc) ARCH=arc uImage uImage.gz
      [ snip ]
        LD      vmlinux
        SORTTAB vmlinux
        SYSMAP  System.map
        OBJCOPY arch/arc/boot/vmlinux.bin
        OBJCOPY arch/arc/boot/vmlinux.bin
        GZIP    arch/arc/boot/vmlinux.bin.gz
        GZIP    arch/arc/boot/vmlinux.bin.gz
        UIMAGE  arch/arc/boot/uImage.gz
        UIMAGE  arch/arc/boot/uImage.gz
      Image Name:   Linux-5.10.0-rc4-00003-g62f23044
      Created:      Sun Nov 22 02:52:26 2020
      Image Type:   ARC Linux Kernel Image (gzip compressed)
      Data Size:    2109376 Bytes = 2059.94 KiB = 2.01 MiB
      Load Address: 80000000
      Entry Point:  80004000
        Image arch/arc/boot/uImage is ready
      Image Name:   Linux-5.10.0-rc4-00003-g62f23044
      Created:      Sun Nov 22 02:52:26 2020
      Image Type:   ARC Linux Kernel Image (gzip compressed)
      Data Size:    2815455 Bytes = 2749.47 KiB = 2.69 MiB
      Load Address: 80000000
      Entry Point:  80004000
    
    This is a race between the two threads trying to write to the same file
    arch/arc/boot/uImage.gz. This is a potential problem that can generate
    a broken file.
    
    I fixed a similar problem for ARM by commit 3939f3345050 ("ARM: 8418/1:
    add boot image dependencies to not generate invalid images").
    
    I highly recommend to avoid such build rules that cause a race condition.
    
    Move the uImage rule to arch/arc/Makefile.
    
    Another strangeness is that arch/arc/boot/Makefile compares the
    timestamps between $(obj)/uImage and $(obj)/uImage.*:
    
      $(obj)/uImage: $(obj)/uImage.$(suffix-y)
              @ln -sf $(notdir $<) $@
              @echo '  Image $@ is ready'
    
    This does not work as expected since $(obj)/uImage is a symlink.
    The symlink should be created in a phony target rule.
    
    I used $(kecho) instead of echo to suppress the message
    'Image arch/arc/boot/uImage is ready' when the -s option is given.
    
    Signed-off-by: Masahiro Yamada <masahiroy@kernel.org>
    Signed-off-by: Vineet Gupta <vgupta@synopsys.com>

commit 0cfccb3c04934cdef42ae26042139f16e805b5f7
Author: Masahiro Yamada <masahiroy@kernel.org>
Date:   Sun Nov 22 04:36:54 2020 +0900

    ARC: build: add boot_targets to PHONY
    
    The top-level boot_targets (uImage and uImage.*) should be phony
    targets. They just let Kbuild descend into arch/arc/boot/ and create
    files there.
    
    If a file exists in the top directory with the same name, the boot
    image will not be created.
    
    You can confirm it by the following steps:
    
      $ export CROSS_COMPILE=<your-arc-compiler-prefix>
      $ make -s ARCH=arc defconfig all   # vmlinux will be built
      $ touch uImage.gz
      $ make ARCH=arc uImage.gz
      CALL    scripts/atomic/check-atomics.sh
      CALL    scripts/checksyscalls.sh
      CHK     include/generated/compile.h
      # arch/arc/boot/uImage.gz is not created
    
    Specify the targets as PHONY to fix this.
    
    Signed-off-by: Masahiro Yamada <masahiroy@kernel.org>
    Signed-off-by: Vineet Gupta <vgupta@synopsys.com>

commit 9836720911cfec25d3fbdead1c438bf87e0f2841
Author: Masahiro Yamada <masahiroy@kernel.org>
Date:   Sun Nov 22 04:36:52 2020 +0900

    ARC: build: remove non-existing bootpImage from KBUILD_IMAGE
    
    The deb-pkg builds for ARCH=arc fail.
    
      $ export CROSS_COMPILE=<your-arc-compiler-prefix>
      $ make -s ARCH=arc defconfig
      $ make ARCH=arc bindeb-pkg
      SORTTAB vmlinux
      SYSMAP  System.map
      MODPOST Module.symvers
      make KERNELRELEASE=5.10.0-rc4 ARCH=arc KBUILD_BUILD_VERSION=2 -f ./Makefile intdeb-pkg
      sh ./scripts/package/builddeb
      cp: cannot stat 'arch/arc/boot/bootpImage': No such file or directory
      make[4]: *** [scripts/Makefile.package:87: intdeb-pkg] Error 1
      make[3]: *** [Makefile:1527: intdeb-pkg] Error 2
      make[2]: *** [debian/rules:13: binary-arch] Error 2
      dpkg-buildpackage: error: debian/rules binary subprocess returned exit status 2
      make[1]: *** [scripts/Makefile.package:83: bindeb-pkg] Error 2
      make: *** [Makefile:1527: bindeb-pkg] Error 2
    
    The reason is obvious; arch/arc/Makefile sets $(boot)/bootpImage as
    the default image, but there is no rule to build it.
    
    Remove the meaningless KBUILD_IMAGE assignment so it will fallback
    to the default vmlinux. With this change, you can build the deb package.
    
    I removed the 'bootpImage' target as well. At best, it provides
    'make bootpImage' as an alias of 'make vmlinux', but I do not see
    much sense in doing so.
    
    Signed-off-by: Masahiro Yamada <masahiroy@kernel.org>
    Signed-off-by: Vineet Gupta <vgupta@synopsys.com>

commit 017909281eb0f8a00445840a36c799d3aed00841
Author: Martin Kaiser <martin@kaiser.cx>
Date:   Sun Nov 29 19:52:28 2020 +0100

    mailbox: stm32-ipcc: cast void pointers to unsigned long
    
    Now that the driver can be enabled by COMPILE_TEST, we see warnings on
    64bit platforms when void pointers are cast to unsigned int (and
    vice versa).
    
    warning: cast to smaller integer type 'unsigned int' from 'void *'
               unsigned int chan = (unsigned int)link->con_priv;
    ...
    warning: cast to 'void *' from smaller integer type 'unsigned int'
               ipcc->controller.chans[i].con_priv = (void *)i;
    
    Update these casts to use unsigned long variables, which are the same
    size as pointers on all platforms.
    
    Reported-by: kernel test robot <lkp@intel.com>
    Signed-off-by: Martin Kaiser <martin@kaiser.cx>
    Reviewed-by: Fabien Dessenne <fabien.dessenne@st.com>
    Signed-off-by: Jassi Brar <jaswinder.singh@linaro.org>

commit d68f17291ccf86442c3d367ba83581b81541baae
Author: Martin Kaiser <martin@kaiser.cx>
Date:   Sun Nov 1 16:42:29 2020 +0100

    mailbox: stm32-ipcc: add COMPILE_TEST dependency
    
    This allows compiling the driver on architectures where the hardware is not
    available. Most other mailbox drivers support this as well.
    
    Signed-off-by: Martin Kaiser <martin@kaiser.cx>
    Reviewed-by: Fabien Dessenne <fabien.dessenne@st.com>
    Signed-off-by: Jassi Brar <jaswinder.singh@linaro.org>

commit 8145dcb07d0c8bdb1e8e76a5df18779431f7af8e
Author: Sergio Paracuellos <sergio.paracuellos@gmail.com>
Date:   Tue Dec 1 12:20:51 2020 +0100

    phy: ralink: phy-mt7621-pci: set correct name in MODULE_DEVICE_TABLE macro
    
    Correct name passed into 'MODULE_DEVICE_TABLE' which was wrong and
    was showing a warning when the driver is enabled for 'COMPILE_TEST'.
    
    Signed-off-by: Sergio Paracuellos <sergio.paracuellos@gmail.com>
    Link: https://lore.kernel.org/r/20201201112051.17463-3-sergio.paracuellos@gmail.com
    Signed-off-by: Vinod Koul <vkoul@kernel.org>

commit 0e055d179ea9368f882d2060b0d82341ee90bae3
Author: Sergio Paracuellos <sergio.paracuellos@gmail.com>
Date:   Tue Dec 1 12:20:50 2020 +0100

    phy: ralink: phy-mt7621-pci: drop 'COMPILE_TEST' from Kconfig
    
    This driver includes the following two files directly:
    - mt7621.h
    - ralink_regs.h
    
    Compilation for its related platform properly works because
    its real path is included in 'arch/mips/ralink/Platform' as
    cflags.
    
    This driver depends on RALINK but also is enabled for COMPILE_TEST
    where nothing about its platform is known and this directly
    included files are not found at all breaking compilation.
    
    If we want 'COMPILE_TEST' we have to change cflags also inside
    'phy/ralink' subdirectory Makefile which seems that does not
    like to linux-phy maintainers. Hence remove COMPILE_TEST from
    Kconfig to avoid the problem.
    
    Fixes: d87da32372a0 ("phy: ralink: Add PHY driver for MT7621 PCIe PHY")
    Reported-by: Stephen Rothwell <sfr@canb.auug.org.au>
    Signed-off-by: Sergio Paracuellos <sergio.paracuellos@gmail.com>
    Link: https://lore.kernel.org/r/20201201112051.17463-2-sergio.paracuellos@gmail.com
    Signed-off-by: Vinod Koul <vkoul@kernel.org>

commit d7bb92e3c908a9df47bd3a306f6fc3e009babc5b
Author: Tiezhu Yang <yangtiezhu@loongson.cn>
Date:   Wed Nov 25 15:37:45 2020 +0800

    phy: mediatek: Make PHY_MTK_{XSPHY, TPHY} depend on HAS_IOMEM and OF_ADDRESS to fix build errors
    
    devm_ioremap_resource() will be not built in lib/devres.c if
    CONFIG_HAS_IOMEM is not set, of_address_to_resource() will be
    not built in drivers/of/address.c if CONFIG_OF_ADDRESS is not
    set, and then there exists two build errors about undefined
    reference to "devm_ioremap_resource" and "of_address_to_resource"
    in phy-mtk-xsphy.c under COMPILE_TEST and CONFIG_PHY_MTK_XSPHY,
    make PHY_MTK_XSPHY depend on HAS_IOMEM and OF_ADDRESS to fix it.
    
    The above issue is reported by kernel test robot <lkp@intel.com>,
    through the discussion in the v1 patch, as Chunfeng said we need
    also do this for config PHY_MTK_TPHY:
    
    drivers/phy/mediatek/phy-mtk-tphy.c:1157:               retval = of_address_to_resource(child_np, 0, &res);
    drivers/phy/mediatek/phy-mtk-tphy.c:1123:               tphy->sif_base = devm_ioremap_resource(dev, sif_res);
    drivers/phy/mediatek/phy-mtk-tphy.c:1164:               instance->port_base = devm_ioremap_resource(&phy->dev, &res);
    
    Reported-by: kernel test robot <lkp@intel.com>
    Signed-off-by: Tiezhu Yang <yangtiezhu@loongson.cn>
    Acked-by: Randy Dunlap <rdunlap@infradead.org>
    Acked-by: Chunfeng Yun <chunfeng.yun@mediatek.com>
    Link: https://lore.kernel.org/r/1606289865-692-1-git-send-email-yangtiezhu@loongson.cn
    Signed-off-by: Vinod Koul <vkoul@kernel.org>

commit 5c9f8c2dbdbe53818bcde6aa6695e1331e5f841f
Author: Jonathan McDowell <noodles@earth.li>
Date:   Sat Nov 14 14:02:33 2020 +0000

    dmaengine: qcom: Add ADM driver
    
    Add the DMA engine driver for the QCOM Application Data Mover (ADM) DMA
    controller found in the MSM8x60 and IPQ/APQ8064 platforms.
    
    The ADM supports both memory to memory transactions and memory
    to/from peripheral device transactions.  The controller also provides
    flow control capabilities for transactions to/from peripheral devices.
    
    The initial release of this driver supports slave transfers to/from
    peripherals and also incorporates CRCI (client rate control interface)
    flow control.
    
    The hardware only supports a 32 bit physical address, so specifying
    !PHYS_ADDR_T_64BIT gives maximum COMPILE_TEST coverage without having to
    spend effort on kludging things in the code that will never actually be
    needed on real hardware.
    
    Signed-off-by: Andy Gross <agross@codeaurora.org>
    Signed-off-by: Thomas Pedersen <twp@codeaurora.org>
    Signed-off-by: Jonathan McDowell <noodles@earth.li>
    Link: https://lore.kernel.org/r/20201114140233.GM32650@earth.li
    Signed-off-by: Vinod Koul <vkoul@kernel.org>

commit 34c5aa2666db54c4bd330fb2759f6e4d4544ad7a
Author: John Stultz <john.stultz@linaro.org>
Date:   Mon Nov 23 22:23:59 2020 +0000

    regulator: Kconfig: Fix REGULATOR_QCOM_RPMH dependencies to avoid build error
    
    The kernel test robot reported the following build error:
    
    All errors (new ones prefixed by >>):
    
       xtensa-linux-ld: drivers/regulator/qcom-rpmh-regulator.o: in function `rpmh_regulator_vrm_get_voltage_sel':
       qcom-rpmh-regulator.c:(.text+0x270): undefined reference to `rpmh_write'
       xtensa-linux-ld: drivers/regulator/qcom-rpmh-regulator.o: in function `rpmh_regulator_send_request':
       qcom-rpmh-regulator.c:(.text+0x2f2): undefined reference to `rpmh_write'
       xtensa-linux-ld: drivers/regulator/qcom-rpmh-regulator.o: in function `rpmh_regulator_vrm_get_voltage_sel':
    >> qcom-rpmh-regulator.c:(.text+0x274): undefined reference to `rpmh_write_async'
       xtensa-linux-ld: drivers/regulator/qcom-rpmh-regulator.o: in function `rpmh_regulator_send_request':
       qcom-rpmh-regulator.c:(.text+0x2fc): undefined reference to `rpmh_write_async'
    
    Which is due to REGULATOR_QCOM_RPMH depending on
    QCOM_RPMH || COMPILE_TEST. The problem is that QOM_RPMH can now
    be a module, which in that case requires REGULATOR_QCOM_RPMH=m
    to build.
    
    However, if COMPILE_TEST is enabled, REGULATOR_QCOM_RPMH can be
    set to =y while QCOM_RPMH=m which will cause build failures.
    
    The fix here is to add (QCOM_RPMH=n && COMPILE_TEST) to the
    dependency.
    
    Feedback would be appreciated!
    
    Cc: Todd Kjos <tkjos@google.com>
    Cc: Saravana Kannan <saravanak@google.com>
    Cc: Andy Gross <agross@kernel.org>
    Cc: Bjorn Andersson <bjorn.andersson@linaro.org>
    Cc: Rajendra Nayak <rnayak@codeaurora.org>
    Cc: Maulik Shah <mkshah@codeaurora.org>
    Cc: Stephen Boyd <swboyd@chromium.org>
    Cc: Liam Girdwood <lgirdwood@gmail.com>
    Cc: Mark Brown <broonie@kernel.org>
    Cc: linux-arm-msm@vger.kernel.org
    Reported-by: kernel test robot <lkp@intel.com>
    Signed-off-by: John Stultz <john.stultz@linaro.org>
    Reviewed-by: Bjorn Andersson <bjorn.andersson@linaro.org>
    Link: https://lore.kernel.org/r/20201123222359.103822-1-john.stultz@linaro.org
    Signed-off-by: Mark Brown <broonie@kernel.org>

commit d8398bf840f8964220508aff7901c924e322f5e8
Author: Stafford Horne <shorne@gmail.com>
Date:   Sat Nov 21 06:54:56 2020 +0900

    openrisc: add local64.h to fix blk-iocost build
    
    As of 5.10 OpenRISC allyesconfig builds fail with the following error.
    
        $ make ARCH=openrisc CROSS_COMPILE=or1k-elf- block/blk-iocost.o
          CALL    scripts/checksyscalls.sh
          CALL    scripts/atomic/check-atomics.sh
          CC      block/blk-iocost.o
        block/blk-iocost.c:183:10: fatal error: asm/local64.h: No such file or directory
          183 | #include <asm/local64.h>
              |          ^~~~~~~~~~~~~~~
        compilation terminated.
    
    The new include of local64.h was added in commit 5e124f74325d
    ("blk-iocost: use local[64]_t for percpu stat") by Tejun.
    
    Adding the generic version of local64.h to OpenRISC fixes the build
    issue.
    
    Cc: Tejun Heo <tj@kernel.org>
    Signed-off-by: Stafford Horne <shorne@gmail.com>

commit 334ef6ed06fa1a54e35296b77b693bcf6d63ee9e
Author: Heiko Carstens <hca@linux.ibm.com>
Date:   Wed Nov 18 21:32:33 2020 +0100

    init/Kconfig: make COMPILE_TEST depend on !S390
    
    While allmodconfig and allyesconfig build for s390 there are also
    various bots running compile tests with randconfig, where PCI is
    disabled. This reveals that a lot of drivers should actually depend on
    HAS_IOMEM.
    Adding this to each device driver would be a never ending story,
    therefore just disable COMPILE_TEST for s390.
    
    The reasoning is more or less the same as described in
    commit bc083a64b6c0 ("init/Kconfig: make COMPILE_TEST depend on !UML").
    
    Reported-by: kernel test robot <lkp@intel.com>
    Suggested-by: Arnd Bergmann <arnd@kernel.org>
    Signed-off-by: Heiko Carstens <hca@linux.ibm.com>

commit 61349f0f2715d08f9ab4448bc9004810fc74b531
Author: Krzysztof Kozlowski <krzk@kernel.org>
Date:   Wed Nov 18 21:14:20 2020 +0100

    ASoC: sunxi: do not select COMMON_CLK to fix builds
    
    COMMON_CLK is a user-selectable option with its own dependencies.  The
    most important dependency is !HAVE_LEGACY_CLK.  User-selectable drivers
    should not select COMMON_CLK because they will create a dependency cycle
    and build failures.  For example on MIPS a configuration with COMMON_CLK
    (selected by SND_SUN8I_CODEC) and HAVE_LEGACY_CLK (selected by
    SOC_RT305X) is possible:
    
      WARNING: unmet direct dependencies detected for COMMON_CLK
        Depends on [n]: !HAVE_LEGACY_CLK [=y]
        Selected by [y]:
        - SND_SUN8I_CODEC [=y] && SOUND [=y] && !UML && SND [=y] && SND_SOC [=y] &&
          (ARCH_SUNXI || COMPILE_TEST [=y]) && OF [=y] && (MACH_SUN8I || ARM64 && ARCH_SUNXI || COMPILE_TEST [=y])
    
        /usr/bin/mips-linux-gnu-ld: drivers/clk/clk.o: in function `clk_set_rate':
        (.text+0xaeb4): multiple definition of `clk_set_rate'; arch/mips/ralink/clk.o:(.text+0x88): first defined here
    
    Signed-off-by: Krzysztof Kozlowski <krzk@kernel.org>
    Reviewed-by: Samuel Holland <samuel@sholland.org>
    Acked-by: Maxime Ripard <mripard@kernel.org>
    Link: https://lore.kernel.org/r/20201118201420.4878-1-krzk@kernel.org
    Signed-off-by: Mark Brown <broonie@kernel.org>

commit 299fe9937dbd1a4d9a1da6a2b6f222298534ca57
Author: Jerome Brunet <jbrunet@baylibre.com>
Date:   Mon Nov 16 18:24:23 2020 +0100

    ASoC: meson: fix COMPILE_TEST error
    
    When compiled with CONFIG_HAVE_CLK, the kernel need to get provider for the
    clock API. This is usually selected by the platform and the sound drivers
    should not really care about this. However COMPILE_TEST is special and the
    platform required may not have been selected, leading to this type of
    error:
    
    > aiu-encoder-spdif.c:(.text+0x3a0): undefined reference to `clk_set_parent'
    
    Since we need a sane provider of the API with COMPILE_TEST, depends on
    COMMON_CLK.
    
    Fixes: 6dc4fa179fb8 ("ASoC: meson: add axg fifo base driver")
    Reported-by: kernel test robot <lkp@intel.com>
    Signed-off-by: Jerome Brunet <jbrunet@baylibre.com>
    Link: https://lore.kernel.org/r/20201116172423.546855-1-jbrunet@baylibre.com
    Signed-off-by: Mark Brown <broonie@kernel.org>

commit 203cb737fbe09cc6b57d4bd46be7977e72d49281
Merge: cef211968c2d 7958ba7e6273
Author: Jakub Kicinski <kuba@kernel.org>
Date:   Thu Nov 12 14:49:42 2020 -0800

    Merge branch 'smsc-w-1-warning-fixes'
    
    Andrew Lunn says:
    
    ====================
    smsc W=1 warning fixes
    
    Fixup various W=1 warnings, and then add COMPILE_TEST support, which
    explains why these where missed on the previous pass.
    
    v2:
    Use while (0)
    Rework buffer alignment to make it clearer
    
    v3:
    Access the length from the hardware and Use __always_unused to tell the
    compiler we want to discard the value.
    ====================
    
    Link: https://lore.kernel.org/r/20201110030248.1480413-1-andrew@lunn.ch
    Signed-off-by: Jakub Kicinski <kuba@kernel.org>

commit 7958ba7e6273a02f49432a2506958d0f59b5b8da
Author: Andrew Lunn <andrew@lunn.ch>
Date:   Tue Nov 10 04:02:48 2020 +0100

    drivers: net: smsc: Add COMPILE_TEST support
    
    Improve the build testing of these SMSC drivers by enabling them when
    COMPILE_TEST is selected.
    
    Signed-off-by: Andrew Lunn <andrew@lunn.ch>
    Signed-off-by: Jakub Kicinski <kuba@kernel.org>

commit 8fc72cb541e7fef8bf2b0724ee965f34d6418832
Merge: 95530a59db3d 03dfd157670b
Author: Jakub Kicinski <kuba@kernel.org>
Date:   Thu Nov 12 14:33:13 2020 -0800

    Merge branch 'xilinx_emaclite-w-1-fixes'
    
    Andrew Lunn says:
    
    ====================
    xilinx_emaclite W=1 fixes
    
    kerneldoc, pointer issues, and add COMPILE_TEST support to easy
    finding future issues via build testing.
    
    v2:
     - Use uintptr_t instead of long
     - Added Acked-by's.
    ====================
    
    Link: https://lore.kernel.org/r/20201110024024.1479741-1-andrew@lunn.ch
    Signed-off-by: Jakub Kicinski <kuba@kernel.org>

commit 03dfd157670bd715306dce1507b8998cabd38539
Author: Andrew Lunn <andrew@lunn.ch>
Date:   Tue Nov 10 03:40:24 2020 +0100

    drivers: net: xilinx_emaclite: Add COMPILE_TEST support
    
    To improve build testing of this driver, add COMPILE_TEST support.
    
    Acked-by: Michal Simek <michal.simek@xilinx.com>
    Signed-off-by: Andrew Lunn <andrew@lunn.ch>
    Signed-off-by: Jakub Kicinski <kuba@kernel.org>

commit f81cc5ac8c2b5c0e2e190ea181ab2b9e5cf8497d
Author: Filip Kokosinski <fkokosinski@antmicro.com>
Date:   Thu Sep 19 13:42:45 2019 +0200

    openrisc: add support for LiteX
    
    This adds support for a basic LiteX-based SoC with a mor1kx soft CPU.
    
    Signed-off-by: Filip Kokosinski <fkokosinski@antmicro.com>
    Signed-off-by: Mateusz Holenko <mholenko@antmicro.com>
    [shorne: Merged in soc-cntl patch, removed CROSS_COMPILE, sort MAINT.]
    Signed-off-by: Stafford Horne <shorne@gmail.com>

commit 245157a31e91aec7f5b621ed26c0a8370b1c8a64
Author: Dmitry Osipenko <digetx@gmail.com>
Date:   Wed Nov 4 19:48:39 2020 +0300

    soc/tegra: fuse: Add stub for tegra_sku_info
    
    Drivers that use tegra_sku_info and have COMPILE_TEST are failing to be
    build due to the missing stub for tegra_sku_info.
    
    Signed-off-by: Dmitry Osipenko <digetx@gmail.com>
    Link: https://lore.kernel.org/r/20201104164923.21238-4-digetx@gmail.com
    Signed-off-by: Krzysztof Kozlowski <krzk@kernel.org>

commit f4f250c7e7ec7f8ac4588eeeb3aef2739bbe6dbf
Author: Arun Easi <aeasi@marvell.com>
Date:   Tue Sep 29 03:21:49 2020 -0700

    scsi: qla2xxx: Fix reset of MPI firmware
    
    commit 3e6efab865ac943f4ec43913eb665695737112b0 upstream.
    
    Normally, the MPI firmware is reset when an MPI dump is collected.  If an
    unsaved MPI dump exists in the driver, though, an alternate mechanism is
    used. This mechanism, which was not fully correct, is not recommended and
    instead an MPI dump template walk is suggested to perform the MPI reset.
    
    To allow for the MPI dump template walk, extra space is reserved in the MPI
    dump buffer which gets used only when there is already an MPI dump in
    place.
    
    Link: https://lore.kernel.org/r/20200929102152.32278-5-njavali@marvell.com
    Fixes: cbb01c2f2f63 ("scsi: qla2xxx: Fix MPI failure AEN (8200) handling")
    Cc: stable@vger.kernel.org
    Reviewed-by: Himanshu Madhani <himanshu.madhani@oracle.com>
    Signed-off-by: Arun Easi <aeasi@marvell.com>
    Signed-off-by: Nilesh Javali <njavali@marvell.com>
    Signed-off-by: Martin K. Petersen <martin.petersen@oracle.com>
    Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>

commit 26474cdeb96eaf2cf3b9ae00e93b0bc634ff1f7c
Author: Arun Easi <aeasi@marvell.com>
Date:   Tue Sep 29 03:21:48 2020 -0700

    scsi: qla2xxx: Fix MPI reset needed message
    
    commit 7a6cdbd5e87515ebf6231b762ad903c7cff87b9c upstream.
    
    When printing the message:
    
      "MPI Heartbeat stop. MPI reset is not needed.."
    
    ..the wrong register was checked leading to always printing that MPI reset
    is not needed, even when it is needed. Fix the MPI reset message.
    
    Link: https://lore.kernel.org/r/20200929102152.32278-4-njavali@marvell.com
    Fixes: cbb01c2f2f63 ("scsi: qla2xxx: Fix MPI failure AEN (8200) handling")
    Cc: stable@vger.kernel.org
    Reviewed-by: Himanshu Madhani <himanshu.madhani@oracle.com>
    Signed-off-by: Arun Easi <aeasi@marvell.com>
    Signed-off-by: Nilesh Javali <njavali@marvell.com>
    Signed-off-by: Martin K. Petersen <martin.petersen@oracle.com>
    Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>

commit e5ac60e9807c00eab5662a8fd73694ed30910d9b
Author: Valentin Schneider <valentin.schneider@arm.com>
Date:   Sat Aug 29 14:00:16 2020 +0100

    arm64: topology: Stop using MPIDR for topology information
    
    [ Upstream commit 3102bc0e6ac752cc5df896acb557d779af4d82a1 ]
    
    In the absence of ACPI or DT topology data, we fallback to haphazardly
    decoding *something* out of MPIDR. Sadly, the contents of that register are
    mostly unusable due to the implementation leniancy and things like Aff0
    having to be capped to 15 (despite being encoded on 8 bits).
    
    Consider a simple system with a single package of 32 cores, all under the
    same LLC. We ought to be shoving them in the same core_sibling mask, but
    MPIDR is going to look like:
    
      | CPU  | 0 | ... | 15 | 16 | ... | 31 |
      |------+---+-----+----+----+-----+----+
      | Aff0 | 0 | ... | 15 |  0 | ... | 15 |
      | Aff1 | 0 | ... |  0 |  1 | ... |  1 |
      | Aff2 | 0 | ... |  0 |  0 | ... |  0 |
    
    Which will eventually yield
    
      core_sibling(0-15)  == 0-15
      core_sibling(16-31) == 16-31
    
    NUMA woes
    =========
    
    If we try to play games with this and set up NUMA boundaries within those
    groups of 16 cores via e.g. QEMU:
    
      # Node0: 0-9; Node1: 10-19
      $ qemu-system-aarch64 <blah> \
        -smp 20 -numa node,cpus=0-9,nodeid=0 -numa node,cpus=10-19,nodeid=1
    
    The scheduler's MC domain (all CPUs with same LLC) is going to be built via
    
      arch_topology.c::cpu_coregroup_mask()
    
    In there we try to figure out a sensible mask out of the topology
    information we have. In short, here we'll pick the smallest of NUMA or
    core sibling mask.
    
      node_mask(CPU9)    == 0-9
      core_sibling(CPU9) == 0-15
    
    MC mask for CPU9 will thus be 0-9, not a problem.
    
      node_mask(CPU10)    == 10-19
      core_sibling(CPU10) == 0-15
    
    MC mask for CPU10 will thus be 10-19, not a problem.
    
      node_mask(CPU16)    == 10-19
      core_sibling(CPU16) == 16-19
    
    MC mask for CPU16 will thus be 16-19... Uh oh. CPUs 16-19 are in two
    different unique MC spans, and the scheduler has no idea what to make of
    that. That triggers the WARN_ON() added by commit
    
      ccf74128d66c ("sched/topology: Assert non-NUMA topology masks don't (partially) overlap")
    
    Fixing MPIDR-derived topology
    =============================
    
    We could try to come up with some cleverer scheme to figure out which of
    the available masks to pick, but really if one of those masks resulted from
    MPIDR then it should be discarded because it's bound to be bogus.
    
    I was hoping to give MPIDR a chance for SMT, to figure out which threads are
    in the same core using Aff1-3 as core ID, but Sudeep and Robin pointed out
    to me that there are systems out there where *all* cores have non-zero
    values in their higher affinity fields (e.g. RK3288 has "5" in all of its
    cores' MPIDR.Aff1), which would expose a bogus core ID to userspace.
    
    Stop using MPIDR for topology information. When no other source of topology
    information is available, mark each CPU as its own core and its NUMA node
    as its LLC domain.
    
    Signed-off-by: Valentin Schneider <valentin.schneider@arm.com>
    Reviewed-by: Sudeep Holla <sudeep.holla@arm.com>
    Link: https://lore.kernel.org/r/20200829130016.26106-1-valentin.schneider@arm.com
    Signed-off-by: Will Deacon <will@kernel.org>
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit 80685a94f7c41f8e817d8588ef4e8afb3667101a
Author: Valentin Schneider <valentin.schneider@arm.com>
Date:   Sat Aug 29 14:00:16 2020 +0100

    arm64: topology: Stop using MPIDR for topology information
    
    [ Upstream commit 3102bc0e6ac752cc5df896acb557d779af4d82a1 ]
    
    In the absence of ACPI or DT topology data, we fallback to haphazardly
    decoding *something* out of MPIDR. Sadly, the contents of that register are
    mostly unusable due to the implementation leniancy and things like Aff0
    having to be capped to 15 (despite being encoded on 8 bits).
    
    Consider a simple system with a single package of 32 cores, all under the
    same LLC. We ought to be shoving them in the same core_sibling mask, but
    MPIDR is going to look like:
    
      | CPU  | 0 | ... | 15 | 16 | ... | 31 |
      |------+---+-----+----+----+-----+----+
      | Aff0 | 0 | ... | 15 |  0 | ... | 15 |
      | Aff1 | 0 | ... |  0 |  1 | ... |  1 |
      | Aff2 | 0 | ... |  0 |  0 | ... |  0 |
    
    Which will eventually yield
    
      core_sibling(0-15)  == 0-15
      core_sibling(16-31) == 16-31
    
    NUMA woes
    =========
    
    If we try to play games with this and set up NUMA boundaries within those
    groups of 16 cores via e.g. QEMU:
    
      # Node0: 0-9; Node1: 10-19
      $ qemu-system-aarch64 <blah> \
        -smp 20 -numa node,cpus=0-9,nodeid=0 -numa node,cpus=10-19,nodeid=1
    
    The scheduler's MC domain (all CPUs with same LLC) is going to be built via
    
      arch_topology.c::cpu_coregroup_mask()
    
    In there we try to figure out a sensible mask out of the topology
    information we have. In short, here we'll pick the smallest of NUMA or
    core sibling mask.
    
      node_mask(CPU9)    == 0-9
      core_sibling(CPU9) == 0-15
    
    MC mask for CPU9 will thus be 0-9, not a problem.
    
      node_mask(CPU10)    == 10-19
      core_sibling(CPU10) == 0-15
    
    MC mask for CPU10 will thus be 10-19, not a problem.
    
      node_mask(CPU16)    == 10-19
      core_sibling(CPU16) == 16-19
    
    MC mask for CPU16 will thus be 16-19... Uh oh. CPUs 16-19 are in two
    different unique MC spans, and the scheduler has no idea what to make of
    that. That triggers the WARN_ON() added by commit
    
      ccf74128d66c ("sched/topology: Assert non-NUMA topology masks don't (partially) overlap")
    
    Fixing MPIDR-derived topology
    =============================
    
    We could try to come up with some cleverer scheme to figure out which of
    the available masks to pick, but really if one of those masks resulted from
    MPIDR then it should be discarded because it's bound to be bogus.
    
    I was hoping to give MPIDR a chance for SMT, to figure out which threads are
    in the same core using Aff1-3 as core ID, but Sudeep and Robin pointed out
    to me that there are systems out there where *all* cores have non-zero
    values in their higher affinity fields (e.g. RK3288 has "5" in all of its
    cores' MPIDR.Aff1), which would expose a bogus core ID to userspace.
    
    Stop using MPIDR for topology information. When no other source of topology
    information is available, mark each CPU as its own core and its NUMA node
    as its LLC domain.
    
    Signed-off-by: Valentin Schneider <valentin.schneider@arm.com>
    Reviewed-by: Sudeep Holla <sudeep.holla@arm.com>
    Link: https://lore.kernel.org/r/20200829130016.26106-1-valentin.schneider@arm.com
    Signed-off-by: Will Deacon <will@kernel.org>
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit f3dc5ac4011eac5a3a8b28fc13fe08b7dfb5af34
Author: Valentin Schneider <valentin.schneider@arm.com>
Date:   Sat Aug 29 14:00:16 2020 +0100

    arm64: topology: Stop using MPIDR for topology information
    
    [ Upstream commit 3102bc0e6ac752cc5df896acb557d779af4d82a1 ]
    
    In the absence of ACPI or DT topology data, we fallback to haphazardly
    decoding *something* out of MPIDR. Sadly, the contents of that register are
    mostly unusable due to the implementation leniancy and things like Aff0
    having to be capped to 15 (despite being encoded on 8 bits).
    
    Consider a simple system with a single package of 32 cores, all under the
    same LLC. We ought to be shoving them in the same core_sibling mask, but
    MPIDR is going to look like:
    
      | CPU  | 0 | ... | 15 | 16 | ... | 31 |
      |------+---+-----+----+----+-----+----+
      | Aff0 | 0 | ... | 15 |  0 | ... | 15 |
      | Aff1 | 0 | ... |  0 |  1 | ... |  1 |
      | Aff2 | 0 | ... |  0 |  0 | ... |  0 |
    
    Which will eventually yield
    
      core_sibling(0-15)  == 0-15
      core_sibling(16-31) == 16-31
    
    NUMA woes
    =========
    
    If we try to play games with this and set up NUMA boundaries within those
    groups of 16 cores via e.g. QEMU:
    
      # Node0: 0-9; Node1: 10-19
      $ qemu-system-aarch64 <blah> \
        -smp 20 -numa node,cpus=0-9,nodeid=0 -numa node,cpus=10-19,nodeid=1
    
    The scheduler's MC domain (all CPUs with same LLC) is going to be built via
    
      arch_topology.c::cpu_coregroup_mask()
    
    In there we try to figure out a sensible mask out of the topology
    information we have. In short, here we'll pick the smallest of NUMA or
    core sibling mask.
    
      node_mask(CPU9)    == 0-9
      core_sibling(CPU9) == 0-15
    
    MC mask for CPU9 will thus be 0-9, not a problem.
    
      node_mask(CPU10)    == 10-19
      core_sibling(CPU10) == 0-15
    
    MC mask for CPU10 will thus be 10-19, not a problem.
    
      node_mask(CPU16)    == 10-19
      core_sibling(CPU16) == 16-19
    
    MC mask for CPU16 will thus be 16-19... Uh oh. CPUs 16-19 are in two
    different unique MC spans, and the scheduler has no idea what to make of
    that. That triggers the WARN_ON() added by commit
    
      ccf74128d66c ("sched/topology: Assert non-NUMA topology masks don't (partially) overlap")
    
    Fixing MPIDR-derived topology
    =============================
    
    We could try to come up with some cleverer scheme to figure out which of
    the available masks to pick, but really if one of those masks resulted from
    MPIDR then it should be discarded because it's bound to be bogus.
    
    I was hoping to give MPIDR a chance for SMT, to figure out which threads are
    in the same core using Aff1-3 as core ID, but Sudeep and Robin pointed out
    to me that there are systems out there where *all* cores have non-zero
    values in their higher affinity fields (e.g. RK3288 has "5" in all of its
    cores' MPIDR.Aff1), which would expose a bogus core ID to userspace.
    
    Stop using MPIDR for topology information. When no other source of topology
    information is available, mark each CPU as its own core and its NUMA node
    as its LLC domain.
    
    Signed-off-by: Valentin Schneider <valentin.schneider@arm.com>
    Reviewed-by: Sudeep Holla <sudeep.holla@arm.com>
    Link: https://lore.kernel.org/r/20200829130016.26106-1-valentin.schneider@arm.com
    Signed-off-by: Will Deacon <will@kernel.org>
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit ce3f952104e0266986d8a4e6b11d8f979e18fb3e
Merge: 7812e10511ce 1bcb32c76540
Author: Jakub Kicinski <kuba@kernel.org>
Date:   Mon Nov 2 15:52:23 2020 -0800

    Merge branch 'davicom-w-1-fixes'
    
    Andrew Lunn says:
    
    ====================
    davicom W=1 fixes
    
    Fixup various W=1 warnings, and then add COMPILE_TEST support, which
    explains why these where missed on the previous pass.
    ====================
    
    Link: https://lore.kernel.org/r/20201031005833.1060316-1-andrew@lunn.ch
    Signed-off-by: Jakub Kicinski <kuba@kernel.org>

commit 1bcb32c765401b0c2323a1df720e71dfad487f85
Author: Andrew Lunn <andrew@lunn.ch>
Date:   Sat Oct 31 01:58:33 2020 +0100

    drivers: net: davicom Add COMPILE_TEST support
    
    Improve the build testing of this davicom driver by enabling it when
    COMPILE_TEST is selected.
    
    Signed-off-by: Andrew Lunn <andrew@lunn.ch>
    Signed-off-by: Jakub Kicinski <kuba@kernel.org>

commit a45c8c0a31a7ff7fc7d6c540ecea017116d3386e
Author: Christian Eggers <ceggers@arri.de>
Date:   Mon Oct 12 11:35:42 2020 +0200

    socket: don't clear SOCK_TSTAMP_NEW when SO_TIMESTAMPNS is disabled
    
    commit 4e3bbb33e6f36e4b05be1b1b9b02e3dd5aaa3e69 upstream.
    
    SOCK_TSTAMP_NEW (timespec64 instead of timespec) is also used for
    hardware time stamps (configured via SO_TIMESTAMPING_NEW).
    
    User space (ptp4l) first configures hardware time stamping via
    SO_TIMESTAMPING_NEW which sets SOCK_TSTAMP_NEW. In the next step, ptp4l
    disables SO_TIMESTAMPNS(_NEW) (software time stamps), but this must not
    switch hardware time stamps back to "32 bit mode".
    
    This problem happens on 32 bit platforms were the libc has already
    switched to struct timespec64 (from SO_TIMExxx_OLD to SO_TIMExxx_NEW
    socket options). ptp4l complains with "missing timestamp on transmitted
    peer delay request" because the wrong format is received (and
    discarded).
    
    Fixes: 887feae36aee ("socket: Add SO_TIMESTAMP[NS]_NEW")
    Fixes: 783da70e8396 ("net: add sock_enable_timestamps")
    Signed-off-by: Christian Eggers <ceggers@arri.de>
    Acked-by: Willem de Bruijn <willemb@google.com>
    Acked-by: Deepa Dinamani <deepa.kernel@gmail.com>
    Signed-off-by: Jakub Kicinski <kuba@kernel.org>
    Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>

commit 75442fb0ccaacddf1654a5304401a9f556c61004
Author: Mauro Carvalho Chehab <mchehab+huawei@kernel.org>
Date:   Fri Oct 30 08:40:45 2020 +0100

    docs: Kconfig/Makefile: add a check for broken ABI files
    
    The files under Documentation/ABI should follow the syntax
    as defined at Documentation/ABI/README.
    
    Allow checking if they're following the syntax by running
    the ABI parser script on COMPILE_TEST.
    
    With that, when there's a problem with a file under
    Documentation/ABI, it would produce a warning like:
    
            Warning: file ./Documentation/ABI/testing/sysfs-bus-pci-devices-aer_stats#14:
                    What '/sys/bus/pci/devices/<dev>/aer_stats/aer_rootport_total_err_cor' doesn't have a description
            Warning: file ./Documentation/ABI/testing/sysfs-bus-pci-devices-aer_stats#21:
                    What '/sys/bus/pci/devices/<dev>/aer_stats/aer_rootport_total_err_fatal' doesn't have a description
    
    Acked-by: Jonathan Corbet <corbet@lwn.net>
    Signed-off-by: Mauro Carvalho Chehab <mchehab+huawei@kernel.org>
    Link: https://lore.kernel.org/r/57a38de85cb4b548857207cf1fc1bf1ee08613c9.1604042072.git.mchehab+huawei@kernel.org
    Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>

commit 0ee5ef9d3a5a5f2f95c92269be2473e235f8f950
Author: Necip Fazil Yildiran <fazilyildiran@gmail.com>
Date:   Mon Sep 14 14:46:52 2020 +0300

    arc: plat-hsdk: fix kconfig dependency warning when !RESET_CONTROLLER
    
    [ Upstream commit 63bcf87cb1c57956e1179f1a78dde625c7e3cba7 ]
    
    When ARC_SOC_HSDK is enabled and RESET_CONTROLLER is disabled, it results
    in the following Kbuild warning:
    
    WARNING: unmet direct dependencies detected for RESET_HSDK
      Depends on [n]: RESET_CONTROLLER [=n] && HAS_IOMEM [=y] && (ARC_SOC_HSDK [=y] || COMPILE_TEST [=n])
      Selected by [y]:
      - ARC_SOC_HSDK [=y] && ISA_ARCV2 [=y]
    
    The reason is that ARC_SOC_HSDK selects RESET_HSDK without depending on or
    selecting RESET_CONTROLLER while RESET_HSDK is subordinate to
    RESET_CONTROLLER.
    
    Honor the kconfig menu hierarchy to remove kconfig dependency warnings.
    
    Fixes: a528629dfd3b ("ARC: [plat-hsdk] select CONFIG_RESET_HSDK from Kconfig")
    Signed-off-by: Necip Fazil Yildiran <fazilyildiran@gmail.com>
    Signed-off-by: Vineet Gupta <vgupta@synopsys.com>
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit 7f101eccd00b242dd15f6dd1dc6cd624cce2ef2c
Author: Necip Fazil Yildiran <fazilyildiran@gmail.com>
Date:   Mon Sep 14 17:40:26 2020 +0300

    pinctrl: bcm: fix kconfig dependency warning when !GPIOLIB
    
    [ Upstream commit 513034d8b089b9a49dab57845aee70e830fe7334 ]
    
    When PINCTRL_BCM2835 is enabled and GPIOLIB is disabled, it results in the
    following Kbuild warning:
    
    WARNING: unmet direct dependencies detected for GPIOLIB_IRQCHIP
      Depends on [n]: GPIOLIB [=n]
      Selected by [y]:
      - PINCTRL_BCM2835 [=y] && PINCTRL [=y] && OF [=y] && (ARCH_BCM2835 [=n] || ARCH_BRCMSTB [=n] || COMPILE_TEST [=y])
    
    The reason is that PINCTRL_BCM2835 selects GPIOLIB_IRQCHIP without
    depending on or selecting GPIOLIB while GPIOLIB_IRQCHIP is subordinate to
    GPIOLIB.
    
    Honor the kconfig menu hierarchy to remove kconfig dependency warnings.
    
    Fixes: 85ae9e512f43 ("pinctrl: bcm2835: switch to GPIOLIB_IRQCHIP")
    Signed-off-by: Necip Fazil Yildiran <fazilyildiran@gmail.com>
    Link: https://lore.kernel.org/r/20200914144025.371370-1-fazilyildiran@gmail.com
    Signed-off-by: Linus Walleij <linus.walleij@linaro.org>
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit 90036c9b3c8489a80630be71a28ab8eeb661c50d
Author: Christian Eggers <ceggers@arri.de>
Date:   Mon Oct 12 11:35:42 2020 +0200

    socket: don't clear SOCK_TSTAMP_NEW when SO_TIMESTAMPNS is disabled
    
    [ Upstream commit 4e3bbb33e6f36e4b05be1b1b9b02e3dd5aaa3e69 ]
    
    SOCK_TSTAMP_NEW (timespec64 instead of timespec) is also used for
    hardware time stamps (configured via SO_TIMESTAMPING_NEW).
    
    User space (ptp4l) first configures hardware time stamping via
    SO_TIMESTAMPING_NEW which sets SOCK_TSTAMP_NEW. In the next step, ptp4l
    disables SO_TIMESTAMPNS(_NEW) (software time stamps), but this must not
    switch hardware time stamps back to "32 bit mode".
    
    This problem happens on 32 bit platforms were the libc has already
    switched to struct timespec64 (from SO_TIMExxx_OLD to SO_TIMExxx_NEW
    socket options). ptp4l complains with "missing timestamp on transmitted
    peer delay request" because the wrong format is received (and
    discarded).
    
    Fixes: 887feae36aee ("socket: Add SO_TIMESTAMP[NS]_NEW")
    Fixes: 783da70e8396 ("net: add sock_enable_timestamps")
    Signed-off-by: Christian Eggers <ceggers@arri.de>
    Acked-by: Willem de Bruijn <willemb@google.com>
    Acked-by: Deepa Dinamani <deepa.kernel@gmail.com>
    Signed-off-by: Jakub Kicinski <kuba@kernel.org>
    Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>

commit 06bf6238fdb56b22e676cc2afe224ac9d13606d6
Author: Christian Eggers <ceggers@arri.de>
Date:   Mon Oct 12 11:35:41 2020 +0200

    socket: fix option SO_TIMESTAMPING_NEW
    
    [ Upstream commit 59e611a566e7cd48cf54b6777a11fe3f9c2f9db5 ]
    
    The comparison of optname with SO_TIMESTAMPING_NEW is wrong way around,
    so SOCK_TSTAMP_NEW will first be set and than reset again. Additionally
    move it out of the test for SOF_TIMESTAMPING_RX_SOFTWARE as this seems
    unrelated.
    
    This problem happens on 32 bit platforms were the libc has already
    switched to struct timespec64 (from SO_TIMExxx_OLD to SO_TIMExxx_NEW
    socket options). ptp4l complains with "missing timestamp on transmitted
    peer delay request" because the wrong format is received (and
    discarded).
    
    Fixes: 9718475e6908 ("socket: Add SO_TIMESTAMPING_NEW")
    Signed-off-by: Christian Eggers <ceggers@arri.de>
    Reviewed-by: Willem de Bruijn <willemdebruijn.kernel@gmail.com>
    Reviewed-by: Deepa Dinamani <deepa.kernel@gmail.com>
    Acked-by: Willem de Bruijn <willemb@google.com>
    Acked-by: Deepa Dinamani <deepa.kernel@gmail.com>
    Signed-off-by: Jakub Kicinski <kuba@kernel.org>
    Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>

commit 1e84d2a5c113c8bad4c5f166ca4e480ca87353a2
Author: Necip Fazil Yildiran <fazilyildiran@gmail.com>
Date:   Mon Sep 14 14:46:52 2020 +0300

    arc: plat-hsdk: fix kconfig dependency warning when !RESET_CONTROLLER
    
    [ Upstream commit 63bcf87cb1c57956e1179f1a78dde625c7e3cba7 ]
    
    When ARC_SOC_HSDK is enabled and RESET_CONTROLLER is disabled, it results
    in the following Kbuild warning:
    
    WARNING: unmet direct dependencies detected for RESET_HSDK
      Depends on [n]: RESET_CONTROLLER [=n] && HAS_IOMEM [=y] && (ARC_SOC_HSDK [=y] || COMPILE_TEST [=n])
      Selected by [y]:
      - ARC_SOC_HSDK [=y] && ISA_ARCV2 [=y]
    
    The reason is that ARC_SOC_HSDK selects RESET_HSDK without depending on or
    selecting RESET_CONTROLLER while RESET_HSDK is subordinate to
    RESET_CONTROLLER.
    
    Honor the kconfig menu hierarchy to remove kconfig dependency warnings.
    
    Fixes: a528629dfd3b ("ARC: [plat-hsdk] select CONFIG_RESET_HSDK from Kconfig")
    Signed-off-by: Necip Fazil Yildiran <fazilyildiran@gmail.com>
    Signed-off-by: Vineet Gupta <vgupta@synopsys.com>
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit 2d92aae41a064193fb9d0281707d4b4129a753dc
Author: Necip Fazil Yildiran <fazilyildiran@gmail.com>
Date:   Mon Sep 14 17:40:26 2020 +0300

    pinctrl: bcm: fix kconfig dependency warning when !GPIOLIB
    
    [ Upstream commit 513034d8b089b9a49dab57845aee70e830fe7334 ]
    
    When PINCTRL_BCM2835 is enabled and GPIOLIB is disabled, it results in the
    following Kbuild warning:
    
    WARNING: unmet direct dependencies detected for GPIOLIB_IRQCHIP
      Depends on [n]: GPIOLIB [=n]
      Selected by [y]:
      - PINCTRL_BCM2835 [=y] && PINCTRL [=y] && OF [=y] && (ARCH_BCM2835 [=n] || ARCH_BRCMSTB [=n] || COMPILE_TEST [=y])
    
    The reason is that PINCTRL_BCM2835 selects GPIOLIB_IRQCHIP without
    depending on or selecting GPIOLIB while GPIOLIB_IRQCHIP is subordinate to
    GPIOLIB.
    
    Honor the kconfig menu hierarchy to remove kconfig dependency warnings.
    
    Fixes: 85ae9e512f43 ("pinctrl: bcm2835: switch to GPIOLIB_IRQCHIP")
    Signed-off-by: Necip Fazil Yildiran <fazilyildiran@gmail.com>
    Link: https://lore.kernel.org/r/20200914144025.371370-1-fazilyildiran@gmail.com
    Signed-off-by: Linus Walleij <linus.walleij@linaro.org>
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit 575e9184885b292e053840f5c5a22e47bdfeae37
Author: Christian Eggers <ceggers@arri.de>
Date:   Mon Oct 12 11:35:42 2020 +0200

    socket: don't clear SOCK_TSTAMP_NEW when SO_TIMESTAMPNS is disabled
    
    [ Upstream commit 4e3bbb33e6f36e4b05be1b1b9b02e3dd5aaa3e69 ]
    
    SOCK_TSTAMP_NEW (timespec64 instead of timespec) is also used for
    hardware time stamps (configured via SO_TIMESTAMPING_NEW).
    
    User space (ptp4l) first configures hardware time stamping via
    SO_TIMESTAMPING_NEW which sets SOCK_TSTAMP_NEW. In the next step, ptp4l
    disables SO_TIMESTAMPNS(_NEW) (software time stamps), but this must not
    switch hardware time stamps back to "32 bit mode".
    
    This problem happens on 32 bit platforms were the libc has already
    switched to struct timespec64 (from SO_TIMExxx_OLD to SO_TIMExxx_NEW
    socket options). ptp4l complains with "missing timestamp on transmitted
    peer delay request" because the wrong format is received (and
    discarded).
    
    Fixes: 887feae36aee ("socket: Add SO_TIMESTAMP[NS]_NEW")
    Fixes: 783da70e8396 ("net: add sock_enable_timestamps")
    Signed-off-by: Christian Eggers <ceggers@arri.de>
    Acked-by: Willem de Bruijn <willemb@google.com>
    Acked-by: Deepa Dinamani <deepa.kernel@gmail.com>
    Signed-off-by: Jakub Kicinski <kuba@kernel.org>
    Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>

commit d2bc51dbdecdda9147fb29e90733662257e2479e
Author: Christian Eggers <ceggers@arri.de>
Date:   Mon Oct 12 11:35:41 2020 +0200

    socket: fix option SO_TIMESTAMPING_NEW
    
    [ Upstream commit 59e611a566e7cd48cf54b6777a11fe3f9c2f9db5 ]
    
    The comparison of optname with SO_TIMESTAMPING_NEW is wrong way around,
    so SOCK_TSTAMP_NEW will first be set and than reset again. Additionally
    move it out of the test for SOF_TIMESTAMPING_RX_SOFTWARE as this seems
    unrelated.
    
    This problem happens on 32 bit platforms were the libc has already
    switched to struct timespec64 (from SO_TIMExxx_OLD to SO_TIMExxx_NEW
    socket options). ptp4l complains with "missing timestamp on transmitted
    peer delay request" because the wrong format is received (and
    discarded).
    
    Fixes: 9718475e6908 ("socket: Add SO_TIMESTAMPING_NEW")
    Signed-off-by: Christian Eggers <ceggers@arri.de>
    Reviewed-by: Willem de Bruijn <willemdebruijn.kernel@gmail.com>
    Reviewed-by: Deepa Dinamani <deepa.kernel@gmail.com>
    Acked-by: Willem de Bruijn <willemb@google.com>
    Acked-by: Deepa Dinamani <deepa.kernel@gmail.com>
    Signed-off-by: Jakub Kicinski <kuba@kernel.org>
    Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>

commit 3789f5cfd60035d924433a14fb25f2caaafbdd1d
Author: Necip Fazil Yildiran <fazilyildiran@gmail.com>
Date:   Mon Sep 14 14:46:52 2020 +0300

    arc: plat-hsdk: fix kconfig dependency warning when !RESET_CONTROLLER
    
    [ Upstream commit 63bcf87cb1c57956e1179f1a78dde625c7e3cba7 ]
    
    When ARC_SOC_HSDK is enabled and RESET_CONTROLLER is disabled, it results
    in the following Kbuild warning:
    
    WARNING: unmet direct dependencies detected for RESET_HSDK
      Depends on [n]: RESET_CONTROLLER [=n] && HAS_IOMEM [=y] && (ARC_SOC_HSDK [=y] || COMPILE_TEST [=n])
      Selected by [y]:
      - ARC_SOC_HSDK [=y] && ISA_ARCV2 [=y]
    
    The reason is that ARC_SOC_HSDK selects RESET_HSDK without depending on or
    selecting RESET_CONTROLLER while RESET_HSDK is subordinate to
    RESET_CONTROLLER.
    
    Honor the kconfig menu hierarchy to remove kconfig dependency warnings.
    
    Fixes: a528629dfd3b ("ARC: [plat-hsdk] select CONFIG_RESET_HSDK from Kconfig")
    Signed-off-by: Necip Fazil Yildiran <fazilyildiran@gmail.com>
    Signed-off-by: Vineet Gupta <vgupta@synopsys.com>
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit fcf7bf4065902168f071cc430a5aa62328e644d7
Author: Necip Fazil Yildiran <fazilyildiran@gmail.com>
Date:   Mon Sep 14 17:40:26 2020 +0300

    pinctrl: bcm: fix kconfig dependency warning when !GPIOLIB
    
    [ Upstream commit 513034d8b089b9a49dab57845aee70e830fe7334 ]
    
    When PINCTRL_BCM2835 is enabled and GPIOLIB is disabled, it results in the
    following Kbuild warning:
    
    WARNING: unmet direct dependencies detected for GPIOLIB_IRQCHIP
      Depends on [n]: GPIOLIB [=n]
      Selected by [y]:
      - PINCTRL_BCM2835 [=y] && PINCTRL [=y] && OF [=y] && (ARCH_BCM2835 [=n] || ARCH_BRCMSTB [=n] || COMPILE_TEST [=y])
    
    The reason is that PINCTRL_BCM2835 selects GPIOLIB_IRQCHIP without
    depending on or selecting GPIOLIB while GPIOLIB_IRQCHIP is subordinate to
    GPIOLIB.
    
    Honor the kconfig menu hierarchy to remove kconfig dependency warnings.
    
    Fixes: 85ae9e512f43 ("pinctrl: bcm2835: switch to GPIOLIB_IRQCHIP")
    Signed-off-by: Necip Fazil Yildiran <fazilyildiran@gmail.com>
    Link: https://lore.kernel.org/r/20200914144025.371370-1-fazilyildiran@gmail.com
    Signed-off-by: Linus Walleij <linus.walleij@linaro.org>
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit c4099221dbc0e0f0b7539c1a4c42144cd544b66a
Author: Christian Eggers <ceggers@arri.de>
Date:   Mon Oct 12 11:35:41 2020 +0200

    socket: fix option SO_TIMESTAMPING_NEW
    
    [ Upstream commit 59e611a566e7cd48cf54b6777a11fe3f9c2f9db5 ]
    
    The comparison of optname with SO_TIMESTAMPING_NEW is wrong way around,
    so SOCK_TSTAMP_NEW will first be set and than reset again. Additionally
    move it out of the test for SOF_TIMESTAMPING_RX_SOFTWARE as this seems
    unrelated.
    
    This problem happens on 32 bit platforms were the libc has already
    switched to struct timespec64 (from SO_TIMExxx_OLD to SO_TIMExxx_NEW
    socket options). ptp4l complains with "missing timestamp on transmitted
    peer delay request" because the wrong format is received (and
    discarded).
    
    Fixes: 9718475e6908 ("socket: Add SO_TIMESTAMPING_NEW")
    Signed-off-by: Christian Eggers <ceggers@arri.de>
    Reviewed-by: Willem de Bruijn <willemdebruijn.kernel@gmail.com>
    Reviewed-by: Deepa Dinamani <deepa.kernel@gmail.com>
    Acked-by: Willem de Bruijn <willemb@google.com>
    Acked-by: Deepa Dinamani <deepa.kernel@gmail.com>
    Signed-off-by: Jakub Kicinski <kuba@kernel.org>
    Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>

commit 3882d3641aff02002cc5c9570b0dd99f9685063c
Author: Necip Fazil Yildiran <fazilyildiran@gmail.com>
Date:   Mon Sep 14 14:46:52 2020 +0300

    arc: plat-hsdk: fix kconfig dependency warning when !RESET_CONTROLLER
    
    [ Upstream commit 63bcf87cb1c57956e1179f1a78dde625c7e3cba7 ]
    
    When ARC_SOC_HSDK is enabled and RESET_CONTROLLER is disabled, it results
    in the following Kbuild warning:
    
    WARNING: unmet direct dependencies detected for RESET_HSDK
      Depends on [n]: RESET_CONTROLLER [=n] && HAS_IOMEM [=y] && (ARC_SOC_HSDK [=y] || COMPILE_TEST [=n])
      Selected by [y]:
      - ARC_SOC_HSDK [=y] && ISA_ARCV2 [=y]
    
    The reason is that ARC_SOC_HSDK selects RESET_HSDK without depending on or
    selecting RESET_CONTROLLER while RESET_HSDK is subordinate to
    RESET_CONTROLLER.
    
    Honor the kconfig menu hierarchy to remove kconfig dependency warnings.
    
    Fixes: a528629dfd3b ("ARC: [plat-hsdk] select CONFIG_RESET_HSDK from Kconfig")
    Signed-off-by: Necip Fazil Yildiran <fazilyildiran@gmail.com>
    Signed-off-by: Vineet Gupta <vgupta@synopsys.com>
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit 98f559201c875dcedffbb268c8308055db2dfeb8
Author: Necip Fazil Yildiran <fazilyildiran@gmail.com>
Date:   Mon Sep 14 17:40:26 2020 +0300

    pinctrl: bcm: fix kconfig dependency warning when !GPIOLIB
    
    [ Upstream commit 513034d8b089b9a49dab57845aee70e830fe7334 ]
    
    When PINCTRL_BCM2835 is enabled and GPIOLIB is disabled, it results in the
    following Kbuild warning:
    
    WARNING: unmet direct dependencies detected for GPIOLIB_IRQCHIP
      Depends on [n]: GPIOLIB [=n]
      Selected by [y]:
      - PINCTRL_BCM2835 [=y] && PINCTRL [=y] && OF [=y] && (ARCH_BCM2835 [=n] || ARCH_BRCMSTB [=n] || COMPILE_TEST [=y])
    
    The reason is that PINCTRL_BCM2835 selects GPIOLIB_IRQCHIP without
    depending on or selecting GPIOLIB while GPIOLIB_IRQCHIP is subordinate to
    GPIOLIB.
    
    Honor the kconfig menu hierarchy to remove kconfig dependency warnings.
    
    Fixes: 85ae9e512f43 ("pinctrl: bcm2835: switch to GPIOLIB_IRQCHIP")
    Signed-off-by: Necip Fazil Yildiran <fazilyildiran@gmail.com>
    Link: https://lore.kernel.org/r/20200914144025.371370-1-fazilyildiran@gmail.com
    Signed-off-by: Linus Walleij <linus.walleij@linaro.org>
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit f6cb0dcfee62a8b2f811b27714a7326ddc8a1087
Author: Necip Fazil Yildiran <fazilyildiran@gmail.com>
Date:   Mon Sep 14 14:46:52 2020 +0300

    arc: plat-hsdk: fix kconfig dependency warning when !RESET_CONTROLLER
    
    [ Upstream commit 63bcf87cb1c57956e1179f1a78dde625c7e3cba7 ]
    
    When ARC_SOC_HSDK is enabled and RESET_CONTROLLER is disabled, it results
    in the following Kbuild warning:
    
    WARNING: unmet direct dependencies detected for RESET_HSDK
      Depends on [n]: RESET_CONTROLLER [=n] && HAS_IOMEM [=y] && (ARC_SOC_HSDK [=y] || COMPILE_TEST [=n])
      Selected by [y]:
      - ARC_SOC_HSDK [=y] && ISA_ARCV2 [=y]
    
    The reason is that ARC_SOC_HSDK selects RESET_HSDK without depending on or
    selecting RESET_CONTROLLER while RESET_HSDK is subordinate to
    RESET_CONTROLLER.
    
    Honor the kconfig menu hierarchy to remove kconfig dependency warnings.
    
    Fixes: a528629dfd3b ("ARC: [plat-hsdk] select CONFIG_RESET_HSDK from Kconfig")
    Signed-off-by: Necip Fazil Yildiran <fazilyildiran@gmail.com>
    Signed-off-by: Vineet Gupta <vgupta@synopsys.com>
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit c39866f268f89868df17724cd2262d121552d8c9
Author: Nathan Chancellor <natechancellor@gmail.com>
Date:   Mon Sep 28 15:48:54 2020 -0700

    arm/build: Always handle .ARM.exidx and .ARM.extab sections
    
    After turning on warnings for orphan section placement, enabling
    CONFIG_UNWINDER_FRAME_POINTER instead of CONFIG_UNWINDER_ARM causes
    thousands of warnings when clang + ld.lld are used:
    
    $ scripts/config --file arch/arm/configs/multi_v7_defconfig \
                     -d CONFIG_UNWINDER_ARM \
                     -e CONFIG_UNWINDER_FRAME_POINTER
    $ make -skj"$(nproc)" ARCH=arm CROSS_COMPILE=arm-linux-gnueabi- LLVM=1 defconfig zImage
    ld.lld: warning: init/built-in.a(main.o):(.ARM.extab) is being placed in '.ARM.extab'
    ld.lld: warning: init/built-in.a(main.o):(.ARM.extab.init.text) is being placed in '.ARM.extab.init.text'
    ld.lld: warning: init/built-in.a(main.o):(.ARM.extab.ref.text) is being placed in '.ARM.extab.ref.text'
    ld.lld: warning: init/built-in.a(do_mounts.o):(.ARM.extab.init.text) is being placed in '.ARM.extab.init.text'
    ld.lld: warning: init/built-in.a(do_mounts.o):(.ARM.extab) is being placed in '.ARM.extab'
    ld.lld: warning: init/built-in.a(do_mounts_rd.o):(.ARM.extab.init.text) is being placed in '.ARM.extab.init.text'
    ld.lld: warning: init/built-in.a(do_mounts_rd.o):(.ARM.extab) is being placed in '.ARM.extab'
    ld.lld: warning: init/built-in.a(do_mounts_initrd.o):(.ARM.extab.init.text) is being placed in '.ARM.extab.init.text'
    ld.lld: warning: init/built-in.a(initramfs.o):(.ARM.extab.init.text) is being placed in '.ARM.extab.init.text'
    ld.lld: warning: init/built-in.a(initramfs.o):(.ARM.extab) is being placed in '.ARM.extab'
    ld.lld: warning: init/built-in.a(calibrate.o):(.ARM.extab.init.text) is being placed in '.ARM.extab.init.text'
    ld.lld: warning: init/built-in.a(calibrate.o):(.ARM.extab) is being placed in '.ARM.extab'
    
    These sections are handled by the ARM_UNWIND_SECTIONS define, which is
    only added to the list of sections when CONFIG_ARM_UNWIND is set.
    CONFIG_ARM_UNWIND is a hidden symbol that is only selected when
    CONFIG_UNWINDER_ARM is set so CONFIG_UNWINDER_FRAME_POINTER never
    handles these sections. According to the help text of
    CONFIG_UNWINDER_ARM, these sections should be discarded so that the
    kernel image size is not affected.
    
    Fixes: 5a17850e251a ("arm/build: Warn on orphan section placement")
    Link: https://github.com/ClangBuiltLinux/linux/issues/1152
    Reported-by: kernel test robot <lkp@intel.com>
    Signed-off-by: Nathan Chancellor <natechancellor@gmail.com>
    Review-by: Nick Desaulniers <ndesaulniers@google.com>
    Tested-by: Nick Desaulniers <ndesaulniers@google.com>
    [kees: Made the discard slightly more specific]
    Signed-off-by: Kees Cook <keescook@chromium.org>
    Link: https://lore.kernel.org/r/20200928224854.3224862-1-natechancellor@gmail.com

commit 4525c8781ec0701ce824e8bd379ae1b129e26568
Author: Linus Torvalds <torvalds@linux-foundation.org>
Date:   Mon Oct 26 15:45:22 2020 -0700

    scsi: qla2xxx: remove incorrect sparse #ifdef
    
    The code to try to shut up sparse warnings about questionable locking
    didn't shut up sparse: it made the result not parse as valid C at all,
    since the end result now has a label with no statement.
    
    The proper fix is to just always lock the hardware, the same way Bart
    did in commit 8ae178760b23 ("scsi: qla2xxx: Simplify the functions for
    dumping firmware").  That avoids the whole problem with having locking
    that is not statically obvious.
    
    But in the meantime, just remove the incorrect attempt at trying to
    avoid a sparse warning that just made things worse.
    
    This was exposed by commit 3e6efab865ac ("scsi: qla2xxx: Fix reset of
    MPI firmware"), very similarly to how commit cbb01c2f2f63 ("scsi:
    qla2xxx: Fix MPI failure AEN (8200) handling") exposed the same problem
    in another place, and caused that commit 8ae178760b23.
    
    Please don't add code to just shut up sparse without actually fixing
    what sparse complains about.
    
    Reported-by: Luc Van Oostenryck <luc.vanoostenryck@gmail.com>
    Cc: Bart Van Assche <bvanassche@acm.org>
    Cc: Arun Easi <aeasi@marvell.com>
    Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>

commit 0fa97e9403c767a4af63cfb5a3badbbe69426085
Author: Nathan Chancellor <natechancellor@gmail.com>
Date:   Mon Oct 19 18:14:07 2020 -0700

    arm64: vdso32: Allow ld.lld to properly link the VDSO
    
    As it stands now, the vdso32 Makefile hardcodes the linker to ld.bfd
    using -fuse-ld=bfd with $(CC). This was taken from the arm vDSO
    Makefile, as the comment notes, done in commit d2b30cd4b722 ("ARM:
    8384/1: VDSO: force use of BFD linker").
    
    Commit fe00e50b2db8 ("ARM: 8858/1: vdso: use $(LD) instead of $(CC) to
    link VDSO") changed that Makefile to use $(LD) directly instead of
    through $(CC), which matches how the rest of the kernel operates. Since
    then, LD=ld.lld means that the arm vDSO will be linked with ld.lld,
    which has shown no problems so far.
    
    Allow ld.lld to link this vDSO as we do the regular arm vDSO. To do
    this, we need to do a few things:
    
    * Add a LD_COMPAT variable, which defaults to $(CROSS_COMPILE_COMPAT)ld
      with gcc and $(LD) if LLVM is 1, which will be ld.lld, or
      $(CROSS_COMPILE_COMPAT)ld if not, which matches the logic of the main
      Makefile. It is overrideable for further customization and avoiding
      breakage.
    
    * Eliminate cc32-ldoption, which matches commit 055efab3120b ("kbuild:
      drop support for cc-ldoption").
    
    With those, we can use $(LD_COMPAT) in cmd_ldvdso and change the flags
    from compiler linker flags to linker flags directly. We eliminate
    -mfloat-abi=soft because it is not handled by the linker.
    
    Reported-by: Nick Desaulniers <ndesaulniers@google.com>
    Signed-off-by: Nathan Chancellor <natechancellor@gmail.com>
    Tested-by: Nick Desaulniers <ndesaulniers@google.com>
    Reviewed-by: Nick Desaulniers <ndesaulniers@google.com>
    Reviewed-by: Vincenzo Frascino <vincenzo.frascino@arm.com>
    Link: https://github.com/ClangBuiltLinux/linux/issues/1033
    Link: https://lore.kernel.org/r/20201020011406.1818918-1-natechancellor@gmail.com
    Signed-off-by: Will Deacon <will@kernel.org>

commit 746b25b1aa0f5736d585728ded70a8141da91edb
Merge: 2b71482060e1 1e66d50ad3a1
Author: Linus Torvalds <torvalds@linux-foundation.org>
Date:   Thu Oct 22 13:13:57 2020 -0700

    Merge tag 'kbuild-v5.10' of git://git.kernel.org/pub/scm/linux/kernel/git/masahiroy/linux-kbuild
    
    Pull Kbuild updates from Masahiro Yamada:
    
     - Support 'make compile_commands.json' to generate the compilation
       database more easily, avoiding stale entries
    
     - Support 'make clang-analyzer' and 'make clang-tidy' for static checks
       using clang-tidy
    
     - Preprocess scripts/modules.lds.S to allow CONFIG options in the
       module linker script
    
     - Drop cc-option tests from compiler flags supported by our minimal
       GCC/Clang versions
    
     - Use always 12-digits commit hash for CONFIG_LOCALVERSION_AUTO=y
    
     - Use sha1 build id for both BFD linker and LLD
    
     - Improve deb-pkg for reproducible builds and rootless builds
    
     - Remove stale, useless scripts/namespace.pl
    
     - Turn -Wreturn-type warning into error
    
     - Fix build error of deb-pkg when CONFIG_MODULES=n
    
     - Replace 'hostname' command with more portable 'uname -n'
    
     - Various Makefile cleanups
    
    * tag 'kbuild-v5.10' of git://git.kernel.org/pub/scm/linux/kernel/git/masahiroy/linux-kbuild: (34 commits)
      kbuild: Use uname for LINUX_COMPILE_HOST detection
      kbuild: Only add -fno-var-tracking-assignments for old GCC versions
      kbuild: remove leftover comment for filechk utility
      treewide: remove DISABLE_LTO
      kbuild: deb-pkg: clean up package name variables
      kbuild: deb-pkg: do not build linux-headers package if CONFIG_MODULES=n
      kbuild: enforce -Werror=return-type
      scripts: remove namespace.pl
      builddeb: Add support for all required debian/rules targets
      builddeb: Enable rootless builds
      builddeb: Pass -n to gzip for reproducible packages
      kbuild: split the build log of kallsyms
      kbuild: explicitly specify the build id style
      scripts/setlocalversion: make git describe output more reliable
      kbuild: remove cc-option test of -Werror=date-time
      kbuild: remove cc-option test of -fno-stack-check
      kbuild: remove cc-option test of -fno-strict-overflow
      kbuild: move CFLAGS_{KASAN,UBSAN,KCSAN} exports to relevant Makefiles
      kbuild: remove redundant CONFIG_KASAN check from scripts/Makefile.kasan
      kbuild: do not create built-in objects for external module builds
      ...

commit 1553d96854b47953e41e7f66b2bdbc1c0d13a3e5
Merge: 3fec0eaaf04a 141bc97c1bfe
Author: Linus Torvalds <torvalds@linux-foundation.org>
Date:   Thu Oct 22 12:56:33 2020 -0700

    Merge tag 'rproc-v5.10' of git://git.kernel.org/pub/scm/linux/kernel/git/andersson/remoteproc
    
    Pull remoteproc updates from Bjorn Andersson:
     "This introduces support for the Mediatek MT9182 SCP and controlling
      the Cortex R5F processors found in TI K3 platforms. It clones the
      longstanding debugfs interface for controlling crash handling to
      sysfs. Lastly it solves a bug where after a warm reset of Qualcomm
      platforms the modem would crash upon first boot"
    
    * tag 'rproc-v5.10' of git://git.kernel.org/pub/scm/linux/kernel/git/andersson/remoteproc:
      remoteproc/mediatek: Remove non-standard dsb()
      remoteproc: Add recovery configuration to the sysfs interface
      remoteproc: Add coredump as part of sysfs interface
      remoteproc: Change default dump configuration to "disabled"
      remoteproc: k3-r5: Add loading support for on-chip SRAM regions
      remoteproc: k3-r5: Initialize TCM memories for ECC
      remoteproc: k3-r5: Add a remoteproc driver for R5F subsystem
      dt-bindings: remoteproc: Add bindings for R5F subsystem on TI K3 SoCs
      remoteproc/mediatek: Add support for mt8192 SCP
      remoteproc: Fixup coredump debugfs disable request
      remoteproc: qcom_q6v5: Assign mpss region to Q6 before MBA boot
      remoteproc/mediatek: fix null pointer dereference on null scp pointer
      remoteproc: stm32: Fix pointer assignement
      remoteproc: scp: add COMPILE_TEST dependency

commit 1e66d50ad3a1dbf0169b14d502be59a4b1213149
Author: Chris Down <chris@chrisdown.name>
Date:   Tue Oct 20 10:34:59 2020 +0100

    kbuild: Use uname for LINUX_COMPILE_HOST detection
    
    `hostname` may not be present on some systems as it's not mandated by
    POSIX/SUSv4. This isn't just a theoretical problem: on Arch Linux,
    `hostname` is provided by `inetutils`, which isn't part of the base
    distribution.
    
        ./scripts/mkcompile_h: line 38: hostname: command not found
    
    Use `uname -n` instead, which is more likely to be available (and
    mandated by standards).
    
    Signed-off-by: Chris Down <chris@chrisdown.name>
    Signed-off-by: Masahiro Yamada <masahiroy@kernel.org>

commit 7cf726a59435301046250c42131554d9ccc566b8
Merge: 41eea65e2aaa 294a7f1613ee
Author: Linus Torvalds <torvalds@linux-foundation.org>
Date:   Sun Oct 18 14:45:59 2020 -0700

    Merge tag 'linux-kselftest-kunit-5.10-rc1' of git://git.kernel.org/pub/scm/linux/kernel/git/shuah/linux-kselftest
    
    Pull more Kunit updates from Shuah Khan:
    
     - add Kunit to kernel_init() and remove KUnit from init calls entirely.
    
       This addresses the concern that Kunit would not work correctly during
       late init phase.
    
     - add a linker section where KUnit can put references to its test
       suites.
    
       This is the first step in transitioning to dispatching all KUnit
       tests from a centralized executor rather than having each as its own
       separate late_initcall.
    
     - add a centralized executor to dispatch tests rather than relying on
       late_initcall to schedule each test suite separately. Centralized
       execution is for built-in tests only; modules will execute tests when
       loaded.
    
     - convert bitfield test to use KUnit framework
    
     - Documentation updates for naming guidelines and how
       kunit_test_suite() works.
    
     - add test plan to KUnit TAP format
    
    * tag 'linux-kselftest-kunit-5.10-rc1' of git://git.kernel.org/pub/scm/linux/kernel/git/shuah/linux-kselftest:
      lib: kunit: Fix compilation test when using TEST_BIT_FIELD_COMPILE
      lib: kunit: add bitfield test conversion to KUnit
      Documentation: kunit: add a brief blurb about kunit_test_suite
      kunit: test: add test plan to KUnit TAP format
      init: main: add KUnit to kernel init
      kunit: test: create a single centralized executor for all tests
      vmlinux.lds.h: add linker section for KUnit test suites
      Documentation: kunit: Add naming guidelines

commit 444a6d0fe930838444abf7c9ff5175f93e1a5d72
Author: Dmitry Golovin <dima@golovin.in>
Date:   Tue Nov 19 16:39:42 2019 +0100

    ARM: 8939/1: kbuild: use correct nm executable
    
    [ Upstream commit 29c623d64f0dcd6aa10e0eabd16233e77114090b ]
    
    Since $(NM) variable can be easily overridden for the whole build, it's
    better to use it instead of $(CROSS_COMPILE)nm. The use of $(CROSS_COMPILE)
    prefixed variables where their calculated equivalents can be used is
    incorrect. This fixes issues with builds where $(NM) is set to llvm-nm.
    
    Link: https://github.com/ClangBuiltLinux/linux/issues/766
    
    Signed-off-by: Dmitry Golovin <dima@golovin.in>
    Suggested-by: Nick Desaulniers <ndesaulniers@google.com>
    Cc: Matthias Maennich <maennich@google.com>
    Reviewed-by: Nathan Chancellor <natechancellor@gmail.com>
    Tested-by: Nathan Chancellor <natechancellor@gmail.com>
    Reviewed-by: Masahiro Yamada <yamada.masahiro@socionext.com>
    Reviewed-by: Nick Desaulniers <ndesaulniers@google.com>
    Signed-off-by: Russell King <rmk+kernel@armlinux.org.uk>
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit 30ddaa4c0c958c7e9e25897170c6c7a5efb2adb3
Author: Dmitry Golovin <dima@golovin.in>
Date:   Tue Nov 19 16:39:42 2019 +0100

    ARM: 8939/1: kbuild: use correct nm executable
    
    [ Upstream commit 29c623d64f0dcd6aa10e0eabd16233e77114090b ]
    
    Since $(NM) variable can be easily overridden for the whole build, it's
    better to use it instead of $(CROSS_COMPILE)nm. The use of $(CROSS_COMPILE)
    prefixed variables where their calculated equivalents can be used is
    incorrect. This fixes issues with builds where $(NM) is set to llvm-nm.
    
    Link: https://github.com/ClangBuiltLinux/linux/issues/766
    
    Signed-off-by: Dmitry Golovin <dima@golovin.in>
    Suggested-by: Nick Desaulniers <ndesaulniers@google.com>
    Cc: Matthias Maennich <maennich@google.com>
    Reviewed-by: Nathan Chancellor <natechancellor@gmail.com>
    Tested-by: Nathan Chancellor <natechancellor@gmail.com>
    Reviewed-by: Masahiro Yamada <yamada.masahiro@socionext.com>
    Reviewed-by: Nick Desaulniers <ndesaulniers@google.com>
    Signed-off-by: Russell King <rmk+kernel@armlinux.org.uk>
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit 294a7f1613ee49a608361bd319519561c0ca7e72
Author: Vitor Massaru Iha <vitor@massaru.org>
Date:   Thu Oct 15 09:08:51 2020 -0300

    lib: kunit: Fix compilation test when using TEST_BIT_FIELD_COMPILE
    
    A build condition was missing around a compilation test, this compilation
    test comes from the original test_bitfield code.
    
    And removed unnecessary code for this test.
    
    Fixes: d2585f5164c2 ("lib: kunit: add bitfield test conversion to KUnit")
    Reported-by: Stephen Rothwell <sfr@canb.auug.org.au>
    Signed-off-by: Vitor Massaru Iha <vitor@massaru.org>
    Link: https://lore.kernel.org/linux-next/20201015163056.56fcc835@canb.auug.org.au/
    Reviewed-by: Brendan Higgins <brendanhiggins@google.com>
    Signed-off-by: Shuah Khan <skhan@linuxfoundation.org>

commit 1a31c12371556bfbe511edd268dab721b504d511
Merge: f888bdf9823c 6d81dc3c79d4
Author: Linus Torvalds <torvalds@linux-foundation.org>
Date:   Wed Oct 14 15:56:58 2020 -0700

    Merge tag 'mfd-next-5.10' of git://git.kernel.org/pub/scm/linux/kernel/git/lee/mfd
    
    Pull MFD updates from Lee Jones:
     "New Drivers:
       - Add support for initialising shared (between children) Regmaps
       - Add support for Kontron SL28CPLD
       - Add support for ENE KB3930 Embedded Controller
       - Add support for Intel FPGA PAC MAX 10 BMC
    
      New Device Support:
       - Add support for Power to Ricoh RN5T618
       - Add support for UART to Intel Lakefield
       - Add support for LP87524_Q1 to Texas Instruments LP87565
    
      New Functionality:
       - Device Tree; ene-kb3930, sl28cpld, syscon, lp87565, lp87524-q1
       - Use new helper dev_err_probe(); madera-core, stmfx, wcd934x
       - Use new GPIOD API; dm355evm_msp
       - Add wake-up capability; sprd-sc27xx-spi
       - Add ACPI support; kempld-core
    
      Fix-ups:
       - Trivial (spelling/whitespace); Kconfig, ab8500
       - Fix for unused variables; khadas-mcu, kempld-core
       - Remove unused header file(s); mt6360-core
       - Use correct IRQ flags in docs; act8945a, gateworks-gsc, rohm,bd70528-pmic
       - Add COMPILE_TEST support; asic3, tmio_core
       - Add dependency on I2C; SL28CPLD
    
      Bug Fixes:
       - Fix memory leak(s); sm501
       - Do not free regmap_config's 'name' until exit; syscon"
    
    * tag 'mfd-next-5.10' of git://git.kernel.org/pub/scm/linux/kernel/git/lee/mfd: (34 commits)
      mfd: kempld-core: Fix unused variable 'kempld_acpi_table' when !ACPI
      mfd: sl28cpld: Depend on I2C
      mfd: asic3: Build if COMPILE_TEST=y
      dt-bindings: mfd: Correct interrupt flags in examples
      mfd: Add ACPI support to Kontron PLD driver
      mfd: intel-m10-bmc: Add Intel MAX 10 BMC chip support for Intel FPGA PAC
      mfd: lp87565: Add LP87524-Q1 variant
      dt-bindings: mfd: Add LP87524-Q1
      dt-bindings: mfd: lp87565: Convert to yaml
      mfd: mt6360: Remove unused include <linux/version.h>
      mfd: sm501: Fix leaks in probe()
      mfd: syscon: Don't free allocated name for regmap_config
      dt-bindings: mfd: syscon: Document Exynos3 and Exynos5433 compatibles
      dt-bindings: mfd: syscon: Merge Samsung Exynos Sysreg bindings
      dt-bindings: mfd: ab8500: Remove weird Unicode characters
      mfd: sprd: Add wakeup capability for PMIC IRQ
      mfd: intel-lpss: Add device IDs for UART ports for Lakefield
      mfd: dm355evm_msp: Convert LEDs to GPIO descriptor table
      mfd: wcd934x: Simplify with dev_err_probe()
      mfd: stmfx: Simplify with dev_err_probe()
      ...

commit 4e3bbb33e6f36e4b05be1b1b9b02e3dd5aaa3e69
Author: Christian Eggers <ceggers@arri.de>
Date:   Mon Oct 12 11:35:42 2020 +0200

    socket: don't clear SOCK_TSTAMP_NEW when SO_TIMESTAMPNS is disabled
    
    SOCK_TSTAMP_NEW (timespec64 instead of timespec) is also used for
    hardware time stamps (configured via SO_TIMESTAMPING_NEW).
    
    User space (ptp4l) first configures hardware time stamping via
    SO_TIMESTAMPING_NEW which sets SOCK_TSTAMP_NEW. In the next step, ptp4l
    disables SO_TIMESTAMPNS(_NEW) (software time stamps), but this must not
    switch hardware time stamps back to "32 bit mode".
    
    This problem happens on 32 bit platforms were the libc has already
    switched to struct timespec64 (from SO_TIMExxx_OLD to SO_TIMExxx_NEW
    socket options). ptp4l complains with "missing timestamp on transmitted
    peer delay request" because the wrong format is received (and
    discarded).
    
    Fixes: 887feae36aee ("socket: Add SO_TIMESTAMP[NS]_NEW")
    Fixes: 783da70e8396 ("net: add sock_enable_timestamps")
    Signed-off-by: Christian Eggers <ceggers@arri.de>
    Acked-by: Willem de Bruijn <willemb@google.com>
    Acked-by: Deepa Dinamani <deepa.kernel@gmail.com>
    Signed-off-by: Jakub Kicinski <kuba@kernel.org>

commit 59e611a566e7cd48cf54b6777a11fe3f9c2f9db5
Author: Christian Eggers <ceggers@arri.de>
Date:   Mon Oct 12 11:35:41 2020 +0200

    socket: fix option SO_TIMESTAMPING_NEW
    
    The comparison of optname with SO_TIMESTAMPING_NEW is wrong way around,
    so SOCK_TSTAMP_NEW will first be set and than reset again. Additionally
    move it out of the test for SOF_TIMESTAMPING_RX_SOFTWARE as this seems
    unrelated.
    
    This problem happens on 32 bit platforms were the libc has already
    switched to struct timespec64 (from SO_TIMExxx_OLD to SO_TIMExxx_NEW
    socket options). ptp4l complains with "missing timestamp on transmitted
    peer delay request" because the wrong format is received (and
    discarded).
    
    Fixes: 9718475e6908 ("socket: Add SO_TIMESTAMPING_NEW")
    Signed-off-by: Christian Eggers <ceggers@arri.de>
    Reviewed-by: Willem de Bruijn <willemdebruijn.kernel@gmail.com>
    Reviewed-by: Deepa Dinamani <deepa.kernel@gmail.com>
    Acked-by: Willem de Bruijn <willemb@google.com>
    Acked-by: Deepa Dinamani <deepa.kernel@gmail.com>
    Signed-off-by: Jakub Kicinski <kuba@kernel.org>

commit 647412daeb454b6dad12a6c6961ab90aac9e5d29
Merge: dfef313e9990 1e23400f1a73
Author: Linus Torvalds <torvalds@linux-foundation.org>
Date:   Tue Oct 13 09:25:24 2020 -0700

    Merge tag 'mmc-v5.10' of git://git.kernel.org/pub/scm/linux/kernel/git/ulfh/mmc
    
    Pull MMC updates from Ulf Hansson:
     "MMC core:
       - Export SDIO revision and info strings to userspace
       - Add support for specifying mmc/mmcblk index via mmc aliases in DT
    
     MMC host:
       - Enable support for async probe for all mmc host drivers
       - Enable compile testing of multiple host drivers
       - dw_mmc: Enable the Synopsys DesignWare driver for RISCV and CSKY
       - mtk-sd: Fixup support for CQHCI
       - owl-mmc: Add support for the actions,s700-mmc variant
       - renesas_sdhi: Fix regression (temporary) for re-insertion of SD cards
       - renesas_sdhi: Add support for the r8a774e1 variant
       - renesas_sdhi/tmio: Improvements for tunings
       - renesas_sdhi/tmio: Rework support for reset of controller
       - sdhci-acpi: Fix HS400 tuning for devices with invalid presets on AMDI0040
       - sdhci_am654: Improve support for tunings
       - sdhci_am654: Add support for input tap delays
       - sdhci_am654: Add workaround for card detect debounce timer
       - sdhci-am654: Add support for the TI's J7200 variants
       - sdhci-esdhc-imx: Fix support for manual tuning
       - sdhci-iproc: Enable support for eMMC DDR 3.3V for bcm2711
       - sdhci-msm: Fix stability issues with HS400 for sc7180
       - sdhci-of-sparx5: Add Sparx5 SoC eMMC driver
       - sdhci-of-esdhc: Fixup reference clock source selection
       - sdhci-pci: Add LTR support for some Intel BYT controllers
       - sdhci-pci-gli: Add CQHCI Support for GL9763E"
    
    * tag 'mmc-v5.10' of git://git.kernel.org/pub/scm/linux/kernel/git/ulfh/mmc: (91 commits)
      mmc: sdhci_am654: Fix module autoload
      mmc: renesas_sdhi: workaround a regression when reinserting SD cards
      mmc: sdhci-pci-gli: Add CQHCI Support for GL9763E
      mmc: sdhci-acpi: AMDI0040: Set SDHCI_QUIRK2_PRESET_VALUE_BROKEN
      mmc: sdhci_am654: Enable tuning for SDR50
      mmc: sdhci_am654: Add support for software tuning
      mmc: sdhci_am654: Add support for input tap delay
      mmc: sdhci_am654: Fix hard coded otap delay array size
      dt-bindings: mmc: sdhci-am654: Add documentation for input tap delay
      dt-bindings: mmc: sdhci-am654: Convert sdhci-am654 controller documentation to json schema
      mmc: sdhci-of-esdhc: fix reference clock source selection
      mmc: host: fix depends for MMC_MESON_GX w/ COMPILE_TEST
      mmc: sdhci-s3c: hide forward declaration of of_device_id behind CONFIG_OF
      mmc: sdhci: fix indentation mistakes
      mmc: moxart: remove unneeded check for drvdata
      mmc: renesas_sdhi: drop local flag for tuning
      mmc: rtsx_usb_sdmmc: simplify the return expression of sd_change_phase()
      mmc: core: document mmc_hw_reset()
      mmc: mediatek: Drop pointer to mmc_host from msdc_host
      dt-bindings: mmc: owl: add compatible string actions,s700-mmc
      ...

commit 6402f4ce95811db7df72244ca84860332e4c2518
Author: Vignesh Raghavendra <vigneshr@ti.com>
Date:   Mon Oct 12 12:39:58 2020 +0530

    mtd: hyperbus: Fix build failure when only RPCIF_HYPERBUS is enabled
    
    commit 5de15b610f78 ("mtd: hyperbus: add Renesas RPC-IF driver") leads
    to build failure[1] with COMPILE_TEST and RPCIF_HYPERBUS enabled. This
    is because driver needs functions RENESAS_RPCIF which is only buildable
    for CONFIG_ARCH_RENESAS.
    
    Fix this by dropping COMPILE_TEST from RPCIF_HYPERBUS Kconfig entry.
    This ensures driver can be built only when RENESAS_RPCIF is also
    selected.
    
    [1]:
    rpc-if.c:(.text+0x20): undefined reference to `rpcif_disable_rpm' ld:
    drivers/mtd/hyperbus/rpc-if.o: in function `rpcif_hb_prepare_read':
    rpc-if.c:(.text+0xd6): undefined reference to `rpcif_prepare' ld:
    drivers/mtd/hyperbus/rpc-if.o: in function `rpcif_hb_read16':
    [...]
    
    Fixes: 5de15b610f78 ("mtd: hyperbus: add Renesas RPC-IF driver") leads
    Reported-by: Richard Weinberger <richard@nod.at>
    Signed-off-by: Vignesh Raghavendra <vigneshr@ti.com>
    Signed-off-by: Richard Weinberger <richard@nod.at>

commit 6734e20e39207556e17d72b5c4950d8f3a4f2de2
Merge: d04a248f1f6c d13027bb35e0
Author: Linus Torvalds <torvalds@linux-foundation.org>
Date:   Mon Oct 12 10:00:51 2020 -0700

    Merge tag 'arm64-upstream' of git://git.kernel.org/pub/scm/linux/kernel/git/arm64/linux
    
    Pull arm64 updates from Will Deacon:
     "There's quite a lot of code here, but much of it is due to the
      addition of a new PMU driver as well as some arm64-specific selftests
      which is an area where we've traditionally been lagging a bit.
    
      In terms of exciting features, this includes support for the Memory
      Tagging Extension which narrowly missed 5.9, hopefully allowing
      userspace to run with use-after-free detection in production on CPUs
      that support it. Work is ongoing to integrate the feature with KASAN
      for 5.11.
    
      Another change that I'm excited about (assuming they get the hardware
      right) is preparing the ASID allocator for sharing the CPU page-table
      with the SMMU. Those changes will also come in via Joerg with the
      IOMMU pull.
    
      We do stray outside of our usual directories in a few places, mostly
      due to core changes required by MTE. Although much of this has been
      Acked, there were a couple of places where we unfortunately didn't get
      any review feedback.
    
      Other than that, we ran into a handful of minor conflicts in -next,
      but nothing that should post any issues.
    
      Summary:
    
       - Userspace support for the Memory Tagging Extension introduced by
         Armv8.5. Kernel support (via KASAN) is likely to follow in 5.11.
    
       - Selftests for MTE, Pointer Authentication and FPSIMD/SVE context
         switching.
    
       - Fix and subsequent rewrite of our Spectre mitigations, including
         the addition of support for PR_SPEC_DISABLE_NOEXEC.
    
       - Support for the Armv8.3 Pointer Authentication enhancements.
    
       - Support for ASID pinning, which is required when sharing
         page-tables with the SMMU.
    
       - MM updates, including treating flush_tlb_fix_spurious_fault() as a
         no-op.
    
       - Perf/PMU driver updates, including addition of the ARM CMN PMU
         driver and also support to handle CPU PMU IRQs as NMIs.
    
       - Allow prefetchable PCI BARs to be exposed to userspace using normal
         non-cacheable mappings.
    
       - Implementation of ARCH_STACKWALK for unwinding.
    
       - Improve reporting of unexpected kernel traps due to BPF JIT
         failure.
    
       - Improve robustness of user-visible HWCAP strings and their
         corresponding numerical constants.
    
       - Removal of TEXT_OFFSET.
    
       - Removal of some unused functions, parameters and prototypes.
    
       - Removal of MPIDR-based topology detection in favour of firmware
         description.
    
       - Cleanups to handling of SVE and FPSIMD register state in
         preparation for potential future optimisation of handling across
         syscalls.
    
       - Cleanups to the SDEI driver in preparation for support in KVM.
    
       - Miscellaneous cleanups and refactoring work"
    
    * tag 'arm64-upstream' of git://git.kernel.org/pub/scm/linux/kernel/git/arm64/linux: (148 commits)
      Revert "arm64: initialize per-cpu offsets earlier"
      arm64: random: Remove no longer needed prototypes
      arm64: initialize per-cpu offsets earlier
      kselftest/arm64: Check mte tagged user address in kernel
      kselftest/arm64: Verify KSM page merge for MTE pages
      kselftest/arm64: Verify all different mmap MTE options
      kselftest/arm64: Check forked child mte memory accessibility
      kselftest/arm64: Verify mte tag inclusion via prctl
      kselftest/arm64: Add utilities and a test to validate mte memory
      perf: arm-cmn: Fix conversion specifiers for node type
      perf: arm-cmn: Fix unsigned comparison to less than zero
      arm64: dbm: Invalidate local TLB when setting TCR_EL1.HD
      arm64: mm: Make flush_tlb_fix_spurious_fault() a no-op
      arm64: Add support for PR_SPEC_DISABLE_NOEXEC prctl() option
      arm64: Pull in task_stack_page() to Spectre-v4 mitigation code
      KVM: arm64: Allow patching EL2 vectors even with KASLR is not enabled
      arm64: Get rid of arm64_ssbd_state
      KVM: arm64: Convert ARCH_WORKAROUND_2 to arm64_get_spectre_v4_state()
      KVM: arm64: Get rid of kvm_arm_have_ssbd()
      KVM: arm64: Simplify handling of ARCH_WORKAROUND_2
      ...

commit bf296b35489b46780b73b74ad984d06750ed5479
Author: Randy Dunlap <rdunlap@infradead.org>
Date:   Sun Oct 11 16:01:31 2020 -0700

    drm/aspeed: Fix Kconfig warning & subsequent build errors
    
    Kernel test robot reported build errors (undefined references)
    that didn't make much sense. After reproducing them, there is also
    a Kconfig warning that is the root cause of the build errors, so
    fix that Kconfig problem.
    
    Fixes this Kconfig warning:
    WARNING: unmet direct dependencies detected for CMA
      Depends on [n]: MMU [=n]
      Selected by [m]:
      - DRM_ASPEED_GFX [=m] && HAS_IOMEM [=y] && DRM [=m] && OF [=y] && (COMPILE_TEST [=y] || ARCH_ASPEED) && HAVE_DMA_CONTIGUOUS [=y]
    
    and these dependent build errors:
    (.text+0x10c8c): undefined reference to `start_isolate_page_range'
    microblaze-linux-ld: (.text+0x10f14): undefined reference to `test_pages_isolated'
    microblaze-linux-ld: (.text+0x10fd0): undefined reference to `undo_isolate_page_range'
    
    Fixes: 76356a966e33 ("drm: aspeed: Clean up Kconfig options")
    Reported-by: kernel test robot <lkp@intel.com>
    Signed-off-by: Randy Dunlap <rdunlap@infradead.org>
    Reviewed-by: Joel Stanley <joel@jms.id.au>
    Cc: Joel Stanley <joel@jms.id.au>
    Cc: Andrew Jeffery <andrew@aj.id.au>
    Cc: Daniel Vetter <daniel.vetter@ffwll.ch>
    Cc: Michal Simek <monstr@monstr.eu>
    Cc: Andrew Morton <akpm@linux-foundation.org>
    Cc: Mike Rapoport <rppt@linux.ibm.com>
    Cc: linux-mm@kvack.org
    Cc: linux-aspeed@lists.ozlabs.org
    Cc: linux-arm-kernel@lists.infradead.org
    Cc: David Airlie <airlied@linux.ie>
    Cc: dri-devel@lists.freedesktop.org
    Signed-off-by: Joel Stanley <joel@jms.id.au>
    Link: https://patchwork.freedesktop.org/patch/msgid/20201011230131.4922-1-rdunlap@infradead.org
    Signed-off-by: Joel Stanley <joel@jms.id.au>

commit f091d7c5fe6cc39e916b50f90e3cac67a032d0be
Author: Alexandru Ardelean <alexandru.ardelean@analog.com>
Date:   Wed Sep 30 16:50:47 2020 +0300

    iio: adc: at91_adc: add Kconfig dep on the OF symbol and remove of_match_ptr()
    
    This tries to solve a warning reported by the lkp bot:
    
    >> drivers/iio/adc/at91_adc.c:1439:34: warning: unused variable
    >> 'at91_adc_dt_ids' [-Wunused-const-variable]
       static const struct of_device_id at91_adc_dt_ids[] = {
                                        ^
       1 warning generated.
    
    This warning has appeared after the AT91_ADC driver compilation has been
    enabled via the COMPILE_TEST symbol dependency.
    
    The warning is caused by the 'of_match_ptr()' helper which returns NULL if
    OF is undefined. This driver should build only for device-tree context, so
    a dependency on the OF Kconfig symbol has been added.
    Also, the usage of of_match_ptr() helper has been removed since it
    shouldn't ever return NULL (because the driver should not be built for the
    non-OF context).
    
    Fixes: 4027860dcc4c ("iio: Kconfig: at91_adc: add COMPILE_TEST dependency to driver")
    Reported-by: kernel test robot <lkp@intel.com>
    Signed-off-by: Alexandru Ardelean <alexandru.ardelean@analog.com>
    Reviewed-by: Alexandre Belloni <alexandre.belloni@bootlin.com>
    Link: https://lore.kernel.org/r/20200930135048.11530-4-alexandru.ardelean@analog.com
    Signed-off-by: Jonathan Cameron <Jonathan.Cameron@huawei.com>

commit 63bcf87cb1c57956e1179f1a78dde625c7e3cba7
Author: Necip Fazil Yildiran <fazilyildiran@gmail.com>
Date:   Mon Sep 14 14:46:52 2020 +0300

    arc: plat-hsdk: fix kconfig dependency warning when !RESET_CONTROLLER
    
    When ARC_SOC_HSDK is enabled and RESET_CONTROLLER is disabled, it results
    in the following Kbuild warning:
    
    WARNING: unmet direct dependencies detected for RESET_HSDK
      Depends on [n]: RESET_CONTROLLER [=n] && HAS_IOMEM [=y] && (ARC_SOC_HSDK [=y] || COMPILE_TEST [=n])
      Selected by [y]:
      - ARC_SOC_HSDK [=y] && ISA_ARCV2 [=y]
    
    The reason is that ARC_SOC_HSDK selects RESET_HSDK without depending on or
    selecting RESET_CONTROLLER while RESET_HSDK is subordinate to
    RESET_CONTROLLER.
    
    Honor the kconfig menu hierarchy to remove kconfig dependency warnings.
    
    Fixes: a528629dfd3b ("ARC: [plat-hsdk] select CONFIG_RESET_HSDK from Kconfig")
    Signed-off-by: Necip Fazil Yildiran <fazilyildiran@gmail.com>
    Signed-off-by: Vineet Gupta <vgupta@synopsys.com>

commit 1a4c450e57d2d7030f64379e3e80966a4ea71eb7
Merge: 2bc8831b135c 6cbfa11d2694
Author: Mark Brown <broonie@kernel.org>
Date:   Fri Oct 2 15:49:12 2020 +0100

    Merge series "ASoC: Intel: Catpt - Lynx and Wildcat point" from Cezary Rojewski <cezary.rojewski@intel.com>:
    
    Implement support for Lynxpoint and Wildcat Point AudioDSP. Catpt
    solution deprecates existing sound/soc/intel/haswell which is removed in
    the following series.
    
    Due to high range of errors and desynchronization from recommendations
    set by Windows solution, re-write came as a lower-cost solution compared
    to refactoring /haswell/ with several series of patches.
    
    Series is dependent on linux-spi change:
    spi: pxa2xx: Add SSC2 and SSPSP2 SSP registers
    https://www.spinics.net/lists/linux-spi/msg23885.html
    which has been already merged and is now part of linux-spi tree.
    
    Bulk of series content is device driver core code - everything up to
    patch 7/14 - with fs entries and trace macros introduced right after.
    While each core patch is shaped in such a way that no unavailable
    members are ever called, until patch 14/14 is applied, no code
    compilation can occur as no Makefile is present. Once said patch is
    added, Makefile and Kconfig are implemented and driver module compiles
    as expected.
    
    Special thanks go to Marcin Barlik and Piotr Papierkowski for sharing
    their LPT/WPT AudioDSP architecture expertise as well as helping
    backtrack its historical background.
    My thanks go to Amadeusz Slawinski for reviews and improvements proposed
    on and off the internal list. Most of internal diff below is his
    contribution.
    Krzysztof Hejmowski helped me setup my own Xtensa environment and
    recompile LPT/WPT FW binary sources what sped up the development greatly.
    
    This would not have been possible without help from these champions,
    especially considering how quickly the catpt was written: 2 weeks
    features, 3 weeks optimizations. Thank you.
    
    Userspace-exposed members are compatible with what is exposed by
    deprecated solution as well as FW binary being re-used thus no harm is
    done. The only visible differences are: the newly added 'Loopback Mute'
    kcontrol and volume support extending to quad from stereo.
    
    On top of fixing erros and design flows, catpt also adds module reload,
    dynamic SRAM memory allocation during PCM runtime and exposes missing
    userspace API: 'Loopback Mute' kcontrol, quad volume controls and sysfs
    fw-version entries. Event tracing is provided to ease solution
    debugging.
    
    Following are not included in this update and are scheduled as later
    addition:
    - fw logging
    - module (library) support
    
    Note: LPT power up/down sequences might get aligned with WPT once enough
    testing is done as capabilities are shared for both DSPs.
    Note #2: Both LPT and WPT power up/down sequences may get optimized in
    future updates as thanks to help from the Windows team, most of nuances
    behind why/what/when in regard to hw registers have been backtracked and
    reviewed again.
    
    Link to developer's deep dive message:
    https://www.spinics.net/lists/alsa-devel/msg113563.html
    
    Changes in v10:
    - reverted DUAL_MONO case relocation from v9
    - indented all constants of enum catpt_module_id to the same column
    - new newline appended for return path of catpt_dsp_do_send_msg()
    
    Changes in v9:
    https://www.spinics.net/lists/alsa-devel/msg116305.html
    - fixed newlines in sysfs as requested by Andy, left tags as no other
      changes done
    - removed volume_map and replaced by simple formulas for volume kcontrol
      calculations
    - removed redundant parentheses in catpt_get_channel_map() and
      relocated DUAL_MONO case
    - runtime suspend no longer called during module unload
    - removed redundant size checks for catpt_dsp_send_tx() and
      catpt_dsp_copy_rx()
    
    Changes in v8:
    https://www.spinics.net/lists/alsa-devel/msg116168.html
    - updated catpt_arrange_page_table() with GENMASK and U32_MAX usage
    - made use of PFN_DOWN() replacing explicit right shitfs by PAGE_SIZE
    - made fw hash dumping in catpt_coredump() more readable and removed
      hardcodes
    - catpt_coredump() dumps fw hash now only if said segment has been found
      within fw_info
    - shortened _MSECS suffixes to _MS
    - IPC structs no longer contain enum members
    - simplified definition of catpt_set_dspvol()
    
    Changes in v7:
    https://www.spinics.net/lists/alsa-devel/msg116019.html
    - fixed licence header for fs.c
    - renamed fs.c to sysfs.c to better match its purpose
    - added documentation within Documentation/ABI/testing for entries
      exposed by catpt
    - bin_attribute fw_build replaced by attribute fw_info:
      fw_info contains full FW information and after successful handshake,
      it's always available (stored in driver data) so no need to invoke
      GET_FW_VERSION IPC again, just dump the stored information
    - rather than manually creating and removing sysfs files, now makes use
      of dev_groups member of struct device_driver
    - patch: 10/14 'ASoC: Intel: Select catpt and deprecate haswell' has
      been moved to the back of the list: enable catpt after machine boards
      have been prepared for it first
    - improved readability of several goto labels
    
    Changes in v6:
    https://www.spinics.net/lists/alsa-devel/msg115765.html
    - reordered and reorganized code for patches 1/13 - 8/13 of v5, so each
      patches makes use of no member or function which is unavailable to it.
      Series size increased from 13 to 14 patches: addition of base members
      e.g.: registers has been split from addition of device.c file which
      describes acpi device behavior
    
    Changes in v5:
    https://www.spinics.net/lists/alsa-devel/msg115621.html
    Basically everything below is result of Andy's review. Thank you Andy
    for taking time into this detailed review
    
    - catpt now makes use of common linux/pxa2xx_ssp.h header file, removing
      redundant SSP register declarations in the process. As stated in the
      opening, this is dependent upon linux-spi change:
      spi: pxa2xx: Add SSC2 and SSPSP2 SSP registers
    
    - updated Kconfig by removing DMADEVICES and adding COMPILE_TEST
      as optional depends-on
    - updated all register macros definitions to be more safe against common
      arithmetics when specifying macro's parameters
    - removed CONFIG_PM and CONFIG_PM_SLEEP usage in favor of __maybe_unused
    - all 'if (ret < 0)' converted to simple 'if (ret)' whenever possible
    - fixed erroneous check for platform_device_register_data within
      catpt_register_board()
    - _SLAVE/_MASTER replaced with more inclusive _CONSUMER/_PROVIDER for
      enum catpt_ssp_mode
    - catpt_acpi_probe() is now making use of high-level wrappers for
      ioremapping and resource assignment, reducing function's code size
    - due to improved catpt_acpi_probe() behavior, catpt_acpi_remove() needs
      not to cast dma_free_coherent() any longer
    - DMA source and destrination maxburst now of value 16, see:
    https://www.spinics.net/lists/alsa-devel/msg114394.html
    
    - simplified catpt_dsp_update_lpclock() as list_for_each_entry() is
      empty-safe by default
    - dropped '_SSP_' from all names of all CATPT_SSP_SSXXX_DEFAULT macros
    - catpt_updatel_pci now makes use of linux/pci.h and uapi/linux/pci.h
      constants such as: PCI_PM_CTRL_STATE_MASK and PCI_D3hot
    
    Changes in v4:
    https://www.spinics.net/lists/alsa-devel/msg113762.html
    - fixed compilation with i386 kconfig (conflicting names)
    - streamlined naming for SHIM and PCI registers to match SSP ones
      (SHIM_REG -> SHIM)
    - catpt_component_probe removed and kcontrols again initializzed
      statically via snd_kcontrol_new array: this is to remove
      kctl->id.device shenanigans
    - renamed catpt_set_ctlvol to catpt_set_dspvol - function name wasn't
      matching its purpose
    
    Changes in v3:
    - fixed IRAM mask usage in lpt_dsp_power_up (dsp.c)
    - updated dbg message formatting in catpt_restore_fwimage as suggested
      by Andy
    - fixed alignment for struct catpt_ssp_device_format
    - catpt_set_ctlvol now verifies all-equal scenario based on all
      channels rather than just first two as requested by Amadeo
    - fixed SPDX for registers.h
    
    Changes in v2:
    https://www.spinics.net/lists/alsa-devel/msg113660.html
    - fixed SPDX formatting for all header files as well as pcm.c
    - fixed size provided to memcpy() in fw_build_read() as reported by Mark
    - renamed struct catpt_pdata to struct catpt_spec (cosmetic)
    - fixed erroneous path in catpt_load_block: region is properly released
    - trace.h events for updating registers have been removed and usages
      replaced by dev_dbg (SRAMPGE/ LPCS)
    
    - as requested by Andy, struct resource has replaced struct catpt_mbank
      and struct catpt_mregion. This change cascaded into:
    
      - catpt_mbank_size and catpt_mregion_size replaced by resource_size
      - catpt_mregion_intersects replaced by resource_overlaps
      - all catpt_mbank_ and catpt_mregion_ handlers found in loader.c
        (_request, _reserve, _release, _extract, _split, _join) have been
        removed
      - __request_region and __release_region have been enlisted in their
        place
      - catpt_mregion_intersecting renamed to catpt_resource_overlapping
      - catpt_request_region helper has been provided to deal with -size
        based requests
          o haven't found direct replacements in resource.c/ ioport.h for
          both functions
    
      - catpt_mbank_create and catpt_mbank_remove renamed to catpt_sram_init
        and catpt_sram_free respectively
      - catpt_sram_init now returns void instead of int and has been
        converted to simple initialized. This change ultimately cascaded
        into:
          o both SRAM banks initialization being moved to catpt_dev_init
            from catpt_acpi_probe (device.c)
          o catpt_dev::spec is now initialized first, with catpt_dev_init
            following it soon after
          o catpt_acpi_probe erroneous path has been simplified as SRAM
            banks no longer need to be freed
    
      - catpt_sram_free now frees all resources via child -> sibling
        enumeration rather than region_list iteration
      - catpt_dsp_update_srampge and catpt_dsp_set_srampge now accept new
        argument: unsigned long mask. Caused by removal of catpt_mbank -
        mask is taken directly from catpt_dev::spec::d/iram_mask
      - trace.h events for catpt_mbank and catpt_mregion have been removed
    
    Diff against last drop on internal list:
    https://www.spinics.net/lists/alsa-devel/msg113549.html
    - replaced spinlock with mutex for mregion allocation and release to
      address sleeping in atomic context warnings
    - fixed coredump fw_hash dumping
    - kcontrol values are now always stored regardless of stream of interest
      is running or not
    - kcontrol values are now applied after stream is prepared instead of
      ignoring what has been set by user initially
    - catpt_pdata instances have been renamed from hsw_ and bdw_ to lpt_ and
      wpt_ respectively
    - reordered Makefile .o(s) (cosmetic)
    
    Cezary Rojewski (14):
      ASoC: Intel: Add catpt base members
      ASoC: Intel: catpt: Implement IPC protocol
      ASoC: Intel: catpt: Add IPC message handlers
      ASoC: Intel: catpt: Define DSP operations
      ASoC: Intel: catpt: Firmware loading and context restore
      ASoC: Intel: catpt: PCM operations
      ASoC: Intel: catpt: Device driver lifecycle
      ASoC: Intel: catpt: Event tracing
      ASoC: Intel: catpt: Simple sysfs attributes
      ASoC: Intel: haswell: Remove haswell-solution specific code
      ASoC: Intel: broadwell: Remove haswell-solution specific code
      ASoC: Intel: bdw-5650: Remove haswell-solution specific code
      ASoC: Intel: bdw-5677: Remove haswell-solution specific code
      ASoC: Intel: Select catpt and deprecate haswell
    
     .../ABI/testing/sysfs-bus-pci-devices-catpt   |   16 +
     sound/soc/intel/Kconfig                       |   24 +-
     sound/soc/intel/Makefile                      |    2 +-
     sound/soc/intel/boards/Kconfig                |    8 +-
     sound/soc/intel/boards/bdw-rt5650.c           |   36 -
     sound/soc/intel/boards/bdw-rt5677.c           |   33 -
     sound/soc/intel/boards/broadwell.c            |   33 -
     sound/soc/intel/boards/haswell.c              |   28 +-
     sound/soc/intel/catpt/Makefile                |    6 +
     sound/soc/intel/catpt/core.h                  |  188 +++
     sound/soc/intel/catpt/device.c                |  352 +++++
     sound/soc/intel/catpt/dsp.c                   |  578 ++++++++
     sound/soc/intel/catpt/ipc.c                   |  298 +++++
     sound/soc/intel/catpt/loader.c                |  671 ++++++++++
     sound/soc/intel/catpt/messages.c              |  313 +++++
     sound/soc/intel/catpt/messages.h              |  401 ++++++
     sound/soc/intel/catpt/pcm.c                   | 1175 +++++++++++++++++
     sound/soc/intel/catpt/registers.h             |  178 +++
     sound/soc/intel/catpt/sysfs.c                 |   55 +
     sound/soc/intel/catpt/trace.h                 |   83 ++
     20 files changed, 4335 insertions(+), 143 deletions(-)
     create mode 100644 Documentation/ABI/testing/sysfs-bus-pci-devices-catpt
     create mode 100644 sound/soc/intel/catpt/Makefile
     create mode 100644 sound/soc/intel/catpt/core.h
     create mode 100644 sound/soc/intel/catpt/device.c
     create mode 100644 sound/soc/intel/catpt/dsp.c
     create mode 100644 sound/soc/intel/catpt/ipc.c
     create mode 100644 sound/soc/intel/catpt/loader.c
     create mode 100644 sound/soc/intel/catpt/messages.c
     create mode 100644 sound/soc/intel/catpt/messages.h
     create mode 100644 sound/soc/intel/catpt/pcm.c
     create mode 100644 sound/soc/intel/catpt/registers.h
     create mode 100644 sound/soc/intel/catpt/sysfs.c
     create mode 100644 sound/soc/intel/catpt/trace.h
    
    --
    2.17.1

commit 57b8b1b4351dafe94de09a2aab5eba885b6705f0
Merge: f75aef392f86 c2bea7a1a1c0 3a1793066fdf 0fdb64c2a303 4e56de82d4ec 9c4b4c701e53 a194c5f2d2b3 80d6b466679c 5fd39dc22027 887e2cff0f8d 03c9c8fad6cb 4b2b76cbbc8f e093256d14fb 9e0f085c2b33 6f3c4afae980 3102bc0e6ac7 9a747c91e8d6 2a30aca81a72
Author: Will Deacon <will@kernel.org>
Date:   Fri Oct 2 12:01:41 2020 +0100

    Merge branches 'for-next/acpi', 'for-next/boot', 'for-next/bpf', 'for-next/cpuinfo', 'for-next/fpsimd', 'for-next/misc', 'for-next/mm', 'for-next/pci', 'for-next/perf', 'for-next/ptrauth', 'for-next/sdei', 'for-next/selftests', 'for-next/stacktrace', 'for-next/svm', 'for-next/topology', 'for-next/tpyos' and 'for-next/vdso' into for-next/core
    
    Remove unused functions and parameters from ACPI IORT code.
    (Zenghui Yu via Lorenzo Pieralisi)
    * for-next/acpi:
      ACPI/IORT: Remove the unused inline functions
      ACPI/IORT: Drop the unused @ops of iort_add_device_replay()
    
    Remove redundant code and fix documentation of caching behaviour for the
    HVC_SOFT_RESTART hypercall.
    (Pingfan Liu)
    * for-next/boot:
      Documentation/kvm/arm: improve description of HVC_SOFT_RESTART
      arm64/relocate_kernel: remove redundant code
    
    Improve reporting of unexpected kernel traps due to BPF JIT failure.
    (Will Deacon)
    * for-next/bpf:
      arm64: Improve diagnostics when trapping BRK with FAULT_BRK_IMM
    
    Improve robustness of user-visible HWCAP strings and their corresponding
    numerical constants.
    (Anshuman Khandual)
    * for-next/cpuinfo:
      arm64/cpuinfo: Define HWCAP name arrays per their actual bit definitions
    
    Cleanups to handling of SVE and FPSIMD register state in preparation
    for potential future optimisation of handling across syscalls.
    (Julien Grall)
    * for-next/fpsimd:
      arm64/sve: Implement a helper to load SVE registers from FPSIMD state
      arm64/sve: Implement a helper to flush SVE registers
      arm64/fpsimdmacros: Allow the macro "for" to be used in more cases
      arm64/fpsimdmacros: Introduce a macro to update ZCR_EL1.LEN
      arm64/signal: Update the comment in preserve_sve_context
      arm64/fpsimd: Update documentation of do_sve_acc
    
    Miscellaneous changes.
    (Tian Tao and others)
    * for-next/misc:
      arm64/mm: return cpu_all_mask when node is NUMA_NO_NODE
      arm64: mm: Fix missing-prototypes in pageattr.c
      arm64/fpsimd: Fix missing-prototypes in fpsimd.c
      arm64: hibernate: Remove unused including <linux/version.h>
      arm64/mm: Refactor {pgd, pud, pmd, pte}_ERROR()
      arm64: Remove the unused include statements
      arm64: get rid of TEXT_OFFSET
      arm64: traps: Add str of description to panic() in die()
    
    Memory management updates and cleanups.
    (Anshuman Khandual and others)
    * for-next/mm:
      arm64: dbm: Invalidate local TLB when setting TCR_EL1.HD
      arm64: mm: Make flush_tlb_fix_spurious_fault() a no-op
      arm64/mm: Unify CONT_PMD_SHIFT
      arm64/mm: Unify CONT_PTE_SHIFT
      arm64/mm: Remove CONT_RANGE_OFFSET
      arm64/mm: Enable THP migration
      arm64/mm: Change THP helpers to comply with generic MM semantics
      arm64/mm/ptdump: Add address markers for BPF regions
    
    Allow prefetchable PCI BARs to be exposed to userspace using normal
    non-cacheable mappings.
    (Clint Sbisa)
    * for-next/pci:
      arm64: Enable PCI write-combine resources under sysfs
    
    Perf/PMU driver updates.
    (Julien Thierry and others)
    * for-next/perf:
      perf: arm-cmn: Fix conversion specifiers for node type
      perf: arm-cmn: Fix unsigned comparison to less than zero
      arm_pmu: arm64: Use NMIs for PMU
      arm_pmu: Introduce pmu_irq_ops
      KVM: arm64: pmu: Make overflow handler NMI safe
      arm64: perf: Defer irq_work to IPI_IRQ_WORK
      arm64: perf: Remove PMU locking
      arm64: perf: Avoid PMXEV* indirection
      arm64: perf: Add missing ISB in armv8pmu_enable_counter()
      perf: Add Arm CMN-600 PMU driver
      perf: Add Arm CMN-600 DT binding
      arm64: perf: Add support caps under sysfs
      drivers/perf: thunderx2_pmu: Fix memory resource error handling
      drivers/perf: xgene_pmu: Fix uninitialized resource struct
      perf: arm_dsu: Support DSU ACPI devices
      arm64: perf: Remove unnecessary event_idx check
      drivers/perf: hisi: Add missing include of linux/module.h
      arm64: perf: Add general hardware LLC events for PMUv3
    
    Support for the Armv8.3 Pointer Authentication enhancements.
    (By Amit Daniel Kachhap)
    * for-next/ptrauth:
      arm64: kprobe: clarify the comment of steppable hint instructions
      arm64: kprobe: disable probe of fault prone ptrauth instruction
      arm64: cpufeature: Modify address authentication cpufeature to exact
      arm64: ptrauth: Introduce Armv8.3 pointer authentication enhancements
      arm64: traps: Allow force_signal_inject to pass esr error code
      arm64: kprobe: add checks for ARMv8.3-PAuth combined instructions
    
    Tonnes of cleanup to the SDEI driver.
    (Gavin Shan)
    * for-next/sdei:
      firmware: arm_sdei: Remove _sdei_event_unregister()
      firmware: arm_sdei: Remove _sdei_event_register()
      firmware: arm_sdei: Introduce sdei_do_local_call()
      firmware: arm_sdei: Cleanup on cross call function
      firmware: arm_sdei: Remove while loop in sdei_event_unregister()
      firmware: arm_sdei: Remove while loop in sdei_event_register()
      firmware: arm_sdei: Remove redundant error message in sdei_probe()
      firmware: arm_sdei: Remove duplicate check in sdei_get_conduit()
      firmware: arm_sdei: Unregister driver on error in sdei_init()
      firmware: arm_sdei: Avoid nested statements in sdei_init()
      firmware: arm_sdei: Retrieve event number from event instance
      firmware: arm_sdei: Common block for failing path in sdei_event_create()
      firmware: arm_sdei: Remove sdei_is_err()
    
    Selftests for Pointer Authentication and FPSIMD/SVE context-switching.
    (Mark Brown and Boyan Karatotev)
    * for-next/selftests:
      selftests: arm64: Add build and documentation for FP tests
      selftests: arm64: Add wrapper scripts for stress tests
      selftests: arm64: Add utility to set SVE vector lengths
      selftests: arm64: Add stress tests for FPSMID and SVE context switching
      selftests: arm64: Add test for the SVE ptrace interface
      selftests: arm64: Test case for enumeration of SVE vector lengths
      kselftests/arm64: add PAuth tests for single threaded consistency and differently initialized keys
      kselftests/arm64: add PAuth test for whether exec() changes keys
      kselftests/arm64: add nop checks for PAuth tests
      kselftests/arm64: add a basic Pointer Authentication test
    
    Implementation of ARCH_STACKWALK for unwinding.
    (Mark Brown)
    * for-next/stacktrace:
      arm64: Move console stack display code to stacktrace.c
      arm64: stacktrace: Convert to ARCH_STACKWALK
      arm64: stacktrace: Make stack walk callback consistent with generic code
      stacktrace: Remove reliable argument from arch_stack_walk() callback
    
    Support for ASID pinning, which is required when sharing page-tables with
    the SMMU.
    (Jean-Philippe Brucker)
    * for-next/svm:
      arm64: cpufeature: Export symbol read_sanitised_ftr_reg()
      arm64: mm: Pin down ASIDs for sharing mm with devices
    
    Rely on firmware tables for establishing CPU topology.
    (Valentin Schneider)
    * for-next/topology:
      arm64: topology: Stop using MPIDR for topology information
    
    Spelling fixes.
    (Xiaoming Ni and Yanfei Xu)
    * for-next/tpyos:
      arm64/numa: Fix a typo in comment of arm64_numa_init
      arm64: fix some spelling mistakes in the comments by codespell
    
    vDSO cleanups.
    (Will Deacon)
    * for-next/vdso:
      arm64: vdso: Fix unusual formatting in *setup_additional_pages()
      arm64: vdso32: Remove a bunch of #ifdef CONFIG_COMPAT_VDSO guards

commit ae6ee6ae2b4f4534664561161ef8087e08aff2d9
Author: Herbert Xu <herbert@gondor.apana.org.au>
Date:   Fri Sep 25 18:19:55 2020 +1000

    lib/mpi: Fix unused variable warnings
    
    This patch removes a number of unused variables and marks others
    as unused in order to silence compiler warnings about them.
    
    Fixes: a8ea8bdd9df9 ("lib/mpi: Extend the MPI library")
    Signed-off-by: Herbert Xu <herbert@gondor.apana.org.au>
    Tested-by: Tianjia Zhang <tianjia.zhang@linux.alibaba.com>
    Signed-off-by: Herbert Xu <herbert@gondor.apana.org.au>

commit 1586d3a964c9b273ca982b750f757fbedcb57afb
Author: Marek Behn <marek.behun@nic.cz>
Date:   Thu Sep 17 21:31:40 2020 +0200

    mfd: asic3: Build if COMPILE_TEST=y
    
    Build this driver on another platforms if COMPILE_TEST=y. Another
    drivers may depend on this, for example leds-asic3.
    
    Signed-off-by: Marek Behn <marek.behun@nic.cz>
    Signed-off-by: Lee Jones <lee.jones@linaro.org>

commit 3e6efab865ac943f4ec43913eb665695737112b0
Author: Arun Easi <aeasi@marvell.com>
Date:   Tue Sep 29 03:21:49 2020 -0700

    scsi: qla2xxx: Fix reset of MPI firmware
    
    Normally, the MPI firmware is reset when an MPI dump is collected.  If an
    unsaved MPI dump exists in the driver, though, an alternate mechanism is
    used. This mechanism, which was not fully correct, is not recommended and
    instead an MPI dump template walk is suggested to perform the MPI reset.
    
    To allow for the MPI dump template walk, extra space is reserved in the MPI
    dump buffer which gets used only when there is already an MPI dump in
    place.
    
    Link: https://lore.kernel.org/r/20200929102152.32278-5-njavali@marvell.com
    Fixes: cbb01c2f2f63 ("scsi: qla2xxx: Fix MPI failure AEN (8200) handling")
    Cc: stable@vger.kernel.org
    Reviewed-by: Himanshu Madhani <himanshu.madhani@oracle.com>
    Signed-off-by: Arun Easi <aeasi@marvell.com>
    Signed-off-by: Nilesh Javali <njavali@marvell.com>
    Signed-off-by: Martin K. Petersen <martin.petersen@oracle.com>

commit 7a6cdbd5e87515ebf6231b762ad903c7cff87b9c
Author: Arun Easi <aeasi@marvell.com>
Date:   Tue Sep 29 03:21:48 2020 -0700

    scsi: qla2xxx: Fix MPI reset needed message
    
    When printing the message:
    
      "MPI Heartbeat stop. MPI reset is not needed.."
    
    ..the wrong register was checked leading to always printing that MPI reset
    is not needed, even when it is needed. Fix the MPI reset message.
    
    Link: https://lore.kernel.org/r/20200929102152.32278-4-njavali@marvell.com
    Fixes: cbb01c2f2f63 ("scsi: qla2xxx: Fix MPI failure AEN (8200) handling")
    Cc: stable@vger.kernel.org
    Reviewed-by: Himanshu Madhani <himanshu.madhani@oracle.com>
    Signed-off-by: Arun Easi <aeasi@marvell.com>
    Signed-off-by: Nilesh Javali <njavali@marvell.com>
    Signed-off-by: Martin K. Petersen <martin.petersen@oracle.com>

commit 513034d8b089b9a49dab57845aee70e830fe7334
Author: Necip Fazil Yildiran <fazilyildiran@gmail.com>
Date:   Mon Sep 14 17:40:26 2020 +0300

    pinctrl: bcm: fix kconfig dependency warning when !GPIOLIB
    
    When PINCTRL_BCM2835 is enabled and GPIOLIB is disabled, it results in the
    following Kbuild warning:
    
    WARNING: unmet direct dependencies detected for GPIOLIB_IRQCHIP
      Depends on [n]: GPIOLIB [=n]
      Selected by [y]:
      - PINCTRL_BCM2835 [=y] && PINCTRL [=y] && OF [=y] && (ARCH_BCM2835 [=n] || ARCH_BRCMSTB [=n] || COMPILE_TEST [=y])
    
    The reason is that PINCTRL_BCM2835 selects GPIOLIB_IRQCHIP without
    depending on or selecting GPIOLIB while GPIOLIB_IRQCHIP is subordinate to
    GPIOLIB.
    
    Honor the kconfig menu hierarchy to remove kconfig dependency warnings.
    
    Fixes: 85ae9e512f43 ("pinctrl: bcm2835: switch to GPIOLIB_IRQCHIP")
    Signed-off-by: Necip Fazil Yildiran <fazilyildiran@gmail.com>
    Link: https://lore.kernel.org/r/20200914144025.371370-1-fazilyildiran@gmail.com
    Signed-off-by: Linus Walleij <linus.walleij@linaro.org>

commit 3157b035f499e48334be1ec74b297721b82adb4b
Author: Randy Dunlap <rdunlap@infradead.org>
Date:   Fri Sep 25 09:43:23 2020 -0700

    mmc: host: fix depends for MMC_MESON_GX w/ COMPILE_TEST
    
    Fix build errors for meson-gx-mmc.c when CONFIG_COMMON_CLK is not
    set/enabled. This can happen when COMPILE_TEST is set/enabled.
    
    ERROR: modpost: "clk_divider_ops" [drivers/mmc/host/meson-gx-mmc.ko] undefined!
    ERROR: modpost: "devm_clk_register" [drivers/mmc/host/meson-gx-mmc.ko] undefined!
    ERROR: modpost: "clk_mux_ops" [drivers/mmc/host/meson-gx-mmc.ko] undefined!
    ERROR: modpost: "__clk_get_name" [drivers/mmc/host/meson-gx-mmc.ko] undefined!
    
    Fixes: 54d8454436a2 ("mmc: host: Enable compile testing of multiple drivers")
    Signed-off-by: Randy Dunlap <rdunlap@infradead.org>
    Reviewed-by: Krzysztof Kozlowski <krzk@kernel.org>
    Reported-by: kernel test robot <lkp@intel.com>
    Link: https://lore.kernel.org/r/20200925164323.29843-1-rdunlap@infradead.org
    Signed-off-by: Ulf Hansson <ulf.hansson@linaro.org>

commit 2aebb78040e741949ac71f1203f003351061b93b
Author: Marek Behn <marek.behun@nic.cz>
Date:   Fri Sep 18 00:32:50 2020 +0200

    leds: ip30: compile if COMPILE_TEST=y
    
    This driver can be compiled on other platforms with small change if
    COMPILE_TEST=y.
    
    Signed-off-by: Marek Behn <marek.behun@nic.cz>
    Cc: Pavel Machek <pavel@ucw.cz>
    Cc: Dan Murphy <dmurphy@ti.com>
    Cc: Thomas Bogendoerfer <tbogendoerfer@suse.de>
    Signed-off-by: Pavel Machek <pavel@ucw.cz>

commit f1b0a43bba3d1ed3fcd13478f8cce24c1275ba92
Author: Marek Behn <marek.behun@nic.cz>
Date:   Fri Sep 18 00:32:49 2020 +0200

    leds: various: compile if COMPILE_TEST=y
    
    These drivers can be compiled without modification when COMPILE_TEST=y:
      cobalt-qube, cobalt-raq, netxbig, ns2 and s3c24xx
    
    Signed-off-by: Marek Behn <marek.behun@nic.cz>
    Cc: Pavel Machek <pavel@ucw.cz>
    Cc: Dan Murphy <dmurphy@ti.com>
    Signed-off-by: Pavel Machek <pavel@ucw.cz>

commit 621150689b0992bc02389b2351c2cbf0bc5bd700
Author: Dmitry Golovin <dima@golovin.in>
Date:   Thu Dec 5 00:54:41 2019 +0200

    x86/boot: kbuild: allow readelf executable to be specified
    
    commit eefb8c124fd969e9a174ff2bedff86aa305a7438 upstream.
    
    Introduce a new READELF variable to top-level Makefile, so the name of
    readelf binary can be specified.
    
    Before this change the name of the binary was hardcoded to
    "$(CROSS_COMPILE)readelf" which might not be present for every
    toolchain.
    
    This allows to build with LLVM Object Reader by using make parameter
    READELF=llvm-readelf.
    
    Link: https://github.com/ClangBuiltLinux/linux/issues/771
    Signed-off-by: Dmitry Golovin <dima@golovin.in>
    Reviewed-by: Nick Desaulniers <ndesaulniers@google.com>
    Signed-off-by: Masahiro Yamada <masahiroy@kernel.org>
    Signed-off-by: Nick Desaulniers <ndesaulniers@google.com>
    [nd: conflict in exported vars list from not backporting commit
     e83b9f55448a ("kbuild: add ability to generate BTF type info for vmlinux")]
    Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>

commit fb181ac6fe194b4eb20007f65504c61ea22826fd
Author: Masahiro Yamada <masahiroy@kernel.org>
Date:   Thu Mar 26 14:57:15 2020 +0900

    net: wan: wanxl: use allow to pass CROSS_COMPILE_M68k for rebuilding firmware
    
    commit 63b903dfebdea92aa92ad337d8451a6fbfeabf9d upstream.
    
    As far as I understood from the Kconfig help text, this build rule is
    used to rebuild the driver firmware, which runs on an old m68k-based
    chip. So, you need m68k tools for the firmware rebuild.
    
    wanxl.c is a PCI driver, but CONFIG_M68K does not select CONFIG_HAVE_PCI.
    So, you cannot enable CONFIG_WANXL_BUILD_FIRMWARE for ARCH=m68k. In other
    words, ifeq ($(ARCH),m68k) is false here.
    
    I am keeping the dead code for now, but rebuilding the firmware requires
    'as68k' and 'ld68k', which I do not have in hand.
    
    Instead, the kernel.org m68k GCC [1] successfully built it.
    
    Allowing a user to pass in CROSS_COMPILE_M68K= is handier.
    
    [1] https://mirrors.edge.kernel.org/pub/tools/crosstool/files/bin/x86_64/9.2.0/x86_64-gcc-9.2.0-nolibc-m68k-linux.tar.xz
    
    Suggested-by: Geert Uytterhoeven <geert@linux-m68k.org>
    Signed-off-by: Masahiro Yamada <masahiroy@kernel.org>
    Signed-off-by: Nick Desaulniers <ndesaulniers@google.com>
    Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>

commit cbd2dca74926c0e4610c40923cc786b732c9e8ef
Author: Alexandre Courbot <acourbot@chromium.org>
Date:   Fri Aug 21 20:58:32 2020 +0900

    remoteproc: scp: add COMPILE_TEST dependency
    
    This will improve this driver's build coverage.
    
    Reported-by: Ezequiel Garcia <ezequiel@collabora.com>
    Signed-off-by: Alexandre Courbot <acourbot@chromium.org>
    Acked-by: Bjorn Andersson <bjorn.andersson@linaro.org>
    Signed-off-by: Mauro Carvalho Chehab <mchehab+huawei@kernel.org>

commit d58bb7e55a8a65894cc02f27c3e2bf9403e7c40f
Author: Tianjia Zhang <tianjia.zhang@linux.alibaba.com>
Date:   Mon Sep 21 00:20:56 2020 +0800

    lib/mpi: Introduce ec implementation to MPI library
    
    The implementation of EC is introduced from libgcrypt as the
    basic algorithm of elliptic curve, which can be more perfectly
    integrated with MPI implementation.
    Some other algorithms will be developed based on mpi ecc, such as SM2.
    
    Signed-off-by: Tianjia Zhang <tianjia.zhang@linux.alibaba.com>
    Tested-by: Xufeng Zhang <yunbo.xufeng@linux.alibaba.com>
    Signed-off-by: Herbert Xu <herbert@gondor.apana.org.au>

commit a8ea8bdd9df92a0e5db5b43900abb7a288b8a53e
Author: Tianjia Zhang <tianjia.zhang@linux.alibaba.com>
Date:   Mon Sep 21 00:20:55 2020 +0800

    lib/mpi: Extend the MPI library
    
    Expand the mpi library based on libgcrypt, and the ECC algorithm of
    mpi based on libgcrypt requires these functions.
    Some other algorithms will be developed based on mpi ecc, such as SM2.
    
    Signed-off-by: Tianjia Zhang <tianjia.zhang@linux.alibaba.com>
    Tested-by: Xufeng Zhang <yunbo.xufeng@linux.alibaba.com>
    Signed-off-by: Herbert Xu <herbert@gondor.apana.org.au>

commit 9a4e66802e417d23f5e4a3397bab8b9284972d1d
Author: Alexandre Courbot <acourbot@chromium.org>
Date:   Tue Sep 15 10:29:11 2020 +0900

    remoteproc: scp: add COMPILE_TEST dependency
    
    This will improve this driver's build coverage.
    
    Reported-by: Ezequiel Garcia <ezequiel@collabora.com>
    Signed-off-by: Alexandre Courbot <acourbot@chromium.org>
    Link: https://lore.kernel.org/r/20200915012911.489820-1-acourbot@chromium.org
    Signed-off-by: Bjorn Andersson <bjorn.andersson@linaro.org>

commit 09fd5f0ddf327ce2b7764ecf3264f3f9230207f1
Author: Alim Akhtar <alim.akhtar@samsung.com>
Date:   Tue Jul 21 22:50:21 2020 +0530

    scsi: ufs: Fix 'unmet direct dependencies' config warning
    
    With !CONFIG_OF and SCSI_UFS_EXYNOS selected, the below warning is given:
    
    WARNING: unmet direct dependencies detected for PHY_SAMSUNG_UFS
      Depends on [n]: OF [=n] && (ARCH_EXYNOS || COMPILE_TEST [=y])
      Selected by [y]:
      - SCSI_UFS_EXYNOS [=y] && SCSI_LOWLEVEL [=y] && SCSI [=y] && SCSI_UFSHCD_PLATFORM [=y] && (ARCH_EXYNOS || COMPILE_TEST [=y])
    
    Fix it by removing PHY_SAMSUNG_UFS dependency.
    
    Link: https://lore.kernel.org/r/20200721172021.28922-1-alim.akhtar@samsung.com
    Reported-by: Randy Dunlap <rdunlap@infradead.org>
    Acked-by: Randy Dunlap <rdunlap@infradead.org>
    Signed-off-by: Alim Akhtar <alim.akhtar@samsung.com>
    Signed-off-by: Martin K. Petersen <martin.petersen@oracle.com>

commit 461aea72af0e3aefff0c428f73c75e6b9ce9fcb5
Author: Ulf Hansson <ulf.hansson@linaro.org>
Date:   Tue Sep 8 16:02:42 2020 +0200

    mmc: Drop COMPILE_TEST Kconfig option for MMC_S3C
    
    MMC_S3C isn't ready yet to be built with COMPILE_TEST, hence drop it.
    
    Signed-off-by: Ulf Hansson <ulf.hansson@linaro.org>
    Link: https://lore.kernel.org/r/20200908140242.743234-1-ulf.hansson@linaro.org
    Reviewed-by: Krzysztof Kozlowski <krzk@kernel.org>

commit 3102bc0e6ac752cc5df896acb557d779af4d82a1
Author: Valentin Schneider <valentin.schneider@arm.com>
Date:   Sat Aug 29 14:00:16 2020 +0100

    arm64: topology: Stop using MPIDR for topology information
    
    In the absence of ACPI or DT topology data, we fallback to haphazardly
    decoding *something* out of MPIDR. Sadly, the contents of that register are
    mostly unusable due to the implementation leniancy and things like Aff0
    having to be capped to 15 (despite being encoded on 8 bits).
    
    Consider a simple system with a single package of 32 cores, all under the
    same LLC. We ought to be shoving them in the same core_sibling mask, but
    MPIDR is going to look like:
    
      | CPU  | 0 | ... | 15 | 16 | ... | 31 |
      |------+---+-----+----+----+-----+----+
      | Aff0 | 0 | ... | 15 |  0 | ... | 15 |
      | Aff1 | 0 | ... |  0 |  1 | ... |  1 |
      | Aff2 | 0 | ... |  0 |  0 | ... |  0 |
    
    Which will eventually yield
    
      core_sibling(0-15)  == 0-15
      core_sibling(16-31) == 16-31
    
    NUMA woes
    =========
    
    If we try to play games with this and set up NUMA boundaries within those
    groups of 16 cores via e.g. QEMU:
    
      # Node0: 0-9; Node1: 10-19
      $ qemu-system-aarch64 <blah> \
        -smp 20 -numa node,cpus=0-9,nodeid=0 -numa node,cpus=10-19,nodeid=1
    
    The scheduler's MC domain (all CPUs with same LLC) is going to be built via
    
      arch_topology.c::cpu_coregroup_mask()
    
    In there we try to figure out a sensible mask out of the topology
    information we have. In short, here we'll pick the smallest of NUMA or
    core sibling mask.
    
      node_mask(CPU9)    == 0-9
      core_sibling(CPU9) == 0-15
    
    MC mask for CPU9 will thus be 0-9, not a problem.
    
      node_mask(CPU10)    == 10-19
      core_sibling(CPU10) == 0-15
    
    MC mask for CPU10 will thus be 10-19, not a problem.
    
      node_mask(CPU16)    == 10-19
      core_sibling(CPU16) == 16-19
    
    MC mask for CPU16 will thus be 16-19... Uh oh. CPUs 16-19 are in two
    different unique MC spans, and the scheduler has no idea what to make of
    that. That triggers the WARN_ON() added by commit
    
      ccf74128d66c ("sched/topology: Assert non-NUMA topology masks don't (partially) overlap")
    
    Fixing MPIDR-derived topology
    =============================
    
    We could try to come up with some cleverer scheme to figure out which of
    the available masks to pick, but really if one of those masks resulted from
    MPIDR then it should be discarded because it's bound to be bogus.
    
    I was hoping to give MPIDR a chance for SMT, to figure out which threads are
    in the same core using Aff1-3 as core ID, but Sudeep and Robin pointed out
    to me that there are systems out there where *all* cores have non-zero
    values in their higher affinity fields (e.g. RK3288 has "5" in all of its
    cores' MPIDR.Aff1), which would expose a bogus core ID to userspace.
    
    Stop using MPIDR for topology information. When no other source of topology
    information is available, mark each CPU as its own core and its NUMA node
    as its LLC domain.
    
    Signed-off-by: Valentin Schneider <valentin.schneider@arm.com>
    Reviewed-by: Sudeep Holla <sudeep.holla@arm.com>
    Link: https://lore.kernel.org/r/20200829130016.26106-1-valentin.schneider@arm.com
    Signed-off-by: Will Deacon <will@kernel.org>

commit 162343a876f14f7604881dd2bc53ca140c82c230
Author: Rustam Kovhaev <rkovhaev@gmail.com>
Date:   Mon Aug 10 08:36:50 2020 -0700

    scripts/tags.sh: exclude tools directory from tags generation
    
    when COMPILED_SOURCE is set, running 'make ARCH=x86_64 COMPILED_SOURCE=1
    cscope tags' in KBUILD_OUTPUT directory produces lots of "No such file
    or directory" warnings:
    ...
    realpath: sigchain.h: No such file or directory
    realpath: orc_gen.c: No such file or directory
    realpath: objtool.c: No such file or directory
    ...
    let's exclude tools directory from tags generation
    
    Fixes: 4f491bb6ea2a ("scripts/tags.sh: collect compiled source precisely")
    Link: https://lore.kernel.org/lkml/20200809210056.GA1344537@thinkpad
    Signed-off-by: Rustam Kovhaev <rkovhaev@gmail.com>
    Link: https://lore.kernel.org/r/20200810153650.1822316-1-rkovhaev@gmail.com
    Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>

commit 3e8b2403545efd46c6347002e27eae4708205fd4
Author: Laurent Pinchart <laurent.pinchart@ideasonboard.com>
Date:   Wed Jul 29 01:23:32 2020 +0300

    drm: xlnx: dpsub: Fix DMADEVICES Kconfig dependency
    
    The dpsub driver uses the DMA engine API, and thus selects DMA_ENGINE to
    provide that API. DMA_ENGINE depends on DMADEVICES, which can be
    deselected by the user, creating a possibly unmet indirect dependency:
    
    WARNING: unmet direct dependencies detected for DMA_ENGINE
      Depends on [n]: DMADEVICES [=n]
      Selected by [m]:
      - DRM_ZYNQMP_DPSUB [=m] && HAS_IOMEM [=y] && (ARCH_ZYNQMP || COMPILE_TEST [=y]) && COMMON_CLK [=y] && DRM [=m] && OF [=y]
    
    Add a dependency on DMADEVICES to fix this.
    
    Reported-by: Randy Dunlap <rdunlap@infradead.org>
    Signed-off-by: Laurent Pinchart <laurent.pinchart@ideasonboard.com>
    Acked-by: Randy Dunlap <rdunlap@infradead.org>

commit a5d6a17faf199bd5dafe6f3572576ac153c02a27
Author: Michael Ellerman <mpe@ellerman.id.au>
Date:   Fri Aug 21 20:49:10 2020 +1000

    video: fbdev: controlfb: Fix build for COMPILE_TEST=y && PPC_PMAC=n
    
    [ Upstream commit 4d618b9f3fcab84e9ec28c180de46fb2c929d096 ]
    
    The build is currently broken, if COMPILE_TEST=y and PPC_PMAC=n:
    
      linux/drivers/video/fbdev/controlfb.c: In function control_set_hardware:
      linux/drivers/video/fbdev/controlfb.c:276:2: error: implicit declaration of function btext_update_display
        276 |  btext_update_display(p->frame_buffer_phys + CTRLFB_OFF,
            |  ^~~~~~~~~~~~~~~~~~~~
    
    Fix it by including btext.h whenever CONFIG_BOOTX_TEXT is enabled.
    
    Fixes: a07a63b0e24d ("video: fbdev: controlfb: add COMPILE_TEST support")
    Signed-off-by: Michael Ellerman <mpe@ellerman.id.au>
    Acked-by: Bartlomiej Zolnierkiewicz <b.zolnierkie@samsung.com>
    Link: https://lore.kernel.org/r/20200821104910.3363818-1-mpe@ellerman.id.au
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit 8bb5021cc2ee5d5dd129a9f2f5ad2bb76eea297d
Merge: 6f0306d1bfbc 4a133eb351cc
Author: Linus Torvalds <torvalds@linux-foundation.org>
Date:   Sun Aug 30 10:56:12 2020 -0700

    Merge tag 'powerpc-5.9-4' of git://git.kernel.org/pub/scm/linux/kernel/git/powerpc/linux
    
    Pull powerpc fixes from Michael Ellerman:
    
     - Revert our removal of PROT_SAO, at least one user expressed an
       interest in using it on Power9. Instead don't allow it to be used in
       guests unless enabled explicitly at compile time.
    
     - A fix for a crash introduced by a recent change to FP handling.
    
     - Revert a change to our idle code that left Power10 with no idle
       support.
    
     - One minor fix for the new scv system call path to set PPR.
    
     - Fix a crash in our "generic" PMU if branch stack events were enabled.
    
     - A fix for the IMC PMU, to correctly identify host kernel samples.
    
     - The ADB_PMU powermac code was found to be incompatible with
       VMAP_STACK, so make them incompatible in Kconfig until the code can
       be fixed.
    
     - A build fix in drivers/video/fbdev/controlfb.c, and a documentation
       fix.
    
    Thanks to Alexey Kardashevskiy, Athira Rajeev, Christophe Leroy,
    Giuseppe Sacco, Madhavan Srinivasan, Milton Miller, Nicholas Piggin,
    Pratik Rajesh Sampat, Randy Dunlap, Shawn Anastasio, Vaidyanathan
    Srinivasan.
    
    * tag 'powerpc-5.9-4' of git://git.kernel.org/pub/scm/linux/kernel/git/powerpc/linux:
      powerpc/32s: Disable VMAP stack which CONFIG_ADB_PMU
      Revert "powerpc/powernv/idle: Replace CPU feature check with PVR check"
      powerpc/perf: Fix reading of MSR[HV/PR] bits in trace-imc
      powerpc/perf: Fix crashes with generic_compat_pmu & BHRB
      powerpc/64s: Fix crash in load_fp_state() due to fpexc_mode
      powerpc/64s: scv entry should set PPR
      Documentation/powerpc: fix malformed table in syscall64-abi
      video: fbdev: controlfb: Fix build for COMPILE_TEST=y && PPC_PMAC=n
      selftests/powerpc: Update PROT_SAO test to skip ISA 3.1
      powerpc/64s: Disallow PROT_SAO in LPARs by default
      Revert "powerpc/64s: Remove PROT_SAO support"

commit 4d618b9f3fcab84e9ec28c180de46fb2c929d096
Author: Michael Ellerman <mpe@ellerman.id.au>
Date:   Fri Aug 21 20:49:10 2020 +1000

    video: fbdev: controlfb: Fix build for COMPILE_TEST=y && PPC_PMAC=n
    
    The build is currently broken, if COMPILE_TEST=y and PPC_PMAC=n:
    
      linux/drivers/video/fbdev/controlfb.c: In function control_set_hardware:
      linux/drivers/video/fbdev/controlfb.c:276:2: error: implicit declaration of function btext_update_display
        276 |  btext_update_display(p->frame_buffer_phys + CTRLFB_OFF,
            |  ^~~~~~~~~~~~~~~~~~~~
    
    Fix it by including btext.h whenever CONFIG_BOOTX_TEXT is enabled.
    
    Fixes: a07a63b0e24d ("video: fbdev: controlfb: add COMPILE_TEST support")
    Signed-off-by: Michael Ellerman <mpe@ellerman.id.au>
    Acked-by: Bartlomiej Zolnierkiewicz <b.zolnierkie@samsung.com>
    Link: https://lore.kernel.org/r/20200821104910.3363818-1-mpe@ellerman.id.au

commit fa84d9f31599fc190ba3ced05bfab7850152fd38
Author: Dmitry Golovin <dima@golovin.in>
Date:   Thu Dec 5 00:54:41 2019 +0200

    x86/boot: kbuild: allow readelf executable to be specified
    
    commit eefb8c124fd969e9a174ff2bedff86aa305a7438 upstream.
    
    Introduce a new READELF variable to top-level Makefile, so the name of
    readelf binary can be specified.
    
    Before this change the name of the binary was hardcoded to
    "$(CROSS_COMPILE)readelf" which might not be present for every
    toolchain.
    
    This allows to build with LLVM Object Reader by using make parameter
    READELF=llvm-readelf.
    
    Link: https://github.com/ClangBuiltLinux/linux/issues/771
    Signed-off-by: Dmitry Golovin <dima@golovin.in>
    Reviewed-by: Nick Desaulniers <ndesaulniers@google.com>
    Signed-off-by: Masahiro Yamada <masahiroy@kernel.org>
    Signed-off-by: Nick Desaulniers <ndesaulniers@google.com>
    Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>

commit c7c239c947be1bc9da8cc4a79dfb7951788632b8
Author: Masahiro Yamada <masahiroy@kernel.org>
Date:   Thu Mar 26 14:57:15 2020 +0900

    net: wan: wanxl: use allow to pass CROSS_COMPILE_M68k for rebuilding firmware
    
    commit 63b903dfebdea92aa92ad337d8451a6fbfeabf9d upstream.
    
    As far as I understood from the Kconfig help text, this build rule is
    used to rebuild the driver firmware, which runs on an old m68k-based
    chip. So, you need m68k tools for the firmware rebuild.
    
    wanxl.c is a PCI driver, but CONFIG_M68K does not select CONFIG_HAVE_PCI.
    So, you cannot enable CONFIG_WANXL_BUILD_FIRMWARE for ARCH=m68k. In other
    words, ifeq ($(ARCH),m68k) is false here.
    
    I am keeping the dead code for now, but rebuilding the firmware requires
    'as68k' and 'ld68k', which I do not have in hand.
    
    Instead, the kernel.org m68k GCC [1] successfully built it.
    
    Allowing a user to pass in CROSS_COMPILE_M68K= is handier.
    
    [1] https://mirrors.edge.kernel.org/pub/tools/crosstool/files/bin/x86_64/9.2.0/x86_64-gcc-9.2.0-nolibc-m68k-linux.tar.xz
    
    Suggested-by: Geert Uytterhoeven <geert@linux-m68k.org>
    Signed-off-by: Masahiro Yamada <masahiroy@kernel.org>
    Signed-off-by: Nick Desaulniers <ndesaulniers@google.com>
    Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>

commit 6a9dc5fd6170d0a41c8a14eb19e63d94bea5705a
Author: Gustavo A. R. Silva <gustavoars@kernel.org>
Date:   Mon Aug 24 15:36:14 2020 -0500

    lib: Revert use of fallthrough pseudo-keyword in lib/
    
    The following build error for powerpc64 was reported by Nathan Chancellor:
    
      "$ scripts/config --file arch/powerpc/configs/powernv_defconfig -e KERNEL_XZ
    
       $ make -skj"$(nproc)" ARCH=powerpc CROSS_COMPILE=powerpc64le-linux- distclean powernv_defconfig zImage
       ...
       In file included from arch/powerpc/boot/../../../lib/decompress_unxz.c:234,
                        from arch/powerpc/boot/decompress.c:38:
       arch/powerpc/boot/../../../lib/xz/xz_dec_stream.c: In function 'dec_main':
       arch/powerpc/boot/../../../lib/xz/xz_dec_stream.c:586:4: error: 'fallthrough' undeclared (first use in this function)
         586 |    fallthrough;
             |    ^~~~~~~~~~~
    
       This will end up affecting distribution configurations such as Debian
       and OpenSUSE according to my testing. I am not sure what the solution
       is, the PowerPC wrapper does not set -D__KERNEL__ so I am not sure
       that compiler_attributes.h can be safely included."
    
    In order to avoid these sort of problems, it seems that the best
    solution is to use /* fall through */ comments instead of the
    fallthrough pseudo-keyword macro in lib/, for now.
    
    Reported-by: Nathan Chancellor <natechancellor@gmail.com>
    Fixes: df561f6688fe ("treewide: Use fallthrough pseudo-keyword")
    Signed-off-by: Gustavo A. R. Silva <gustavoars@kernel.org>
    Reviewed-and-tested-by: Nathan Chancellor <natechancellor@gmail.com>
    Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>

commit 93d0c1ab23281fda96490f23cd6f2a1966fdc030
Author: Sumit Gupta <sumitg@nvidia.com>
Date:   Wed Aug 12 01:13:17 2020 +0530

    cpufreq: replace cpu_logical_map() with read_cpuid_mpir()
    
    Commit eaecca9e7710 ("arm64: Fix __cpu_logical_map undefined issue")
    fixes the issue with building tegra194 cpufreq driver as module. But
    the fix might cause problem while supporting physical CPU hotplug[1].
    
    This patch fixes the original problem by avoiding use of cpu_logical_map().
    Instead calling read_cpuid_mpidr() to get MPIDR on target CPU.
    
    [1] https://lore.kernel.org/linux-arm-kernel/20200724131059.GB6521@bogus/
    
    Fixes: df320f89359c ("cpufreq: Add Tegra194 cpufreq driver")
    Reviewed-by: Sudeep Holla <sudeep.holla@arm.com>
    Signed-off-by: Sumit Gupta <sumitg@nvidia.com>
    Acked-by: Viresh Kumar <viresh.kumar@linaro.org>
    [ rjw: Subject & changelog edits ]
    Signed-off-by: Rafael J. Wysocki <rafael.j.wysocki@intel.com>

commit fcd4fd88eb02089f2df59f197d6b98a7d5a2f0be
Author: Krzysztof Kozlowski <krzk@kernel.org>
Date:   Wed Aug 5 17:50:53 2020 +0200

    s390/Kconfig: add missing ZCRYPT dependency to VFIO_AP
    
    [ Upstream commit 929a343b858612100cb09443a8aaa20d4a4706d3 ]
    
    The VFIO_AP uses ap_driver_register() (and deregister) functions
    implemented in ap_bus.c (compiled into ap.o).  However the ap.o will be
    built only if CONFIG_ZCRYPT is selected.
    
    This was not visible before commit e93a1695d7fb ("iommu: Enable compile
    testing for some of drivers") because the CONFIG_VFIO_AP depends on
    CONFIG_S390_AP_IOMMU which depends on the missing CONFIG_ZCRYPT.  After
    adding COMPILE_TEST, it is possible to select a configuration with
    VFIO_AP and S390_AP_IOMMU but without the ZCRYPT.
    
    Add proper dependency to the VFIO_AP to fix build errors:
    
    ERROR: modpost: "ap_driver_register" [drivers/s390/crypto/vfio_ap.ko] undefined!
    ERROR: modpost: "ap_driver_unregister" [drivers/s390/crypto/vfio_ap.ko] undefined!
    
    Reported-by: kernel test robot <lkp@intel.com>
    Fixes: e93a1695d7fb ("iommu: Enable compile testing for some of drivers")
    Signed-off-by: Krzysztof Kozlowski <krzk@kernel.org>
    Signed-off-by: Heiko Carstens <hca@linux.ibm.com>
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit fa08065ef74942b9b491a1292e8e0982d781872a
Author: Thomas Hebb <tommyhebb@gmail.com>
Date:   Sun Jul 26 21:08:14 2020 -0700

    tools build feature: Use CC and CXX from parent
    
    [ Upstream commit e3232c2f39acafd5a29128425bc30b9884642cfa ]
    
    commit c8c188679ccf ("tools build: Use the same CC for feature detection
    and actual build") changed these assignments from unconditional (:=) to
    conditional (?=) so that they wouldn't clobber values from the
    environment. However, conditional assignment does not work properly for
    variables that Make implicitly sets, among which are CC and CXX. To
    quote tools/scripts/Makefile.include, which handles this properly:
    
      # Makefiles suck: This macro sets a default value of $(2) for the
      # variable named by $(1), unless the variable has been set by
      # environment or command line. This is necessary for CC and AR
      # because make sets default values, so the simpler ?= approach
      # won't work as expected.
    
    In other words, the conditional assignments will not run even if the
    variables are not overridden in the environment; Make will set CC to
    "cc" and CXX to "g++" when it starts[1], meaning the variables are not
    empty by the time the conditional assignments are evaluated. This breaks
    cross-compilation when CROSS_COMPILE is set but CC isn't, since "cc"
    gets used for feature detection instead of the cross compiler (and
    likewise for CXX).
    
    To fix the issue, just pass down the values of CC and CXX computed by
    the parent Makefile, which gets included by the Makefile that actually
    builds whatever we're detecting features for and so is guaranteed to
    have good values. This is a better solution anyway, since it means we
    aren't trying to replicate the logic of the parent build system and so
    don't risk it getting out of sync.
    
    Leave PKG_CONFIG alone, since 1) there's no common logic to compute it
    in Makefile.include, and 2) it's not an implicit variable, so
    conditional assignment works properly.
    
    [1] https://www.gnu.org/software/make/manual/html_node/Implicit-Variables.html
    
    Fixes: c8c188679ccf ("tools build: Use the same CC for feature detection and actual build")
    Signed-off-by: Thomas Hebb <tommyhebb@gmail.com>
    Acked-by: Jiri Olsa <jolsa@kernel.org>
    Cc: David Carrillo-Cisneros <davidcc@google.com>
    Cc: Ian Rogers <irogers@google.com>
    Cc: Igor Lubashev <ilubashe@akamai.com>
    Cc: Namhyung Kim <namhyung@kernel.org>
    Cc: Quentin Monnet <quentin@isovalent.com>
    Cc: Song Liu <songliubraving@fb.com>
    Cc: Stephane Eranian <eranian@google.com>
    Cc: thomas hebb <tommyhebb@gmail.com>
    Link: http://lore.kernel.org/lkml/0a6e69d1736b0fa231a648f50b0cce5d8a6734ef.1595822871.git.tommyhebb@gmail.com
    Signed-off-by: Arnaldo Carvalho de Melo <acme@redhat.com>
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit fdeb41184c3283bc7019c44b619de9fe8688e598
Author: Krzysztof Kozlowski <krzk@kernel.org>
Date:   Wed Aug 5 17:50:53 2020 +0200

    s390/Kconfig: add missing ZCRYPT dependency to VFIO_AP
    
    [ Upstream commit 929a343b858612100cb09443a8aaa20d4a4706d3 ]
    
    The VFIO_AP uses ap_driver_register() (and deregister) functions
    implemented in ap_bus.c (compiled into ap.o).  However the ap.o will be
    built only if CONFIG_ZCRYPT is selected.
    
    This was not visible before commit e93a1695d7fb ("iommu: Enable compile
    testing for some of drivers") because the CONFIG_VFIO_AP depends on
    CONFIG_S390_AP_IOMMU which depends on the missing CONFIG_ZCRYPT.  After
    adding COMPILE_TEST, it is possible to select a configuration with
    VFIO_AP and S390_AP_IOMMU but without the ZCRYPT.
    
    Add proper dependency to the VFIO_AP to fix build errors:
    
    ERROR: modpost: "ap_driver_register" [drivers/s390/crypto/vfio_ap.ko] undefined!
    ERROR: modpost: "ap_driver_unregister" [drivers/s390/crypto/vfio_ap.ko] undefined!
    
    Reported-by: kernel test robot <lkp@intel.com>
    Fixes: e93a1695d7fb ("iommu: Enable compile testing for some of drivers")
    Signed-off-by: Krzysztof Kozlowski <krzk@kernel.org>
    Signed-off-by: Heiko Carstens <hca@linux.ibm.com>
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit 706355158ebc04ff7bb6c7e988c95648d20f28e2
Author: Thomas Hebb <tommyhebb@gmail.com>
Date:   Sun Jul 26 21:08:14 2020 -0700

    tools build feature: Use CC and CXX from parent
    
    [ Upstream commit e3232c2f39acafd5a29128425bc30b9884642cfa ]
    
    commit c8c188679ccf ("tools build: Use the same CC for feature detection
    and actual build") changed these assignments from unconditional (:=) to
    conditional (?=) so that they wouldn't clobber values from the
    environment. However, conditional assignment does not work properly for
    variables that Make implicitly sets, among which are CC and CXX. To
    quote tools/scripts/Makefile.include, which handles this properly:
    
      # Makefiles suck: This macro sets a default value of $(2) for the
      # variable named by $(1), unless the variable has been set by
      # environment or command line. This is necessary for CC and AR
      # because make sets default values, so the simpler ?= approach
      # won't work as expected.
    
    In other words, the conditional assignments will not run even if the
    variables are not overridden in the environment; Make will set CC to
    "cc" and CXX to "g++" when it starts[1], meaning the variables are not
    empty by the time the conditional assignments are evaluated. This breaks
    cross-compilation when CROSS_COMPILE is set but CC isn't, since "cc"
    gets used for feature detection instead of the cross compiler (and
    likewise for CXX).
    
    To fix the issue, just pass down the values of CC and CXX computed by
    the parent Makefile, which gets included by the Makefile that actually
    builds whatever we're detecting features for and so is guaranteed to
    have good values. This is a better solution anyway, since it means we
    aren't trying to replicate the logic of the parent build system and so
    don't risk it getting out of sync.
    
    Leave PKG_CONFIG alone, since 1) there's no common logic to compute it
    in Makefile.include, and 2) it's not an implicit variable, so
    conditional assignment works properly.
    
    [1] https://www.gnu.org/software/make/manual/html_node/Implicit-Variables.html
    
    Fixes: c8c188679ccf ("tools build: Use the same CC for feature detection and actual build")
    Signed-off-by: Thomas Hebb <tommyhebb@gmail.com>
    Acked-by: Jiri Olsa <jolsa@kernel.org>
    Cc: David Carrillo-Cisneros <davidcc@google.com>
    Cc: Ian Rogers <irogers@google.com>
    Cc: Igor Lubashev <ilubashe@akamai.com>
    Cc: Namhyung Kim <namhyung@kernel.org>
    Cc: Quentin Monnet <quentin@isovalent.com>
    Cc: Song Liu <songliubraving@fb.com>
    Cc: Stephane Eranian <eranian@google.com>
    Cc: thomas hebb <tommyhebb@gmail.com>
    Link: http://lore.kernel.org/lkml/0a6e69d1736b0fa231a648f50b0cce5d8a6734ef.1595822871.git.tommyhebb@gmail.com
    Signed-off-by: Arnaldo Carvalho de Melo <acme@redhat.com>
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit 4f69483568d6732fa61164b2dba3158726ee5cd9
Author: Thomas Hebb <tommyhebb@gmail.com>
Date:   Sun Jul 26 21:08:14 2020 -0700

    tools build feature: Use CC and CXX from parent
    
    [ Upstream commit e3232c2f39acafd5a29128425bc30b9884642cfa ]
    
    commit c8c188679ccf ("tools build: Use the same CC for feature detection
    and actual build") changed these assignments from unconditional (:=) to
    conditional (?=) so that they wouldn't clobber values from the
    environment. However, conditional assignment does not work properly for
    variables that Make implicitly sets, among which are CC and CXX. To
    quote tools/scripts/Makefile.include, which handles this properly:
    
      # Makefiles suck: This macro sets a default value of $(2) for the
      # variable named by $(1), unless the variable has been set by
      # environment or command line. This is necessary for CC and AR
      # because make sets default values, so the simpler ?= approach
      # won't work as expected.
    
    In other words, the conditional assignments will not run even if the
    variables are not overridden in the environment; Make will set CC to
    "cc" and CXX to "g++" when it starts[1], meaning the variables are not
    empty by the time the conditional assignments are evaluated. This breaks
    cross-compilation when CROSS_COMPILE is set but CC isn't, since "cc"
    gets used for feature detection instead of the cross compiler (and
    likewise for CXX).
    
    To fix the issue, just pass down the values of CC and CXX computed by
    the parent Makefile, which gets included by the Makefile that actually
    builds whatever we're detecting features for and so is guaranteed to
    have good values. This is a better solution anyway, since it means we
    aren't trying to replicate the logic of the parent build system and so
    don't risk it getting out of sync.
    
    Leave PKG_CONFIG alone, since 1) there's no common logic to compute it
    in Makefile.include, and 2) it's not an implicit variable, so
    conditional assignment works properly.
    
    [1] https://www.gnu.org/software/make/manual/html_node/Implicit-Variables.html
    
    Fixes: c8c188679ccf ("tools build: Use the same CC for feature detection and actual build")
    Signed-off-by: Thomas Hebb <tommyhebb@gmail.com>
    Acked-by: Jiri Olsa <jolsa@kernel.org>
    Cc: David Carrillo-Cisneros <davidcc@google.com>
    Cc: Ian Rogers <irogers@google.com>
    Cc: Igor Lubashev <ilubashe@akamai.com>
    Cc: Namhyung Kim <namhyung@kernel.org>
    Cc: Quentin Monnet <quentin@isovalent.com>
    Cc: Song Liu <songliubraving@fb.com>
    Cc: Stephane Eranian <eranian@google.com>
    Cc: thomas hebb <tommyhebb@gmail.com>
    Link: http://lore.kernel.org/lkml/0a6e69d1736b0fa231a648f50b0cce5d8a6734ef.1595822871.git.tommyhebb@gmail.com
    Signed-off-by: Arnaldo Carvalho de Melo <acme@redhat.com>
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit bb1da23aa45bbe1edb74379d5b541c62f0d2836a
Author: Thomas Hebb <tommyhebb@gmail.com>
Date:   Sun Jul 26 21:08:14 2020 -0700

    tools build feature: Use CC and CXX from parent
    
    [ Upstream commit e3232c2f39acafd5a29128425bc30b9884642cfa ]
    
    commit c8c188679ccf ("tools build: Use the same CC for feature detection
    and actual build") changed these assignments from unconditional (:=) to
    conditional (?=) so that they wouldn't clobber values from the
    environment. However, conditional assignment does not work properly for
    variables that Make implicitly sets, among which are CC and CXX. To
    quote tools/scripts/Makefile.include, which handles this properly:
    
      # Makefiles suck: This macro sets a default value of $(2) for the
      # variable named by $(1), unless the variable has been set by
      # environment or command line. This is necessary for CC and AR
      # because make sets default values, so the simpler ?= approach
      # won't work as expected.
    
    In other words, the conditional assignments will not run even if the
    variables are not overridden in the environment; Make will set CC to
    "cc" and CXX to "g++" when it starts[1], meaning the variables are not
    empty by the time the conditional assignments are evaluated. This breaks
    cross-compilation when CROSS_COMPILE is set but CC isn't, since "cc"
    gets used for feature detection instead of the cross compiler (and
    likewise for CXX).
    
    To fix the issue, just pass down the values of CC and CXX computed by
    the parent Makefile, which gets included by the Makefile that actually
    builds whatever we're detecting features for and so is guaranteed to
    have good values. This is a better solution anyway, since it means we
    aren't trying to replicate the logic of the parent build system and so
    don't risk it getting out of sync.
    
    Leave PKG_CONFIG alone, since 1) there's no common logic to compute it
    in Makefile.include, and 2) it's not an implicit variable, so
    conditional assignment works properly.
    
    [1] https://www.gnu.org/software/make/manual/html_node/Implicit-Variables.html
    
    Fixes: c8c188679ccf ("tools build: Use the same CC for feature detection and actual build")
    Signed-off-by: Thomas Hebb <tommyhebb@gmail.com>
    Acked-by: Jiri Olsa <jolsa@kernel.org>
    Cc: David Carrillo-Cisneros <davidcc@google.com>
    Cc: Ian Rogers <irogers@google.com>
    Cc: Igor Lubashev <ilubashe@akamai.com>
    Cc: Namhyung Kim <namhyung@kernel.org>
    Cc: Quentin Monnet <quentin@isovalent.com>
    Cc: Song Liu <songliubraving@fb.com>
    Cc: Stephane Eranian <eranian@google.com>
    Cc: thomas hebb <tommyhebb@gmail.com>
    Link: http://lore.kernel.org/lkml/0a6e69d1736b0fa231a648f50b0cce5d8a6734ef.1595822871.git.tommyhebb@gmail.com
    Signed-off-by: Arnaldo Carvalho de Melo <acme@redhat.com>
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit 0999f2835cd4ecb5e6374d86d57a2e041333a504
Author: Thomas Hebb <tommyhebb@gmail.com>
Date:   Sun Jul 26 21:08:14 2020 -0700

    tools build feature: Use CC and CXX from parent
    
    [ Upstream commit e3232c2f39acafd5a29128425bc30b9884642cfa ]
    
    commit c8c188679ccf ("tools build: Use the same CC for feature detection
    and actual build") changed these assignments from unconditional (:=) to
    conditional (?=) so that they wouldn't clobber values from the
    environment. However, conditional assignment does not work properly for
    variables that Make implicitly sets, among which are CC and CXX. To
    quote tools/scripts/Makefile.include, which handles this properly:
    
      # Makefiles suck: This macro sets a default value of $(2) for the
      # variable named by $(1), unless the variable has been set by
      # environment or command line. This is necessary for CC and AR
      # because make sets default values, so the simpler ?= approach
      # won't work as expected.
    
    In other words, the conditional assignments will not run even if the
    variables are not overridden in the environment; Make will set CC to
    "cc" and CXX to "g++" when it starts[1], meaning the variables are not
    empty by the time the conditional assignments are evaluated. This breaks
    cross-compilation when CROSS_COMPILE is set but CC isn't, since "cc"
    gets used for feature detection instead of the cross compiler (and
    likewise for CXX).
    
    To fix the issue, just pass down the values of CC and CXX computed by
    the parent Makefile, which gets included by the Makefile that actually
    builds whatever we're detecting features for and so is guaranteed to
    have good values. This is a better solution anyway, since it means we
    aren't trying to replicate the logic of the parent build system and so
    don't risk it getting out of sync.
    
    Leave PKG_CONFIG alone, since 1) there's no common logic to compute it
    in Makefile.include, and 2) it's not an implicit variable, so
    conditional assignment works properly.
    
    [1] https://www.gnu.org/software/make/manual/html_node/Implicit-Variables.html
    
    Fixes: c8c188679ccf ("tools build: Use the same CC for feature detection and actual build")
    Signed-off-by: Thomas Hebb <tommyhebb@gmail.com>
    Acked-by: Jiri Olsa <jolsa@kernel.org>
    Cc: David Carrillo-Cisneros <davidcc@google.com>
    Cc: Ian Rogers <irogers@google.com>
    Cc: Igor Lubashev <ilubashe@akamai.com>
    Cc: Namhyung Kim <namhyung@kernel.org>
    Cc: Quentin Monnet <quentin@isovalent.com>
    Cc: Song Liu <songliubraving@fb.com>
    Cc: Stephane Eranian <eranian@google.com>
    Cc: thomas hebb <tommyhebb@gmail.com>
    Link: http://lore.kernel.org/lkml/0a6e69d1736b0fa231a648f50b0cce5d8a6734ef.1595822871.git.tommyhebb@gmail.com
    Signed-off-by: Arnaldo Carvalho de Melo <acme@redhat.com>
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit 322b60ceb0f321b4b9c41717f7306c0dbaf0279b
Author: Carl Huang <cjhuang@codeaurora.org>
Date:   Thu Aug 13 12:04:17 2020 +0300

    ath11k: do not depend on ARCH_QCOM for ath11k
    
    With only IPQ8074 supported ath11k was only usable on Qualcomm architectures.
    But now that we are adding QCA6390 PCI support to ath11k that's not the case
    anymore and it can be used on any architecture supporting PCI. So remove the
    dependency on ARCH_QCOM. After that there is also no need to depend on
    COMPILE_TEST.
    
    Tested-on: QCA6390 hw2.0 PCI WLAN.HST.1.0.1-01740-QCAHSTSWPLZ_V2_TO_X86-1
    Tested-on: IPQ8074 hw2.0 AHB WLAN.HK.2.1.0.1-01238-QCAHKSWPL_SILICONZ-2
    
    Signed-off-by: Carl Huang <cjhuang@codeaurora.org>
    Signed-off-by: Kalle Valo <kvalo@codeaurora.org>
    Link: https://lore.kernel.org/r/1597309466-19688-2-git-send-email-kvalo@codeaurora.org

commit 929a343b858612100cb09443a8aaa20d4a4706d3
Author: Krzysztof Kozlowski <krzk@kernel.org>
Date:   Wed Aug 5 17:50:53 2020 +0200

    s390/Kconfig: add missing ZCRYPT dependency to VFIO_AP
    
    The VFIO_AP uses ap_driver_register() (and deregister) functions
    implemented in ap_bus.c (compiled into ap.o).  However the ap.o will be
    built only if CONFIG_ZCRYPT is selected.
    
    This was not visible before commit e93a1695d7fb ("iommu: Enable compile
    testing for some of drivers") because the CONFIG_VFIO_AP depends on
    CONFIG_S390_AP_IOMMU which depends on the missing CONFIG_ZCRYPT.  After
    adding COMPILE_TEST, it is possible to select a configuration with
    VFIO_AP and S390_AP_IOMMU but without the ZCRYPT.
    
    Add proper dependency to the VFIO_AP to fix build errors:
    
    ERROR: modpost: "ap_driver_register" [drivers/s390/crypto/vfio_ap.ko] undefined!
    ERROR: modpost: "ap_driver_unregister" [drivers/s390/crypto/vfio_ap.ko] undefined!
    
    Reported-by: kernel test robot <lkp@intel.com>
    Fixes: e93a1695d7fb ("iommu: Enable compile testing for some of drivers")
    Signed-off-by: Krzysztof Kozlowski <krzk@kernel.org>
    Signed-off-by: Heiko Carstens <hca@linux.ibm.com>

commit bbb839901fe865a56d91aa88d70908a7d16268a1
Merge: f8851cb2d0cc 3f0279488821
Author: Linus Torvalds <torvalds@linux-foundation.org>
Date:   Mon Aug 3 20:05:44 2020 -0700

    Merge tag 'regulator-v5.9' of git://git.kernel.org/pub/scm/linux/kernel/git/broonie/regulator
    
    Pull regulator updates from Mark Brown:
     "This time around the bulk of the work on the regulator API has been
      cleanups of various kinds, partly but not entirely inspired by the W=1
      stuff that 0day turned on.
    
      There's also been a fairly large crop of new drivers, and a few
      bugfixes for existing drivers.
    
       - Mode setting support for MT6397 and DA9211.
    
       - New drivers for ChromeOS embedded controllers, Fairchild FAN53880,
         NXP PCA9450, Qualcomm LABIBB, MP5496, and VBUS booster, and Silergy
         SY8827N"
    
    * tag 'regulator-v5.9' of git://git.kernel.org/pub/scm/linux/kernel/git/broonie/regulator: (67 commits)
      regulator: add the sub node names for the MP5496 PMIC
      regulator: cros-ec-regulator: Fix double free of desc->name.
      platform/chrome: cros_ec: Fix host command for regulator control.
      regulator: pca9450: Convert to use module_i2c_driver
      regulator: fix memory leak on error path of regulator_register()
      regulator: Replace HTTP links with HTTPS ones
      regulator: convert QCOM SMD-RPM regulator document to YAML schema
      regulator: gpio: Honor regulator-boot-on property
      regulator: core: Add destroy_regulator()
      regulator: Correct kernel-doc inconsistency
      regulator: Add labibb regulator binding
      regulator: qcom: Add labibb driver
      regulator: Allow regulators to verify enabled during enable()
      regulator: cros-ec: Constify cros_ec_regulator_voltage_ops
      regulator: devres: Standardise on function documentation headers
      regulator: of_regulator: Add missing colon for rdev kerneldoc argument
      regulator: devres: Fix issues with kerneldoc headers
      regulator: fan53880: Add support for COMPILE_TEST
      regulator: fan53880: Add missing .owner field in regulator_desc
      dt-bindings: regulator: add pca9450 regulator yaml
      ...

commit 48040793fa6003d211f021c6ad273477bcd90d91
Author: Yousuk Seung <ysseung@google.com>
Date:   Thu Jul 30 15:44:40 2020 -0700

    tcp: add earliest departure time to SCM_TIMESTAMPING_OPT_STATS
    
    This change adds TCP_NLA_EDT to SCM_TIMESTAMPING_OPT_STATS that reports
    the earliest departure time(EDT) of the timestamped skb. By tracking EDT
    values of the skb from different timestamps, we can observe when and how
    much the value changed. This allows to measure the precise delay
    injected on the sender host e.g. by a bpf-base throttler.
    
    Signed-off-by: Yousuk Seung <ysseung@google.com>
    Signed-off-by: Eric Dumazet <edumazet@google.com>
    Acked-by: Neal Cardwell <ncardwell@google.com>
    Acked-by: Soheil Hassas Yeganeh <soheil@google.com>
    Acked-by: Yuchung Cheng <ycheng@google.com>
    Signed-off-by: David S. Miller <davem@davemloft.net>

commit d98d958276c73db039a4c47499cd9f085bcec6bb
Author: Fangrui Song <maskray@google.com>
Date:   Tue Jul 21 10:31:23 2020 -0700

    Makefile: Fix GCC_TOOLCHAIN_DIR prefix for Clang cross compilation
    
    commit ca9b31f6bb9c6aa9b4e5f0792f39a97bbffb8c51 upstream.
    
    When CROSS_COMPILE is set (e.g. aarch64-linux-gnu-), if
    $(CROSS_COMPILE)elfedit is found at /usr/bin/aarch64-linux-gnu-elfedit,
    GCC_TOOLCHAIN_DIR will be set to /usr/bin/.  --prefix= will be set to
    /usr/bin/ and Clang as of 11 will search for both
    $(prefix)aarch64-linux-gnu-$needle and $(prefix)$needle.
    
    GCC searchs for $(prefix)aarch64-linux-gnu/$version/$needle,
    $(prefix)aarch64-linux-gnu/$needle and $(prefix)$needle. In practice,
    $(prefix)aarch64-linux-gnu/$needle rarely contains executables.
    
    To better model how GCC's -B/--prefix takes in effect in practice, newer
    Clang (since
    https://github.com/llvm/llvm-project/commit/3452a0d8c17f7166f479706b293caf6ac76ffd90)
    only searches for $(prefix)$needle. Currently it will find /usr/bin/as
    instead of /usr/bin/aarch64-linux-gnu-as.
    
    Set --prefix= to $(GCC_TOOLCHAIN_DIR)$(notdir $(CROSS_COMPILE))
    (/usr/bin/aarch64-linux-gnu-) so that newer Clang can find the
    appropriate cross compiling GNU as (when -no-integrated-as is in
    effect).
    
    Cc: stable@vger.kernel.org
    Reported-by: Nathan Chancellor <natechancellor@gmail.com>
    Signed-off-by: Fangrui Song <maskray@google.com>
    Reviewed-by: Nathan Chancellor <natechancellor@gmail.com>
    Tested-by: Nathan Chancellor <natechancellor@gmail.com>
    Tested-by: Nick Desaulniers <ndesaulniers@google.com>
    Link: https://github.com/ClangBuiltLinux/linux/issues/1099
    Reviewed-by: Nick Desaulniers <ndesaulniers@google.com>
    Signed-off-by: Masahiro Yamada <masahiroy@kernel.org>
    Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>

commit 993320d59fc790ac9e85df2f4b51876a059103c1
Author: Fangrui Song <maskray@google.com>
Date:   Tue Jul 21 10:31:23 2020 -0700

    Makefile: Fix GCC_TOOLCHAIN_DIR prefix for Clang cross compilation
    
    commit ca9b31f6bb9c6aa9b4e5f0792f39a97bbffb8c51 upstream.
    
    When CROSS_COMPILE is set (e.g. aarch64-linux-gnu-), if
    $(CROSS_COMPILE)elfedit is found at /usr/bin/aarch64-linux-gnu-elfedit,
    GCC_TOOLCHAIN_DIR will be set to /usr/bin/.  --prefix= will be set to
    /usr/bin/ and Clang as of 11 will search for both
    $(prefix)aarch64-linux-gnu-$needle and $(prefix)$needle.
    
    GCC searchs for $(prefix)aarch64-linux-gnu/$version/$needle,
    $(prefix)aarch64-linux-gnu/$needle and $(prefix)$needle. In practice,
    $(prefix)aarch64-linux-gnu/$needle rarely contains executables.
    
    To better model how GCC's -B/--prefix takes in effect in practice, newer
    Clang (since
    https://github.com/llvm/llvm-project/commit/3452a0d8c17f7166f479706b293caf6ac76ffd90)
    only searches for $(prefix)$needle. Currently it will find /usr/bin/as
    instead of /usr/bin/aarch64-linux-gnu-as.
    
    Set --prefix= to $(GCC_TOOLCHAIN_DIR)$(notdir $(CROSS_COMPILE))
    (/usr/bin/aarch64-linux-gnu-) so that newer Clang can find the
    appropriate cross compiling GNU as (when -no-integrated-as is in
    effect).
    
    Cc: stable@vger.kernel.org
    Reported-by: Nathan Chancellor <natechancellor@gmail.com>
    Signed-off-by: Fangrui Song <maskray@google.com>
    Reviewed-by: Nathan Chancellor <natechancellor@gmail.com>
    Tested-by: Nathan Chancellor <natechancellor@gmail.com>
    Tested-by: Nick Desaulniers <ndesaulniers@google.com>
    Link: https://github.com/ClangBuiltLinux/linux/issues/1099
    Reviewed-by: Nick Desaulniers <ndesaulniers@google.com>
    Signed-off-by: Masahiro Yamada <masahiroy@kernel.org>
    [nc: Adjust context, CLANG_FLAGS does not exist in 4.4]
    Signed-off-by: Nathan Chancellor <natechancellor@gmail.com>
    Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>

commit e3232c2f39acafd5a29128425bc30b9884642cfa
Author: Thomas Hebb <tommyhebb@gmail.com>
Date:   Sun Jul 26 21:08:14 2020 -0700

    tools build feature: Use CC and CXX from parent
    
    commit c8c188679ccf ("tools build: Use the same CC for feature detection
    and actual build") changed these assignments from unconditional (:=) to
    conditional (?=) so that they wouldn't clobber values from the
    environment. However, conditional assignment does not work properly for
    variables that Make implicitly sets, among which are CC and CXX. To
    quote tools/scripts/Makefile.include, which handles this properly:
    
      # Makefiles suck: This macro sets a default value of $(2) for the
      # variable named by $(1), unless the variable has been set by
      # environment or command line. This is necessary for CC and AR
      # because make sets default values, so the simpler ?= approach
      # won't work as expected.
    
    In other words, the conditional assignments will not run even if the
    variables are not overridden in the environment; Make will set CC to
    "cc" and CXX to "g++" when it starts[1], meaning the variables are not
    empty by the time the conditional assignments are evaluated. This breaks
    cross-compilation when CROSS_COMPILE is set but CC isn't, since "cc"
    gets used for feature detection instead of the cross compiler (and
    likewise for CXX).
    
    To fix the issue, just pass down the values of CC and CXX computed by
    the parent Makefile, which gets included by the Makefile that actually
    builds whatever we're detecting features for and so is guaranteed to
    have good values. This is a better solution anyway, since it means we
    aren't trying to replicate the logic of the parent build system and so
    don't risk it getting out of sync.
    
    Leave PKG_CONFIG alone, since 1) there's no common logic to compute it
    in Makefile.include, and 2) it's not an implicit variable, so
    conditional assignment works properly.
    
    [1] https://www.gnu.org/software/make/manual/html_node/Implicit-Variables.html
    
    Fixes: c8c188679ccf ("tools build: Use the same CC for feature detection and actual build")
    Signed-off-by: Thomas Hebb <tommyhebb@gmail.com>
    Acked-by: Jiri Olsa <jolsa@kernel.org>
    Cc: David Carrillo-Cisneros <davidcc@google.com>
    Cc: Ian Rogers <irogers@google.com>
    Cc: Igor Lubashev <ilubashe@akamai.com>
    Cc: Namhyung Kim <namhyung@kernel.org>
    Cc: Quentin Monnet <quentin@isovalent.com>
    Cc: Song Liu <songliubraving@fb.com>
    Cc: Stephane Eranian <eranian@google.com>
    Cc: thomas hebb <tommyhebb@gmail.com>
    Link: http://lore.kernel.org/lkml/0a6e69d1736b0fa231a648f50b0cce5d8a6734ef.1595822871.git.tommyhebb@gmail.com
    Signed-off-by: Arnaldo Carvalho de Melo <acme@redhat.com>

commit 9972321613e8213e76506abe1e53c69c250f89b1
Author: Geert Uytterhoeven <geert@linux-m68k.org>
Date:   Mon Jun 29 14:24:43 2020 +0200

    ASoC: qcom: Drop HAS_DMA dependency to fix link failure
    
    commit b6aa06de7757667bac88997a8807b143b8436035 upstream.
    
    When building on allyesconfig kernel for a NO_DMA=y platform (e.g.
    Sun-3), CONFIG_SND_SOC_QCOM_COMMON=y, but CONFIG_SND_SOC_QDSP6_AFE=n,
    leading to a link failure:
    
        sound/soc/qcom/common.o: In function `qcom_snd_parse_of':
        common.c:(.text+0x2e2): undefined reference to `q6afe_is_rx_port'
    
    While SND_SOC_QDSP6 depends on HAS_DMA, SND_SOC_MSM8996 and SND_SOC_SDM845
    don't, so the following warning is seen:
    
        WARNING: unmet direct dependencies detected for SND_SOC_QDSP6
          Depends on [n]: SOUND [=y] && !UML && SND [=y] && SND_SOC [=y] && QCOM_APR [=y] && HAS_DMA [=n]
          Selected by [y]:
          - SND_SOC_MSM8996 [=y] && SOUND [=y] && !UML && SND [=y] && SND_SOC [=y] && QCOM_APR [=y]
          - SND_SOC_SDM845 [=y] && SOUND [=y] && !UML && SND [=y] && SND_SOC [=y] && QCOM_APR [=y] && CROS_EC [=y] && I2C [=y] && SOUNDWIRE [=y]
    
    Until recently, this warning was harmless (from a compile-testing
    point-of-view), but the new user of q6afe_is_rx_port() turned this into
    a hard failure.
    
    As the QDSP6 driver itself builds fine if NO_DMA=y, and it depends on
    QCOM_APR (which in turns depends on ARCH_QCOM || COMPILE_TEST), it is
    safe to increase compile testing coverage.  Hence fix the link failure
    by dropping the HAS_DMA dependency of SND_SOC_QDSP6.
    
    Fixes: a2120089251f1fe2 ("ASoC: qcom: common: set correct directions for dailinks")
    Fixes: 6b1687bf76ef84cb ("ASoC: qcom: add sdm845 sound card support")
    Fixes: a6f933f63f2ffdb2 ("ASoC: qcom: apq8096: Add db820c machine driver")
    Signed-off-by: Geert Uytterhoeven <geert@linux-m68k.org>
    Link: https://lore.kernel.org/r/20200629122443.21736-1-geert@linux-m68k.org
    Signed-off-by: Mark Brown <broonie@kernel.org>
    Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>

commit 0515349fee17bb0002e10b32904172a274dbd34e
Author: Nathan Chancellor <natechancellor@gmail.com>
Date:   Wed Jul 22 21:15:10 2020 -0700

    arm64: vdso32: Fix '--prefix=' value for newer versions of clang
    
    commit 7b7891c7bdfd61fc9ed6747a0a05efe2394dddc6 upstream.
    
    Newer versions of clang only look for $(COMPAT_GCC_TOOLCHAIN_DIR)as [1],
    rather than $(COMPAT_GCC_TOOLCHAIN_DIR)$(CROSS_COMPILE_COMPAT)as,
    resulting in the following build error:
    
    $ make -skj"$(nproc)" ARCH=arm64 CROSS_COMPILE=aarch64-linux-gnu- \
    CROSS_COMPILE_COMPAT=arm-linux-gnueabi- LLVM=1 O=out/aarch64 distclean \
    defconfig arch/arm64/kernel/vdso32/
    ...
    /home/nathan/cbl/toolchains/llvm-binutils/bin/as: unrecognized option '-EL'
    clang-12: error: assembler command failed with exit code 1 (use -v to see invocation)
    make[3]: *** [arch/arm64/kernel/vdso32/Makefile:181: arch/arm64/kernel/vdso32/note.o] Error 1
    ...
    
    Adding the value of CROSS_COMPILE_COMPAT (adding notdir to account for a
    full path for CROSS_COMPILE_COMPAT) fixes this issue, which matches the
    solution done for the main Makefile [2].
    
    [1]: https://github.com/llvm/llvm-project/commit/3452a0d8c17f7166f479706b293caf6ac76ffd90
    [2]: https://lore.kernel.org/lkml/20200721173125.1273884-1-maskray@google.com/
    
    Signed-off-by: Nathan Chancellor <natechancellor@gmail.com>
    Cc: stable@vger.kernel.org
    Link: https://github.com/ClangBuiltLinux/linux/issues/1099
    Link: https://lore.kernel.org/r/20200723041509.400450-1-natechancellor@gmail.com
    Signed-off-by: Will Deacon <will@kernel.org>
    Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>

commit 4055a0a9dc137856c9b99be72d56edae6c8564ea
Author: Fangrui Song <maskray@google.com>
Date:   Tue Jul 21 10:31:23 2020 -0700

    Makefile: Fix GCC_TOOLCHAIN_DIR prefix for Clang cross compilation
    
    commit ca9b31f6bb9c6aa9b4e5f0792f39a97bbffb8c51 upstream.
    
    When CROSS_COMPILE is set (e.g. aarch64-linux-gnu-), if
    $(CROSS_COMPILE)elfedit is found at /usr/bin/aarch64-linux-gnu-elfedit,
    GCC_TOOLCHAIN_DIR will be set to /usr/bin/.  --prefix= will be set to
    /usr/bin/ and Clang as of 11 will search for both
    $(prefix)aarch64-linux-gnu-$needle and $(prefix)$needle.
    
    GCC searchs for $(prefix)aarch64-linux-gnu/$version/$needle,
    $(prefix)aarch64-linux-gnu/$needle and $(prefix)$needle. In practice,
    $(prefix)aarch64-linux-gnu/$needle rarely contains executables.
    
    To better model how GCC's -B/--prefix takes in effect in practice, newer
    Clang (since
    https://github.com/llvm/llvm-project/commit/3452a0d8c17f7166f479706b293caf6ac76ffd90)
    only searches for $(prefix)$needle. Currently it will find /usr/bin/as
    instead of /usr/bin/aarch64-linux-gnu-as.
    
    Set --prefix= to $(GCC_TOOLCHAIN_DIR)$(notdir $(CROSS_COMPILE))
    (/usr/bin/aarch64-linux-gnu-) so that newer Clang can find the
    appropriate cross compiling GNU as (when -no-integrated-as is in
    effect).
    
    Cc: stable@vger.kernel.org
    Reported-by: Nathan Chancellor <natechancellor@gmail.com>
    Signed-off-by: Fangrui Song <maskray@google.com>
    Reviewed-by: Nathan Chancellor <natechancellor@gmail.com>
    Tested-by: Nathan Chancellor <natechancellor@gmail.com>
    Tested-by: Nick Desaulniers <ndesaulniers@google.com>
    Link: https://github.com/ClangBuiltLinux/linux/issues/1099
    Reviewed-by: Nick Desaulniers <ndesaulniers@google.com>
    Signed-off-by: Masahiro Yamada <masahiroy@kernel.org>
    Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>

commit 16155138e82bebf86d8b0ed82df33ba8ef463f49
Author: Matthew Howell <matthew.howell@sealevel.com>
Date:   Wed Jul 22 16:11:24 2020 -0400

    serial: exar: Fix GPIO configuration for Sealevel cards based on XR17V35X
    
    [ Upstream commit 5fdbe136ae19ab751daaa4d08d9a42f3e30d17f9 ]
    
    Sealevel XR17V35X based devices are inoperable on kernel versions
    4.11 and above due to a change in the GPIO preconfiguration introduced in
    commit
    7dea8165f1d. This patch fixes this by preconfiguring the GPIO on Sealevel
    cards to the value (0x00) used prior to commit 7dea8165f1d
    
    With GPIOs preconfigured as per commit 7dea8165f1d all ports on
    Sealevel XR17V35X based devices become stuck in high impedance
    mode, regardless of dip-switch or software configuration. This
    causes the device to become effectively unusable. This patch (in
    various forms) has been distributed to our customers and no issues
    related to it have been reported.
    
    Fixes: 7dea8165f1d6 ("serial: exar: Preconfigure xr17v35x MPIOs as output")
    Signed-off-by: Matthew Howell <matthew.howell@sealevel.com>
    Link: https://lore.kernel.org/r/alpine.DEB.2.21.2007221605270.13247@tstest-VirtualBox
    Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit e60e53e685d94efd7a369ca479a7cc88bef778ea
Author: Geert Uytterhoeven <geert@linux-m68k.org>
Date:   Mon Jun 29 14:24:43 2020 +0200

    ASoC: qcom: Drop HAS_DMA dependency to fix link failure
    
    commit b6aa06de7757667bac88997a8807b143b8436035 upstream.
    
    When building on allyesconfig kernel for a NO_DMA=y platform (e.g.
    Sun-3), CONFIG_SND_SOC_QCOM_COMMON=y, but CONFIG_SND_SOC_QDSP6_AFE=n,
    leading to a link failure:
    
        sound/soc/qcom/common.o: In function `qcom_snd_parse_of':
        common.c:(.text+0x2e2): undefined reference to `q6afe_is_rx_port'
    
    While SND_SOC_QDSP6 depends on HAS_DMA, SND_SOC_MSM8996 and SND_SOC_SDM845
    don't, so the following warning is seen:
    
        WARNING: unmet direct dependencies detected for SND_SOC_QDSP6
          Depends on [n]: SOUND [=y] && !UML && SND [=y] && SND_SOC [=y] && QCOM_APR [=y] && HAS_DMA [=n]
          Selected by [y]:
          - SND_SOC_MSM8996 [=y] && SOUND [=y] && !UML && SND [=y] && SND_SOC [=y] && QCOM_APR [=y]
          - SND_SOC_SDM845 [=y] && SOUND [=y] && !UML && SND [=y] && SND_SOC [=y] && QCOM_APR [=y] && CROS_EC [=y] && I2C [=y] && SOUNDWIRE [=y]
    
    Until recently, this warning was harmless (from a compile-testing
    point-of-view), but the new user of q6afe_is_rx_port() turned this into
    a hard failure.
    
    As the QDSP6 driver itself builds fine if NO_DMA=y, and it depends on
    QCOM_APR (which in turns depends on ARCH_QCOM || COMPILE_TEST), it is
    safe to increase compile testing coverage.  Hence fix the link failure
    by dropping the HAS_DMA dependency of SND_SOC_QDSP6.
    
    Fixes: a2120089251f1fe2 ("ASoC: qcom: common: set correct directions for dailinks")
    Fixes: 6b1687bf76ef84cb ("ASoC: qcom: add sdm845 sound card support")
    Fixes: a6f933f63f2ffdb2 ("ASoC: qcom: apq8096: Add db820c machine driver")
    Signed-off-by: Geert Uytterhoeven <geert@linux-m68k.org>
    Link: https://lore.kernel.org/r/20200629122443.21736-1-geert@linux-m68k.org
    Signed-off-by: Mark Brown <broonie@kernel.org>
    Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>

commit 5835e6d5988ff86bc1a184c35837c64c6acc3fa4
Author: Fangrui Song <maskray@google.com>
Date:   Tue Jul 21 10:31:23 2020 -0700

    Makefile: Fix GCC_TOOLCHAIN_DIR prefix for Clang cross compilation
    
    commit ca9b31f6bb9c6aa9b4e5f0792f39a97bbffb8c51 upstream.
    
    When CROSS_COMPILE is set (e.g. aarch64-linux-gnu-), if
    $(CROSS_COMPILE)elfedit is found at /usr/bin/aarch64-linux-gnu-elfedit,
    GCC_TOOLCHAIN_DIR will be set to /usr/bin/.  --prefix= will be set to
    /usr/bin/ and Clang as of 11 will search for both
    $(prefix)aarch64-linux-gnu-$needle and $(prefix)$needle.
    
    GCC searchs for $(prefix)aarch64-linux-gnu/$version/$needle,
    $(prefix)aarch64-linux-gnu/$needle and $(prefix)$needle. In practice,
    $(prefix)aarch64-linux-gnu/$needle rarely contains executables.
    
    To better model how GCC's -B/--prefix takes in effect in practice, newer
    Clang (since
    https://github.com/llvm/llvm-project/commit/3452a0d8c17f7166f479706b293caf6ac76ffd90)
    only searches for $(prefix)$needle. Currently it will find /usr/bin/as
    instead of /usr/bin/aarch64-linux-gnu-as.
    
    Set --prefix= to $(GCC_TOOLCHAIN_DIR)$(notdir $(CROSS_COMPILE))
    (/usr/bin/aarch64-linux-gnu-) so that newer Clang can find the
    appropriate cross compiling GNU as (when -no-integrated-as is in
    effect).
    
    Cc: stable@vger.kernel.org
    Reported-by: Nathan Chancellor <natechancellor@gmail.com>
    Signed-off-by: Fangrui Song <maskray@google.com>
    Reviewed-by: Nathan Chancellor <natechancellor@gmail.com>
    Tested-by: Nathan Chancellor <natechancellor@gmail.com>
    Tested-by: Nick Desaulniers <ndesaulniers@google.com>
    Link: https://github.com/ClangBuiltLinux/linux/issues/1099
    Reviewed-by: Nick Desaulniers <ndesaulniers@google.com>
    Signed-off-by: Masahiro Yamada <masahiroy@kernel.org>
    Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>

commit 1e63d569fd2d97c0c19356645e23fa1a4e44008c
Author: Matthew Howell <matthew.howell@sealevel.com>
Date:   Wed Jul 22 16:11:24 2020 -0400

    serial: exar: Fix GPIO configuration for Sealevel cards based on XR17V35X
    
    [ Upstream commit 5fdbe136ae19ab751daaa4d08d9a42f3e30d17f9 ]
    
    Sealevel XR17V35X based devices are inoperable on kernel versions
    4.11 and above due to a change in the GPIO preconfiguration introduced in
    commit
    7dea8165f1d. This patch fixes this by preconfiguring the GPIO on Sealevel
    cards to the value (0x00) used prior to commit 7dea8165f1d
    
    With GPIOs preconfigured as per commit 7dea8165f1d all ports on
    Sealevel XR17V35X based devices become stuck in high impedance
    mode, regardless of dip-switch or software configuration. This
    causes the device to become effectively unusable. This patch (in
    various forms) has been distributed to our customers and no issues
    related to it have been reported.
    
    Fixes: 7dea8165f1d6 ("serial: exar: Preconfigure xr17v35x MPIOs as output")
    Signed-off-by: Matthew Howell <matthew.howell@sealevel.com>
    Link: https://lore.kernel.org/r/alpine.DEB.2.21.2007221605270.13247@tstest-VirtualBox
    Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit 0d034bb300f9ac8e567f67015466485e0556fd09
Author: Geert Uytterhoeven <geert@linux-m68k.org>
Date:   Mon Jun 29 14:24:43 2020 +0200

    ASoC: qcom: Drop HAS_DMA dependency to fix link failure
    
    commit b6aa06de7757667bac88997a8807b143b8436035 upstream.
    
    When building on allyesconfig kernel for a NO_DMA=y platform (e.g.
    Sun-3), CONFIG_SND_SOC_QCOM_COMMON=y, but CONFIG_SND_SOC_QDSP6_AFE=n,
    leading to a link failure:
    
        sound/soc/qcom/common.o: In function `qcom_snd_parse_of':
        common.c:(.text+0x2e2): undefined reference to `q6afe_is_rx_port'
    
    While SND_SOC_QDSP6 depends on HAS_DMA, SND_SOC_MSM8996 and SND_SOC_SDM845
    don't, so the following warning is seen:
    
        WARNING: unmet direct dependencies detected for SND_SOC_QDSP6
          Depends on [n]: SOUND [=y] && !UML && SND [=y] && SND_SOC [=y] && QCOM_APR [=y] && HAS_DMA [=n]
          Selected by [y]:
          - SND_SOC_MSM8996 [=y] && SOUND [=y] && !UML && SND [=y] && SND_SOC [=y] && QCOM_APR [=y]
          - SND_SOC_SDM845 [=y] && SOUND [=y] && !UML && SND [=y] && SND_SOC [=y] && QCOM_APR [=y] && CROS_EC [=y] && I2C [=y] && SOUNDWIRE [=y]
    
    Until recently, this warning was harmless (from a compile-testing
    point-of-view), but the new user of q6afe_is_rx_port() turned this into
    a hard failure.
    
    As the QDSP6 driver itself builds fine if NO_DMA=y, and it depends on
    QCOM_APR (which in turns depends on ARCH_QCOM || COMPILE_TEST), it is
    safe to increase compile testing coverage.  Hence fix the link failure
    by dropping the HAS_DMA dependency of SND_SOC_QDSP6.
    
    Fixes: a2120089251f1fe2 ("ASoC: qcom: common: set correct directions for dailinks")
    Fixes: 6b1687bf76ef84cb ("ASoC: qcom: add sdm845 sound card support")
    Fixes: a6f933f63f2ffdb2 ("ASoC: qcom: apq8096: Add db820c machine driver")
    Signed-off-by: Geert Uytterhoeven <geert@linux-m68k.org>
    Link: https://lore.kernel.org/r/20200629122443.21736-1-geert@linux-m68k.org
    Signed-off-by: Mark Brown <broonie@kernel.org>
    Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>

commit 69c122751164c3c343eea205fd5c3e1d5132f967
Author: Fangrui Song <maskray@google.com>
Date:   Tue Jul 21 10:31:23 2020 -0700

    Makefile: Fix GCC_TOOLCHAIN_DIR prefix for Clang cross compilation
    
    commit ca9b31f6bb9c6aa9b4e5f0792f39a97bbffb8c51 upstream.
    
    When CROSS_COMPILE is set (e.g. aarch64-linux-gnu-), if
    $(CROSS_COMPILE)elfedit is found at /usr/bin/aarch64-linux-gnu-elfedit,
    GCC_TOOLCHAIN_DIR will be set to /usr/bin/.  --prefix= will be set to
    /usr/bin/ and Clang as of 11 will search for both
    $(prefix)aarch64-linux-gnu-$needle and $(prefix)$needle.
    
    GCC searchs for $(prefix)aarch64-linux-gnu/$version/$needle,
    $(prefix)aarch64-linux-gnu/$needle and $(prefix)$needle. In practice,
    $(prefix)aarch64-linux-gnu/$needle rarely contains executables.
    
    To better model how GCC's -B/--prefix takes in effect in practice, newer
    Clang (since
    https://github.com/llvm/llvm-project/commit/3452a0d8c17f7166f479706b293caf6ac76ffd90)
    only searches for $(prefix)$needle. Currently it will find /usr/bin/as
    instead of /usr/bin/aarch64-linux-gnu-as.
    
    Set --prefix= to $(GCC_TOOLCHAIN_DIR)$(notdir $(CROSS_COMPILE))
    (/usr/bin/aarch64-linux-gnu-) so that newer Clang can find the
    appropriate cross compiling GNU as (when -no-integrated-as is in
    effect).
    
    Cc: stable@vger.kernel.org
    Reported-by: Nathan Chancellor <natechancellor@gmail.com>
    Signed-off-by: Fangrui Song <maskray@google.com>
    Reviewed-by: Nathan Chancellor <natechancellor@gmail.com>
    Tested-by: Nathan Chancellor <natechancellor@gmail.com>
    Tested-by: Nick Desaulniers <ndesaulniers@google.com>
    Link: https://github.com/ClangBuiltLinux/linux/issues/1099
    Reviewed-by: Nick Desaulniers <ndesaulniers@google.com>
    Signed-off-by: Masahiro Yamada <masahiroy@kernel.org>
    Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>

commit 8fede296d5243931d84f9842243e2316fbb8ab90
Author: Matthew Howell <matthew.howell@sealevel.com>
Date:   Wed Jul 22 16:11:24 2020 -0400

    serial: exar: Fix GPIO configuration for Sealevel cards based on XR17V35X
    
    [ Upstream commit 5fdbe136ae19ab751daaa4d08d9a42f3e30d17f9 ]
    
    Sealevel XR17V35X based devices are inoperable on kernel versions
    4.11 and above due to a change in the GPIO preconfiguration introduced in
    commit
    7dea8165f1d. This patch fixes this by preconfiguring the GPIO on Sealevel
    cards to the value (0x00) used prior to commit 7dea8165f1d
    
    With GPIOs preconfigured as per commit 7dea8165f1d all ports on
    Sealevel XR17V35X based devices become stuck in high impedance
    mode, regardless of dip-switch or software configuration. This
    causes the device to become effectively unusable. This patch (in
    various forms) has been distributed to our customers and no issues
    related to it have been reported.
    
    Fixes: 7dea8165f1d6 ("serial: exar: Preconfigure xr17v35x MPIOs as output")
    Signed-off-by: Matthew Howell <matthew.howell@sealevel.com>
    Link: https://lore.kernel.org/r/alpine.DEB.2.21.2007221605270.13247@tstest-VirtualBox
    Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit 71749b1181eca12af96654a781cabcd058c37c8f
Author: Fangrui Song <maskray@google.com>
Date:   Tue Jul 21 10:31:23 2020 -0700

    Makefile: Fix GCC_TOOLCHAIN_DIR prefix for Clang cross compilation
    
    commit ca9b31f6bb9c6aa9b4e5f0792f39a97bbffb8c51 upstream.
    
    When CROSS_COMPILE is set (e.g. aarch64-linux-gnu-), if
    $(CROSS_COMPILE)elfedit is found at /usr/bin/aarch64-linux-gnu-elfedit,
    GCC_TOOLCHAIN_DIR will be set to /usr/bin/.  --prefix= will be set to
    /usr/bin/ and Clang as of 11 will search for both
    $(prefix)aarch64-linux-gnu-$needle and $(prefix)$needle.
    
    GCC searchs for $(prefix)aarch64-linux-gnu/$version/$needle,
    $(prefix)aarch64-linux-gnu/$needle and $(prefix)$needle. In practice,
    $(prefix)aarch64-linux-gnu/$needle rarely contains executables.
    
    To better model how GCC's -B/--prefix takes in effect in practice, newer
    Clang (since
    https://github.com/llvm/llvm-project/commit/3452a0d8c17f7166f479706b293caf6ac76ffd90)
    only searches for $(prefix)$needle. Currently it will find /usr/bin/as
    instead of /usr/bin/aarch64-linux-gnu-as.
    
    Set --prefix= to $(GCC_TOOLCHAIN_DIR)$(notdir $(CROSS_COMPILE))
    (/usr/bin/aarch64-linux-gnu-) so that newer Clang can find the
    appropriate cross compiling GNU as (when -no-integrated-as is in
    effect).
    
    Cc: stable@vger.kernel.org
    Reported-by: Nathan Chancellor <natechancellor@gmail.com>
    Signed-off-by: Fangrui Song <maskray@google.com>
    Reviewed-by: Nathan Chancellor <natechancellor@gmail.com>
    Tested-by: Nathan Chancellor <natechancellor@gmail.com>
    Tested-by: Nick Desaulniers <ndesaulniers@google.com>
    Link: https://github.com/ClangBuiltLinux/linux/issues/1099
    Reviewed-by: Nick Desaulniers <ndesaulniers@google.com>
    Signed-off-by: Masahiro Yamada <masahiroy@kernel.org>
    Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>

commit 7b8d75ae4de2572db2c8b9fb2b14d1110ed6a140
Author: Matthew Howell <matthew.howell@sealevel.com>
Date:   Wed Jul 22 16:11:24 2020 -0400

    serial: exar: Fix GPIO configuration for Sealevel cards based on XR17V35X
    
    [ Upstream commit 5fdbe136ae19ab751daaa4d08d9a42f3e30d17f9 ]
    
    Sealevel XR17V35X based devices are inoperable on kernel versions
    4.11 and above due to a change in the GPIO preconfiguration introduced in
    commit
    7dea8165f1d. This patch fixes this by preconfiguring the GPIO on Sealevel
    cards to the value (0x00) used prior to commit 7dea8165f1d
    
    With GPIOs preconfigured as per commit 7dea8165f1d all ports on
    Sealevel XR17V35X based devices become stuck in high impedance
    mode, regardless of dip-switch or software configuration. This
    causes the device to become effectively unusable. This patch (in
    various forms) has been distributed to our customers and no issues
    related to it have been reported.
    
    Fixes: 7dea8165f1d6 ("serial: exar: Preconfigure xr17v35x MPIOs as output")
    Signed-off-by: Matthew Howell <matthew.howell@sealevel.com>
    Link: https://lore.kernel.org/r/alpine.DEB.2.21.2007221605270.13247@tstest-VirtualBox
    Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit 5fdbe136ae19ab751daaa4d08d9a42f3e30d17f9
Author: Matthew Howell <matthew.howell@sealevel.com>
Date:   Wed Jul 22 16:11:24 2020 -0400

    serial: exar: Fix GPIO configuration for Sealevel cards based on XR17V35X
    
    Sealevel XR17V35X based devices are inoperable on kernel versions
    4.11 and above due to a change in the GPIO preconfiguration introduced in
    commit
    7dea8165f1d. This patch fixes this by preconfiguring the GPIO on Sealevel
    cards to the value (0x00) used prior to commit 7dea8165f1d
    
    With GPIOs preconfigured as per commit 7dea8165f1d all ports on
    Sealevel XR17V35X based devices become stuck in high impedance
    mode, regardless of dip-switch or software configuration. This
    causes the device to become effectively unusable. This patch (in
    various forms) has been distributed to our customers and no issues
    related to it have been reported.
    
    Fixes: 7dea8165f1d6 ("serial: exar: Preconfigure xr17v35x MPIOs as output")
    Signed-off-by: Matthew Howell <matthew.howell@sealevel.com>
    Link: https://lore.kernel.org/r/alpine.DEB.2.21.2007221605270.13247@tstest-VirtualBox
    Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>

commit 83249952ffab43b82487c1c497f1b49324c602d4
Author: Randy Dunlap <rdunlap@infradead.org>
Date:   Mon Jul 20 11:32:21 2020 -0700

    ASoC: ti: fix SND_SOC_J721E_EVM warnings & errors
    
    SND_SOC_J721E_EVM should not select SND_SOC_PCM3168A_I2C when I2C
    is not enabled. That causes build errors, so make this driver's
    symbol depend on I2C.
    
    WARNING: unmet direct dependencies detected for SND_SOC_PCM3168A_I2C
      Depends on [n]: SOUND [=m] && !UML && SND [=m] && SND_SOC [=m] && I2C [=n]
      Selected by [m]:
      - SND_SOC_J721E_EVM [=m] && SOUND [=m] && !UML && SND [=m] && SND_SOC [=m] && (DMA_OMAP [=y] || TI_EDMA [=m] || TI_K3_UDMA [=n] || COMPILE_TEST [=y]) && (ARCH_K3_J721E_SOC [=n] || COMPILE_TEST [=y])
    
    ../sound/soc/codecs/pcm3168a-i2c.c:59:1: warning: data definition has no type or storage class
     module_i2c_driver(pcm3168a_i2c_driver);
     ^~~~~~~~~~~~~~~~~
    ../sound/soc/codecs/pcm3168a-i2c.c:59:1: error: type defaults to int in declaration of module_i2c_driver [-Werror=implicit-int]
    ../sound/soc/codecs/pcm3168a-i2c.c:59:1: warning: parameter names (without types) in function declaration
    ../sound/soc/codecs/pcm3168a-i2c.c:49:26: warning: pcm3168a_i2c_driver defined but not used [-Wunused-variable]
     static struct i2c_driver pcm3168a_i2c_driver = {
                              ^~~~~~~~~~~~~~~~~~~
    cc1: some warnings being treated as errors
    
    Fixes: 6748d0559059 ("ASoC: ti: Add custom machine driver for j721e EVM (CPB and IVI)")
    Signed-off-by: Randy Dunlap <rdunlap@infradead.org>
    Acked-by: Peter Ujfalusi <peter.ujfalusi@ti.com>
    Cc: Peter Ujfalusi <peter.ujfalusi@ti.com>
    Cc: Mark Brown <broonie@kernel.org>
    Link: https://lore.kernel.org/r/e74c690c-c7f8-fd42-e461-4f33571df4ef@infradead.org
    Signed-off-by: Mark Brown <broonie@kernel.org>

commit 7b7891c7bdfd61fc9ed6747a0a05efe2394dddc6
Author: Nathan Chancellor <natechancellor@gmail.com>
Date:   Wed Jul 22 21:15:10 2020 -0700

    arm64: vdso32: Fix '--prefix=' value for newer versions of clang
    
    Newer versions of clang only look for $(COMPAT_GCC_TOOLCHAIN_DIR)as [1],
    rather than $(COMPAT_GCC_TOOLCHAIN_DIR)$(CROSS_COMPILE_COMPAT)as,
    resulting in the following build error:
    
    $ make -skj"$(nproc)" ARCH=arm64 CROSS_COMPILE=aarch64-linux-gnu- \
    CROSS_COMPILE_COMPAT=arm-linux-gnueabi- LLVM=1 O=out/aarch64 distclean \
    defconfig arch/arm64/kernel/vdso32/
    ...
    /home/nathan/cbl/toolchains/llvm-binutils/bin/as: unrecognized option '-EL'
    clang-12: error: assembler command failed with exit code 1 (use -v to see invocation)
    make[3]: *** [arch/arm64/kernel/vdso32/Makefile:181: arch/arm64/kernel/vdso32/note.o] Error 1
    ...
    
    Adding the value of CROSS_COMPILE_COMPAT (adding notdir to account for a
    full path for CROSS_COMPILE_COMPAT) fixes this issue, which matches the
    solution done for the main Makefile [2].
    
    [1]: https://github.com/llvm/llvm-project/commit/3452a0d8c17f7166f479706b293caf6ac76ffd90
    [2]: https://lore.kernel.org/lkml/20200721173125.1273884-1-maskray@google.com/
    
    Signed-off-by: Nathan Chancellor <natechancellor@gmail.com>
    Cc: stable@vger.kernel.org
    Link: https://github.com/ClangBuiltLinux/linux/issues/1099
    Link: https://lore.kernel.org/r/20200723041509.400450-1-natechancellor@gmail.com
    Signed-off-by: Will Deacon <will@kernel.org>

commit ca9b31f6bb9c6aa9b4e5f0792f39a97bbffb8c51
Author: Fangrui Song <maskray@google.com>
Date:   Tue Jul 21 10:31:23 2020 -0700

    Makefile: Fix GCC_TOOLCHAIN_DIR prefix for Clang cross compilation
    
    When CROSS_COMPILE is set (e.g. aarch64-linux-gnu-), if
    $(CROSS_COMPILE)elfedit is found at /usr/bin/aarch64-linux-gnu-elfedit,
    GCC_TOOLCHAIN_DIR will be set to /usr/bin/.  --prefix= will be set to
    /usr/bin/ and Clang as of 11 will search for both
    $(prefix)aarch64-linux-gnu-$needle and $(prefix)$needle.
    
    GCC searchs for $(prefix)aarch64-linux-gnu/$version/$needle,
    $(prefix)aarch64-linux-gnu/$needle and $(prefix)$needle. In practice,
    $(prefix)aarch64-linux-gnu/$needle rarely contains executables.
    
    To better model how GCC's -B/--prefix takes in effect in practice, newer
    Clang (since
    https://github.com/llvm/llvm-project/commit/3452a0d8c17f7166f479706b293caf6ac76ffd90)
    only searches for $(prefix)$needle. Currently it will find /usr/bin/as
    instead of /usr/bin/aarch64-linux-gnu-as.
    
    Set --prefix= to $(GCC_TOOLCHAIN_DIR)$(notdir $(CROSS_COMPILE))
    (/usr/bin/aarch64-linux-gnu-) so that newer Clang can find the
    appropriate cross compiling GNU as (when -no-integrated-as is in
    effect).
    
    Cc: stable@vger.kernel.org
    Reported-by: Nathan Chancellor <natechancellor@gmail.com>
    Signed-off-by: Fangrui Song <maskray@google.com>
    Reviewed-by: Nathan Chancellor <natechancellor@gmail.com>
    Tested-by: Nathan Chancellor <natechancellor@gmail.com>
    Tested-by: Nick Desaulniers <ndesaulniers@google.com>
    Link: https://github.com/ClangBuiltLinux/linux/issues/1099
    Reviewed-by: Nick Desaulniers <ndesaulniers@google.com>
    Signed-off-by: Masahiro Yamada <masahiroy@kernel.org>

commit cf40b872a37110742c0dc6be8589ef19ad3d405e
Author: Colin Ian King <colin.king@canonical.com>
Date:   Tue Apr 28 11:20:13 2020 +0100

    scsi: qla2xxx: make 1-bit bit-fields unsigned int
    
    [ Upstream commit 78b874b7cbf09fbfadfa5f18a347ebef7bbb49fe ]
    
    The bitfields mpi_fw_dump_reading and mpi_fw_dumped are currently signed
    which is not recommended as the representation is an implementation defined
    behaviour.  Fix this by making the bit-fields unsigned ints.
    
    Link: https://lore.kernel.org/r/20200428102013.1040598-1-colin.king@canonical.com
    Fixes: cbb01c2f2f63 ("scsi: qla2xxx: Fix MPI failure AEN (8200) handling")
    Reviewed-by: Bart Van Assche <bvanassche@acm.org>
    Reviewed-by: Himanshu Madhani <himanshu.madhani@oracle.com>
    Signed-off-by: Colin Ian King <colin.king@canonical.com>
    Signed-off-by: Martin K. Petersen <martin.petersen@oracle.com>
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit f6b35db072dcf25365972503ade853960da5c984
Merge: 419317021ccc 62a30a292a82
Author: Greg Kroah-Hartman <gregkh@linuxfoundation.org>
Date:   Fri Jul 17 12:04:05 2020 +0200

    Merge tag 'iio-for-5.9a-take2' of git://git.kernel.org/pub/scm/linux/kernel/git/jic23/iio into staging-next
    
    Jonathan writes:
    
    First set of new device support, cleanups and features for IIO in the 5.9 cycle
    
    Some new devices, but particularly good this time is the core rework coming
    from Alexandru. Some of this has been in Analog's tree a long time, but other
    parts are motivated by closing down common mistakes in new drivers.
    
    Changes since first try at this pull request:
    * Add missed patch to actually remove iio_priv_to_dev and as a result
      also drop a few ingenic patches that need to be updated to take this
      into account.
    * Fix an ordering issue int he pollfunc attach in the core rework.
    
    New device support
    * qcom pmic7 adc
      - New driver using common qcom-vadc library. Some associated cleanups and
        refactors.
    * invensense icm42600
      - New driver supporting icm42600, icm42602, icm42605 and icm42622 via i2c
        or spi.  These are all 6 axis IMUs with gyro and accelerometers.
        Driver supports buffered modes using the hardware fifo and interpolation
        for accurate timestamps.
    * sensirion scd30
      - New driver for this carbon dioxide sensor including i2c and serial
        interfaces + bindings.
    
    Features
    * ak8975
      - Add reset gpio support.
    * bma400
      - Support SPI.
    * bmc150
      - Document and add support for bmc156b and bmm150b, tidy up _magn endings.
    * bmi160
      - Regulator and mount matrix support.
    * mxc4005
      - Add ID for mxc6655
    * rockchip-saradc
      - Triggered buffer support.
    
    DT bindings
    * qcom spmi-vadc converted to yaml + pmic7 bindings
    * ak8975 tidy up and convert to yaml + add reset-gpio binding
    * ingenic-adc -convert to yaml.
    
    Core rework all carried through by Alexandru Ardelean.
    * Assign parent device in the core rather than every driver. A few devices
      need to provide specific non standard parents, so there is support for
      overriding.
    * Start to take parts of struct iio_dev opaque to the drivers.
      This will be a long term job, but should reduce the number of drivers
      we get that use parts that are currently only 'internal' by documentation.
    * Move attach and detach of pollfunc to the core.  Every triggered buffer
      using driver had to do the same thing, so lets do it in the core.  The
      hard part here was getting all the drivers into canonical form so there
      would be no functional changes in this final patch.  That's taken quite
      a lot of work over last couple of cycles!
    
    Cleanups and minor fixes.
    * docs
      - Improve IIO_CONCENTRATION channel type description in ABI docs.
      - Drop doubled word cases.
      - Http to Https conversion.
    * core
      - Make iio_device_get_drvdata take a const struct iio_dev * avoiding some
        nasty casts.
    * ADCs
      - Drop lots of users of of_match_ptr macro, includes of mod_devicetable.h
        and CONFIG_OF protections.  These prevent use of ACPI PRP0001 with these
        drivers and get coppied into lots of new drivers.
    * ad5380
      - Constify iio_chan_spec_ext_info
    * ad5592r
      - Constify iio_chan_spec_ext_info
      - Avoid use of iio_priv_to_dev (precursor to taking parts of iio_dev opaque)
    * ad8366
      - Make gpio optional as doesn't matter if its there or not.
    * adis16480
      - Use irq types instead of the flags.
    * atlas-ezo-sensor
      - Minimize scope of ret variable.
    * at91-adc
      - Add COMPILE_TEST dependency to driver to improve build coverage.
      - Avoid use of iio_priv_to_dev (precursor to taking parts of iio_dev opaque)
    * at91-sama5d2
      - Avoid use of iio_priv_to_dev (precursor to taking parts of iio_dev opaque)
      - Drop Ludovic as a co-maintaienr.
    * cros_ec
      - Reapply the range after resume.
      - Add a read only frequency entry for legacy version.
      - Typo fixes
    * hts221
      - Avoid use of iio_priv_to_dev (precursor to taking parts of iio_dev opaque)
    * inv_mpu
      - Drop double check on ACPI companion device.
    * iqs621
      - Avoid use of iio_priv_to_dev (precursor to taking parts of iio_dev opaque)
    * iqs624
      - Avoid use of iio_priv_to_dev (precursor to taking parts of iio_dev opaque)
    * max11100
      - Constify iio_chan_spec
    * mmc35240
      - Constify reg_default
    * rockchip-saradc
      - Move to managed allocators for everything in probe.
      - Use more distinctive prefix for channel macros.
    * stk3310
      - Constify regmap_config.
    * stm32-adc
      - Avoid use of iio_priv_to_dev (precursor to taking parts of iio_dev opaque)
    * stm32-dfsdm-adc
      - Avoid use of iio_priv_to_dev (precursor to taking parts of iio_dev opaque)
    * ti-am335x
      - Use managed allocations where straight forward in probe function.
    * tsl2563
      - Avoid use of iio_priv_to_dev (precursor to taking parts of iio_dev opaque)
    
    * tag 'iio-for-5.9a-take2' of git://git.kernel.org/pub/scm/linux/kernel/git/jic23/iio: (107 commits)
      iio: buffer: fix attach/detach pollfunc order
      iio: core: remove iio_priv_to_dev() helper
      Replace HTTP links with HTTPS ones: drivers/iio
      Replace HTTP links with HTTPS ones: Documentation/devicetree/bindings/iio
      dt-bindings: iio/adc: Convert ingenic-adc docs to YAML.
      iio: cros_ec_accel_legacy: Add Read Only frequency entries
      MAINTAINERS: adc: at91-sama5d2_adc: remove myself as co-maintainer
      iio: adc: ti_am335x_adc: alloc kfifo & IRQ via devm_ functions
      iio: adc: ti_am335x_adc: alloc channels via devm_kcalloc()
      iio:adc:ingenic: drop of_match_ptr protection and include mod_devicetable.h
      iio:adc:ti-tlc4541: Drop CONFIG_OF and of_match_ptr protections.
      iio:adc:ti-adc161s626: Drop of_match_ptr protection.
      iio:adc:ti-adc084s021: drop of_match_ptr protection
      iio:adc:ti-adc0832: drop CONFIG_OF and of_match_ptr protections
      iio:adc:ti-adc081c: Drop of_match_ptr and change to mod_devicetable.h
      iio:adc:sd_adc_modulator: Drop of_match_ptr and tweak includes
      iio:adc:mcp3422: remove CONFIG_OF and of_match_ptr protections
      iio:adc:mcp320x: Drop CONFIG_OF and of_match_ptr protections
      iio:adc:max1118: Drop CONFIG_OF / of_match_ptr protections
      iio:adc:max11100: Drop of_match_ptr protection / add mod_devicetable.h include
      ...

commit b780c3f38812bce7d7baebe2108738a043d6c4c3
Author: Tudor Ambarus <tudor.ambarus@microchip.com>
Date:   Thu Jul 16 07:31:39 2020 +0300

    spi: atmel-quadspi: Use optimezed memcpy_fromio()/memcpy_toio()
    
    Optimezed mem*io operations are defined for LE platforms, use them.
    
    The ARM and !ARCH_EBSA110 dependencies for COMPILE_TEST were added
    only for the _memcpy_fromio()/_memcpy_toio() functions. Drop these
    dependencies.
    
    Tested unaligned accesses on both sama5d2 and sam9x60 QSPI controllers
    using SPI NOR flashes, everything works ok. The following performance
    improvement can be seen when running mtd_speedtest:
    
    sama5d2_xplained (mx25l25635e)
    - before:
            mtd_speedtest: eraseblock write speed is 983 KiB/s
            mtd_speedtest: eraseblock read speed is 6150 KiB/s
    - after:
            mtd_speedtest: eraseblock write speed is 1055 KiB/s
            mtd_speedtest: eraseblock read speed is 20144 KiB/s
    
    sam9x60ek (sst26vf064b)
    - before:
            mtd_speedtest: eraseblock write speed is 4770 KiB/s
            mtd_speedtest: eraseblock read speed is 8062 KiB/s
    - after:
            mtd_speedtest: eraseblock write speed is 4524 KiB/s
            mtd_speedtest: eraseblock read speed is 21186 KiB/s
    
    Signed-off-by: Tudor Ambarus <tudor.ambarus@microchip.com>
    Link: https://lore.kernel.org/r/20200716043139.565734-1-tudor.ambarus@microchip.com
    Signed-off-by: Mark Brown <broonie@kernel.org>

commit 84ab66821948c06c0da75a25b1305263bc633a7d
Author: Arun Easi <aeasi@marvell.com>
Date:   Tue Mar 31 03:40:13 2020 -0700

    scsi: qla2xxx: Fix MPI failure AEN (8200) handling
    
    [ Upstream commit cbb01c2f2f630f1497f703c51ff21538ae2d86b8 ]
    
    Today, upon an MPI failure AEN, on top of collecting an MPI dump, a regular
    firmware dump is also taken and then chip reset. This is disruptive to IOs
    and not required. Make the firmware dump collection, followed by chip
    reset, optional (not done by default).
    
    Firmware dump buffer and MPI dump buffer are independent of each
    other with this change and each can have dump that was taken at two
    different times for two different issues. The MPI dump is saved in a
    separate buffer and is retrieved differently from firmware dump.
    
    To collect full dump on MPI failure AEN, a module parameter is
    introduced:
        ql2xfulldump_on_mpifail (default: 0)
    
    Link: https://lore.kernel.org/r/20200331104015.24868-2-njavali@marvell.com
    Reported-by: kbuild test robot <lkp@intel.com>
    Reviewed-by: Himanshu Madhani <himanshu.madhani@oracle.com>
    Signed-off-by: Arun Easi <aeasi@marvell.com>
    Signed-off-by: Nilesh Javali <njavali@marvell.com>
    Signed-off-by: Martin K. Petersen <martin.petersen@oracle.com>
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit 010f0dff9f07fe4e4633807253b02126cf8981fa
Author: Tiezhu Yang <yangtiezhu@loongson.cn>
Date:   Tue Jul 7 17:22:26 2020 +0800

    phy: allwinner: Make PHY_SUN6I_MIPI_DPHY depend on COMMON_CLK
    
    When CONFIG_ARCH_SUNXI is not set but CONFIG_COMPILE_TEST=y,
    CONFIG_HAVE_CLK=y, CONFIG_HAVE_LEGACY_CLK=y, there exists
    the following build errors with CONFIG_PHY_SUN6I_MIPI_DPHY=y:
    
    drivers/phy/allwinner/phy-sun6i-mipi-dphy.o: In function `sun6i_dphy_init':
    phy-sun6i-mipi-dphy.c:(.text+0x320): undefined reference to `clk_set_rate_exclusive'
    drivers/phy/allwinner/phy-sun6i-mipi-dphy.o: In function `sun6i_dphy_exit':
    phy-sun6i-mipi-dphy.c:(.text+0x2c8): undefined reference to `clk_rate_exclusive_put'
    
    clk_set_rate_exclusive() and clk_rate_exclusive_put() are defined
    in drivers/clk/clk.c, this file is built under CONFIG_COMMON_CLK,
    so in order to build drivers/phy/allwinner/phy-sun6i-mipi-dphy.c
    successful used with various configs, CONFIG_PHY_SUN6I_MIPI_DPHY
    should depend on CONFIG_COMMON_CLK.
    
    Fixes: 133552bf03ed ("phy: Remove CONFIG_ARCH_* check for related subdir in Makefile")
    Reported-by: kernel test robot <lkp@intel.com>
    Signed-off-by: Tiezhu Yang <yangtiezhu@loongson.cn>
    Link: https://lore.kernel.org/r/1594113746-25393-1-git-send-email-yangtiezhu@loongson.cn
    Signed-off-by: Vinod Koul <vkoul@kernel.org>

commit 943c8a80830b88b7b203fa3e2d755620d85129d1
Author: Randy Dunlap <rdunlap@infradead.org>
Date:   Mon Jun 29 09:43:52 2020 -0700

    <linux/of.h>: add stub for of_get_next_parent() to fix qcom build error
    
    Fix a (COMPILE_TEST) build error when CONFIG_OF is not set/enabled
    by adding a stub for of_get_next_parent().
    
    ../drivers/soc/qcom/qcom-geni-se.c:819:11: error: implicit declaration of function 'of_get_next_parent'; did you mean 'of_get_parent'? [-Werror=implicit-function-declaration]
    ../drivers/soc/qcom/qcom-geni-se.c:819:9: warning: assignment makes pointer from integer without a cast [-Wint-conversion]
    
    Fixes: 048eb908a1f2 ("soc: qcom-geni-se: Add interconnect support to fix earlycon crash")
    Acked-by: Rob Herring <robh@kernel.org>
    Reviewed-by: Bjorn Andersson <bjorn.andersson@linaro.org>
    Signed-off-by: Randy Dunlap <rdunlap@infradead.org>
    Cc: Rob Herring <robh+dt@kernel.org>
    Cc: Frank Rowand <frowand.list@gmail.com>
    Cc: devicetree@vger.kernel.org
    Cc: Andy Gross <agross@kernel.org>
    Cc: Bjorn Andersson <bjorn.andersson@linaro.org>
    Cc: linux-arm-msm@vger.kernel.org
    Link: https://lore.kernel.org/r/ce0d7561-ff93-d267-b57a-6505014c728c@infradead.org
    Signed-off-by: Bjorn Andersson <bjorn.andersson@linaro.org>

commit 97215a7df4351fdd9141418568be872fb1032d6e
Author: Robin Murphy <robin.murphy@arm.com>
Date:   Fri Jul 3 17:03:20 2020 +0100

    iommu/renesas: Expand COMPILE_TEST coverage
    
    This driver shouldn't need anything architecture-specific (that isn't
    under CONFIG_ARM protection already), and has already been accessible
    from certain x86 configurations by virtue of the previously-cleaned-up
    "ARM || IOMMU_DMA" dependency. Allow COMPILE_TEST for all architectures.
    
    Signed-off-by: Robin Murphy <robin.murphy@arm.com>
    Link: https://lore.kernel.org/r/1fe2006aa98f008a2e689adba6e8c96e9197f903.1593791968.git.robin.murphy@arm.com
    Signed-off-by: Joerg Roedel <jroedel@suse.de>

commit b4ceb4a5359ed1c9ba4a20acf3a70d4bbead3248
Author: Robin Murphy <robin.murphy@arm.com>
Date:   Fri Jul 3 17:03:19 2020 +0100

    iommu: Tidy up Kconfig for SoC IOMMUs
    
    Wacky COMPILE_TEST dependencies based on who used to define
    dev_archdata.iommu can go.
    
    Dependencies on ARM or ARM64 already implied by the ARCH_* platform
    selection can go.
    
    The entire IOMMU_SUPPORT menu already depends on MMU, so those can go.
    
    IOMMU_DMA is for the architecture's DMA API implementation to choose,
    and its interface to IOMMU drivers is properly stubbed out if disabled,
    so dependencies on or selections of that can go (AMD_IOMMU is the
    current exception since the x86 drivers have to provide their own entire
    dma_map_ops implementation).
    
    Since commit ed6ccf10f24b ("dma-mapping: properly stub out the DMA API
    for !CONFIG_HAS_DMA"), drivers which simply use the dma-mapping API
    should not need to depend on HAS_DMA, so those can go.
    
    And a long-dead option for code removed from the MSM driver 4 years ago
    can also go.
    
    Signed-off-by: Robin Murphy <robin.murphy@arm.com>
    Link: https://lore.kernel.org/r/7fb9c74dc6bd12a4619ca44c92408e91352f1be0.1593791968.git.robin.murphy@arm.com
    Signed-off-by: Joerg Roedel <jroedel@suse.de>

commit 880bc529bae2257d05a767f7f5c24fd61a47b605
Author: Miquel Raynal <miquel.raynal@bootlin.com>
Date:   Fri Jun 26 08:55:11 2020 +0200

    mtd: rawnand: xway: Fix build issue
    
    This MIPS driver does not support COMPILE_TEST yet and failed to build
    under my radar.
    
    Replace 'mtd' chich is not defined in the scope of xway_nand_remove()
    by nand_to_mtd(chip). The mistake has been added in the long series
    dropping nand_release().
    
    Tested with a 7.3.0 MIPS GCC toolchain built with Buildroot.
    
    Fixes: 9fdd78f7bcda ("mtd: rawnand: xway: Stop using nand_release()")
    Reported-by: kernel test robot <lkp@intel.com>
    Signed-off-by: Miquel Raynal <miquel.raynal@bootlin.com>
    Link: https://lore.kernel.org/linux-mtd/20200626065511.16424-1-miquel.raynal@bootlin.com

commit 318b8a09f295cbf86fd504bcff3769b1fc4a936b
Author: Christoph Fritz <chf.fritz@googlemail.com>
Date:   Tue Jul 7 12:57:31 2020 +0200

    regulator: fan53880: Add support for COMPILE_TEST
    
    This patch adds support for COMPILE_TEST while fixing a warning when
    no support for device tree is there.
    
    Reported-by: kernel test robot <lkp@intel.com>
    Signed-off-by: Christoph Fritz <chf.fritz@googlemail.com>
    Link: https://lore.kernel.org/r/1c437154873ace65ff738a0ebca511308f1cecc1.camel@googlemail.com
    Signed-off-by: Mark Brown <broonie@kernel.org>

commit 68a3cbc4466058eb61752a494606e2d192dae7cc
Author: Nathan Chancellor <natechancellor@gmail.com>
Date:   Tue Jun 2 12:25:24 2020 -0700

    s390/vdso: Use $(LD) instead of $(CC) to link vDSO
    
    [ Upstream commit 2b2a25845d534ac6d55086e35c033961fdd83a26 ]
    
    Currently, the VDSO is being linked through $(CC). This does not match
    how the rest of the kernel links objects, which is through the $(LD)
    variable.
    
    When clang is built in a default configuration, it first attempts to use
    the target triple's default linker, which is just ld. However, the user
    can override this through the CLANG_DEFAULT_LINKER cmake define so that
    clang uses another linker by default, such as LLVM's own linker, ld.lld.
    This can be useful to get more optimized links across various different
    projects.
    
    However, this is problematic for the s390 vDSO because ld.lld does not
    have any s390 emulatiom support:
    
    https://github.com/llvm/llvm-project/blob/llvmorg-10.0.1-rc1/lld/ELF/Driver.cpp#L132-L150
    
    Thus, if a user is using a toolchain with ld.lld as the default, they
    will see an error, even if they have specified ld.bfd through the LD
    make variable:
    
    $ make -j"$(nproc)" -s ARCH=s390 CROSS_COMPILE=s390x-linux-gnu- LLVM=1 \
                           LD=s390x-linux-gnu-ld \
                           defconfig arch/s390/kernel/vdso64/
    ld.lld: error: unknown emulation: elf64_s390
    clang-11: error: linker command failed with exit code 1 (use -v to see invocation)
    
    Normally, '-fuse-ld=bfd' could be used to get around this; however, this
    can be fragile, depending on paths and variable naming. The cleaner
    solution for the kernel is to take advantage of the fact that $(LD) can
    be invoked directly, which bypasses the heuristics of $(CC) and respects
    the user's choice. Similar changes have been done for ARM, ARM64, and
    MIPS.
    
    Link: https://lkml.kernel.org/r/20200602192523.32758-1-natechancellor@gmail.com
    Link: https://github.com/ClangBuiltLinux/linux/issues/1041
    Signed-off-by: Nathan Chancellor <natechancellor@gmail.com>
    Reviewed-by: Nick Desaulniers <ndesaulniers@google.com>
    [heiko.carstens@de.ibm.com: add --build-id flag]
    Signed-off-by: Heiko Carstens <heiko.carstens@de.ibm.com>
    Signed-off-by: Vasily Gorbik <gor@linux.ibm.com>
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit b671ec06830b79bd75a63d8051489a0c76269846
Author: Nathan Chancellor <natechancellor@gmail.com>
Date:   Tue Jun 2 12:25:24 2020 -0700

    s390/vdso: Use $(LD) instead of $(CC) to link vDSO
    
    [ Upstream commit 2b2a25845d534ac6d55086e35c033961fdd83a26 ]
    
    Currently, the VDSO is being linked through $(CC). This does not match
    how the rest of the kernel links objects, which is through the $(LD)
    variable.
    
    When clang is built in a default configuration, it first attempts to use
    the target triple's default linker, which is just ld. However, the user
    can override this through the CLANG_DEFAULT_LINKER cmake define so that
    clang uses another linker by default, such as LLVM's own linker, ld.lld.
    This can be useful to get more optimized links across various different
    projects.
    
    However, this is problematic for the s390 vDSO because ld.lld does not
    have any s390 emulatiom support:
    
    https://github.com/llvm/llvm-project/blob/llvmorg-10.0.1-rc1/lld/ELF/Driver.cpp#L132-L150
    
    Thus, if a user is using a toolchain with ld.lld as the default, they
    will see an error, even if they have specified ld.bfd through the LD
    make variable:
    
    $ make -j"$(nproc)" -s ARCH=s390 CROSS_COMPILE=s390x-linux-gnu- LLVM=1 \
                           LD=s390x-linux-gnu-ld \
                           defconfig arch/s390/kernel/vdso64/
    ld.lld: error: unknown emulation: elf64_s390
    clang-11: error: linker command failed with exit code 1 (use -v to see invocation)
    
    Normally, '-fuse-ld=bfd' could be used to get around this; however, this
    can be fragile, depending on paths and variable naming. The cleaner
    solution for the kernel is to take advantage of the fact that $(LD) can
    be invoked directly, which bypasses the heuristics of $(CC) and respects
    the user's choice. Similar changes have been done for ARM, ARM64, and
    MIPS.
    
    Link: https://lkml.kernel.org/r/20200602192523.32758-1-natechancellor@gmail.com
    Link: https://github.com/ClangBuiltLinux/linux/issues/1041
    Signed-off-by: Nathan Chancellor <natechancellor@gmail.com>
    Reviewed-by: Nick Desaulniers <ndesaulniers@google.com>
    [heiko.carstens@de.ibm.com: add --build-id flag]
    Signed-off-by: Heiko Carstens <heiko.carstens@de.ibm.com>
    Signed-off-by: Vasily Gorbik <gor@linux.ibm.com>
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit b6aa06de7757667bac88997a8807b143b8436035
Author: Geert Uytterhoeven <geert@linux-m68k.org>
Date:   Mon Jun 29 14:24:43 2020 +0200

    ASoC: qcom: Drop HAS_DMA dependency to fix link failure
    
    When building on allyesconfig kernel for a NO_DMA=y platform (e.g.
    Sun-3), CONFIG_SND_SOC_QCOM_COMMON=y, but CONFIG_SND_SOC_QDSP6_AFE=n,
    leading to a link failure:
    
        sound/soc/qcom/common.o: In function `qcom_snd_parse_of':
        common.c:(.text+0x2e2): undefined reference to `q6afe_is_rx_port'
    
    While SND_SOC_QDSP6 depends on HAS_DMA, SND_SOC_MSM8996 and SND_SOC_SDM845
    don't, so the following warning is seen:
    
        WARNING: unmet direct dependencies detected for SND_SOC_QDSP6
          Depends on [n]: SOUND [=y] && !UML && SND [=y] && SND_SOC [=y] && QCOM_APR [=y] && HAS_DMA [=n]
          Selected by [y]:
          - SND_SOC_MSM8996 [=y] && SOUND [=y] && !UML && SND [=y] && SND_SOC [=y] && QCOM_APR [=y]
          - SND_SOC_SDM845 [=y] && SOUND [=y] && !UML && SND [=y] && SND_SOC [=y] && QCOM_APR [=y] && CROS_EC [=y] && I2C [=y] && SOUNDWIRE [=y]
    
    Until recently, this warning was harmless (from a compile-testing
    point-of-view), but the new user of q6afe_is_rx_port() turned this into
    a hard failure.
    
    As the QDSP6 driver itself builds fine if NO_DMA=y, and it depends on
    QCOM_APR (which in turns depends on ARCH_QCOM || COMPILE_TEST), it is
    safe to increase compile testing coverage.  Hence fix the link failure
    by dropping the HAS_DMA dependency of SND_SOC_QDSP6.
    
    Fixes: a2120089251f1fe2 ("ASoC: qcom: common: set correct directions for dailinks")
    Fixes: 6b1687bf76ef84cb ("ASoC: qcom: add sdm845 sound card support")
    Fixes: a6f933f63f2ffdb2 ("ASoC: qcom: apq8096: Add db820c machine driver")
    Signed-off-by: Geert Uytterhoeven <geert@linux-m68k.org>
    Link: https://lore.kernel.org/r/20200629122443.21736-1-geert@linux-m68k.org
    Signed-off-by: Mark Brown <broonie@kernel.org>

commit c79484f68b164a4b59c85b7a5008455ddd7af6fb
Author: YueHaibing <yuehaibing@huawei.com>
Date:   Wed Apr 29 15:13:37 2020 +0800

    drm/mediatek: Fix Kconfig warning
    
    WARNING: unmet direct dependencies detected for MTK_MMSYS
      Depends on [n]: (ARCH_MEDIATEK [=y] || COMPILE_TEST [=n]) && COMMON_CLK_MT8173_MMSYS [=n]
      Selected by [y]:
      - DRM_MEDIATEK [=y] && HAS_IOMEM [=y] && DRM [=y] && (ARCH_MEDIATEK [=y] || ARM && COMPILE_TEST [=n]) && COMMON_CLK [=y] && HAVE_ARM_SMCCC [=y] && OF [=y]
    
    Make DRM_MEDIATEK depend on MTK_MMSYS to fix this.
    
    Fixes: 2c758e301ed9 ("soc / drm: mediatek: Move routing control to mmsys device")
    Signed-off-by: YueHaibing <yuehaibing@huawei.com>
    Reviewed-by: Enric Balletbo i Serra <enric.balletbo@collabora.com>
    Signed-off-by: Chun-Kuang Hu <chunkuang.hu@kernel.org>

commit 133552bf03edbe3892767a4b64c56e3bed746374
Author: Tiezhu Yang <yangtiezhu@loongson.cn>
Date:   Mon May 25 21:08:58 2020 +0800

    phy: Remove CONFIG_ARCH_* check for related subdir in Makefile
    
    If CONFIG_ARCH_ROCKCHIP is not set but COMPILE_TEST is set, the file in
    the subdir rockchip can not be built due to CONFIG_ARCH_ROCKCHIP check
    in drivers/phy/Makefile.
    
    Since the related configs in drivers/phy/rockchip/Kconfig depend on
    ARCH_ROCKCHIP, so remove CONFIG_ARCH_ROCKCHIP check for subdir rockchip
    in drivers/phy/Makefile.
    
    The other CONFIG_ARCH_* about allwinner, amlogic, mediatek, renesas and
    tegra have the same situation, so remove them too.
    
    Signed-off-by: Tiezhu Yang <yangtiezhu@loongson.cn>
    Reviewed-by: Heiko Stuebner <heiko@sntech.de>
    Link: https://lore.kernel.org/r/1590412138-13903-2-git-send-email-yangtiezhu@loongson.cn
    Signed-off-by: Vinod Koul <vkoul@kernel.org>

commit d544d3a254026cf9a623bf0f5fe0ce79420025f3
Author: Hari Bathini <hbathini@linux.ibm.com>
Date:   Mon Apr 20 14:26:22 2020 +0530

    powerpc/fadump: consider reserved ranges while reserving memory
    
    commit 140777a3d8dfdb3d3f20ea7707c0f1c0ce1b0aa5 upstream.
    
    Commit 0962e8004e97 ("powerpc/prom: Scan reserved-ranges node for
    memory reservations") enabled support to parse reserved-ranges DT
    node and reserve kernel memory falling in these ranges for F/W
    purposes. Memory reserved for FADump should not overlap with these
    ranges as it could corrupt memory meant for F/W or crash'ed kernel
    memory to be exported as vmcore.
    
    But since commit 579ca1a27675 ("powerpc/fadump: make use of memblock's
    bottom up allocation mode"), memblock_find_in_range() is being used to
    find the appropriate area to reserve memory for FADump, which can't
    account for reserved-ranges as these ranges are reserved only after
    FADump memory reservation.
    
    With reserved-ranges now being populated during early boot, look out
    for these memory ranges while reserving memory for FADump. Without
    this change, MPIPL on PowerNV systems aborts with hostboot failure,
    when memory reserved for FADump is less than 4096MB.
    
    Fixes: 579ca1a27675 ("powerpc/fadump: make use of memblock's bottom up allocation mode")
    Cc: stable@vger.kernel.org
    Signed-off-by: Hari Bathini <hbathini@linux.ibm.com>
    Reviewed-by: Mahesh Salgaonkar <mahesh@linux.ibm.com>
    Signed-off-by: Michael Ellerman <mpe@ellerman.id.au>
    Link: https://lore.kernel.org/r/158737297693.26700.16193820746269425424.stgit@hbathini.in.ibm.com
    Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>

commit d72eb20a639b6f6e2b1add0adb1e29a5b6f11dbf
Author: Hari Bathini <hbathini@linux.ibm.com>
Date:   Mon Apr 20 14:26:09 2020 +0530

    powerpc/fadump: use static allocation for reserved memory ranges
    
    commit 02c04e374e176ae3a3f64a682f80702f8d2fb65d upstream.
    
    At times, memory ranges have to be looked up during early boot, when
    kernel couldn't be initialized for dynamic memory allocation. In fact,
    reserved-ranges look up is needed during FADump memory reservation.
    Without accounting for reserved-ranges in reserving memory for FADump,
    MPIPL boot fails with memory corruption issues. So, extend memory
    ranges handling to support static allocation and populate reserved
    memory ranges during early boot.
    
    Fixes: dda9dbfeeb7a ("powerpc/fadump: consider reserved ranges while releasing memory")
    Cc: stable@vger.kernel.org
    Signed-off-by: Hari Bathini <hbathini@linux.ibm.com>
    Reviewed-by: Mahesh Salgaonkar <mahesh@linux.ibm.com>
    Signed-off-by: Michael Ellerman <mpe@ellerman.id.au>
    Link: https://lore.kernel.org/r/158737294432.26700.4830263187856221314.stgit@hbathini.in.ibm.com
    Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>

commit e7da37ea1c2459595503103d7a7e2edee1f4fbd3
Author: Kees Cook <keescook@chromium.org>
Date:   Mon Jun 1 21:52:46 2020 -0700

    ubsan: entirely disable alignment checks under UBSAN_TRAP
    
    [ Upstream commit 9380ce246a052a1e00121cd480028b6907aeae38 ]
    
    Commit 8d58f222e85f ("ubsan: disable UBSAN_ALIGNMENT under
    COMPILE_TEST") tried to fix the pathological results of UBSAN_ALIGNMENT
    with UBSAN_TRAP (which objtool would rightly scream about), but it made
    an assumption about how COMPILE_TEST gets set (it is not set for
    randconfig).  As a result, we need a bigger hammer here: just don't
    allow the alignment checks with the trap mode.
    
    Fixes: 8d58f222e85f ("ubsan: disable UBSAN_ALIGNMENT under COMPILE_TEST")
    Reported-by: Randy Dunlap <rdunlap@infradead.org>
    Signed-off-by: Kees Cook <keescook@chromium.org>
    Signed-off-by: Andrew Morton <akpm@linux-foundation.org>
    Acked-by: Randy Dunlap <rdunlap@infradead.org>
    Cc: Josh Poimboeuf <jpoimboe@redhat.com>
    Cc: Dmitry Vyukov <dvyukov@google.com>
    Cc: Elena Petrova <lenaptr@google.com>
    Link: http://lkml.kernel.org/r/202005291236.000FCB6@keescook
    Link: https://lore.kernel.org/lkml/742521db-1e8c-0d7a-1ed4-a908894fb497@infradead.org/
    Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit 6fd930da24e1c6521dc5d3dab51010ca14837ccd
Author: Hari Bathini <hbathini@linux.ibm.com>
Date:   Mon Apr 20 14:26:22 2020 +0530

    powerpc/fadump: consider reserved ranges while reserving memory
    
    commit 140777a3d8dfdb3d3f20ea7707c0f1c0ce1b0aa5 upstream.
    
    Commit 0962e8004e97 ("powerpc/prom: Scan reserved-ranges node for
    memory reservations") enabled support to parse reserved-ranges DT
    node and reserve kernel memory falling in these ranges for F/W
    purposes. Memory reserved for FADump should not overlap with these
    ranges as it could corrupt memory meant for F/W or crash'ed kernel
    memory to be exported as vmcore.
    
    But since commit 579ca1a27675 ("powerpc/fadump: make use of memblock's
    bottom up allocation mode"), memblock_find_in_range() is being used to
    find the appropriate area to reserve memory for FADump, which can't
    account for reserved-ranges as these ranges are reserved only after
    FADump memory reservation.
    
    With reserved-ranges now being populated during early boot, look out
    for these memory ranges while reserving memory for FADump. Without
    this change, MPIPL on PowerNV systems aborts with hostboot failure,
    when memory reserved for FADump is less than 4096MB.
    
    Fixes: 579ca1a27675 ("powerpc/fadump: make use of memblock's bottom up allocation mode")
    Cc: stable@vger.kernel.org
    Signed-off-by: Hari Bathini <hbathini@linux.ibm.com>
    Reviewed-by: Mahesh Salgaonkar <mahesh@linux.ibm.com>
    Signed-off-by: Michael Ellerman <mpe@ellerman.id.au>
    Link: https://lore.kernel.org/r/158737297693.26700.16193820746269425424.stgit@hbathini.in.ibm.com
    Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>

commit 3e9211d98803bb0e0a5b4678087a4703bc449db3
Author: Hari Bathini <hbathini@linux.ibm.com>
Date:   Mon Apr 20 14:26:09 2020 +0530

    powerpc/fadump: use static allocation for reserved memory ranges
    
    commit 02c04e374e176ae3a3f64a682f80702f8d2fb65d upstream.
    
    At times, memory ranges have to be looked up during early boot, when
    kernel couldn't be initialized for dynamic memory allocation. In fact,
    reserved-ranges look up is needed during FADump memory reservation.
    Without accounting for reserved-ranges in reserving memory for FADump,
    MPIPL boot fails with memory corruption issues. So, extend memory
    ranges handling to support static allocation and populate reserved
    memory ranges during early boot.
    
    Fixes: dda9dbfeeb7a ("powerpc/fadump: consider reserved ranges while releasing memory")
    Cc: stable@vger.kernel.org
    Signed-off-by: Hari Bathini <hbathini@linux.ibm.com>
    Reviewed-by: Mahesh Salgaonkar <mahesh@linux.ibm.com>
    Signed-off-by: Michael Ellerman <mpe@ellerman.id.au>
    Link: https://lore.kernel.org/r/158737294432.26700.4830263187856221314.stgit@hbathini.in.ibm.com
    Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>

commit 2b2a25845d534ac6d55086e35c033961fdd83a26
Author: Nathan Chancellor <natechancellor@gmail.com>
Date:   Tue Jun 2 12:25:24 2020 -0700

    s390/vdso: Use $(LD) instead of $(CC) to link vDSO
    
    Currently, the VDSO is being linked through $(CC). This does not match
    how the rest of the kernel links objects, which is through the $(LD)
    variable.
    
    When clang is built in a default configuration, it first attempts to use
    the target triple's default linker, which is just ld. However, the user
    can override this through the CLANG_DEFAULT_LINKER cmake define so that
    clang uses another linker by default, such as LLVM's own linker, ld.lld.
    This can be useful to get more optimized links across various different
    projects.
    
    However, this is problematic for the s390 vDSO because ld.lld does not
    have any s390 emulatiom support:
    
    https://github.com/llvm/llvm-project/blob/llvmorg-10.0.1-rc1/lld/ELF/Driver.cpp#L132-L150
    
    Thus, if a user is using a toolchain with ld.lld as the default, they
    will see an error, even if they have specified ld.bfd through the LD
    make variable:
    
    $ make -j"$(nproc)" -s ARCH=s390 CROSS_COMPILE=s390x-linux-gnu- LLVM=1 \
                           LD=s390x-linux-gnu-ld \
                           defconfig arch/s390/kernel/vdso64/
    ld.lld: error: unknown emulation: elf64_s390
    clang-11: error: linker command failed with exit code 1 (use -v to see invocation)
    
    Normally, '-fuse-ld=bfd' could be used to get around this; however, this
    can be fragile, depending on paths and variable naming. The cleaner
    solution for the kernel is to take advantage of the fact that $(LD) can
    be invoked directly, which bypasses the heuristics of $(CC) and respects
    the user's choice. Similar changes have been done for ARM, ARM64, and
    MIPS.
    
    Link: https://lkml.kernel.org/r/20200602192523.32758-1-natechancellor@gmail.com
    Link: https://github.com/ClangBuiltLinux/linux/issues/1041
    Signed-off-by: Nathan Chancellor <natechancellor@gmail.com>
    Reviewed-by: Nick Desaulniers <ndesaulniers@google.com>
    [heiko.carstens@de.ibm.com: add --build-id flag]
    Signed-off-by: Heiko Carstens <heiko.carstens@de.ibm.com>
    Signed-off-by: Vasily Gorbik <gor@linux.ibm.com>

commit 0f53f2da43fab1c9ce5cf0a9fc6f989e7ab29fd3
Author: Emil Velikov <emil.l.velikov@gmail.com>
Date:   Sun May 17 20:36:53 2020 +0100

    drm/arm: Kconfig annotate drivers as COMPILE_TEST
    
    Add the COMPILE_TEST conditional, so that people can at least build test
    the drivers.
    
    Cc: Liviu Dudau <liviu.dudau@arm.com>
    Cc: Brian Starkey <brian.starkey@arm.com>
    Cc: Mali DP Maintainers <malidp@foss.arm.com>
    Cc: dri-devel@lists.freedesktop.org
    Signed-off-by: Emil Velikov <emil.l.velikov@gmail.com>
    Tested-by: Liviu Dudau <liviu.dudau@arm.com>
    Acked-by: Liviu Dudau <liviu.dudau@arm.com>
    Link: https://patchwork.freedesktop.org/patch/msgid/20200517193655.3895087-1-emil.l.velikov@gmail.com

commit 4027860dcc4cd0c45c36bae21e45bee5a17f2f0f
Author: Alexandru Ardelean <alexandru.ardelean@analog.com>
Date:   Mon May 25 13:27:44 2020 +0300

    iio: Kconfig: at91_adc: add COMPILE_TEST dependency to driver
    
    Since changes can come from all sort of places, it may make sense to have
    this symbol as a dependency to make sure that the 'make allmodconfig' &&
    'make allyesconfig' build rules cover this driver as well for a
    compile-build/test.
    
    It seemed useful [recently] when trying to apply a change for this.
    
    Signed-off-by: Alexandru Ardelean <alexandru.ardelean@analog.com>
    Acked-by: Ludovic Desroches <ludovic.desroches@microchip.com>
    Signed-off-by: Jonathan Cameron <Jonathan.Cameron@huawei.com>

commit fca5e94921d50d13ee8720ce58a352e7fc0228bf
Author: Masahiro Yamada <masahiroy@kernel.org>
Date:   Sun Jun 7 12:20:53 2020 +0900

    samples: binderfs: really compile this sample and fix build issues
    
    Even after commit c624adc9cb6e ("samples: fix binderfs sample"), this
    sample is never compiled.
    
    'hostprogs' teaches Kbuild that this is a host program, but not enough
    to order to compile it. You must add it to 'always-y' to really compile
    it.
    
    Since this sample has never been compiled in upstream, various issues
    are left unnoticed.
    
    [1] compilers without <linux/android/binderfs.h> are still widely used
    
    <linux/android/binderfs.h> is only available since commit c13295ad219d
    ("binderfs: rename header to binderfs.h"), i.e., Linux 5.0
    
    If your compiler is based on UAPI headers older than Linux 5.0, you
    will see the following error:
    
      samples/binderfs/binderfs_example.c:16:10: fatal error: linux/android/binderfs.h: No such file or directory
       #include <linux/android/binderfs.h>
                ^~~~~~~~~~~~~~~~~~~~~~~~~~
      compilation terminated.
    
    You cannot rely on compilers having such a new header.
    
    The common approach is to install UAPI headers of this kernel into
    usr/include, and then add it to the header search path.
    
    I added 'depends on HEADERS_INSTALL' in Kconfig, and '-I usr/include'
    compiler flag in Makefile.
    
    [2] compile the sample for target architecture
    
    Because headers_install works for the target architecture, only the
    native compiler was able to build sample code that requires
    '-I usr/include'.
    
    Commit 7f3a59db274c ("kbuild: add infrastructure to build userspace
    programs") added the new syntax 'userprogs' to compile user-space
    programs for the target architecture.
    
    Use it, and then 'ifndef CROSS_COMPILE' will go away.
    
    I added 'depends on CC_CAN_LINK' because $(CC) is not necessarily
    capable of linking user-space programs.
    
    [3] use subdir-y to descend into samples/binderfs
    
    Since this directory does not contain any kernel-space code, it has no
    point in generating built-in.a or modules.order.
    
    Replace obj-$(CONFIG_...) with subdir-$(CONFIG_...).
    
    [4] -Wunused-variable warning
    
    If I compile this, I see the following warning.
    
      samples/binderfs/binderfs_example.c: In function 'main':
      samples/binderfs/binderfs_example.c:21:9: warning: unused variable 'len' [-Wunused-variable]
         21 |  size_t len;
            |         ^~~
    
    I removed the unused 'len'.
    
    [5] CONFIG_ANDROID_BINDERFS is not required
    
    Since this is a user-space standalone program, it is independent of
    the kernel configuration.
    
    Remove 'depends on ANDROID_BINDERFS'.
    
    Fixes: 9762dc1432e1 ("samples: add binderfs sample program")
    Fixes: c624adc9cb6e ("samples: fix binderfs sample")
    Signed-off-by: Masahiro Yamada <masahiroy@kernel.org>
    Acked-by: Christian Brauner <christian.brauner@ubuntu.com>

commit de8f81077be2ef01c6ddad2c0fbb3e24b4696fca
Author: Fugang Duan <fugang.duan@nxp.com>
Date:   Mon May 25 16:18:14 2020 +0800

    net: stmmac: enable timestamp snapshot for required PTP packets in dwmac v5.10a
    
    [ Upstream commit f2fb6b6275eba9d312957ca44c487bd780da6169 ]
    
    For rx filter 'HWTSTAMP_FILTER_PTP_V2_EVENT', it should be
    PTP v2/802.AS1, any layer, any kind of event packet, but HW only
    take timestamp snapshot for below PTP message: sync, Pdelay_req,
    Pdelay_resp.
    
    Then it causes below issue when test E2E case:
    ptp4l[2479.534]: port 1: received DELAY_REQ without timestamp
    ptp4l[2481.423]: port 1: received DELAY_REQ without timestamp
    ptp4l[2481.758]: port 1: received DELAY_REQ without timestamp
    ptp4l[2483.524]: port 1: received DELAY_REQ without timestamp
    ptp4l[2484.233]: port 1: received DELAY_REQ without timestamp
    ptp4l[2485.750]: port 1: received DELAY_REQ without timestamp
    ptp4l[2486.888]: port 1: received DELAY_REQ without timestamp
    ptp4l[2487.265]: port 1: received DELAY_REQ without timestamp
    ptp4l[2487.316]: port 1: received DELAY_REQ without timestamp
    
    Timestamp snapshot dependency on register bits in received path:
    SNAPTYPSEL TSMSTRENA TSEVNTENA  PTP_Messages
    01         x         0          SYNC, Follow_Up, Delay_Req,
                                    Delay_Resp, Pdelay_Req, Pdelay_Resp,
                                    Pdelay_Resp_Follow_Up
    01         0         1          SYNC, Pdelay_Req, Pdelay_Resp
    
    For dwmac v5.10a, enabling all events by setting register
    DWC_EQOS_TIME_STAMPING[SNAPTYPSEL] to 2b01, clearing bit [TSEVNTENA]
    to 0b0, which can support all required events.
    
    Signed-off-by: Fugang Duan <fugang.duan@nxp.com>
    Signed-off-by: David S. Miller <davem@davemloft.net>
    Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>

commit a0722dbaaf06942ee80ce469e11472baf28154bc
Author: Fugang Duan <fugang.duan@nxp.com>
Date:   Mon May 25 16:18:14 2020 +0800

    net: stmmac: enable timestamp snapshot for required PTP packets in dwmac v5.10a
    
    [ Upstream commit f2fb6b6275eba9d312957ca44c487bd780da6169 ]
    
    For rx filter 'HWTSTAMP_FILTER_PTP_V2_EVENT', it should be
    PTP v2/802.AS1, any layer, any kind of event packet, but HW only
    take timestamp snapshot for below PTP message: sync, Pdelay_req,
    Pdelay_resp.
    
    Then it causes below issue when test E2E case:
    ptp4l[2479.534]: port 1: received DELAY_REQ without timestamp
    ptp4l[2481.423]: port 1: received DELAY_REQ without timestamp
    ptp4l[2481.758]: port 1: received DELAY_REQ without timestamp
    ptp4l[2483.524]: port 1: received DELAY_REQ without timestamp
    ptp4l[2484.233]: port 1: received DELAY_REQ without timestamp
    ptp4l[2485.750]: port 1: received DELAY_REQ without timestamp
    ptp4l[2486.888]: port 1: received DELAY_REQ without timestamp
    ptp4l[2487.265]: port 1: received DELAY_REQ without timestamp
    ptp4l[2487.316]: port 1: received DELAY_REQ without timestamp
    
    Timestamp snapshot dependency on register bits in received path:
    SNAPTYPSEL TSMSTRENA TSEVNTENA  PTP_Messages
    01         x         0          SYNC, Follow_Up, Delay_Req,
                                    Delay_Resp, Pdelay_Req, Pdelay_Resp,
                                    Pdelay_Resp_Follow_Up
    01         0         1          SYNC, Pdelay_Req, Pdelay_Resp
    
    For dwmac v5.10a, enabling all events by setting register
    DWC_EQOS_TIME_STAMPING[SNAPTYPSEL] to 2b01, clearing bit [TSEVNTENA]
    to 0b0, which can support all required events.
    
    Signed-off-by: Fugang Duan <fugang.duan@nxp.com>
    Signed-off-by: David S. Miller <davem@davemloft.net>
    Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>

commit 47f6bc4ce1ff70d7ba0924c2f1c218c96cd585fb
Author: Brett Mastbergen <brett.mastbergen@gmail.com>
Date:   Tue Jun 9 17:35:06 2020 -0400

    tools, bpf: Do not force gcc as CC
    
    This allows transparent cross-compilation with CROSS_COMPILE by
    relying on 7ed1c1901fe5 ("tools: fix cross-compile var clobbering").
    
    Same change was applied to tools/bpf/bpftool/Makefile in
    9e88b9312acb ("tools: bpftool: do not force gcc as CC").
    
    Signed-off-by: Brett Mastbergen <brett.mastbergen@gmail.com>
    Signed-off-by: Daniel Borkmann <daniel@iogearbox.net>
    Link: https://lore.kernel.org/bpf/20200609213506.3299-1-brett.mastbergen@gmail.com

commit cf0c97f148e9e50aa5a7ddd1984a604dd2bde4af
Merge: e8dff03aef6a 94873f6b46f8
Author: Linus Torvalds <torvalds@linux-foundation.org>
Date:   Sun Jun 7 16:13:43 2020 -0700

    Merge tag 'pinctrl-v5.8-1' of git://git.kernel.org/pub/scm/linux/kernel/git/linusw/linux-pinctrl
    
    Pull pin control updates from Linus Walleij:
     "This is the bulk of pin control changes for the v5.8 kernel cycle.
    
      It's just really boring this time. Zero core changes. Just linear
      development, cleanups and misc noncritical fixes. Some new drivers for
      very new Qualcomm and Intel chips.
    
      New drivers:
    
       - Intel Jasper Lake support.
    
       - NXP Freescale i.MX8DXL support.
    
       - Qualcomm SM8250 support.
    
       - Renesas R8A7742 SH-PFC support.
    
      Driver improvements:
    
       - Severe cleanup and modernization of the MCP23s08 driver.
    
       - Mediatek driver modularized.
    
       - Setting config supported in the Meson driver.
    
       - Wakeup support for the Broadcom BCM7211"
    
    * tag 'pinctrl-v5.8-1' of git://git.kernel.org/pub/scm/linux/kernel/git/linusw/linux-pinctrl: (72 commits)
      pinctrl: sprd: Fix the incorrect pull-up definition
      pinctrl: pxa: pxa2xx: Remove 'pxa2xx_pinctrl_exit()' which is unused and broken
      pinctrl: freescale: imx: Use 'devm_of_iomap()' to avoid a resource leak in case of error in 'imx_pinctrl_probe()'
      pinctrl: freescale: imx: Fix an error handling path in 'imx_pinctrl_probe()'
      pinctrl: sirf: add missing put_device() call in sirfsoc_gpio_probe()
      pinctrl: imxl: Fix an error handling path in 'imx1_pinctrl_core_probe()'
      pinctrl: bcm2835: Add support for wake-up interrupts
      pinctrl: bcm2835: Match BCM7211 compatible string
      dt-bindings: pinctrl: Document optional BCM7211 wake-up interrupts
      dt-bindings: pinctrl: Document 7211 compatible for brcm, bcm2835-gpio.txt
      dt-bindings: pinctrl: stm32: Add missing interrupts property
      pinctrl: at91-pio4: Add COMPILE_TEST support
      pinctrl: Fix return value about devm_platform_ioremap_resource()
      MAINTAINERS: Renesas Pin Controllers are supported
      dt-bindings: pinctrl: ocelot: Add Sparx5 SoC support
      pinctrl: ocelot: Fix GPIO interrupt decoding on Jaguar2
      pinctrl: ocelot: Remove instance number from pin functions
      pinctrl: ocelot: Always register GPIO driver
      dt-bindings: pinctrl: rockchip: update example
      pinctrl: amd: Add ACPI dependency
      ...

commit 3f7e82379fc91102d82ed89822bd4242c83e40d5
Merge: 1f2dc7f5b6c1 74910e15ab25
Author: Linus Torvalds <torvalds@linux-foundation.org>
Date:   Fri Jun 5 14:00:30 2020 -0700

    Merge tag 'gpio-v5.8-1' of git://git.kernel.org/pub/scm/linux/kernel/git/linusw/linux-gpio
    
    Pull GPIO updates from Linus Walleij:
     "This is the bulk of GPIO changes for the v5.8 kernel cycle.
    
      Core changes:
    
       - A new GPIO aggregator driver has been merged: this can join a few
         select GPIO lines into a new aggregated GPIO chip. This can be used
         for security: a process can be granted access to only these lines,
         for example for industrial control. Another way to use this is to
         reexpose certain select lines to a virtual machine or container.
    
       - Warn if the gpio-line-names is too long in he DT parser core.
    
       - GPIO lines can now be looked up by line name in addition to being
         looked up by offset.
    
      New drivers:
    
       - A new generic regmap GPIO driver has been merged. Too many regmap
         drivers are starting to look like each other so we need to create
         some common ground and try to move drivers over to using that.
    
       - The F7188X driver now supports F81865.
    
      Driver improvements:
    
       - Large improvements to the PCA953x expander, get multiple lines and
         several cleanups.
    
       - Large improvements to the DesignWare DWAPB driver, and Sergey Semin
         has volunteered to maintain it.
    
       - PL061 can now be built as a module, this is part of a bigger effort
         to make the ARM platforms more modular"
    
    * tag 'gpio-v5.8-1' of git://git.kernel.org/pub/scm/linux/kernel/git/linusw/linux-gpio: (77 commits)
      gpio: pca953x: Drop unneeded ACPI_PTR()
      MAINTAINERS: Add gpio regmap section
      gpio: add a reusable generic gpio_chip using regmap
      gpiolib: Introduce gpiochip_irqchip_add_domain()
      gpio: gpiolib: Allow GPIO IRQs to lazy disable
      gpiolib: Separate GPIO_GET_LINEINFO_WATCH_IOCTL conditional
      gpio: rcar: Fix runtime PM imbalance on error
      gpio: pca935x: Allow IRQ support for driver built as a module
      gpio: pxa: Add COMPILE_TEST support
      dt-bindings: gpio: Add renesas,em-gio bindings
      MAINTAINERS: Fix file name for DesignWare GPIO DT schema
      gpio: dwapb: Remove unneeded has_irq member in struct dwapb_port_property
      gpio: dwapb: Don't use IRQ 0 as valid Linux interrupt
      gpio: dwapb: avoid error message for optional IRQ
      gpio: dwapb: Call acpi_gpiochip_free_interrupts() on GPIO chip de-registration
      gpio: max730x: bring gpiochip_add_data after port config
      MAINTAINERS: Add GPIO Aggregator section
      docs: gpio: Add GPIO Aggregator documentation
      gpio: Add GPIO Aggregator
      gpiolib: Add support for GPIO lookup by line name
      ...

commit cb8e59cc87201af93dfbb6c3dccc8fcad72a09c2
Merge: 2e63f6ce7ed2 065fcfd49763
Author: Linus Torvalds <torvalds@linux-foundation.org>
Date:   Wed Jun 3 16:27:18 2020 -0700

    Merge git://git.kernel.org/pub/scm/linux/kernel/git/netdev/net-next
    
    Pull networking updates from David Miller:
    
     1) Allow setting bluetooth L2CAP modes via socket option, from Luiz
        Augusto von Dentz.
    
     2) Add GSO partial support to igc, from Sasha Neftin.
    
     3) Several cleanups and improvements to r8169 from Heiner Kallweit.
    
     4) Add IF_OPER_TESTING link state and use it when ethtool triggers a
        device self-test. From Andrew Lunn.
    
     5) Start moving away from custom driver versions, use the globally
        defined kernel version instead, from Leon Romanovsky.
    
     6) Support GRO vis gro_cells in DSA layer, from Alexander Lobakin.
    
     7) Allow hard IRQ deferral during NAPI, from Eric Dumazet.
    
     8) Add sriov and vf support to hinic, from Luo bin.
    
     9) Support Media Redundancy Protocol (MRP) in the bridging code, from
        Horatiu Vultur.
    
    10) Support netmap in the nft_nat code, from Pablo Neira Ayuso.
    
    11) Allow UDPv6 encapsulation of ESP in the ipsec code, from Sabrina
        Dubroca. Also add ipv6 support for espintcp.
    
    12) Lots of ReST conversions of the networking documentation, from Mauro
        Carvalho Chehab.
    
    13) Support configuration of ethtool rxnfc flows in bcmgenet driver,
        from Doug Berger.
    
    14) Allow to dump cgroup id and filter by it in inet_diag code, from
        Dmitry Yakunin.
    
    15) Add infrastructure to export netlink attribute policies to
        userspace, from Johannes Berg.
    
    16) Several optimizations to sch_fq scheduler, from Eric Dumazet.
    
    17) Fallback to the default qdisc if qdisc init fails because otherwise
        a packet scheduler init failure will make a device inoperative. From
        Jesper Dangaard Brouer.
    
    18) Several RISCV bpf jit optimizations, from Luke Nelson.
    
    19) Correct the return type of the ->ndo_start_xmit() method in several
        drivers, it's netdev_tx_t but many drivers were using
        'int'. From Yunjian Wang.
    
    20) Add an ethtool interface for PHY master/slave config, from Oleksij
        Rempel.
    
    21) Add BPF iterators, from Yonghang Song.
    
    22) Add cable test infrastructure, including ethool interfaces, from
        Andrew Lunn. Marvell PHY driver is the first to support this
        facility.
    
    23) Remove zero-length arrays all over, from Gustavo A. R. Silva.
    
    24) Calculate and maintain an explicit frame size in XDP, from Jesper
        Dangaard Brouer.
    
    25) Add CAP_BPF, from Alexei Starovoitov.
    
    26) Support terse dumps in the packet scheduler, from Vlad Buslov.
    
    27) Support XDP_TX bulking in dpaa2 driver, from Ioana Ciornei.
    
    28) Add devm_register_netdev(), from Bartosz Golaszewski.
    
    29) Minimize qdisc resets, from Cong Wang.
    
    30) Get rid of kernel_getsockopt and kernel_setsockopt in order to
        eliminate set_fs/get_fs calls. From Christoph Hellwig.
    
    * git://git.kernel.org/pub/scm/linux/kernel/git/netdev/net-next: (2517 commits)
      selftests: net: ip_defrag: ignore EPERM
      net_failover: fixed rollback in net_failover_open()
      Revert "tipc: Fix potential tipc_aead refcnt leak in tipc_crypto_rcv"
      Revert "tipc: Fix potential tipc_node refcnt leak in tipc_rcv"
      vmxnet3: allow rx flow hash ops only when rss is enabled
      hinic: add set_channels ethtool_ops support
      selftests/bpf: Add a default $(CXX) value
      tools/bpf: Don't use $(COMPILE.c)
      bpf, selftests: Use bpf_probe_read_kernel
      s390/bpf: Use bcr 0,%0 as tail call nop filler
      s390/bpf: Maintain 8-byte stack alignment
      selftests/bpf: Fix verifier test
      selftests/bpf: Fix sample_cnt shared between two threads
      bpf, selftests: Adapt cls_redirect to call csum_level helper
      bpf: Add csum_level helper for fixing up csum levels
      bpf: Fix up bpf_skb_adjust_room helper's skb csum setting
      sfc: add missing annotation for efx_ef10_try_update_nic_stats_vf()
      crypto/chtls: IPv6 support for inline TLS
      Crypto/chcr: Fixes a coccinile check error
      Crypto/chcr: Fixes compilations warnings
      ...

commit 3cf22679ba43c0feda17dd283e163315103df34c
Author: Kefeng Wang <wangkefeng.wang@huawei.com>
Date:   Mon May 11 10:19:52 2020 +0800

    riscv: Fix unmet direct dependencies built based on SOC_VIRT
    
    [ Upstream commit ab7fbad0c7d7a4f9b320a059a171a92a34b6d409 ]
    
    Fix unmet direct dependencies Warning and fix Kconfig indent.
    
    WARNING: unmet direct dependencies detected for POWER_RESET_SYSCON
      Depends on [n]: POWER_RESET [=n] && OF [=y] && HAS_IOMEM [=y]
      Selected by [y]:
      - SOC_VIRT [=y]
    
    WARNING: unmet direct dependencies detected for POWER_RESET_SYSCON_POWEROFF
      Depends on [n]: POWER_RESET [=n] && OF [=y] && HAS_IOMEM [=y]
      Selected by [y]:
      - SOC_VIRT [=y]
    
    WARNING: unmet direct dependencies detected for RTC_DRV_GOLDFISH
      Depends on [n]: RTC_CLASS [=n] && OF [=y] && HAS_IOMEM [=y] && (GOLDFISH [=y] || COMPILE_TEST [=n])
      Selected by [y]:
      - SOC_VIRT [=y]
    
    Reported-by: Hulk Robot <hulkci@huawei.com>
    Signed-off-by: Kefeng Wang <wangkefeng.wang@huawei.com>
    Signed-off-by: Palmer Dabbelt <palmerdabbelt@google.com>
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit d70a6be1e2ab98f13688e4a529b326e8e11230d0
Author: Ilya Leoshkevich <iii@linux.ibm.com>
Date:   Tue Jun 2 19:56:48 2020 +0200

    tools/bpf: Don't use $(COMPILE.c)
    
    When using make kselftest TARGETS=bpf, tools/bpf is built with
    MAKEFLAGS=rR, which causes $(COMPILE.c) to be undefined, which in turn
    causes the build to fail with
    
      CC       kselftest/bpf/tools/build/bpftool/map_perf_ring.o
    /bin/sh: 1: -MMD: not found
    
    Fix by using $(CC) $(CFLAGS) -c instead of $(COMPILE.c).
    
    Signed-off-by: Ilya Leoshkevich <iii@linux.ibm.com>
    Signed-off-by: Daniel Borkmann <daniel@iogearbox.net>
    Link: https://lore.kernel.org/bpf/20200602175649.2501580-2-iii@linux.ibm.com

commit 9380ce246a052a1e00121cd480028b6907aeae38
Author: Kees Cook <keescook@chromium.org>
Date:   Mon Jun 1 21:52:46 2020 -0700

    ubsan: entirely disable alignment checks under UBSAN_TRAP
    
    Commit 8d58f222e85f ("ubsan: disable UBSAN_ALIGNMENT under
    COMPILE_TEST") tried to fix the pathological results of UBSAN_ALIGNMENT
    with UBSAN_TRAP (which objtool would rightly scream about), but it made
    an assumption about how COMPILE_TEST gets set (it is not set for
    randconfig).  As a result, we need a bigger hammer here: just don't
    allow the alignment checks with the trap mode.
    
    Fixes: 8d58f222e85f ("ubsan: disable UBSAN_ALIGNMENT under COMPILE_TEST")
    Reported-by: Randy Dunlap <rdunlap@infradead.org>
    Signed-off-by: Kees Cook <keescook@chromium.org>
    Signed-off-by: Andrew Morton <akpm@linux-foundation.org>
    Acked-by: Randy Dunlap <rdunlap@infradead.org>
    Cc: Josh Poimboeuf <jpoimboe@redhat.com>
    Cc: Dmitry Vyukov <dvyukov@google.com>
    Cc: Elena Petrova <lenaptr@google.com>
    Link: http://lkml.kernel.org/r/202005291236.000FCB6@keescook
    Link: https://lore.kernel.org/lkml/742521db-1e8c-0d7a-1ed4-a908894fb497@infradead.org/
    Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>

commit d77aeb5d403d379ff458e04fc07b5b86700270f2
Author: Ingo Molnar <mingo@kernel.org>
Date:   Mon Jun 1 09:45:27 2020 +0200

    irqchip: Fix "Loongson HyperTransport Vector support" driver build on all non-MIPS platforms
    
    This commit:
    
      818e915fbac5: ("irqchip: Add Loongson HyperTransport Vector support")
    
    Added a MIPS-only driver, but turned on compilation on all other architectures as well:
    
     config LOONGSON_HTVEC
            bool "Loongson3 HyperTransport Interrupt Vector Controller"
            depends on MACH_LOONGSON64 || COMPILE_TEST
    
    But this driver was never build tested on any other architecture than MIPS:
    
      drivers/irqchip/irq-loongson-htvec.c: In function htvec_irq_dispatch:
      drivers/irqchip/irq-loongson-htvec.c:59:3: error: implicit declaration of function spurious_interrupt; did you mean smp_reboot_interrupt? [-Werror=implicit-function-declaration]
    
    Because spurious_interrupt() only exists on MIPS.
    
    So make it MIPS-only.
    
    Signed-off-by: Ingo Molnar <mingo@kernel.org>
    Cc: Jiaxun Yang <jiaxun.yang@flygoat.com>
    Cc: Marc Zyngier <maz@kernel.org>
    Cc: Thomas Gleixner <tglx@linutronix.de>
    Signed-off-by: Ingo Molnar <mingo@kernel.org>

commit 5f55f1fb187ddb7d58bc01a68b93a5e109730378
Author: Rob Herring <robh@kernel.org>
Date:   Wed May 27 12:13:07 2020 -0600

    clk: versatile: Fix kconfig dependency on COMMON_CLK_VERSATILE
    
    If COMPILE_TEST is enabled, then COMMON_CLK_VERSATILE can be disabled
    when dependent options like ICST are selected resulting in kconfig
    warnings:
    
    WARNING: unmet direct dependencies detected for ICST
      Depends on [n]: COMMON_CLK [=y] && COMMON_CLK_VERSATILE [=n]
      Selected by [y]:
      - ARCH_REALVIEW [=y] && (ARCH_MULTI_V5 [=n] || ARCH_MULTI_V6 [=n] || ARCH_MULTI_V7 [=y])
      - ARCH_VEXPRESS [=y] && ARCH_MULTI_V7 [=y]
      - ARCH_ZYNQ [=y] && ARCH_MULTI_V7 [=y]
    
    WARNING: unmet direct dependencies detected for CLK_SP810
      Depends on [n]: COMMON_CLK [=y] && COMMON_CLK_VERSATILE [=n]
      Selected by [y]:
      - ARCH_REALVIEW [=y] && (ARCH_MULTI_V5 [=n] || ARCH_MULTI_V6 [=n] || ARCH_MULTI_V7 [=y])
    
    Fix this by dropping COMMON_CLK_VERSATILE and just using 'menu' instead
    of 'menuconfig'.
    
    [arnd: add ZYNQ to the dependency list]
    
    Link: https://lore.kernel.org/r/20200527181307.2482167-1-robh@kernel.org
    Fixes: 81134fb541d4 ("clk: versatile: Rework kconfig structure")
    Cc: Linus Walleij <linus.walleij@linaro.org>
    Cc: Michael Turquette <mturquette@baylibre.com>
    Cc: Stephen Boyd <sboyd@kernel.org>
    Cc: linux-arm-kernel@lists.infradead.org
    Cc: linux-clk@vger.kernel.org
    Signed-off-by: Rob Herring <robh@kernel.org>
    Acked-by: Stephen Boyd <sboyd@kernel.org>
    Signed-off-by: Arnd Bergmann <arnd@arndb.de>

commit 60b4000f54649546b4780ac61b67e5601382225d
Author: Arnd Bergmann <arnd@arndb.de>
Date:   Wed May 27 15:39:16 2020 +0200

    tee: fix crypto select
    
    When selecting a crypto cipher, we also need to select the
    subsystem itself:
    
    WARNING: unmet direct dependencies detected for CRYPTO_SHA1
      Depends on [m]: CRYPTO [=m]
      Selected by [y]:
      - TEE [=y] && (HAVE_ARM_SMCCC [=n] || COMPILE_TEST [=y] || CPU_SUP_AMD [=y])
      Selected by [m]:
      - CRYPTO_DEV_QAT [=m] && CRYPTO [=m] && CRYPTO_HW [=y]
      - CRYPTO_DEV_MEDIATEK [=m] && CRYPTO [=m] && CRYPTO_HW [=y] && (ARM && ARCH_MEDIATEK || COMPILE_TEST [=y])
      - CRYPTO_DEV_SAFEXCEL [=m] && CRYPTO [=m] && CRYPTO_HW [=y] && (OF [=y] || PCI [=y] || COMPILE_TEST [=y]) && HAS_IOMEM [=y]
      - CRYPTO_DEV_CCREE [=m] && CRYPTO [=m] && CRYPTO_HW [=y] && OF [=y] && HAS_DMA [=y]
      - CRYPTO_DEV_SP_CCP [=y] && CRYPTO [=m] && CRYPTO_HW [=y] && CRYPTO_DEV_CCP [=y] && CRYPTO_DEV_CCP_DD [=m] && DMADEVICES [=y]
    
    Link: https://lore.kernel.org/r/20200527133924.724819-1-arnd@arndb.de
    Fixes: e33bcbab16d1 ("tee: add support for session's client UUID generation")
    Signed-off-by: Arnd Bergmann <arnd@arndb.de>
    Reviewed-by: Vesa Jskelinen <vesa.jaaskelainen@vaisala.com>
    Signed-off-by: Arnd Bergmann <arnd@arndb.de>

commit b0975a7501f6450a5f50b0bb808e3d471d80d1e6
Author: Shuah Khan <skhan@linuxfoundation.org>
Date:   Mon Apr 27 18:11:07 2020 -0600

    selftests: fix kvm relocatable native/cross builds and installs
    
    [ Upstream commit 66d69e081b526b6a6031f0d3ca8ddff71e5707a5 ]
    
    kvm test Makefile doesn't fully support cross-builds and installs.
    UNAME_M = $(shell uname -m) variable is used to define the target
    programs and libraries to be built from arch specific sources in
    sub-directories.
    
    For cross-builds to work, UNAME_M has to map to ARCH and arch specific
    directories and targets in this Makefile.
    
    UNAME_M variable to used to run the compiles pointing to the right arch
    directories and build the right targets for these supported architectures.
    
    TEST_GEN_PROGS and LIBKVM are set using UNAME_M variable.
    LINUX_TOOL_ARCH_INCLUDE is set using ARCH variable.
    
    x86_64 targets are named to include x86_64 as a suffix and directories
    for includes are in x86_64 sub-directory. s390x and aarch64 follow the
    same convention. "uname -m" doesn't result in the correct mapping for
    s390x and aarch64. Fix it to set UNAME_M correctly for s390x and aarch64
    cross-builds.
    
    In addition, Makefile doesn't create arch sub-directories in the case of
    relocatable builds and test programs under s390x and x86_64 directories
    fail to build. This is a problem for native and cross-builds. Fix it to
    create all necessary directories keying off of TEST_GEN_PROGS.
    
    The following use-cases work with this change:
    
    Native x86_64:
    make O=/tmp/kselftest -C tools/testing/selftests TARGETS=kvm install \
     INSTALL_PATH=$HOME/x86_64
    
    arm64 cross-build:
    make O=$HOME/arm64_build/ ARCH=arm64 HOSTCC=gcc \
            CROSS_COMPILE=aarch64-linux-gnu- defconfig
    
    make O=$HOME/arm64_build/ ARCH=arm64 HOSTCC=gcc \
            CROSS_COMPILE=aarch64-linux-gnu- all
    
    make kselftest-install TARGETS=kvm O=$HOME/arm64_build ARCH=arm64 \
            HOSTCC=gcc CROSS_COMPILE=aarch64-linux-gnu-
    
    s390x cross-build:
    make O=$HOME/s390x_build/ ARCH=s390 HOSTCC=gcc \
            CROSS_COMPILE=s390x-linux-gnu- defconfig
    
    make O=$HOME/s390x_build/ ARCH=s390 HOSTCC=gcc \
            CROSS_COMPILE=s390x-linux-gnu- all
    
    make kselftest-install TARGETS=kvm O=$HOME/s390x_build/ ARCH=s390 \
            HOSTCC=gcc CROSS_COMPILE=s390x-linux-gnu- all
    
    No regressions in the following use-cases:
    make -C tools/testing/selftests TARGETS=kvm
    make kselftest-all TARGETS=kvm
    
    Signed-off-by: Shuah Khan <skhan@linuxfoundation.org>
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit ed3119e45519880a246b085ba6a96aa1074da532
Author: Krzysztof Kozlowski <krzk@kernel.org>
Date:   Mon May 18 14:08:55 2020 +0200

    x86: Hide the archdata.iommu field behind generic IOMMU_API
    
    There is a generic, kernel wide configuration symbol for enabling the
    IOMMU specific bits: CONFIG_IOMMU_API.  Implementations (including
    INTEL_IOMMU and AMD_IOMMU driver) select it so use it here as well.
    
    This makes the conditional archdata.iommu field consistent with other
    platforms and also fixes any compile test builds of other IOMMU drivers,
    when INTEL_IOMMU or AMD_IOMMU are not selected).
    
    For the case when INTEL_IOMMU/AMD_IOMMU and COMPILE_TEST are not
    selected, this should create functionally equivalent code/choice.  With
    COMPILE_TEST this field could appear if other IOMMU drivers are chosen
    but neither INTEL_IOMMU nor AMD_IOMMU are not.
    
    Reported-by: kbuild test robot <lkp@intel.com>
    Fixes: e93a1695d7fb ("iommu: Enable compile testing for some of drivers")
    Signed-off-by: Krzysztof Kozlowski <krzk@kernel.org>
    Acked-by: Borislav Petkov <bp@suse.de>
    Link: https://lore.kernel.org/r/20200518120855.27822-2-krzk@kernel.org
    Signed-off-by: Joerg Roedel <jroedel@suse.de>

commit e18a8c104d777af46aa5c8573c8a19ba2b5de597
Author: Krzysztof Kozlowski <krzk@kernel.org>
Date:   Mon May 18 14:08:54 2020 +0200

    ia64: Hide the archdata.iommu field behind generic IOMMU_API
    
    There is a generic, kernel wide configuration symbol for enabling the
    IOMMU specific bits: CONFIG_IOMMU_API.  Implementations (including
    INTEL_IOMMU driver) select it so use it here as well.
    
    This makes the conditional archdata.iommu field consistent with other
    platforms and also fixes any compile test builds of other IOMMU drivers,
    when INTEL_IOMMU is not selected).
    
    For the case when INTEL_IOMMU and COMPILE_TEST are not selected, this
    should create functionally equivalent code/choice.  With COMPILE_TEST
    this field could appear if other IOMMU drivers are chosen but
    INTEL_IOMMU not.
    
    Reported-by: kbuild test robot <lkp@intel.com>
    Fixes: e93a1695d7fb ("iommu: Enable compile testing for some of drivers")
    Signed-off-by: Krzysztof Kozlowski <krzk@kernel.org>
    
    Link: https://lore.kernel.org/r/20200518120855.27822-1-krzk@kernel.org
    Signed-off-by: Joerg Roedel <jroedel@suse.de>

commit f2fb6b6275eba9d312957ca44c487bd780da6169
Author: Fugang Duan <fugang.duan@nxp.com>
Date:   Mon May 25 16:18:14 2020 +0800

    net: stmmac: enable timestamp snapshot for required PTP packets in dwmac v5.10a
    
    For rx filter 'HWTSTAMP_FILTER_PTP_V2_EVENT', it should be
    PTP v2/802.AS1, any layer, any kind of event packet, but HW only
    take timestamp snapshot for below PTP message: sync, Pdelay_req,
    Pdelay_resp.
    
    Then it causes below issue when test E2E case:
    ptp4l[2479.534]: port 1: received DELAY_REQ without timestamp
    ptp4l[2481.423]: port 1: received DELAY_REQ without timestamp
    ptp4l[2481.758]: port 1: received DELAY_REQ without timestamp
    ptp4l[2483.524]: port 1: received DELAY_REQ without timestamp
    ptp4l[2484.233]: port 1: received DELAY_REQ without timestamp
    ptp4l[2485.750]: port 1: received DELAY_REQ without timestamp
    ptp4l[2486.888]: port 1: received DELAY_REQ without timestamp
    ptp4l[2487.265]: port 1: received DELAY_REQ without timestamp
    ptp4l[2487.316]: port 1: received DELAY_REQ without timestamp
    
    Timestamp snapshot dependency on register bits in received path:
    SNAPTYPSEL TSMSTRENA TSEVNTENA  PTP_Messages
    01         x         0          SYNC, Follow_Up, Delay_Req,
                                    Delay_Resp, Pdelay_Req, Pdelay_Resp,
                                    Pdelay_Resp_Follow_Up
    01         0         1          SYNC, Pdelay_Req, Pdelay_Resp
    
    For dwmac v5.10a, enabling all events by setting register
    DWC_EQOS_TIME_STAMPING[SNAPTYPSEL] to 2b01, clearing bit [TSEVNTENA]
    to 0b0, which can support all required events.
    
    Signed-off-by: Fugang Duan <fugang.duan@nxp.com>
    Signed-off-by: David S. Miller <davem@davemloft.net>

commit 9ffc30a66da1653e4ce0cb58f6289a31584b6f9b
Merge: 19207ea8e099 ba8f6682bcb3
Author: Arnd Bergmann <arnd@arndb.de>
Date:   Mon May 25 23:28:35 2020 +0200

    Merge tag 'tegra-for-5.8-media' of git://git.kernel.org/pub/scm/linux/kernel/git/tegra/linux into arm/drivers
    
    media: tegra: Changes for v5.8-rc1
    
    This contains a V4L2 video capture driver for Tegra210.
    
    * tag 'tegra-for-5.8-media' of git://git.kernel.org/pub/scm/linux/kernel/git/tegra/linux:
      media: tegra-video: Do not enable COMPILE_TEST
      MAINTAINERS: correct path in TEGRA VIDEO DRIVER
      media: tegra-video: Make tegra210_video_formats static
      MAINTAINERS: Add Tegra Video driver section
      media: tegra-video: Add Tegra210 Video input driver
      dt-bindings: i2c: tegra: Document Tegra210 VI I2C
      dt-bindings: tegra: Add VI and CSI bindings
      dt-bindings: cpufreq: Add binding for NVIDIA Tegra20/30
      dt-bindings: memory: tegra: Add external memory controller binding for Tegra210
      dt-bindings: clock: tegra: Remove PMC clock IDs
      dt-bindings: clock: tegra: Add clock ID for CSI TPG clock
    
    Link: https://lore.kernel.org/r/20200515145311.1580134-7-thierry.reding@gmail.com
    Signed-off-by: Arnd Bergmann <arnd@arndb.de>

commit cff1f8b4f8e119a9dbd9872d7a04fedef8d0c1a2
Author: shengjiu wang <shengjiu.wang@nxp.com>
Date:   Mon May 25 17:03:32 2020 +0800

    ASoC: fsl_asrc: Fix -Wmissing-prototypes warning
    
    COMPILER_INSTALL_PATH=$HOME/0day COMPILER=clang make.cross ARCH=x86_64
    
    sound/soc/fsl/fsl_asrc.c:557:18: warning: no previous prototype for function 'fsl_asrc_get_dma_channel' [-Wmissing-prototypes]
    struct dma_chan *fsl_asrc_get_dma_channel(struct fsl_asrc_pair *pair, bool dir)
                     ^
    sound/soc/fsl/fsl_asrc.c:557:1: note: declare 'static' if the function is not intended to be used outside of this translation unit
    struct dma_chan *fsl_asrc_get_dma_channel(struct fsl_asrc_pair *pair, bool dir)
    ^
    static
    
    Fixes: be7bd03f0201 ("ASoC: fsl_asrc: Move common definition to fsl_asrc_common")
    Reported-by: kbuild test robot <lkp@intel.com>
    Signed-off-by: shengjiu wang <shengjiu.wang@nxp.com>
    Link: https://lore.kernel.org/r/1590397412-12966-1-git-send-email-shengjiu.wang@nxp.com
    Signed-off-by: Mark Brown <broonie@kernel.org>

commit e682fcc769709e563ab2ebea5a2af62bcbd7f8cc
Author: Tiezhu Yang <yangtiezhu@loongson.cn>
Date:   Sat May 23 19:45:26 2020 +0800

    pinctrl: at91-pio4: Add COMPILE_TEST support
    
    Add COMPILE_TEST support to the AT91 PIO4 pinctrl driver for better compile
    testing coverage.
    
    Signed-off-by: Tiezhu Yang <yangtiezhu@loongson.cn>
    Link: https://lore.kernel.org/r/1590234326-2194-2-git-send-email-yangtiezhu@loongson.cn
    Signed-off-by: Linus Walleij <linus.walleij@linaro.org>

commit 22e4ebd05890cf2d9423ed7a35f18b0937c0cb3b
Author: Tiezhu Yang <yangtiezhu@loongson.cn>
Date:   Fri May 22 12:12:20 2020 +0800

    gpio: pxa: Add COMPILE_TEST support
    
    Add COMPILE_TEST support to the PXA GPIO driver for better compile
    testing coverage.
    
    Signed-off-by: Tiezhu Yang <yangtiezhu@loongson.cn>
    Signed-off-by: Bartosz Golaszewski <bgolaszewski@baylibre.com>

commit 94e05d0837e4dae9a2ef5a2d8fba7c307ee017a3
Author: Kelly Littlepage <kelly@onechronos.com>
Date:   Fri May 8 19:58:46 2020 +0000

    net: tcp: fix rx timestamp behavior for tcp_recvmsg
    
    [ Upstream commit cc4de047b33be247f9c8150d3e496743a49642b8 ]
    
    The stated intent of the original commit is to is to "return the timestamp
    corresponding to the highest sequence number data returned." The current
    implementation returns the timestamp for the last byte of the last fully
    read skb, which is not necessarily the last byte in the recv buffer. This
    patch converts behavior to the original definition, and to the behavior of
    the previous draft versions of commit 98aaa913b4ed ("tcp: Extend
    SOF_TIMESTAMPING_RX_SOFTWARE to TCP recvmsg") which also match this
    behavior.
    
    Fixes: 98aaa913b4ed ("tcp: Extend SOF_TIMESTAMPING_RX_SOFTWARE to TCP recvmsg")
    Co-developed-by: Iris Liu <iris@onechronos.com>
    Signed-off-by: Iris Liu <iris@onechronos.com>
    Signed-off-by: Kelly Littlepage <kelly@onechronos.com>
    Signed-off-by: Eric Dumazet <edumazet@google.com>
    Acked-by: Soheil Hassas Yeganeh <soheil@google.com>
    Acked-by: Willem de Bruijn <willemb@google.com>
    Signed-off-by: Jakub Kicinski <kuba@kernel.org>
    Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>

commit 2fbd6eca3711ac64944c128654aa9cb0f0ede444
Author: Kelly Littlepage <kelly@onechronos.com>
Date:   Fri May 8 19:58:46 2020 +0000

    net: tcp: fix rx timestamp behavior for tcp_recvmsg
    
    [ Upstream commit cc4de047b33be247f9c8150d3e496743a49642b8 ]
    
    The stated intent of the original commit is to is to "return the timestamp
    corresponding to the highest sequence number data returned." The current
    implementation returns the timestamp for the last byte of the last fully
    read skb, which is not necessarily the last byte in the recv buffer. This
    patch converts behavior to the original definition, and to the behavior of
    the previous draft versions of commit 98aaa913b4ed ("tcp: Extend
    SOF_TIMESTAMPING_RX_SOFTWARE to TCP recvmsg") which also match this
    behavior.
    
    Fixes: 98aaa913b4ed ("tcp: Extend SOF_TIMESTAMPING_RX_SOFTWARE to TCP recvmsg")
    Co-developed-by: Iris Liu <iris@onechronos.com>
    Signed-off-by: Iris Liu <iris@onechronos.com>
    Signed-off-by: Kelly Littlepage <kelly@onechronos.com>
    Signed-off-by: Eric Dumazet <edumazet@google.com>
    Acked-by: Soheil Hassas Yeganeh <soheil@google.com>
    Acked-by: Willem de Bruijn <willemb@google.com>
    Signed-off-by: Jakub Kicinski <kuba@kernel.org>
    Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>

commit 31080a892c54dd7852b24c584b9a5f904708fb6f
Author: Kelly Littlepage <kelly@onechronos.com>
Date:   Fri May 8 19:58:46 2020 +0000

    net: tcp: fix rx timestamp behavior for tcp_recvmsg
    
    [ Upstream commit cc4de047b33be247f9c8150d3e496743a49642b8 ]
    
    The stated intent of the original commit is to is to "return the timestamp
    corresponding to the highest sequence number data returned." The current
    implementation returns the timestamp for the last byte of the last fully
    read skb, which is not necessarily the last byte in the recv buffer. This
    patch converts behavior to the original definition, and to the behavior of
    the previous draft versions of commit 98aaa913b4ed ("tcp: Extend
    SOF_TIMESTAMPING_RX_SOFTWARE to TCP recvmsg") which also match this
    behavior.
    
    Fixes: 98aaa913b4ed ("tcp: Extend SOF_TIMESTAMPING_RX_SOFTWARE to TCP recvmsg")
    Co-developed-by: Iris Liu <iris@onechronos.com>
    Signed-off-by: Iris Liu <iris@onechronos.com>
    Signed-off-by: Kelly Littlepage <kelly@onechronos.com>
    Signed-off-by: Eric Dumazet <edumazet@google.com>
    Acked-by: Soheil Hassas Yeganeh <soheil@google.com>
    Acked-by: Willem de Bruijn <willemb@google.com>
    Signed-off-by: Jakub Kicinski <kuba@kernel.org>
    Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>

commit 8df010e4c84d5b3518e698e1a89dc2b0a87f2be9
Author: Kelly Littlepage <kelly@onechronos.com>
Date:   Fri May 8 19:58:46 2020 +0000

    net: tcp: fix rx timestamp behavior for tcp_recvmsg
    
    [ Upstream commit cc4de047b33be247f9c8150d3e496743a49642b8 ]
    
    The stated intent of the original commit is to is to "return the timestamp
    corresponding to the highest sequence number data returned." The current
    implementation returns the timestamp for the last byte of the last fully
    read skb, which is not necessarily the last byte in the recv buffer. This
    patch converts behavior to the original definition, and to the behavior of
    the previous draft versions of commit 98aaa913b4ed ("tcp: Extend
    SOF_TIMESTAMPING_RX_SOFTWARE to TCP recvmsg") which also match this
    behavior.
    
    Fixes: 98aaa913b4ed ("tcp: Extend SOF_TIMESTAMPING_RX_SOFTWARE to TCP recvmsg")
    Co-developed-by: Iris Liu <iris@onechronos.com>
    Signed-off-by: Iris Liu <iris@onechronos.com>
    Signed-off-by: Kelly Littlepage <kelly@onechronos.com>
    Signed-off-by: Eric Dumazet <edumazet@google.com>
    Acked-by: Soheil Hassas Yeganeh <soheil@google.com>
    Acked-by: Willem de Bruijn <willemb@google.com>
    Signed-off-by: Jakub Kicinski <kuba@kernel.org>
    Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>

commit c3888416221849ed46fd35413c7a1d00ee291cbe
Author: Bart Van Assche <bvanassche@acm.org>
Date:   Mon May 18 14:17:06 2020 -0700

    scsi: qla2xxx: Use register names instead of register offsets
    
    Make qla27xx_write_remote_reg() easier to read by using register names
    instead of register offsets. The 'pahole' tool has been used to convert
    register offsets into register names. See also commit cbb01c2f2f63 ("scsi:
    qla2xxx: Fix MPI failure AEN (8200) handling").
    
    Link: https://lore.kernel.org/r/20200518211712.11395-10-bvanassche@acm.org
    Cc: Arun Easi <aeasi@marvell.com>
    Cc: Nilesh Javali <njavali@marvell.com>
    Cc: Martin Wilck <mwilck@suse.com>
    Cc: Roman Bolshakov <r.bolshakov@yadro.com>
    Reviewed-by: Hannes Reinecke <hare@suse.de>
    Reviewed-by: Daniel Wagner <dwagner@suse.de>
    Reviewed-by: Himanshu Madhani <himanshu.madhani@oracle.com>
    Signed-off-by: Bart Van Assche <bvanassche@acm.org>
    Signed-off-by: Martin K. Petersen <martin.petersen@oracle.com>

commit 8ae178760b23e2055aecf8b8a54629cec7ccc58e
Author: Bart Van Assche <bvanassche@acm.org>
Date:   Mon May 18 14:17:00 2020 -0700

    scsi: qla2xxx: Simplify the functions for dumping firmware
    
    Instead of passing an argument to the firmware dumping functions that tells
    these functions whether or not to obtain the hardware lock, obtain that
    lock before calling these functions. This patch fixes the following
    recently introduced C=2 build error:
    
      CHECK   drivers/scsi/qla2xxx/qla_tmpl.c
    drivers/scsi/qla2xxx/qla_tmpl.c:1133:1: error: Expected ; at end of statement
    drivers/scsi/qla2xxx/qla_tmpl.c:1133:1: error: got }
    drivers/scsi/qla2xxx/qla_tmpl.h:247:0: error: Expected } at end of function
    drivers/scsi/qla2xxx/qla_tmpl.h:247:0: error: got end-of-input
    
    Link: https://lore.kernel.org/r/20200518211712.11395-4-bvanassche@acm.org
    Fixes: cbb01c2f2f63 ("scsi: qla2xxx: Fix MPI failure AEN (8200) handling")
    Cc: Arun Easi <aeasi@marvell.com>
    Cc: Nilesh Javali <njavali@marvell.com>
    Cc: Himanshu Madhani <himanshu.madhani@oracle.com>
    Cc: Martin Wilck <mwilck@suse.com>
    Cc: Roman Bolshakov <r.bolshakov@yadro.com>
    Reviewed-by: Hannes Reinecke <hare@suse.de>
    Reviewed-by: Daniel Wagner <dwagner@suse.de>
    Signed-off-by: Bart Van Assche <bvanassche@acm.org>
    Signed-off-by: Martin K. Petersen <martin.petersen@oracle.com>

commit b24bc583dea7e0cf2d5d68e3325e1689fa7c2275
Author: Andy Shevchenko <andriy.shevchenko@linux.intel.com>
Date:   Tue May 12 21:27:20 2020 +0300

    gpio: xgene-sb: Allow driver to be built with COMPILE_TEST
    
    Allow driver to be built with COMPILE_TEST for better test coverage.
    
    Signed-off-by: Andy Shevchenko <andriy.shevchenko@linux.intel.com>
    Link: https://lore.kernel.org/r/20200512182721.55127-2-andriy.shevchenko@linux.intel.com
    Signed-off-by: Linus Walleij <linus.walleij@linaro.org>

commit f59e76687742fc2d6226e0d6449ae09c5942e9fc
Author: Masahiro Yamada <masahiroy@kernel.org>
Date:   Wed Apr 29 12:45:16 2020 +0900

    samples: seccomp: build sample programs for target architecture
    
    These userspace programs include UAPI headers exported to usr/include/.
    'make headers' always works for the target architecture (i.e. the same
    architecture as the kernel), so the sample programs should be built for
    the target as well. Kbuild now supports 'userprogs' for that.
    
    I also guarded the CONFIG option by 'depends on CC_CAN_LINK' because
    $(CC) may not provide libc.
    
    The 'ifndef CROSS_COMPILE' is no longer needed.
    
    BTW, the -m31 for s390 is left-over code. Commit 5a79859ae0f3 ("s390:
    remove 31 bit support") killed it.
    
    Signed-off-by: Masahiro Yamada <masahiroy@kernel.org>
    Acked-by: Sam Ravnborg <sam@ravnborg.org>

commit ab7fbad0c7d7a4f9b320a059a171a92a34b6d409
Author: Kefeng Wang <wangkefeng.wang@huawei.com>
Date:   Mon May 11 10:19:52 2020 +0800

    riscv: Fix unmet direct dependencies built based on SOC_VIRT
    
    Fix unmet direct dependencies Warning and fix Kconfig indent.
    
    WARNING: unmet direct dependencies detected for POWER_RESET_SYSCON
      Depends on [n]: POWER_RESET [=n] && OF [=y] && HAS_IOMEM [=y]
      Selected by [y]:
      - SOC_VIRT [=y]
    
    WARNING: unmet direct dependencies detected for POWER_RESET_SYSCON_POWEROFF
      Depends on [n]: POWER_RESET [=n] && OF [=y] && HAS_IOMEM [=y]
      Selected by [y]:
      - SOC_VIRT [=y]
    
    WARNING: unmet direct dependencies detected for RTC_DRV_GOLDFISH
      Depends on [n]: RTC_CLASS [=n] && OF [=y] && HAS_IOMEM [=y] && (GOLDFISH [=y] || COMPILE_TEST [=n])
      Selected by [y]:
      - SOC_VIRT [=y]
    
    Reported-by: Hulk Robot <hulkci@huawei.com>
    Signed-off-by: Kefeng Wang <wangkefeng.wang@huawei.com>
    Signed-off-by: Palmer Dabbelt <palmerdabbelt@google.com>

commit ba8f6682bcb3312645c6cb77499ceaa66cc950a6
Author: Thierry Reding <treding@nvidia.com>
Date:   Tue May 12 23:01:38 2020 +0200

    media: tegra-video: Do not enable COMPILE_TEST
    
    The symbols exported when TEGRA_HOST1X is selected don't have dummies
    that could serve as stubs for COMPILE_TEST, so a hard dependency on the
    TEGRA_HOST1X symbol is needed.
    
    Suggested-by: Stephen Rothwell <sfr@canb.auug.org.au>
    Signed-off-by: Thierry Reding <treding@nvidia.com>

commit fd9d0ca2cc4f3c26877eb336a7d26d705ff42b8a
Author: Nathan Chancellor <natechancellor@gmail.com>
Date:   Tue Apr 28 15:14:17 2020 -0700

    MIPS: Unconditionally specify '-EB' or '-EL'
    
    This was all done to work around a GCC bug that has been fixed after
    4.2. The kernel requires GCC 4.6 or newer so remove all of these hacks
    and just use the traditional flags.
    
     $ mips64-linux-gcc --version | head -n1
     mips64-linux-gcc (GCC) 4.6.3
    
     $ mips64-linux-gcc -EB -dM -E -C -x c /dev/null | grep MIPSE
     #define MIPSEB 1
     #define __MIPSEB__ 1
     #define _MIPSEB 1
     #define __MIPSEB 1
    
     $ mips64-linux-gcc -EL -dM -E -C -x c /dev/null | grep MIPSE
     #define __MIPSEL__ 1
     #define MIPSEL 1
     #define _MIPSEL 1
     #define __MIPSEL 1
    
    This is necessary when converting the MIPS VDSO to use $(LD) instead of
    $(CC) to link because the OUTPUT_FORMAT is defaulted to little endian
    and only flips to big endian when '-EB' is set on the command line.
    There is no issue currently because the compiler explicitly passes
    '-EB' or '-EL' to the linker regardless of whether or not it was
    provided by the user. Passing '-v' to VDSO_LDFLAGS shows:
    
    <gcc_prefix>/libexec/gcc/mips64-linux/9.3.0/collect2 ... -EB ...
    
    even though '-EB' is nowhere to be found in KBUILD_CFLAGS. The VDSO
    Makefile already supports getting '-EB' or '-EL' from KBUILD_CFLAGS
    through a filter directive but '-EB' or '-EL' is not always present.
    
    If we do not do this, we will see the following error when compiling
    for big endian:
    
    $ make -j$(nproc) ARCH=mips CROSS_COMPILE=mips64-linux- \
      64r2el_defconfig arch/mips/vdso/
    ...
    mips64-linux-ld: arch/mips/vdso/elf.o: compiled for a big endian system
    and target is little endian
    mips64-linux-ld: arch/mips/vdso/elf.o: endianness incompatible with that
    of the selected emulation
    mips64-linux-ld: failed to merge target specific data of file
    arch/mips/vdso/elf.o
    ...
    
    Remove this legacy hack and just use '-EB' and '-EL' unconditionally.
    
    Reported-by: Thomas Bogendoerfer <tsbogend@alpha.franken.de>
    Signed-off-by: Nathan Chancellor <natechancellor@gmail.com>
    Signed-off-by: Thomas Bogendoerfer <tsbogend@alpha.franken.de>

commit 9a950154668729a472d17b8e307d92e7c60f45f7
Author: Masahiro Yamada <masahiroy@kernel.org>
Date:   Thu Apr 23 23:23:54 2020 +0900

    kbuild: use CONFIG_CC_VERSION_TEXT to construct LINUX_COMPILER macro
    
    scripts/mkcompile_h runs $(CC) just for getting the version string.
    Reuse CONFIG_CC_VERSION_TEXT for optimization.
    
    For GCC, this slightly changes the version string. I do not think it
    is a big deal as we do not have the defined format for LINUX_COMPILER.
    In fact, the recent commit 4dcc9a88448a ("kbuild: mkcompile_h:
    Include $LD version in /proc/version") added the linker version.
    
    Signed-off-by: Masahiro Yamada <masahiroy@kernel.org>

commit dc960bfeedb01cf832c5632ed1f3daed4416b142
Author: Masahiro Yamada <masahiroy@kernel.org>
Date:   Sat Apr 25 14:18:16 2020 +0900

    h8300: suppress error messages for 'make clean'
    
    'make ARCH=h8300 clean' emits error messages as follows:
    
      $ make ARCH=h8300 clean
      gcc: error: missing argument to '-Wframe-larger-than='
      gcc: error: unrecognized command line option '-mint32'
    
    You can suppress the second one by setting the correct CROSS_COMPILE=,
    but we should not require any compiler for cleaning.
    
    Signed-off-by: Masahiro Yamada <masahiroy@kernel.org>

commit 6632fa8fcabacd75329bd2ea78cba5c43754639a
Author: Masahiro Yamada <masahiroy@kernel.org>
Date:   Sat Apr 25 01:15:02 2020 +0900

    hexagon: suppress error message for 'make clean'
    
    'make ARCH=hexagon clean' emits an error message as follows:
    
      $ make ARCH=hexagon clean
      gcc: error: unrecognized command line option '-G0'
    
    You can suppress it by setting the correct CROSS_COMPILE=,
    but we should not require any compiler for cleaning.
    
    Signed-off-by: Masahiro Yamada <masahiroy@kernel.org>
    Acked-by: Brian Cain <bcain@codeaurora.org>

commit cc4de047b33be247f9c8150d3e496743a49642b8
Author: Kelly Littlepage <kelly@onechronos.com>
Date:   Fri May 8 19:58:46 2020 +0000

    net: tcp: fix rx timestamp behavior for tcp_recvmsg
    
    The stated intent of the original commit is to is to "return the timestamp
    corresponding to the highest sequence number data returned." The current
    implementation returns the timestamp for the last byte of the last fully
    read skb, which is not necessarily the last byte in the recv buffer. This
    patch converts behavior to the original definition, and to the behavior of
    the previous draft versions of commit 98aaa913b4ed ("tcp: Extend
    SOF_TIMESTAMPING_RX_SOFTWARE to TCP recvmsg") which also match this
    behavior.
    
    Fixes: 98aaa913b4ed ("tcp: Extend SOF_TIMESTAMPING_RX_SOFTWARE to TCP recvmsg")
    Co-developed-by: Iris Liu <iris@onechronos.com>
    Signed-off-by: Iris Liu <iris@onechronos.com>
    Signed-off-by: Kelly Littlepage <kelly@onechronos.com>
    Signed-off-by: Eric Dumazet <edumazet@google.com>
    Acked-by: Soheil Hassas Yeganeh <soheil@google.com>
    Acked-by: Willem de Bruijn <willemb@google.com>
    Signed-off-by: Jakub Kicinski <kuba@kernel.org>

commit af38553c661207f96464e15f3506bf788daee474
Merge: 79dede78c057 14f69140ff9c
Author: Linus Torvalds <torvalds@linux-foundation.org>
Date:   Fri May 8 08:41:09 2020 -0700

    Merge branch 'akpm' (patches from Andrew)
    
    Merge misc fixes from Andrew Morton:
     "14 fixes and one selftest to verify the ipc fixes herein"
    
    * emailed patches from Andrew Morton <akpm@linux-foundation.org>:
      mm: limit boost_watermark on small zones
      ubsan: disable UBSAN_ALIGNMENT under COMPILE_TEST
      mm/vmscan: remove unnecessary argument description of isolate_lru_pages()
      epoll: atomically remove wait entry on wake up
      kselftests: introduce new epoll60 testcase for catching lost wakeups
      percpu: make pcpu_alloc() aware of current gfp context
      mm/slub: fix incorrect interpretation of s->offset
      scripts/gdb: repair rb_first() and rb_last()
      eventpoll: fix missing wakeup for ovflist in ep_poll_callback
      arch/x86/kvm/svm/sev.c: change flag passed to GUP fast in sev_pin_memory()
      scripts/decodecode: fix trapping instruction formatting
      kernel/kcov.c: fix typos in kcov_remote_start documentation
      mm/page_alloc: fix watchdog soft lockups during set_zone_contiguous()
      mm, memcg: fix error return value of mem_cgroup_css_alloc()
      ipc/mqueue.c: change __do_notify() to bypass check_kill_permission()

commit 1c4b3c409998a7d63ed9b590e3601cf7c4d102b5
Author: Eric Biggers <ebiggers@google.com>
Date:   Sat May 2 11:24:22 2020 -0700

    crypto: powerpc/sha1 - remove unused temporary workspace
    
    The PowerPC implementation of SHA-1 doesn't actually use the 16-word
    temporary array that's passed to the assembly code.  This was probably
    meant to correspond to the 'W' array that lib/sha1.c uses.  However, in
    sha1-powerpc-asm.S these values are actually stored in GPRs 16-31.
    
    Referencing SHA_WORKSPACE_WORDS from this code also isn't appropriate,
    since it's an implementation detail of lib/sha1.c.
    
    Therefore, just remove this unneeded array.
    
    Tested with:
    
            export ARCH=powerpc CROSS_COMPILE=powerpc-linux-gnu-
            make mpc85xx_defconfig
            cat >> .config << EOF
            # CONFIG_MODULES is not set
            # CONFIG_CRYPTO_MANAGER_DISABLE_TESTS is not set
            CONFIG_DEBUG_KERNEL=y
            CONFIG_CRYPTO_MANAGER_EXTRA_TESTS=y
            CONFIG_CRYPTO_SHA1_PPC=y
            EOF
            make olddefconfig
            make -j32
            qemu-system-ppc -M mpc8544ds -cpu e500 -nographic \
                    -kernel arch/powerpc/boot/zImage \
                    -append "cryptomgr.fuzz_iterations=1000 cryptomgr.panic_on_fail=1"
    
    Cc: linuxppc-dev@lists.ozlabs.org
    Cc: Benjamin Herrenschmidt <benh@kernel.crashing.org>
    Cc: Michael Ellerman <mpe@ellerman.id.au>
    Cc: Paul Mackerras <paulus@samba.org>
    Signed-off-by: Eric Biggers <ebiggers@google.com>
    Acked-by: Michael Ellerman <mpe@ellerman.id.au> (powerpc)
    Signed-off-by: Herbert Xu <herbert@gondor.apana.org.au>

commit 3fd911b69b3117e03181262fc19ae6c3ef6962ce
Merge: 370fb6b0aaf0 0ea2ea42b31a
Author: Dave Airlie <airlied@redhat.com>
Date:   Fri May 8 15:16:36 2020 +1000

    Merge tag 'drm-misc-next-2020-05-07' of git://anongit.freedesktop.org/drm/drm-misc into drm-next
    
    drm-misc-next for 5.8:
    
    UAPI Changes:
    
    Cross-subsystem Changes:
    
     * MAINTAINERS: restore alphabetical order; update cirrus driver
     * Dcomuentation: document visionix, chronteli, ite vendor prefices; update
                      documentation for Chrontel CH7033, IT6505, IVO, BOE,
                      Panasonic, Chunghwa, AUO bindings; convert dw_mipi_dsi.txt
                      to YAML; remove todo item for drm_display_mode.hsync removal;
    
    Core Changes:
    
     * drm: add devm_drm_dev_alloc() for managed allocations of drm_device;
            use DRM_MODESET_LOCK_ALL_*() in mode-object code; remove
            drm_display_mode.hsync; small cleanups of unused variables,
            compiler warnings and static functions
     * drm/client: dual-lincensing: GPL-2.0 or MIT
     * drm/mm: optimize tree searches in rb_hole_addr()
    
    Driver Changes:
    
     * drm/{many}: use devm_drm_dev_alloc(); don't use drm_device.dev_private
     * drm/ast: don't double-assign to drm_crtc_funcs.set_config; drop
                drm_connector_register()
     * drm/bochs: drop drm_connector_register()
     * drm/bridge: add support for Chrontel ch7033; fix stack usage with
                   old gccs; return error pointer in drm_panel_bridge_add()
     * drm/cirrus: Move to tiny
     * drm/dp_mst: don't use 2nd sideband tx slot; revert "Remove single tx
                   msg restriction"
     * drm/lima: support runtime PM;
     * drm/meson: limit modes wrt chipset
     * drm/panel: add support for Visionox rm69299; fix clock on
                  boe-tv101wum-n16; fix panel type for AUO G101EVN10;
                  add support for Ivo M133NFW4 R0; add support for BOE
                  NV133FHM-N61; add support for AUO G121EAN01.4, G156XTN01.0,
                  G190EAN01
     * drm/pl111: improve vexpress init; fix module auto-loading
     * drm/stm: read number of endpoints from device tree
     * drm/vboxvideo: use managed PCI functions; drop DRM_MTRR_WC
     * drm/vkms: fix use-after-free in vkms_gem_create(); enable cursor
                 support by default
     * fbdev: use boolean values in several drivers
     * fbdev/controlfb: fix COMPILE_TEST
     * fbdev/w100fb: fix double-free bug
    
    Signed-off-by: Dave Airlie <airlied@redhat.com>
    
    From: Thomas Zimmermann <tzimmermann@suse.de>
    Link: https://patchwork.freedesktop.org/patch/msgid/20200507072503.GA10979@linux-uq9g

commit 8d58f222e85f01da0c0e1fc1e77986c86de889e2
Author: Kees Cook <keescook@chromium.org>
Date:   Thu May 7 18:36:23 2020 -0700

    ubsan: disable UBSAN_ALIGNMENT under COMPILE_TEST
    
    The documentation for UBSAN_ALIGNMENT already mentions that it should
    not be used on all*config builds (and for efficient-unaligned-access
    architectures), so just refactor the Kconfig to correctly implement this
    so randconfigs will stop creating insane images that freak out objtool
    under CONFIG_UBSAN_TRAP (due to the false positives producing functions
    that never return, etc).
    
    Link: http://lkml.kernel.org/r/202005011433.C42EA3E2D@keescook
    Fixes: 0887a7ebc977 ("ubsan: add trap instrumentation option")
    Signed-off-by: Kees Cook <keescook@chromium.org>
    Reported-by: Randy Dunlap <rdunlap@infradead.org>
      Link: https://lore.kernel.org/linux-next/202004231224.D6B3B650@keescook/
    Signed-off-by: Andrew Morton <akpm@linux-foundation.org>
    Cc: Josh Poimboeuf <jpoimboe@redhat.com>
    Cc: Stephen Rothwell <sfr@canb.auug.org.au>
    Cc: Peter Zijlstra <peterz@infradead.org>
    Cc: Andrey Ryabinin <aryabinin@virtuozzo.com>
    Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>

commit 81134fb541d46d0441ce7fce557eba6c418fcc36
Author: Rob Herring <robh@kernel.org>
Date:   Wed Apr 29 15:58:13 2020 -0500

    clk: versatile: Rework kconfig structure
    
    CONFIG_COMMON_CLK_VERSATILE doesn't really do anything other than hiding
    Arm Ltd reference platform clock drivers. It is both selected by the
    platforms that need it and has a 'depends on' for those platforms. Let's
    drop the selects and convert CONFIG_COMMON_CLK_VERSATILE into a
    menuconfig entry. With this make CONFIG_ICST visible.
    
    Move the 'select REGMAP_MMIO' to the drivers that require it (SP810 did
    not).
    
    This also has the side effect of enabling CONFIG_ICST for COMPILE_TEST
    as it was not visible before.
    
    Cc: Catalin Marinas <catalin.marinas@arm.com>
    Cc: Will Deacon <will@kernel.org>
    Cc: Liviu Dudau <liviu.dudau@arm.com>
    Cc: Lorenzo Pieralisi <lorenzo.pieralisi@arm.com>
    Cc: Linus Walleij <linus.walleij@linaro.org>
    Reviewed-by: Sudeep Holla <sudeep.holla@arm.com>
    Reviewed-by: Stephen Boyd <sboyd@kernel.org>
    Signed-off-by: Rob Herring <robh@kernel.org>

commit 140777a3d8dfdb3d3f20ea7707c0f1c0ce1b0aa5
Author: Hari Bathini <hbathini@linux.ibm.com>
Date:   Mon Apr 20 14:26:22 2020 +0530

    powerpc/fadump: consider reserved ranges while reserving memory
    
    Commit 0962e8004e97 ("powerpc/prom: Scan reserved-ranges node for
    memory reservations") enabled support to parse reserved-ranges DT
    node and reserve kernel memory falling in these ranges for F/W
    purposes. Memory reserved for FADump should not overlap with these
    ranges as it could corrupt memory meant for F/W or crash'ed kernel
    memory to be exported as vmcore.
    
    But since commit 579ca1a27675 ("powerpc/fadump: make use of memblock's
    bottom up allocation mode"), memblock_find_in_range() is being used to
    find the appropriate area to reserve memory for FADump, which can't
    account for reserved-ranges as these ranges are reserved only after
    FADump memory reservation.
    
    With reserved-ranges now being populated during early boot, look out
    for these memory ranges while reserving memory for FADump. Without
    this change, MPIPL on PowerNV systems aborts with hostboot failure,
    when memory reserved for FADump is less than 4096MB.
    
    Fixes: 579ca1a27675 ("powerpc/fadump: make use of memblock's bottom up allocation mode")
    Cc: stable@vger.kernel.org
    Signed-off-by: Hari Bathini <hbathini@linux.ibm.com>
    Reviewed-by: Mahesh Salgaonkar <mahesh@linux.ibm.com>
    Signed-off-by: Michael Ellerman <mpe@ellerman.id.au>
    Link: https://lore.kernel.org/r/158737297693.26700.16193820746269425424.stgit@hbathini.in.ibm.com

commit 02c04e374e176ae3a3f64a682f80702f8d2fb65d
Author: Hari Bathini <hbathini@linux.ibm.com>
Date:   Mon Apr 20 14:26:09 2020 +0530

    powerpc/fadump: use static allocation for reserved memory ranges
    
    At times, memory ranges have to be looked up during early boot, when
    kernel couldn't be initialized for dynamic memory allocation. In fact,
    reserved-ranges look up is needed during FADump memory reservation.
    Without accounting for reserved-ranges in reserving memory for FADump,
    MPIPL boot fails with memory corruption issues. So, extend memory
    ranges handling to support static allocation and populate reserved
    memory ranges during early boot.
    
    Fixes: dda9dbfeeb7a ("powerpc/fadump: consider reserved ranges while releasing memory")
    Cc: stable@vger.kernel.org
    Signed-off-by: Hari Bathini <hbathini@linux.ibm.com>
    Reviewed-by: Mahesh Salgaonkar <mahesh@linux.ibm.com>
    Signed-off-by: Michael Ellerman <mpe@ellerman.id.au>
    Link: https://lore.kernel.org/r/158737294432.26700.4830263187856221314.stgit@hbathini.in.ibm.com

commit 66d69e081b526b6a6031f0d3ca8ddff71e5707a5
Author: Shuah Khan <skhan@linuxfoundation.org>
Date:   Mon Apr 27 18:11:07 2020 -0600

    selftests: fix kvm relocatable native/cross builds and installs
    
    kvm test Makefile doesn't fully support cross-builds and installs.
    UNAME_M = $(shell uname -m) variable is used to define the target
    programs and libraries to be built from arch specific sources in
    sub-directories.
    
    For cross-builds to work, UNAME_M has to map to ARCH and arch specific
    directories and targets in this Makefile.
    
    UNAME_M variable to used to run the compiles pointing to the right arch
    directories and build the right targets for these supported architectures.
    
    TEST_GEN_PROGS and LIBKVM are set using UNAME_M variable.
    LINUX_TOOL_ARCH_INCLUDE is set using ARCH variable.
    
    x86_64 targets are named to include x86_64 as a suffix and directories
    for includes are in x86_64 sub-directory. s390x and aarch64 follow the
    same convention. "uname -m" doesn't result in the correct mapping for
    s390x and aarch64. Fix it to set UNAME_M correctly for s390x and aarch64
    cross-builds.
    
    In addition, Makefile doesn't create arch sub-directories in the case of
    relocatable builds and test programs under s390x and x86_64 directories
    fail to build. This is a problem for native and cross-builds. Fix it to
    create all necessary directories keying off of TEST_GEN_PROGS.
    
    The following use-cases work with this change:
    
    Native x86_64:
    make O=/tmp/kselftest -C tools/testing/selftests TARGETS=kvm install \
     INSTALL_PATH=$HOME/x86_64
    
    arm64 cross-build:
    make O=$HOME/arm64_build/ ARCH=arm64 HOSTCC=gcc \
            CROSS_COMPILE=aarch64-linux-gnu- defconfig
    
    make O=$HOME/arm64_build/ ARCH=arm64 HOSTCC=gcc \
            CROSS_COMPILE=aarch64-linux-gnu- all
    
    make kselftest-install TARGETS=kvm O=$HOME/arm64_build ARCH=arm64 \
            HOSTCC=gcc CROSS_COMPILE=aarch64-linux-gnu-
    
    s390x cross-build:
    make O=$HOME/s390x_build/ ARCH=s390 HOSTCC=gcc \
            CROSS_COMPILE=s390x-linux-gnu- defconfig
    
    make O=$HOME/s390x_build/ ARCH=s390 HOSTCC=gcc \
            CROSS_COMPILE=s390x-linux-gnu- all
    
    make kselftest-install TARGETS=kvm O=$HOME/s390x_build/ ARCH=s390 \
            HOSTCC=gcc CROSS_COMPILE=s390x-linux-gnu- all
    
    No regressions in the following use-cases:
    make -C tools/testing/selftests TARGETS=kvm
    make kselftest-all TARGETS=kvm
    
    Signed-off-by: Shuah Khan <skhan@linuxfoundation.org>

commit 78b874b7cbf09fbfadfa5f18a347ebef7bbb49fe
Author: Colin Ian King <colin.king@canonical.com>
Date:   Tue Apr 28 11:20:13 2020 +0100

    scsi: qla2xxx: make 1-bit bit-fields unsigned int
    
    The bitfields mpi_fw_dump_reading and mpi_fw_dumped are currently signed
    which is not recommended as the representation is an implementation defined
    behaviour.  Fix this by making the bit-fields unsigned ints.
    
    Link: https://lore.kernel.org/r/20200428102013.1040598-1-colin.king@canonical.com
    Fixes: cbb01c2f2f63 ("scsi: qla2xxx: Fix MPI failure AEN (8200) handling")
    Reviewed-by: Bart Van Assche <bvanassche@acm.org>
    Reviewed-by: Himanshu Madhani <himanshu.madhani@oracle.com>
    Signed-off-by: Colin Ian King <colin.king@canonical.com>
    Signed-off-by: Martin K. Petersen <martin.petersen@oracle.com>

commit 6d4f3e2bfc4968eba13ea41bd3040ed76733324b
Author: Bartlomiej Zolnierkiewicz <b.zolnierkie@samsung.com>
Date:   Wed Apr 29 12:48:24 2020 +0200

    video: fbdev: controlfb: fix build for COMPILE_TEST=y && PPC_PMAC=y && PPC32=n
    
    powerpc allyesconfig fails like this:
    
    drivers/video/fbdev/controlfb.c: In function 'controlfb_mmap':
    drivers/video/fbdev/controlfb.c:756:23: error: implicit declaration of function 'pgprot_cached_wthru'; did you mean 'pgprot_cached'? [-Werror=implicit-function-declaration]
      756 |   vma->vm_page_prot = pgprot_cached_wthru(vma->vm_page_prot);
          |                       ^~~~~~~~~~~~~~~~~~~
          |                       pgprot_cached
    drivers/video/fbdev/controlfb.c:756:23: error: incompatible types when assigning to type 'pgprot_t' {aka 'struct <anonymous>'} from type 'int'
    
    Fix it by adding missing PPC32 dependency.
    
    Fixes: a07a63b0e24d ("video: fbdev: controlfb: add COMPILE_TEST support")
    Reported-by: Stephen Rothwell <sfr@canb.auug.org.au>
    Reported-by: kbuild test robot <lkp@intel.com>
    Cc: Sam Ravnborg <sam@ravnborg.org>
    Cc: Daniel Vetter <daniel.vetter@ffwll.ch>
    Signed-off-by: Bartlomiej Zolnierkiewicz <b.zolnierkie@samsung.com>
    Signed-off-by: Sam Ravnborg <sam@ravnborg.org>
    Link: https://patchwork.freedesktop.org/patch/msgid/fe520316-3863-e6c4-9581-5d709f49e906@samsung.com

commit 94659e93c93c23dfaada78aaad45183867698f74
Author: Paolo Bonzini <pbonzini@redhat.com>
Date:   Fri May 17 14:08:53 2019 +0200

    kvm: fix compilation on aarch64
    
    commit c011d23ba046826ccf8c4a4a6c1d01c9ccaa1403 upstream.
    
    Commit e45adf665a53 ("KVM: Introduce a new guest mapping API", 2019-01-31)
    introduced a build failure on aarch64 defconfig:
    
    $ make -j$(nproc) ARCH=arm64 CROSS_COMPILE=aarch64-linux-gnu- O=out defconfig \
                    Image.gz
    ...
    ../arch/arm64/kvm/../../../virt/kvm/kvm_main.c:
        In function '__kvm_map_gfn':
    ../arch/arm64/kvm/../../../virt/kvm/kvm_main.c:1763:9: error:
        implicit declaration of function 'memremap'; did you mean 'memset_p'?
    ../arch/arm64/kvm/../../../virt/kvm/kvm_main.c:1763:46: error:
        'MEMREMAP_WB' undeclared (first use in this function)
    ../arch/arm64/kvm/../../../virt/kvm/kvm_main.c:
        In function 'kvm_vcpu_unmap':
    ../arch/arm64/kvm/../../../virt/kvm/kvm_main.c:1795:3: error:
        implicit declaration of function 'memunmap'; did you mean 'vm_munmap'?
    
    because these functions are declared in <linux/io.h> rather than <asm/io.h>,
    and the former was being pulled in already on x86 but not on aarch64.
    
    Reported-by: Nathan Chancellor <natechancellor@gmail.com>
    Signed-off-by: Paolo Bonzini <pbonzini@redhat.com>
    [bwh: Backported to 4.19: adjust context]
    Signed-off-by: Ben Hutchings <ben.hutchings@codethink.co.uk>
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit 9dd124b63a2e03c85dab42cc009a6fd9b9e571a1
Author: Krzysztof Kozlowski <krzk@kernel.org>
Date:   Tue Apr 14 16:26:30 2020 +0200

    iommu: spapr_tce: Disable compile testing to fix build on book3s_32 config
    
    Although SPAPR_TCE_IOMMU itself can be compile tested on certain PowerPC
    configurations, its presence makes arch/powerpc/kvm/Makefile to select
    modules which do not build in such configuration.
    
    The arch/powerpc/kvm/ modules use kvm_arch.spapr_tce_tables which exists
    only with CONFIG_PPC_BOOK3S_64.  However these modules are selected when
    COMPILE_TEST and SPAPR_TCE_IOMMU are chosen leading to build failures:
    
        In file included from arch/powerpc/include/asm/book3s/64/mmu-hash.h:20:0,
                         from arch/powerpc/kvm/book3s_64_vio_hv.c:22:
        arch/powerpc/include/asm/book3s/64/pgtable.h:17:0: error: "_PAGE_EXEC" redefined [-Werror]
         #define _PAGE_EXEC  0x00001 /* execute permission */
    
        In file included from arch/powerpc/include/asm/book3s/32/pgtable.h:8:0,
                         from arch/powerpc/include/asm/book3s/pgtable.h:8,
                         from arch/powerpc/include/asm/pgtable.h:18,
                         from include/linux/mm.h:95,
                         from arch/powerpc/include/asm/io.h:29,
                         from include/linux/io.h:13,
                         from include/linux/irq.h:20,
                         from arch/powerpc/include/asm/hardirq.h:6,
                         from include/linux/hardirq.h:9,
                         from include/linux/kvm_host.h:7,
                         from arch/powerpc/kvm/book3s_64_vio_hv.c:12:
        arch/powerpc/include/asm/book3s/32/hash.h:29:0: note: this is the location of the previous definition
         #define _PAGE_EXEC 0x200 /* software: exec allowed */
    
    Fixes: e93a1695d7fb ("iommu: Enable compile testing for some of drivers")
    Reported-by: Geert Uytterhoeven <geert@linux-m68k.org>
    Signed-off-by: Krzysztof Kozlowski <krzk@kernel.org>
    Link: https://lore.kernel.org/r/20200414142630.21153-1-krzk@kernel.org
    Signed-off-by: Joerg Roedel <jroedel@suse.de>

commit bfed0eded1ce00bda5cc2d2939b017f88e6b1fd0
Author: Rob Herring <robh@kernel.org>
Date:   Fri Apr 17 16:20:45 2020 -0500

    clocksource/drivers/versatile: Allow CONFIG_CLKSRC_VERSATILE to be disabled
    
    The timer-versatile driver provides a sched_clock for certain Arm Ltd.
    reference platforms. Specifically, it is used on Versatile and 32-bit
    VExpress. It is not needed for those platforms with an arch timer (all
    the 64-bit ones) yet CONFIG_MFD_VEXPRESS_SYSREG does still need to be
    enabled. In that case, the timer-versatile can only be disabled when
    COMPILE_TEST is enabled which is not desirable. Let's use the sub-arch
    kconfig symbols instead.
    
    Realview platforms don't have the sysregs that this driver uses so
    correct the help text.
    
    Cc: Daniel Lezcano <daniel.lezcano@linaro.org>
    Cc: Thomas Gleixner <tglx@linutronix.de>
    Cc: Linus Walleij <linus.walleij@linaro.org>
    Signed-off-by: Rob Herring <robh@kernel.org>
    Reviewed-by: Linus Walleij <linus.walleij@linaro.org>
    Signed-off-by: Daniel Lezcano <daniel.lezcano@linaro.org>
    Link: https://lore.kernel.org/r/20200417212045.16917-1-robh@kernel.org

commit cbb01c2f2f630f1497f703c51ff21538ae2d86b8
Author: Arun Easi <aeasi@marvell.com>
Date:   Tue Mar 31 03:40:13 2020 -0700

    scsi: qla2xxx: Fix MPI failure AEN (8200) handling
    
    Today, upon an MPI failure AEN, on top of collecting an MPI dump, a regular
    firmware dump is also taken and then chip reset. This is disruptive to IOs
    and not required. Make the firmware dump collection, followed by chip
    reset, optional (not done by default).
    
    Firmware dump buffer and MPI dump buffer are independent of each
    other with this change and each can have dump that was taken at two
    different times for two different issues. The MPI dump is saved in a
    separate buffer and is retrieved differently from firmware dump.
    
    To collect full dump on MPI failure AEN, a module parameter is
    introduced:
        ql2xfulldump_on_mpifail (default: 0)
    
    Link: https://lore.kernel.org/r/20200331104015.24868-2-njavali@marvell.com
    Reported-by: kbuild test robot <lkp@intel.com>
    Reviewed-by: Himanshu Madhani <himanshu.madhani@oracle.com>
    Signed-off-by: Arun Easi <aeasi@marvell.com>
    Signed-off-by: Nilesh Javali <njavali@marvell.com>
    Signed-off-by: Martin K. Petersen <martin.petersen@oracle.com>

commit 126a34061eec2df05a5a28052edefd4e6125f31c
Merge: 1aa63ddf726e 776d58823a60
Author: Dave Airlie <airlied@redhat.com>
Date:   Fri Apr 24 13:12:08 2020 +1000

    Merge tag 'drm-misc-next-2020-04-23' of git://anongit.freedesktop.org/drm/drm-misc into drm-next
    
    drm-misc-next for 5.8:
    
    UAPI Changes:
    
    Cross-subsystem Changes:
    
     * MAINTAINERS: adapt several filenames to changes in panel code
     * arch/arm, fbdev: Use GPIO descriptors in sa11x0
     * dma-buf: Fix typo in documentation
    
    Core Changes:
    
     * drm: Don't free framebuffer in drm_gem_fb_init()
     * drm: Document struct drm_device.dev_private being deprecated
     * drm: Merged topic/phy-compliance-202004-08
    
    Driver Changes:
    
     * drm/adv7511: Add support for HDMI SPDIF and additional sampling rates
     * drm/ast: Allocate CRTC state of correct size
     * drm/panel: convert many driver bindings to DT schema; add port/ports property
              to bindings
     * drm/rockchip: Convert rk3066 bindings to YAML; spelling fixes
     * fbdev/arcfb: Call request_irq(), free_irq() at appropriate places
     * fbdev/controlfb: Support COMPILE_TEST; cleanups
     * fbdev/imxfb: Fix unbalanced enables/disables
     * fbdev/s1d13xxxfb: Call unregister_framebuffer()
     * fbdev/ssd1307fb: Use atomic PWM API, device properties and probe_new();
                        cleanups
     * fbdev/vesafb: Call release_region()
     * cleanups of includes, unused types/variables/fields, and fallthrough
    
    Signed-off-by: Dave Airlie <airlied@redhat.com>
    
    From: Thomas Zimmermann <tzimmermann@suse.de>
    Link: https://patchwork.freedesktop.org/patch/msgid/20200423083425.GA15883@linux-uq9g

commit e10daad5bb6e51395c505feafd869037090f9ca8
Author: Mauro Carvalho Chehab <mchehab+huawei@kernel.org>
Date:   Mon Apr 20 18:44:03 2020 +0200

    media: staging: rkisp1 Kconfig: depends on OF
    
    building it with a random config causes a warning:
    
    WARNING: unmet direct dependencies detected for PHY_ROCKCHIP_DPHY_RX0
      Depends on [n]: STAGING [=y] && STAGING_MEDIA [=y] && MEDIA_SUPPORT [=y] && (ARCH_ROCKCHIP || COMPILE_TEST [=y]) && OF [=n]
      Selected by [y]:
      - VIDEO_ROCKCHIP_ISP1 [=y] && STAGING [=y] && STAGING_MEDIA [=y] && MEDIA_SUPPORT [=y] && VIDEO_V4L2 [=y] && (ARCH_ROCKCHIP || COMPILE_TEST [=y])
    
    Reported-by: Randy Dunlap <rdunlap@infradead.org>
    Acked-by: Randy Dunlap <rdunlap@infradead.org> # build-tested
    Signed-off-by: Mauro Carvalho Chehab <mchehab+huawei@kernel.org>

commit a07a63b0e24dd1316d11427601a9f83dc955bb40
Author: Bartlomiej Zolnierkiewicz <b.zolnierkie@samsung.com>
Date:   Tue Mar 24 14:45:04 2020 +0100

    video: fbdev: controlfb: add COMPILE_TEST support
    
    Add COMPILE_TEST support to controlfb driver for better compile
    testing coverage.
    
    While at it:
    - convert driver to use eieio() and dcbf() helpers instead of
      open-coding them
    - add invalid_vram_cache() helper to avoid code duplication
    
    Acked-by: Sam Ravnborg <sam@ravnborg.org>
    Signed-off-by: Bartlomiej Zolnierkiewicz <b.zolnierkie@samsung.com>
    Link: https://patchwork.freedesktop.org/patch/msgid/20200324134508.25120-3-b.zolnierkie@samsung.com

commit 32ec783ae19d48084b893cc54747fed37b07eb0c
Author: Arnd Bergmann <arnd@arndb.de>
Date:   Wed Apr 8 21:02:57 2020 +0200

    firmware: imx: fix compile-testing
    
    It is nice to allow compile-testing the firmware drivers, but this
    fails when the dependency is a loadable module:
    
    aarch64-linux-ld: drivers/firmware/imx/scu-pd.o: in function `imx_sc_pd_power':
    scu-pd.c:(.text+0xd8): undefined reference to `imx_scu_call_rpc'
    aarch64-linux-ld: scu-pd.c:(.text+0x108): undefined reference to `imx_scu_call_rpc'
    aarch64-linux-ld: drivers/firmware/imx/scu-pd.o: in function `imx_sc_pd_probe':
    
    Change the dependencies to ensure that any driver we depend on is
    either reachable or we are compile-testing and it is disabled,
    effectively reverting most of the previous changes that turned
    out to be incorrect.
    
    Fixes: a9f85f93ed73 ("firmware: imx: add COMPILE_TEST support")
    Fixes: 5b00b8375416 ("firmware: imx: add COMPILE_TEST for IMX_SCU driver")
    Signed-off-by: Arnd Bergmann <arnd@arndb.de>
    Link: https://lore.kernel.org/r/20200408190314.695067-1-arnd@arndb.de
    Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>

commit 6af5797c76c11d8c08ae1f5a73c3711fcf89ab6f
Author: Mauro Carvalho Chehab <mchehab+huawei@kernel.org>
Date:   Fri Apr 17 08:49:06 2020 +0200

    media: cec: don't select PCI & DMI
    
    While select would be a great idea for most archs, this
    causes a breakage with s390:
    
            "I don't think that's a good idea, as it suddenly enables selecting all PCI
             drivers on platforms that do not have PCI.
    
                WARNING: unmet direct dependencies detected for PCI
                  Depends on [n]: HAVE_PCI [=n]
                  Selected by [m]:
                  - CEC_SECO [=m] && MEDIA_CEC_SUPPORT [=y] && (X86 || IA64 || COMPILE_TEST [=y])
    
    Reported-by: Geert Uytterhoeven <geert@linux-m68k.org>
    Signed-off-by: Mauro Carvalho Chehab <mchehab+huawei@kernel.org>

commit 022467444515c15ac8f3f690f3dff5f21d04c627
Author: Peter Ujfalusi <peter.ujfalusi@ti.com>
Date:   Fri Apr 3 17:19:50 2020 +0300

    dmaengine: ti: k3-udma: Drop COMPILE_TEST for the drivers for now
    
    It is not possible to compile test the UDMA stack right now due to
    dependencies to T_SCI_PROTOCOL and TI_SCI_INTA_IRQCHIP and their
    dependencies.
    
    Remove the COMPILE_TEST until it is actually possible to compile test the
    drivers.
    
    Reported-by: Linus Torvalds <torvalds@linux-foundation.org>
    Signed-off-by: Peter Ujfalusi <peter.ujfalusi@ti.com>
    Acked-by: Linus Torvalds <torvalds@linux-foundation.org>
    Link: https://lore.kernel.org/r/20200403141950.9359-1-peter.ujfalusi@ti.com
    Signed-off-by: Vinod Koul <vkoul@kernel.org>

commit 9393d050c860a8f03f1e04d380653d23c7911c90
Author: Mauro Carvalho Chehab <mchehab+huawei@kernel.org>
Date:   Wed Apr 15 09:46:06 2020 +0200

    Revert "media: Kconfig: move CEC-specific options to cec/Kconfig"
    
    The CEC_CORE symbols are selected by DRM, and should be
    independent of MEDIA_SUPPORT.
    
    Fixes this warning when doing "make multi_v7_defconfig":
    
            WARNING: unmet direct dependencies detected for CEC_CORE
              Depends on [m]: MEDIA_SUPPORT [=m]
              Selected by [y]:
              - DRM_TEGRA [=y] && HAS_IOMEM [=y] && (ARCH_TEGRA [=y] || ARM [=y] && COMPILE_TEST [=n]) && COMMON_CLK [=y] && DRM [=y] && OF [=y] && CEC_NOTIFIER [=y]
              Selected by [m]:
              - VIDEO_SAMSUNG_S5P_CEC [=m] && MEDIA_SUPPORT [=m] && MEDIA_PLATFORM_SUPPORT [=y] && CEC_PLATFORM_DRIVERS [=y] && (ARCH_EXYNOS [=y] || COMPILE_TEST [=n])
              - DRM_EXYNOS_HDMI [=y] && HAS_IOMEM [=y] && DRM_EXYNOS [=m] && (DRM_EXYNOS_MIXER [=y] || DRM_EXYNOS5433_DECON [=n]) && CEC_NOTIFIER [=y]
              - DRM_I2C_ADV7511_CEC [=y] && HAS_IOMEM [=y] && DRM [=y] && DRM_BRIDGE [=y] && DRM_I2C_ADV7511 [=m]
              - DRM_DW_HDMI [=m] && HAS_IOMEM [=y] && DRM [=y] && DRM_BRIDGE [=y] && CEC_NOTIFIER [=y]
    
    This reverts commit f1991411257bdb68d96ef8c8c5b35f412b480375.
    
    Reported-by: Stephen Rothwell <sfr@canb.auug.org.au>
    Signed-off-by: Mauro Carvalho Chehab <mchehab+huawei@kernel.org>

commit 6268b351394450e9168a9281a9279f7cb420669f
Author: Mauro Carvalho Chehab <mchehab+huawei@kernel.org>
Date:   Thu Mar 26 15:47:25 2020 +0100

    media: Kconfig: fix selection for test drivers
    
    There are some long-time mistakes related to build test
    drivers, with regards to depends on/select. Also, as we
    now want to build any test driver without needing to
    enable anything else, change the logic in order to properly
    filter them.
    
    Please notice that the PCI skeleton is somewhat an
    exception, as it requires to select *both* SAMPLES and
    MEDIA_TEST_SUPPORT. I almost changed it to be either one,
    but decided to keep it as-is, as this is something that
    we don't really need to be included on any distribution.
    
    The only reason for someone to build it is for COMPILE_TEST
    purposes.
    
    Signed-off-by: Mauro Carvalho Chehab <mchehab+huawei@kernel.org>

commit b753101a4ac0b906064a72feec43f5b80a1fe2e5
Merge: c7850ae4d71c 00d76a0c1943
Author: Linus Torvalds <torvalds@linux-foundation.org>
Date:   Sat Apr 11 09:46:12 2020 -0700

    Merge tag 'kbuild-v5.7-2' of git://git.kernel.org/pub/scm/linux/kernel/git/masahiroy/linux-kbuild
    
    Pull more Kbuild updates from Masahiro Yamada:
    
     - raise minimum supported binutils version to 2.23
    
     - remove old CONFIG_AS_* macros that we know binutils >= 2.23 supports
    
     - move remaining CONFIG_AS_* tests to Kconfig from Makefile
    
     - enable -Wtautological-compare warnings to catch more issues
    
     - do not support GCC plugins for GCC <= 4.7
    
     - fix various breakages of 'make xconfig'
    
     - include the linker version used for linking the kernel into
       LINUX_COMPILER, which is used for the banner, and also exposed to
       /proc/version
    
     - link lib-y objects to vmlinux forcibly when CONFIG_MODULES=y, which
       allows us to remove the lib-ksyms.o workaround, and to solve the last
       known issue of the LLVM linker
    
     - add dummy tools in scripts/dummy-tools/ to enable all compiler tests
       in Kconfig, which will be useful for distro maintainers
    
     - support the single switch, LLVM=1 to use Clang and all LLVM utilities
       instead of GCC and Binutils.
    
     - support LLVM_IAS=1 to enable the integrated assembler, which is still
       experimental
    
    * tag 'kbuild-v5.7-2' of git://git.kernel.org/pub/scm/linux/kernel/git/masahiroy/linux-kbuild: (36 commits)
      kbuild: fix comment about missing include guard detection
      kbuild: support LLVM=1 to switch the default tools to Clang/LLVM
      kbuild: replace AS=clang with LLVM_IAS=1
      kbuild: add dummy toolchains to enable all cc-option etc. in Kconfig
      kbuild: link lib-y objects to vmlinux forcibly when CONFIG_MODULES=y
      MIPS: fw: arc: add __weak to prom_meminit and prom_free_prom_memory
      kbuild: remove -I$(srctree)/tools/include from scripts/Makefile
      kbuild: do not pass $(KBUILD_CFLAGS) to scripts/mkcompile_h
      Documentation/llvm: fix the name of llvm-size
      kbuild: mkcompile_h: Include $LD version in /proc/version
      kconfig: qconf: Fix a few alignment issues
      kconfig: qconf: remove some old bogus TODOs
      kconfig: qconf: fix support for the split view mode
      kconfig: qconf: fix the content of the main widget
      kconfig: qconf: Change title for the item window
      kconfig: qconf: clean deprecated warnings
      gcc-plugins: drop support for GCC <= 4.7
      kbuild: Enable -Wtautological-compare
      x86: update AS_* macros to binutils >=2.23, supporting ADX and AVX2
      crypto: x86 - clean up poly1305-x86_64-cryptogams.S by 'make clean'
      ...

commit cb8d9937e85559ea0ad1f4f83df8ad1288fed47d
Author: kbuild test robot <lkp@intel.com>
Date:   Fri Apr 10 14:34:03 2020 -0700

    drivers/dma/tegra20-apb-dma.c: fix platform_get_irq.cocci warnings
    
    Remove dev_err() messages after platform_get_irq*() failures.
    platform_get_irq() already prints an error.
    
    Generated by: scripts/coccinelle/api/platform_get_irq.cocci
    
    Fixes: 6c41ac96ad92 ("dmaengine: tegra-apb: Support COMPILE_TEST")
    Signed-off-by: kbuild test robot <lkp@intel.com>
    Signed-off-by: Julia Lawall <julia.lawall@inria.fr>
    Signed-off-by: Andrew Morton <akpm@linux-foundation.org>
    Reviewed-by: Dmitry Osipenko <digetx@gmail.com>
    Acked-by: Thierry Reding <treding@nvidia.com>
    Cc: Laxman Dewangan <ldewangan@nvidia.com>
    Cc: Vinod Koul <vinod.koul@linux.intel.com>
    Cc: Stephen Warren <swarren@wwwdotorg.org>
    Cc: Jon Hunter <jonathanh@nvidia.com>
    Link: http://lkml.kernel.org/r/alpine.DEB.2.21.2002271133450.2973@hadrien
    Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>

commit 76426e238834f0927dee9925e8832179b8d56d6e
Author: Masahiro Yamada <masahiroy@kernel.org>
Date:   Wed Apr 8 00:53:52 2020 +0900

    kbuild: add dummy toolchains to enable all cc-option etc. in Kconfig
    
    Staring v4.18, Kconfig evaluates compiler capabilities, and hides CONFIG
    options your compiler does not support. This works well if you configure
    and build the kernel on the same host machine.
    
    It is inconvenient if you prepare the .config that is carried to a
    different build environment (typically this happens when you package
    the kernel for distros) because using a different compiler potentially
    produces different CONFIG options than the real build environment.
    So, you probably want to make as many options visible as possible.
    In other words, you need to create a super-set of CONFIG options that
    cover any build environment. If some of the CONFIG options turned out
    to be unsupported on the build machine, they are automatically disabled
    by the nature of Kconfig.
    
    However, it is not feasible to get a full-featured compiler for every
    arch.
    
    This issue was discussed here:
    
      https://lkml.org/lkml/2019/12/9/620
    
    Other than distros, savedefconfig is also a problem. Some arch sub-systems
    periodically resync defconfig files. If you use a less-capable compiler
    for savedefconfig, options that do not meet 'depends on $(cc-option,...)'
    will be forcibly disabled. So, 'make defconfig && make savedefconfig'
    may silently change the behavior.
    
    This commit adds a set of dummy toolchains that pretend to support any
    feature.
    
    Most of compiler features are tested by cc-option, which simply checks
    the exit code of $(CC). The dummy tools are shell scripts that always
    exit with 0. So, $(cc-option, ...) is evaluated as 'y'.
    
    There are more complicated checks such as:
    
      scripts/gcc-x86_{32,64}-has-stack-protector.sh
      scripts/gcc-plugin.sh
      scripts/tools-support-relr.sh
    
    scripts/dummy-tools/gcc passes all checks.
    
    From the top directory of the source tree, you can do:
    
       $ make CROSS_COMPILE=scripts/dummy-tools/ oldconfig
    
    Signed-off-by: Masahiro Yamada <masahiroy@kernel.org>
    Reviewed-by: Philipp Rudo <prudo@linux.ibm.com>
    Tested-by: Jeremy Cline <jcline@redhat.com>

commit 34183ddd13dbfa859c4b68d16a30aad2cce72b11
Merge: 8645f09bad14 11700fcb90b4
Author: Linus Torvalds <torvalds@linux-foundation.org>
Date:   Tue Apr 7 20:00:16 2020 -0700

    Merge tag 'thermal-v5.7-rc1' of git://git.kernel.org/pub/scm/linux/kernel/git/thermal/linux
    
    Pull thermal updates from Daniel Lezcano:
    
     - Convert tsens configuration DT binding to yaml (Rajeshwari)
    
     - Add interrupt support on the rcar sensor (Niklas Sderlund)
    
     - Add a new Spreadtrum thermal driver (Baolin Wang)
    
     - Add thermal binding for the fsl scu board, a new API to retrieve the
       sensor id bound to the thermal zone and i.MX system controller sensor
       (Anson Huang))
    
     - Remove warning log when a deferred probe is requested on Exynos
       (Marek Szyprowski)
    
     - Add the thermal monitoring unit support for imx8mm with its DT
       bindings (Anson Huang)
    
     - Rephrase the Kconfig text for clarity (Linus Walleij)
    
     - Use the gpio descriptor for the ti-soc-thermal (Linus Walleij)
    
     - Align msg structure to 4 bytes for i.MX SC, fix the Kconfig
       dependency, add the __may_be unused annotation for PM functions and
       the COMPILE_TEST option for imx8mm (Anson Huang)
    
     - Fix a dependency on regmap in Kconfig for qoriq (Yuantian Tang)
    
     - Add DT binding and support for the rcar gen3 r8a77961 and improve the
       error path on the rcar init function (Niklas Sderlund)
    
     - Cleanup and improvements for the tsens Qcom sensor (Amit Kucheria)
    
     - Improve code by removing lock and caching values in the rcar thermal
       sensor (Niklas Sderlund)
    
     - Cleanup in the qoriq drivers and add a call to
       imx_thermal_unregister_legacy_cooling in the removal function (Anson
       Huang)
    
     - Remove redundant 'maxItems' in tsens and sprd DT bindings (Rob
       Herring)
    
     - Change the thermal DT bindings by making the cooling-maps optional
       (Yuantian Tang)
    
     - Add Tiger Lake support (Sumeet Pawnikar)
    
     - Use scnprintf() for avoiding potential buffer overflow (Takashi Iwai)
    
     - Make pkg_temp_lock a raw_spinlock_t(Clark Williams)
    
     - Fix incorrect data types by changing them to signed on i.MX SC (Anson
       Huang)
    
     - Replace zero-length array with flexible-array member (Gustavo A. R.
       Silva)
    
     - Add support for i.MX8MP in the driver and in the DT bindings (Anson
       Huang)
    
     - Fix return value of the cpufreq_set_cur_state() function (Willy
       Wolff)
    
     - Remove abusing and scary WARN_ON in the cpufreq cooling device
       (Daniel Lezcano)
    
     - Fix build warning of incorrect argument type reported by sparse on
       imx8mm (Anson Huang)
    
     - Fix stub for the devfreq cooling device (Martin Blumenstingl)
    
     - Fix cpu idle cooling documentation (Sergey Vidishev)
    
    * tag 'thermal-v5.7-rc1' of git://git.kernel.org/pub/scm/linux/kernel/git/thermal/linux: (52 commits)
      Documentation: cpu-idle-cooling: Fix diagram for 33% duty cycle
      thermal: devfreq_cooling: inline all stubs for CONFIG_DEVFREQ_THERMAL=n
      thermal: imx8mm: Fix build warning of incorrect argument type
      thermal/drivers/cpufreq_cooling: Remove abusing WARN_ON
      thermal/drivers/cpufreq_cooling: Fix return of cpufreq_set_cur_state
      thermal: imx8mm: Add i.MX8MP support
      dt-bindings: thermal: imx8mm-thermal: Add support for i.MX8MP
      thermal: qcom: tsens.h: Replace zero-length array with flexible-array member
      thermal: imx_sc_thermal: Fix incorrect data type
      thermal: int340x_thermal: Use scnprintf() for avoiding potential buffer overflow
      thermal: int340x: processor_thermal: Add Tiger Lake support
      thermal/x86_pkg_temp: Make pkg_temp_lock a raw_spinlock_t
      dt-bindings: thermal: make cooling-maps property optional
      dt-bindings: thermal: qcom-tsens: Remove redundant 'maxItems'
      dt-bindings: thermal: sprd: Remove redundant 'maxItems'
      thermal: imx: Calling imx_thermal_unregister_legacy_cooling() in .remove
      thermal: qoriq: Sort includes alphabetically
      thermal: qoriq: Use devm_add_action_or_reset() to handle all cleanups
      thermal: rcar_thermal: Remove lock in rcar_thermal_get_current_temp()
      thermal: rcar_thermal: Do not store ctemp in rcar_thermal_priv
      ...

commit d5d247661e869b71e4db5ca69b08b9607895d496
Merge: f9db97d75187 9737e2c5f0bc
Author: Linus Torvalds <torvalds@linux-foundation.org>
Date:   Tue Apr 7 12:33:37 2020 -0700

    Merge tag 'for-linus' of git://github.com/openrisc/linux
    
    Pull OpenRISC updates from Stafford Horne:
     "A few cleanups all over the place, things of note:
    
       - Enable the clone3 syscall
    
       - Remove CONFIG_CROSS_COMPILE from Krzysztof Kozlowski
    
       - Update to use mmgrab from Julia Lawall"
    
    * tag 'for-linus' of git://github.com/openrisc/linux:
      openrisc: Remove obsolete show_trace_task function
      openrisc: Cleanup copy_thread_tls docs and comments
      openrisc: Enable the clone3 syscall
      openrisc: Convert copy_thread to copy_thread_tls
      openrisc: use mmgrab
      openrisc: configs: Cleanup CONFIG_CROSS_COMPILE

commit d18292dc07dbaaacef040a23a5e5e65c6ea61803
Merge: 0e8fb69f287b cedb414aa8c3
Author: Linus Torvalds <torvalds@linux-foundation.org>
Date:   Fri Apr 3 15:05:35 2020 -0700

    Merge tag 'arm-drivers-5.7' of git://git.kernel.org/pub/scm/linux/kernel/git/soc/soc
    
    Pull ARM driver updates from Arnd Bergmann:
     "These are the usual updates for SoC specific device drivers and
      related subsystems that don't have their own top-level maintainers:
    
       - ARM SCMI/SCPI updates to allow pluggable transport layers
    
       - TEE subsystem cleanups
    
       - A new driver for the Amlogic secure power domain controller
    
       - Various driver updates for the NXP Layerscape DPAA2, NXP i.MX SCU
         and TI OMAP2+ sysc drivers.
    
       - Qualcomm SoC driver updates, including a new library module for
         "protection domain" notifications
    
       - Lots of smaller bugfixes and cleanups in other drivers"
    
    * tag 'arm-drivers-5.7' of git://git.kernel.org/pub/scm/linux/kernel/git/soc/soc: (70 commits)
      soc: fsl: qe: fix sparse warnings for ucc_slow.c
      soc: fsl: qe: ucc_slow: remove 0 assignment for kzalloc'ed structure
      soc: fsl: qe: fix sparse warnings for ucc_fast.c
      soc: fsl: qe: fix sparse warnings for qe_ic.c
      soc: fsl: qe: fix sparse warnings for ucc.c
      soc: fsl: qe: fix sparse warning for qe_common.c
      soc: fsl: qe: fix sparse warnings for qe.c
      soc: qcom: Fix QCOM_APR dependencies
      soc: qcom: pdr: Avoid uninitialized use of found in pdr_indication_cb
      soc: imx: drop COMPILE_TEST for IMX_SCU_SOC
      firmware: imx: add COMPILE_TEST for IMX_SCU driver
      soc: imx: gpc: fix power up sequencing
      soc: imx: increase build coverage for imx8m soc driver
      soc: qcom: apr: Add avs/audio tracking functionality
      dt-bindings: soc: qcom: apr: Add protection domain bindings
      soc: qcom: Introduce Protection Domain Restart helpers
      devicetree: bindings: firmware: add ipq806x to qcom_scm
      memory: tegra: Correct debugfs clk rate-range on Tegra124
      memory: tegra: Correct debugfs clk rate-range on Tegra30
      memory: tegra: Correct debugfs clk rate-range on Tegra20
      ...

commit e109f506074152b7241bcbd3949a099e776cb802
Merge: e964f1e04a1c 025a06c1104c
Author: Linus Torvalds <torvalds@linux-foundation.org>
Date:   Thu Apr 2 16:45:46 2020 -0700

    Merge tag 'mtd/for-5.7' of git://git.kernel.org/pub/scm/linux/kernel/git/mtd/linux
    
    Pull MTD updates from Miquel Raynal:
     "MTD core changes:
       - Fix issue where write_cached_data() fails but write() still returns
         success
    
       - maps: sa1100-flash: Replace zero-length array with flexible-array
         member
    
       - phram: Fix a double free issue in error path
    
       - Convert fallthrough comments into statements
    
       - MAINTAINERS: Add the IRC channel to the MTD related subsystems
    
      Raw NAND core changes:
       - Add support for manufacturer specific suspend/resume operation
    
       - Add support for manufacturer specific lock/unlock operation
    
       - Replace zero-length array with flexible-array member
    
       - Fix a typo ("manufecturer")
    
       - Ensure nand_soft_waitrdy wait period is enough
    
      Raw NAND controller driver changes:
       - Brcmnand:
           * Add support for flash-edu for dma transfers (+ bindings)
    
       - Cadence:
           * Reinit completion before executing a new command
           * Change bad block marker size
           * Fix the calculation of the avaialble OOB size
           * Get meta data size from registers
    
       - Qualcom:
           * Use dma_request_chan() instead dma_request_slave_channel()
           * Release resources on failure within qcom_nandc_alloc()
    
       - Allwinner:
           * Use dma_request_chan() instead dma_request_slave_channel()
    
       - Marvell:
           * Use dma_request_chan() instead dma_request_slave_channel()
           * Release DMA channel on error
    
       - Freescale:
           * Use dma_request_chan() instead dma_request_slave_channel()
    
       - Macronix:
           * Add support for Macronix NAND randomizer (+ bindings)
    
       - Ams-delta:
           * Rename structures and functions to gpio_nand*
           * Make the driver custom I/O ready
           * Drop useless local variable
           * Support custom driver initialisation
           * Add module device tables
           * Handle more GPIO pins as optional
           * Make read pulses optional
           * Don't hardcode read/write pulse widths
           * Push inversion handling to gpiolib
           * Enable OF partition info support
           * Drop board specific partition info
           * Use struct gpio_nand_platdata
           * Write protect device during probe
    
       - Ingenic:
           * Use devm_platform_ioremap_resource()
           * Add dependency on MIPS || COMPILE_TEST
    
       - Denali:
           * Deassert write protect pin
    
       - ST:
           * Use dma_request_chan() instead dma_request_slave_channel()
    
      Raw NAND chip driver changes:
       - Toshiba:
           * Support reading the number of bitflips for BENAND (Built-in ECC NAND)
    
       - Macronix:
           * Add support for deep power down mode
           * Add support for block protection
    
      SPI-NAND core changes:
       - Do not erase the block before writing a bad block marker
    
       - Explicitly use MTD_OPS_RAW to write the bad block marker to OOB
    
       - Stop using spinand->oobbuf for buffering bad block markers
    
       - Rework detect procedure for different READ_ID operation
    
      SPI-NAND driver changes:
       - Toshiba:
           * Support for new Kioxia Serial NAND
           * Rename function name to change suffix and prefix (8Gbit)
           * Add comment about Kioxia ID
    
       - Micron:
           * Add new Micron SPI NAND devices with multiple dies
           * Add M70A series Micron SPI NAND devices
           * identify SPI NAND device with Continuous Read mode
           * Add new Micron SPI NAND devices
           * Describe the SPI NAND device MT29F2G01ABAGD
           * Generalize the OOB layout structure and function names
    
      SPI NOR core changes:
       - Move all the manufacturer specific quirks/code out of the core, to
         make the core logic more readable and thus ease maintenance.
    
       - Move the SFDP logic out of the core, it provides a better
         separation between the SFDP parsing and core logic.
    
       - Trim what is exposed in spi-nor.h. The SPI NOR controllers drivers
         must not be able to use structures that are meant just for the SPI
         NOR core.
    
       - Use the spi-mem direct mapping API to let advanced controllers
         optimize the read/write operations when they support direct
         mapping.
    
       - Add generic formula for the Status Register block protection
         handling. It fixes some long standing locking limitations and eases
         the addition of the 4bit block protection support.
    
       - Add block protection support for flashes with 4 block protection
         bits in the Status Register.
    
      SPI NOR controller drivers changes:
       - The mtk-quadspi driver is replaced by the new spi-mem spi-mtk-nor
         driver.
    
       - Merge tag 'mtk-mtd-spi-move' into spi-nor/next to avoid conflicts.
    
      HyperBus changes:
       - Print error msg when compatible is wrong or missing
    
       - Move mapping of direct access window from core to individual
         drivers"
    
    * tag 'mtd/for-5.7' of git://git.kernel.org/pub/scm/linux/kernel/git/mtd/linux: (103 commits)
      mtd: Convert fallthrough comments into statements
      mtd: rawnand: toshiba: Support reading the number of bitflips for BENAND (Built-in ECC NAND)
      MAINTAINERS: Add the IRC channel to the MTD related subsystems
      mtd: Fix issue where write_cached_data() fails but write() still returns success
      mtd: maps: sa1100-flash: Replace zero-length array with flexible-array member
      mtd: phram: fix a double free issue in error path
      mtd: spinand: toshiba: Support for new Kioxia Serial NAND
      mtd: spinand: toshiba: Rename function name to change suffix and prefix (8Gbit)
      mtd: rawnand: macronix: Add support for deep power down mode
      mtd: rawnand: Add support for manufacturer specific suspend/resume operation
      mtd: spi-nor: Enable locking for n25q512ax3/n25q512a
      mtd: spi-nor: Add SR 4bit block protection support
      mtd: spi-nor: Add generic formula for SR block protection handling
      mtd: spi-nor: Set all BP bits to one when lock_len == mtd->size
      mtd: spi-nor: controllers: aspeed-smc: Replace zero-length array with flexible-array member
      mtd: spi-nor: Clear WEL bit when erase or program errors occur
      MAINTAINERS: update entry after SPI NOR controller move
      mtd: spi-nor: Trim what is exposed in spi-nor.h
      mtd: spi-nor: Drop the MFR definitions
      mtd: spi-nor: Get rid of the now empty spi_nor_ids[] table
      ...

commit 11786191e2d946410cf5fde482b10cdd5356e76c
Merge: c6570114316f ef17f5193edd
Author: Linus Torvalds <torvalds@linux-foundation.org>
Date:   Thu Apr 2 15:45:45 2020 -0700

    Merge tag 'hwlock-v5.7' of git://git.kernel.org/pub/scm/linux/kernel/git/andersson/remoteproc
    
    Pull hwspinlock updates from Bjorn Andersson:
     "This marks all hwspinlock driver COMPILE_TESTable and replaces the
      zero-length array in hwspinlock_device with a flexible-array member"
    
    * tag 'hwlock-v5.7' of git://git.kernel.org/pub/scm/linux/kernel/git/andersson/remoteproc:
      hwspinlock: hwspinlock_internal.h: Replace zero-length array with flexible-array member
      hwspinlock: Allow drivers to be built with COMPILE_TEST

commit 5b67fbfc32b544daa7f4e0f4e0ecdec4e4895938
Merge: a16298439bd5 e51d8dacf272
Author: Linus Torvalds <torvalds@linux-foundation.org>
Date:   Tue Mar 31 16:03:39 2020 -0700

    Merge tag 'kbuild-v5.7' of git://git.kernel.org/pub/scm/linux/kernel/git/masahiroy/linux-kbuild
    
    Pull Kbuild updates from Masahiro Yamada:
     "Build system:
    
       - add CONFIG_UNUSED_KSYMS_WHITELIST, which will be useful to define a
         fixed set of export symbols for Generic Kernel Image (GKI)
    
       - allow to run 'make dt_binding_check' without .config
    
       - use full schema for checking DT examples in *.yaml files
    
       - make modpost fail for missing MODULE_IMPORT_NS(), which makes more
         sense because we know the produced modules are never loadable
    
       - Remove unused 'AS' variable
    
      Kconfig:
    
       - sanitize DEFCONFIG_LIST, and remove ARCH_DEFCONFIG from Kconfig
         files
    
       - relax the 'imply' behavior so that symbols implied by 'y' can
         become 'm'
    
       - make 'imply' obey 'depends on' in order to make 'imply' really weak
    
      Misc:
    
       - add documentation on building the kernel with Clang/LLVM
    
       - revive __HAVE_ARCH_STRLEN for 32bit sparc to use optimized strlen()
    
       - fix warning from deb-pkg builds when CONFIG_DEBUG_INFO=n
    
       - various script and Makefile cleanups"
    
    * tag 'kbuild-v5.7' of git://git.kernel.org/pub/scm/linux/kernel/git/masahiroy/linux-kbuild: (34 commits)
      Makefile: Update kselftest help information
      kbuild: deb-pkg: fix warning when CONFIG_DEBUG_INFO is unset
      kbuild: add outputmakefile to no-dot-config-targets
      kbuild: remove AS variable
      net: wan: wanxl: refactor the firmware rebuild rule
      net: wan: wanxl: use $(M68KCC) instead of $(M68KAS) for rebuilding firmware
      net: wan: wanxl: use allow to pass CROSS_COMPILE_M68k for rebuilding firmware
      kbuild: add comment about grouped target
      kbuild: add -Wall to KBUILD_HOSTCXXFLAGS
      kconfig: remove unused variable in qconf.cc
      sparc: revive __HAVE_ARCH_STRLEN for 32bit sparc
      kbuild: refactor Makefile.dtbinst more
      kbuild: compute the dtbs_install destination more simply
      Makefile: disallow data races on gcc-10 as well
      kconfig: make 'imply' obey the direct dependency
      kconfig: allow symbols implied by y to become m
      net: drop_monitor: use IS_REACHABLE() to guard net_dm_hw_report()
      modpost: return error if module is missing ns imports and MODULE_ALLOW_MISSING_NAMESPACE_IMPORTS=n
      modpost: rework and consolidate logging interface
      kbuild: allow to run dt_binding_check without kernel configuration
      ...

commit 699274b1a1272601eaa379973d10a503a60bef5d
Merge: 245bbe80e01b fca88925d769
Author: Miquel Raynal <miquel.raynal@bootlin.com>
Date:   Mon Mar 30 10:14:19 2020 +0200

    Merge tag 'nand/for-5.7' into mtd/next
    
    Raw NAND core changes:
    * Add support for manufacturer specific suspend/resume operation
    * Add support for manufacturer specific lock/unlock operation
    * Replace zero-length array with flexible-array member
    * Fix a typo ("manufecturer")
    * Ensure nand_soft_waitrdy wait period is enough
    
    Raw NAND controller driver changes:
    * Brcmnand:
    Add support for flash-edu for dma transfers (+ bindings)
    * Cadence:
    Reinit completion before executing a new command
    Change bad block marker size
    Fix the calculation of the avaialble OOB size
    Get meta data size from registers
    * Qualcom:
    Use dma_request_chan() instead dma_request_slave_channel()
    Release resources on failure within qcom_nandc_alloc()
    * Allwinner:
    Use dma_request_chan() instead dma_request_slave_channel()
    * Marvell:
    Use dma_request_chan() instead dma_request_slave_channel()
    Release DMA channel on error
    * Freescale:
    Use dma_request_chan() instead dma_request_slave_channel()
    * Macronix:
    Add support for Macronix NAND randomizer (+ bindings)
    * Ams-delta:
    Rename structures and functions to gpio_nand*
    Make the driver custom I/O ready
    Drop useless local variable
    Support custom driver initialisation
    Add module device tables
    Handle more GPIO pins as optional
    Make read pulses optional
    Don't hardcode read/write pulse widths
    Push inversion handling to gpiolib
    Enable OF partition info support
    Drop board specific partition info
    Use struct gpio_nand_platdata
    Write protect device during probe
    * Ingenic:
    Use devm_platform_ioremap_resource()
    Add dependency on MIPS || COMPILE_TEST
    * Denali:
    Deassert write protect pin
    * ST:
    Use dma_request_chan() instead dma_request_slave_channel()
    
    Raw NAND chip driver changes:
    * Toshiba:
    Support reading the number of bitflips for BENAND (Built-in ECC NAND)
    * Macronix:
    Add support for deep power down mode
    Add support for block protection
    
    SPI-NAND core changes:
    * Do not erase the block before writing a bad block marker
    * Explicitly use MTD_OPS_RAW to write the bad block marker to OOB
    * Stop using spinand->oobbuf for buffering bad block markers
    * Rework detect procedure for different READ_ID operation
    
    SPI-NAND driver changes:
    * Toshiba:
    Support for new Kioxia Serial NAND
    Rename function name to change suffix and prefix (8Gbit)
    Add comment about Kioxia ID
    * Micron:
    Add new Micron SPI NAND devices with multiple dies
    Add M70A series Micron SPI NAND devices
    identify SPI NAND device with Continuous Read mode
    Add new Micron SPI NAND devices
    Describe the SPI NAND device MT29F2G01ABAGD
    Generalize the OOB layout structure and function names

commit f76510b458a52023e96b3a700a97ffb526de17dc
Author: Michal Kubecek <mkubecek@suse.cz>
Date:   Sat Mar 28 00:01:53 2020 +0100

    ethtool: add timestamping related string sets
    
    Add three string sets related to timestamping information:
    
      ETH_SS_SOF_TIMESTAMPING: SOF_TIMESTAMPING_* flags
      ETH_SS_TS_TX_TYPES:      timestamping Tx types
      ETH_SS_TS_RX_FILTERS:    timestamping Rx filters
    
    These will be used for TIMESTAMP_GET request.
    
    v2: avoid compiler warning ("enumeration value not handled in switch")
        in net_hwtstamp_validate()
    
    v3: omit dash in Tx type names ("one-step-*" -> "onestep-*"), suggested by
        Richard Cochran
    
    Signed-off-by: Michal Kubecek <mkubecek@suse.cz>
    Acked-by: Richard Cochran <richardcochran@gmail.com>
    Signed-off-by: David S. Miller <davem@davemloft.net>

commit 63b903dfebdea92aa92ad337d8451a6fbfeabf9d
Author: Masahiro Yamada <masahiroy@kernel.org>
Date:   Thu Mar 26 14:57:15 2020 +0900

    net: wan: wanxl: use allow to pass CROSS_COMPILE_M68k for rebuilding firmware
    
    As far as I understood from the Kconfig help text, this build rule is
    used to rebuild the driver firmware, which runs on an old m68k-based
    chip. So, you need m68k tools for the firmware rebuild.
    
    wanxl.c is a PCI driver, but CONFIG_M68K does not select CONFIG_HAVE_PCI.
    So, you cannot enable CONFIG_WANXL_BUILD_FIRMWARE for ARCH=m68k. In other
    words, ifeq ($(ARCH),m68k) is false here.
    
    I am keeping the dead code for now, but rebuilding the firmware requires
    'as68k' and 'ld68k', which I do not have in hand.
    
    Instead, the kernel.org m68k GCC [1] successfully built it.
    
    Allowing a user to pass in CROSS_COMPILE_M68K= is handier.
    
    [1] https://mirrors.edge.kernel.org/pub/tools/crosstool/files/bin/x86_64/9.2.0/x86_64-gcc-9.2.0-nolibc-m68k-linux.tar.xz
    
    Suggested-by: Geert Uytterhoeven <geert@linux-m68k.org>
    Signed-off-by: Masahiro Yamada <masahiroy@kernel.org>

commit d3fd949abd3e3005dab7ccb185c3c8bc0ad639f1
Author: Shuah Khan <skhan@linuxfoundation.org>
Date:   Wed Mar 25 17:17:09 2020 -0600

    selftests: Fix memfd to support relocatable build (O=objdir)
    
    Fix memfd to support relocatable build (O=objdir). This calls out
    source files necessary to build tests and simplfies the dependency
    enforcement.
    
    Tested the following:
    
    Note that cross-build for fuse_mnt has dependency on -lfuse.
    
    make all
    make clean
    make kselftest-install O=/arm64_build/ ARCH=arm64 HOSTCC=gcc \
    CROSS_COMPILE=aarch64-linux-gnu- TARGETS=memfd
    
    Signed-off-by: Shuah Khan <skhan@linuxfoundation.org>

commit 860f0a7792a5abcaae047a114a8b24807ce0880f
Author: Shuah Khan <skhan@linuxfoundation.org>
Date:   Wed Mar 25 17:16:02 2020 -0600

    selftests: Fix seccomp to support relocatable build (O=objdir)
    
    Fix seccomp relocatable builds. This is a simple fix to use the
    right lib.mk variable TEST_GEN_PROGS. Local header dependency
    is addressed in a change to lib.mk as a framework change that
    enforces the dependency without requiring changes to individual
    tests.
    
    The following use-cases work with this change:
    
    In seccomp directory:
    make all and make clean
    
    From top level from main Makefile:
    make kselftest-install O=objdir ARCH=arm64 HOSTCC=gcc \
     CROSS_COMPILE=aarch64-linux-gnu- TARGETS=seccomp
    
    Signed-off-by: Shuah Khan <skhan@linuxfoundation.org>
    Acked-by: Kees Cook <keescook@chromium.org>
    Signed-off-by: Shuah Khan <skhan@linuxfoundation.org>

commit ffd0bbfb378ecd56eac22bf932ccdbf89ac7f725
Author: Baolin Wang <baolin.wang7@gmail.com>
Date:   Mon Feb 10 17:01:07 2020 +0800

    hwspinlock: Allow drivers to be built with COMPILE_TEST
    
    Allow drivers to be built with COMPILE_TEST.
    
    Signed-off-by: Baolin Wang <baolin.wang7@gmail.com>
    Link: https://lore.kernel.org/r/5a95c3de07ef020a4e2f2776fa5adb00637ee387.1581324976.git.baolin.wang7@gmail.com
    Signed-off-by: Bjorn Andersson <bjorn.andersson@linaro.org>

commit 90ae9ee792537e5a0018555d35b274b0a0b5e51d
Merge: 8f10e1ab5369 2a52651292ad
Author: Arnd Bergmann <arnd@arndb.de>
Date:   Wed Mar 25 13:36:09 2020 +0100

    Merge tag 'imx-drivers-5.7' of git://git.kernel.org/pub/scm/linux/kernel/git/shawnguo/linux into arm/drivers
    
    i.MX drivers update for 5.7:
    
     - Update SCU power domain driver to include PD ranges for audio, CM40
       I2C and INTMUX, also  enlarge PD range for mu_b.
     - Remove IMX_SC_RPC_SVC_ABORT from SCU API, as it was added by mistake.
     - Increase build test coverage for i.MX8M SoC and IMX_SCU driver.
     - Improve i.MX GPC power up sequencing to ensure that the reset is
       properly propagated through the peripheral devices in the power
       domain.
    
    * tag 'imx-drivers-5.7' of git://git.kernel.org/pub/scm/linux/kernel/git/shawnguo/linux:
      soc: imx: drop COMPILE_TEST for IMX_SCU_SOC
      firmware: imx: add COMPILE_TEST for IMX_SCU driver
      soc: imx: gpc: fix power up sequencing
      soc: imx: increase build coverage for imx8m soc driver
      firmware: imx: scu-pd: add power domain for I2C and INTMUX in CM40 SS
      firmware: imx: Remove IMX_SC_RPC_SVC_ABORT
      firmware: imx: scu-pd: enlarge PD range for mu_b
      firmware: imx: scu-pd: Add missing audio PD ranges
      soc: imx: gpcv2: include linux/sizes.h
    
    Link: https://lore.kernel.org/r/20200318051918.32579-1-shawnguo@kernel.org
    Signed-off-by: Arnd Bergmann <arnd@arndb.de>

commit 30a464a8dfee552e058c8f071a02a91baa79a9ff
Merge: a28e1c0505a0 975516250253
Author: Linus Walleij <linus.walleij@linaro.org>
Date:   Wed Mar 25 12:11:00 2020 +0100

    Merge tag 'gpio-updates-for-v5.7-part4' of git://git.kernel.org/pub/scm/linux/kernel/git/brgl/linux into devel
    
    gpio updates for v5.7 part 4
    
    - improve comments in the uapi header
    - fix documentation issues
    - add a warning to gpio-pl061 when the IRQ line is not configured
    - allow building gpio-mxc and gpio-mxs with COMPILE_TEST enabled
    - don't print an error message when an optional IRQ is missing in gpio-mvebu
    - fix a potential segfault in gpio-hammer
    - fix a couple typos and coding style issues in gpio tools
    - provide a new flag in gpio-mmio and use it in mt7621 to fix an issue with
      the controller ignoring value setting when a GPIO is in input mode
    - slightly refactor gpio_name_to_desc()

commit 6876ca311bfca5d7cae30c4b529aeb9449c072eb
Author: Anson Huang <Anson.Huang@nxp.com>
Date:   Mon Mar 9 09:57:38 2020 +0800

    gpio: mxs: add COMPILE_TEST support for GPIO_MXS
    
    Add COMPILE_TEST support to GPIO_MXS driver for better compile
    testing coverage.
    
    Signed-off-by: Anson Huang <Anson.Huang@nxp.com>
    Reported-by: kbuild test robot <lkp@intel.com>
    Signed-off-by: Bartosz Golaszewski <bgolaszewski@baylibre.com>

commit d4e9361442e23fe6edd4c1702004f19fc15553df
Author: Anson Huang <Anson.Huang@nxp.com>
Date:   Sat Mar 7 21:31:57 2020 +0800

    gpio: mxc: Add COMPILE_TEST support for GPIO_MXC
    
    Add COMPILE_TEST support to GPIO_MXC driver for better compile
    testing coverage.
    
    Signed-off-by: Anson Huang <Anson.Huang@nxp.com>
    Signed-off-by: Bartosz Golaszewski <bgolaszewski@baylibre.com>

commit 8d145da294a9371c050994bbe6fef98c91e3c072
Author: Julian Wiedmann <jwi@linux.ibm.com>
Date:   Wed Mar 18 13:54:51 2020 +0100

    s390/qeth: add SW timestamping support for IQD devices
    
    This adds support for SOF_TIMESTAMPING_TX_SOFTWARE.
    No support for non-IQD devices, since they orphan the skb in their xmit
    path.
    
    To play nice with TX bulking, set the timestamp when the buffer that
    contains the skb(s) is actually flushed out to HW.
    
    Signed-off-by: Julian Wiedmann <jwi@linux.ibm.com>
    Signed-off-by: David S. Miller <davem@davemloft.net>

commit a9f85f93ed735ebdacdaeb9652844b74c94c8c9c
Author: Anson Huang <Anson.Huang@nxp.com>
Date:   Fri Mar 6 23:42:32 2020 +0800

    firmware: imx: add COMPILE_TEST support
    
    Add COMPILE_TEST support to i.MX SCU drivers for better compile
    testing coverage.
    
    Signed-off-by: Anson Huang <Anson.Huang@nxp.com>
    Link: https://lore.kernel.org/r/1583509356-8265-1-git-send-email-Anson.Huang@nxp.com
    Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>

commit 863bba34d2f4c189a851643712cfc341ef7bcb8f
Author: Hou Zhiqiang <Zhiqiang.Hou@nxp.com>
Date:   Wed Mar 18 17:33:12 2020 +0800

    PCI: mobiveil: Fix unmet dependency warning for PCIE_MOBIVEIL_PLAT
    
    Fix the following warning by adding the dependency PCI_MSI_IRQ_DOMAIN
    to PCIE_MOBIVEIL_PLAT.
    
    WARNING: unmet direct dependencies detected for PCIE_MOBIVEIL_HOST
      Depends on [n]: PCI [=y] && PCI_MSI_IRQ_DOMAIN [=n]
      Selected by [y]:
      - PCIE_MOBIVEIL_PLAT [=y] && PCI [=y] && (ARCH_ZYNQMP || COMPILE_TEST [=y]) && OF [=y]
    
    Signed-off-by: Hou Zhiqiang <Zhiqiang.Hou@nxp.com>
    Signed-off-by: Lorenzo Pieralisi <lorenzo.pieralisi@arm.com>

commit 7098f5368268800a65cc45d91b42281dd0572514
Author: Alexandre Belloni <alexandre.belloni@bootlin.com>
Date:   Fri Mar 6 14:16:28 2020 +0100

    rtc: fsl-ftm-alarm: allow COMPILE_TEST
    
    Allow building building the driver with COMPILE_TEST.
    
    Link: https://lore.kernel.org/r/20200306131629.18837-1-alexandre.belloni@bootlin.com
    Signed-off-by: Alexandre Belloni <alexandre.belloni@bootlin.com>

commit b427ca8c663ea32c67702b2ff5fb19aabd57fa7f
Author: Anson Huang <Anson.Huang@nxp.com>
Date:   Mon Mar 2 16:13:05 2020 +0800

    rtc: snvs: Improve Kconfig dependency
    
    i.MX SNVS RTC should depend on ARCH_MXC or COMPILE_TEST.
    
    Signed-off-by: Anson Huang <Anson.Huang@nxp.com>
    Link: https://lore.kernel.org/r/1583136785-4973-1-git-send-email-Anson.Huang@nxp.com
    Signed-off-by: Alexandre Belloni <alexandre.belloni@bootlin.com>

commit 2a52651292ad9e642d205ce2ece2686d3b3395a7
Author: Peng Fan <peng.fan@nxp.com>
Date:   Mon Mar 16 11:09:02 2020 +0800

    soc: imx: drop COMPILE_TEST for IMX_SCU_SOC
    
    With COMPILE_TEST, there will be build error, because IMX_SCU
    might be set to n, so drop COMPILE_TEST.
    
    Suggested-by: Shawn Guo <shawnguo@kernel.org>
    Signed-off-by: Peng Fan <peng.fan@nxp.com>
    Signed-off-by: Shawn Guo <shawnguo@kernel.org>

commit 5b00b83754167ce060495aca3945a725b9190a15
Author: Anson Huang <Anson.Huang@nxp.com>
Date:   Sat Mar 7 09:25:54 2020 +0800

    firmware: imx: add COMPILE_TEST for IMX_SCU driver
    
    Add COMPILE_TEST support to IMX_SCU driver for better compile
    testing coverage.  Any driver depending on IMX_SCU shouldn't have
    COMPILE_TEST though.
    
    Signed-off-by: Anson Huang <Anson.Huang@nxp.com>
    Signed-off-by: Shawn Guo <shawnguo@kernel.org>

commit 52cbc58b3bad2d37286110ce3adc7441c2d3de81
Author: Anson Huang <Anson.Huang@nxp.com>
Date:   Fri Mar 6 23:37:37 2020 +0800

    thermal: Add COMPILE_TEST support for i.MX8MM
    
    Add COMPILE_TEST support to i.MX8MM thermal driver for better compile
    testing coverage.
    
    Signed-off-by: Anson Huang <Anson.Huang@nxp.com>
    Reviewed-by: Amit Kucheria <amit.kucheria@linaro.org>
    Signed-off-by: Daniel Lezcano <daniel.lezcano@linaro.org>
    Link: https://lore.kernel.org/r/1583509057-8197-1-git-send-email-Anson.Huang@nxp.com

commit ef502fc1f0ddac2c98aca58b255d9603cd20aa3d
Author: Anson Huang <Anson.Huang@nxp.com>
Date:   Tue Mar 3 16:04:44 2020 +0800

    thermal: Remove COMPILE_TEST for IMX_SC_THERMAL
    
    i.MX SCU thermal driver depends on IMX_SCU which does NOT have
    COMPILE_TEST enabled, so need to remove COMPILE_TEST for i.MX
    SCU thermal as well.
    
    Signed-off-by: Anson Huang <Anson.Huang@nxp.com>
    Reported-by: Stephen Rothwell <sfr@canb.auug.org.au>
    Signed-off-by: Daniel Lezcano <daniel.lezcano@linaro.org>
    Link: https://lore.kernel.org/r/1583222684-10229-2-git-send-email-Anson.Huang@nxp.com

commit caef2df1137adcea48b0902f310f4639b846e3a1
Author: John Garry <john.garry@huawei.com>
Date:   Thu Mar 12 01:35:15 2020 +0800

    spi: Stop selecting MTD_SPI_NOR for SPI_HISI_SFC_V3XX
    
    By selecting MTD_SPI_NOR for SPI_HISI_SFC_V3XX, we may introduce unmet
    dependencies:
    
    WARNING: unmet direct dependencies detected for MTD_SPI_NOR
      Depends on [m]: MTD [=m] && SPI_MASTER [=y]
      Selected by [y]:
      - SPI_HISI_SFC_V3XX [=y] && SPI [=y] && SPI_MASTER [=y] && (ARM64 && ACPI [=y] || COMPILE_TEST [=y]) && HAS_IOMEM [=y]
    
    Since MTD_SPI_NOR is only selected by SPI_HISI_SFC_V3XX for practical
    reasons - slave devices use the spi-nor driver, enabled by MTD_SPI_NOR -
    just drop it.
    
    Signed-off-by: John Garry <john.garry@huawei.com>
    
    Link: https://lore.kernel.org/r/1583948115-239907-1-git-send-email-john.garry@huawei.com
    Signed-off-by: Mark Brown <broonie@kernel.org>

commit e015d72f321e8b54aa3aef680e85dcd87f912703
Author: Paul Cercueil <paul@crapouillou.net>
Date:   Mon Mar 2 15:45:09 2020 -0300

    mtd: rawnand: ingenic: Add dependency on MIPS || COMPILE_TEST
    
    This driver has no arch-specific instructions but is only ever useful
    on MIPS; so disable this driver if we're not compiling for MIPS, unless
    the driver is compile-tested.
    
    Signed-off-by: Paul Cercueil <paul@crapouillou.net>
    Signed-off-by: Miquel Raynal <miquel.raynal@bootlin.com>
    Link: https://lore.kernel.org/linux-mtd/20200302184509.10666-1-paul@crapouillou.net

commit 79c57bffebe83ad0a7395f62596dc2e8d29a9ede
Merge: 1e09e5818b3a 434cebabd3a2
Author: David S. Miller <davem@davemloft.net>
Date:   Tue Mar 10 15:48:54 2020 -0700

    Merge branch 'enetc-Support-extended-BD-rings-at-runtime'
    
    Claudiu Manoil says:
    
    ====================
    enetc: Support extended BD rings at runtime
    
    First two patches are just misc code cleanup.
    The 3rd patch prepares the Rx BD processing code to be extended
    to processing both normal and extended BDs.
    The last one adds extended Rx BD support for timestamping
    without the need of a static config. Finally, the config option
    FSL_ENETC_HW_TIMESTAMPING can be dropped.
    Care was taken not to impact non-timestamping usecases.
    ====================
    
    Signed-off-by: David S. Miller <davem@davemloft.net>

commit 434cebabd3a2470881dd69fe65c0986c470b6fb8
Author: Claudiu Manoil <claudiu.manoil@nxp.com>
Date:   Tue Mar 10 14:51:24 2020 +0200

    enetc: Add dynamic allocation of extended Rx BD rings
    
    Hardware timestamping support (PTP) on Rx requires extended
    buffer descriptors, double the size of normal Rx descriptors.
    On the current controller revision only the timestamping offload
    requires extended Rx descriptors.
    Since Rx timestamping can be turned on/off at runtime, make Rx ring
    allocation configurable at runtime too. As a result, the static
    config option FSL_ENETC_HW_TIMESTAMPING can be dropped and the
    extended descriptors can be used only when Rx timestamping gets
    activated.
    The extension has the same size as the base descriptor, making
    the descriptor iterators easy to update for the extended case.
    
    Signed-off-by: Claudiu Manoil <claudiu.manoil@nxp.com>
    Signed-off-by: David S. Miller <davem@davemloft.net>

commit e08ab0b377a1489760533424437c5f4be7f484a4
Author: Yousuk Seung <ysseung@google.com>
Date:   Mon Mar 9 13:16:40 2020 -0700

    tcp: add bytes not sent to SCM_TIMESTAMPING_OPT_STATS
    
    Add TCP_NLA_BYTES_NOTSENT to SCM_TIMESTAMPING_OPT_STATS that reports
    bytes in the write queue but not sent. This is the same metric as
    what is exported with tcp_info.tcpi_notsent_bytes.
    
    Signed-off-by: Yousuk Seung <ysseung@google.com>
    Signed-off-by: Eric Dumazet <edumazet@google.com>
    Acked-by: Soheil Hassas Yeganeh <soheil@google.com>
    Acked-by: Yuchung Cheng <ycheng@google.com>
    Acked-by: Neal Cardwell <ncardwell@google.com>
    Signed-off-by: David S. Miller <davem@davemloft.net>

commit 66968d7dfc3f545185236ba7814f3a056f6b5099
Author: Anson Huang <Anson.Huang@nxp.com>
Date:   Sat Mar 7 21:42:27 2020 +0800

    irqchip: Add COMPILE_TEST support for IMX_INTMUX
    
    Add COMPILE_TEST support to IMX_INTMUX driver for better compile
    testing coverage.
    
    Signed-off-by: Anson Huang <Anson.Huang@nxp.com>
    Signed-off-by: Marc Zyngier <maz@kernel.org>
    Link: https://lore.kernel.org/r/1583588547-7164-1-git-send-email-Anson.Huang@nxp.com

commit 6135a891dc0bc43265cd583614419e04f3fd42b4
Author: Krzysztof Kozlowski <krzk@kernel.org>
Date:   Tue Mar 3 21:27:49 2020 +0100

    iommu/omap: Fix printing format for size_t on 64-bit
    
    Print size_t as %zu or %zx to fix -Wformat warnings when compiling on
    64-bit platform (e.g. with COMPILE_TEST):
    
        drivers/iommu/omap-iommu.c: In function flush_iotlb_page:
        drivers/iommu/omap-iommu.c:437:47: warning:
            format %x expects argument of type unsigned int,
            but argument 7 has type size_t {aka long unsigned int} [-Wformat=]
    
    Acked-by: Suman Anna <s-anna@ti.com>
    Signed-off-by: Krzysztof Kozlowski <krzk@kernel.org>
    Signed-off-by: Joerg Roedel <jroedel@suse.de>

commit f2ce16c3c15e90f8279ccda8deeb24682a4a3706
Author: Krzysztof Kozlowski <krzk@kernel.org>
Date:   Tue Mar 3 21:27:48 2020 +0100

    iommu/omap: Fix pointer cast -Wpointer-to-int-cast warnings on 64 bit
    
    pointers should be casted to unsigned long to avoid
    -Wpointer-to-int-cast warnings when compiling on 64-bit platform (e.g.
    with COMPILE_TEST):
    
        drivers/iommu/omap-iommu.c: In function omap2_iommu_enable:
        drivers/iommu/omap-iommu.c:170:25: warning:
            cast from pointer to integer of different size [-Wpointer-to-int-cast]
          if (!obj->iopgd || !IS_ALIGNED((u32)obj->iopgd,  SZ_16K))
                                 ^
    
    Signed-off-by: Krzysztof Kozlowski <krzk@kernel.org>
    Signed-off-by: Joerg Roedel <jroedel@suse.de>

commit 9eb81d69ad6bcd8a81933d02d402e80c8472ccf9
Author: Baolin Wang <baolin.wang7@gmail.com>
Date:   Tue Mar 3 11:32:15 2020 +0800

    pinctrl: sprd: Fix the kconfig warning
    
    On X86 plaform, if the CONFIG_OF is not selected, and set the
    CONFIG_SPRD_SC9860 as 'm', that will cause below waring:
    
    WARNING: unmet direct dependencies detected for PINCTRL_SPRD
      Depends on [n]: PINCTRL [=y] && OF [=n] && (ARCH_SPRD || COMPILE_TEST [=y])
      Selected by [m]:
      - PINCTRL_SPRD_SC9860 [=m] && PINCTRL [=y]
    
    Thus move the configuration dependency under CONFIG_PINCTRL_SPRD_SC9860
    to fix the warning.
    
    Reported-by: Randy Dunlap <rdunlap@infradead.org>
    Signed-off-by: Baolin Wang <baolin.wang7@gmail.com>
    Link: https://lore.kernel.org/r/eeb12d7843fb06f80e19f98eb25711231c3b610f.1583205650.git.baolin.wang7@gmail.com
    Acked-by: Randy Dunlap <rdunlap@infradead.org> # build-tested
    Signed-off-by: Linus Walleij <linus.walleij@linaro.org>

commit 9e24d63b054ba692129872c1acb9be7536fd1d45
Author: Bartlomiej Zolnierkiewicz <b.zolnierkie@samsung.com>
Date:   Thu Jan 16 15:58:08 2020 +0100

    video: fbdev: wm8505fb: add COMPILE_TEST support
    
    Add COMPILE_TEST support to wm8505fb driver for better compile
    testing coverage.
    
    Signed-off-by: Bartlomiej Zolnierkiewicz <b.zolnierkie@samsung.com>
    Acked-by: Sam Ravnborg <sam@ravnborg.org>
    Link: https://patchwork.freedesktop.org/patch/msgid/900c16b3-9306-7d17-f467-0f98bc95416a@samsung.com

commit ee5aca2e7167ee3feccc989ad609b64e698d5eb3
Author: Bartlomiej Zolnierkiewicz <b.zolnierkie@samsung.com>
Date:   Thu Jan 16 15:53:58 2020 +0100

    video: fbdev: w100fb: add COMPILE_TEST support
    
    Add COMPILE_TEST support to w100fb driver for better compile
    testing coverage.
    
    Signed-off-by: Bartlomiej Zolnierkiewicz <b.zolnierkie@samsung.com>
    Acked-by: Sam Ravnborg <sam@ravnborg.org>
    Link: https://patchwork.freedesktop.org/patch/msgid/a929db5e-d373-7b09-ae2b-efec227f7e85@samsung.com

commit 3d3287e609877aa549b1cbb41eafaf73c3742a0b
Author: Bartlomiej Zolnierkiewicz <b.zolnierkie@samsung.com>
Date:   Thu Jan 16 15:49:07 2020 +0100

    video: fbdev: arcfb: add COMPILE_TEST support
    
    Add COMPILE_TEST support to arcfb driver for better compile
    testing coverage.
    
    Signed-off-by: Bartlomiej Zolnierkiewicz <b.zolnierkie@samsung.com>
    Acked-by: Sam Ravnborg <sam@ravnborg.org>
    Link: https://patchwork.freedesktop.org/patch/msgid/acf2cc2e-614d-f0fb-ce40-cee62bfcde4c@samsung.com

commit 6df8627609fdc03e0824de47a3a3b8cec7324df5
Author: Bartlomiej Zolnierkiewicz <b.zolnierkie@samsung.com>
Date:   Thu Jan 16 15:51:57 2020 +0100

    video: fbdev: sh_mobile_lcdcfb: add COMPILE_TEST support
    
    Add COMPILE_TEST support to sh_mobile_lcdcfb driver for better compile
    testing coverage.
    
    Signed-off-by: Bartlomiej Zolnierkiewicz <b.zolnierkie@samsung.com>
    Reviewed-by: Geert Uytterhoeven <geert+renesas@glider.be>
    Link: https://patchwork.freedesktop.org/patch/msgid/d98fea18-b72e-6d0f-33ac-1421738bd12b@samsung.com

commit 6179b0e90cbc0117cd4ff994bc24f4ea417b11d7
Author: Anson Huang <Anson.Huang@nxp.com>
Date:   Mon Mar 2 19:55:18 2020 +0800

    regulator: anatop: Improve Kconfig dependency
    
    ANATOP regulator should depend on ARCH_MXC or COMPILE_TEST.
    
    Signed-off-by: Anson Huang <Anson.Huang@nxp.com>
    Link: https://lore.kernel.org/r/1583150118-8014-1-git-send-email-Anson.Huang@nxp.com
    Signed-off-by: Mark Brown <broonie@kernel.org>

commit cad9c2d28ec69f1d0370b2ba5abe309b0b709be4
Author: Quinn Tran <qutran@marvell.com>
Date:   Wed Feb 26 14:40:15 2020 -0800

    scsi: qla2xxx: Force semaphore on flash validation failure
    
    For single port 28XX adapter, the second core can still run in the
    background.  The flash semaphore can be held by the non-active core.
    This patch tell MPI FW to check for this case and clear the semaphore
    from the non-active core.
    
    Link: https://lore.kernel.org/r/20200226224022.24518-12-hmadhani@marvell.com
    Signed-off-by: Himanshu Madhani <hmadhani@marvell.com>
    Signed-off-by: Quinn Tran <qutran@marvell.com>
    Signed-off-by: Martin K. Petersen <martin.petersen@oracle.com>

commit b8bedd5bfaa6a1cc9df7c96d9723d9e7aa882f8d
Author: Chanwoo Choi <cw00.choi@samsung.com>
Date:   Thu Dec 12 11:20:30 2019 +0900

    PM / devfreq: rk3399_dmc: Add COMPILE_TEST and HAVE_ARM_SMCCC dependency
    
    [ Upstream commit eff5d31f7407fa9d31fb840106f1593399457298 ]
    
    To build test, add COMPILE_TEST depedency to both ARM_RK3399_DMC_DEVFREQ
    and DEVFREQ_EVENT_ROCKCHIP_DFI configuration. And ARM_RK3399_DMC_DEVFREQ
    used the SMCCC interface so that add HAVE_ARM_SMCCC dependency to prevent
    the build break.
    
    Reported-by: kbuild test robot <lkp@intel.com>
    Signed-off-by: Chanwoo Choi <cw00.choi@samsung.com>
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit c673faa159f76a78170a280b229beed6526b05bc
Author: Chanwoo Choi <cw00.choi@samsung.com>
Date:   Thu Dec 12 11:20:30 2019 +0900

    PM / devfreq: rk3399_dmc: Add COMPILE_TEST and HAVE_ARM_SMCCC dependency
    
    [ Upstream commit eff5d31f7407fa9d31fb840106f1593399457298 ]
    
    To build test, add COMPILE_TEST depedency to both ARM_RK3399_DMC_DEVFREQ
    and DEVFREQ_EVENT_ROCKCHIP_DFI configuration. And ARM_RK3399_DMC_DEVFREQ
    used the SMCCC interface so that add HAVE_ARM_SMCCC dependency to prevent
    the build break.
    
    Reported-by: kbuild test robot <lkp@intel.com>
    Signed-off-by: Chanwoo Choi <cw00.choi@samsung.com>
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit 6c41ac96ad9217fe2a6f31c9dcc31b97365b21f6
Author: Dmitry Osipenko <digetx@gmail.com>
Date:   Sun Feb 9 19:33:54 2020 +0300

    dmaengine: tegra-apb: Support COMPILE_TEST
    
    There is nothing arch-specific in the driver's code, so let's enable
    compile-testing for the driver.
    
    Signed-off-by: Dmitry Osipenko <digetx@gmail.com>
    Acked-by: Jon Hunter <jonathanh@nvidia.com>
    Link: https://lore.kernel.org/r/20200209163356.6439-18-digetx@gmail.com
    Signed-off-by: Vinod Koul <vkoul@kernel.org>

commit 5b4ab0153929ccdcb1b1072139d562aabf090a0b
Author: Chanwoo Choi <cw00.choi@samsung.com>
Date:   Thu Dec 12 11:20:30 2019 +0900

    PM / devfreq: rk3399_dmc: Add COMPILE_TEST and HAVE_ARM_SMCCC dependency
    
    [ Upstream commit eff5d31f7407fa9d31fb840106f1593399457298 ]
    
    To build test, add COMPILE_TEST depedency to both ARM_RK3399_DMC_DEVFREQ
    and DEVFREQ_EVENT_ROCKCHIP_DFI configuration. And ARM_RK3399_DMC_DEVFREQ
    used the SMCCC interface so that add HAVE_ARM_SMCCC dependency to prevent
    the build break.
    
    Reported-by: kbuild test robot <lkp@intel.com>
    Signed-off-by: Chanwoo Choi <cw00.choi@samsung.com>
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit d3db7b78e7d6762bfb9103598328d9c5fe616683
Author: Chanwoo Choi <cw00.choi@samsung.com>
Date:   Thu Dec 12 11:20:30 2019 +0900

    PM / devfreq: rk3399_dmc: Add COMPILE_TEST and HAVE_ARM_SMCCC dependency
    
    [ Upstream commit eff5d31f7407fa9d31fb840106f1593399457298 ]
    
    To build test, add COMPILE_TEST depedency to both ARM_RK3399_DMC_DEVFREQ
    and DEVFREQ_EVENT_ROCKCHIP_DFI configuration. And ARM_RK3399_DMC_DEVFREQ
    used the SMCCC interface so that add HAVE_ARM_SMCCC dependency to prevent
    the build break.
    
    Reported-by: kbuild test robot <lkp@intel.com>
    Signed-off-by: Chanwoo Choi <cw00.choi@samsung.com>
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit 0f6ca0c7842e36ad158e9c3a7d52f2c269a698a4
Author: Chanwoo Choi <cw00.choi@samsung.com>
Date:   Thu Dec 12 11:20:30 2019 +0900

    PM / devfreq: rk3399_dmc: Add COMPILE_TEST and HAVE_ARM_SMCCC dependency
    
    [ Upstream commit eff5d31f7407fa9d31fb840106f1593399457298 ]
    
    To build test, add COMPILE_TEST depedency to both ARM_RK3399_DMC_DEVFREQ
    and DEVFREQ_EVENT_ROCKCHIP_DFI configuration. And ARM_RK3399_DMC_DEVFREQ
    used the SMCCC interface so that add HAVE_ARM_SMCCC dependency to prevent
    the build break.
    
    Reported-by: kbuild test robot <lkp@intel.com>
    Signed-off-by: Chanwoo Choi <cw00.choi@samsung.com>
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit feb5d98e0a156274fbf334362f56359d19f614fa
Author: Vladimir Oltean <vladimir.oltean@nxp.com>
Date:   Fri Feb 21 16:46:24 2020 +0200

    enetc: remove "depends on (ARCH_LAYERSCAPE || COMPILE_TEST)"
    
    ARCH_LAYERSCAPE isn't needed for this driver, it builds and
    sends/receives traffic without this config option just fine.
    
    Signed-off-by: Vladimir Oltean <vladimir.oltean@nxp.com>
    Acked-by: Claudiu Manoil <claudiu.manoil@nxp.com>
    Signed-off-by: David S. Miller <davem@davemloft.net>

commit 72cf3b3df423c1bbd8fa1056fed009d3a260f8a9
Author: Nathan Chancellor <natechancellor@gmail.com>
Date:   Mon Feb 17 14:11:49 2020 -0700

    MIPS: vdso: Wrap -mexplicit-relocs in cc-option
    
    Clang does not support this option and errors out:
    
    clang-11: error: unknown argument: '-mexplicit-relocs'
    
    Clang does not appear to need this flag like GCC does because the jalr
    check that was added in commit 976c23af3ee5 ("mips: vdso: add build
    time check that no 'jalr t9' calls left") passes just fine with
    
    $ make ARCH=mips CC=clang CROSS_COMPILE=mipsel-linux-gnu- malta_defconfig arch/mips/vdso/
    
    even before commit d3f703c4359f ("mips: vdso: fix 'jalr t9' crash in
    vdso code").
    
    -mrelax-pic-calls has been supported since clang 9, which is the
    earliest version that could build a working MIPS kernel, and it is the
    default for clang so just leave it be.
    
    Fixes: d3f703c4359f ("mips: vdso: fix 'jalr t9' crash in vdso code")
    Link: https://github.com/ClangBuiltLinux/linux/issues/890
    Signed-off-by: Nathan Chancellor <natechancellor@gmail.com>
    Reviewed-by: Nick Desaulniers <ndesaulniers@google.com>
    Tested-by: Nick Desaulniers <ndesaulniers@google.com>
    Signed-off-by: Paul Burton <paulburton@kernel.org>
    Cc: Ralf Baechle <ralf@linux-mips.org>
    Cc: linux-mips@vger.kernel.org
    Cc: linux-kernel@vger.kernel.org
    Cc: clang-built-linux@googlegroups.com

commit 44144c809e39d64ff9931c7e8956c42b2baa89e6
Author: Guenter Roeck <linux@roeck-us.net>
Date:   Sat Feb 8 05:08:03 2020 -0800

    watchdog: da9062: Add dependency on I2C
    
    Since commit 057b52b4b3d58 ("watchdog: da9062: make restart handler atomic
    safe"), the driver calls i2c functions directly. It now therefore depends
    on I2C. This is a hard dependency which overrides COMPILE_TEST.
    
    Reported-by: kbuild test robot <lkp@intel.com>
    Reported-by: Randy Dunlap <rdunlap@infradead.org>
    Fixes: 057b52b4b3d58 ("watchdog: da9062: make restart handler atomic safe")
    Cc: Marco Felsch <m.felsch@pengutronix.de>
    Cc: Adam Thomson <Adam.Thomson.Opensource@diasemi.com>
    Cc: Stefan Lengfeld <contact@stefanchrist.eu>
    Reviewed-by: Marco Felsch <m.felsch@pengutronix.de>
    Acked-by: Randy Dunlap <rdunlap@infradead.org>
    Acked-by: Geert Uytterhoeven <geert@linux-m68k.org>
    Signed-off-by: Guenter Roeck <linux@roeck-us.net>
    Signed-off-by: Wim Van Sebroeck <wim@linux-watchdog.org>

commit b5cc96d3bfcbc495a350f78aa2e1295b238d26da
Author: Leonard Crestez <leonard.crestez@nxp.com>
Date:   Mon Jan 20 14:51:28 2020 +0200

    soc: imx: gpcv2: include linux/sizes.h
    
    This header is included indirectly on arm/arm64 but not on x86 so
    CONFIG_COMPILE_TEST breaks. Fix by including <linux/sizes.h> directly.
    
    Signed-off-by: Leonard Crestez <leonard.crestez@nxp.com>
    Signed-off-by: Shawn Guo <shawnguo@kernel.org>

commit 0d4416446897a91bb19ba837b97b607caea59a8f
Author: Geert Uytterhoeven <geert@linux-m68k.org>
Date:   Mon Feb 10 10:30:27 2020 +0100

    spi: pxa2xx: Enable support for compile-testing
    
    m68k/allmodconfig:
    
        WARNING: unmet direct dependencies detected for SPI_PXA2XX
          Depends on [n]: SPI [=y] && SPI_MASTER [=y] && (ARCH_PXA || ARCH_MMP || PCI [=n] || ACPI)
          Selected by [m]:
          - SND_SOC_INTEL_BDW_RT5677_MACH [=m] && SOUND [=m] && !UML && SND [=m] && SND_SOC [=m] && SND_SOC_INTEL_MACH [=y] && (SND_SOC_INTEL_HASWELL [=n] || SND_SOC_SOF_BROADWELL [=m]) && I2C [=m] && (I2C_DESIGNWARE_PLATFORM [=m] || COMPILE_TEST [=y]) && (GPIOLIB [=y] || COMPILE_TEST [=y]) && (X86_INTEL_LPSS || COMPILE_TEST [=y]) && SPI_MASTER [=y]
    
    This happens because SND_SOC_INTEL_BDW_RT5677_MACH selects SPI_PXA2XX,
    and the former depends on COMPILE_TEST, while the latter does not.
    
    Fix this by enabling compile-testing for SPI_PXA2XX.
    
    Fixes: 630db1549356f644 ("ASoC: Intel: bdw-rt5677: fix Kconfig dependencies")
    Signed-off-by: Geert Uytterhoeven <geert@linux-m68k.org>
    Reviewed-by: Pierre-Louis Bossart <pierre-louis.bossart@linux.intel.com>
    Link: https://lore.kernel.org/r/20200210093027.6672-1-geert@linux-m68k.org
    Signed-off-by: Mark Brown <broonie@kernel.org>

commit 0cbb4f9c69827decf56519c2f63918f16904ede5
Author: Stephen Boyd <swboyd@chromium.org>
Date:   Mon Feb 3 09:46:19 2020 -0800

    platform/chrome: wilco_ec: Include asm/unaligned instead of linux/ path
    
    It seems that we shouldn't try to include the include/linux/ path to
    unaligned functions. Just include asm/unaligned.h instead so that we
    don't run into compilation warnings like below.
    
       In file included from drivers/platform/chrome/wilco_ec/properties.c:8:0:
       include/linux/unaligned/le_memmove.h:7:19: error: redefinition of 'get_unaligned_le16'
        static inline u16 get_unaligned_le16(const void *p)
                          ^~~~~~~~~~~~~~~~~~
       In file included from arch/ia64/include/asm/unaligned.h:5:0,
                        from arch/ia64/include/asm/io.h:23,
                        from arch/ia64/include/asm/smp.h:21,
                        from include/linux/smp.h:68,
                        from include/linux/percpu.h:7,
                        from include/linux/arch_topology.h:9,
                        from include/linux/topology.h:30,
                        from include/linux/gfp.h:9,
                        from include/linux/xarray.h:14,
                        from include/linux/radix-tree.h:18,
                        from include/linux/idr.h:15,
                        from include/linux/kernfs.h:13,
                        from include/linux/sysfs.h:16,
                        from include/linux/kobject.h:20,
                        from include/linux/device.h:16,
                        from include/linux/platform_data/wilco-ec.h:11,
                        from drivers/platform/chrome/wilco_ec/properties.c:6:
       include/linux/unaligned/le_struct.h:7:19: note: previous definition of 'get_unaligned_le16' was here
        static inline u16 get_unaligned_le16(const void *p)
                          ^~~~~~~~~~~~~~~~~~
    Reported-by: kbuild test robot <lkp@intel.com>
    Fixes: 60fb8a8e93ca ("platform/chrome: wilco_ec: Allow wilco to be compiled in COMPILE_TEST")
    Signed-off-by: Stephen Boyd <swboyd@chromium.org>
    Signed-off-by: Enric Balletbo i Serra <enric.balletbo@collabora.com>

commit 3508aae9b5618aca727f07c183e25d09033a5b66
Author: Krzysztof Kozlowski <krzk@kernel.org>
Date:   Thu Jan 30 20:55:25 2020 +0100

    ARM: configs: Cleanup old Kconfig options
    
    CONFIG_MMC_BLOCK_BOUNCE is gone since commit c3dccb74be28 ("mmc: core:
    Delete bounce buffer Kconfig option").
    
    CONFIG_LBDAF is gone since commit 72deb455b5ec ("block: remove
    CONFIG_LBDAF").
    
    CONFIG_IOSCHED_DEADLINE and CONFIG_IOSCHED_CFQ are gone since
    commit f382fb0bcef4 ("block: remove legacy IO schedulers").
    
    The IOSCHED_DEADLINE was replaced by MQ_IOSCHED_DEADLINE and it will be
    now enabled by default (along with MQ_IOSCHED_KYBER).
    
    The IOSCHED_BFQ seems to replace IOSCHED_CFQ so select it in configs
    previously choosing the latter.
    
    CONFIG_CROSS_COMPILE is gone since commit f1089c92da79 ("kbuild: remove
    CONFIG_CROSS_COMPILE support").
    
    Link: https://lore.kernel.org/r/20200130195525.4525-2-krzk@kernel.org
    Signed-off-by: Krzysztof Kozlowski <krzk@kernel.org>
    Acked-by: Arnd Bergmann <arnd@arndb.de>
    Signed-off-by: Olof Johansson <olof@lixom.net>

commit 0b06c373db8a80c0dfccaa55728892702aaefb41
Author: Krzysztof Kozlowski <krzk@kernel.org>
Date:   Fri Jan 3 17:39:25 2020 +0100

    parisc: Use proper printk format for resource_size_t
    
    [ Upstream commit 4f80b70e1953cb846dbdd1ce72cb17333d4c8d11 ]
    
    resource_size_t should be printed with its own size-independent format
    to fix warnings when compiling on 64-bit platform (e.g. with
    COMPILE_TEST):
    
        arch/parisc/kernel/drivers.c: In function 'print_parisc_device':
        arch/parisc/kernel/drivers.c:892:9: warning:
            format '%p' expects argument of type 'void *',
            but argument 4 has type 'resource_size_t {aka unsigned int}' [-Wformat=]
    
    Signed-off-by: Krzysztof Kozlowski <krzk@kernel.org>
    Signed-off-by: Helge Deller <deller@gmx.de>
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit 4c7d00ccf40db99bfb7bd1857bcbf007275704d8
Merge: 18ea671ba40b 9871abffc810
Author: Linus Torvalds <torvalds@linux-foundation.org>
Date:   Wed Feb 5 18:11:51 2020 +0000

    Merge tag 'pwm/for-5.6-rc1' of git://git.kernel.org/pub/scm/linux/kernel/git/thierry.reding/linux-pwm
    
    Pull pwm updates from Thierry Reding:
     "Mostly cleanups and minor improvements with some new chip support for
      some drivers"
    
    * tag 'pwm/for-5.6-rc1' of git://git.kernel.org/pub/scm/linux/kernel/git/thierry.reding/linux-pwm: (37 commits)
      pwm: Remove set but not set variable 'pwm'
      pwm: sun4i: Initialize variables before use
      pwm: stm32: Remove automatic output enable
      pwm: sun4i: Narrow scope of local variable
      pwm: bcm2835: Allow building for ARCH_BRCMSTB
      pwm: imx27: Eliminate error message for defer probe
      pwm: sun4i: Fix inconsistent IS_ERR and PTR_ERR
      pwm: sun4i: Move pwm_calculate() out of spin_lock()
      pwm: omap-dmtimer: Allow compiling with COMPILE_TEST
      pwm: omap-dmtimer: put_device() after of_find_device_by_node()
      pwm: omap-dmtimer: Simplify error handling
      pwm: omap-dmtimer: Remove PWM chip in .remove before making it unfunctional
      pwm: Implement tracing for .get_state() and .apply_state()
      pwm: rcar: Document inability to set duty_cycle = 0
      pwm: rcar: Drop useless call to pwm_get_state()
      pwm: Fix minor Kconfig whitespace issues
      pwm: atmel: Implement .get_state()
      pwm: atmel: Use register accessors for channels
      pwm: atmel: Document known weaknesses of both hardware and software
      pwm: atmel: Replace loop in prescale calculation by ad-hoc calculation
      ...

commit a618848babc37ebc6d11f6df57a17e71e2d6bc28
Author: Krzysztof Kozlowski <krzk@kernel.org>
Date:   Fri Jan 3 17:39:25 2020 +0100

    parisc: Use proper printk format for resource_size_t
    
    [ Upstream commit 4f80b70e1953cb846dbdd1ce72cb17333d4c8d11 ]
    
    resource_size_t should be printed with its own size-independent format
    to fix warnings when compiling on 64-bit platform (e.g. with
    COMPILE_TEST):
    
        arch/parisc/kernel/drivers.c: In function 'print_parisc_device':
        arch/parisc/kernel/drivers.c:892:9: warning:
            format '%p' expects argument of type 'void *',
            but argument 4 has type 'resource_size_t {aka unsigned int}' [-Wformat=]
    
    Signed-off-by: Krzysztof Kozlowski <krzk@kernel.org>
    Signed-off-by: Helge Deller <deller@gmx.de>
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit 13426feaf46c48fcddb591e89d35120fcc90527f
Author: Geert Uytterhoeven <geert@linux-m68k.org>
Date:   Tue Feb 4 14:18:57 2020 +0100

    ASoC: wcd934x: Add missing COMMON_CLK dependency to SND_SOC_ALL_CODECS
    
    Just adding a dependency on COMMON_CLK to SND_SOC_WCD934X is not
    sufficient, as enabling SND_SOC_ALL_CODECS will still select it,
    breaking the build later:
    
        WARNING: unmet direct dependencies detected for SND_SOC_WCD934X
          Depends on [n]: SOUND [=m] && !UML && SND [=m] && SND_SOC [=m] && COMMON_CLK [=n] && MFD_WCD934X [=m]
          Selected by [m]:
          - SND_SOC_ALL_CODECS [=m] && SOUND [=m] && !UML && SND [=m] && SND_SOC [=m] && COMPILE_TEST [=y] && MFD_WCD934X [=m]
        ...
        ERROR: "of_clk_add_provider" [sound/soc/codecs/snd-soc-wcd934x.ko] undefined!
        ERROR: "of_clk_src_simple_get" [sound/soc/codecs/snd-soc-wcd934x.ko] undefined!
        ERROR: "clk_hw_register" [sound/soc/codecs/snd-soc-wcd934x.ko] undefined!
        ERROR: "__clk_get_name" [sound/soc/codecs/snd-soc-wcd934x.ko] undefined!
    
    Fix this by adding the missing dependency to SND_SOC_ALL_CODECS
    
    Fixes: 42b716359beca106 ("ASoC: wcd934x: Add missing COMMON_CLK dependency")
    Signed-off-by: Geert Uytterhoeven <geert@linux-m68k.org>
    Tested-by: Stephen Rothwell <sfr@canb.auug.org.au>
    Link: https://lore.kernel.org/r/20200204131857.7634-1-geert@linux-m68k.org
    Signed-off-by: Mark Brown <broonie@kernel.org>

commit 79703e014ba02ad86af4bcdf0c16e4b208cca406
Merge: eadc4e40e688 034dbec179e5
Author: Linus Torvalds <torvalds@linux-foundation.org>
Date:   Tue Feb 4 07:17:41 2020 +0000

    Merge tag 'tag-chrome-platform-for-v5.6' of git://git.kernel.org/pub/scm/linux/kernel/git/chrome-platform/linux
    
    Pull chrome platform updates from Benson Leung:
     "CrOS EC:
    
       - Refactoring of some of cros_ec's headers:
    
         include/linux/mfd/cros_ec.h now removed, new cros_ec.h added to
         drivers/platform/chrome which contains shared operations of cros_ec
         transport drivers.
    
       - Response tracing in cros_ec_proto
    
      Wilco EC:
    
       - Fix unregistration order.
    
       - Fix keyboard backlight probing on systems without keyboard
         backlight
    
       - Minor cleanup (newlines in printks, COMPILE_TEST)
    
      Misc:
    
       - chromeos_laptop converted to use i2c_new_scanned_device instead of
         i2c_new_probed_device"
    
    * tag 'tag-chrome-platform-for-v5.6' of git://git.kernel.org/pub/scm/linux/kernel/git/chrome-platform/linux:
      platform/chrome: cros_ec: Match implementation with headers
      platform/chrome: cros_ec: Drop unaligned.h include
      platform/chrome: wilco_ec: Allow wilco to be compiled in COMPILE_TEST
      platform/chrome: wilco_ec: Add newlines to printks
      platform/chrome: wilco_ec: Fix unregistration order
      cros_ec: treewide: Remove 'include/linux/mfd/cros_ec.h'
      platform/chrome: cros_ec_ishtp: Make init_lock static
      platform/chrome: chromeos_laptop: Convert to i2c_new_scanned_device
      platform/chrome: cros_ec_lpc: Use platform_get_irq_optional() for optional IRQs
      platform/chrome: cros_ec_proto: Add response tracing
      platform/chrome: cros_ec_trace: Match trace commands with EC commands

commit a6c5729b0ae1164326c8899a67a40cbe4325e82e
Author: Krzysztof Kozlowski <krzk@kernel.org>
Date:   Fri Jan 31 09:28:33 2020 +0100

    openrisc: configs: Cleanup CONFIG_CROSS_COMPILE
    
    CONFIG_CROSS_COMPILE is gone since commit f1089c92da79 ("kbuild: remove
    CONFIG_CROSS_COMPILE support").
    
    Signed-off-by: Krzysztof Kozlowski <krzk@kernel.org>
    Signed-off-by: Stafford Horne <shorne@gmail.com>

commit 8bea0dfb4a820ae063568a87cc2e7d8f587377af
Author: Giovanni Gherdovich <ggherdovich@suse.cz>
Date:   Wed Jan 22 16:16:14 2020 +0100

    x86, sched: Add support for frequency invariance on XEON_PHI_KNL/KNM
    
    The scheduler needs the ratio freq_curr/freq_max for frequency-invariant
    accounting. On Xeon Phi CPUs set freq_max to the second-highest frequency
    reported by the CPU.
    
    Xeon Phi CPUs such as Knights Landing and Knights Mill typically have either
    one or two turbo frequencies; in the former case that's 100 MHz above the base
    frequency, in the latter case the two levels are 100 MHz and 200 MHz above
    base frequency.
    
    We set freq_max to the second-highest frequency reported by the CPU. This
    could be the base frequency (if only one turbo level is available) or the first
    turbo level (if two levels are available). The rationale is to compromise
    between power efficiency or performance -- going straight to max turbo would
    favor efficiency and blindly using base freq would favor performance.
    
    For reference, this is how MSR_TURBO_RATIO_LIMIT must be parsed on a Xeon Phi
    to get the available frequencies (taken from a comment in turbostat's sources):
    
        [0] -- Reserved
        [7:1] -- Base value of number of active cores of bucket 1.
        [15:8] -- Base value of freq ratio of bucket 1.
        [20:16] -- +ve delta of number of active cores of bucket 2.
        i.e. active cores of bucket 2 =
        active cores of bucket 1 + delta
        [23:21] -- Negative delta of freq ratio of bucket 2.
        i.e. freq ratio of bucket 2 =
        freq ratio of bucket 1 - delta
        [28:24]-- +ve delta of number of active cores of bucket 3.
        [31:29]-- -ve delta of freq ratio of bucket 3.
        [36:32]-- +ve delta of number of active cores of bucket 4.
        [39:37]-- -ve delta of freq ratio of bucket 4.
        [44:40]-- +ve delta of number of active cores of bucket 5.
        [47:45]-- -ve delta of freq ratio of bucket 5.
        [52:48]-- +ve delta of number of active cores of bucket 6.
        [55:53]-- -ve delta of freq ratio of bucket 6.
        [60:56]-- +ve delta of number of active cores of bucket 7.
        [63:61]-- -ve delta of freq ratio of bucket 7.
    
    1. PERFORMANCE EVALUATION: TBENCH +5%
    2. NEUTRAL BENCHMARKS (ALL OTHERS)
    3. TEST SETUP
    
    1. PERFORMANCE EVALUATION: TBENCH +5%
    -------------------------------------
    
    A performance evaluation was conducted on a Knights Mill machine (see "Test
    Setup" below), were the frequency-invariance patch (on schedutil) is compared
    to both non-invariant schedutil and active intel_pstate with powersave: all
    three tested kernels behave the same performance-wise and with regard to power
    consumption (performance per watt). The only notable difference is tbench:
    
    comparison ratio of performance with baseline; 1.00 means neutral,
    higher is better:
    
                          I_PSTATE      FREQ-INV
        ----------------------------------------
        tbench                1.04          1.05
    
    performance-per-watt ratios with baseline; 1.00 means neutral, higher is better:
    
                          I_PSTATE      FREQ-INV
        ----------------------------------------
        tbench                1.03          1.04
    
    which essentially means that frequency-invariant schedutil is 5% better than
    baseline, the same as intel_pstate+powersave.
    
    As the results above are averaged over the varying parameter, here the detailed
    table.
    
    Varying parameter  : number of clients
    Unit               : MB/sec (higher is better)
    
                        5.2.0 vanilla (BASELINE)                 5.2.0 intel_pstate                     5.2.0 freq-inv
    - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
    Hmean   1         49.06  +- 2.12% (        )         51.66  +- 1.52% (   5.30%)         52.87  +- 0.88% (   7.76%)
    Hmean   2         93.82  +- 0.45% (        )        103.24  +- 0.70% (  10.05%)        105.90  +- 0.70% (  12.88%)
    Hmean   4        192.46  +- 1.15% (        )        215.95  +- 0.60% (  12.21%)        215.78  +- 1.43% (  12.12%)
    Hmean   8        406.74  +- 2.58% (        )        438.58  +- 0.36% (   7.83%)        437.61  +- 0.97% (   7.59%)
    Hmean   16       857.70  +- 1.22% (        )        890.26  +- 0.72% (   3.80%)        889.11  +- 0.73% (   3.66%)
    Hmean   32      1760.10  +- 0.92% (        )       1791.70  +- 0.44% (   1.79%)       1787.95  +- 0.44% (   1.58%)
    Hmean   64      3183.50  +- 0.34% (        )       3183.19  +- 0.36% (  -0.01%)       3187.53  +- 0.36% (   0.13%)
    Hmean   128     4830.96  +- 0.31% (        )       4846.53  +- 0.30% (   0.32%)       4855.86  +- 0.30% (   0.52%)
    Hmean   256     5467.98  +- 0.38% (        )       5793.80  +- 0.28% (   5.96%)       5821.94  +- 0.17% (   6.47%)
    Hmean   512     5398.10  +- 0.06% (        )       5745.56  +- 0.08% (   6.44%)       5503.68  +- 0.07% (   1.96%)
    Hmean   1024    5290.43  +- 0.63% (        )       5221.07  +- 0.47% (  -1.31%)       5277.22  +- 0.80% (  -0.25%)
    Hmean   1088    5139.71  +- 0.57% (        )       5236.02  +- 0.71% (   1.87%)       5190.57  +- 0.41% (   0.99%)
    
    2. NEUTRAL BENCHMARKS (ALL OTHERS)
    ----------------------------------
    
    * pgbench (both read/write and read-only)
    * NASA Parallel Benchmarks (NPB), MPI or OpenMP for message-passing
    * hackbench
    * netperf
    * dbench
    * kernbench
    * gitsource (git unit test suite)
    
    3. TEST SETUP
    -------------
    
    Test machine:
    
    CPU Model   : Intel Xeon Phi CPU 7255 @ 1.10GHz (a.k.a. Knights Mill)
    Fam/Mod/Ste : 6:133:0
    Topology    : 1 socket, 68 cores / 272 threads
    Memory      : 96G
    Storage     : rotary, XFS filesystem
    
    Max EFFICiency, BASE frequency and available turbo levels (MHz):
    
        EFFIC   1000 |**********
        BASE    1100 |***********
        68C     1100 |***********
        30C     1200 |************
    
    Tested kernels:
    
    Baseline      : v5.2,              intel_pstate passive,  schedutil
    Comparison #1 : v5.2,              intel_pstate active ,  powersave
    Comparison #2 : v5.2, this patch,  intel_pstate passive,  schedutil
    
    Signed-off-by: Giovanni Gherdovich <ggherdovich@suse.cz>
    Signed-off-by: Peter Zijlstra (Intel) <peterz@infradead.org>
    Signed-off-by: Ingo Molnar <mingo@kernel.org>
    Acked-by: Rafael J. Wysocki <rafael.j.wysocki@intel.com>
    Link: https://lkml.kernel.org/r/20200122151617.531-4-ggherdovich@suse.cz

commit 2a0abc59699896f03bf6f16efb8a3a490511216f
Author: Giovanni Gherdovich <ggherdovich@suse.cz>
Date:   Wed Jan 22 16:16:13 2020 +0100

    x86, sched: Add support for frequency invariance on SKYLAKE_X
    
    The scheduler needs the ratio freq_curr/freq_max for frequency-invariant
    accounting. On SKYLAKE_X CPUs set freq_max to the highest frequency that can
    be sustained by a group of at least 4 cores.
    
    From the changelog of commit 31e07522be56 ("tools/power turbostat: fix
    decoding for GLM, DNV, SKX turbo-ratio limits"):
    
     >   Newer processors do not hard-code the the number of cpus in each bin
     >   to {1, 2, 3, 4, 5, 6, 7, 8}  Rather, they can specify any number
     >   of CPUS in each of the 8 bins:
     >
     >   eg.
     >
     >   ...
     >   37 * 100.0 = 3600.0 MHz max turbo 4 active cores
     >   38 * 100.0 = 3700.0 MHz max turbo 3 active cores
     >   39 * 100.0 = 3800.0 MHz max turbo 2 active cores
     >   39 * 100.0 = 3900.0 MHz max turbo 1 active cores
     >
     >   could now look something like this:
     >
     >   ...
     >   37 * 100.0 = 3600.0 MHz max turbo 16 active cores
     >   38 * 100.0 = 3700.0 MHz max turbo 8 active cores
     >   39 * 100.0 = 3800.0 MHz max turbo 4 active cores
     >   39 * 100.0 = 3900.0 MHz max turbo 2 active cores
    
    This encoding of turbo levels applies to both SKYLAKE_X and GOLDMONT/GOLDMONT_D,
    but we treat these two classes in separate commits because their freq_max
    values need to be different. For SKX we prefer a lower freq_max in the ratio
    freq_curr/freq_max, allowing load and utilization to overshoot and the
    schedutil governor to be more performance-oriented. Models from the Atom
    series (such as GOLDMONT*) are handled in a forthcoming commit as they have to
    favor power-efficiency over performance.
    
    Results from a performance evaluation follow.
    
    1. TEST SETUP
    2. NEUTRAL BENCHMARKS
    3. NON-NEUTRAL BENCHMARKS
    4. DETAILED TABLES
    
    1. TEST SETUP
    -------------
    
    Test machine:
    
    CPU Model   : Intel Xeon Platinum 8260L CPU @ 2.40GHz (a.k.a. Cascade Lake)
    Fam/Mod/Ste : 6:85:6
    Topology    : 2 sockets, 24 cores / 48 threads each socket
    Memory      : 192G
    Storage     : SSD, XFS filesystem
    
    Max EFFICiency, BASE frequency and available turbo levels (MHz):
    
        EFFIC   1000 |**********
        BASE    2400 |************************
        24C     3100 |*******************************
        20C     3300 |*********************************
        16C     3600 |************************************
        12C     3600 |************************************
        8C      3600 |************************************
        4C      3700 |*************************************
        2C      3900 |***************************************
    
    Tested kernels:
    
    Baseline      : v5.2,              intel_pstate passive,  schedutil
    Comparison #1 : v5.2,              intel_pstate active ,  powersave+HWP
    Comparison #2 : v5.2, this patch,  intel_pstate passive,  schedutil
    
    2. NEUTRAL BENCHMARKS
    ---------------------
    
    * pgbench read/write
    * NASA Parallel Benchmarks (NPB), MPI or OpenMP for message-passing
    * hackbench
    * netperf
    
    3. NON-NEUTRAL BENCHMARKS
    -------------------------
    
    comparison ratio with baseline; 1.00 means neutral, higher is better:
    
                          I_PSTATE      FREQ-INV
        ----------------------------------------
        pgbench read-only     1.10             ~
        tbench                1.82          1.14
    
    comparison ratio with baseline; 1.00 means neutral, lower is better:
    
                          I_PSTATE      FREQ-INV
        ----------------------------------------
        dbench                   ~          0.97
        kernbench             0.88          0.78
        gitsource[*]             ~          0.46
    
    [*] "gitsource" consists in running git's unit tests
    tilde (~) means 1.00, ie result identical to baseline
    
    Performance per watt:
    
    performance-per-watt ratios with baseline; 1.00 means neutral, higher is better:
    
                          I_PSTATE      FREQ-INV
        ----------------------------------------
        dbench                0.92          0.91
        tbench                1.26          1.04
        kernbench             0.95          0.96
        gitsource             1.03          1.30
    
    Similarly to earlier Xeons, measurable performance gains over non-invariant
    schedutil are observed on dbench, tbench, kernel compilation and running the
    git unit tests suite. Looking at the detailed tables show that the patch
    scores the largest difference when the machine is lightly loaded. Power
    efficiency suffers lightly on kernbench and a bit more on dbench, but largely
    improves on gitsource (which also runs considerably faster). For reference, we
    also report results using active intel_pstate with powersave and HWP; the
    largest gap between non-invariant schedutil and intel_pstate+powersave is
    still tbench, which runs 82% better and with 26% improved efficiency on the
    latter configuration -- this divide isn't closed yet by frequency-invariant
    schedutil.
    
    4. DETAILED TABLES
    ------------------
    
    Benchmark          : tbench4 (i.e. dbench4 over the network, actually loopback)
    Varying parameter  : number of clients
    Unit               : MB/sec (higher is better)
    
                         5.2.0 vanilla (BASELINE)            5.2.0 intel_pstate/HWP                    5.2.0 freq-inv
    - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
    Hmean   1         183.56  +- 0.21% (        )       516.12  +- 0.57% ( 181.18%)       185.59  +- 0.59% (   1.11%)
    Hmean   2         365.75  +- 0.25% (        )      1015.14  +- 0.33% ( 177.55%)       402.59  +- 4.48% (  10.07%)
    Hmean   4         720.99  +- 0.44% (        )      1951.75  +- 0.28% ( 170.70%)       738.39  +- 1.72% (   2.41%)
    Hmean   8        1449.93  +- 0.34% (        )      3830.56  +- 0.24% ( 164.19%)      1750.36  +- 4.65% (  20.72%)
    Hmean   16       2874.26  +- 0.57% (        )      7381.62  +- 0.53% ( 156.82%)      4348.35  +- 2.22% (  51.29%)
    Hmean   32       6116.17  +- 5.10% (        )     13013.05  +- 0.08% ( 112.76%)      8980.35  +- 0.66% (  46.83%)
    Hmean   64      14485.04  +- 3.46% (        )     17835.12  +- 0.35% (  23.13%)     16540.73  +- 0.51% (  14.19%)
    Hmean   128     30779.16  +- 3.20% (        )     32796.94  +- 2.13% (   6.56%)     31512.58  +- 0.20% (   2.38%)
    Hmean   256     34664.66  +- 0.81% (        )     34604.67  +- 0.46% (  -0.17%)     34943.70  +- 0.25% (   0.80%)
    Hmean   384     33957.51  +- 0.11% (        )     34091.50  +- 0.14% (   0.39%)     33921.41  +- 0.09% (  -0.11%)
    
    Benchmark          : kernbench (kernel compilation)
    Varying parameter  : number of jobs
    Unit               : seconds (lower is better)
    
                        5.2.0 vanilla (BASELINE)             5.2.0 intel_pstate/HWP                     5.2.0 freq-inv
    - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
    Amean   2        332.94  +- 0.40% (        )        260.16  +- 0.45% (  21.86%)        233.56  +- 0.21% (  29.85%)
    Amean   4        173.04  +- 0.43% (        )        138.76  +- 0.03% (  19.81%)        123.59  +- 0.11% (  28.58%)
    Amean   8         89.65  +- 0.20% (        )         73.54  +- 0.09% (  17.97%)         65.69  +- 0.10% (  26.72%)
    Amean   16        48.08  +- 1.41% (        )         41.64  +- 1.61% (  13.40%)         36.00  +- 1.80% (  25.11%)
    Amean   32        28.78  +- 0.72% (        )         26.61  +- 1.99% (   7.55%)         23.19  +- 1.68% (  19.43%)
    Amean   64        20.46  +- 1.85% (        )         19.76  +- 0.35% (   3.42%)         17.38  +- 0.92% (  15.06%)
    Amean   128       18.69  +- 1.70% (        )         17.59  +- 1.04% (   5.90%)         15.73  +- 1.40% (  15.85%)
    Amean   192       18.82  +- 1.01% (        )         17.76  +- 0.77% (   5.67%)         15.57  +- 1.80% (  17.28%)
    
    Benchmark          : gitsource (time to run the git unit test suite)
    Varying parameter  : none
    Unit               : seconds (lower is better)
    
                     5.2.0 vanilla (BASELINE)           5.2.0 intel_pstate/HWP                    5.2.0 freq-inv
    - - - - - - - -  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
    Amean         792.49  +- 0.20% (        )      779.35  +- 0.24% (   1.66%)      427.14  +- 0.16% (   46.10%)
    
    Signed-off-by: Giovanni Gherdovich <ggherdovich@suse.cz>
    Signed-off-by: Peter Zijlstra (Intel) <peterz@infradead.org>
    Signed-off-by: Ingo Molnar <mingo@kernel.org>
    Acked-by: Rafael J. Wysocki <rafael.j.wysocki@intel.com>
    Link: https://lkml.kernel.org/r/20200122151617.531-3-ggherdovich@suse.cz

commit 1567c3e3467cddeb019a7b53ec632f834b6a9239
Author: Giovanni Gherdovich <ggherdovich@suse.cz>
Date:   Wed Jan 22 16:16:12 2020 +0100

    x86, sched: Add support for frequency invariance
    
    Implement arch_scale_freq_capacity() for 'modern' x86. This function
    is used by the scheduler to correctly account usage in the face of
    DVFS.
    
    The present patch addresses Intel processors specifically and has positive
    performance and performance-per-watt implications for the schedutil cpufreq
    governor, bringing it closer to, if not on-par with, the powersave governor
    from the intel_pstate driver/framework.
    
    Large performance gains are obtained when the machine is lightly loaded and
    no regression are observed at saturation. The benchmarks with the largest
    gains are kernel compilation, tbench (the networking version of dbench) and
    shell-intensive workloads.
    
    1. FREQUENCY INVARIANCE: MOTIVATION
       * Without it, a task looks larger if the CPU runs slower
    
    2. PECULIARITIES OF X86
       * freq invariance accounting requires knowing the ratio freq_curr/freq_max
       2.1 CURRENT FREQUENCY
           * Use delta_APERF / delta_MPERF * freq_base (a.k.a "BusyMHz")
       2.2 MAX FREQUENCY
           * It varies with time (turbo). As an approximation, we set it to a
             constant, i.e. 4-cores turbo frequency.
    
    3. EFFECTS ON THE SCHEDUTIL FREQUENCY GOVERNOR
       * The invariant schedutil's formula has no feedback loop and reacts faster
         to utilization changes
    
    4. KNOWN LIMITATIONS
       * In some cases tasks can't reach max util despite how hard they try
    
    5. PERFORMANCE TESTING
       5.1 MACHINES
           * Skylake, Broadwell, Haswell
       5.2 SETUP
           * baseline Linux v5.2 w/ non-invariant schedutil. Tested freq_max = 1-2-3-4-8-12
             active cores turbo w/ invariant schedutil, and intel_pstate/powersave
       5.3 BENCHMARK RESULTS
           5.3.1 NEUTRAL BENCHMARKS
                 * NAS Parallel Benchmark (HPC), hackbench
           5.3.2 NON-NEUTRAL BENCHMARKS
                 * tbench (10-30% better), kernbench (10-15% better),
                   shell-intensive-scripts (30-50% better)
                 * no regressions
           5.3.3 SELECTION OF DETAILED RESULTS
           5.3.4 POWER CONSUMPTION, PERFORMANCE-PER-WATT
                 * dbench (5% worse on one machine), kernbench (3% worse),
                   tbench (5-10% better), shell-intensive-scripts (10-40% better)
    
    6. MICROARCH'ES ADDRESSED HERE
       * Xeon Core before Scalable Performance processors line (Xeon Gold/Platinum
         etc have different MSRs semantic for querying turbo levels)
    
    7. REFERENCES
       * MMTests performance testing framework, github.com/gormanm/mmtests
    
     +-------------------------------------------------------------------------+
     | 1. FREQUENCY INVARIANCE: MOTIVATION
     +-------------------------------------------------------------------------+
    
    For example; suppose a CPU has two frequencies: 500 and 1000 Mhz. When
    running a task that would consume 1/3rd of a CPU at 1000 MHz, it would
    appear to consume 2/3rd (or 66.6%) when running at 500 MHz, giving the
    false impression this CPU is almost at capacity, even though it can go
    faster [*]. In a nutshell, without frequency scale-invariance tasks look
    larger just because the CPU is running slower.
    
    [*] (footnote: this assumes a linear frequency/performance relation; which
    everybody knows to be false, but given realities its the best approximation
    we can make.)
    
     +-------------------------------------------------------------------------+
     | 2. PECULIARITIES OF X86
     +-------------------------------------------------------------------------+
    
    Accounting for frequency changes in PELT signals requires the computation of
    the ratio freq_curr / freq_max. On x86 neither of those terms is readily
    available.
    
    2.1 CURRENT FREQUENCY
    ====================
    
    Since modern x86 has hardware control over the actual frequency we run
    at (because amongst other things, Turbo-Mode), we cannot simply use
    the frequency as requested through cpufreq.
    
    Instead we use the APERF/MPERF MSRs to compute the effective frequency
    over the recent past. Also, because reading MSRs is expensive, don't
    do so every time we need the value, but amortize the cost by doing it
    every tick.
    
    2.2 MAX FREQUENCY
    =================
    
    Obtaining freq_max is also non-trivial because at any time the hardware can
    provide a frequency boost to a selected subset of cores if the package has
    enough power to spare (eg: Turbo Boost). This means that the maximum frequency
    available to a given core changes with time.
    
    The approach taken in this change is to arbitrarily set freq_max to a constant
    value at boot. The value chosen is the "4-cores (4C) turbo frequency" on most
    microarchitectures, after evaluating the following candidates:
    
        * 1-core (1C) turbo frequency (the fastest turbo state available)
        * around base frequency (a.k.a. max P-state)
        * something in between, such as 4C turbo
    
    To interpret these options, consider that this is the denominator in
    freq_curr/freq_max, and that ratio will be used to scale PELT signals such as
    util_avg and load_avg. A large denominator will undershoot (util_avg looks a
    bit smaller than it really is), viceversa with a smaller denominator PELT
    signals will tend to overshoot. Given that PELT drives frequency selection
    in the schedutil governor, we will have:
    
        freq_max set to     | effect on DVFS
        --------------------+------------------
        1C turbo            | power efficiency (lower freq choices)
        base freq           | performance (higher util_avg, higher freq requests)
        4C turbo            | a bit of both
    
    4C turbo proves to be a good compromise in a number of benchmarks (see below).
    
     +-------------------------------------------------------------------------+
     | 3. EFFECTS ON THE SCHEDUTIL FREQUENCY GOVERNOR
     +-------------------------------------------------------------------------+
    
    Once an architecture implements a frequency scale-invariant utilization (the
    PELT signal util_avg), schedutil switches its frequency selection formula from
    
        freq_next = 1.25 * freq_curr * util            [non-invariant util signal]
    
    to
    
        freq_next = 1.25 * freq_max * util             [invariant util signal]
    
    where, in the second formula, freq_max is set to the 1C turbo frequency (max
    turbo). The advantage of the second formula, whose usage we unlock with this
    patch, is that freq_next doesn't depend on the current frequency in an
    iterative fashion, but can jump to any frequency in a single update. This
    absence of feedback in the formula makes it quicker to react to utilization
    changes and more robust against pathological instabilities.
    
    Compare it to the update formula of intel_pstate/powersave:
    
        freq_next = 1.25 * freq_max * Busy%
    
    where again freq_max is 1C turbo and Busy% is the percentage of time not spent
    idling (calculated with delta_MPERF / delta_TSC); essentially the same as
    invariant schedutil, and largely responsible for intel_pstate/powersave good
    reputation. The non-invariant schedutil formula is derived from the invariant
    one by approximating util_inv with util_raw * freq_curr / freq_max, but this
    has limitations.
    
    Testing shows improved performances due to better frequency selections when
    the machine is lightly loaded, and essentially no change in behaviour at
    saturation / overutilization.
    
     +-------------------------------------------------------------------------+
     | 4. KNOWN LIMITATIONS
     +-------------------------------------------------------------------------+
    
    It's been shown that it is possible to create pathological scenarios where a
    CPU-bound task cannot reach max utilization, if the normalizing factor
    freq_max is fixed to a constant value (see [Lelli-2018]).
    
    If freq_max is set to 4C turbo as we do here, one needs to peg at least 5
    cores in a package doing some busywork, and observe that none of those task
    will ever reach max util (1024) because they're all running at less than the
    4C turbo frequency.
    
    While this concern still applies, we believe the performance benefit of
    frequency scale-invariant PELT signals outweights the cost of this limitation.
    
     [Lelli-2018]
     https://lore.kernel.org/lkml/20180517150418.GF22493@localhost.localdomain/
    
     +-------------------------------------------------------------------------+
     | 5. PERFORMANCE TESTING
     +-------------------------------------------------------------------------+
    
    5.1 MACHINES
    ============
    
    We tested the patch on three machines, with Skylake, Broadwell and Haswell
    CPUs. The details are below, together with the available turbo ratios as
    reported by the appropriate MSRs.
    
    * 8x-SKYLAKE-UMA:
      Single socket E3-1240 v5, Skylake 4 cores/8 threads
      Max EFFiciency, BASE frequency and available turbo levels (MHz):
    
        EFFIC    800 |********
        BASE    3500 |***********************************
        4C      3700 |*************************************
        3C      3800 |**************************************
        2C      3900 |***************************************
        1C      3900 |***************************************
    
    * 80x-BROADWELL-NUMA:
      Two sockets E5-2698 v4, 2x Broadwell 20 cores/40 threads
      Max EFFiciency, BASE frequency and available turbo levels (MHz):
    
        EFFIC   1200 |************
        BASE    2200 |**********************
        8C      2900 |*****************************
        7C      3000 |******************************
        6C      3100 |*******************************
        5C      3200 |********************************
        4C      3300 |*********************************
        3C      3400 |**********************************
        2C      3600 |************************************
        1C      3600 |************************************
    
    * 48x-HASWELL-NUMA
      Two sockets E5-2670 v3, 2x Haswell 12 cores/24 threads
      Max EFFiciency, BASE frequency and available turbo levels (MHz):
    
        EFFIC   1200 |************
        BASE    2300 |***********************
        12C     2600 |**************************
        11C     2600 |**************************
        10C     2600 |**************************
        9C      2600 |**************************
        8C      2600 |**************************
        7C      2600 |**************************
        6C      2600 |**************************
        5C      2700 |***************************
        4C      2800 |****************************
        3C      2900 |*****************************
        2C      3100 |*******************************
        1C      3100 |*******************************
    
    5.2 SETUP
    =========
    
    * The baseline is Linux v5.2 with schedutil (non-invariant) and the intel_pstate
      driver in passive mode.
    * The rationale for choosing the various freq_max values to test have been to
      try all the 1-2-3-4C turbo levels (note that 1C and 2C turbo are identical
      on all machines), plus one more value closer to base_freq but still in the
      turbo range (8C turbo for both 80x-BROADWELL-NUMA and 48x-HASWELL-NUMA).
    * In addition we've run all tests with intel_pstate/powersave for comparison.
    * The filesystem is always XFS, the userspace is openSUSE Leap 15.1.
    * 8x-SKYLAKE-UMA is capable of HWP (Hardware-Managed P-States), so the runs
      with active intel_pstate on this machine use that.
    
    This gives, in terms of combinations tested on each machine:
    
    * 8x-SKYLAKE-UMA
      * Baseline: Linux v5.2, non-invariant schedutil, intel_pstate passive
      * intel_pstate active + powersave + HWP
      * invariant schedutil, freq_max = 1C turbo
      * invariant schedutil, freq_max = 3C turbo
      * invariant schedutil, freq_max = 4C turbo
    
    * both 80x-BROADWELL-NUMA and 48x-HASWELL-NUMA
      * [same as 8x-SKYLAKE-UMA, but no HWP capable]
      * invariant schedutil, freq_max = 8C turbo
        (which on 48x-HASWELL-NUMA is the same as 12C turbo, or "all cores turbo")
    
    5.3 BENCHMARK RESULTS
    =====================
    
    5.3.1 NEUTRAL BENCHMARKS
    ------------------------
    
    Tests that didn't show any measurable difference in performance on any of the
    test machines between non-invariant schedutil and our patch are:
    
    * NAS Parallel Benchmarks (NPB) using either MPI or openMP for IPC, any
      computational kernel
    * flexible I/O (FIO)
    * hackbench (using threads or processes, and using pipes or sockets)
    
    5.3.2 NON-NEUTRAL BENCHMARKS
    ----------------------------
    
    What follow are summary tables where each benchmark result is given a score.
    
    * A tilde (~) means a neutral result, i.e. no difference from baseline.
    * Scores are computed with the ratio result_new / result_baseline, so a tilde
      means a score of 1.00.
    * The results in the score ratio are the geometric means of results running
      the benchmark with different parameters (eg: for kernbench: using 1, 2, 4,
      ... number of processes; for pgbench: varying the number of clients, and so
      on).
    * The first three tables show higher-is-better kind of tests (i.e. measured in
      operations/second), the subsequent three show lower-is-better kind of tests
      (i.e. the workload is fixed and we measure elapsed time, think kernbench).
    * "gitsource" is a name we made up for the test consisting in running the
      entire unit tests suite of the Git SCM and measuring how long it takes. We
      take it as a typical example of shell-intensive serialized workload.
    * In the "I_PSTATE" column we have the results for intel_pstate/powersave. Other
      columns show invariant schedutil for different values of freq_max. 4C turbo
      is circled as it's the value we've chosen for the final implementation.
    
    80x-BROADWELL-NUMA (comparison ratio; higher is better)
                                             +------+
                     I_PSTATE   1C     3C    | 4C   |  8C
    pgbench-ro           1.14   ~      ~     | 1.11 |  1.14
    pgbench-rw           ~      ~      ~     | ~    |  ~
    netperf-udp          1.06   ~      1.06  | 1.05 |  1.07
    netperf-tcp          ~      1.03   ~     | 1.01 |  1.02
    tbench4              1.57   1.18   1.22  | 1.30 |  1.56
                                             +------+
    
    8x-SKYLAKE-UMA (comparison ratio; higher is better)
                                             +------+
                 I_PSTATE/HWP   1C     3C    | 4C   |
    pgbench-ro           ~      ~      ~     | ~    |
    pgbench-rw           ~      ~      ~     | ~    |
    netperf-udp          ~      ~      ~     | ~    |
    netperf-tcp          ~      ~      ~     | ~    |
    tbench4              1.30   1.14   1.14  | 1.16 |
                                             +------+
    
    48x-HASWELL-NUMA (comparison ratio; higher is better)
                                             +------+
                     I_PSTATE   1C     3C    | 4C   |  12C
    pgbench-ro           1.15   ~      ~     | 1.06 |  1.16
    pgbench-rw           ~      ~      ~     | ~    |  ~
    netperf-udp          1.05   0.97   1.04  | 1.04 |  1.02
    netperf-tcp          0.96   1.01   1.01  | 1.01 |  1.01
    tbench4              1.50   1.05   1.13  | 1.13 |  1.25
                                             +------+
    
    In the table above we see that active intel_pstate is slightly better than our
    4C-turbo patch (both in reference to the baseline non-invariant schedutil) on
    read-only pgbench and much better on tbench. Both cases are notable in which
    it shows that lowering our freq_max (to 8C-turbo and 12C-turbo on
    80x-BROADWELL-NUMA and 48x-HASWELL-NUMA respectively) helps invariant
    schedutil to get closer.
    
    If we ignore active intel_pstate and focus on the comparison with baseline
    alone, there are several instances of double-digit performance improvement.
    
    80x-BROADWELL-NUMA (comparison ratio; lower is better)
                                             +------+
                     I_PSTATE   1C     3C    | 4C   |  8C
    dbench4              1.23   0.95   0.95  | 0.95 |  0.95
    kernbench            0.93   0.83   0.83  | 0.83 |  0.82
    gitsource            0.98   0.49   0.49  | 0.49 |  0.48
                                             +------+
    
    8x-SKYLAKE-UMA (comparison ratio; lower is better)
                                             +------+
                 I_PSTATE/HWP   1C     3C    | 4C   |
    dbench4              ~      ~      ~     | ~    |
    kernbench            ~      ~      ~     | ~    |
    gitsource            0.92   0.55   0.55  | 0.55 |
                                             +------+
    
    48x-HASWELL-NUMA (comparison ratio; lower is better)
                                             +------+
                     I_PSTATE   1C     3C    | 4C   |  8C
    dbench4              ~      ~      ~     | ~    |  ~
    kernbench            0.94   0.90   0.89  | 0.90 |  0.90
    gitsource            0.97   0.69   0.69  | 0.69 |  0.69
                                             +------+
    
    dbench is not very remarkable here, unless we notice how poorly active
    intel_pstate is performing on 80x-BROADWELL-NUMA: 23% regression versus
    non-invariant schedutil. We repeated that run getting consistent results. Out
    of scope for the patch at hand, but deserving future investigation. Other than
    that, we previously ran this campaign with Linux v5.0 and saw the patch doing
    better on dbench a the time. We haven't checked closely and can only speculate
    at this point.
    
    On the NUMA boxes kernbench gets 10-15% improvements on average; we'll see in
    the detailed tables that the gains concentrate on low process counts (lightly
    loaded machines).
    
    The test we call "gitsource" (running the git unit test suite, a long-running
    single-threaded shell script) appears rather spectacular in this table (gains
    of 30-50% depending on the machine). It is to be noted, however, that
    gitsource has no adjustable parameters (such as the number of jobs in
    kernbench, which we average over in order to get a single-number summary
    score) and is exactly the kind of low-parallelism workload that benefits the
    most from this patch. When looking at the detailed tables of kernbench or
    tbench4, at low process or client counts one can see similar numbers.
    
    5.3.3 SELECTION OF DETAILED RESULTS
    -----------------------------------
    
    Machine            : 48x-HASWELL-NUMA
    Benchmark          : tbench4 (i.e. dbench4 over the network, actually loopback)
    Varying parameter  : number of clients
    Unit               : MB/sec (higher is better)
    
                       5.2.0 vanilla (BASELINE)               5.2.0 intel_pstate                   5.2.0 1C-turbo
    - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
    Hmean  1        126.73  +- 0.31% (        )      315.91  +- 0.66% ( 149.28%)      125.03  +- 0.76% (  -1.34%)
    Hmean  2        258.04  +- 0.62% (        )      614.16  +- 0.51% ( 138.01%)      269.58  +- 1.45% (   4.47%)
    Hmean  4        514.30  +- 0.67% (        )     1146.58  +- 0.54% ( 122.94%)      533.84  +- 1.99% (   3.80%)
    Hmean  8       1111.38  +- 2.52% (        )     2159.78  +- 0.38% (  94.33%)     1359.92  +- 1.56% (  22.36%)
    Hmean  16      2286.47  +- 1.36% (        )     3338.29  +- 0.21% (  46.00%)     2720.20  +- 0.52% (  18.97%)
    Hmean  32      4704.84  +- 0.35% (        )     4759.03  +- 0.43% (   1.15%)     4774.48  +- 0.30% (   1.48%)
    Hmean  64      7578.04  +- 0.27% (        )     7533.70  +- 0.43% (  -0.59%)     7462.17  +- 0.65% (  -1.53%)
    Hmean  128     6998.52  +- 0.16% (        )     6987.59  +- 0.12% (  -0.16%)     6909.17  +- 0.14% (  -1.28%)
    Hmean  192     6901.35  +- 0.25% (        )     6913.16  +- 0.10% (   0.17%)     6855.47  +- 0.21% (  -0.66%)
    
                                 5.2.0 3C-turbo                   5.2.0 4C-turbo                  5.2.0 12C-turbo
    - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
    Hmean  1        128.43  +- 0.28% (   1.34%)      130.64  +- 3.81% (   3.09%)      153.71  +- 5.89% (  21.30%)
    Hmean  2        311.70  +- 6.15% (  20.79%)      281.66  +- 3.40% (   9.15%)      305.08  +- 5.70% (  18.23%)
    Hmean  4        641.98  +- 2.32% (  24.83%)      623.88  +- 5.28% (  21.31%)      906.84  +- 4.65% (  76.32%)
    Hmean  8       1633.31  +- 1.56% (  46.96%)     1714.16  +- 0.93% (  54.24%)     2095.74  +- 0.47% (  88.57%)
    Hmean  16      3047.24  +- 0.42% (  33.27%)     3155.02  +- 0.30% (  37.99%)     3634.58  +- 0.15% (  58.96%)
    Hmean  32      4734.31  +- 0.60% (   0.63%)     4804.38  +- 0.23% (   2.12%)     4674.62  +- 0.27% (  -0.64%)
    Hmean  64      7699.74  +- 0.35% (   1.61%)     7499.72  +- 0.34% (  -1.03%)     7659.03  +- 0.25% (   1.07%)
    Hmean  128     6935.18  +- 0.15% (  -0.91%)     6942.54  +- 0.10% (  -0.80%)     7004.85  +- 0.12% (   0.09%)
    Hmean  192     6901.62  +- 0.12% (   0.00%)     6856.93  +- 0.10% (  -0.64%)     6978.74  +- 0.10% (   1.12%)
    
    This is one of the cases where the patch still can't surpass active
    intel_pstate, not even when freq_max is as low as 12C-turbo. Otherwise, gains are
    visible up to 16 clients and the saturated scenario is the same as baseline.
    
    The scores in the summary table from the previous sections are ratios of
    geometric means of the results over different clients, as seen in this table.
    
    Machine            : 80x-BROADWELL-NUMA
    Benchmark          : kernbench (kernel compilation)
    Varying parameter  : number of jobs
    Unit               : seconds (lower is better)
    
                       5.2.0 vanilla (BASELINE)               5.2.0 intel_pstate                   5.2.0 1C-turbo
    - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
    Amean  2        379.68  +- 0.06% (        )      330.20  +- 0.43% (  13.03%)      285.93  +- 0.07% (  24.69%)
    Amean  4        200.15  +- 0.24% (        )      175.89  +- 0.22% (  12.12%)      153.78  +- 0.25% (  23.17%)
    Amean  8        106.20  +- 0.31% (        )       95.54  +- 0.23% (  10.03%)       86.74  +- 0.10% (  18.32%)
    Amean  16        56.96  +- 1.31% (        )       53.25  +- 1.22% (   6.50%)       48.34  +- 1.73% (  15.13%)
    Amean  32        34.80  +- 2.46% (        )       33.81  +- 0.77% (   2.83%)       30.28  +- 1.59% (  12.99%)
    Amean  64        26.11  +- 1.63% (        )       25.04  +- 1.07% (   4.10%)       22.41  +- 2.37% (  14.16%)
    Amean  128       24.80  +- 1.36% (        )       23.57  +- 1.23% (   4.93%)       21.44  +- 1.37% (  13.55%)
    Amean  160       24.85  +- 0.56% (        )       23.85  +- 1.17% (   4.06%)       21.25  +- 1.12% (  14.49%)
    
                                 5.2.0 3C-turbo                   5.2.0 4C-turbo                   5.2.0 8C-turbo
    - - - - - - - -  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
    Amean  2        284.08  +- 0.13% (  25.18%)      283.96  +- 0.51% (  25.21%)      285.05  +- 0.21% (  24.92%)
    Amean  4        153.18  +- 0.22% (  23.47%)      154.70  +- 1.64% (  22.71%)      153.64  +- 0.30% (  23.24%)
    Amean  8         87.06  +- 0.28% (  18.02%)       86.77  +- 0.46% (  18.29%)       86.78  +- 0.22% (  18.28%)
    Amean  16        48.03  +- 0.93% (  15.68%)       47.75  +- 1.99% (  16.17%)       47.52  +- 1.61% (  16.57%)
    Amean  32        30.23  +- 1.20% (  13.14%)       30.08  +- 1.67% (  13.57%)       30.07  +- 1.67% (  13.60%)
    Amean  64        22.59  +- 2.02% (  13.50%)       22.63  +- 0.81% (  13.32%)       22.42  +- 0.76% (  14.12%)
    Amean  128       21.37  +- 0.67% (  13.82%)       21.31  +- 1.15% (  14.07%)       21.17  +- 1.93% (  14.63%)
    Amean  160       21.68  +- 0.57% (  12.76%)       21.18  +- 1.74% (  14.77%)       21.22  +- 1.00% (  14.61%)
    
    The patch outperform active intel_pstate (and baseline) by a considerable
    margin; the summary table from the previous section says 4C turbo and active
    intel_pstate are 0.83 and 0.93 against baseline respectively, so 4C turbo is
    0.83/0.93=0.89 against intel_pstate (~10% better on average). There is no
    noticeable difference with regard to the value of freq_max.
    
    Machine            : 8x-SKYLAKE-UMA
    Benchmark          : gitsource (time to run the git unit test suite)
    Varying parameter  : none
    Unit               : seconds (lower is better)
    
                                5.2.0 vanilla           5.2.0 intel_pstate/hwp         5.2.0 1C-turbo
    - - - - - - - -  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
    Amean         858.85  +- 1.16% (        )      791.94  +- 0.21% (   7.79%)      474.95 (  44.70%)
    
                               5.2.0 3C-turbo                   5.2.0 4C-turbo
    - - - - - - - -  - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
    Amean         475.26  +- 0.20% (  44.66%)      474.34  +- 0.13% (  44.77%)
    
    In this test, which is of interest as representing shell-intensive
    (i.e. fork-intensive) serialized workloads, invariant schedutil outperforms
    intel_pstate/powersave by a whopping 40% margin.
    
    5.3.4 POWER CONSUMPTION, PERFORMANCE-PER-WATT
    ---------------------------------------------
    
    The following table shows average power consumption in watt for each
    benchmark. Data comes from turbostat (package average), which in turn is read
    from the RAPL interface on CPUs. We know the patch affects CPU frequencies so
    it's reasonable to ignore other power consumers (such as memory or I/O). Also,
    we don't have a power meter available in the lab so RAPL is the best we have.
    
    turbostat sampled average power every 10 seconds for the entire duration of
    each benchmark. We took all those values and averaged them (i.e. with don't
    have detail on a per-parameter granularity, only on whole benchmarks).
    
    80x-BROADWELL-NUMA (power consumption, watts)
                                                        +--------+
                   BASELINE I_PSTATE       1C       3C  |     4C |      8C
    pgbench-ro       130.01   142.77   131.11   132.45  | 134.65 |  136.84
    pgbench-rw        68.30    60.83    71.45    71.70  |  71.65 |   72.54
    dbench4           90.25    59.06   101.43    99.89  | 101.10 |  102.94
    netperf-udp       65.70    69.81    66.02    68.03  |  68.27 |   68.95
    netperf-tcp       88.08    87.96    88.97    88.89  |  88.85 |   88.20
    tbench4          142.32   176.73   153.02   163.91  | 165.58 |  176.07
    kernbench         92.94   101.95   114.91   115.47  | 115.52 |  115.10
    gitsource         40.92    41.87    75.14    75.20  |  75.40 |   75.70
                                                        +--------+
    8x-SKYLAKE-UMA (power consumption, watts)
                                                        +--------+
                  BASELINE I_PSTATE/HWP    1C       3C  |     4C |
    pgbench-ro        46.49    46.68    46.56    46.59  |  46.52 |
    pgbench-rw        29.34    31.38    30.98    31.00  |  31.00 |
    dbench4           27.28    27.37    27.49    27.41  |  27.38 |
    netperf-udp       22.33    22.41    22.36    22.35  |  22.36 |
    netperf-tcp       27.29    27.29    27.30    27.31  |  27.33 |
    tbench4           41.13    45.61    43.10    43.33  |  43.56 |
    kernbench         42.56    42.63    43.01    43.01  |  43.01 |
    gitsource         13.32    13.69    17.33    17.30  |  17.35 |
                                                        +--------+
    48x-HASWELL-NUMA (power consumption, watts)
                                                        +--------+
                   BASELINE I_PSTATE       1C       3C  |     4C |     12C
    pgbench-ro       128.84   136.04   129.87   132.43  | 132.30 |  134.86
    pgbench-rw        37.68    37.92    37.17    37.74  |  37.73 |   37.31
    dbench4           28.56    28.73    28.60    28.73  |  28.70 |   28.79
    netperf-udp       56.70    60.44    56.79    57.42  |  57.54 |   57.52
    netperf-tcp       75.49    75.27    75.87    76.02  |  76.01 |   75.95
    tbench4          115.44   139.51   119.53   123.07  | 123.97 |  130.22
    kernbench         83.23    91.55    95.58    95.69  |  95.72 |   96.04
    gitsource         36.79    36.99    39.99    40.34  |  40.35 |   40.23
                                                        +--------+
    
    A lower power consumption isn't necessarily better, it depends on what is done
    with that energy. Here are tables with the ratio of performance-per-watt on
    each machine and benchmark. Higher is always better; a tilde (~) means a
    neutral ratio (i.e. 1.00).
    
    80x-BROADWELL-NUMA (performance-per-watt ratios; higher is better)
                                         +------+
                 I_PSTATE     1C     3C  |   4C |    8C
    pgbench-ro       1.04   1.06   0.94  | 1.07 |  1.08
    pgbench-rw       1.10   0.97   0.96  | 0.96 |  0.97
    dbench4          1.24   0.94   0.95  | 0.94 |  0.92
    netperf-udp      ~      1.02   1.02  | ~    |  1.02
    netperf-tcp      ~      1.02   ~     | ~    |  1.02
    tbench4          1.26   1.10   1.06  | 1.12 |  1.26
    kernbench        0.98   0.97   0.97  | 0.97 |  0.98
    gitsource        ~      1.11   1.11  | 1.11 |  1.13
                                         +------+
    
    8x-SKYLAKE-UMA (performance-per-watt ratios; higher is better)
                                         +------+
             I_PSTATE/HWP     1C     3C  |   4C |
    pgbench-ro       ~      ~      ~     | ~    |
    pgbench-rw       0.95   0.97   0.96  | 0.96 |
    dbench4          ~      ~      ~     | ~    |
    netperf-udp      ~      ~      ~     | ~    |
    netperf-tcp      ~      ~      ~     | ~    |
    tbench4          1.17   1.09   1.08  | 1.10 |
    kernbench        ~      ~      ~     | ~    |
    gitsource        1.06   1.40   1.40  | 1.40 |
                                         +------+
    
    48x-HASWELL-NUMA  (performance-per-watt ratios; higher is better)
                                         +------+
                 I_PSTATE     1C     3C  |   4C |   12C
    pgbench-ro       1.09   ~      1.09  | 1.03 |  1.11
    pgbench-rw       ~      0.86   ~     | ~    |  0.86
    dbench4          ~      1.02   1.02  | 1.02 |  ~
    netperf-udp      ~      0.97   1.03  | 1.02 |  ~
    netperf-tcp      0.96   ~      ~     | ~    |  ~
    tbench4          1.24   ~      1.06  | 1.05 |  1.11
    kernbench        0.97   0.97   0.98  | 0.97 |  0.96
    gitsource        1.03   1.33   1.32  | 1.32 |  1.33
                                         +------+
    
    These results are overall pleasing: in plenty of cases we observe
    performance-per-watt improvements. The few regressions (read/write pgbench and
    dbench on the Broadwell machine) are of small magnitude. kernbench loses a few
    percentage points (it has a 10-15% performance improvement, but apparently the
    increase in power consumption is larger than that). tbench4 and gitsource, which
    benefit the most from the patch, keep a positive score in this table which is
    a welcome surprise; that suggests that in those particular workloads the
    non-invariant schedutil (and active intel_pstate, too) makes some rather
    suboptimal frequency selections.
    
    +-------------------------------------------------------------------------+
    | 6. MICROARCH'ES ADDRESSED HERE
    +-------------------------------------------------------------------------+
    
    The patch addresses Xeon Core processors that use MSR_PLATFORM_INFO and
    MSR_TURBO_RATIO_LIMIT to advertise their base frequency and turbo frequencies
    respectively. This excludes the recent Xeon Scalable Performance processors
    line (Xeon Gold, Platinum etc) whose MSRs have to be parsed differently.
    
    Subsequent patches will address:
    
    * Xeon Scalable Performance processors and Atom Goldmont/Goldmont Plus
    * Xeon Phi (Knights Landing, Knights Mill)
    * Atom Silvermont
    
    +-------------------------------------------------------------------------+
    | 7. REFERENCES
    +-------------------------------------------------------------------------+
    
    Tests have been run with the help of the MMTests performance testing
    framework, see github.com/gormanm/mmtests. The configuration file names for
    the benchmark used are:
    
        db-pgbench-timed-ro-small-xfs
        db-pgbench-timed-rw-small-xfs
        io-dbench4-async-xfs
        network-netperf-unbound
        network-tbench
        scheduler-unbound
        workload-kerndevel-xfs
        workload-shellscripts-xfs
        hpc-nas-c-class-mpi-full-xfs
        hpc-nas-c-class-omp-full
    
    All those benchmarks are generally available on the web:
    
    pgbench: https://www.postgresql.org/docs/10/pgbench.html
    netperf: https://hewlettpackard.github.io/netperf/
    dbench/tbench: https://dbench.samba.org/
    gitsource: git unit test suite, github.com/git/git
    NAS Parallel Benchmarks: https://www.nas.nasa.gov/publications/npb.html
    hackbench: https://people.redhat.com/mingo/cfs-scheduler/tools/hackbench.c
    
    Suggested-by: Peter Zijlstra <peterz@infradead.org>
    Signed-off-by: Giovanni Gherdovich <ggherdovich@suse.cz>
    Signed-off-by: Peter Zijlstra (Intel) <peterz@infradead.org>
    Signed-off-by: Ingo Molnar <mingo@kernel.org>
    Acked-by: Doug Smythies <dsmythies@telus.net>
    Acked-by: Rafael J. Wysocki <rafael.j.wysocki@intel.com>
    Link: https://lkml.kernel.org/r/20200122151617.531-2-ggherdovich@suse.cz

commit 6d277aca488fdf0a1e67cd14b5a58869f66197c9
Merge: aae1464f46a2 c102671af085
Author: Linus Torvalds <torvalds@linux-foundation.org>
Date:   Mon Jan 27 11:23:54 2020 -0800

    Merge tag 'pm-5.6-rc1' of git://git.kernel.org/pub/scm/linux/kernel/git/rafael/linux-pm
    
    Pull power management updates from Rafael Wysocki:
     "These add ACPI support to the intel_idle driver along with an admin
      guide document for it, add support for CPR (Core Power Reduction) to
      the AVS (Adaptive Voltage Scaling) subsystem, add new hardware support
      in a few places, add some new sysfs attributes, debugfs files and
      tracepoints, fix bugs and clean up a bunch of things all over.
    
      Specifics:
    
       - Update the ACPI processor driver in order to export
         acpi_processor_evaluate_cst() to the code outside of it, add ACPI
         support to the intel_idle driver based on that and clean up that
         driver somewhat (Rafael Wysocki).
    
       - Add an admin guide document for the intel_idle driver (Rafael
         Wysocki).
    
       - Clean up cpuidle core and drivers, enable compilation testing for
         some of them (Benjamin Gaignard, Krzysztof Kozlowski, Rafael
         Wysocki, Yangtao Li).
    
       - Fix reference counting of OPP (operating performance points) table
         structures (Viresh Kumar).
    
       - Add support for CPR (Core Power Reduction) to the AVS (Adaptive
         Voltage Scaling) subsystem (Niklas Cassel, Colin Ian King,
         YueHaibing).
    
       - Add support for TigerLake Mobile and JasperLake to the Intel RAPL
         power capping driver (Zhang Rui).
    
       - Update cpufreq drivers:
          - Add i.MX8MP support to imx-cpufreq-dt (Anson Huang).
          - Fix usage of a macro in loongson2_cpufreq (Alexandre Oliva).
          - Fix cpufreq policy reference counting issues in s3c and
            brcmstb-avs (chenqiwu).
          - Fix ACPI table reference counting issue and HiSilicon quirk
            handling in the CPPC driver (Hanjun Guo).
          - Clean up spelling mistake in intel_pstate (Harry Pan).
          - Convert the kirkwood and tegra186 drivers to using
            devm_platform_ioremap_resource() (Yangtao Li).
    
       - Update devfreq core:
          - Add 'name' sysfs attribute for devfreq devices (Chanwoo Choi).
          - Clean up the handing of transition statistics and allow them to
            be reset by writing 0 to the 'trans_stat' devfreq device
            attribute in sysfs (Kamil Konieczny).
          - Add 'devfreq_summary' to debugfs (Chanwoo Choi).
          - Clean up kerneldoc comments and Kconfig indentation (Krzysztof
            Kozlowski, Randy Dunlap).
    
       - Update devfreq drivers:
          - Add dynamic scaling for the imx8m DDR controller and clean up
            imx8m-ddrc (Leonard Crestez, YueHaibing).
          - Fix DT node reference counting and nitialization error code path
            in rk3399_dmc and add COMPILE_TEST and HAVE_ARM_SMCCC dependency
            for it (Chanwoo Choi, Yangtao Li).
          - Fix DT node reference counting in rockchip-dfi and make it use
            devm_platform_ioremap_resource() (Yangtao Li).
          - Fix excessive stack usage in exynos-ppmu (Arnd Bergmann).
          - Fix initialization error code paths in exynos-bus (Yangtao Li).
          - Clean up exynos-bus and exynos somewhat (Artur wigo, Krzysztof
            Kozlowski).
    
       - Add tracepoints for tracking usage_count updates unrelated to
         status changes in PM-runtime (Micha Mirosaw).
    
       - Add sysfs attribute to control the "sync on suspend" behavior
         during system-wide suspend (Jonas Meurer).
    
       - Switch system-wide suspend tests over to 64-bit time (Alexandre
         Belloni).
    
       - Make wakeup sources statistics in debugfs cover deleted ones which
         used to be the case some time ago (zhuguangqing).
    
       - Clean up computations carried out during hibernation, update
         messages related to hibernation and fix a spelling mistake in one
         of them (Wen Yang, Luigi Semenzato, Colin Ian King).
    
       - Add mailmap entry for maintainer e-mail address that has not been
         functional for several years (Rafael Wysocki)"
    
    * tag 'pm-5.6-rc1' of git://git.kernel.org/pub/scm/linux/kernel/git/rafael/linux-pm: (83 commits)
      cpufreq: loongson2_cpufreq: adjust cpufreq uses of LOONGSON_CHIPCFG
      intel_idle: Clean up irtl_2_usec()
      intel_idle: Move 3 functions closer to their callers
      intel_idle: Annotate initialization code and data structures
      intel_idle: Move and clean up intel_idle_cpuidle_devices_uninit()
      intel_idle: Rearrange intel_idle_cpuidle_driver_init()
      intel_idle: Clean up NULL pointer check in intel_idle_init()
      intel_idle: Fold intel_idle_probe() into intel_idle_init()
      intel_idle: Eliminate __setup_broadcast_timer()
      cpuidle: fix cpuidle_find_deepest_state() kerneldoc warnings
      cpuidle: sysfs: fix warnings when compiling with W=1
      cpuidle: coupled: fix warnings when compiling with W=1
      cpufreq: brcmstb-avs: fix imbalance of cpufreq policy refcount
      PM: suspend: Add sysfs attribute to control the "sync on suspend" behavior
      PM / devfreq: Add debugfs support with devfreq_summary file
      Documentation: admin-guide: PM: Add intel_idle document
      cpuidle: arm: Enable compile testing for some of drivers
      PM-runtime: add tracepoints for usage_count changes
      cpufreq: intel_pstate: fix spelling mistake: "Whethet" -> "Whether"
      PM: hibernate: fix spelling mistake "shapshot" -> "snapshot"
      ...

commit 1441242c357ea952993e999a2b5c8808c1d7be58
Author: Fred Klassen <fklassen@appneta.com>
Date:   Mon Jun 17 12:05:07 2019 -0700

    net/udp_gso: Allow TX timestamp with UDP GSO
    
    [ Upstream commit 76e21533a48bb42d1fa894f93f6233bf4554f45e ]
    
    Fixes an issue where TX Timestamps are not arriving on the error queue
    when UDP_SEGMENT CMSG type is combined with CMSG type SO_TIMESTAMPING.
    This can be illustrated with an updated updgso_bench_tx program which
    includes the '-T' option to test for this condition. It also introduces
    the '-P' option which will call poll() before reading the error queue.
    
        ./udpgso_bench_tx -4ucTPv -S 1472 -l2 -D 172.16.120.18
        poll timeout
        udp tx:      0 MB/s        1 calls/s      1 msg/s
    
    The "poll timeout" message above indicates that TX timestamp never
    arrived.
    
    This patch preserves tx_flags for the first UDP GSO segment. Only the
    first segment is timestamped, even though in some cases there may be
    benefital in timestamping both the first and last segment.
    
    Factors in deciding on first segment timestamp only:
    
    - Timestamping both first and last segmented is not feasible. Hardware
    can only have one outstanding TS request at a time.
    
    - Timestamping last segment may under report network latency of the
    previous segments. Even though the doorbell is suppressed, the ring
    producer counter has been incremented.
    
    - Timestamping the first segment has the upside in that it reports
    timestamps from the application's view, e.g. RTT.
    
    - Timestamping the first segment has the downside that it may
    underreport tx host network latency. It appears that we have to pick
    one or the other. And possibly follow-up with a config flag to choose
    behavior.
    
    v2: Remove tests as noted by Willem de Bruijn <willemb@google.com>
        Moving tests from net to net-next
    
    v3: Update only relevant tx_flag bits as per
        Willem de Bruijn <willemb@google.com>
    
    v4: Update comments and commit message as per
        Willem de Bruijn <willemb@google.com>
    
    Fixes: ee80d1ebe5ba ("udp: add udp gso")
    Signed-off-by: Fred Klassen <fklassen@appneta.com>
    Acked-by: Willem de Bruijn <willemb@google.com>
    Signed-off-by: David S. Miller <davem@davemloft.net>
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit c102671af085aacf17219e9bdcfccddc6620a866
Merge: c95d9c140cea 854e334903df
Author: Rafael J. Wysocki <rafael.j.wysocki@intel.com>
Date:   Mon Jan 27 11:30:38 2020 +0100

    Merge branch 'pm-devfreq'
    
    * pm-devfreq: (24 commits)
      PM / devfreq: Add debugfs support with devfreq_summary file
      PM / devfreq: exynos: Rename Exynos to lowercase
      PM / devfreq: imx8m-ddrc: Fix inconsistent IS_ERR and PTR_ERR
      PM / devfreq: exynos-bus: Add error log when fail to get devfreq-event
      PM / devfreq: exynos-bus: Disable devfreq-event device when fails
      PM / devfreq: rk3399_dmc: Disable devfreq-event device when fails
      PM / devfreq: imx8m-ddrc: Remove unused defines
      PM / devfreq: exynos-bus: Reduce goto statements and remove unused headers
      PM / devfreq: rk3399_dmc: Add COMPILE_TEST and HAVE_ARM_SMCCC dependency
      PM / devfreq: rockchip-dfi: Convert to devm_platform_ioremap_resource
      PM / devfreq: rk3399_dmc: Add missing of_node_put()
      PM / devfreq: rockchip-dfi: Add missing of_node_put()
      PM / devfreq: Fix multiple kernel-doc warnings
      PM / devfreq: exynos-bus: Extract exynos_bus_profile_init_passive()
      PM / devfreq: exynos-bus: Extract exynos_bus_profile_init()
      PM / devfreq: Move declaration of DEVICE_ATTR_RW(min_freq)
      PM / devfreq: Move statistics to separate struct devfreq_stats
      PM / devfreq: Add clearing transitions stats
      PM / devfreq: Change time stats to 64-bit
      PM / devfreq: Add new name attribute for sysfs
      ...

commit 32efcc06d2a15fa87585614d12d6c2308cc2d3f3
Author: Abdul Kabbani <akabbani@google.com>
Date:   Fri Jan 24 16:34:02 2020 -0500

    tcp: export count for rehash attempts
    
    Using IPv6 flow-label to swiftly route around avoid congested or
    disconnected network path can greatly improve TCP reliability.
    
    This patch adds SNMP counters and a OPT_STATS counter to track both
    host-level and connection-level statistics. Network administrators
    can use these counters to evaluate the impact of this new ability better.
    
    Export count for rehash attempts to
    1) two SNMP counters: TcpTimeoutRehash (rehash due to timeouts),
       and TcpDuplicateDataRehash (rehash due to receiving duplicate
       packets)
    2) Timestamping API SOF_TIMESTAMPING_OPT_STATS.
    
    Signed-off-by: Abdul Kabbani <akabbani@google.com>
    Signed-off-by: Neal Cardwell <ncardwell@google.com>
    Signed-off-by: Yuchung Cheng <ycheng@google.com>
    Signed-off-by: Kevin(Yudong) Yang <yyd@google.com>
    Signed-off-by: Eric Dumazet <edumazet@google.com>
    Signed-off-by: David S. Miller <davem@davemloft.net>

commit 37f6f8e88caef5f69774b82117ca35bdc4a985d8
Author: Oliver O'Halloran <oohall@gmail.com>
Date:   Fri Nov 1 19:55:22 2019 +1100

    powerpc/powernv: Allow manually invoking special reboots
    
    OPAL provides several different kinds of reboot for the kernel to use,
    namely forcing a full reboot, platform error reboot and MPIPL. Right now
    triggering the alternative resets requires some ad-hoc method such as
    triggering a kernel crash and hoping the stars align. It's sometimes handy
    to be able to trigger one of these resets directly, so add a way to do
    that.
    
    Signed-off-by: Oliver O'Halloran <oohall@gmail.com>
    Signed-off-by: Michael Ellerman <mpe@ellerman.id.au>
    Link: https://lore.kernel.org/r/20191101085522.3055-2-oohall@gmail.com

commit 6f0b46c56ff7e57397c03133f735f4b7ce189302
Author: Peng Fan <peng.fan@nxp.com>
Date:   Wed Dec 18 12:22:32 2019 +0000

    ARM: dts: imx7ulp: fix reg of cpu node
    
    commit b8ab62ff7199fac8ce27fa4a149929034fabe7f8 upstream.
    
    According to arm cpus binding doc,
    "
          On 32-bit ARM v7 or later systems this property is
            required and matches the CPU MPIDR[23:0] register
            bits.
    
            Bits [23:0] in the reg cell must be set to
            bits [23:0] in MPIDR.
    
            All other bits in the reg cell must be set to 0.
    "
    
    In i.MX7ULP, the MPIDR[23:0] is 0xf00, not 0, so fix it.
    Otherwise there will be warning:
    "DT missing boot CPU MPIDR[23:0], fall back to default cpu_logical_map"
    
    Fixes: 20434dc92c05 ("ARM: dts: imx: add common imx7ulp dtsi support")
    Signed-off-by: Peng Fan <peng.fan@nxp.com>
    Reviewed-by: Fabio Estevam <festevam@gmail.com>
    Signed-off-by: Shawn Guo <shawnguo@kernel.org>
    Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>

commit 60fb8a8e93ca94e752a509bb3f6f74068ccca739
Author: Stephen Boyd <swboyd@chromium.org>
Date:   Tue Jan 21 17:24:34 2020 -0800

    platform/chrome: wilco_ec: Allow wilco to be compiled in COMPILE_TEST
    
    Enable this Kconfig on COMPILE_TEST enabled configs so we can get more
    build coverage.
    
    Signed-off-by: Stephen Boyd <swboyd@chromium.org>
    Signed-off-by: Enric Balletbo i Serra <enric.balletbo@collabora.com>

commit 440c24535caf9a2ae393a555b2e23854037d65e2
Author: Krzysztof Kozlowski <krzk@kernel.org>
Date:   Sun Dec 29 19:36:11 2019 +0100

    mtd: onenand: samsung: Fix printing format for size_t on 64-bit
    
    Print size_t as %zu to fix -Wformat warnings when compiling on 64-bit
    platform (e.g. with COMPILE_TEST):
    
        drivers/mtd/nand/onenand/samsung_mtd.c: In function s5pc110_read_bufferram:
        drivers/mtd/nand/onenand/samsung_mtd.c:661:16: warning:
            format %d expects argument of type int, but argument 3 has type size_t {aka long unsigned int} [-Wformat=]
           dev_err(dev, "Couldn't map a %d byte buffer for DMA\n", count);
    
    Signed-off-by: Krzysztof Kozlowski <krzk@kernel.org>
    Signed-off-by: Miquel Raynal <miquel.raynal@bootlin.com>

commit 14b292adcc780b2a319862f22a60054fe72e382f
Author: Krzysztof Kozlowski <krzk@kernel.org>
Date:   Sun Dec 29 19:36:10 2019 +0100

    mtd: onenand: samsung: Fix pointer cast -Wpointer-to-int-cast warnings on 64 bit
    
    iomem pointers should be casted to unsigned long to avoid
    -Wpointer-to-int-cast warnings when compiling on 64-bit platform (e.g.
    with COMPILE_TEST):
    
        drivers/mtd/nand/onenand/samsung_mtd.c: In function s3c_onenand_readw:
        drivers/mtd/nand/onenand/samsung_mtd.c:251:6: warning:
            cast from pointer to integer of different size [-Wpointer-to-int-cast]
          if ((unsigned int) addr < ONENAND_DATARAM && onenand->bootram_command) {
              ^
    
    Signed-off-by: Krzysztof Kozlowski <krzk@kernel.org>
    Signed-off-by: Miquel Raynal <miquel.raynal@bootlin.com>

commit f6003f948226c87b6ce0e5130a43f7b705fe0fd8
Author: Uwe Kleine-Knig <u.kleine-koenig@pengutronix.de>
Date:   Tue Dec 10 11:24:44 2019 +0100

    pwm: sun4i: Narrow scope of local variable
    
    The variable pval is only used in a single block in the function
    sun4i_pwm_calculate(). So declare it in a more local scope to simplify
    the function for humans and compilers.
    
    While at it also simplify assignment to pval.
    
    While the diffstat for this patch is negative for this patch I still
    thing the advantage of having a narrower scope is beneficial.
    
    In my compiler / .config setup (gcc 8.2.1, arm/imx_v6_v7_defconfig +
    COMPILE_TEST + PWM_SUN4I) this change doesn't result in any binary
    changes.
    
    Signed-off-by: Uwe Kleine-Knig <u.kleine-koenig@pengutronix.de>
    Signed-off-by: Thierry Reding <thierry.reding@gmail.com>

commit 9f2919e9b40ec480609ee1f45567531de06ab3fe
Author: Uwe Kleine-Knig <u.kleine-koenig@pengutronix.de>
Date:   Mon Nov 11 10:03:57 2019 +0100

    pwm: omap-dmtimer: Allow compiling with COMPILE_TEST
    
    The dependency on OMAP_DM_TIMER is only a runtime dependency. Also
    OMAP_DM_TIMER cannot be enabled without ARCH_OMAP being enabled.
    
    Signed-off-by: Uwe Kleine-Knig <u.kleine-koenig@pengutronix.de>
    Signed-off-by: Thierry Reding <thierry.reding@gmail.com>

commit 42bbdd99221bac206dde2b5e87098177fcd2a48e
Author: Hongbo Yao <yaohongbo@huawei.com>
Date:   Sat Jan 18 02:53:10 2020 +0530

    phy: ti: j721e-wiz: Fix build error without CONFIG_OF_ADDRESS
    
    If CONFIG_OF_ADDRESS is not set and COMPILE_TEST=y, the following
    error is seen while building phy-j721e-wiz.c
    
    drivers/phy/ti/phy-j721e-wiz.o: In function `wiz_remove':
    phy-j721e-wiz.c:(.text+0x1a): undefined reference to
    `of_platform_device_destroy'
    
    Fix the config dependency for PHY_J721E_WIZ here.
    
    Reported-by: Hulk Robot <hulkci@huawei.com>
    Fixes: 091876cc355d ("phy: ti: j721e-wiz: Add support for WIZ module present in TI J721E SoC")
    Signed-off-by: Hongbo Yao <yaohongbo@huawei.com>
    Signed-off-by: Kishon Vijay Abraham I <kishon@ti.com>
    Link: https://lore.kernel.org/r/20200117212310.2864-1-kishon@ti.com
    Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>

commit bfa120840905c94616fd6200a9bf3a37e2ede938
Author: Arnd Bergmann <arnd@arndb.de>
Date:   Thu Dec 12 10:56:31 2019 +0900

    PM / devfreq: tegra: Add COMMON_CLK dependency
    
    commit 5fdb0684b5b0f41402161f068d3d84bf6ed1c3f4 upstream.
    
    Compile-testing this driver fails if CONFIG_COMMON_CLK is not set:
    
    drivers/devfreq/tegra30-devfreq.o: In function `tegra_devfreq_target':
    tegra30-devfreq.c:(.text+0x164): undefined reference to `clk_set_min_rate'
    
    Fixes: 35f8dbc72721 ("PM / devfreq: tegra: Enable COMPILE_TEST for the driver")
    Signed-off-by: Arnd Bergmann <arnd@arndb.de>
    Reviewed-by: Dmitry Osipenko <digetx@gmail.com>
    Signed-off-by: Chanwoo Choi <cw00.choi@samsung.com>
    Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>

commit 854e334903dfed8eae58c7ddc43945e3885c4bfb
Merge: b3a987b0264d 490a421bc575
Author: Rafael J. Wysocki <rafael.j.wysocki@intel.com>
Date:   Fri Jan 17 11:19:45 2020 +0100

    Merge tag 'devfreq-next-for-5.6' of git://git.kernel.org/pub/scm/linux/kernel/git/chanwoo/linux
    
    Pull devfreq updates for v5.6 from Chanwoo Choi:
    
    "1. Update devfreq core
    
     - Add new 'name' attribute of sysfs to show the device name
       : /sys/class/devfreq/devfreqX/name
    
     - Make 'trans_stat' sysfs reset by entering zero(0)
       : echo 0 > /sys/class/devfreq/devfreqX/trans_stat
    
     - Add debugfs support with 'devfreq_summary' to show the summary
       : /sys/kernel/debug/devfreq/devfreq_summary
    
     - Change the type of time variable to 64bit to avoid overflows.
    
     - Make separate devfreq_stats including the statistics information.
    
     - Fix minor coding-style like indentation and kernel-doc warnings.
    
     2. Update devfreq drivers
    
     - Add new imx8m-ddrc.c devfreq driver for dynamic scaling of DDR frequency.
       It changes the DDR frequency by using ARM SMCCC(SMC Calling Convention)
       interface to control TF-A firmware.
    
     - Add COMPILE_TEST dependency for rk3399_dmc.c.
    
     - Clean-up code for exynos-bus.c and rk3399_dmc.c without behavior changes
    
     3. Update devfreq-event drivers
    
     - Fix excessive stack usage of exynos-ppmu.c and clean-up code of
       rockchip-dfi.c without behavior changes."
    
    * tag 'devfreq-next-for-5.6' of git://git.kernel.org/pub/scm/linux/kernel/git/chanwoo/linux: (24 commits)
      PM / devfreq: Add debugfs support with devfreq_summary file
      PM / devfreq: exynos: Rename Exynos to lowercase
      PM / devfreq: imx8m-ddrc: Fix inconsistent IS_ERR and PTR_ERR
      PM / devfreq: exynos-bus: Add error log when fail to get devfreq-event
      PM / devfreq: exynos-bus: Disable devfreq-event device when fails
      PM / devfreq: rk3399_dmc: Disable devfreq-event device when fails
      PM / devfreq: imx8m-ddrc: Remove unused defines
      PM / devfreq: exynos-bus: Reduce goto statements and remove unused headers
      PM / devfreq: rk3399_dmc: Add COMPILE_TEST and HAVE_ARM_SMCCC dependency
      PM / devfreq: rockchip-dfi: Convert to devm_platform_ioremap_resource
      PM / devfreq: rk3399_dmc: Add missing of_node_put()
      PM / devfreq: rockchip-dfi: Add missing of_node_put()
      PM / devfreq: Fix multiple kernel-doc warnings
      PM / devfreq: exynos-bus: Extract exynos_bus_profile_init_passive()
      PM / devfreq: exynos-bus: Extract exynos_bus_profile_init()
      PM / devfreq: Move declaration of DEVICE_ATTR_RW(min_freq)
      PM / devfreq: Move statistics to separate struct devfreq_stats
      PM / devfreq: Add clearing transitions stats
      PM / devfreq: Change time stats to 64-bit
      PM / devfreq: Add new name attribute for sysfs
      ...

commit 0f827273178f5656edf1210dc94b8653df7580bf
Merge: c7ce73eb0185 f52cdcce9197
Author: Olof Johansson <olof@lixom.net>
Date:   Thu Jan 16 10:47:27 2020 -0800

    Merge tag 'imx-driver-5.6' of git://git.kernel.org/pub/scm/linux/kernel/git/shawnguo/linux into arm/drivers
    
    i.MX driver changes for 5.6:
    
     - Add i.MX8MP SoC driver support.
     - Allow IMX DSP Protocol driver to be built as module.
     - Add COMPILE_TEST for IMX_SCU_SOC driver to increase build coverage.
     - Print SoC type and revision in i.MX8 SoC driver, as this is useful
       information to have when looking through boot log.
    
    * tag 'imx-driver-5.6' of git://git.kernel.org/pub/scm/linux/kernel/git/shawnguo/linux:
      firmware: imx: Allow IMX DSP to be selected as module
      soc: imx: Enable compile testing of IMX_SCU_SOC
      soc: imx: Add i.MX8MP SoC driver support
      soc: imx8: print SoC type and revision
    
    Link: https://lore.kernel.org/r/20200113034006.17430-1-shawnguo@kernel.org
    Signed-off-by: Olof Johansson <olof@lixom.net>

commit 40b2ec1251c370bc5557568e259d4058c651d405
Author: Krzysztof Kozlowski <krzk@kernel.org>
Date:   Wed Jan 15 21:02:50 2020 +0100

    i2c: highlander: Use proper printk format for size_t
    
    size_t should be printed with its own format to be 64-bit friendly and
    fix warning when compiling on 64-bit platform (e.g. with COMPILE_TEST):
    
        drivers/i2c/busses/i2c-highlander.c: In function highlander_i2c_smbus_xfer:
        drivers/i2c/busses/i2c-highlander.c:325:22: warning:
            format %d expects argument of type int,
            but argument 3 has type size_t {aka long unsigned int} [-Wformat=]
    
    Signed-off-by: Krzysztof Kozlowski <krzk@kernel.org>
    Signed-off-by: Wolfram Sang <wsa@the-dreams.de>

commit 17b3fe8b04ec92161638378744d4d915fd8cfa2e
Author: Krzysztof Kozlowski <krzk@kernel.org>
Date:   Wed Jan 15 21:02:49 2020 +0100

    i2c: pnx: Use proper printk format for resource_size_t
    
    resource_size_t should be printed with its own size-independent format
    to fix warnings when compiling on 64-bit platform (e.g. with
    COMPILE_TEST):
    
        drivers/i2c/busses/i2c-pnx.c: In function i2c_pnx_probe:
        drivers/i2c/busses/i2c-pnx.c:737:47: warning:
            format %x expects argument of type unsigned int,
            but argument 5 has type resource_size_t {aka long long unsigned int} [-Wformat=]
    
    Signed-off-by: Krzysztof Kozlowski <krzk@kernel.org>
    Signed-off-by: Wolfram Sang <wsa@the-dreams.de>

commit 066e6e805d4af26d24776f4628683ddcef6297f7
Author: Krzysztof Kozlowski <krzk@kernel.org>
Date:   Wed Jan 15 21:02:48 2020 +0100

    i2c: pmcmsp: Use proper printk format for resource_size_t
    
    resource_size_t should be printed with its own size-independent format
    to fix warnings when compiling on 64-bit platform (e.g. with
    COMPILE_TEST):
    
        drivers/i2c/busses/i2c-pmcmsp.c: In function pmcmsptwi_probe:
        drivers/i2c/busses/i2c-pmcmsp.c:276:25: warning:
            format %x expects argument of type unsigned int,
            but argument 3 has type resource_size_t {aka long long unsigned int} [-Wformat=]
    
    Signed-off-by: Krzysztof Kozlowski <krzk@kernel.org>
    Signed-off-by: Wolfram Sang <wsa@the-dreams.de>

commit 49945ef0f90b5becef67db68338e8ce34ef70975
Author: Krzysztof Kozlowski <krzk@kernel.org>
Date:   Tue Jan 14 10:06:05 2020 +0100

    i2c: stu300: Use proper printk format for iomem pointer
    
    iomem pointers should be printed with pointer format to hide the
    actual value and fix warnings when compiling on 64-bit platform (e.g. with
    COMPILE_TEST):
    
        drivers/i2c/busses/i2c-stu300.c: In function stu300_wait_while_busy:
        drivers/i2c/busses/i2c-stu300.c:446:76: warning:
            cast from pointer to integer of different size [-Wpointer-to-int-cast]
    
    Signed-off-by: Krzysztof Kozlowski <krzk@kernel.org>
    Reviewed-by: Linus Walleij <linus.walleij@linaro.org>
    Signed-off-by: Wolfram Sang <wsa@the-dreams.de>

commit 4f80b70e1953cb846dbdd1ce72cb17333d4c8d11
Author: Krzysztof Kozlowski <krzk@kernel.org>
Date:   Fri Jan 3 17:39:25 2020 +0100

    parisc: Use proper printk format for resource_size_t
    
    resource_size_t should be printed with its own size-independent format
    to fix warnings when compiling on 64-bit platform (e.g. with
    COMPILE_TEST):
    
        arch/parisc/kernel/drivers.c: In function 'print_parisc_device':
        arch/parisc/kernel/drivers.c:892:9: warning:
            format '%p' expects argument of type 'void *',
            but argument 4 has type 'resource_size_t {aka unsigned int}' [-Wformat=]
    
    Signed-off-by: Krzysztof Kozlowski <krzk@kernel.org>
    Signed-off-by: Helge Deller <deller@gmx.de>

commit 3346358055dfc6e45b1c5c8ff29f39c0e9b9fde2
Author: Arnd Bergmann <arnd@arndb.de>
Date:   Wed Dec 11 14:39:28 2019 +0100

    gcc-plugins: make it possible to disable CONFIG_GCC_PLUGINS again
    
    commit a5b0dc5a46c221725c43bd9b01570239a4cd78b1 upstream.
    
    I noticed that randconfig builds with gcc no longer produce a lot of
    ccache hits, unlike with clang, and traced this back to plugins
    now being enabled unconditionally if they are supported.
    
    I am now working around this by adding
    
       export CCACHE_COMPILERCHECK=/usr/bin/size -A %compiler%
    
    to my top-level Makefile. This changes the heuristic that ccache uses
    to determine whether the plugins are the same after a 'make clean'.
    
    However, it also seems that being able to just turn off the plugins is
    generally useful, at least for build testing it adds noticeable overhead
    but does not find a lot of bugs additional bugs, and may be easier for
    ccache users than my workaround.
    
    Fixes: 9f671e58159a ("security: Create "kernel hardening" config area")
    Signed-off-by: Arnd Bergmann <arnd@arndb.de>
    Acked-by: Ard Biesheuvel <ardb@kernel.org>
    Reviewed-by: Masahiro Yamada <masahiroy@kernel.org>
    Link: https://lore.kernel.org/r/20191211133951.401933-1-arnd@arndb.de
    Cc: stable@vger.kernel.org
    Signed-off-by: Kees Cook <keescook@chromium.org>
    Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>

commit a566696cf9f27f701cd4a6426d46f112c180059c
Merge: 528d06d41b80 3cacb2086e41
Author: Dave Airlie <airlied@redhat.com>
Date:   Thu Jan 9 10:46:07 2020 +1000

    Merge tag 'drm-misc-next-2020-01-07' of git://anongit.freedesktop.org/drm/drm-misc into drm-next
    
    drm-misc-next for v5.6:
    
    UAPI Changes:
    - Allow overriding number of bootup penguins in fbcon using fbcon=logo-count:n.
    
    Cross-subsystem Changes:
    - fbdev fixes for mmp, and make it work with CONFIG_COMPILE_TEST.
    - Use devm_platform_ioremap_resource in fbdev drivers.
    - Various small fbdev fixes.
    
    Core Changes:
    - Support scanline alignment for dumb buffers.
    - Add atomic_check() hook to bridge ops, to support bus format negotiation.
    - Add gem_create_object() to vram helpers.
    
    Driver Changes:
    - Rockchip: Add support for PX30.
    - Use generic fbdev code and dumb helpers in hisilicon/hibmc.
    - Add support for Leadtek LTK500HD1829 panel, and xinpeng XPP055C272.
    - Clock fixes for atmel-hlcdc.
    - Various smaller fixes to all drivers.
    
    Signed-off-by: Dave Airlie <airlied@redhat.com>
    
    From: Maarten Lankhorst <maarten.lankhorst@linux.intel.com>
    Link: https://patchwork.freedesktop.org/patch/msgid/8eff1e3f-ef0a-2dd9-9a14-6273b1d6f963@linux.intel.com

commit 2ec1431ffac9f891a11ac955a9ee914e0547215e
Author: kbuild test robot <lkp@intel.com>
Date:   Sat Jan 4 21:43:31 2020 +0100

    video: fbdev: mmp: fix platform_get_irq.cocci warnings
    
    Remove dev_err() messages after platform_get_irq*() failures.
    Line 450 is redundant because platform_get_irq() already prints
    an error.
    
    Generated by: scripts/coccinelle/api/platform_get_irq.cocci
    
    Fixes: dd90e9ae55a1 ("video: fbdev: mmp: add COMPILE_TEST support")
    Signed-off-by: kbuild test robot <lkp@intel.com>
    Signed-off-by: Julia Lawall <julia.lawall@inria.fr>
    Signed-off-by: Daniel Vetter <daniel.vetter@ffwll.ch>
    Link: https://patchwork.freedesktop.org/patch/msgid/alpine.DEB.2.21.2001042140310.6944@hadrien

commit dd90e9ae55a1e7efd3ac036afe9f7ae7bb64d39d
Author: Bartlomiej Zolnierkiewicz <b.zolnierkie@samsung.com>
Date:   Thu Jun 27 16:07:43 2019 +0200

    video: fbdev: mmp: add COMPILE_TEST support
    
    Add COMPILE_TEST support to mmp display subsystem for better compile
    testing coverage.
    
    Reviewed-by: Andrzej Hajda <a.hajda@samsung.com>
    Signed-off-by: Bartlomiej Zolnierkiewicz <b.zolnierkie@samsung.com>
    Link: https://patchwork.freedesktop.org/patch/msgid/d21a19ea-8c18-80df-ae79-76de7c5ee67c@samsung.com

commit d3f623ae8e0323ca434ee9029100312a8be37773
Author: Sreekanth Reddy <sreekanth.reddy@broadcom.com>
Date:   Thu Dec 26 06:13:25 2019 -0500

    scsi: mpt3sas: Add support for NVMe shutdown
    
    Introduce function _scsih_nvme_shutdown() to issue IO Unit Control message
    to IOC firmware with operation code 'shutdown'. This causes IOC firmware to
    issue NVMe shutdown commands to all NVMe drives attached to it.
    
    NVMe Shutdown:
    
    NVMe devices need to have a specific shutdown sequence performed before
    power is removed. For this, the IOC firmware needs to be notified when the
    system is being shutdown. So during the system shutdown time, driver issues
    an IO Unit Control request with operation code MPI26_CTRL_OP_SHUTDOWN to
    inform firmware that a shutdown is initiated.
    
    This shutdown command is issued only if NVMe devices are attached to the
    controller.
    
    During each NVMe device addition, driver reads pcie device page2 to get
    shutdown latency (e.g. drive's RTD3 Entry Latency) and updates the max
    latency value among the added NVMe drives in ioc->max_shutdown_latency.
    This is used as the timeout value for IO Unit Control command at the time
    of shutdown.
    
    When a NVMe drive is removed and its shutdown latency matches which
    ioc->max_shutdown_latency then ioc->max_shutdown_latency is updated to next
    max value (by iterating over the list of available devices).  If the
    shutdown latency is 0, then default timeout is set to six seconds.
    
    Link: https://lore.kernel.org/r/20191226111333.26131-3-sreekanth.reddy@broadcom.com
    Signed-off-by: Sreekanth Reddy <sreekanth.reddy@broadcom.com>
    Signed-off-by: Martin K. Petersen <martin.petersen@oracle.com>

commit 1ade26b616cc2da0b7277a97e3799c99bae0655b
Author: Sreekanth Reddy <sreekanth.reddy@broadcom.com>
Date:   Thu Dec 26 06:13:24 2019 -0500

    scsi: mpt3sas: Update MPI Headers to v02.00.57
    
    Update MPI Headers to version 02.00.57.
    
    Link: https://lore.kernel.org/r/20191226111333.26131-2-sreekanth.reddy@broadcom.com
    Signed-off-by: Sreekanth Reddy <sreekanth.reddy@broadcom.com>
    Signed-off-by: Martin K. Petersen <martin.petersen@oracle.com>

commit a5b0dc5a46c221725c43bd9b01570239a4cd78b1
Author: Arnd Bergmann <arnd@arndb.de>
Date:   Wed Dec 11 14:39:28 2019 +0100

    gcc-plugins: make it possible to disable CONFIG_GCC_PLUGINS again
    
    I noticed that randconfig builds with gcc no longer produce a lot of
    ccache hits, unlike with clang, and traced this back to plugins
    now being enabled unconditionally if they are supported.
    
    I am now working around this by adding
    
       export CCACHE_COMPILERCHECK=/usr/bin/size -A %compiler%
    
    to my top-level Makefile. This changes the heuristic that ccache uses
    to determine whether the plugins are the same after a 'make clean'.
    
    However, it also seems that being able to just turn off the plugins is
    generally useful, at least for build testing it adds noticeable overhead
    but does not find a lot of bugs additional bugs, and may be easier for
    ccache users than my workaround.
    
    Fixes: 9f671e58159a ("security: Create "kernel hardening" config area")
    Signed-off-by: Arnd Bergmann <arnd@arndb.de>
    Acked-by: Ard Biesheuvel <ardb@kernel.org>
    Reviewed-by: Masahiro Yamada <masahiroy@kernel.org>
    Link: https://lore.kernel.org/r/20191211133951.401933-1-arnd@arndb.de
    Cc: stable@vger.kernel.org
    Signed-off-by: Kees Cook <keescook@chromium.org>

commit d98020a3fddd027f154b7adc12c6c9f9aa4f0216
Author: Pierre-Louis Bossart <pierre-louis.bossart@linux.intel.com>
Date:   Fri Nov 1 12:30:39 2019 -0500

    ASoC: SOF: imx: fix reverse CONFIG_SND_SOC_SOF_OF dependency
    
    [ Upstream commit f9ad75468453b019b92c5296e6a04bf7c37f49e4 ]
    
    updated solution to the problem reported with randconfig:
    
    CONFIG_SND_SOC_SOF_IMX depends on CONFIG_SND_SOC_SOF, but is in
    turn referenced by the sof-of-dev driver. This creates a reverse
    dependency that manifests in a link error when CONFIG_SND_SOC_SOF_OF
    is built-in but CONFIG_SND_SOC_SOF_IMX=m:
    
    sound/soc/sof/sof-of-dev.o:(.data+0x118): undefined reference to `sof_imx8_ops'
    
    use def_trisate to propagate the right settings without select.
    
    Fixes: f4df4e4042b0 ("ASoC: SOF: imx8: Fix COMPILE_TEST error")
    Fixes: 202acc565a1f ("ASoC: SOF: imx: Add i.MX8 HW support")
    Suggested-by: Arnd Bergmann <arnd@arndb.de>
    Signed-off-by: Pierre-Louis Bossart <pierre-louis.bossart@linux.intel.com>
    Link: https://lore.kernel.org/r/20191101173045.27099-6-pierre-louis.bossart@linux.intel.com
    Signed-off-by: Mark Brown <broonie@kernel.org>
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit eff5d31f7407fa9d31fb840106f1593399457298
Author: Chanwoo Choi <cw00.choi@samsung.com>
Date:   Thu Dec 12 11:20:30 2019 +0900

    PM / devfreq: rk3399_dmc: Add COMPILE_TEST and HAVE_ARM_SMCCC dependency
    
    To build test, add COMPILE_TEST depedency to both ARM_RK3399_DMC_DEVFREQ
    and DEVFREQ_EVENT_ROCKCHIP_DFI configuration. And ARM_RK3399_DMC_DEVFREQ
    used the SMCCC interface so that add HAVE_ARM_SMCCC dependency to prevent
    the build break.
    
    Reported-by: kbuild test robot <lkp@intel.com>
    Signed-off-by: Chanwoo Choi <cw00.choi@samsung.com>

commit 5af744ebae856a50e8b5e208a5acf28713a4ce98
Author: Leonard Crestez <leonard.crestez@nxp.com>
Date:   Fri Nov 22 23:45:03 2019 +0200

    PM / devfreq: Add dynamic scaling for imx8m ddr controller
    
    Add driver for dynamic scaling the DDR Controller on imx8m chips. Actual
    frequency switching is implemented inside TF-A, this driver wraps the
    SMC calls and synchronizes the clk tree.
    
    The DRAM clocks on imx8m have the following structure (abridged):
    
     +----------+       |\            +------+
     | dram_pll |-------|M| dram_core |      |
     +----------+       |U|---------->| D    |
                     /--|X|           |  D   |
       dram_alt_root |  |/            |   R  |
                     |                |    C |
                +---------+           |      |
                |FIX DIV/4|           |      |
                +---------+           |      |
      composite:     |                |      |
     +----------+    |                |      |
     | dram_alt |----/                |      |
     +----------+                     |      |
     | dram_apb |-------------------->|      |
     +----------+                     +------+
    
    The dram_pll is used for higher rates and dram_alt is used for lower
    rates. The dram_alt and dram_apb clocks are "imx composite" and their
    parent can also be modified.
    
    This driver will prepare/enable the new parents ahead of switching (so
    that the expected roots are enabled) and afterwards it will call
    clk_set_parent to ensure the parents in clock framework are up-to-date.
    
    The driver relies on dram_pll dram_alt and dram_apb being marked with
    CLK_GET_RATE_NOCACHE for rate updates.
    
    Signed-off-by: Leonard Crestez <leonard.crestez@nxp.com>
    Acked-by: Chanwoo Choi <cw00.choi@samsung.com>
    [cw00.choi: Edit the COMPILE_TEST module dependency in Kconfig]
    Signed-off-by: Chanwoo Choi <cw00.choi@samsung.com>

commit f685e609a301f171b62ee52a69acc3a74c2c04aa
Author: Vladimir Oltean <olteanv@gmail.com>
Date:   Sat Dec 28 15:30:46 2019 +0200

    net: dsa: Deny PTP on master if switch supports it
    
    It is possible to kill PTP on a DSA switch completely and absolutely,
    until a reboot, with a simple command:
    
    tcpdump -i eth2 -j adapter_unsynced
    
    where eth2 is the switch's DSA master.
    
    Why? Well, in short, the PTP API in place today is a bit rudimentary and
    relies on applications to retrieve the TX timestamps by polling the
    error queue and looking at the cmsg structure. But there is no timestamp
    identification of any sorts (except whether it's HW or SW), you don't
    know how many more timestamps are there to come, which one is this one,
    from whom it is, etc. In other words, the SO_TIMESTAMPING API is
    fundamentally limited in that you can get a single HW timestamp from the
    stack.
    
    And the "-j adapter_unsynced" flag of tcpdump enables hardware
    timestamping.
    
    So let's imagine what happens when the DSA master decides it wants to
    deliver TX timestamps to the skb's socket too:
    - The timestamp that the user space sees is taken by the DSA master.
      Whereas the RX timestamp will eventually be overwritten by the DSA
      switch. So the RX and TX timestamps will be in different time bases
      (aka garbage).
    - The user space applications have no way to deal with the second (real)
      TX timestamp finally delivered by the DSA switch, or even to know to
      wait for it.
    
    Take ptp4l from the linuxptp project, for example. This is its behavior
    after running tcpdump, before the patch:
    
    ptp4l[172]: [6469.594] Unexpected data on socket err queue:
    ptp4l[172]: [6469.693] rms    8 max   16 freq -21257 +/-  11 delay   748 +/-   0
    ptp4l[172]: [6469.711] Unexpected data on socket err queue:
    ptp4l[172]: 0020 00 00 00 1f 7b ff fe 63 02 48 00 03 aa 05 00 fd
    ptp4l[172]: 0030 00 00 00 00 00 00 00 00 00 00
    ptp4l[172]: [6469.721] Unexpected data on socket err queue:
    ptp4l[172]: 0000 01 80 c2 00 00 0e 00 1f 7b 63 02 48 88 f7 10 02
    ptp4l[172]: 0010 00 2c 00 00 02 00 00 00 00 00 00 00 00 00 00 00
    ptp4l[172]: 0020 00 00 00 1f 7b ff fe 63 02 48 00 01 c6 b1 00 fd
    ptp4l[172]: 0030 00 00 00 00 00 00 00 00 00 00
    ptp4l[172]: [6469.838] Unexpected data on socket err queue:
    ptp4l[172]: 0000 01 80 c2 00 00 0e 00 1f 7b 63 02 48 88 f7 10 02
    ptp4l[172]: 0010 00 2c 00 00 02 00 00 00 00 00 00 00 00 00 00 00
    ptp4l[172]: 0020 00 00 00 1f 7b ff fe 63 02 48 00 03 aa 06 00 fd
    ptp4l[172]: 0030 00 00 00 00 00 00 00 00 00 00
    ptp4l[172]: [6469.848] Unexpected data on socket err queue:
    ptp4l[172]: 0000 01 80 c2 00 00 0e 00 1f 7b 63 02 48 88 f7 13 02
    ptp4l[172]: 0010 00 36 00 00 02 00 00 00 00 00 00 00 00 00 00 00
    ptp4l[172]: 0020 00 00 00 1f 7b ff fe 63 02 48 00 04 1a 45 05 7f
    ptp4l[172]: 0030 00 00 5e 05 41 32 27 c2 1a 68 00 04 9f ff fe 05
    ptp4l[172]: 0040 de 06 00 01
    ptp4l[172]: [6469.855] Unexpected data on socket err queue:
    ptp4l[172]: 0000 01 80 c2 00 00 0e 00 1f 7b 63 02 48 88 f7 10 02
    ptp4l[172]: 0010 00 2c 00 00 02 00 00 00 00 00 00 00 00 00 00 00
    ptp4l[172]: 0020 00 00 00 1f 7b ff fe 63 02 48 00 01 c6 b2 00 fd
    ptp4l[172]: 0030 00 00 00 00 00 00 00 00 00 00
    ptp4l[172]: [6469.974] Unexpected data on socket err queue:
    ptp4l[172]: 0000 01 80 c2 00 00 0e 00 1f 7b 63 02 48 88 f7 10 02
    ptp4l[172]: 0010 00 2c 00 00 02 00 00 00 00 00 00 00 00 00 00 00
    ptp4l[172]: 0020 00 00 00 1f 7b ff fe 63 02 48 00 03 aa 07 00 fd
    ptp4l[172]: 0030 00 00 00 00 00 00 00 00 00 00
    
    The ptp4l program itself is heavily patched to show this (more details
    here [0]). Otherwise, by default it just hangs.
    
    On the other hand, with the DSA patch to disallow HW timestamping
    applied:
    
    tcpdump -i eth2 -j adapter_unsynced
    tcpdump: SIOCSHWTSTAMP failed: Device or resource busy
    
    So it is a fact of life that PTP timestamping on the DSA master is
    incompatible with timestamping on the switch MAC, at least with the
    current API. And if the switch supports PTP, taking the timestamps from
    the switch MAC is highly preferable anyway, due to the fact that those
    don't contain the queuing latencies of the switch. So just disallow PTP
    on the DSA master if there is any PTP-capable switch attached.
    
    [0]: https://sourceforge.net/p/linuxptp/mailman/message/36880648/
    
    Fixes: 0336369d3a4d ("net: dsa: forward hardware timestamping ioctls to switch driver")
    Signed-off-by: Vladimir Oltean <olteanv@gmail.com>
    Acked-by: Richard Cochran <richardcochran@gmail.com>
    Signed-off-by: David S. Miller <davem@davemloft.net>

commit aea3dee86c414caa43a87d6cfc2e03e87c1e76c9
Merge: 9f6cff995e98 bad1eaa6ac31
Author: David S. Miller <davem@davemloft.net>
Date:   Wed Dec 25 19:51:34 2019 -0800

    Merge branch 'Peer-to-Peer-One-Step-time-stamping'
    
    Richard Cochran says:
    
    ====================
    Peer to Peer One-Step time stamping
    
    This series adds support for PTP (IEEE 1588) P2P one-step time
    stamping along with a driver for a hardware device that supports this.
    
    If the hardware supports p2p one-step, it subtracts the ingress time
    stamp value from the Pdelay_Request correction field.  The user space
    software stack then simply copies the correction field into the
    Pdelay_Response, and on transmission the hardware adds the egress time
    stamp into the correction field.
    
    This new functionality extends CONFIG_NETWORK_PHY_TIMESTAMPING to
    cover MII snooping devices, but it still depends on phylib, just as
    that option does.  Expanding beyond phylib is not within the scope of
    the this series.
    
    User space support is available in the current linuxptp master branch.
    
    - Patch 1 adds phy_device methods for existing time stamping fields.
    - Patches 2-5 convert the stack and drivers to the new methods.
    - Patch 6 moves code around the dp83640 driver.
    - Patches 7-10 add support for MII time stamping in non-PHY devices.
    - Patch 11 adds the new P2P 1-step option.
    - Patch 12 adds a driver implementing the new option.
    
    Thanks,
    Richard
    
    Changed in v9:
    ~~~~~~~~~~~~~~
    
    - Fix two more drivers' switch/case blocks WRT the new HWTSTAMP ioctl.
    - Picked up two more review tags from Andrew.
    
    Changed in v8:
    ~~~~~~~~~~~~~~
    
    - Avoided adding forward functional declarations in the dp83640 driver.
    - Picked up Florian's new review tags and another one from Andrew.
    
    Changed in v7:
    ~~~~~~~~~~~~~~
    
    - Converted pr_debug|err to dev_ variants in new driver.
    - Fixed device tree documentation per Rob's v6 review.
    - Picked up Andrew's and Rob's review tags.
    - Silenced sparse warnings in new driver.
    
    Changed in v6:
    ~~~~~~~~~~~~~~
    
    - Added methods for accessing the phy_device time stamping fields.
    - Adjust the device tree documentation per Rob's v5 review.
    - Fixed the build failures due to missing exports.
    
    Changed in v5:
    ~~~~~~~~~~~~~~
    
    - Fixed build failure in macvlan.
    - Fixed latent bug with its gcc warning in the driver.
    
    Changed in v4:
    ~~~~~~~~~~~~~~
    
    - Correct error paths and PTR_ERR return values in the framework.
    - Expanded KernelDoc comments WRT PHY locking.
    - Pick up Andrew's review tag.
    
    Changed in v3:
    ~~~~~~~~~~~~~~
    
    - Simplify the device tree binding and document the time stamping
      phandle by itself.
    
    Changed in v2:
    ~~~~~~~~~~~~~~
    
    - Per the v1 review, changed the modeling of MII time stamping
      devices.  They are no longer a kind of mdio device.
    ====================
    
    Signed-off-by: David S. Miller <davem@davemloft.net>

commit 2cb7bfc1ca9a34ca148ed77f5f6f07373312bb0a
Merge: 46cf053efec6 5fdb0684b5b0
Author: Rafael J. Wysocki <rafael.j.wysocki@intel.com>
Date:   Wed Dec 25 15:15:55 2019 +0100

    Merge tag 'devfreq-fixes-for-5.5-rc4' of git://git.kernel.org/pub/scm/linux/kernel/git/chanwoo/linux
    
    Pull devfreq fixes for 5.5-rc4 from Chanwoo Choi:
    
    "1. Fix the build error of tegra*-devfreq.c when COMPILE_TEST is enabled.
     2. Drop unneeded PM_OPP dependency from each driver in Kconfig."
    
    * tag 'devfreq-fixes-for-5.5-rc4' of git://git.kernel.org/pub/scm/linux/kernel/git/chanwoo/linux:
      PM / devfreq: tegra: Add COMMON_CLK dependency
      PM / devfreq: Drop explicit selection of PM_OPP

commit b8ab62ff7199fac8ce27fa4a149929034fabe7f8
Author: Peng Fan <peng.fan@nxp.com>
Date:   Wed Dec 18 12:22:32 2019 +0000

    ARM: dts: imx7ulp: fix reg of cpu node
    
    According to arm cpus binding doc,
    "
          On 32-bit ARM v7 or later systems this property is
            required and matches the CPU MPIDR[23:0] register
            bits.
    
            Bits [23:0] in the reg cell must be set to
            bits [23:0] in MPIDR.
    
            All other bits in the reg cell must be set to 0.
    "
    
    In i.MX7ULP, the MPIDR[23:0] is 0xf00, not 0, so fix it.
    Otherwise there will be warning:
    "DT missing boot CPU MPIDR[23:0], fall back to default cpu_logical_map"
    
    Fixes: 20434dc92c05 ("ARM: dts: imx: add common imx7ulp dtsi support")
    Signed-off-by: Peng Fan <peng.fan@nxp.com>
    Reviewed-by: Fabio Estevam <festevam@gmail.com>
    Signed-off-by: Shawn Guo <shawnguo@kernel.org>

commit 5fdb0684b5b0f41402161f068d3d84bf6ed1c3f4
Author: Arnd Bergmann <arnd@arndb.de>
Date:   Thu Dec 12 10:56:31 2019 +0900

    PM / devfreq: tegra: Add COMMON_CLK dependency
    
    Compile-testing this driver fails if CONFIG_COMMON_CLK is not set:
    
    drivers/devfreq/tegra30-devfreq.o: In function `tegra_devfreq_target':
    tegra30-devfreq.c:(.text+0x164): undefined reference to `clk_set_min_rate'
    
    Fixes: 35f8dbc72721 ("PM / devfreq: tegra: Enable COMPILE_TEST for the driver")
    Signed-off-by: Arnd Bergmann <arnd@arndb.de>
    Reviewed-by: Dmitry Osipenko <digetx@gmail.com>
    Signed-off-by: Chanwoo Choi <cw00.choi@samsung.com>

commit 6c1c79a5f4eead27465d4d1d97ce230163772a78
Merge: 6210469417fd 28f94a44298c
Author: Linus Torvalds <torvalds@linux-foundation.org>
Date:   Sat Dec 21 10:49:47 2019 -0800

    Merge tag 'kbuild-fixes-v5.5' of git://git.kernel.org/pub/scm/linux/kernel/git/masahiroy/linux-kbuild
    
    Pull Kbuild fixes from Masahiro Yamada:
    
     - fix warning in out-of-tree 'make clean'
    
     - add READELF variable to the top Makefile
    
     - fix broken builds when LINUX_COMPILE_BY contains a backslash
    
     - fix build warning in kallsyms
    
     - fix NULL pointer access in expr_eq() in Kconfig
    
     - fix missing dependency on rsync in deb-pkg build
    
     - remove ---help--- from documentation
    
     - fix misleading documentation about directory descending
    
    * tag 'kbuild-fixes-v5.5' of git://git.kernel.org/pub/scm/linux/kernel/git/masahiroy/linux-kbuild:
      kbuild: clarify the difference between obj-y and obj-m w.r.t. descending
      kconfig: remove ---help--- from documentation
      scripts: package: mkdebian: add missing rsync dependency
      kconfig: don't crash on NULL expressions in expr_eq()
      scripts/kallsyms: fix offset overflow of kallsyms_relative_base
      mkcompile_h: use printf for LINUX_COMPILE_BY
      mkcompile_h: git rid of UTS_TRUNCATE from LINUX_COMPILE_{BY,HOST}
      x86/boot: kbuild: allow readelf executable to be specified
      kbuild: fix 'No such file or directory' warning when cleaning

commit f9daaba80483fa1f5740c9fef89e95a9879c38a4
Author: Michael Hernandez <mhernandez@marvell.com>
Date:   Tue Dec 3 14:36:56 2019 -0800

    scsi: qla2xxx: Added support for MPI and PEP regions for ISP28XX
    
    commit a530bf691f0e4691214562c165e6c8889dc51e57 upstream.
    
    This patch adds support for MPI/PEP region updates which is required with
    secure flash updates for ISP28XX.
    
    Fixes: 3f006ac342c0 ("scsi: qla2xxx: Secure flash update support for ISP28XX")
    Cc: stable@vger.kernel.org
    Link: https://lore.kernel.org/r/20191203223657.22109-3-hmadhani@marvell.com
    Signed-off-by: Michael Hernandez <mhernandez@marvell.com>
    Signed-off-by: Himanshu Madhani <hmadhani@marvell.com>
    Signed-off-by: Martin K. Petersen <martin.petersen@oracle.com>
    Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>

commit 225a2ec19aac426ef29f0e4accfc890c87d38bdc
Author: Krzysztof Kozlowski <krzk@kernel.org>
Date:   Fri Dec 13 08:24:33 2019 +0100

    pinctrl: samsung: Fix missing OF and GPIOLIB dependency on S3C24xx and S3C64xx
    
    All Samsung pinctrl drivers select common part - PINCTRL_SAMSUNG which uses
    both OF and GPIOLIB inside.  However only Exynos drivers depend on these,
    therefore after enabling COMPILE_TEST, on x86_64 build of S3C64xx driver
    failed:
    
        drivers/pinctrl/samsung/pinctrl-samsung.c: In function samsung_gpiolib_register:
        drivers/pinctrl/samsung/pinctrl-samsung.c:969:5: error: struct gpio_chip has no member named of_node
           gc->of_node = bank->of_node;
             ^
    
    Rework the dependencies so all Samsung drivers and common
    PINCTRL_SAMSUNG part depend on OF_GPIO (which is default yes if GPIOLIB
    and OF are enabled).
    
    Reported-by: Chen Zhou <chenzhou10@huawei.com>
    Signed-off-by: Krzysztof Kozlowski <krzk@kernel.org>

commit c8f3dea90e38194dae542c5d56e05d30447e58cb
Author: Masahiro Yamada <masahiroy@kernel.org>
Date:   Fri Dec 6 22:03:02 2019 +0900

    mkcompile_h: use printf for LINUX_COMPILE_BY
    
    Commit 858805b336be ("kbuild: add $(BASH) to run scripts with
    bash-extension") shed light on portability issues. Here is another one.
    
    Since commit f07726048d59 ("Fix handling of backlash character in
    LINUX_COMPILE_BY name"), we must escape a backslash contained in
    LINUX_COMPILE_BY. This is not working on such distros as Ubuntu.
    
    As the POSIX spec [1] says, if any of the operands contain a backslash
    ( '\' ) character, the results are implementation-defined.
    
    The actual shell of /bin/sh could be bash, dash, etc. depending on
    distros, and the behavior of builtin echo command is different among
    them.
    
    The bash builtin echo, unless -e is given, copies the arguments to
    stdout without expanding escape sequences (BSD-like behavior).
    
    The dash builtin echo, in contrast, adopts System V behavior, which
    does expand escape sequences without any option given.
    
    Even non-builtin /bin/echo behaves differently depending on the system.
    Due to these variations, echo is considered as a non-portable command.
    Using printf is the common solution to avoid the portability issue.
    
    [1] https://pubs.opengroup.org/onlinepubs/009695399/utilities/echo.html
    
    Fixes: 858805b336be ("kbuild: add $(BASH) to run scripts with bash-extension")
    Reported-by: XXing Wei <xxing.wei@unisoc.com>
    Signed-off-by: Masahiro Yamada <masahiroy@kernel.org>

commit e8193650bf38bf531f19de36ae3afdee32627191
Author: Masahiro Yamada <masahiroy@kernel.org>
Date:   Fri Dec 6 22:03:01 2019 +0900

    mkcompile_h: git rid of UTS_TRUNCATE from LINUX_COMPILE_{BY,HOST}
    
    UTS_VERSION is set to struct uts_namespace, hence a too long string
    should be truncated so it fits in 64 characters.
    
    On the other hand, LINUX_COMPILE_BY/HOST are not set to uts_namespace.
    They are just used in the banners, which do not have specific length
    limitation.
    
    I dug into the git history, but I could not find the reason why
    these two strings must fit in 64 characters. Remove them.
    
    Now that UTS_VERSION is the only user of UTS_TRUNCATE, I squashed it.
    
    Signed-off-by: Masahiro Yamada <masahiroy@kernel.org>

commit eefb8c124fd969e9a174ff2bedff86aa305a7438
Author: Dmitry Golovin <dima@golovin.in>
Date:   Thu Dec 5 00:54:41 2019 +0200

    x86/boot: kbuild: allow readelf executable to be specified
    
    Introduce a new READELF variable to top-level Makefile, so the name of
    readelf binary can be specified.
    
    Before this change the name of the binary was hardcoded to
    "$(CROSS_COMPILE)readelf" which might not be present for every
    toolchain.
    
    This allows to build with LLVM Object Reader by using make parameter
    READELF=llvm-readelf.
    
    Link: https://github.com/ClangBuiltLinux/linux/issues/771
    Signed-off-by: Dmitry Golovin <dima@golovin.in>
    Reviewed-by: Nick Desaulniers <ndesaulniers@google.com>
    Signed-off-by: Masahiro Yamada <masahiroy@kernel.org>

commit ed973f15f445352cd92efadfa47135c237561b5e
Author: Maxime Jourdan <mjourdan@baylibre.com>
Date:   Mon Nov 12 17:46:54 2018 +0100

    drivers: soc: Allow building the amlogic drivers without ARCH_MESON
    
    [ Upstream commit 41bb5769b7f4b7a85e4b92c37429228279b4f569 ]
    
    The current condition makes it difficult to compile the amlogic/
    drivers with COMPILE_TEST, or without ARCH_MESON in general.
    
    Fixes kbuild errors with patch series that depend on drivers in that
    directory, for instance the meson video decoder.
    
    Signed-off-by: Maxime Jourdan <mjourdan@baylibre.com>
    Signed-off-by: Kevin Hilman <khilman@baylibre.com>
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit 40f9f2f6f3d791b37c4cb77410df5f54ac2e909e
Author: Paul Burton <paul.burton@mips.com>
Date:   Mon Oct 7 23:18:06 2019 +0000

    staging/octeon: Use stubs for MIPS && !CAVIUM_OCTEON_SOC
    
    commit 17a29fea086ba18b000d28439bd5cb4f2b0a527b upstream.
    
    When building for a non-Cavium MIPS system with COMPILE_TEST=y, the
    Octeon ethernet driver hits a number of issues due to use of macros
    provided only for CONFIG_CAVIUM_OCTEON_SOC=y configurations. For
    example:
    
      drivers/staging/octeon/ethernet-rx.c:190:6: error:
        'CONFIG_CAVIUM_OCTEON_CVMSEG_SIZE' undeclared (first use in this function)
      drivers/staging/octeon/ethernet-rx.c:472:25: error:
        'OCTEON_IRQ_WORKQ0' undeclared (first use in this function)
    
    These come from various asm/ headers that a non-Octeon build will be
    using a non-Octeon version of.
    
    Fix this by using the octeon-stubs.h header for non-Cavium MIPS builds,
    and only using the real asm/octeon/ headers when building a Cavium
    Octeon kernel configuration.
    
    This requires that octeon-stubs.h doesn't redefine XKPHYS_TO_PHYS, which
    is defined for MIPS by asm/addrspace.h which is pulled in by many other
    common asm/ headers.
    
    Signed-off-by: Paul Burton <paul.burton@mips.com>
    Reported-by: Geert Uytterhoeven <geert@linux-m68k.org>
    URL: https://lore.kernel.org/linux-mips/CAMuHMdXvu+BppwzsU9imNWVKea_hoLcRt9N+a29Q-QsjW=ip2g@mail.gmail.com/
    Fixes: 171a9bae68c7 ("staging/octeon: Allow test build on !MIPS")
    Cc: Matthew Wilcox (Oracle) <willy@infradead.org>
    Cc: David S. Miller <davem@davemloft.net>
    Link: https://lore.kernel.org/r/20191007231741.2012860-1-paul.burton@mips.com
    Cc: Guenter Roeck <linux@roeck-us.net>
    Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>

commit b87671f17c3e94e80b802904d80b6ed213ac70ae
Author: Greg Kroah-Hartman <gregkh@linuxfoundation.org>
Date:   Tue Dec 10 15:36:57 2019 +0100

    tty: serial: samsung: allow driver to be built by anyone
    
    There is no need to tie this driver to only the Exynos platform,
    especially for build testing.  So add COMPILE_TEST as an option allowing
    it to be built on any platform.
    
    Cc: Kukjin Kim <kgene@kernel.org>
    Cc: Hyunki Koo <kkoos00@naver.com>
    Cc: HYUN-KI KOO <hyunki00.koo@samsung.com>
    Cc: Shinbeom Choi <sbeom.choi@samsung.com>
    Cc: Jiri Slaby <jslaby@suse.com>
    Cc: linux-arm-kernel@lists.infradead.org
    Cc: linux-samsung-soc@vger.kernel.org
    Cc: linux-serial@vger.kernel.org
    Cc: linux-kernel@vger.kernel.org
    Reviewed-by: Krzysztof Kozlowski <krzk@kernel.org>
    Link: https://lore.kernel.org/r/20191210143706.3928480-1-gregkh@linuxfoundation.org
    Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>

commit 73ae2cb424950f917829a8b78359ae1e4b175f3c
Author: Krzysztof Kozlowski <krzk@kernel.org>
Date:   Mon Dec 9 17:39:36 2019 +0100

    pinctrl: samsung: Enable compile test for build coverage
    
    The Samsung pinctrl drivers require only GPIOLIB and OF for building.
    The drivers should be buildable on all architectures so enable
    COMPILE_TEST.
    
    Signed-off-by: Krzysztof Kozlowski <krzk@kernel.org>

commit a530bf691f0e4691214562c165e6c8889dc51e57
Author: Michael Hernandez <mhernandez@marvell.com>
Date:   Tue Dec 3 14:36:56 2019 -0800

    scsi: qla2xxx: Added support for MPI and PEP regions for ISP28XX
    
    This patch adds support for MPI/PEP region updates which is required with
    secure flash updates for ISP28XX.
    
    Fixes: 3f006ac342c0 ("scsi: qla2xxx: Secure flash update support for ISP28XX")
    Cc: stable@vger.kernel.org
    Link: https://lore.kernel.org/r/20191203223657.22109-3-hmadhani@marvell.com
    Signed-off-by: Michael Hernandez <mhernandez@marvell.com>
    Signed-off-by: Himanshu Madhani <hmadhani@marvell.com>
    Signed-off-by: Martin K. Petersen <martin.petersen@oracle.com>

commit aacf6578ef7704d8df252bbc146b1a35ca131248
Author: Grygorii Strashko <grygorii.strashko@ti.com>
Date:   Wed Dec 4 19:45:32 2019 +0200

    net: ethernet: ti: cpsw_switchdev: fix unmet direct dependencies detected for NET_SWITCHDEV
    
    Replace "select NET_SWITCHDEV" vs "depends on NET_SWITCHDEV" to fix Kconfig
    warning with CONFIG_COMPILE_TEST=y
    
    WARNING: unmet direct dependencies detected for NET_SWITCHDEV
      Depends on [n]: NET [=y] && INET [=n]
      Selected by [y]:
      - TI_CPSW_SWITCHDEV [=y] && NETDEVICES [=y] && ETHERNET [=y] && NET_VENDOR_TI [=y] && (ARCH_DAVINCI || ARCH_OMAP2PLUS || COMPILE_TEST [=y])
    
    because TI_CPSW_SWITCHDEV blindly selects NET_SWITCHDEV even though
    INET is not set/enabled, while NET_SWITCHDEV depends on INET.
    
    Reported-by: Randy Dunlap <rdunlap@infradead.org>
    Fixes: ed3525eda4c4 ("net: ethernet: ti: introduce cpsw switchdev based driver part 1 - dual-emac")
    Signed-off-by: Grygorii Strashko <grygorii.strashko@ti.com>
    Acked-by: Randy Dunlap <rdunlap@infradead.org> # build-tested
    Signed-off-by: David S. Miller <davem@davemloft.net>

commit c19b9c45fc58396b6e443381153911cdf48bbc28
Author: Paul Thomas <pthomas8589@gmail.com>
Date:   Mon Apr 8 15:37:54 2019 -0400

    net: macb driver, check for SKBTX_HW_TSTAMP
    
    commit a62520473f15750cd1432d36b377a06cd7cff8d2 upstream.
    
    Make sure SKBTX_HW_TSTAMP (i.e. SOF_TIMESTAMPING_TX_HARDWARE) has been
    enabled for this skb. It does fix the issue where normal socks that
    aren't expecting a timestamp will not wake up on select, but when a
    user does want a SOF_TIMESTAMPING_TX_HARDWARE it does work.
    
    Signed-off-by: Paul Thomas <pthomas8589@gmail.com>
    Signed-off-by: David S. Miller <davem@davemloft.net>
    Signed-off-by: Lee Jones <lee.jones@linaro.org>
    Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>

commit 54a708ab4f564941e43a0ee33744835523bf336d
Author: Masahiro Yamada <yamada.masahiro@socionext.com>
Date:   Fri Dec 7 20:33:52 2018 +0900

    microblaze: adjust the help to the real behavior
    
    [ Upstream commit bafcc61d998c1ca18f556d92a0e95335ac68c7da ]
    
    "make ARCH=microblaze help" mentions simpleImage.<dt>.unstrip,
    but it is not a real Make target. It does not work because Makefile
    assumes "system.unstrip" is the name of DT.
    
    $ make ARCH=microblaze CROSS_COMPILE=microblaze-linux- simpleImage.system.unstrip
      [ snip ]
    make[1]: *** No rule to make target 'arch/microblaze/boot/dts/system.unstrip.dtb', needed by 'arch/microblaze/boot/dts/system.dtb'.  Stop.
    make: *** [Makefile;1060: arch/microblaze/boot/dts] Error 2
    make: *** Waiting for unfinished jobs....
    
    simpleImage.<dt> works like a phony target that generates multiple
    images. Reflect the real behavior. I removed the DT directory path
    information because it is already explained a few lines below.
    
    While I am here, I deleted the redundant *_defconfig explanation.
    
    The top-level Makefile caters to list available defconfig files:
    
      mmu_defconfig            - Build for mmu
      nommu_defconfig          - Build for nommu
    
    Signed-off-by: Masahiro Yamada <yamada.masahiro@socionext.com>
    Signed-off-by: Michal Simek <michal.simek@xilinx.com>
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit 3a0ac1d6cdaa5067c3fb5af2fe9f30e8c794eb01
Author: Masahiro Yamada <yamada.masahiro@socionext.com>
Date:   Fri Dec 7 20:33:52 2018 +0900

    microblaze: adjust the help to the real behavior
    
    [ Upstream commit bafcc61d998c1ca18f556d92a0e95335ac68c7da ]
    
    "make ARCH=microblaze help" mentions simpleImage.<dt>.unstrip,
    but it is not a real Make target. It does not work because Makefile
    assumes "system.unstrip" is the name of DT.
    
    $ make ARCH=microblaze CROSS_COMPILE=microblaze-linux- simpleImage.system.unstrip
      [ snip ]
    make[1]: *** No rule to make target 'arch/microblaze/boot/dts/system.unstrip.dtb', needed by 'arch/microblaze/boot/dts/system.dtb'.  Stop.
    make: *** [Makefile;1060: arch/microblaze/boot/dts] Error 2
    make: *** Waiting for unfinished jobs....
    
    simpleImage.<dt> works like a phony target that generates multiple
    images. Reflect the real behavior. I removed the DT directory path
    information because it is already explained a few lines below.
    
    While I am here, I deleted the redundant *_defconfig explanation.
    
    The top-level Makefile caters to list available defconfig files:
    
      mmu_defconfig            - Build for mmu
      nommu_defconfig          - Build for nommu
    
    Signed-off-by: Masahiro Yamada <yamada.masahiro@socionext.com>
    Signed-off-by: Michal Simek <michal.simek@xilinx.com>
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit ba39f52ffbc9608dd03eea16537bcd23a09fe1f8
Author: Masahiro Yamada <yamada.masahiro@socionext.com>
Date:   Fri Dec 7 20:33:52 2018 +0900

    microblaze: adjust the help to the real behavior
    
    [ Upstream commit bafcc61d998c1ca18f556d92a0e95335ac68c7da ]
    
    "make ARCH=microblaze help" mentions simpleImage.<dt>.unstrip,
    but it is not a real Make target. It does not work because Makefile
    assumes "system.unstrip" is the name of DT.
    
    $ make ARCH=microblaze CROSS_COMPILE=microblaze-linux- simpleImage.system.unstrip
      [ snip ]
    make[1]: *** No rule to make target 'arch/microblaze/boot/dts/system.unstrip.dtb', needed by 'arch/microblaze/boot/dts/system.dtb'.  Stop.
    make: *** [Makefile;1060: arch/microblaze/boot/dts] Error 2
    make: *** Waiting for unfinished jobs....
    
    simpleImage.<dt> works like a phony target that generates multiple
    images. Reflect the real behavior. I removed the DT directory path
    information because it is already explained a few lines below.
    
    While I am here, I deleted the redundant *_defconfig explanation.
    
    The top-level Makefile caters to list available defconfig files:
    
      mmu_defconfig            - Build for mmu
      nommu_defconfig          - Build for nommu
    
    Signed-off-by: Masahiro Yamada <yamada.masahiro@socionext.com>
    Signed-off-by: Michal Simek <michal.simek@xilinx.com>
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit cabf7f90ced5088d16820221c9301c872a7a2a5d
Author: Paul Thomas <pthomas8589@gmail.com>
Date:   Mon Apr 8 15:37:54 2019 -0400

    net: macb driver, check for SKBTX_HW_TSTAMP
    
    commit a62520473f15750cd1432d36b377a06cd7cff8d2 upstream.
    
    Make sure SKBTX_HW_TSTAMP (i.e. SOF_TIMESTAMPING_TX_HARDWARE) has been
    enabled for this skb. It does fix the issue where normal socks that
    aren't expecting a timestamp will not wake up on select, but when a
    user does want a SOF_TIMESTAMPING_TX_HARDWARE it does work.
    
    Signed-off-by: Paul Thomas <pthomas8589@gmail.com>
    Signed-off-by: David S. Miller <davem@davemloft.net>
    Signed-off-by: Lee Jones <lee.jones@linaro.org>
    Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>

commit b92e5db0f492026778cb31dfc479e50f33f75bca
Author: Joel Stanley <joel@jms.id.au>
Date:   Mon Nov 12 15:58:06 2018 +1030

    powerpc/32: Avoid unsupported flags with clang
    
    [ Upstream commit 72e7bcc2cdf82bf03caaa5e6c9b0134c2fc2ee7d ]
    
    When building for ppc32 with clang these flags are unsupported:
    
      -ffixed-r2 and -mmultiple
    
    llvm's lib/Target/PowerPC/PPCRegisterInfo.cpp marks r2 as reserved on
    when building for SVR4ABI and !ppc64:
    
      // The SVR4 ABI reserves r2 and r13
      if (Subtarget.isSVR4ABI()) {
        // We only reserve r2 if we need to use the TOC pointer. If we have no
        // explicit uses of the TOC pointer (meaning we're a leaf function with
        // no constant-pool loads, etc.) and we have no potential uses inside an
        // inline asm block, then we can treat r2 has an ordinary callee-saved
        // register.
        const PPCFunctionInfo *FuncInfo = MF.getInfo<PPCFunctionInfo>();
        if (!TM.isPPC64() || FuncInfo->usesTOCBasePtr() || MF.hasInlineAsm())
          markSuperRegs(Reserved, PPC::R2);  // System-reserved register
        markSuperRegs(Reserved, PPC::R13); // Small Data Area pointer register
      }
    
    This means we can safely omit -ffixed-r2 when building for 32-bit
    targets.
    
    The -mmultiple/-mno-multiple flags are not supported by clang, so
    platforms that might support multiple miss out on using multiple word
    instructions.
    
    We wrap these flags in cc-option so that when Clang gains support the
    kernel will be able use these flags.
    
    Clang 8 can then build a ppc44x_defconfig which boots in Qemu:
    
      make CC=clang-8 ARCH=powerpc CROSS_COMPILE=powerpc-linux-gnu-  ppc44x_defconfig
      ./scripts/config -e CONFIG_DEVTMPFS -d DEVTMPFS_MOUNT
      make CC=clang-8 ARCH=powerpc CROSS_COMPILE=powerpc-linux-gnu-
    
      qemu-system-ppc -M bamboo \
       -kernel arch/powerpc/boot/zImage \
       -dtb arch/powerpc/boot/dts/bamboo.dtb \
       -initrd ~/ppc32-440-rootfs.cpio \
       -nographic -serial stdio -monitor pty -append "console=ttyS0"
    
    Link: https://github.com/ClangBuiltLinux/linux/issues/261
    Link: https://bugs.llvm.org/show_bug.cgi?id=39556
    Link: https://bugs.llvm.org/show_bug.cgi?id=39555
    Signed-off-by: Joel Stanley <joel@jms.id.au>
    Reviewed-by: Nick Desaulniers <ndesaulniers@google.com>
    Signed-off-by: Michael Ellerman <mpe@ellerman.id.au>
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit 694c90cd5ba72ebf820209f741fe26084733485f
Author: Masahiro Yamada <yamada.masahiro@socionext.com>
Date:   Fri Dec 7 20:33:54 2018 +0900

    microblaze: fix multiple bugs in arch/microblaze/boot/Makefile
    
    [ Upstream commit 4722a3e6b716d9d4594c3cf3856b03bbd24a59a8 ]
    
    This commit fixes some build issues.
    
    The first issue is the breakage of linux.bin.ub target since commit
    ece97f3a5fb5 ("microblaze: Fix simpleImage format generation")
    because the addition of UIMAGE_{IN,OUT} affected it.
    
    make ARCH=microblaze CROSS_COMPILE=microblaze-linux- linux.bin.ub
      [ snip ]
      OBJCOPY arch/microblaze/boot/linux.bin
      UIMAGE  arch/microblaze/boot/linux.bin.ub.ub
    /usr/bin/mkimage: Can't open arch/microblaze/boot/linux.bin.ub: No such file or directory
    make[1]: *** [arch/microblaze/boot/Makefile;14: arch/microblaze/boot/linux.bin.ub] Error 1
    make: *** [arch/microblaze/Makefile;83: linux.bin.ub] Error 2
    
    The second issue is the use of the "if_changed" multiple times for
    the same target.
    
    As commit 92a4728608a8 ("x86/boot: Fix if_changed build flip/flop bug")
    pointed out, this never works properly. Moreover, generating multiple
    images as a side-effect is confusing.
    
    Let's split the build recipe for each image.
    
    simpleImage.<dt>*.unstrip is just a copy of vmlinux.
    
    simpleImage.<dt> and simpleImage.<dt>.ub are created in the same way
    as linux.bin and linux.bin.ub, respectively.
    
    I kept simpleImage.* recipes independent of linux.bin.* ones to not
    change the behavior.
    
    Lastly, this commit fixes "make ARCH=microblaze clean". Previously,
    it only cleaned up the unstrip image. Now, all the simpleImage files
    are cleaned.
    
    Signed-off-by: Masahiro Yamada <yamada.masahiro@socionext.com>
    Signed-off-by: Michal Simek <michal.simek@xilinx.com>
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit 4e860e92c8fde5d66a193e6994d8485a39e59c3a
Author: Masahiro Yamada <yamada.masahiro@socionext.com>
Date:   Fri Dec 7 20:33:52 2018 +0900

    microblaze: adjust the help to the real behavior
    
    [ Upstream commit bafcc61d998c1ca18f556d92a0e95335ac68c7da ]
    
    "make ARCH=microblaze help" mentions simpleImage.<dt>.unstrip,
    but it is not a real Make target. It does not work because Makefile
    assumes "system.unstrip" is the name of DT.
    
    $ make ARCH=microblaze CROSS_COMPILE=microblaze-linux- simpleImage.system.unstrip
      [ snip ]
    make[1]: *** No rule to make target 'arch/microblaze/boot/dts/system.unstrip.dtb', needed by 'arch/microblaze/boot/dts/system.dtb'.  Stop.
    make: *** [Makefile;1060: arch/microblaze/boot/dts] Error 2
    make: *** Waiting for unfinished jobs....
    
    simpleImage.<dt> works like a phony target that generates multiple
    images. Reflect the real behavior. I removed the DT directory path
    information because it is already explained a few lines below.
    
    While I am here, I deleted the redundant *_defconfig explanation.
    
    The top-level Makefile caters to list available defconfig files:
    
      mmu_defconfig            - Build for mmu
      nommu_defconfig          - Build for nommu
    
    Signed-off-by: Masahiro Yamada <yamada.masahiro@socionext.com>
    Signed-off-by: Michal Simek <michal.simek@xilinx.com>
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit ddebe839c6013ab42f376bdeaaaf66bd0c0d68d6
Merge: ceb307474506 ec16ffe36d80
Author: Linus Torvalds <torvalds@linux-foundation.org>
Date:   Sun Dec 1 16:06:02 2019 -0800

    Merge tag 'clk-for-linus' of git://git.kernel.org/pub/scm/linux/kernel/git/clk/linux
    
    Pull clk updates from Stephen Boyd:
     "This merge window we have one small clk provider API in the core
      framework and then a bunch of driver updates and a handful of new
      drivers. In terms of diffstat the Qualcomm and Amlogic drivers are
      high up there because of all the clk data introcued by new drivers.
      The Nvidia Tegra driver had a lot of work done this cycle too to
      support suspend/resume and memory controllers. And the OMAP clk driver
      got proper clk and reset handling in place.
    
      Rounding out the patches are various updates to remove unused data,
      mark things static, correct incorrect data in drivers, etc. All the
      little things that improve drivers and maintain code health. I will
      point out that there's a patch in here for the GPIO clk driver, that
      almost nobody uses, which changes behavior and causes clk_set_rate()
      to try to change the GPIO gate clk's parent. Other than that things
      are fairly well SoC specific here.
    
      Core:
       - Add a clk provider API to get current parent index
       - Plug a memory leak in clk_unregister() path
    
      New Drivers:
       - CGU in Ingenix X1000
       - Bitmain BM1880 clks
       - Qualcomm MSM8998 GPU clk controllers
       - Qualcomm SC7180 GCC and RPMH clk controllers
       - Qualcomm QCS404 Q6SSTOP clk controllers
       - Add support for the Renesas R-Car M3-W+ (r8a77961) SoC
       - Add support for the Renesas RZ/G2N (r8a774b1) SoC
       - Add Tegra20/30 External Memory Clock (EMC) support
    
      Updates:
       - Make gpio gate clks propagate rate setting up to parent
       - Prepare Armada 3700 for suspend to RAM by moving PCIe
         suspend/resume priority
       - Drop unused variables, enums, etc. in various clk drivers
       - Convert various drivers to use devm_platform_ioremap_resource()
       - Use struct_size() some more in various clk drivers
       - Improve Rockchip px30 clk tree
       - Add suspend/resume support to Tegra210 clk driver
       - Reimplement SOR clks on earlier Tegra SoCs, helping HDMI and DP
       - Allwinner DT exports and H6 clk tree fixes
       - Proper clk and reset handling for OMAP SoCs
       - Revamped TI divider clk to clamp max divider
       - Make 1443X/1416X PLL clock structure common for reusing among i.MX8
         SoCs
       - Drop IMX7ULP_CLK_MIPI_PLL clock, it shouldn't be used
       - Add VIDEO2_PLL clock for imx8mq
       - Add missing gate clock for pll1/2 fixed dividers on i.MX8 SoCs
       - Add sm1 support in the Amlogic audio clock controller
       - Switch some clocks on R-Car Gen2/3 to .determine_rate()
       - Remove Renesas R-Car Gen2 legacy DT clock support
       - Improve arithmetic divisions on Renesas R-Car Gen2 and Gen3
       - Improve Renesas R-Car Gen3 SD clock handling
       - Add rate table for Samsung exynos542x GPU and VPLL clks
       - Fix potential CPU performance degradation after system
         suspend/resume cycle on exynos542x SoCs"
    
    * tag 'clk-for-linus' of git://git.kernel.org/pub/scm/linux/kernel/git/clk/linux: (160 commits)
      clk: aspeed: Add RMII RCLK gates for both AST2500 MACs
      MAINTAINERS: Add entry for BM1880 SoC clock driver
      clk: Add common clock driver for BM1880 SoC
      dt-bindings: clock: Add devicetree binding for BM1880 SoC
      clk: Add clk_hw_unregister_composite helper function definition
      clk: Zero init clk_init_data in helpers
      clk: ingenic: Allow drivers to be built with COMPILE_TEST
      MAINTAINERS: Update section for Ux500 clock drivers
      clk: mark clk_disable_unused() as __init
      clk: Fix memory leak in clk_unregister()
      clk: Ingenic: Add CGU driver for X1000.
      dt-bindings: clock: Add X1000 bindings.
      clk: tegra: Use match_string() helper to simplify the code
      clk: pxa: fix one of the pxa RTC clocks
      clk: sprd: Use IS_ERR() to validate the return value of syscon_regmap_lookup_by_phandle()
      clk: armada-xp: remove unused code
      clk: tegra: Fix build error without CONFIG_PM_SLEEP
      clk: tegra: Add missing stubs for the case of !CONFIG_PM_SLEEP
      clk: tegra: Optimize PLLX restore on Tegra20/30
      clk: tegra: Add suspend and resume support on Tegra210
      ...

commit 7bd4c4a7b0ff94ef01247f905cd568fb67c747e0
Merge: d8ddab63635d 3b55809cf91f
Author: Bjorn Helgaas <bhelgaas@google.com>
Date:   Thu Nov 28 08:54:53 2019 -0600

    Merge branch 'remotes/lorenzo/pci/mmio-dma-ranges'
    
      - Consolidate DT "dma-ranges" parsing and convert all host drivers to use
        shared parsing (Rob Herring)
    
    * remotes/lorenzo/pci/mmio-dma-ranges:
      PCI: Make devm_of_pci_get_host_bridge_resources() static
      PCI: rcar: Use inbound resources for setup
      PCI: iproc: Use inbound resources for setup
      PCI: xgene: Use inbound resources for setup
      PCI: v3-semi: Use inbound resources for setup
      PCI: ftpci100: Use inbound resources for setup
      PCI: of: Add inbound resource parsing to helpers
      PCI: versatile: Enable COMPILE_TEST
      PCI: versatile: Remove usage of PHYS_OFFSET
      PCI: versatile: Use pci_parse_request_of_pci_ranges()
      PCI: xilinx-nwl: Use pci_parse_request_of_pci_ranges()
      PCI: xilinx: Use pci_parse_request_of_pci_ranges()
      PCI: xgene: Use pci_parse_request_of_pci_ranges()
      PCI: v3-semi: Use pci_parse_request_of_pci_ranges()
      PCI: rockchip: Drop storing driver private outbound resource data
      PCI: rockchip: Use pci_parse_request_of_pci_ranges()
      PCI: mobiveil: Use pci_parse_request_of_pci_ranges()
      PCI: mediatek: Use pci_parse_request_of_pci_ranges()
      PCI: iproc: Use pci_parse_request_of_pci_ranges()
      PCI: faraday: Use pci_parse_request_of_pci_ranges()
      PCI: dwc: Use pci_parse_request_of_pci_ranges()
      PCI: altera: Use pci_parse_request_of_pci_ranges()
      PCI: aardvark: Use pci_parse_request_of_pci_ranges()
      PCI: Export pci_parse_request_of_pci_ranges()
      resource: Add a resource_list_first_type helper
    
    # Conflicts:
    #       drivers/pci/controller/pcie-rcar.c

commit ec16ffe36d80b18a1f98d126a865d5557ab27c30
Merge: dabedfede324 cd94eade0b2a 564f86d38475 8f39f22f73b3 1e4fb2c0cb34
Author: Stephen Boyd <sboyd@kernel.org>
Date:   Wed Nov 27 08:15:13 2019 -0800

    Merge branches 'clk-ingenic', 'clk-init-leak', 'clk-ux500' and 'clk-bitmain' into clk-next
    
     - Support CGU in Ingenix X1000
     - Support Bitmain BM1880 clks
    
    * clk-ingenic:
      clk: ingenic: Allow drivers to be built with COMPILE_TEST
      clk: Ingenic: Add CGU driver for X1000.
      dt-bindings: clock: Add X1000 bindings.
    
    * clk-init-leak:
      clk: mark clk_disable_unused() as __init
      clk: Fix memory leak in clk_unregister()
    
    * clk-ux500:
      MAINTAINERS: Update section for Ux500 clock drivers
    
    * clk-bitmain:
      MAINTAINERS: Add entry for BM1880 SoC clock driver
      clk: Add common clock driver for BM1880 SoC
      dt-bindings: clock: Add devicetree binding for BM1880 SoC
      clk: Add clk_hw_unregister_composite helper function definition
      clk: Zero init clk_init_data in helpers

commit 642356cb5f4a8c82b5ca5ebac288c327d10df236
Merge: f838767555d4 4ee812f6143d
Author: Linus Torvalds <torvalds@linux-foundation.org>
Date:   Mon Nov 25 19:49:58 2019 -0800

    Merge git://git.kernel.org/pub/scm/linux/kernel/git/herbert/crypto-2.6
    
    Pull crypto updates from Herbert Xu:
     "API:
       - Add library interfaces of certain crypto algorithms for WireGuard
       - Remove the obsolete ablkcipher and blkcipher interfaces
       - Move add_early_randomness() out of rng_mutex
    
      Algorithms:
       - Add blake2b shash algorithm
       - Add blake2s shash algorithm
       - Add curve25519 kpp algorithm
       - Implement 4 way interleave in arm64/gcm-ce
       - Implement ciphertext stealing in powerpc/spe-xts
       - Add Eric Biggers's scalar accelerated ChaCha code for ARM
       - Add accelerated 32r2 code from Zinc for MIPS
       - Add OpenSSL/CRYPTOGRAMS poly1305 implementation for ARM and MIPS
    
      Drivers:
       - Fix entropy reading failures in ks-sa
       - Add support for sam9x60 in atmel
       - Add crypto accelerator for amlogic GXL
       - Add sun8i-ce Crypto Engine
       - Add sun8i-ss cryptographic offloader
       - Add a host of algorithms to inside-secure
       - Add NPCM RNG driver
       - add HiSilicon HPRE accelerator
       - Add HiSilicon TRNG driver"
    
    * git://git.kernel.org/pub/scm/linux/kernel/git/herbert/crypto-2.6: (285 commits)
      crypto: vmx - Avoid weird build failures
      crypto: lib/chacha20poly1305 - use chacha20_crypt()
      crypto: x86/chacha - only unregister algorithms if registered
      crypto: chacha_generic - remove unnecessary setkey() functions
      crypto: amlogic - enable working on big endian kernel
      crypto: sun8i-ce - enable working on big endian
      crypto: mips/chacha - select CRYPTO_SKCIPHER, not CRYPTO_BLKCIPHER
      hwrng: ks-sa - Enable COMPILE_TEST
      crypto: essiv - remove redundant null pointer check before kfree
      crypto: atmel-aes - Change data type for "lastc" buffer
      crypto: atmel-tdes - Set the IV after {en,de}crypt
      crypto: sun4i-ss - fix big endian issues
      crypto: sun4i-ss - hide the Invalid keylen message
      crypto: sun4i-ss - use crypto_ahash_digestsize
      crypto: sun4i-ss - remove dependency on not 64BIT
      crypto: sun4i-ss - Fix 64-bit size_t warnings on sun4i-ss-hash.c
      MAINTAINERS: Add maintainer for HiSilicon SEC V2 driver
      crypto: hisilicon - add DebugFS for HiSilicon SEC
      Documentation: add DebugFS doc for HiSilicon SEC
      crypto: hisilicon - add SRIOV for HiSilicon SEC
      ...

commit 3d7ff04aae05c93857604ae0910a4f329d1221ff
Author: Deepak Ukey <deepak.ukey@microchip.com>
Date:   Tue Sep 11 14:18:04 2018 +0530

    scsi: pm80xx: Fixed system hang issue during kexec boot
    
    [ Upstream commit 72349b62a571effd6faadd0600b8e657dd87afbf ]
    
    When the firmware is not responding, execution of kexec boot causes a system
    hang. When firmware assertion happened, driver get notified with interrupt
    vector updated in MPI configuration table. Then, the driver will read
    scratchpad register and set controller_fatal_error flag to true.
    
    Signed-off-by: Deepak Ukey <deepak.ukey@microchip.com>
    Signed-off-by: Viswas G <Viswas.G@microchip.com>
    Acked-by: Jack Wang <jinpu.wang@profitbricks.com>
    Signed-off-by: Martin K. Petersen <martin.petersen@oracle.com>
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit 86c5cc2a5e196a4c6df7fdf4d9bffe7f2da1593c
Author: Deepak Ukey <deepak.ukey@microchip.com>
Date:   Tue Sep 11 14:18:04 2018 +0530

    scsi: pm80xx: Fixed system hang issue during kexec boot
    
    [ Upstream commit 72349b62a571effd6faadd0600b8e657dd87afbf ]
    
    When the firmware is not responding, execution of kexec boot causes a system
    hang. When firmware assertion happened, driver get notified with interrupt
    vector updated in MPI configuration table. Then, the driver will read
    scratchpad register and set controller_fatal_error flag to true.
    
    Signed-off-by: Deepak Ukey <deepak.ukey@microchip.com>
    Signed-off-by: Viswas G <Viswas.G@microchip.com>
    Acked-by: Jack Wang <jinpu.wang@profitbricks.com>
    Signed-off-by: Martin K. Petersen <martin.petersen@oracle.com>
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit dc83ef22cdb483027f1bf0892e466433ec5299bf
Author: Andreas K. Besslein <besslein.andreas@gmail.com>
Date:   Sat Nov 23 22:04:47 2019 +0100

    ax88179_178a: add ethtool_op_get_ts_info()
    
    This enables the use of SW timestamping.
    
    ax88179_178a uses the usbnet transmit function usbnet_start_xmit() which
    implements software timestamping. ax88179_178a overrides ethtool_ops but
    missed to set .get_ts_info. This caused SOF_TIMESTAMPING_TX_SOFTWARE
    capability to be not available.
    
    Signed-off-by: Andreas K. Besslein <besslein.andreas@gmail.com>
    Signed-off-by: Jakub Kicinski <jakub.kicinski@netronome.com>

commit cd94eade0b2ab7673a97223d09406abf668b7f73
Author: Stephen Boyd <sboyd@kernel.org>
Date:   Wed Nov 13 16:19:25 2019 -0800

    clk: ingenic: Allow drivers to be built with COMPILE_TEST
    
    We don't need the MIPS architecture or even a MIPS compiler to compile
    test these drivers. Let's add a COMPILE_TEST possibility on the
    menuconfig here so that we can build these drivers on more
    configurations.
    
    Cc: Paul Cercueil <paul@crapouillou.net>
    Signed-off-by: Stephen Boyd <sboyd@kernel.org>
    Link: https://lkml.kernel.org/r/20191114001925.159276-1-sboyd@kernel.org
    Reviewed-by: Paul Cercueil <paul@crapouillou.net>

commit 90c4b29eb1e555fee66f8329a18cb8a070090ad6
Author: Herbert Xu <herbert@gondor.apana.org.au>
Date:   Sun Nov 17 08:43:44 2019 +0800

    hwrng: ks-sa - Enable COMPILE_TEST
    
    This patch enables COMPILE_TEST on the ks-sa-rng driver.
    
    Signed-off-by: Herbert Xu <herbert@gondor.apana.org.au>
    Reviewed-by: Alexander Sverdlin <alexander.sverdlin@nokia.com>
    Signed-off-by: Herbert Xu <herbert@gondor.apana.org.au>

commit 282eaa624f0682a212977076c9062de349540ebb
Author: Giovanni Gherdovich <bobdc9664@seznam.cz>
Date:   Mon Nov 18 19:38:52 2019 +0100

    staging: octeon: indent with tabs instead of spaces
    
    Remove a coding style error from the Octeon driver's tree and keep
    checkpatch.pl a little quieter.
    
    Being a white-spaces patch the chances of breakage are minimal; we don't
    have the hardware to run this driver so we built it with COMPILE_TEST
    enabled on an x86 machine.
    
    Signed-off-by: Giovanni Gherdovich <bobdc9664@seznam.cz>
    Reviewed-by: Dan Carpenter <dan.carpenter@oracle.com>
    Link: https://lore.kernel.org/r/20191118183852.3699-1-bobdc9664@seznam.cz
    Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>

commit 13baf667fa8e23aed12516776de6e50f7617820a
Author: Mao Wenan <maowenan@huawei.com>
Date:   Fri Nov 22 10:52:40 2019 +0800

    enetc: make enetc_setup_tc_mqprio static
    
    While using ARCH=mips CROSS_COMPILE=mips-linux-gnu- command to compile,
    make C=2 drivers/net/ethernet/freescale/enetc/enetc.o
    
    one warning can be found:
    drivers/net/ethernet/freescale/enetc/enetc.c:1439:5:
    warning: symbol 'enetc_setup_tc_mqprio' was not declared.
    Should it be static?
    
    This patch make symbol enetc_setup_tc_mqprio static.
    Fixes: 34c6adf1977b ("enetc: Configure the Time-Aware Scheduler via tc-taprio offload")
    Signed-off-by: Mao Wenan <maowenan@huawei.com>
    Signed-off-by: David S. Miller <davem@davemloft.net>

commit 29c623d64f0dcd6aa10e0eabd16233e77114090b
Author: Dmitry Golovin <dima@golovin.in>
Date:   Tue Nov 19 16:39:42 2019 +0100

    ARM: 8939/1: kbuild: use correct nm executable
    
    Since $(NM) variable can be easily overridden for the whole build, it's
    better to use it instead of $(CROSS_COMPILE)nm. The use of $(CROSS_COMPILE)
    prefixed variables where their calculated equivalents can be used is
    incorrect. This fixes issues with builds where $(NM) is set to llvm-nm.
    
    Link: https://github.com/ClangBuiltLinux/linux/issues/766
    
    Signed-off-by: Dmitry Golovin <dima@golovin.in>
    Suggested-by: Nick Desaulniers <ndesaulniers@google.com>
    Cc: Matthias Maennich <maennich@google.com>
    Reviewed-by: Nathan Chancellor <natechancellor@gmail.com>
    Tested-by: Nathan Chancellor <natechancellor@gmail.com>
    Reviewed-by: Masahiro Yamada <yamada.masahiro@socionext.com>
    Reviewed-by: Nick Desaulniers <ndesaulniers@google.com>
    Signed-off-by: Russell King <rmk+kernel@armlinux.org.uk>

commit 7aea0bd886ae7b564d50364fa854e6361bdd3ee4
Author: Deepak Ukey <deepak.ukey@microchip.com>
Date:   Tue Sep 11 14:18:04 2018 +0530

    scsi: pm80xx: Fixed system hang issue during kexec boot
    
    [ Upstream commit 72349b62a571effd6faadd0600b8e657dd87afbf ]
    
    When the firmware is not responding, execution of kexec boot causes a system
    hang. When firmware assertion happened, driver get notified with interrupt
    vector updated in MPI configuration table. Then, the driver will read
    scratchpad register and set controller_fatal_error flag to true.
    
    Signed-off-by: Deepak Ukey <deepak.ukey@microchip.com>
    Signed-off-by: Viswas G <Viswas.G@microchip.com>
    Acked-by: Jack Wang <jinpu.wang@profitbricks.com>
    Signed-off-by: Martin K. Petersen <martin.petersen@oracle.com>
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit d36d5fbfe15cdc0c553e924dad53f14a6b3de77f
Author: Deepak Ukey <deepak.ukey@microchip.com>
Date:   Tue Sep 11 14:18:04 2018 +0530

    scsi: pm80xx: Fixed system hang issue during kexec boot
    
    [ Upstream commit 72349b62a571effd6faadd0600b8e657dd87afbf ]
    
    When the firmware is not responding, execution of kexec boot causes a system
    hang. When firmware assertion happened, driver get notified with interrupt
    vector updated in MPI configuration table. Then, the driver will read
    scratchpad register and set controller_fatal_error flag to true.
    
    Signed-off-by: Deepak Ukey <deepak.ukey@microchip.com>
    Signed-off-by: Viswas G <Viswas.G@microchip.com>
    Acked-by: Jack Wang <jinpu.wang@profitbricks.com>
    Signed-off-by: Martin K. Petersen <martin.petersen@oracle.com>
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit 8703317ae576c9bf3e07e5b97275e3f957e8d74b
Author: Shaokun Zhang <zhangshaokun@hisilicon.com>
Date:   Thu Nov 7 15:56:04 2019 +0800

    drivers/perf: hisi: update the sccl_id/ccl_id for certain HiSilicon platform
    
    For some HiSilicon platform, the originally designed SCCL_ID and CCL_ID
    are not satisfied with much rich topology when the MT is set, so we
    extend the SCCL_ID to MPIDR[aff3] and CCL_ID to MPIDR[aff2]. Let's
    update this for HiSilicon uncore PMU driver.
    
    Cc: John Garry <john.garry@huawei.com>
    Cc: Hanjun Guo <guohanjun@huawei.com>
    Cc: Mark Rutland <mark.rutland@arm.com>
    Cc: Will Deacon <will@kernel.org>
    Signed-off-by: Shaokun Zhang <zhangshaokun@hisilicon.com>
    Signed-off-by: Will Deacon <will@kernel.org>

commit 1cc874e69a6046b9f777b4d9303ac170906ae91b
Author: Will Deacon <will@kernel.org>
Date:   Fri Oct 4 15:44:45 2019 +0100

    arm64: vdso32: Don't use KBUILD_CPPFLAGS unconditionally
    
    [ Upstream commit c71e88c437962c1ec43d4d23a0ebf4c9cf9bee0d ]
    
    KBUILD_CPPFLAGS is defined differently depending on whether the main
    compiler is clang or not. This means that it is not possible to build
    the compat vDSO with GCC if the rest of the kernel is built with clang.
    
    Define VDSO_CPPFLAGS directly to break this dependency and allow a clang
    kernel to build a compat vDSO with GCC:
    
      $ make ARCH=arm64 CROSS_COMPILE=aarch64-linux-gnu- \
        CROSS_COMPILE_COMPAT=arm-linux-gnueabihf- CC=clang \
        COMPATCC=arm-linux-gnueabihf-gcc
    
    Acked-by: Catalin Marinas <catalin.marinas@arm.com>
    Signed-off-by: Will Deacon <will@kernel.org>
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit 6c47a6ecc2ac7d8d46ea3afe0130dd20bdb29a23
Author: Will Deacon <will@kernel.org>
Date:   Fri Oct 4 14:08:13 2019 +0100

    arm64: Default to building compat vDSO with clang when CONFIG_CC_IS_CLANG
    
    [ Upstream commit 24ee01a927bfe56c66429ec4b1df6955a814adc8 ]
    
    Rather than force the use of GCC for the compat cross-compiler, instead
    extract the target from CROSS_COMPILE_COMPAT and pass it to clang if the
    main compiler is clang.
    
    Acked-by: Catalin Marinas <catalin.marinas@arm.com>
    Signed-off-by: Will Deacon <will@kernel.org>
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit 818845bbcb4acb437cd6c7a4fe7bc2dad0da2cfa
Author: Vincenzo Frascino <vincenzo.frascino@arm.com>
Date:   Thu Oct 3 18:48:33 2019 +0100

    arm64: vdso32: Fix broken compat vDSO build warnings
    
    [ Upstream commit e0de01aafc3dd7b73308106b056ead2d48391905 ]
    
    The .config file and the generated include/config/auto.conf can
    end up out of sync after a set of commands since
    CONFIG_CROSS_COMPILE_COMPAT_VDSO is not updated correctly.
    
    The sequence can be reproduced as follows:
    
    $ make ARCH=arm64 CROSS_COMPILE=aarch64-linux-gnu- defconfig
    [...]
    $ make ARCH=arm64 CROSS_COMPILE=aarch64-linux-gnu- menuconfig
    [set CONFIG_CROSS_COMPILE_COMPAT_VDSO="arm-linux-gnueabihf-"]
    $ make ARCH=arm64 CROSS_COMPILE=aarch64-linux-gnu-
    
    Which results in:
    
    arch/arm64/Makefile:62: CROSS_COMPILE_COMPAT not defined or empty,
    the compat vDSO will not be built
    
    even though the compat vDSO has been built:
    
    $ file arch/arm64/kernel/vdso32/vdso.so
    arch/arm64/kernel/vdso32/vdso.so: ELF 32-bit LSB pie executable, ARM,
    EABI5 version 1 (SYSV), dynamically linked,
    BuildID[sha1]=c67f6c786f2d2d6f86c71f708595594aa25247f6, stripped
    
    A similar case that involves changing the configuration parameter
    multiple times can be reconducted to the same family of problems.
    
    Remove the use of CONFIG_CROSS_COMPILE_COMPAT_VDSO altogether and
    instead rely on the cross-compiler prefix coming from the environment
    via CROSS_COMPILE_COMPAT, much like we do for the rest of the kernel.
    
    Cc: Will Deacon <will@kernel.org>
    Cc: Catalin Marinas <catalin.marinas@arm.com>
    Reported-by: Will Deacon <will@kernel.org>
    Signed-off-by: Vincenzo Frascino <vincenzo.frascino@arm.com>
    Signed-off-by: Will Deacon <will@kernel.org>
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit f9ad75468453b019b92c5296e6a04bf7c37f49e4
Author: Pierre-Louis Bossart <pierre-louis.bossart@linux.intel.com>
Date:   Fri Nov 1 12:30:39 2019 -0500

    ASoC: SOF: imx: fix reverse CONFIG_SND_SOC_SOF_OF dependency
    
    updated solution to the problem reported with randconfig:
    
    CONFIG_SND_SOC_SOF_IMX depends on CONFIG_SND_SOC_SOF, but is in
    turn referenced by the sof-of-dev driver. This creates a reverse
    dependency that manifests in a link error when CONFIG_SND_SOC_SOF_OF
    is built-in but CONFIG_SND_SOC_SOF_IMX=m:
    
    sound/soc/sof/sof-of-dev.o:(.data+0x118): undefined reference to `sof_imx8_ops'
    
    use def_trisate to propagate the right settings without select.
    
    Fixes: f4df4e4042b0 ("ASoC: SOF: imx8: Fix COMPILE_TEST error")
    Fixes: 202acc565a1f ("ASoC: SOF: imx: Add i.MX8 HW support")
    Suggested-by: Arnd Bergmann <arnd@arndb.de>
    Signed-off-by: Pierre-Louis Bossart <pierre-louis.bossart@linux.intel.com>
    Link: https://lore.kernel.org/r/20191101173045.27099-6-pierre-louis.bossart@linux.intel.com
    Signed-off-by: Mark Brown <broonie@kernel.org>

commit 0b6b30c65621fc11a799ca71241f52d8fd9e334c
Author: Narendra K <Narendra.K@dell.com>
Date:   Tue Oct 29 18:37:50 2019 +0100

    efi: Make CONFIG_EFI_RCI2_TABLE selectable on x86 only
    
    For the EFI_RCI2_TABLE Kconfig option, 'make oldconfig' asks the user
    for input on platforms where the option may not be applicable. This patch
    modifies the Kconfig option to ask the user for input only when CONFIG_X86
    or CONFIG_COMPILE_TEST is set to y.
    
    Suggested-by: Geert Uytterhoeven <geert@linux-m68k.org>
    Reported-by: Geert Uytterhoeven <geert@linux-m68k.org>
    Tested-by: Geert Uytterhoeven <geert+renesas@glider.be>
    Signed-off-by: Narendra K <Narendra.K@dell.com>
    Signed-off-by: Ard Biesheuvel <ard.biesheuvel@linaro.org>
    Cc: Linus Torvalds <torvalds@linux-foundation.org>
    Cc: Peter Zijlstra <peterz@infradead.org>
    Cc: Thomas Gleixner <tglx@linutronix.de>
    Cc: linux-efi@vger.kernel.org
    Link: https://lkml.kernel.org/r/20191029173755.27149-2-ardb@kernel.org
    Signed-off-by: Ingo Molnar <mingo@kernel.org>

commit 11dbb632a45a120ceb64f9f2a733992f947278c8
Author: Mao Wenan <maowenan@huawei.com>
Date:   Sat Oct 26 10:07:38 2019 +0800

    net: aquantia: make two symbols be static
    
    When using ARCH=mips CROSS_COMPILE=mips-linux-gnu-
    to build drivers/net/ethernet/aquantia/atlantic/aq_ptp.o
    and drivers/net/ethernet/aquantia/atlantic/hw_atl/hw_atl_b0.o,
    below errors can be seen:
    drivers/net/ethernet/aquantia/atlantic/aq_ptp.c:1378:6:
    warning: symbol 'aq_ptp_poll_sync_work_cb' was not declared.
    Should it be static?
    
    drivers/net/ethernet/aquantia/atlantic/hw_atl/hw_atl_b0.c:1155:5:
    warning: symbol 'hw_atl_b0_ts_to_sys_clock' was not declared.
    Should it be static?
    
    This patch to make aq_ptp_poll_sync_work_cb and hw_atl_b0_ts_to_sys_clock
    be static to fix these warnings.
    
    Fixes: 9c477032f7d0 ("net: aquantia: add support for PIN funcs")
    Signed-off-by: Mao Wenan <maowenan@huawei.com>
    Signed-off-by: David S. Miller <davem@davemloft.net>

commit ecf8fd6d917dca1065e1021ff7fc6b6c282373f9
Author: Rob Herring <robh@kernel.org>
Date:   Mon Oct 28 11:32:49 2019 -0500

    PCI: versatile: Enable COMPILE_TEST
    
    Since commit a574795bc383 ("PCI: generic,versatile: Remove unused
    pci_sys_data structures") the build dependency on ARM is gone, so let's
    enable COMPILE_TEST for versatile.
    
    Signed-off-by: Rob Herring <robh@kernel.org>
    Signed-off-by: Lorenzo Pieralisi <lorenzo.pieralisi@arm.com>
    Reviewed-by: Andrew Murray <andrew.murray@arm.com>
    Acked-by: Linus Walleij <linus.walleij@linaro.org>
    Cc: Lorenzo Pieralisi <lorenzo.pieralisi@arm.com>
    Cc: Bjorn Helgaas <bhelgaas@google.com>

commit 2999dea8e94a8e32dadfe17970aa29eba46985b9
Author: Rob Herring <robh@kernel.org>
Date:   Mon Oct 28 11:32:48 2019 -0500

    PCI: versatile: Remove usage of PHYS_OFFSET
    
    PHYS_OFFSET is not universally defined on all arches and using it prevents
    enabling COMPILE_TEST. PAGE_OFFSET and __pa() are always available, so use
    them to get the physical start of memory address.
    
    This should have probably used 'dma-ranges' to get the address, but we
    don't want to force a DT update to do that. At least in QEMU, the SMAP
    registers have no effect (or perhaps the only value that is handled is 0).
    
    Signed-off-by: Rob Herring <robh@kernel.org>
    Signed-off-by: Lorenzo Pieralisi <lorenzo.pieralisi@arm.com>
    Acked-by: Linus Walleij <linus.walleij@linaro.org>
    Cc: Lorenzo Pieralisi <lorenzo.pieralisi@arm.com>
    Cc: Andrew Murray <andrew.murray@arm.com>
    Cc: Bjorn Helgaas <bhelgaas@google.com>

commit 542c4b6923c701f647785c8472c19b977a217cfd
Author: Marc Zyngier <marc.zyngier@arm.com>
Date:   Tue Apr 9 16:26:21 2019 +0100

    arm64: Enable workaround for Cavium TX2 erratum 219 when running SMT
    
    commit 93916beb70143c46bf1d2bacf814be3a124b253b upstream.
    
    It appears that the only case where we need to apply the TX2_219_TVM
    mitigation is when the core is in SMT mode. So let's condition the
    enabling on detecting a CPU whose MPIDR_EL1.Aff0 is non-zero.
    
    Cc: <stable@vger.kernel.org>
    Signed-off-by: Marc Zyngier <marc.zyngier@arm.com>
    Signed-off-by: Will Deacon <will@kernel.org>
    Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>

commit 4292745536d22a2320fe262fa181cb88ec9ba94a
Author: Marc Zyngier <marc.zyngier@arm.com>
Date:   Tue Apr 9 16:26:21 2019 +0100

    arm64: Enable workaround for Cavium TX2 erratum 219 when running SMT
    
    commit 93916beb70143c46bf1d2bacf814be3a124b253b upstream.
    
    It appears that the only case where we need to apply the TX2_219_TVM
    mitigation is when the core is in SMT mode. So let's condition the
    enabling on detecting a CPU whose MPIDR_EL1.Aff0 is non-zero.
    
    Cc: <stable@vger.kernel.org>
    Signed-off-by: Marc Zyngier <marc.zyngier@arm.com>
    Signed-off-by: Will Deacon <will@kernel.org>
    Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>

commit 7f725f41f62750832817047e44892ce92d65e6aa
Author: Eric Biggers <ebiggers@google.com>
Date:   Mon Oct 14 19:45:17 2019 -0700

    crypto: powerpc - convert SPE AES algorithms to skcipher API
    
    Convert the glue code for the PowerPC SPE implementations of AES-ECB,
    AES-CBC, AES-CTR, and AES-XTS from the deprecated "blkcipher" API to the
    "skcipher" API.  This is needed in order for the blkcipher API to be
    removed.
    
    Tested with:
    
            export ARCH=powerpc CROSS_COMPILE=powerpc-linux-gnu-
            make mpc85xx_defconfig
            cat >> .config << EOF
            # CONFIG_MODULES is not set
            # CONFIG_CRYPTO_MANAGER_DISABLE_TESTS is not set
            CONFIG_DEBUG_KERNEL=y
            CONFIG_CRYPTO_MANAGER_EXTRA_TESTS=y
            CONFIG_CRYPTO_AES=y
            CONFIG_CRYPTO_CBC=y
            CONFIG_CRYPTO_CTR=y
            CONFIG_CRYPTO_ECB=y
            CONFIG_CRYPTO_XTS=y
            CONFIG_CRYPTO_AES_PPC_SPE=y
            EOF
            make olddefconfig
            make -j32
            qemu-system-ppc -M mpc8544ds -cpu e500 -nographic \
                    -kernel arch/powerpc/boot/zImage \
                    -append cryptomgr.fuzz_iterations=1000
    
    Note that xts-ppc-spe still fails the comparison tests due to the lack
    of ciphertext stealing support.  This is not addressed by this patch.
    
    This patch also cleans up the code by making ->encrypt() and ->decrypt()
    call a common function for each of ECB, CBC, and XTS, and by using a
    clearer way to compute the length to process at each step.
    
    Signed-off-by: Eric Biggers <ebiggers@google.com>
    Signed-off-by: Herbert Xu <herbert@gondor.apana.org.au>

commit a362687404edc5d73a4fc281af3b2b1542ef194e
Author: Olof Johansson <olof@lixom.net>
Date:   Mon Oct 21 18:52:24 2019 -0700

    soc: mmp: guard include of asm/cputype.h with CONFIG_ARM{,64}
    
    Since this driver is enabled for COMPILE_TEST, it avoids build error
    on x86 allmodconfig:
    
    In file included from /build/drivers/phy/marvell/phy-mmp3-usb.c:12:
    /build/include/linux/soc/mmp/cputype.h:5:10: fatal error: asm/cputype.h: No such file or directory
    
    Link: https://lore.kernel.org/r/20191022015658.14624-1-olof@lixom.net
    Signed-off-by: Olof Johansson <olof@lixom.net>

commit 37518c7f00aabc61cc0eabe0492b426c5be0c70c
Author: Jeremy Linton <jeremy.linton@arm.com>
Date:   Mon Oct 14 19:56:02 2019 +0800

    arm64: topology: Use PPTT to determine if PE is a thread
    
    Commit 98dc19902a0b2e5348e43d6a2c39a0a7d0fc639e upstream.
    
    ACPI 6.3 adds a thread flag to represent if a CPU/PE is
    actually a thread. Given that the MPIDR_MT bit may not
    represent this information consistently on homogeneous machines
    we should prefer the PPTT flag if its available.
    
    Signed-off-by: Jeremy Linton <jeremy.linton@arm.com>
    Reviewed-by: Sudeep Holla <sudeep.holla@arm.com>
    Reviewed-by: Robert Richter <rrichter@marvell.com>
    [will: made acpi_cpu_is_threaded() return 'bool']
    Signed-off-by: Will Deacon <will@kernel.org>
    Signed-off-by: John Garry <john.garry@huawei.com>
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit a64241ba496c482d2f89115c8b6749ac01079d74
Author: Jeremy Linton <jeremy.linton@arm.com>
Date:   Mon Oct 14 17:56:26 2019 +0800

    arm64: topology: Use PPTT to determine if PE is a thread
    
    Commit 98dc19902a0b2e5348e43d6a2c39a0a7d0fc639e upstream.
    
    ACPI 6.3 adds a thread flag to represent if a CPU/PE is
    actually a thread. Given that the MPIDR_MT bit may not
    represent this information consistently on homogeneous machines
    we should prefer the PPTT flag if its available.
    
    Signed-off-by: Jeremy Linton <jeremy.linton@arm.com>
    Reviewed-by: Sudeep Holla <sudeep.holla@arm.com>
    Reviewed-by: Robert Richter <rrichter@marvell.com>
    [will: made acpi_cpu_is_threaded() return 'bool']
    Signed-off-by: Will Deacon <will@kernel.org>
    Signed-off-by: John Garry <john.garry@huawei.com>
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit 2948d192169356b9361331a62e09bae5219a37f4
Author: Pierre-Louis Bossart <pierre-louis.bossart@linux.intel.com>
Date:   Mon Sep 16 13:57:39 2019 -0500

    soundwire: intel: remove X86 dependency
    
    This is not needed and may generate unmet dependencies when
    COMPILE_TEST is used for SOF.
    
    ACPI is required, and should be tested when selecting this option.
    
    Signed-off-by: Pierre-Louis Bossart <pierre-louis.bossart@linux.intel.com>
    Link: https://lore.kernel.org/r/20190916185739.32184-3-pierre-louis.bossart@linux.intel.com
    Signed-off-by: Vinod Koul <vkoul@kernel.org>

commit c2383d398ed97390cdcc3042cfe724ea39188c99
Merge: e78dcbf41454 1600c9c26f6b
Author: Alexei Starovoitov <ast@kernel.org>
Date:   Sat Oct 12 16:09:00 2019 -0700

    Merge branch 'samples-cross-compile'
    
    Ivan Khoronzhuk says:
    
    ====================
    This series contains mainly fixes/improvements for cross-compilation
    but not only, tested for arm, arm64, and intended for any arch.
    Also verified on native build (not cross compilation) for x86_64
    and arm, arm64.
    
    Initial RFC link:
    https://lkml.org/lkml/2019/8/29/1665
    
    Prev. version:
    https://lkml.org/lkml/2019/10/9/1045
    
    Besides the patches given here, the RFC also contains couple patches
    related to llvm clang
      arm: include: asm: swab: mask rev16 instruction for clang
      arm: include: asm: unified: mask .syntax unified for clang
    They are necessarily to verify arm 32 build.
    
    Also, couple more fixes were added but are not merged in bpf-next yet,
    they can be needed for verification/configuration steps, if not in
    your tree the fixes can be taken here:
    https://www.spinics.net/lists/netdev/msg601716.html
    https://www.spinics.net/lists/netdev/msg601714.html
    https://www.spinics.net/lists/linux-kbuild/msg23468.html
    
    Now, to build samples, SAMPLE_BPF should be enabled in config.
    
    The change touches not only cross-compilation and can have impact on
    other archs and build environments, so might be good idea to verify
    it in order to add appropriate changes, some warn options could be
    tuned also.
    
    All is tested on x86-64 with clang installed (has to be built containing
    targets for arm, arm64..., see llc --version, usually it's present already)
    
    Instructions to test native on x86_64
    =================================================
    Native build on x86_64 is done in usual way and shouldn't have difference
    except HOSTCC is now printed as CC wile building the samples.
    
    Instructions to test cross compilation on arm64
    =================================================
    gcc version 8.3.0
    (GNU Toolchain for the A-profile Architecture 8.3-2019.03 (arm-rel-8.36))
    
    I've used sdk for TI am65x got here:
    http://downloads.ti.com/processor-sdk-linux/esd/AM65X/latest/exports/\
    ti-processor-sdk-linux-am65xx-evm-06.00.00.07-Linux-x86-Install.bin
    
    make ARCH=arm64 -C tools/ clean
    make ARCH=arm64 -C samples/bpf clean
    make ARCH=arm64 clean
    make ARCH=arm64 defconfig
    
    make ARCH=arm64 headers_install
    
    make ARCH=arm64 INSTALL_HDR_PATH=/../sdk/\
    ti-processor-sdk-linux-am65xx-evm-06.00.00.07/linux-devkit/sysroots/\
    aarch64-linux/usr headers_install
    
    make samples/bpf/ ARCH=arm64 CROSS_COMPILE="aarch64-linux-gnu-"\
    SYSROOT="/../sdk/ti-processor-sdk-linux-am65xx-evm-06.00.00.07/\
    linux-devkit/sysroots/aarch64-linux"
    
    Instructions to test cross compilation on arm
    =================================================
    arm-linux-gnueabihf-gcc (Linaro GCC 7.2-2017.11) 7.2.1 20171011
    or
    arm-linux-gnueabihf-gcc
    (GNU Toolchain for the A-profile Architecture 8.3-2019.03 \
    (arm-rel-8.36)) 8.3.0
    
    http://downloads.ti.com/processor-sdk-linux/esd/AM57X/05_03_00_07/exports/\
    ti-processor-sdk-linux-am57xx-evm-05.03.00.07-Linux-x86-Install.bin
    
    make ARCH=arm -C tools/ clean
    make ARCH=arm -C samples/bpf clean
    make ARCH=arm clean
    make ARCH=arm omap2plus_defconfig
    
    make ARCH=arm headers_install
    
    make ARCH=arm INSTALL_HDR_PATH=/../sdk/\
    ti-processor-sdk-linux-am57xx-evm-05.03.00.07/linux-devkit/sysroots/\
    armv7ahf-neon-linux-gnueabi/usr headers_install
    
    make samples/bpf/ ARCH=arm CROSS_COMPILE="arm-linux-gnueabihf-"\
    SYSROOT="/../sdk/ti-processor-sdk-linux-am57xx-evm-05.03\
    .00.07/linux-devkit/sysroots/armv7ahf-neon-linux-gnueabi"
    
    Based on bpf-next/master
    
    v5..v4:
    - any changes, only missed SOBs are added
    
    v4..v3:
    - renamed CLANG_EXTRA_CFLAGS on BPF_EXTRA_CFLAGS
    - used filter for ARCH_ARM_SELECTOR
    - omit "-fomit-frame-pointer" and use same flags for native and "cross"
    - used sample/bpf prefixes
    - use C instead of C++ compiler for test_libbpf target
    
    v3..v2:
    - renamed makefile.progs to makeifle.target, as more appropriate
    - left only __LINUX_ARM_ARCH__ for D options for arm
    - for host build - left options from KBUILD_HOST for compatibility reasons
    - split patch adding c/cxx/ld flags to libbpf by modules
    - moved readme change to separate patch
    - added patch setting options for cross-compile
    - fixed issue with option error for syscall_nrs.S,
      avoiding overlap for ccflags-y.
    
    v2..v1:
    - restructured patches order
    - split "samples: bpf: Makefile: base progs build on Makefile.progs"
      to make change more readable. It added couple nice extra patches.
    - removed redundant patch:
      "samples: bpf: Makefile: remove target for native build"
    - added fix:
      "samples: bpf: makefile: fix cookie_uid_helper_example obj build"
    - limited -D option filter only for arm
    - improved comments
    - added couple instructions to verify cross compilation for arm and
      arm64 arches based on TI am57xx and am65xx sdks.
    - corrected include a little order
    ====================
    
    Tested-by: Ilias Apalodimas <ilias.apalodimas@linaro.org>
    Signed-off-by: Alexei Starovoitov <ast@kernel.org>

commit b2327c107d6255e4ea591042120514bedcdc616a
Author: Ivan Khoronzhuk <ivan.khoronzhuk@linaro.org>
Date:   Fri Oct 11 03:28:07 2019 +0300

    samples/bpf: Add sysroot support
    
    Basically it only enables that was added by previous couple fixes.
    Sysroot contains correct libs installed and its headers. Useful when
    working with NFC or virtual machine.
    
    Usage example:
    
    clean (on demand)
        make ARCH=arm -C samples/bpf clean
        make ARCH=arm -C tools clean
        make ARCH=arm clean
    
    configure and install headers:
    
        make ARCH=arm defconfig
        make ARCH=arm headers_install
    
    build samples/bpf:
        make ARCH=arm CROSS_COMPILE=arm-linux-gnueabihf- samples/bpf/ \
        SYSROOT="path/to/sysroot"
    
    Signed-off-by: Ivan Khoronzhuk <ivan.khoronzhuk@linaro.org>
    Signed-off-by: Alexei Starovoitov <ast@kernel.org>
    Link: https://lore.kernel.org/bpf/20191011002808.28206-15-ivan.khoronzhuk@linaro.org

commit d52cd7747d905f5b2a6ec07d5f6abe8720969dc5
Author: Quinn Tran <qutran@marvell.com>
Date:   Thu Sep 12 11:09:16 2019 -0700

    scsi: qla2xxx: Capture FW dump on MPI heartbeat stop event
    
    For MPI heartbeat stop Async Event, this patch would capture MPI FW dump
    and chip reset. FW will tell which function to capture FW dump for.
    
    Link: https://lore.kernel.org/r/20190912180918.6436-13-hmadhani@marvell.com
    Reviewed-by: Laurence Oberman <loberman@redhat.com>
    Signed-off-by: Quinn Tran <qutran@marvell.com>
    Signed-off-by: Himanshu Madhani <hmadhani@marvell.com>
    Signed-off-by: Martin K. Petersen <martin.petersen@oracle.com>

commit e60329c97b9cc07ce15e3c39fc42e57bf14add92
Merge: e3280b54afed 3e7c93bd04ed
Author: Linus Torvalds <torvalds@linux-foundation.org>
Date:   Wed Oct 9 09:27:22 2019 -0700

    Merge tag 'arm64-fixes' of git://git.kernel.org/pub/scm/linux/kernel/git/arm64/linux
    
    Pull arm64 fixes from Will Deacon:
     "A larger-than-usual batch of arm64 fixes for -rc3.
    
      The bulk of the fixes are dealing with a bunch of issues with the
      build system from the compat vDSO, which unfortunately led to some
      significant Makefile rework to manage the horrible combinations of
      toolchains that we can end up needing to drive simultaneously.
    
      We came close to disabling the thing entirely, but Vincenzo was quick
      to spin up some patches and I ended up picking up most of the bits
      that were left [*]. Future work will look at disentangling the header
      files properly.
    
      Other than that, we have some important fixes all over, including one
      papering over the miscompilation fallout from forcing
      CONFIG_OPTIMIZE_INLINING=y, which I'm still unhappy about. Harumph.
    
      We've still got a couple of open issues, so I'm expecting to have some
      more fixes later this cycle.
    
      Summary:
    
       - Numerous fixes to the compat vDSO build system, especially when
         combining gcc and clang
    
       - Fix parsing of PAR_EL1 in spurious kernel fault detection
    
       - Partial workaround for Neoverse-N1 erratum #1542419
    
       - Fix IRQ priority masking on entry from compat syscalls
    
       - Fix advertisment of FRINT HWCAP to userspace
    
       - Attempt to workaround inlining breakage with '__always_inline'
    
       - Fix accidental freeing of parent SVE state on fork() error path
    
       - Add some missing NULL pointer checks in instruction emulation init
    
       - Some formatting and comment fixes"
    
    [*] Will's final fixes were
    
            Reviewed-by: Vincenzo Frascino <vincenzo.frascino@arm.com>
            Tested-by: Vincenzo Frascino <vincenzo.frascino@arm.com>
    
        but they were already in linux-next by then and he didn't rebase
        just to add those.
    
    * tag 'arm64-fixes' of git://git.kernel.org/pub/scm/linux/kernel/git/arm64/linux: (21 commits)
      arm64: armv8_deprecated: Checking return value for memory allocation
      arm64: Kconfig: Make CONFIG_COMPAT_VDSO a proper Kconfig option
      arm64: vdso32: Rename COMPATCC to CC_COMPAT
      arm64: vdso32: Pass '--target' option to clang via VDSO_CAFLAGS
      arm64: vdso32: Don't use KBUILD_CPPFLAGS unconditionally
      arm64: vdso32: Move definition of COMPATCC into vdso32/Makefile
      arm64: Default to building compat vDSO with clang when CONFIG_CC_IS_CLANG
      lib: vdso: Remove CROSS_COMPILE_COMPAT_VDSO
      arm64: vdso32: Remove jump label config option in Makefile
      arm64: vdso32: Detect binutils support for dmb ishld
      arm64: vdso: Remove stale files from old assembly implementation
      arm64: vdso32: Fix broken compat vDSO build warnings
      arm64: mm: fix spurious fault detection
      arm64: ftrace: Ensure synchronisation in PLT setup for Neoverse-N1 #1542419
      arm64: Fix incorrect irqflag restore for priority masking for compat
      arm64: mm: avoid virt_to_phys(init_mm.pgd)
      arm64: cpufeature: Effectively expose FRINT capability to userspace
      arm64: Mark functions using explicit register variables as '__always_inline'
      docs: arm64: Fix indentation and doc formatting
      arm64/sve: Fix wrong free for task->thread.sve_state
      ...

commit 17a29fea086ba18b000d28439bd5cb4f2b0a527b
Author: Paul Burton <paul.burton@mips.com>
Date:   Mon Oct 7 23:18:06 2019 +0000

    staging/octeon: Use stubs for MIPS && !CAVIUM_OCTEON_SOC
    
    When building for a non-Cavium MIPS system with COMPILE_TEST=y, the
    Octeon ethernet driver hits a number of issues due to use of macros
    provided only for CONFIG_CAVIUM_OCTEON_SOC=y configurations. For
    example:
    
      drivers/staging/octeon/ethernet-rx.c:190:6: error:
        'CONFIG_CAVIUM_OCTEON_CVMSEG_SIZE' undeclared (first use in this function)
      drivers/staging/octeon/ethernet-rx.c:472:25: error:
        'OCTEON_IRQ_WORKQ0' undeclared (first use in this function)
    
    These come from various asm/ headers that a non-Octeon build will be
    using a non-Octeon version of.
    
    Fix this by using the octeon-stubs.h header for non-Cavium MIPS builds,
    and only using the real asm/octeon/ headers when building a Cavium
    Octeon kernel configuration.
    
    This requires that octeon-stubs.h doesn't redefine XKPHYS_TO_PHYS, which
    is defined for MIPS by asm/addrspace.h which is pulled in by many other
    common asm/ headers.
    
    Signed-off-by: Paul Burton <paul.burton@mips.com>
    Reported-by: Geert Uytterhoeven <geert@linux-m68k.org>
    URL: https://lore.kernel.org/linux-mips/CAMuHMdXvu+BppwzsU9imNWVKea_hoLcRt9N+a29Q-QsjW=ip2g@mail.gmail.com/
    Fixes: 171a9bae68c7 ("staging/octeon: Allow test build on !MIPS")
    Cc: Matthew Wilcox (Oracle) <willy@infradead.org>
    Cc: David S. Miller <davem@davemloft.net>
    
    Link: https://lore.kernel.org/r/20191007231741.2012860-1-paul.burton@mips.com
    Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>

commit 93916beb70143c46bf1d2bacf814be3a124b253b
Author: Marc Zyngier <marc.zyngier@arm.com>
Date:   Tue Apr 9 16:26:21 2019 +0100

    arm64: Enable workaround for Cavium TX2 erratum 219 when running SMT
    
    It appears that the only case where we need to apply the TX2_219_TVM
    mitigation is when the core is in SMT mode. So let's condition the
    enabling on detecting a CPU whose MPIDR_EL1.Aff0 is non-zero.
    
    Cc: <stable@vger.kernel.org>
    Signed-off-by: Marc Zyngier <marc.zyngier@arm.com>
    Signed-off-by: Will Deacon <will@kernel.org>

commit eff9cb67be21346402ea07d7a48564909b4f0f25
Author: Will Deacon <will@kernel.org>
Date:   Fri Oct 4 14:20:06 2019 +0100

    arm64: vdso32: Rename COMPATCC to CC_COMPAT
    
    For consistency with CROSS_COMPILE_COMPAT, mechanically rename COMPATCC
    to CC_COMPAT so that specifying aspects of the compat vDSO toolchain in
    the environment isn't needlessly confusing.
    
    Acked-by: Catalin Marinas <catalin.marinas@arm.com>
    Signed-off-by: Will Deacon <will@kernel.org>

commit c71e88c437962c1ec43d4d23a0ebf4c9cf9bee0d
Author: Will Deacon <will@kernel.org>
Date:   Fri Oct 4 15:44:45 2019 +0100

    arm64: vdso32: Don't use KBUILD_CPPFLAGS unconditionally
    
    KBUILD_CPPFLAGS is defined differently depending on whether the main
    compiler is clang or not. This means that it is not possible to build
    the compat vDSO with GCC if the rest of the kernel is built with clang.
    
    Define VDSO_CPPFLAGS directly to break this dependency and allow a clang
    kernel to build a compat vDSO with GCC:
    
      $ make ARCH=arm64 CROSS_COMPILE=aarch64-linux-gnu- \
        CROSS_COMPILE_COMPAT=arm-linux-gnueabihf- CC=clang \
        COMPATCC=arm-linux-gnueabihf-gcc
    
    Acked-by: Catalin Marinas <catalin.marinas@arm.com>
    Signed-off-by: Will Deacon <will@kernel.org>

commit 24ee01a927bfe56c66429ec4b1df6955a814adc8
Author: Will Deacon <will@kernel.org>
Date:   Fri Oct 4 14:08:13 2019 +0100

    arm64: Default to building compat vDSO with clang when CONFIG_CC_IS_CLANG
    
    Rather than force the use of GCC for the compat cross-compiler, instead
    extract the target from CROSS_COMPILE_COMPAT and pass it to clang if the
    main compiler is clang.
    
    Acked-by: Catalin Marinas <catalin.marinas@arm.com>
    Signed-off-by: Will Deacon <will@kernel.org>

commit 50a2610adec9d796b25e262734edb56ef324ce15
Author: Vincenzo Frascino <vincenzo.frascino@arm.com>
Date:   Thu Oct 3 18:48:38 2019 +0100

    lib: vdso: Remove CROSS_COMPILE_COMPAT_VDSO
    
    arm64 was the last architecture using CROSS_COMPILE_COMPAT_VDSO config
    option. With this patch series the dependency in the architecture has
    been removed.
    
    Remove CROSS_COMPILE_COMPAT_VDSO from the Unified vDSO library code.
    
    Cc: Thomas Gleixner <tglx@linutronix.de>
    Cc: Andy Lutomirski <luto@kernel.org>
    Signed-off-by: Vincenzo Frascino <vincenzo.frascino@arm.com>
    Signed-off-by: Will Deacon <will@kernel.org>

commit e0de01aafc3dd7b73308106b056ead2d48391905
Author: Vincenzo Frascino <vincenzo.frascino@arm.com>
Date:   Thu Oct 3 18:48:33 2019 +0100

    arm64: vdso32: Fix broken compat vDSO build warnings
    
    The .config file and the generated include/config/auto.conf can
    end up out of sync after a set of commands since
    CONFIG_CROSS_COMPILE_COMPAT_VDSO is not updated correctly.
    
    The sequence can be reproduced as follows:
    
    $ make ARCH=arm64 CROSS_COMPILE=aarch64-linux-gnu- defconfig
    [...]
    $ make ARCH=arm64 CROSS_COMPILE=aarch64-linux-gnu- menuconfig
    [set CONFIG_CROSS_COMPILE_COMPAT_VDSO="arm-linux-gnueabihf-"]
    $ make ARCH=arm64 CROSS_COMPILE=aarch64-linux-gnu-
    
    Which results in:
    
    arch/arm64/Makefile:62: CROSS_COMPILE_COMPAT not defined or empty,
    the compat vDSO will not be built
    
    even though the compat vDSO has been built:
    
    $ file arch/arm64/kernel/vdso32/vdso.so
    arch/arm64/kernel/vdso32/vdso.so: ELF 32-bit LSB pie executable, ARM,
    EABI5 version 1 (SYSV), dynamically linked,
    BuildID[sha1]=c67f6c786f2d2d6f86c71f708595594aa25247f6, stripped
    
    A similar case that involves changing the configuration parameter
    multiple times can be reconducted to the same family of problems.
    
    Remove the use of CONFIG_CROSS_COMPILE_COMPAT_VDSO altogether and
    instead rely on the cross-compiler prefix coming from the environment
    via CROSS_COMPILE_COMPAT, much like we do for the rest of the kernel.
    
    Cc: Will Deacon <will@kernel.org>
    Cc: Catalin Marinas <catalin.marinas@arm.com>
    Reported-by: Will Deacon <will@kernel.org>
    Signed-off-by: Vincenzo Frascino <vincenzo.frascino@arm.com>
    Signed-off-by: Will Deacon <will@kernel.org>

commit 6880e07374031d7a9bd08db0c304caa2d3a44ede
Author: Herbert Xu <herbert@gondor.apana.org.au>
Date:   Mon Jun 24 18:32:26 2019 +0800

    lib/mpi: Fix karactx leak in mpi_powm
    
    commit c8ea9fce2baf7b643384f36f29e4194fa40d33a6 upstream.
    
    Sometimes mpi_powm will leak karactx because a memory allocation
    failure causes a bail-out that skips the freeing of karactx.  This
    patch moves the freeing of karactx to the end of the function like
    everything else so that it can't be skipped.
    
    Reported-by: syzbot+f7baccc38dcc1e094e77@syzkaller.appspotmail.com
    Fixes: cdec9cb5167a ("crypto: GnuPG based MPI lib - source files...")
    Signed-off-by: Herbert Xu <herbert@gondor.apana.org.au>
    Reviewed-by: Eric Biggers <ebiggers@kernel.org>
    Signed-off-by: Herbert Xu <herbert@gondor.apana.org.au>
    Signed-off-by: Ben Hutchings <ben@decadent.org.uk>

commit c44f658d1731f0ebb48397cda27a36291959833c
Author: Mark Rutland <mark.rutland@arm.com>
Date:   Wed Aug 14 15:31:57 2019 +0100

    kasan/arm64: fix CONFIG_KASAN_SW_TAGS && KASAN_INLINE
    
    [ Upstream commit 34b5560db40d2941cfbe82eca1641353d5aed1a9 ]
    
    The generic Makefile.kasan propagates CONFIG_KASAN_SHADOW_OFFSET into
    KASAN_SHADOW_OFFSET, but only does so for CONFIG_KASAN_GENERIC.
    
    Since commit:
    
      6bd1d0be0e97936d ("arm64: kasan: Switch to using KASAN_SHADOW_OFFSET")
    
    ... arm64 defines CONFIG_KASAN_SHADOW_OFFSET in Kconfig rather than
    defining KASAN_SHADOW_OFFSET in a Makefile. Thus, if
    CONFIG_KASAN_SW_TAGS && KASAN_INLINE are selected, we get build time
    splats due to KASAN_SHADOW_OFFSET not being set:
    
    | [mark@lakrids:~/src/linux]% usellvm 8.0.1 usekorg 8.1.0  make ARCH=arm64 CROSS_COMPILE=aarch64-linux- CC=clang
    | scripts/kconfig/conf  --syncconfig Kconfig
    |   CC      scripts/mod/empty.o
    | clang (LLVM option parsing): for the -hwasan-mapping-offset option: '' value invalid for uint argument!
    | scripts/Makefile.build:273: recipe for target 'scripts/mod/empty.o' failed
    | make[1]: *** [scripts/mod/empty.o] Error 1
    | Makefile:1123: recipe for target 'prepare0' failed
    | make: *** [prepare0] Error 2
    
    Let's fix this by always propagating CONFIG_KASAN_SHADOW_OFFSET into
    KASAN_SHADOW_OFFSET if CONFIG_KASAN is selected, moving the existing
    common definition of +CFLAGS_KASAN_NOSANITIZE to the top of
    Makefile.kasan.
    
    Cc: Catalin Marinas <catalin.marinas@arm.com>
    Signed-off-by: Mark Rutland <mark.rutland@arm.com>
    Acked-by: Andrey Ryabinin <aryabinin@virtuozzo.com>
    Tested-by Steve Capper <steve.capper@arm.com>
    Signed-off-by: Will Deacon <will@kernel.org>
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit 57e2eda9a744c5ce44ab56aa9f1d24092a27544b
Author: YueHaibing <yuehaibing@huawei.com>
Date:   Wed Jul 24 23:41:29 2019 -0300

    media: staging: tegra-vde: Fix build error
    
    [ Upstream commit 6b2265975239ab655069d796b822835a593e1cc7 ]
    
    If IOMMU_SUPPORT is not set, and COMPILE_TEST is y,
    IOMMU_IOVA may be set to m. So building will fails:
    
    drivers/staging/media/tegra-vde/iommu.o: In function `tegra_vde_iommu_map':
    iommu.c:(.text+0x41): undefined reference to `alloc_iova'
    iommu.c:(.text+0x56): undefined reference to `__free_iova'
    
    Select IOMMU_IOVA while COMPILE_TEST is set to fix this.
    
    Reported-by: Hulk Robot <hulkci@huawei.com>
    Suggested-by: Dmitry Osipenko <digetx@gmail.com>
    Fixes: b301f8de1925 ("media: staging: media: tegra-vde: Add IOMMU support")
    Signed-off-by: YueHaibing <yuehaibing@huawei.com>
    Acked-by: Dmitry Osipenko <digetx@gmail.com>
    Signed-off-by: Hans Verkuil <hverkuil-cisco@xs4all.nl>
    Signed-off-by: Mauro Carvalho Chehab <mchehab+samsung@kernel.org>
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit 2e984ea2f81563b6620b2bdfe361ea69be9ad98d
Author: Randy Dunlap <rdunlap@infradead.org>
Date:   Tue Aug 6 19:01:36 2019 -0300

    media: media/platform: fsl-viu.c: fix build for MICROBLAZE
    
    [ Upstream commit 6898dd580a045341f844862ceb775144156ec1af ]
    
    arch/microblaze/ defines out_be32() and in_be32(), so don't do that
    again in the driver source.
    
    Fixes these build warnings:
    
    ../drivers/media/platform/fsl-viu.c:36: warning: "out_be32" redefined
    ../arch/microblaze/include/asm/io.h:50: note: this is the location of the previous definition
    ../drivers/media/platform/fsl-viu.c:37: warning: "in_be32" redefined
    ../arch/microblaze/include/asm/io.h:53: note: this is the location of the previous definition
    
    Fixes: 29d750686331 ("media: fsl-viu: allow building it with COMPILE_TEST")
    Signed-off-by: Randy Dunlap <rdunlap@infradead.org>
    Signed-off-by: Hans Verkuil <hverkuil-cisco@xs4all.nl>
    Signed-off-by: Mauro Carvalho Chehab <mchehab+samsung@kernel.org>
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit c3e1334bc47ae2600229e57100f25667baf3e1b7
Author: Mark Rutland <mark.rutland@arm.com>
Date:   Wed Aug 14 15:31:57 2019 +0100

    kasan/arm64: fix CONFIG_KASAN_SW_TAGS && KASAN_INLINE
    
    [ Upstream commit 34b5560db40d2941cfbe82eca1641353d5aed1a9 ]
    
    The generic Makefile.kasan propagates CONFIG_KASAN_SHADOW_OFFSET into
    KASAN_SHADOW_OFFSET, but only does so for CONFIG_KASAN_GENERIC.
    
    Since commit:
    
      6bd1d0be0e97936d ("arm64: kasan: Switch to using KASAN_SHADOW_OFFSET")
    
    ... arm64 defines CONFIG_KASAN_SHADOW_OFFSET in Kconfig rather than
    defining KASAN_SHADOW_OFFSET in a Makefile. Thus, if
    CONFIG_KASAN_SW_TAGS && KASAN_INLINE are selected, we get build time
    splats due to KASAN_SHADOW_OFFSET not being set:
    
    | [mark@lakrids:~/src/linux]% usellvm 8.0.1 usekorg 8.1.0  make ARCH=arm64 CROSS_COMPILE=aarch64-linux- CC=clang
    | scripts/kconfig/conf  --syncconfig Kconfig
    |   CC      scripts/mod/empty.o
    | clang (LLVM option parsing): for the -hwasan-mapping-offset option: '' value invalid for uint argument!
    | scripts/Makefile.build:273: recipe for target 'scripts/mod/empty.o' failed
    | make[1]: *** [scripts/mod/empty.o] Error 1
    | Makefile:1123: recipe for target 'prepare0' failed
    | make: *** [prepare0] Error 2
    
    Let's fix this by always propagating CONFIG_KASAN_SHADOW_OFFSET into
    KASAN_SHADOW_OFFSET if CONFIG_KASAN is selected, moving the existing
    common definition of +CFLAGS_KASAN_NOSANITIZE to the top of
    Makefile.kasan.
    
    Cc: Catalin Marinas <catalin.marinas@arm.com>
    Signed-off-by: Mark Rutland <mark.rutland@arm.com>
    Acked-by: Andrey Ryabinin <aryabinin@virtuozzo.com>
    Tested-by Steve Capper <steve.capper@arm.com>
    Signed-off-by: Will Deacon <will@kernel.org>
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit ff45dc5d103f4db0051ff2e0b1ca7e32b39735fe
Author: Randy Dunlap <rdunlap@infradead.org>
Date:   Tue Aug 6 19:01:36 2019 -0300

    media: media/platform: fsl-viu.c: fix build for MICROBLAZE
    
    [ Upstream commit 6898dd580a045341f844862ceb775144156ec1af ]
    
    arch/microblaze/ defines out_be32() and in_be32(), so don't do that
    again in the driver source.
    
    Fixes these build warnings:
    
    ../drivers/media/platform/fsl-viu.c:36: warning: "out_be32" redefined
    ../arch/microblaze/include/asm/io.h:50: note: this is the location of the previous definition
    ../drivers/media/platform/fsl-viu.c:37: warning: "in_be32" redefined
    ../arch/microblaze/include/asm/io.h:53: note: this is the location of the previous definition
    
    Fixes: 29d750686331 ("media: fsl-viu: allow building it with COMPILE_TEST")
    Signed-off-by: Randy Dunlap <rdunlap@infradead.org>
    Signed-off-by: Hans Verkuil <hverkuil-cisco@xs4all.nl>
    Signed-off-by: Mauro Carvalho Chehab <mchehab+samsung@kernel.org>
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit 465bc6e80fd2df46388f2fb448e39aea6c25358f
Author: Randy Dunlap <rdunlap@infradead.org>
Date:   Tue Aug 6 19:01:36 2019 -0300

    media: media/platform: fsl-viu.c: fix build for MICROBLAZE
    
    [ Upstream commit 6898dd580a045341f844862ceb775144156ec1af ]
    
    arch/microblaze/ defines out_be32() and in_be32(), so don't do that
    again in the driver source.
    
    Fixes these build warnings:
    
    ../drivers/media/platform/fsl-viu.c:36: warning: "out_be32" redefined
    ../arch/microblaze/include/asm/io.h:50: note: this is the location of the previous definition
    ../drivers/media/platform/fsl-viu.c:37: warning: "in_be32" redefined
    ../arch/microblaze/include/asm/io.h:53: note: this is the location of the previous definition
    
    Fixes: 29d750686331 ("media: fsl-viu: allow building it with COMPILE_TEST")
    Signed-off-by: Randy Dunlap <rdunlap@infradead.org>
    Signed-off-by: Hans Verkuil <hverkuil-cisco@xs4all.nl>
    Signed-off-by: Mauro Carvalho Chehab <mchehab+samsung@kernel.org>
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit 5c6bd5de3c2e5bc8a17451e281ed2613375a7fd5
Merge: f7c3bf8fa7e5 05d013a0366d
Author: Linus Torvalds <torvalds@linux-foundation.org>
Date:   Sun Sep 22 09:30:30 2019 -0700

    Merge tag 'mips_5.4' of git://git.kernel.org/pub/scm/linux/kernel/git/mips/linux
    
    Pull MIPS updates from Paul Burton:
     "Main MIPS changes:
    
       - boot_mem_map is removed, providing a nice cleanup made possible by
         the recent removal of bootmem.
    
       - Some fixes to atomics, in general providing compiler barriers for
         smp_mb__{before,after}_atomic plus fixes specific to Loongson CPUs
         or MIPS32 systems using cmpxchg64().
    
       - Conversion to the new generic VDSO infrastructure courtesy of
         Vincenzo Frascino.
    
       - Removal of undefined behavior in set_io_port_base(), fixing the
         behavior of some MIPS kernel configurations when built with recent
         clang versions.
    
       - Initial MIPS32 huge page support, functional on at least Ingenic
         SoCs.
    
       - pte_special() is now supported for some configurations, allowing
         among other things generic fast GUP to be used.
    
       - Miscellaneous fixes & cleanups.
    
      And platform specific changes:
    
       - Major improvements to Ingenic SoC support from Paul Cercueil,
         mostly enabled by the inclusion of the new TCU (timer-counter unit)
         drivers he's spent a very patient year or so working on. Plus some
         fixes for X1000 SoCs from Zhou Yanjie.
    
       - Netgear R6200 v1 systems are now supported by the bcm47xx platform.
    
       - DT updates for BMIPS, Lantiq & Microsemi Ocelot systems"
    
    * tag 'mips_5.4' of git://git.kernel.org/pub/scm/linux/kernel/git/mips/linux: (89 commits)
      MIPS: Detect bad _PFN_SHIFT values
      MIPS: Disable pte_special() for MIPS32 with RiXi
      MIPS: ralink: deactivate PCI support for SOC_MT7621
      mips: compat: vdso: Use legacy syscalls as fallback
      MIPS: Drop Loongson _CACHE_* definitions
      MIPS: tlbex: Remove cpu_has_local_ebase
      MIPS: tlbex: Simplify r3k check
      MIPS: Select R3k-style TLB in Kconfig
      MIPS: PCI: refactor ioc3 special handling
      mips: remove ioremap_cachable
      mips/atomic: Fix smp_mb__{before,after}_atomic()
      mips/atomic: Fix loongson_llsc_mb() wreckage
      mips/atomic: Fix cmpxchg64 barriers
      MIPS: Octeon: remove duplicated include from dma-octeon.c
      firmware: bcm47xx_nvram: Allow COMPILE_TEST
      firmware: bcm47xx_nvram: Correct size_t printf format
      MIPS: Treat Loongson Extensions as ASEs
      MIPS: Remove dev_err() usage after platform_get_irq()
      MIPS: dts: mscc: describe the PTP ready interrupt
      MIPS: dts: mscc: describe the PTP register range
      ...

commit 147162f575152db80000fb3de26358264768ee9f
Author: Arnd Bergmann <arnd@arndb.de>
Date:   Fri Sep 20 09:50:18 2019 +0200

    ASoC: ti: fix SND_SOC_DM365_VOICE_CODEC dependencies
    
    SND_SOC_DM365_VOICE_CODEC is a 'bool' option in a choice statement,
    meaning it cannot be set to =m, but it selects two other drivers
    that we may want to be loadable modules after all:
    
    WARNING: unmet direct dependencies detected for SND_SOC_CQ0093VC
      Depends on [m]: SOUND [=m] && !UML && SND [=m] && SND_SOC [=m]
      Selected by [y]:
      - SND_SOC_DM365_VOICE_CODEC [=y] && <choice>
      Selected by [m]:
      - SND_SOC_ALL_CODECS [=m] && SOUND [=m] && !UML && SND [=m] && SND_SOC [=m] && COMPILE_TEST [=y]
    
    Add an intermediate symbol that sets SND_SOC_CQ0093VC and
    MFD_DAVINCI_VOICECODEC to =m if SND_SOC=m.
    
    Signed-off-by: Arnd Bergmann <arnd@arndb.de>
    Link: https://lore.kernel.org/r/20190920075046.3210393-1-arnd@arndb.de
    Signed-off-by: Mark Brown <broonie@kernel.org>

commit 8b53c76533aa4356602aea98f98a2f3b4051464c
Merge: 6cfae0c26b21 9575d1a5c078
Author: Linus Torvalds <torvalds@linux-foundation.org>
Date:   Wed Sep 18 12:11:14 2019 -0700

    Merge branch 'linus' of git://git.kernel.org/pub/scm/linux/kernel/git/herbert/crypto-2.6
    
    Pull crypto updates from Herbert Xu:
     "API:
       - Add the ability to abort a skcipher walk.
    
      Algorithms:
       - Fix XTS to actually do the stealing.
       - Add library helpers for AES and DES for single-block users.
       - Add library helpers for SHA256.
       - Add new DES key verification helper.
       - Add surrounding bits for ESSIV generator.
       - Add accelerations for aegis128.
       - Add test vectors for lzo-rle.
    
      Drivers:
       - Add i.MX8MQ support to caam.
       - Add gcm/ccm/cfb/ofb aes support in inside-secure.
       - Add ofb/cfb aes support in media-tek.
       - Add HiSilicon ZIP accelerator support.
    
      Others:
       - Fix potential race condition in padata.
       - Use unbound workqueues in padata"
    
    * 'linus' of git://git.kernel.org/pub/scm/linux/kernel/git/herbert/crypto-2.6: (311 commits)
      crypto: caam - Cast to long first before pointer conversion
      crypto: ccree - enable CTS support in AES-XTS
      crypto: inside-secure - Probe transform record cache RAM sizes
      crypto: inside-secure - Base RD fetchcount on actual RD FIFO size
      crypto: inside-secure - Base CD fetchcount on actual CD FIFO size
      crypto: inside-secure - Enable extended algorithms on newer HW
      crypto: inside-secure: Corrected configuration of EIP96_TOKEN_CTRL
      crypto: inside-secure - Add EIP97/EIP197 and endianness detection
      padata: remove cpu_index from the parallel_queue
      padata: unbind parallel jobs from specific CPUs
      padata: use separate workqueues for parallel and serial work
      padata, pcrypt: take CPU hotplug lock internally in padata_alloc_possible
      crypto: pcrypt - remove padata cpumask notifier
      padata: make padata_do_parallel find alternate callback CPU
      workqueue: require CPU hotplug read exclusion for apply_workqueue_attrs
      workqueue: unconfine alloc/apply/free_workqueue_attrs()
      padata: allocate workqueue internally
      arm64: dts: imx8mq: Add CAAM node
      random: Use wait_event_freezable() in add_hwgenerator_randomness()
      crypto: ux500 - Fix COMPILE_TEST warnings
      ...

commit 031f469ecf7c85d2d43a04abd256b6f3a1ef5794
Merge: ca61a72ac371 da9cd91c87ad
Author: Rafael J. Wysocki <rafael.j.wysocki@intel.com>
Date:   Tue Sep 17 09:45:44 2019 +0200

    Merge branch 'pm-devfreq'
    
    * pm-devfreq: (28 commits)
      PM / devfreq: passive: fix compiler warning
      PM / devfreq: passive: Use non-devm notifiers
      PM / devfreq: exynos-bus: Convert to use dev_pm_opp_set_rate()
      PM / devfreq: exynos-bus: Correct clock enable sequence
      PM / devfreq: Correct devm_devfreq_remove_device() documentation
      PM / devfreq: events: extend events by type of counted data
      PM / devfreq: exynos-events: change matching code during probe
      PM / devfreq: tegra20: add COMMON_CLK dependency
      PM / devfreq: events: add Exynos PPMU new events
      PM / devfreq: Fix kernel oops on governor module load
      PM / devfreq: rk3399_dmc: Fix spelling typo
      PM / devfreq: Fix spelling typo
      PM / devfreq: Introduce driver for NVIDIA Tegra20
      PM / devfreq: tegra: Rename tegra-devfreq.c to tegra30-devfreq.c
      PM / devfreq: tegra: Enable COMPILE_TEST for the driver
      PM / devfreq: tegra: Support Tegra30
      PM / devfreq: tegra: Reconfigure hardware on governor's restart
      PM / devfreq: tegra: Move governor registration to driver's probe
      PM / devfreq: tegra: Mark ACTMON's governor as immutable
      PM / devfreq: tegra: Avoid inconsistency of current frequency value
      ...

commit 2b97c39514a6130f38b14227a36d9cd37e650a9d
Merge: d0a16fe93438 0366977480c4
Author: Linus Torvalds <torvalds@linux-foundation.org>
Date:   Mon Sep 16 15:48:14 2019 -0700

    Merge tag 'armsoc-soc' of git://git.kernel.org/pub/scm/linux/kernel/git/soc/soc
    
    Pull ARM SoC platform updates from Arnd Bergmann:
     "The main change this time around is a cleanup of some of the oldest
      platforms based on the XScale and ARM9 CPU cores, which are between 10
      and 20 years old.
    
      The Kendin/Micrel/Microchip KS8695, Winbond/Nuvoton W90x900 and Intel
      IOP33x/IOP13xx platforms are removed after we determined that nobody
      is using them any more.
    
      The TI Davinci and NXP LPC32xx platforms on the other hand are still
      in active use and are converted to the ARCH_MULTIPLATFORM build,
      meaning that we can compile a kernel that works on these along with
      most other ARMv5 platforms. Changes toward that goal are also merged
      for IOP32x, but additional work is needed to complete this. Patches
      for the remaining ARMv5 platforms have started but need more work and
      some testing.
    
      Support for the new ASpeed AST2600 gets added, this is based on the
      Cortex-A7 ARMv7 core, and is a newer version of the existing ARMv5 and
      ARMv6 chips in the same family.
    
      Other changes include a cleanup of the ST-Ericsson ux500 platform and
      the move of the TI Davinci platform to a new clocksource driver"
    
    [ The changes had marked INTEL_IOP_ADMA and USB_LPC32XX as being
      buildable on other platforms through COMPILE_TEST, but that causes new
      warnings that I most definitely do not want to see during the merge
      window as that could hide other issues.
    
      So the COMPILE_TEST option got disabled for them again   - Linus ]
    
    * tag 'armsoc-soc' of git://git.kernel.org/pub/scm/linux/kernel/git/soc/soc: (61 commits)
      ARM: multi_v5_defconfig: make DaVinci part of the ARM v5 multiplatform build
      ARM: davinci: support multiplatform build for ARM v5
      arm64: exynos: Enable exynos-chipid driver
      ARM: OMAP2+: Delete an unnecessary kfree() call in omap_hsmmc_pdata_init()
      ARM: OMAP2+: move platform-specific asm-offset.h to arch/arm/mach-omap2
      ARM: davinci: dm646x: Fix a typo in the comment
      ARM: davinci: dm646x: switch to using the clocksource driver
      ARM: davinci: dm644x: switch to using the clocksource driver
      ARM: aspeed: Enable SMP boot
      ARM: aspeed: Add ASPEED AST2600 architecture
      ARM: aspeed: Select timer in each SoC
      dt-bindings: arm: cpus: Add ASPEED SMP
      ARM: imx: stop adjusting ar8031 phy tx delay
      mailmap: map old company name to new one @microchip.com
      MAINTAINERS: at91: remove the TC entry
      MAINTAINERS: at91: Collect all pinctrl/gpio drivers in same entry
      ARM: at91: move platform-specific asm-offset.h to arch/arm/mach-at91
      MAINTAINERS: Extend patterns for Samsung SoC, Security Subsystem and clock drivers
      ARM: s3c64xx: squash samsung_usb_phy.h into setup-usb-phy.c
      ARM: debug-ll: Add support for r7s9210
      ...

commit c9b8af43a7cddf4f0bd8f36a4242cf70e73097fa
Author: Arnd Bergmann <arnd@arndb.de>
Date:   Fri Aug 9 16:40:29 2019 +0200

    watchdog: pnx4008_wdt: allow compile-testing
    
    The only thing that prevents building this driver on other
    platforms is the mach/hardware.h include, which is not actually
    used here at all, so remove the line and allow CONFIG_COMPILE_TEST.
    
    Acked-by: Sylvain Lemieux <slemieux.tyco@gmail.com>
    Reviewed-by: Guenter Roeck <linux@roeck-us.net>
    Signed-off-by: Arnd Bergmann <arnd@arndb.de>
    Link: https://lore.kernel.org/r/20190809144043.476786-4-arnd@arndb.de
    Signed-off-by: Guenter Roeck <linux@roeck-us.net>
    Signed-off-by: Wim Van Sebroeck <wim@linux-watchdog.org>

commit bec53196adf4791d466adf0e339b61186c7b5283
Author: Hari Bathini <hbathini@linux.ibm.com>
Date:   Wed Sep 11 20:26:03 2019 +0530

    powerpc/fadump: add support to preserve crash data on FADUMP disabled kernel
    
    Add a new kernel config option, CONFIG_PRESERVE_FA_DUMP that ensures
    that crash data, from previously crash'ed kernel, is preserved. This
    helps in cases where FADump is not enabled but the subsequent memory
    preserving kernel boot is likely to process this crash data. One
    typical usecase for this config option is petitboot kernel.
    
    As OPAL allows registering address with it in the first kernel and
    retrieving it after MPIPL, use it to store the top of boot memory.
    A kernel that intends to preserve crash data retrieves it and avoids
    using memory beyond this address.
    
    Move arch_reserved_kernel_pages() function as it is needed for both
    FA_DUMP and PRESERVE_FA_DUMP configurations.
    
    Signed-off-by: Hari Bathini <hbathini@linux.ibm.com>
    Signed-off-by: Michael Ellerman <mpe@ellerman.id.au>
    Link: https://lore.kernel.org/r/156821375751.5656.11459483669542541602.stgit@hbathini.in.ibm.com

commit 6071e8f9d5ac960f0d35495f070d4d0b7ae5fc76
Author: Hari Bathini <hbathini@linux.ibm.com>
Date:   Wed Sep 11 20:22:32 2019 +0530

    powerpc/fadump: Warn before processing partial crashdump
    
    If all kernel boot memory regions are not registered for MPIPL before
    system crashes, try processing the partial crashdump but warn the user
    before proceeding.
    
    Signed-off-by: Hari Bathini <hbathini@linux.ibm.com>
    Signed-off-by: Michael Ellerman <mpe@ellerman.id.au>
    Link: https://lore.kernel.org/r/156821352793.5656.1734051341024721407.stgit@hbathini.in.ibm.com

commit 2a1b06dd3a17ac278494da3c15cac84684346d22
Author: Hari Bathini <hbathini@linux.ibm.com>
Date:   Wed Sep 11 20:21:59 2019 +0530

    powerpc/fadump: process the crashdump by exporting it as /proc/vmcore
    
    Add support in the kernel to process the crash'ed kernel's memory
    preserved during MPIPL and export it as /proc/vmcore file for the
    userland scripts to filter and analyze it later.
    
    Signed-off-by: Hari Bathini <hbathini@linux.ibm.com>
    Signed-off-by: Michael Ellerman <mpe@ellerman.id.au>
    Link: https://lore.kernel.org/r/156821351482.5656.6255805804744333073.stgit@hbathini.in.ibm.com

commit 51bba8edef90cf579dba16de912d3ef809fe1d77
Author: Hari Bathini <hbathini@linux.ibm.com>
Date:   Wed Sep 11 20:21:46 2019 +0530

    powerpc/fadump: support copying multiple kernel boot memory regions
    
    Firmware uses a 32-bit field for size while copying/backing-up memory
    during MPIPL. So, the maximum value that could be represented with
    a PAGE_SIZE aligned 32-bit field will be the maximum copy size for a
    region but FADump capture kernel usually needs more memory than that
    to be preserved to avoid running into out of memory errors.
    
    So, request firmware to copy multiple kernel boot memory regions
    instead of just one (which worked fine for pseries as 64-bit field
    was used for size there).
    
    Signed-off-by: Hari Bathini <hbathini@linux.ibm.com>
    Signed-off-by: Michael Ellerman <mpe@ellerman.id.au>
    Link: https://lore.kernel.org/r/156821350193.5656.3664853158523582019.stgit@hbathini.in.ibm.com

commit a20a8fa42def548f46c7e0401a94f62b8e595883
Author: Hari Bathini <hbathini@linux.ibm.com>
Date:   Wed Sep 11 20:21:33 2019 +0530

    powerpc/fadump: define OPAL register/un-register callback functions
    
    Make OPAL calls to register and un-register with firmware for MPIPL.
    
    Signed-off-by: Hari Bathini <hbathini@linux.ibm.com>
    Signed-off-by: Michael Ellerman <mpe@ellerman.id.au>
    Link: https://lore.kernel.org/r/156821348482.5656.13646250851483648241.stgit@hbathini.in.ibm.com

commit 742a265accd3e3afcc8e7b17f409c93c1de8be85
Author: Hari Bathini <hbathini@linux.ibm.com>
Date:   Wed Sep 11 20:20:57 2019 +0530

    powerpc/fadump: register kernel metadata address with opal
    
    OPAL allows registering address with it in the first kernel and
    retrieving it after MPIPL. Setup kernel metadata and register its
    address with OPAL to use it for processing the crash dump.
    
    Signed-off-by: Hari Bathini <hbathini@linux.ibm.com>
    Signed-off-by: Michael Ellerman <mpe@ellerman.id.au>
    Link: https://lore.kernel.org/r/156821345011.5656.13567765019032928471.stgit@hbathini.in.ibm.com

commit 6f5f193e84d3d7b55d406ecc7ac4ea1ef1d1876f
Author: Hari Bathini <hbathini@linux.ibm.com>
Date:   Wed Sep 11 20:20:12 2019 +0530

    powerpc/opal: add MPIPL interface definitions
    
    MPIPL is Memory Preserving IPL supported from POWER9. This enables the
    kernel to reset the system with memory 'preserved'. Also, it supports
    copying memory from a source address to some destination address during
    MPIPL boot. Add MPIPL interface definitions here to leverage these f/w
    features in adding FADump support for PowerNV platform.
    
    Signed-off-by: Hari Bathini <hbathini@linux.ibm.com>
    Signed-off-by: Michael Ellerman <mpe@ellerman.id.au>
    Link: https://lore.kernel.org/r/156821340710.5656.10071829040515662624.stgit@hbathini.in.ibm.com

commit 347bce3eab76b2e07147f8d4b4436d59264f8132
Author: Herbert Xu <herbert@gondor.apana.org.au>
Date:   Thu Sep 5 14:51:37 2019 +1000

    crypto: ux500 - Fix COMPILE_TEST warnings
    
    This patch fixes a number of warnings encountered when this driver
    is built on a 64-bit platform with COMPILE_TEST.
    
    Signed-off-by: Herbert Xu <herbert@gondor.apana.org.au>

commit 62974fc389b364d8af70e044836362222bd3ae53
Author: Dan Williams <dan.j.williams@intel.com>
Date:   Wed Sep 4 15:43:31 2019 -0700

    libnvdimm: Enable unit test infrastructure compile checks
    
    The infrastructure to mock core libnvdimm routines for unit testing
    purposes is prone to bitrot relative to refactoring of that core.  Arrange
    for the unit test core to be built when CONFIG_COMPILE_TEST=y.  This does
    not result in a functional unit test environment, it is only a helper for
    0day to catch unit test build regressions.
    
    Note that there are a few x86isms in the implementation, so this does not
    bother compile testing this architectures other than 64-bit x86.
    
    Link: https://lore.kernel.org/r/156763690875.2556198.15786177395425033830.stgit@dwillia2-desk3.amr.corp.intel.com
    Reported-by: Christoph Hellwig <hch@lst.de>
    Signed-off-by: Dan Williams <dan.j.williams@intel.com>
    Signed-off-by: Jason Gunthorpe <jgg@mellanox.com>

commit f4df4e4042b045c6ddbaff878a17ae169fe68ba6
Author: YueHaibing <yuehaibing@huawei.com>
Date:   Thu Sep 5 14:44:00 2019 +0800

    ASoC: SOF: imx8: Fix COMPILE_TEST error
    
    When do compile test, if SND_SOC_SOF_OF is not set, we get:
    
    sound/soc/sof/imx/imx8.o: In function `imx8_dsp_handle_request':
    imx8.c:(.text+0xb0): undefined reference to `snd_sof_ipc_msgs_rx'
    sound/soc/sof/imx/imx8.o: In function `imx8_ipc_msg_data':
    imx8.c:(.text+0xf4): undefined reference to `sof_mailbox_read'
    sound/soc/sof/imx/imx8.o: In function `imx8_dsp_handle_reply':
    imx8.c:(.text+0x160): undefined reference to `sof_mailbox_read'
    
    Make SND_SOC_SOF_IMX_TOPLEVEL always depends on SND_SOC_SOF_OF
    
    Reported-by: Hulk Robot <hulkci@huawei.com>
    Fixes: 202acc565a1f ("ASoC: SOF: imx: Add i.MX8 HW support")
    Signed-off-by: YueHaibing <yuehaibing@huawei.com>
    Reviewed-by: Daniel Baluta <daniel.baluta@nxp.com>
    Reviewed-by: Pierre-Louis Bossart <pierre-louis.bossart@linux.intel.com>
    Link: https://lore.kernel.org/r/20190905064400.24800-1-yuehaibing@huawei.com
    Signed-off-by: Mark Brown <broonie@kernel.org>

commit 4a79ce748f318773464d786cf816dba759d22a49
Merge: 77fda29f9c48 6311b6521bcc
Author: Greg Kroah-Hartman <gregkh@linuxfoundation.org>
Date:   Tue Sep 3 21:47:37 2019 +0200

    Merge tag 'icc-5.4-rc1' of https://git.linaro.org/people/georgi.djakov/linux into char-misc-next
    
    Georgi writes:
    
    interconnect patches for 5.4
    
    Here are the interconnect driver updates for the 5.4-rc1 merge window.
    
    - New feature is the path tagging support that helps with grouping and
    aggregating the bandwidth requests into separate buckets based on a tag.
    - The first user of the path tagging is the Qualcomm sdm845 driver that
    now implements support for wake/sleep sets. This allows consumer drivers
    to express their bandwidth needs for the different CPU power states.
    - New interconnect driver for the qcs404 platforms and a driver that
    communicates bandwidth requests with remote processor over shared memory.
    - Cleanups and fixes.
    
    Signed-off-by: Georgi Djakov <georgi.djakov@linaro.org>
    
    * tag 'icc-5.4-rc1' of https://git.linaro.org/people/georgi.djakov/linux:
      drivers: qcom: Add BCM vote macro to header
      interconnect: qcom: remove COMPILE_TEST from CONFIG_INTERCONNECT_QCOM_QCS404
      interconnect: qcom: Add QCS404 interconnect provider driver
      interconnect: qcom: Add interconnect RPM over SMD driver
      dt-bindings: interconnect: Add Qualcomm QCS404 DT bindings
      interconnect: qcom: Add tagging and wake/sleep support for sdm845
      interconnect: Add pre_aggregate() callback
      interconnect: Add support for path tags

commit dd1bf47a84fe64edf50f6a83fdc164d0da6fa021
Author: Ryan M. Collins <rmc032@bucknell.edu>
Date:   Fri Aug 30 14:49:55 2019 -0400

    net: bcmgenet: use ethtool_op_get_ts_info()
    
    This change enables the use of SW timestamping on the Raspberry Pi 4.
    
    bcmgenet's transmit function bcmgenet_xmit() implements software
    timestamping. However the SOF_TIMESTAMPING_TX_SOFTWARE capability was
    missing and only SOF_TIMESTAMPING_RX_SOFTWARE was announced. By using
    ethtool_ops bcmgenet_ethtool_ops() as get_ts_info(), the
    SOF_TIMESTAMPING_TX_SOFTWARE capability is announced.
    
    Similar to commit a8f5cb9e7991 ("smsc95xx: use ethtool_op_get_ts_info()")
    
    Signed-off-by: Ryan M. Collins <rmc032@bucknell.edu>
    Acked-by: Florian Fainelli <f.fainelli@gmail.com>
    Acked-by: Doug Berger <opendmb@gmail.com>
    Signed-off-by: David S. Miller <davem@davemloft.net>

commit e8d6766f3cc8318e8fcaa5ef2d1af4d2d9903af3
Merge: 8fb8e9e46261 7a6c9dbb36a4
Author: Linus Torvalds <torvalds@linux-foundation.org>
Date:   Fri Aug 30 10:53:12 2019 -0700

    Merge tag 'armsoc-fixes' of git://git.kernel.org/pub/scm/linux/kernel/git/soc/soc
    
    Pull ARM SoC fixes from Arnd Bergmann:
     "The majority of the fixes this time are for OMAP hardware, here is a
      breakdown of the significant changes:
    
      Various device tree bug fixes:
       - TI am57xx boards need a voltage level fix to avoid damaging SD
         cards
       - vf610-bk4 fails to detect its flash due to an incorrect description
       - meson-g12a USB phy configuration fails
       - meson-g12b reboot should not power off the SD card
       - Some corrections for apparently harmless differences from the
         documentation.
    
      Regression fixes:
       - ams-delta FIQ interrupts broke in 5.3
       - TI am3/am4 mmc controllers broke in 5.2
    
      The logic_pio driver (used on some Huawei ARM servers) got a few bug
      fixes for reliability.
    
      And a couple of compile-time warning fixes"
    
    * tag 'armsoc-fixes' of git://git.kernel.org/pub/scm/linux/kernel/git/soc/soc: (26 commits)
      soc: ixp4xx: Protect IXP4xx SoC drivers by ARCH_IXP4XX || COMPILE_TEST
      soc: ti: pm33xx: Make two symbols static
      soc: ti: pm33xx: Fix static checker warnings
      ARM: OMAP: dma: Mark expected switch fall-throughs
      ARM: dts: Fix incomplete dts data for am3 and am4 mmc
      bus: ti-sysc: Simplify cleanup upon failures in sysc_probe()
      ARM: OMAP1: ams-delta-fiq: Fix missing irq_ack
      ARM: dts: dra74x: Fix iodelay configuration for mmc3
      ARM: dts: am335x: Fix UARTs length
      ARM: OMAP2+: Fix omap4 errata warning on other SoCs
      bus: hisi_lpc: Add .remove method to avoid driver unbind crash
      bus: hisi_lpc: Unregister logical PIO range to avoid potential use-after-free
      lib: logic_pio: Add logic_pio_unregister_range()
      lib: logic_pio: Avoid possible overlap for unregistering regions
      lib: logic_pio: Fix RCU usage
      arm64: dts: amlogic: odroid-n2: keep SD card regulator always on
      arm64: dts: meson-g12a-sei510: enable IR controller
      arm64: dts: meson-g12a: add missing dwc2 phy-names
      ARM: dts: vf610-bk4: Fix qspi node description
      ARM: dts: Fix incorrect dcan register mapping for am3, am4 and dra7
      ...

commit 7a6c9dbb36a415c5901313fc89871fd19f533656
Author: Geert Uytterhoeven <geert@linux-m68k.org>
Date:   Fri Aug 23 11:03:52 2019 +0200

    soc: ixp4xx: Protect IXP4xx SoC drivers by ARCH_IXP4XX || COMPILE_TEST
    
    The move of the IXP4xx SoC drivers exposed their config options on all
    platforms.
    
    Fix this by wrapping them inside an ARCH_IXP4XX or COMPILE_TEST block.
    
    Link: https://lore.kernel.org/r/20190823090352.12243-1-linus.walleij@linaro.org
    Fixes: fcf2d8978cd538a5 ("ARM: ixp4xx: Move NPE and QMGR to drivers/soc")
    Signed-off-by: Geert Uytterhoeven <geert@linux-m68k.org>
    Signed-off-by: Linus Walleij <linus.walleij@linaro.org>
    Signed-off-by: Arnd Bergmann <arnd@arndb.de>

commit e003f9af9b8dc110dd62b7eaa3a796fd81d4d256
Author: Rui Miguel Silva <rui.silva@linaro.org>
Date:   Wed Aug 28 13:48:25 2019 +0100

    staging: greybus: fix more header declarations
    
    More headers needed to be fixed when moving greybus out of staging and
    enabling the COMPILE_TEST option.
    
    Add forward declarations for the needed structures.
    
    Reported-by: kbuild test robot <lkp@intel.com>
    Signed-off-by: Rui Miguel Silva <rui.silva@linaro.org>
    Reviewed-by: Johan Hovold <johan@kernel.org>
    Link: https://lore.kernel.org/r/20190828124825.20800-1-rui.silva@linaro.org
    Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>

commit 5699ad0aaf1091824f22492a708478912c38c7d2
Author: Florian Fainelli <f.fainelli@gmail.com>
Date:   Tue May 14 10:38:15 2019 -0700

    firmware: bcm47xx_nvram: Allow COMPILE_TEST
    
    Allow building building the BCM47xx NVRAM and SPROM drivers using
    COMPILE_TEST.
    
    Signed-off-by: Florian Fainelli <f.fainelli@gmail.com>
    Signed-off-by: Paul Burton <paul.burton@mips.com>
    Cc: linux-mips@linux-mips.org
    Cc: joe@perches.com
    Cc: Rafa Miecki <zajec5@gmail.com>
    Cc: linux-mips@vger.kernel.org
    Cc: linux-kernel@vger.kernel.org

commit 47e6a8d6d8eae537ad4a513b0e206bf45e4523ba
Merge: a55aa89aab90 0ef7c7cce43f
Author: Rafael J. Wysocki <rafael.j.wysocki@intel.com>
Date:   Mon Aug 26 10:06:57 2019 +0200

    Merge tag 'pullreq201908' of ssh://gitolite.kernel.org/pub/scm/linux/kernel/git/mzx/devfreq
    
    Pull devfreq changes for v5.4 from MyungJoo Ham:
    
    "This series include:
    
    - Tegra driver fixes
    - new Tegra devices
    - Rockchip fixes
    - Exynos-bus fixes
    - Event: add "event type"
    - Passive: notifier updates"
    
    * tag 'pullreq201908' of ssh://gitolite.kernel.org/pub/scm/linux/kernel/git/mzx/devfreq: (27 commits)
      PM / devfreq: passive: Use non-devm notifiers
      PM / devfreq: exynos-bus: Convert to use dev_pm_opp_set_rate()
      PM / devfreq: exynos-bus: Correct clock enable sequence
      PM / devfreq: Correct devm_devfreq_remove_device() documentation
      PM / devfreq: events: extend events by type of counted data
      PM / devfreq: exynos-events: change matching code during probe
      PM / devfreq: tegra20: add COMMON_CLK dependency
      PM / devfreq: events: add Exynos PPMU new events
      PM / devfreq: Fix kernel oops on governor module load
      PM / devfreq: rk3399_dmc: Fix spelling typo
      PM / devfreq: Fix spelling typo
      PM / devfreq: Introduce driver for NVIDIA Tegra20
      PM / devfreq: tegra: Rename tegra-devfreq.c to tegra30-devfreq.c
      PM / devfreq: tegra: Enable COMPILE_TEST for the driver
      PM / devfreq: tegra: Support Tegra30
      PM / devfreq: tegra: Reconfigure hardware on governor's restart
      PM / devfreq: tegra: Move governor registration to driver's probe
      PM / devfreq: tegra: Mark ACTMON's governor as immutable
      PM / devfreq: tegra: Avoid inconsistency of current frequency value
      PM / devfreq: tegra: Clean up driver's probe / remove
      ...

commit 35f8dbc727212bc5a49b90961d98f9ef596e2072
Author: Dmitry Osipenko <digetx@gmail.com>
Date:   Thu May 2 02:38:13 2019 +0300

    PM / devfreq: tegra: Enable COMPILE_TEST for the driver
    
    The driver's compilation doesn't have any specific dependencies, hence
    the COMPILE_TEST option can be supported in Kconfig.
    
    Signed-off-by: Dmitry Osipenko <digetx@gmail.com>
    Reviewed-by: Chanwoo Choi <cw00.choi@samsung.com>
    Signed-off-by: MyungJoo Ham <myungjoo.ham@samsung.com>

commit 4e99276a6f7cf6cbf1d375e2da59c358ca0fd0a8
Author: Martin Blumenstingl <martin.blumenstingl@googlemail.com>
Date:   Sat Jul 27 14:04:14 2019 +0200

    phy: enable compile-testing for the Lantiq PHY drivers
    
    Unconditionally include the lantiq subdirectory in the phy Makefile.
    
    All drivers in there have their dependencies maintained. One of these
    (optional) dependencies is COMPILE_TEST, however this can only be
    evaluated when Kconfig scans the lantiq subdirectory.
    
    Signed-off-by: Martin Blumenstingl <martin.blumenstingl@googlemail.com>
    Signed-off-by: Kishon Vijay Abraham I <kishon@ti.com>

commit 8084499bd7d44b2c96658d788e329f3c232eb050
Author: YueHaibing <yuehaibing@huawei.com>
Date:   Tue Aug 13 09:56:02 2019 +0800

    irqchip/irq-ingenic-tcu: Fix COMPILE_TEST building
    
    While do COMPILE_TEST building, if GENERIC_IRQ_CHIP is
    not selected, it fails:
    
    drivers/irqchip/irq-ingenic-tcu.o: In function `ingenic_tcu_intc_cascade':
    irq-ingenic-tcu.c:(.text+0x13f): undefined reference to `irq_get_domain_generic_chip'
    drivers/irqchip/irq-ingenic-tcu.o: In function `ingenic_tcu_irq_init':
    irq-ingenic-tcu.c:(.init.text+0x97): undefined reference to `irq_generic_chip_ops'
    irq-ingenic-tcu.c:(.init.text+0xdd): undefined reference to `__irq_alloc_domain_generic_chips'
    irq-ingenic-tcu.c:(.init.text+0x10b): undefined reference to `irq_get_domain_generic_chip'
    
    select GENERIC_IRQ_CHIP to fix this.
    
    Reported-by: Hulk Robot <hulkci@huawei.com>
    Fixes: 9536eba03ec7 ("irqchip: Add irq-ingenic-tcu driver")
    Signed-off-by: YueHaibing <yuehaibing@huawei.com>
    Acked-by: Thomas Gleixner <tglx@linutronix.de>
    Signed-off-by: Paul Burton <paul.burton@mips.com>
    Cc: <jason@lakedaemon.net>
    Cc: <maz@kernel.org>
    Cc: <paul@crapouillou.net>
    Cc: <malat@debian.org>
    Cc: <linux-kernel@vger.kernel.org>
    Cc: <linux-mips@vger.kernel.org>
    Cc: <linux-clk@vger.kernel.org>

commit ffba29c9ebd0977dbf77bf6064776716a51b8ae5
Author: Arnd Bergmann <arnd@arndb.de>
Date:   Fri Aug 9 16:40:37 2019 +0200

    serial: lpc32xx: allow compile testing
    
    The lpc32xx_loopback_set() function in hte lpc32xx_hs driver is the
    one thing that relies on platform header files. Move that into the
    core platform code so we only need a variable declaration for it,
    and enable COMPILE_TEST building.
    
    Link: https://lore.kernel.org/r/20190809144043.476786-12-arnd@arndb.de
    Signed-off-by: Arnd Bergmann <arnd@arndb.de>
    Acked-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>
    Signed-off-by: Arnd Bergmann <arnd@arndb.de>

commit 5711e41b682ed4fc9b0803dc27722b1d8723a78a
Author: Arnd Bergmann <arnd@arndb.de>
Date:   Fri Aug 9 16:40:30 2019 +0200

    serial: lpc32xx_hs: allow compile-testing
    
    The only thing that prevents building this driver on other
    platforms is the mach/hardware.h include, which is not actually
    used here at all, so remove the line and allow CONFIG_COMPILE_TEST.
    
    Link: https://lore.kernel.org/r/20190809144043.476786-5-arnd@arndb.de
    Acked-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>
    Acked-by: Sylvain Lemieux <slemieux.tyco@gmail.com>
    Signed-off-by: Arnd Bergmann <arnd@arndb.de>

commit 0a453d527ba4ce393d8d8bc0b3f21d5df3d640bf
Author: Arnd Bergmann <arnd@arndb.de>
Date:   Fri Aug 9 16:40:29 2019 +0200

    watchdog: pnx4008_wdt: allow compile-testing
    
    The only thing that prevents building this driver on other
    platforms is the mach/hardware.h include, which is not actually
    used here at all, so remove the line and allow CONFIG_COMPILE_TEST.
    
    Link: https://lore.kernel.org/r/20190809144043.476786-4-arnd@arndb.de
    Acked-by: Sylvain Lemieux <slemieux.tyco@gmail.com>
    Reviewed-by: Guenter Roeck <linux@roeck-us.net>
    Signed-off-by: Arnd Bergmann <arnd@arndb.de>

commit 50ad15282e7c75269ab754f9460dd36ae784e181
Author: Arnd Bergmann <arnd@arndb.de>
Date:   Fri Aug 9 16:40:28 2019 +0200

    usb: udc: lpc32xx: allow compile-testing
    
    The only thing that prevents building this driver on other
    platforms is the mach/hardware.h include, which is not actually
    used here at all, so remove the line and allow CONFIG_COMPILE_TEST.
    
    Link: https://lore.kernel.org/r/20190809144043.476786-3-arnd@arndb.de
    Acked-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>
    Acked-by: Sylvain Lemieux <slemieux.tyco@gmail.com>
    Signed-off-by: Arnd Bergmann <arnd@arndb.de>

commit 34b5560db40d2941cfbe82eca1641353d5aed1a9
Author: Mark Rutland <mark.rutland@arm.com>
Date:   Wed Aug 14 15:31:57 2019 +0100

    kasan/arm64: fix CONFIG_KASAN_SW_TAGS && KASAN_INLINE
    
    The generic Makefile.kasan propagates CONFIG_KASAN_SHADOW_OFFSET into
    KASAN_SHADOW_OFFSET, but only does so for CONFIG_KASAN_GENERIC.
    
    Since commit:
    
      6bd1d0be0e97936d ("arm64: kasan: Switch to using KASAN_SHADOW_OFFSET")
    
    ... arm64 defines CONFIG_KASAN_SHADOW_OFFSET in Kconfig rather than
    defining KASAN_SHADOW_OFFSET in a Makefile. Thus, if
    CONFIG_KASAN_SW_TAGS && KASAN_INLINE are selected, we get build time
    splats due to KASAN_SHADOW_OFFSET not being set:
    
    | [mark@lakrids:~/src/linux]% usellvm 8.0.1 usekorg 8.1.0  make ARCH=arm64 CROSS_COMPILE=aarch64-linux- CC=clang
    | scripts/kconfig/conf  --syncconfig Kconfig
    |   CC      scripts/mod/empty.o
    | clang (LLVM option parsing): for the -hwasan-mapping-offset option: '' value invalid for uint argument!
    | scripts/Makefile.build:273: recipe for target 'scripts/mod/empty.o' failed
    | make[1]: *** [scripts/mod/empty.o] Error 1
    | Makefile:1123: recipe for target 'prepare0' failed
    | make: *** [prepare0] Error 2
    
    Let's fix this by always propagating CONFIG_KASAN_SHADOW_OFFSET into
    KASAN_SHADOW_OFFSET if CONFIG_KASAN is selected, moving the existing
    common definition of +CFLAGS_KASAN_NOSANITIZE to the top of
    Makefile.kasan.
    
    Cc: Catalin Marinas <catalin.marinas@arm.com>
    Signed-off-by: Mark Rutland <mark.rutland@arm.com>
    Acked-by: Andrey Ryabinin <aryabinin@virtuozzo.com>
    Tested-by Steve Capper <steve.capper@arm.com>
    Signed-off-by: Will Deacon <will@kernel.org>

commit dcc31687b8b9bf92aa1da1afbd7a91b1910f5512
Author: Mao Wenan <maowenan@huawei.com>
Date:   Thu Aug 15 15:48:48 2019 +0800

    interconnect: qcom: remove COMPILE_TEST from CONFIG_INTERCONNECT_QCOM_QCS404
    
    There is one compilation error when CONFIG_INTERCONNECT_QCOM_QCS404=y and
    CONFIG_INTERCONNECT_QCOM_SMD_RPM=y, as well as CONFIG_COMPILE_TEST=y,
    but CONFIG_QCOM_SMD_RPM is not set, logs as below:
    
    drivers/interconnect/qcom/smd-rpm.o: In function `qcom_icc_rpm_smd_send':
    smd-rpm.c:(.text+0xe4): undefined reference to `qcom_rpm_smd_write'
    Makefile:1071: recipe for target 'vmlinux' failed
    make: *** [vmlinux] Error 1
    
    This is because
    INTERCONNECT_QCOM_QCS404 depends on QCOM_SMD_RPM || COMPILE_TEST.
    Here CONFIG_COMPILE_TEST=y, so CONFIG_INTERCONNECT_QCOM_SMD_RPM
    is selected. If CONFIG_QCOM_SMD_RPM is not set, then
    qcom_rpm_smd_write() is not defined, and compilation error happen.
    Fix this by removing COMPILE_TEST from CONFIG_INTERCONNECT_QCOM_QCS404.
    
    Fixes: 5e4e6c4d3ae0 ("interconnect: qcom: Add QCS404 interconnect provider driver")
    Signed-off-by: Mao Wenan <maowenan@huawei.com>
    Signed-off-by: Georgi Djakov <georgi.djakov@linaro.org>

commit 98dc19902a0b2e5348e43d6a2c39a0a7d0fc639e
Author: Jeremy Linton <jeremy.linton@arm.com>
Date:   Thu Aug 8 15:40:07 2019 -0500

    arm64: topology: Use PPTT to determine if PE is a thread
    
    ACPI 6.3 adds a thread flag to represent if a CPU/PE is
    actually a thread. Given that the MPIDR_MT bit may not
    represent this information consistently on homogeneous machines
    we should prefer the PPTT flag if its available.
    
    Signed-off-by: Jeremy Linton <jeremy.linton@arm.com>
    Reviewed-by: Sudeep Holla <sudeep.holla@arm.com>
    Reviewed-by: Robert Richter <rrichter@marvell.com>
    [will: made acpi_cpu_is_threaded() return 'bool']
    Signed-off-by: Will Deacon <will@kernel.org>

commit ba630ea068d7cb593ae3bb7085846c5a137d10a6
Author: Suganath Prabu <suganath-prabu.subramani@broadcom.com>
Date:   Sat Aug 3 09:59:52 2019 -0400

    scsi: mpt3sas: Support MEMORY MOVE Tool box command
    
    Host uses the Memory Move Tool to copy data from any source/destination
    combination of system memory and IOC memory.
    
    Memory Move Tool box request contains two SGE fields, First SGE field must
    contains the source buffer details described by an MPI Simple SGE.  The
    second SGE field must contains the destination buffer details described by
    an MPI Simple SGE.
    
     Source   ->   Destination
    
    1. IOC    ->   IOC    (Both the SGE's will be filled by application)
    
    2. HOST   ->   HOST   (Both the SGE's will be filled by the host,
                   application should give sgl_offset to first SGE offset)
    
    3. IOC    ->   HOST   (Application will fill the first SGE and set the
                   sgl_offset to second SGE and hence driver fills
                   the second SGE)
    4. HOST   ->   IOC    (Application will fill IOC buffer information in the
                   first SGE and set the sgl_offset to second SGE.
                   Then driver will fill the second SGE with Host buffer
                   information and just before posting the command to the
                   firmware, driver will swap these two SGEs so that first
                   SGE contains the HOST buffer information and second SGE
                   contains the IOC information.
    
    Driver has to take care only of the 4th case, other three cases are by
    default supported by the current driver design.
    
    Signed-off-by: Suganath Prabu <suganath-prabu.subramani@broadcom.com>
    Signed-off-by: Martin K. Petersen <martin.petersen@oracle.com>

commit 5bb309dbbbf2157786004201eb70dafd283b54b5
Author: Suganath Prabu <suganath-prabu.subramani@broadcom.com>
Date:   Sat Aug 3 09:59:50 2019 -0400

    scsi: mpt3sas: Enumerate SES of a managed PCIe switch
    
    SES device of managed PCIe switch will be enumerated same as NVMe drives.
    
    The device info type for this SES device is
    
            MPI26_PCIE_DEVINFO_SCSI (0x4),
    
    whereas the device info type for NVMe drives is
    
            MPI26_PCIE_DEVINFO_NVME (0x3).
    
    Based on this device info type driver determines whether the device is NVMe
    drive or a SES device of a managed PCIe switch.
    
    This SES device doesn't have the PCIe device page 2 information like NVMe
    drives, so driver won't read PCIe device page 2 information for SES device.
    
    This SES device uses only IEEE SGL's, So driver build's IEEE SGL's whenever
    it receives any SCSI commands for this SES device.
    
    Signed-off-by: Suganath Prabu <suganath-prabu.subramani@broadcom.com>
    Signed-off-by: Martin K. Petersen <martin.petersen@oracle.com>

commit 635ee6c73034ea4488a8e26bb0d0291d83146863
Author: Suganath Prabu <suganath-prabu.subramani@broadcom.com>
Date:   Sat Aug 3 09:59:49 2019 -0400

    scsi: mpt3sas: Update MPI headers to 2.6.8 spec
    
    Updated MPI to 2.6.8 specification and header files to 2.00.54.
    
    Signed-off-by: Suganath Prabu <suganath-prabu.subramani@broadcom.com>
    Signed-off-by: Martin K. Petersen <martin.petersen@oracle.com>

commit 6898dd580a045341f844862ceb775144156ec1af
Author: Randy Dunlap <rdunlap@infradead.org>
Date:   Tue Aug 6 19:01:36 2019 -0300

    media: media/platform: fsl-viu.c: fix build for MICROBLAZE
    
    arch/microblaze/ defines out_be32() and in_be32(), so don't do that
    again in the driver source.
    
    Fixes these build warnings:
    
    ../drivers/media/platform/fsl-viu.c:36: warning: "out_be32" redefined
    ../arch/microblaze/include/asm/io.h:50: note: this is the location of the previous definition
    ../drivers/media/platform/fsl-viu.c:37: warning: "in_be32" redefined
    ../arch/microblaze/include/asm/io.h:53: note: this is the location of the previous definition
    
    Fixes: 29d750686331 ("media: fsl-viu: allow building it with COMPILE_TEST")
    Signed-off-by: Randy Dunlap <rdunlap@infradead.org>
    Signed-off-by: Hans Verkuil <hverkuil-cisco@xs4all.nl>
    Signed-off-by: Mauro Carvalho Chehab <mchehab+samsung@kernel.org>

commit 6b2265975239ab655069d796b822835a593e1cc7
Author: YueHaibing <yuehaibing@huawei.com>
Date:   Wed Jul 24 23:41:29 2019 -0300

    media: staging: tegra-vde: Fix build error
    
    If IOMMU_SUPPORT is not set, and COMPILE_TEST is y,
    IOMMU_IOVA may be set to m. So building will fails:
    
    drivers/staging/media/tegra-vde/iommu.o: In function `tegra_vde_iommu_map':
    iommu.c:(.text+0x41): undefined reference to `alloc_iova'
    iommu.c:(.text+0x56): undefined reference to `__free_iova'
    
    Select IOMMU_IOVA while COMPILE_TEST is set to fix this.
    
    Reported-by: Hulk Robot <hulkci@huawei.com>
    Suggested-by: Dmitry Osipenko <digetx@gmail.com>
    Fixes: b301f8de1925 ("media: staging: media: tegra-vde: Add IOMMU support")
    Signed-off-by: YueHaibing <yuehaibing@huawei.com>
    Acked-by: Dmitry Osipenko <digetx@gmail.com>
    Signed-off-by: Hans Verkuil <hverkuil-cisco@xs4all.nl>
    Signed-off-by: Mauro Carvalho Chehab <mchehab+samsung@kernel.org>

commit 71c67a31f09fa8fdd1495dffd96a5f0d4cef2ede
Author: Will Deacon <will@kernel.org>
Date:   Wed Aug 7 12:48:33 2019 +0100

    init/Kconfig: Fix infinite Kconfig recursion on PPC
    
    Commit 5cf896fb6be3 ("arm64: Add support for relocating the kernel with
    RELR relocations") introduced CONFIG_TOOLS_SUPPORT_RELR, which checks
    for RELR support in the toolchain as part of the kernel configuration.
    During this procedure, "$(NM)" is invoked to see if it supports the new
    relocation format, however PowerPC conditionally overrides this variable
    in the architecture Makefile in order to pass '--synthetic' when
    targetting PPC64.
    
    This conditional override causes Kconfig to recurse forever, since
    CONFIG_TOOLS_SUPPORT_RELR cannot be determined without $(NM) being
    defined, but that in turn depends on CONFIG_PPC64:
    
      $ make ARCH=powerpc CROSS_COMPILE=powerpc-linux-gnu-
      scripts/kconfig/conf  --syncconfig Kconfig
      scripts/kconfig/conf  --syncconfig Kconfig
      scripts/kconfig/conf  --syncconfig Kconfig
      [...]
    
    In this particular case, it looks like PowerPC may be able to pass
    '--synthetic' unconditionally to nm or even drop it altogether. While
    that is being resolved, let's just bodge the RELR check by picking up
    $(NM) directly from the environment in whatever state it happens to be
    in.
    
    Cc: Peter Collingbourne <pcc@google.com>
    Reported-by: Stephen Rothwell <sfr@canb.auug.org.au>
    Suggested-by: Masahiro Yamada <yamada.masahiro@socionext.com>
    Signed-off-by: Will Deacon <will@kernel.org>

commit b8fb640643fcdb3bca84137c4cec0c649b25e056
Author: Nathan Chancellor <natechancellor@gmail.com>
Date:   Fri Aug 2 23:01:56 2019 -0700

    net: mdio-octeon: Fix Kconfig warnings and build errors
    
    After commit 171a9bae68c7 ("staging/octeon: Allow test build on
    !MIPS"), the following combination of configs cause a few Kconfig
    warnings and build errors (distilled from arm allyesconfig and Randy's
    randconfig builds):
    
        CONFIG_NETDEVICES=y
        CONFIG_STAGING=y
        CONFIG_COMPILE_TEST=y
    
    and CONFIG_OCTEON_ETHERNET as either a module or built-in.
    
    WARNING: unmet direct dependencies detected for MDIO_OCTEON
      Depends on [n]: NETDEVICES [=y] && MDIO_DEVICE [=y] && MDIO_BUS [=y]
    && 64BIT [=n] && HAS_IOMEM [=y] && OF_MDIO [=n]
      Selected by [y]:
      - OCTEON_ETHERNET [=y] && STAGING [=y] && (CAVIUM_OCTEON_SOC ||
    COMPILE_TEST [=y]) && NETDEVICES [=y]
    
    In file included from ../drivers/net/phy/mdio-octeon.c:14:
    ../drivers/net/phy/mdio-cavium.h:111:36: error: implicit declaration of
    function writeq; did you mean writel?
    [-Werror=implicit-function-declaration]
      111 | #define oct_mdio_writeq(val, addr) writeq(val, (void *)addr)
          |                                    ^~~~~~
    
    CONFIG_64BIT is not strictly necessary if the proper readq/writeq
    definitions are included from io-64-nonatomic-lo-hi.h.
    
    CONFIG_OF_MDIO is not needed when CONFIG_COMPILE_TEST is enabled because
    of commit f9dc9ac51610 ("of/mdio: Add dummy functions in of_mdio.h.").
    
    Fixes: 171a9bae68c7 ("staging/octeon: Allow test build on !MIPS")
    Reported-by: kbuild test robot <lkp@intel.com>
    Reported-by: Mark Brown <broonie@kernel.org>
    Reported-by: Randy Dunlap <rdunlap@infradead.org>
    Signed-off-by: Nathan Chancellor <natechancellor@gmail.com>
    Acked-by: Randy Dunlap <rdunlap@infradead.org> # build-tested
    Signed-off-by: David S. Miller <davem@davemloft.net>

commit 57134d56a30d0550795283be1aa9236580d1dd04
Author: Masahiro Yamada <yamada.masahiro@socionext.com>
Date:   Mon Jul 29 18:15:17 2019 +0900

    kbuild: initialize CLANG_FLAGS correctly in the top Makefile
    
    commit 5241ab4cf42d3a93b933b55d3d53f43049081fa1 upstream.
    
    CLANG_FLAGS is initialized by the following line:
    
      CLANG_FLAGS     := --target=$(notdir $(CROSS_COMPILE:%-=%))
    
    ..., which is run only when CROSS_COMPILE is set.
    
    Some build targets (bindeb-pkg etc.) recurse to the top Makefile.
    
    When you build the kernel with Clang but without CROSS_COMPILE,
    the same compiler flags such as -no-integrated-as are accumulated
    into CLANG_FLAGS.
    
    If you run 'make CC=clang' and then 'make CC=clang bindeb-pkg',
    Kbuild will recompile everything needlessly due to the build command
    change.
    
    Fix this by correctly initializing CLANG_FLAGS.
    
    Fixes: 238bcbc4e07f ("kbuild: consolidate Clang compiler flags")
    Cc: <stable@vger.kernel.org> # v5.0+
    Signed-off-by: Masahiro Yamada <yamada.masahiro@socionext.com>
    Reviewed-by: Nathan Chancellor <natechancellor@gmail.com>
    Acked-by: Nick Desaulniers <ndesaulniers@google.com>
    Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>

commit 4c5a442561e86933b656b5357da43c5967f5c91f
Author: Masahiro Yamada <yamada.masahiro@socionext.com>
Date:   Mon Jul 29 18:15:17 2019 +0900

    kbuild: initialize CLANG_FLAGS correctly in the top Makefile
    
    commit 5241ab4cf42d3a93b933b55d3d53f43049081fa1 upstream.
    
    CLANG_FLAGS is initialized by the following line:
    
      CLANG_FLAGS     := --target=$(notdir $(CROSS_COMPILE:%-=%))
    
    ..., which is run only when CROSS_COMPILE is set.
    
    Some build targets (bindeb-pkg etc.) recurse to the top Makefile.
    
    When you build the kernel with Clang but without CROSS_COMPILE,
    the same compiler flags such as -no-integrated-as are accumulated
    into CLANG_FLAGS.
    
    If you run 'make CC=clang' and then 'make CC=clang bindeb-pkg',
    Kbuild will recompile everything needlessly due to the build command
    change.
    
    Fix this by correctly initializing CLANG_FLAGS.
    
    Fixes: 238bcbc4e07f ("kbuild: consolidate Clang compiler flags")
    Cc: <stable@vger.kernel.org> # v5.0+
    Signed-off-by: Masahiro Yamada <yamada.masahiro@socionext.com>
    Reviewed-by: Nathan Chancellor <natechancellor@gmail.com>
    Acked-by: Nick Desaulniers <ndesaulniers@google.com>
    Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>

commit 3e1332cfb41ccb47134d20e08ce999474d4e1f38
Author: Masahiro Yamada <yamada.masahiro@socionext.com>
Date:   Mon Jul 29 18:15:17 2019 +0900

    kbuild: initialize CLANG_FLAGS correctly in the top Makefile
    
    commit 5241ab4cf42d3a93b933b55d3d53f43049081fa1 upstream.
    
    CLANG_FLAGS is initialized by the following line:
    
      CLANG_FLAGS     := --target=$(notdir $(CROSS_COMPILE:%-=%))
    
    ..., which is run only when CROSS_COMPILE is set.
    
    Some build targets (bindeb-pkg etc.) recurse to the top Makefile.
    
    When you build the kernel with Clang but without CROSS_COMPILE,
    the same compiler flags such as -no-integrated-as are accumulated
    into CLANG_FLAGS.
    
    If you run 'make CC=clang' and then 'make CC=clang bindeb-pkg',
    Kbuild will recompile everything needlessly due to the build command
    change.
    
    Fix this by correctly initializing CLANG_FLAGS.
    
    Fixes: 238bcbc4e07f ("kbuild: consolidate Clang compiler flags")
    Cc: <stable@vger.kernel.org> # v5.0+
    Signed-off-by: Masahiro Yamada <yamada.masahiro@socionext.com>
    Reviewed-by: Nathan Chancellor <natechancellor@gmail.com>
    Acked-by: Nick Desaulniers <ndesaulniers@google.com>
    Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>

commit 757ee02703cda68a0f1d56746e5c0292e975c319
Author: Masahiro Yamada <yamada.masahiro@socionext.com>
Date:   Mon Jul 29 18:15:17 2019 +0900

    kbuild: initialize CLANG_FLAGS correctly in the top Makefile
    
    commit 5241ab4cf42d3a93b933b55d3d53f43049081fa1 upstream.
    
    CLANG_FLAGS is initialized by the following line:
    
      CLANG_FLAGS     := --target=$(notdir $(CROSS_COMPILE:%-=%))
    
    ..., which is run only when CROSS_COMPILE is set.
    
    Some build targets (bindeb-pkg etc.) recurse to the top Makefile.
    
    When you build the kernel with Clang but without CROSS_COMPILE,
    the same compiler flags such as -no-integrated-as are accumulated
    into CLANG_FLAGS.
    
    If you run 'make CC=clang' and then 'make CC=clang bindeb-pkg',
    Kbuild will recompile everything needlessly due to the build command
    change.
    
    Fix this by correctly initializing CLANG_FLAGS.
    
    Fixes: 238bcbc4e07f ("kbuild: consolidate Clang compiler flags")
    Cc: <stable@vger.kernel.org> # v5.0+
    Signed-off-by: Masahiro Yamada <yamada.masahiro@socionext.com>
    Reviewed-by: Nathan Chancellor <natechancellor@gmail.com>
    Acked-by: Nick Desaulniers <ndesaulniers@google.com>
    Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>

commit 2d75989d2d92b71f3f34f2704ac109897a87319f
Author: Vignesh Raghavendra <vigneshr@ti.com>
Date:   Fri Jul 19 13:59:12 2019 +0530

    mtd: hyperbus: Kconfig: Fix HBMC_AM654 dependencies
    
    On x86_64, when CONFIG_OF is not disabled:
    
    WARNING: unmet direct dependencies detected for MUX_MMIO
      Depends on [n]: MULTIPLEXER [=y] && (OF [=n] || COMPILE_TEST [=n])
      Selected by [y]:
      - HBMC_AM654 [=y] && MTD [=y] && MTD_HYPERBUS [=y]
    
    due to
    config HBMC_AM654
            tristate "HyperBus controller driver for AM65x SoC"
            select MULTIPLEXER
            select MUX_MMIO
    
    Fix this by making HBMC_AM654 imply MUX_MMIO instead of select so
    that dependencies are taken care of. MUX_MMIO is optional for
    functioning of driver.
    
    Fixes: b07079f1642c ("mtd: hyperbus: Add driver for TI's HyperBus memory controller")
    Reported-by: Randy Dunlap <rdunlap@infradead.org>
    Signed-off-by: Vignesh Raghavendra <vigneshr@ti.com>
    Acked-by: Randy Dunlap <rdunlap@infradead.org> # build-tested
    Signed-off-by: Miquel Raynal <miquel.raynal@bootlin.com>

commit a507f25d1c2048c136f6834f10966510b62af987
Merge: 9100fc5ae83e d8bb6718c4db
Author: Linus Torvalds <torvalds@linux-foundation.org>
Date:   Fri Aug 2 15:23:27 2019 -0700

    Merge tag 'arm64-fixes' of git://git.kernel.org/pub/scm/linux/kernel/git/arm64/linux
    
    Pull arm64 fixes from Catalin Marinas:
    
     - Update the compat layer to allow single-byte watchpoints on all
       addresses (similar to the native support)
    
     - arm_pmu: fix the restoration of the counters on the
       CPU_PM_ENTER_FAILED path
    
     - Fix build regression with vDSO and Makefile not stripping
       CROSS_COMPILE_COMPAT
    
     - Fix the CTR_EL0 (cache type register) sanitisation on heterogeneous
       machines (e.g. big.LITTLE)
    
     - Fix the interrupt controller priority mask value when pseudo-NMIs are
       enabled
    
     - arm64 kprobes fixes: recovering of the PSTATE.D flag in the
       single-step exception handler, NOKPROBE annotations for
       unwind_frame() and walk_stackframe(), remove unneeded
       rcu_read_lock/unlock from debug handlers
    
     - Several gcc fall-through warnings
    
     - Unused variable warnings
    
    * tag 'arm64-fixes' of git://git.kernel.org/pub/scm/linux/kernel/git/arm64/linux:
      arm64: Make debug exception handlers visible from RCU
      arm64: kprobes: Recover pstate.D in single-step exception handler
      arm64/mm: fix variable 'tag' set but not used
      arm64/mm: fix variable 'pud' set but not used
      arm64: Remove unneeded rcu_read_lock from debug handlers
      arm64: unwind: Prohibit probing on return_address()
      arm64: Lower priority mask for GIC_PRIO_IRQON
      arm64/efi: fix variable 'si' set but not used
      arm64: cpufeature: Fix feature comparison for CTR_EL0.{CWG,ERG}
      arm64: vdso: Fix Makefile regression
      arm64: module: Mark expected switch fall-through
      arm64: smp: Mark expected switch fall-through
      arm64: hw_breakpoint: Fix warnings about implicit fallthrough
      drivers/perf: arm_pmu: Fix failure path in PM notifier
      arm64: compat: Allow single-byte watchpoints on all addresses

commit a22c5cf5d37ddcd4d2dd98ee9cf04fa5dd1e1c01
Author: Vincenzo Frascino <vincenzo.frascino@arm.com>
Date:   Mon Jul 29 13:54:21 2019 +0100

    arm64: vdso: Fix Makefile regression
    
    Using an old .config in combination with "make oldconfig" can cause
    an incorrect detection of the compat compiler:
    
    $ grep CROSS_COMPILE_COMPAT .config
    CONFIG_CROSS_COMPILE_COMPAT_VDSO=""
    
    $ make oldconfig && make
    arch/arm64/Makefile:58: gcc not found, check CROSS_COMPILE_COMPAT.
    Stop.
    
    Accordingly to the section 7.2 of the GNU Make manual "Syntax of
    Conditionals", "When the value results from complex expansions of
    variables and functions, expansions you would consider empty may
    actually contain whitespace characters and thus are not seen as
    empty. However, you can use the strip function to avoid interpreting
    whitespace as a non-empty value."
    
    Fix the issue adding strip to the CROSS_COMPILE_COMPAT string
    evaluation.
    
    Reported-by: Matteo Croce <mcroce@redhat.com>
    Tested-by: Matteo Croce <mcroce@redhat.com>
    Acked-by: Will Deacon <will@kernel.org>
    Signed-off-by: Vincenzo Frascino <vincenzo.frascino@arm.com>
    Signed-off-by: Catalin Marinas <catalin.marinas@arm.com>

commit 6a7ce95d752efa86a1a383385d4f8035c224dc3d
Author: YueHaibing <yuehaibing@huawei.com>
Date:   Wed Jul 31 18:02:19 2019 +0200

    staging/octeon: Fix build error without CONFIG_NETDEVICES
    
    While do COMPILE_TEST build without CONFIG_NETDEVICES,
    we get Kconfig warning:
    
    WARNING: unmet direct dependencies detected for PHYLIB
      Depends on [n]: NETDEVICES [=n]
      Selected by [y]:
      - OCTEON_ETHERNET [=y] && STAGING [=y] && (CAVIUM_OCTEON_SOC && NETDEVICES [=n] || COMPILE_TEST [=y])
    
    Reported-by: Hulk Robot <hulkci@huawei.com>
    Reported-by: Mark Brown <broonie@kernel.org>
    Fixes: 171a9bae68c7 ("staging/octeon: Allow test build on !MIPS")
    Signed-off-by: YueHaibing <yuehaibing@huawei.com>
    Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>
    Signed-off-by: David S. Miller <davem@davemloft.net>

commit e8bbd6178866ea21cffc2eddb2a0de3159ffba26
Author: Arnd Bergmann <arnd@arndb.de>
Date:   Mon Jul 22 13:41:20 2019 +0200

    structleak: disable STRUCTLEAK_BYREF in combination with KASAN_STACK
    
    commit 173e6ee21e2b3f477f07548a79c43b8d9cfbb37d upstream.
    
    The combination of KASAN_STACK and GCC_PLUGIN_STRUCTLEAK_BYREF
    leads to much larger kernel stack usage, as seen from the warnings
    about functions that now exceed the 2048 byte limit:
    
    drivers/media/i2c/tvp5150.c:253:1: error: the frame size of 3936 bytes is larger than 2048 bytes
    drivers/media/tuners/r820t.c:1327:1: error: the frame size of 2816 bytes is larger than 2048 bytes
    drivers/net/wireless/broadcom/brcm80211/brcmsmac/phy/phy_n.c:16552:1: error: the frame size of 3144 bytes is larger than 2048 bytes [-Werror=frame-larger-than=]
    fs/ocfs2/aops.c:1892:1: error: the frame size of 2088 bytes is larger than 2048 bytes
    fs/ocfs2/dlm/dlmrecovery.c:737:1: error: the frame size of 2088 bytes is larger than 2048 bytes
    fs/ocfs2/namei.c:1677:1: error: the frame size of 2584 bytes is larger than 2048 bytes
    fs/ocfs2/super.c:1186:1: error: the frame size of 2640 bytes is larger than 2048 bytes
    fs/ocfs2/xattr.c:3678:1: error: the frame size of 2176 bytes is larger than 2048 bytes
    net/bluetooth/l2cap_core.c:7056:1: error: the frame size of 2144 bytes is larger than 2048 bytes [-Werror=frame-larger-than=]
    net/bluetooth/l2cap_core.c: In function 'l2cap_recv_frame':
    net/bridge/br_netlink.c:1505:1: error: the frame size of 2448 bytes is larger than 2048 bytes
    net/ieee802154/nl802154.c:548:1: error: the frame size of 2232 bytes is larger than 2048 bytes
    net/wireless/nl80211.c:1726:1: error: the frame size of 2224 bytes is larger than 2048 bytes
    net/wireless/nl80211.c:2357:1: error: the frame size of 4584 bytes is larger than 2048 bytes
    net/wireless/nl80211.c:5108:1: error: the frame size of 2760 bytes is larger than 2048 bytes
    net/wireless/nl80211.c:6472:1: error: the frame size of 2112 bytes is larger than 2048 bytes
    
    The structleak plugin was previously disabled for CONFIG_COMPILE_TEST,
    but meant we missed some bugs, so this time we should address them.
    
    The frame size warnings are distracting, and risking a kernel stack
    overflow is generally not beneficial to performance, so it may be best
    to disallow that particular combination. This can be done by turning
    off either one. I picked the dependency in GCC_PLUGIN_STRUCTLEAK_BYREF
    and GCC_PLUGIN_STRUCTLEAK_BYREF_ALL, as this option is designed to
    make uninitialized stack usage less harmful when enabled on its own,
    but it also prevents KASAN from detecting those cases in which it was
    in fact needed.
    
    KASAN_STACK is currently implied by KASAN on gcc, but could be made a
    user selectable option if we want to allow combining (non-stack) KASAN
    with GCC_PLUGIN_STRUCTLEAK_BYREF.
    
    Note that it would be possible to specifically address the files that
    print the warning, but presumably the overall stack usage is still
    significantly higher than in other configurations, so this would not
    address the full problem.
    
    I could not test this with CONFIG_INIT_STACK_ALL, which may or may not
    suffer from a similar problem.
    
    Fixes: 81a56f6dcd20 ("gcc-plugins: structleak: Generalize to all variable types")
    Signed-off-by: Arnd Bergmann <arnd@arndb.de>
    Link: https://lore.kernel.org/r/20190722114134.3123901-1-arnd@arndb.de
    Signed-off-by: Kees Cook <keescook@chromium.org>
    Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>

commit 8f55c307ab577af74efab066ba1e45b0e51e4bae
Author: Minwoo Im <minwoo.im@samsung.com>
Date:   Sun Jul 28 03:53:37 2019 +0900

    scsi: mpt3sas: support target smid for [abort|query] task
    
    We can request task management IOCTL command(MPI2_FUNCTION_SCSI_TASK_MGMT)
    to /dev/mpt3ctl.  If the given task_type is either abort task or query
    task, it may need a field named "Initiator Port Transfer Tag to Manage" in
    the IU.
    
    Current code does not support to check target IPTT tag from the tm_request.
    This patch introduces to check TaskMID given from the userspace as a target
    tag.  We have a rule of relationship between
    (struct request *req->tag) and smid in mpt3sas_base.c:
    
    3318 u16
    3319 mpt3sas_base_get_smid_scsiio(struct MPT3SAS_ADAPTER *ioc, u8 cb_idx,
    3320         struct scsi_cmnd *scmd)
    3321 {
    3322         struct scsiio_tracker *request = scsi_cmd_priv(scmd);
    3323         unsigned int tag = scmd->request->tag;
    3324         u16 smid;
    3325
    3326         smid = tag + 1;
    
    So if we want to abort a request tagged #X, then we can pass (X + 1) to
    this IOCTL handler.  Otherwise, user space just can pass 0 TaskMID to abort
    the first outstanding smid which is legacy behaviour.
    
    Cc: Sreekanth Reddy <sreekanth.reddy@broadcom.com>
    Cc: Suganath Prabu Subramani <suganath-prabu.subramani@broadcom.com>
    Cc: Sathya Prakash <sathya.prakash@broadcom.com>
    Cc: James E.J. Bottomley <jejb@linux.ibm.com>
    Cc: Martin K. Petersen <martin.petersen@oracle.com>
    Cc: MPT-FusionLinux.pdl@broadcom.com
    Signed-off-by: Minwoo Im <minwoo.im@samsung.com>
    Acked-by: Sreekanth Reddy <sreekanth.reddy@broadcom.com>
    Signed-off-by: Minwoo Im <minwoo.im.dev@gmail.com>
    Signed-off-by: Martin K. Petersen <martin.petersen@oracle.com>

commit 5241ab4cf42d3a93b933b55d3d53f43049081fa1
Author: Masahiro Yamada <yamada.masahiro@socionext.com>
Date:   Mon Jul 29 18:15:17 2019 +0900

    kbuild: initialize CLANG_FLAGS correctly in the top Makefile
    
    CLANG_FLAGS is initialized by the following line:
    
      CLANG_FLAGS     := --target=$(notdir $(CROSS_COMPILE:%-=%))
    
    ..., which is run only when CROSS_COMPILE is set.
    
    Some build targets (bindeb-pkg etc.) recurse to the top Makefile.
    
    When you build the kernel with Clang but without CROSS_COMPILE,
    the same compiler flags such as -no-integrated-as are accumulated
    into CLANG_FLAGS.
    
    If you run 'make CC=clang' and then 'make CC=clang bindeb-pkg',
    Kbuild will recompile everything needlessly due to the build command
    change.
    
    Fix this by correctly initializing CLANG_FLAGS.
    
    Fixes: 238bcbc4e07f ("kbuild: consolidate Clang compiler flags")
    Cc: <stable@vger.kernel.org> # v5.0+
    Signed-off-by: Masahiro Yamada <yamada.masahiro@socionext.com>
    Reviewed-by: Nathan Chancellor <natechancellor@gmail.com>
    Acked-by: Nick Desaulniers <ndesaulniers@google.com>

commit 036184af23e07272482e224d5c4643c80760d78f
Author: Vedang Patel <vedang.patel@intel.com>
Date:   Tue Jun 25 15:07:12 2019 -0700

    igb: clear out skb->tstamp after reading the txtime
    
    [ Upstream commit 1e08511d5d01884a3c9070afd52a47799312074a ]
    
    If a packet which is utilizing the launchtime feature (via SO_TXTIME socket
    option) also requests the hardware transmit timestamp, the hardware
    timestamp is not delivered to the userspace. This is because the value in
    skb->tstamp is mistaken as the software timestamp.
    
    Applications, like ptp4l, request a hardware timestamp by setting the
    SOF_TIMESTAMPING_TX_HARDWARE socket option. Whenever a new timestamp is
    detected by the driver (this work is done in igb_ptp_tx_work() which calls
    igb_ptp_tx_hwtstamps() in igb_ptp.c[1]), it will queue the timestamp in the
    ERR_QUEUE for the userspace to read. When the userspace is ready, it will
    issue a recvmsg() call to collect this timestamp.  The problem is in this
    recvmsg() call. If the skb->tstamp is not cleared out, it will be
    interpreted as a software timestamp and the hardware tx timestamp will not
    be successfully sent to the userspace. Look at skb_is_swtx_tstamp() and the
    callee function __sock_recv_timestamp() in net/socket.c for more details.
    
    Signed-off-by: Vedang Patel <vedang.patel@intel.com>
    Tested-by: Aaron Brown <aaron.f.brown@intel.com>
    Signed-off-by: David S. Miller <davem@davemloft.net>
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit d7924e6fc36f2fe4b0d47f20c2699ff538f1f696
Author: Vedang Patel <vedang.patel@intel.com>
Date:   Tue Jun 25 15:07:12 2019 -0700

    igb: clear out skb->tstamp after reading the txtime
    
    [ Upstream commit 1e08511d5d01884a3c9070afd52a47799312074a ]
    
    If a packet which is utilizing the launchtime feature (via SO_TXTIME socket
    option) also requests the hardware transmit timestamp, the hardware
    timestamp is not delivered to the userspace. This is because the value in
    skb->tstamp is mistaken as the software timestamp.
    
    Applications, like ptp4l, request a hardware timestamp by setting the
    SOF_TIMESTAMPING_TX_HARDWARE socket option. Whenever a new timestamp is
    detected by the driver (this work is done in igb_ptp_tx_work() which calls
    igb_ptp_tx_hwtstamps() in igb_ptp.c[1]), it will queue the timestamp in the
    ERR_QUEUE for the userspace to read. When the userspace is ready, it will
    issue a recvmsg() call to collect this timestamp.  The problem is in this
    recvmsg() call. If the skb->tstamp is not cleared out, it will be
    interpreted as a software timestamp and the hardware tx timestamp will not
    be successfully sent to the userspace. Look at skb_is_swtx_tstamp() and the
    callee function __sock_recv_timestamp() in net/socket.c for more details.
    
    Signed-off-by: Vedang Patel <vedang.patel@intel.com>
    Tested-by: Aaron Brown <aaron.f.brown@intel.com>
    Signed-off-by: David S. Miller <davem@davemloft.net>
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit ee0725334e604ce88e76b97868652973439e4694
Author: Vedang Patel <vedang.patel@intel.com>
Date:   Tue Jun 25 15:07:12 2019 -0700

    igb: clear out skb->tstamp after reading the txtime
    
    [ Upstream commit 1e08511d5d01884a3c9070afd52a47799312074a ]
    
    If a packet which is utilizing the launchtime feature (via SO_TXTIME socket
    option) also requests the hardware transmit timestamp, the hardware
    timestamp is not delivered to the userspace. This is because the value in
    skb->tstamp is mistaken as the software timestamp.
    
    Applications, like ptp4l, request a hardware timestamp by setting the
    SOF_TIMESTAMPING_TX_HARDWARE socket option. Whenever a new timestamp is
    detected by the driver (this work is done in igb_ptp_tx_work() which calls
    igb_ptp_tx_hwtstamps() in igb_ptp.c[1]), it will queue the timestamp in the
    ERR_QUEUE for the userspace to read. When the userspace is ready, it will
    issue a recvmsg() call to collect this timestamp.  The problem is in this
    recvmsg() call. If the skb->tstamp is not cleared out, it will be
    interpreted as a software timestamp and the hardware tx timestamp will not
    be successfully sent to the userspace. Look at skb_is_swtx_tstamp() and the
    callee function __sock_recv_timestamp() in net/socket.c for more details.
    
    Signed-off-by: Vedang Patel <vedang.patel@intel.com>
    Tested-by: Aaron Brown <aaron.f.brown@intel.com>
    Signed-off-by: David S. Miller <davem@davemloft.net>
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit 173e6ee21e2b3f477f07548a79c43b8d9cfbb37d
Author: Arnd Bergmann <arnd@arndb.de>
Date:   Mon Jul 22 13:41:20 2019 +0200

    structleak: disable STRUCTLEAK_BYREF in combination with KASAN_STACK
    
    The combination of KASAN_STACK and GCC_PLUGIN_STRUCTLEAK_BYREF
    leads to much larger kernel stack usage, as seen from the warnings
    about functions that now exceed the 2048 byte limit:
    
    drivers/media/i2c/tvp5150.c:253:1: error: the frame size of 3936 bytes is larger than 2048 bytes
    drivers/media/tuners/r820t.c:1327:1: error: the frame size of 2816 bytes is larger than 2048 bytes
    drivers/net/wireless/broadcom/brcm80211/brcmsmac/phy/phy_n.c:16552:1: error: the frame size of 3144 bytes is larger than 2048 bytes [-Werror=frame-larger-than=]
    fs/ocfs2/aops.c:1892:1: error: the frame size of 2088 bytes is larger than 2048 bytes
    fs/ocfs2/dlm/dlmrecovery.c:737:1: error: the frame size of 2088 bytes is larger than 2048 bytes
    fs/ocfs2/namei.c:1677:1: error: the frame size of 2584 bytes is larger than 2048 bytes
    fs/ocfs2/super.c:1186:1: error: the frame size of 2640 bytes is larger than 2048 bytes
    fs/ocfs2/xattr.c:3678:1: error: the frame size of 2176 bytes is larger than 2048 bytes
    net/bluetooth/l2cap_core.c:7056:1: error: the frame size of 2144 bytes is larger than 2048 bytes [-Werror=frame-larger-than=]
    net/bluetooth/l2cap_core.c: In function 'l2cap_recv_frame':
    net/bridge/br_netlink.c:1505:1: error: the frame size of 2448 bytes is larger than 2048 bytes
    net/ieee802154/nl802154.c:548:1: error: the frame size of 2232 bytes is larger than 2048 bytes
    net/wireless/nl80211.c:1726:1: error: the frame size of 2224 bytes is larger than 2048 bytes
    net/wireless/nl80211.c:2357:1: error: the frame size of 4584 bytes is larger than 2048 bytes
    net/wireless/nl80211.c:5108:1: error: the frame size of 2760 bytes is larger than 2048 bytes
    net/wireless/nl80211.c:6472:1: error: the frame size of 2112 bytes is larger than 2048 bytes
    
    The structleak plugin was previously disabled for CONFIG_COMPILE_TEST,
    but meant we missed some bugs, so this time we should address them.
    
    The frame size warnings are distracting, and risking a kernel stack
    overflow is generally not beneficial to performance, so it may be best
    to disallow that particular combination. This can be done by turning
    off either one. I picked the dependency in GCC_PLUGIN_STRUCTLEAK_BYREF
    and GCC_PLUGIN_STRUCTLEAK_BYREF_ALL, as this option is designed to
    make uninitialized stack usage less harmful when enabled on its own,
    but it also prevents KASAN from detecting those cases in which it was
    in fact needed.
    
    KASAN_STACK is currently implied by KASAN on gcc, but could be made a
    user selectable option if we want to allow combining (non-stack) KASAN
    with GCC_PLUGIN_STRUCTLEAK_BYREF.
    
    Note that it would be possible to specifically address the files that
    print the warning, but presumably the overall stack usage is still
    significantly higher than in other configurations, so this would not
    address the full problem.
    
    I could not test this with CONFIG_INIT_STACK_ALL, which may or may not
    suffer from a similar problem.
    
    Fixes: 81a56f6dcd20 ("gcc-plugins: structleak: Generalize to all variable types")
    Signed-off-by: Arnd Bergmann <arnd@arndb.de>
    Link: https://lore.kernel.org/r/20190722114134.3123901-1-arnd@arndb.de
    Signed-off-by: Kees Cook <keescook@chromium.org>

commit 2e2f3c9b864d9f21fb82aa8da5ac9adc1e020f60
Author: Naohiro Aota <naohiro.aota@wdc.com>
Date:   Fri Jul 12 19:15:56 2019 +0900

    arm64: vdso: fix flip/flop vdso build bug
    
    Running "make" on an already compiled kernel tree will rebuild the kernel
    even without any modifications:
    
    $ make ARCH=arm64 CROSS_COMPILE=/usr/bin/aarch64-unknown-linux-gnu-
    arch/arm64/Makefile:58: CROSS_COMPILE_COMPAT not defined or empty, the compat vDSO will not be built
      CALL    scripts/checksyscalls.sh
      CALL    scripts/atomic/check-atomics.sh
      VDSOCHK arch/arm64/kernel/vdso/vdso.so.dbg
      VDSOSYM include/generated/vdso-offsets.h
      CHK     include/generated/compile.h
      CC      arch/arm64/kernel/signal.o
      CC      arch/arm64/kernel/vdso.o
      CC      arch/arm64/kernel/signal32.o
      LD      arch/arm64/kernel/vdso/vdso.so.dbg
      OBJCOPY arch/arm64/kernel/vdso/vdso.so
      AS      arch/arm64/kernel/vdso/vdso.o
      AR      arch/arm64/kernel/vdso/built-in.a
      AR      arch/arm64/kernel/built-in.a
      GEN     .version
      CHK     include/generated/compile.h
      UPD     include/generated/compile.h
      CC      init/version.o
      AR      init/built-in.a
      LD      vmlinux.o
    
    This is the same bug fixed in commit 92a4728608a8 ("x86/boot: Fix
    if_changed build flip/flop bug"). We cannot use two "if_changed" in one
    target. Fix this build bug by merging two commands into one function.
    
    Fixes: a7f71a2c8903 ("arm64: compat: Add vDSO")
    Fixes: 28b1a824a4f4 ("arm64: vdso: Substitute gettimeofday() with C implementation")
    Reviewed-by: Masahiro Yamada <yamada.masahiro@socionext.com>
    Reviewed-by: Vincenzo Frascino <vincenzo.frascino@arm.com>
    Tested-by: Vincenzo Frascino <vincenzo.frascino@arm.com>
    Co-developed-by: Vincenzo Frascino <vincenzo.frascino@arm.com>
    Signed-off-by: Vincenzo Frascino <vincenzo.frascino@arm.com>
    Signed-off-by: Naohiro Aota <naohiro.aota@wdc.com>
    [will: merged in compat fix from Vincenzo and made rule names consistent]
    Signed-off-by: Will Deacon <will@kernel.org>

commit 39d7530d7494b4e47ba1856e741f513dafd17e3d
Merge: 16c97650a56a a45ff5994c9c
Author: Linus Torvalds <torvalds@linux-foundation.org>
Date:   Fri Jul 12 15:35:14 2019 -0700

    Merge tag 'for-linus' of git://git.kernel.org/pub/scm/virt/kvm/kvm
    
    Pull KVM updates from Paolo Bonzini:
     "ARM:
       - support for chained PMU counters in guests
       - improved SError handling
       - handle Neoverse N1 erratum #1349291
       - allow side-channel mitigation status to be migrated
       - standardise most AArch64 system register accesses to msr_s/mrs_s
       - fix host MPIDR corruption on 32bit
       - selftests ckleanups
    
      x86:
       - PMU event {white,black}listing
       - ability for the guest to disable host-side interrupt polling
       - fixes for enlightened VMCS (Hyper-V pv nested virtualization),
       - new hypercall to yield to IPI target
       - support for passing cstate MSRs through to the guest
       - lots of cleanups and optimizations
    
      Generic:
       - Some txt->rST conversions for the documentation"
    
    * tag 'for-linus' of git://git.kernel.org/pub/scm/virt/kvm/kvm: (128 commits)
      Documentation: virtual: Add toctree hooks
      Documentation: kvm: Convert cpuid.txt to .rst
      Documentation: virtual: Convert paravirt_ops.txt to .rst
      KVM: x86: Unconditionally enable irqs in guest context
      KVM: x86: PMU Event Filter
      kvm: x86: Fix -Wmissing-prototypes warnings
      KVM: Properly check if "page" is valid in kvm_vcpu_unmap
      KVM: arm/arm64: Initialise host's MPIDRs by reading the actual register
      KVM: LAPIC: Retry tune per-vCPU timer_advance_ns if adaptive tuning goes insane
      kvm: LAPIC: write down valid APIC registers
      KVM: arm64: Migrate _elx sysreg accessors to msr_s/mrs_s
      KVM: doc: Add API documentation on the KVM_REG_ARM_WORKAROUNDS register
      KVM: arm/arm64: Add save/restore support for firmware workaround state
      arm64: KVM: Propagate full Spectre v2 workaround state to KVM guests
      KVM: arm/arm64: Support chained PMU counters
      KVM: arm/arm64: Remove pmc->bitmask
      KVM: arm/arm64: Re-create event when setting counter value
      KVM: arm/arm64: Extract duplicated code to own function
      KVM: arm/arm64: Rename kvm_pmu_{enable/disable}_counter functions
      KVM: LAPIC: ARBPRI is a reserved register for x2APIC
      ...

commit ba6d10ab8014ac10d25ca513352b6665e73b5785
Merge: 64b08df460cf baf23eddbf2a
Author: Linus Torvalds <torvalds@linux-foundation.org>
Date:   Thu Jul 11 15:14:01 2019 -0700

    Merge tag 'scsi-misc' of git://git.kernel.org/pub/scm/linux/kernel/git/jejb/scsi
    
    Pull SCSI updates from James Bottomley:
     "This is mostly update of the usual drivers: qla2xxx, hpsa, lpfc, ufs,
      mpt3sas, ibmvscsi, megaraid_sas, bnx2fc and hisi_sas as well as the
      removal of the osst driver (I heard from Willem privately that he
      would like the driver removed because all his test hardware has
      failed). Plus number of minor changes, spelling fixes and other
      trivia.
    
      The big merge conflict this time around is the SPDX licence tags.
      Following discussion on linux-next, we believe our version to be more
      accurate than the one in the tree, so the resolution is to take our
      version for all the SPDX conflicts"
    
    Note on the SPDX license tag conversion conflicts: the SCSI tree had
    done its own SPDX conversion, which in some cases conflicted with the
    treewide ones done by Thomas & co.
    
    In almost all cases, the conflicts were purely syntactic: the SCSI tree
    used the old-style SPDX tags ("GPL-2.0" and "GPL-2.0+") while the
    treewide conversion had used the new-style ones ("GPL-2.0-only" and
    "GPL-2.0-or-later").
    
    In these cases I picked the new-style one.
    
    In a few cases, the SPDX conversion was actually different, though.  As
    explained by James above, and in more detail in a pre-pull-request
    thread:
    
     "The other problem is actually substantive: In the libsas code Luben
      Tuikov originally specified gpl 2.0 only by dint of stating:
    
      * This file is licensed under GPLv2.
    
      In all the libsas files, but then muddied the water by quoting GPLv2
      verbatim (which includes the or later than language). So for these
      files Christoph did the conversion to v2 only SPDX tags and Thomas
      converted to v2 or later tags"
    
    So in those cases, where the spdx tag substantially mattered, I took the
    SCSI tree conversion of it, but then also took the opportunity to turn
    the old-style "GPL-2.0" into a new-style "GPL-2.0-only" tag.
    
    Similarly, when there were whitespace differences or other differences
    to the comments around the copyright notices, I took the version from
    the SCSI tree as being the more specific conversion.
    
    Finally, in the spdx conversions that had no conflicts (because the
    treewide ones hadn't been done for those files), I just took the SCSI
    tree version as-is, even if it was old-style.  The old-style conversions
    are perfectly valid, even if the "-only" and "-or-later" versions are
    perhaps more descriptive.
    
    * tag 'scsi-misc' of git://git.kernel.org/pub/scm/linux/kernel/git/jejb/scsi: (185 commits)
      scsi: qla2xxx: move IO flush to the front of NVME rport unregistration
      scsi: qla2xxx: Fix NVME cmd and LS cmd timeout race condition
      scsi: qla2xxx: on session delete, return nvme cmd
      scsi: qla2xxx: Fix kernel crash after disconnecting NVMe devices
      scsi: megaraid_sas: Update driver version to 07.710.06.00-rc1
      scsi: megaraid_sas: Introduce various Aero performance modes
      scsi: megaraid_sas: Use high IOPS queues based on IO workload
      scsi: megaraid_sas: Set affinity for high IOPS reply queues
      scsi: megaraid_sas: Enable coalescing for high IOPS queues
      scsi: megaraid_sas: Add support for High IOPS queues
      scsi: megaraid_sas: Add support for MPI toolbox commands
      scsi: megaraid_sas: Offload Aero RAID5/6 division calculations to driver
      scsi: megaraid_sas: RAID1 PCI bandwidth limit algorithm is applicable for only Ventura
      scsi: megaraid_sas: megaraid_sas: Add check for count returned by HOST_DEVICE_LIST DCMD
      scsi: megaraid_sas: Handle sequence JBOD map failure at driver level
      scsi: megaraid_sas: Don't send FPIO to RL Bypass queue
      scsi: megaraid_sas: In probe context, retry IOC INIT once if firmware is in fault
      scsi: megaraid_sas: Release Mutex lock before OCR in case of DCMD timeout
      scsi: megaraid_sas: Call disable_irq from process IRQ poll
      scsi: megaraid_sas: Remove few debug counters from IO path
      ...

commit a45ff5994c9cde41af627c46abb9f32beae68943
Merge: 429bb83af8bc 1e0cf16cdad1
Author: Paolo Bonzini <pbonzini@redhat.com>
Date:   Thu Jul 11 15:14:16 2019 +0200

    Merge tag 'kvm-arm-for-5.3' of git://git.kernel.org/pub/scm/linux/kernel/git/kvmarm/kvmarm into HEAD
    
    KVM/arm updates for 5.3
    
    - Add support for chained PMU counters in guests
    - Improve SError handling
    - Handle Neoverse N1 erratum #1349291
    - Allow side-channel mitigation status to be migrated
    - Standardise most AArch64 system register accesses to msr_s/mrs_s
    - Fix host MPIDR corruption on 32bit

commit adbf2b44e8f1764662962dd0580d5dfab082caeb
Author: Herbert Xu <herbert@gondor.apana.org.au>
Date:   Mon Jun 24 18:32:26 2019 +0800

    lib/mpi: Fix karactx leak in mpi_powm
    
    commit c8ea9fce2baf7b643384f36f29e4194fa40d33a6 upstream.
    
    Sometimes mpi_powm will leak karactx because a memory allocation
    failure causes a bail-out that skips the freeing of karactx.  This
    patch moves the freeing of karactx to the end of the function like
    everything else so that it can't be skipped.
    
    Reported-by: syzbot+f7baccc38dcc1e094e77@syzkaller.appspotmail.com
    Fixes: cdec9cb5167a ("crypto: GnuPG based MPI lib - source files...")
    Cc: <stable@vger.kernel.org>
    Signed-off-by: Herbert Xu <herbert@gondor.apana.org.au>
    Reviewed-by: Eric Biggers <ebiggers@kernel.org>
    Signed-off-by: Herbert Xu <herbert@gondor.apana.org.au>
    Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>

commit 18eee992e8e86dffc6a16e0566b1bcf780c2c7bd
Author: Paul Burton <paul.burton@mips.com>
Date:   Mon Aug 20 15:36:18 2018 -0700

    MIPS: Workaround GCC __builtin_unreachable reordering bug
    
    [ Upstream commit 906d441febc0de974b2a6ef848a8f058f3bfada3 ]
    
    Some versions of GCC for the MIPS architecture suffer from a bug which
    can lead to instructions from beyond an unreachable statement being
    incorrectly reordered into earlier branch delay slots if the unreachable
    statement is the only content of a case in a switch statement. This can
    lead to seemingly random behaviour, such as invalid memory accesses from
    incorrectly reordered loads or stores, and link failures on microMIPS
    builds.
    
    See this potential GCC fix for details:
    
        https://gcc.gnu.org/ml/gcc-patches/2015-09/msg00360.html
    
    Runtime problems resulting from this bug were initially observed using a
    maltasmvp_defconfig v4.4 kernel built using GCC 4.9.2 (from a Codescape
    SDK 2015.06-05 toolchain), with the result being an address exception
    taken after log messages about the L1 caches (during probe of the L2
    cache):
    
        Initmem setup node 0 [mem 0x0000000080000000-0x000000009fffffff]
        VPE topology {2,2} total 4
        Primary instruction cache 64kB, VIPT, 4-way, linesize 32 bytes.
        Primary data cache 64kB, 4-way, PIPT, no aliases, linesize 32 bytes
        <AdEL exception here>
    
    This is early enough that the kernel exception vectors are not in use,
    so any further output depends upon the bootloader. This is reproducible
    in QEMU where no further output occurs - ie. the system hangs here.
    Given the nature of the bug it may potentially be hit with differing
    symptoms. The bug is known to affect GCC versions as recent as 7.3, and
    it is unclear whether GCC 8 fixed it or just happens not to encounter
    the bug in the testcase found at the link above due to differing
    optimizations.
    
    This bug can be worked around by placing a volatile asm statement, which
    GCC is prevented from reordering past, prior to the
    __builtin_unreachable call.
    
    That was actually done already for other reasons by commit 173a3efd3edb
    ("bug.h: work around GCC PR82365 in BUG()"), but creates problems for
    microMIPS builds due to the lack of a .insn directive. The microMIPS ISA
    allows for interlinking with regular MIPS32 code by repurposing bit 0 of
    the program counter as an ISA mode bit. To switch modes one changes the
    value of this bit in the PC. However typical branch instructions encode
    their offsets as multiples of 2-byte instruction halfwords, which means
    they cannot change ISA mode - this must be done using either an indirect
    branch (a jump-register in MIPS terminology) or a dedicated jalx
    instruction. In order to ensure that regular branches don't attempt to
    target code in a different ISA which they can't actually switch to, the
    linker will check that branch targets are code in the same ISA as the
    branch.
    
    Unfortunately our empty asm volatile statements don't qualify as code,
    and the link for microMIPS builds fails with errors such as:
    
        arch/mips/mm/dma-default.s:3265: Error: branch to a symbol in another ISA mode
        arch/mips/mm/dma-default.s:5027: Error: branch to a symbol in another ISA mode
    
    Resolve this by adding a .insn directive within the asm statement which
    declares that what comes next is code. This may or may not be true,
    since we don't really know what comes next, but as this code is in an
    unreachable path anyway that doesn't matter since we won't execute it.
    
    We do this in asm/compiler.h & select CONFIG_HAVE_ARCH_COMPILER_H in
    order to have this included by linux/compiler_types.h after
    linux/compiler-gcc.h. This will result in asm/compiler.h being included
    in all C compilations via the -include linux/compiler_types.h argument
    in c_flags, which should be harmless.
    
    Signed-off-by: Paul Burton <paul.burton@mips.com>
    Fixes: 173a3efd3edb ("bug.h: work around GCC PR82365 in BUG()")
    Patchwork: https://patchwork.linux-mips.org/patch/20270/
    Cc: James Hogan <jhogan@kernel.org>
    Cc: Ralf Baechle <ralf@linux-mips.org>
    Cc: Arnd Bergmann <arnd@arndb.de>
    Cc: linux-mips@linux-mips.org
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit ea68394342605bad4a1c2bc8c30de4209b4ffac3
Author: Herbert Xu <herbert@gondor.apana.org.au>
Date:   Mon Jun 24 18:32:26 2019 +0800

    lib/mpi: Fix karactx leak in mpi_powm
    
    commit c8ea9fce2baf7b643384f36f29e4194fa40d33a6 upstream.
    
    Sometimes mpi_powm will leak karactx because a memory allocation
    failure causes a bail-out that skips the freeing of karactx.  This
    patch moves the freeing of karactx to the end of the function like
    everything else so that it can't be skipped.
    
    Reported-by: syzbot+f7baccc38dcc1e094e77@syzkaller.appspotmail.com
    Fixes: cdec9cb5167a ("crypto: GnuPG based MPI lib - source files...")
    Cc: <stable@vger.kernel.org>
    Signed-off-by: Herbert Xu <herbert@gondor.apana.org.au>
    Reviewed-by: Eric Biggers <ebiggers@kernel.org>
    Signed-off-by: Herbert Xu <herbert@gondor.apana.org.au>
    Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>

commit e7816df0494bf4c49b6c7d20dbfec4e1a1a016c2
Author: Paul Burton <paul.burton@mips.com>
Date:   Mon Aug 20 15:36:18 2018 -0700

    MIPS: Workaround GCC __builtin_unreachable reordering bug
    
    [ Upstream commit 906d441febc0de974b2a6ef848a8f058f3bfada3 ]
    
    Some versions of GCC for the MIPS architecture suffer from a bug which
    can lead to instructions from beyond an unreachable statement being
    incorrectly reordered into earlier branch delay slots if the unreachable
    statement is the only content of a case in a switch statement. This can
    lead to seemingly random behaviour, such as invalid memory accesses from
    incorrectly reordered loads or stores, and link failures on microMIPS
    builds.
    
    See this potential GCC fix for details:
    
        https://gcc.gnu.org/ml/gcc-patches/2015-09/msg00360.html
    
    Runtime problems resulting from this bug were initially observed using a
    maltasmvp_defconfig v4.4 kernel built using GCC 4.9.2 (from a Codescape
    SDK 2015.06-05 toolchain), with the result being an address exception
    taken after log messages about the L1 caches (during probe of the L2
    cache):
    
        Initmem setup node 0 [mem 0x0000000080000000-0x000000009fffffff]
        VPE topology {2,2} total 4
        Primary instruction cache 64kB, VIPT, 4-way, linesize 32 bytes.
        Primary data cache 64kB, 4-way, PIPT, no aliases, linesize 32 bytes
        <AdEL exception here>
    
    This is early enough that the kernel exception vectors are not in use,
    so any further output depends upon the bootloader. This is reproducible
    in QEMU where no further output occurs - ie. the system hangs here.
    Given the nature of the bug it may potentially be hit with differing
    symptoms. The bug is known to affect GCC versions as recent as 7.3, and
    it is unclear whether GCC 8 fixed it or just happens not to encounter
    the bug in the testcase found at the link above due to differing
    optimizations.
    
    This bug can be worked around by placing a volatile asm statement, which
    GCC is prevented from reordering past, prior to the
    __builtin_unreachable call.
    
    That was actually done already for other reasons by commit 173a3efd3edb
    ("bug.h: work around GCC PR82365 in BUG()"), but creates problems for
    microMIPS builds due to the lack of a .insn directive. The microMIPS ISA
    allows for interlinking with regular MIPS32 code by repurposing bit 0 of
    the program counter as an ISA mode bit. To switch modes one changes the
    value of this bit in the PC. However typical branch instructions encode
    their offsets as multiples of 2-byte instruction halfwords, which means
    they cannot change ISA mode - this must be done using either an indirect
    branch (a jump-register in MIPS terminology) or a dedicated jalx
    instruction. In order to ensure that regular branches don't attempt to
    target code in a different ISA which they can't actually switch to, the
    linker will check that branch targets are code in the same ISA as the
    branch.
    
    Unfortunately our empty asm volatile statements don't qualify as code,
    and the link for microMIPS builds fails with errors such as:
    
        arch/mips/mm/dma-default.s:3265: Error: branch to a symbol in another ISA mode
        arch/mips/mm/dma-default.s:5027: Error: branch to a symbol in another ISA mode
    
    Resolve this by adding a .insn directive within the asm statement which
    declares that what comes next is code. This may or may not be true,
    since we don't really know what comes next, but as this code is in an
    unreachable path anyway that doesn't matter since we won't execute it.
    
    We do this in asm/compiler.h & select CONFIG_HAVE_ARCH_COMPILER_H in
    order to have this included by linux/compiler_types.h after
    linux/compiler-gcc.h. This will result in asm/compiler.h being included
    in all C compilations via the -include linux/compiler_types.h argument
    in c_flags, which should be harmless.
    
    Signed-off-by: Paul Burton <paul.burton@mips.com>
    Fixes: 173a3efd3edb ("bug.h: work around GCC PR82365 in BUG()")
    Patchwork: https://patchwork.linux-mips.org/patch/20270/
    Cc: James Hogan <jhogan@kernel.org>
    Cc: Ralf Baechle <ralf@linux-mips.org>
    Cc: Arnd Bergmann <arnd@arndb.de>
    Cc: linux-mips@linux-mips.org
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit 99b6668f2e3f70f703a01c77ada0c4bc80cfb1cf
Author: Manuel Traut <manut@linutronix.de>
Date:   Thu Jun 13 15:55:52 2019 -0700

    scripts/decode_stacktrace.sh: prefix addr2line with $CROSS_COMPILE
    
    [ Upstream commit c04e32e911653442fc834be6e92e072aeebe01a1 ]
    
    At least for ARM64 kernels compiled with the crosstoolchain from
    Debian/stretch or with the toolchain from kernel.org the line number is
    not decoded correctly by 'decode_stacktrace.sh':
    
      $ echo "[  136.513051]  f1+0x0/0xc [kcrash]" | \
        CROSS_COMPILE=/opt/gcc-8.1.0-nolibc/aarch64-linux/bin/aarch64-linux- \
       ./scripts/decode_stacktrace.sh /scratch/linux-arm64/vmlinux \
                                      /scratch/linux-arm64 \
                                      /nfs/debian/lib/modules/4.20.0-devel
      [  136.513051] f1 (/linux/drivers/staging/kcrash/kcrash.c:68) kcrash
    
    If addr2line from the toolchain is used the decoded line number is correct:
    
      [  136.513051] f1 (/linux/drivers/staging/kcrash/kcrash.c:57) kcrash
    
    Link: http://lkml.kernel.org/r/20190527083425.3763-1-manut@linutronix.de
    Signed-off-by: Manuel Traut <manut@linutronix.de>
    Acked-by: Konstantin Khlebnikov <khlebnikov@yandex-team.ru>
    Signed-off-by: Andrew Morton <akpm@linux-foundation.org>
    Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit 9fbe87fc25ad9b169505ab6ad282c7072b2d275e
Author: Herbert Xu <herbert@gondor.apana.org.au>
Date:   Mon Jun 24 18:32:26 2019 +0800

    lib/mpi: Fix karactx leak in mpi_powm
    
    commit c8ea9fce2baf7b643384f36f29e4194fa40d33a6 upstream.
    
    Sometimes mpi_powm will leak karactx because a memory allocation
    failure causes a bail-out that skips the freeing of karactx.  This
    patch moves the freeing of karactx to the end of the function like
    everything else so that it can't be skipped.
    
    Reported-by: syzbot+f7baccc38dcc1e094e77@syzkaller.appspotmail.com
    Fixes: cdec9cb5167a ("crypto: GnuPG based MPI lib - source files...")
    Cc: <stable@vger.kernel.org>
    Signed-off-by: Herbert Xu <herbert@gondor.apana.org.au>
    Reviewed-by: Eric Biggers <ebiggers@kernel.org>
    Signed-off-by: Herbert Xu <herbert@gondor.apana.org.au>
    Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>

commit 793ff5efee9ff49fa633cfb1fdf58e7370af160c
Author: Manuel Traut <manut@linutronix.de>
Date:   Thu Jun 13 15:55:52 2019 -0700

    scripts/decode_stacktrace.sh: prefix addr2line with $CROSS_COMPILE
    
    [ Upstream commit c04e32e911653442fc834be6e92e072aeebe01a1 ]
    
    At least for ARM64 kernels compiled with the crosstoolchain from
    Debian/stretch or with the toolchain from kernel.org the line number is
    not decoded correctly by 'decode_stacktrace.sh':
    
      $ echo "[  136.513051]  f1+0x0/0xc [kcrash]" | \
        CROSS_COMPILE=/opt/gcc-8.1.0-nolibc/aarch64-linux/bin/aarch64-linux- \
       ./scripts/decode_stacktrace.sh /scratch/linux-arm64/vmlinux \
                                      /scratch/linux-arm64 \
                                      /nfs/debian/lib/modules/4.20.0-devel
      [  136.513051] f1 (/linux/drivers/staging/kcrash/kcrash.c:68) kcrash
    
    If addr2line from the toolchain is used the decoded line number is correct:
    
      [  136.513051] f1 (/linux/drivers/staging/kcrash/kcrash.c:57) kcrash
    
    Link: http://lkml.kernel.org/r/20190527083425.3763-1-manut@linutronix.de
    Signed-off-by: Manuel Traut <manut@linutronix.de>
    Acked-by: Konstantin Khlebnikov <khlebnikov@yandex-team.ru>
    Signed-off-by: Andrew Morton <akpm@linux-foundation.org>
    Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit ea38007107d656e40173da3fed59287ac2a7e11b
Author: Herbert Xu <herbert@gondor.apana.org.au>
Date:   Mon Jun 24 18:32:26 2019 +0800

    lib/mpi: Fix karactx leak in mpi_powm
    
    commit c8ea9fce2baf7b643384f36f29e4194fa40d33a6 upstream.
    
    Sometimes mpi_powm will leak karactx because a memory allocation
    failure causes a bail-out that skips the freeing of karactx.  This
    patch moves the freeing of karactx to the end of the function like
    everything else so that it can't be skipped.
    
    Reported-by: syzbot+f7baccc38dcc1e094e77@syzkaller.appspotmail.com
    Fixes: cdec9cb5167a ("crypto: GnuPG based MPI lib - source files...")
    Cc: <stable@vger.kernel.org>
    Signed-off-by: Herbert Xu <herbert@gondor.apana.org.au>
    Reviewed-by: Eric Biggers <ebiggers@kernel.org>
    Signed-off-by: Herbert Xu <herbert@gondor.apana.org.au>
    Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>

commit 4fce0a79e98516de8f9e85d47d442efb0494df43
Author: Manuel Traut <manut@linutronix.de>
Date:   Thu Jun 13 15:55:52 2019 -0700

    scripts/decode_stacktrace.sh: prefix addr2line with $CROSS_COMPILE
    
    [ Upstream commit c04e32e911653442fc834be6e92e072aeebe01a1 ]
    
    At least for ARM64 kernels compiled with the crosstoolchain from
    Debian/stretch or with the toolchain from kernel.org the line number is
    not decoded correctly by 'decode_stacktrace.sh':
    
      $ echo "[  136.513051]  f1+0x0/0xc [kcrash]" | \
        CROSS_COMPILE=/opt/gcc-8.1.0-nolibc/aarch64-linux/bin/aarch64-linux- \
       ./scripts/decode_stacktrace.sh /scratch/linux-arm64/vmlinux \
                                      /scratch/linux-arm64 \
                                      /nfs/debian/lib/modules/4.20.0-devel
      [  136.513051] f1 (/linux/drivers/staging/kcrash/kcrash.c:68) kcrash
    
    If addr2line from the toolchain is used the decoded line number is correct:
    
      [  136.513051] f1 (/linux/drivers/staging/kcrash/kcrash.c:57) kcrash
    
    Link: http://lkml.kernel.org/r/20190527083425.3763-1-manut@linutronix.de
    Signed-off-by: Manuel Traut <manut@linutronix.de>
    Acked-by: Konstantin Khlebnikov <khlebnikov@yandex-team.ru>
    Signed-off-by: Andrew Morton <akpm@linux-foundation.org>
    Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit 3e421061981c8bb6ddfb9ebf8469146b90ba7c50
Author: Herbert Xu <herbert@gondor.apana.org.au>
Date:   Mon Jun 24 18:32:26 2019 +0800

    lib/mpi: Fix karactx leak in mpi_powm
    
    commit c8ea9fce2baf7b643384f36f29e4194fa40d33a6 upstream.
    
    Sometimes mpi_powm will leak karactx because a memory allocation
    failure causes a bail-out that skips the freeing of karactx.  This
    patch moves the freeing of karactx to the end of the function like
    everything else so that it can't be skipped.
    
    Reported-by: syzbot+f7baccc38dcc1e094e77@syzkaller.appspotmail.com
    Fixes: cdec9cb5167a ("crypto: GnuPG based MPI lib - source files...")
    Cc: <stable@vger.kernel.org>
    Signed-off-by: Herbert Xu <herbert@gondor.apana.org.au>
    Reviewed-by: Eric Biggers <ebiggers@kernel.org>
    Signed-off-by: Herbert Xu <herbert@gondor.apana.org.au>
    Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>

commit 80d567f799c18814c2065df840c74d76ded2fc3c
Author: Manuel Traut <manut@linutronix.de>
Date:   Thu Jun 13 15:55:52 2019 -0700

    scripts/decode_stacktrace.sh: prefix addr2line with $CROSS_COMPILE
    
    [ Upstream commit c04e32e911653442fc834be6e92e072aeebe01a1 ]
    
    At least for ARM64 kernels compiled with the crosstoolchain from
    Debian/stretch or with the toolchain from kernel.org the line number is
    not decoded correctly by 'decode_stacktrace.sh':
    
      $ echo "[  136.513051]  f1+0x0/0xc [kcrash]" | \
        CROSS_COMPILE=/opt/gcc-8.1.0-nolibc/aarch64-linux/bin/aarch64-linux- \
       ./scripts/decode_stacktrace.sh /scratch/linux-arm64/vmlinux \
                                      /scratch/linux-arm64 \
                                      /nfs/debian/lib/modules/4.20.0-devel
      [  136.513051] f1 (/linux/drivers/staging/kcrash/kcrash.c:68) kcrash
    
    If addr2line from the toolchain is used the decoded line number is correct:
    
      [  136.513051] f1 (/linux/drivers/staging/kcrash/kcrash.c:57) kcrash
    
    Link: http://lkml.kernel.org/r/20190527083425.3763-1-manut@linutronix.de
    Signed-off-by: Manuel Traut <manut@linutronix.de>
    Acked-by: Konstantin Khlebnikov <khlebnikov@yandex-team.ru>
    Signed-off-by: Andrew Morton <akpm@linux-foundation.org>
    Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit 2d41ef5432b76ae90dc0db93026f1d981f874ec4
Merge: ed63b9c87360 732146a3f1dc
Author: Linus Torvalds <torvalds@linux-foundation.org>
Date:   Tue Jul 9 09:55:45 2019 -0700

    Merge tag 'fbdev-v5.3' of git://github.com/bzolnier/linux
    
    Pull fbdev updates from Bartlomiej Zolnierkiewicz:
    
     - remove fbdev notifier usage for fbcon (as prep work to clean up the
       fbcon locking), add locking checks in vt/console code and make
       assorted cleanups in fbdev and backlight code (Daniel Vetter)
    
     - add COMPILE_TEST support to atmel_lcdfb, da8xx-fb, gbefb, imxfb,
       pvr2fb and pxa168fb drivers (me)
    
     - fix DMA API abuse in au1200fb and jz4740_fb drivers (Christoph
       Hellwig)
    
     - add check for new BGRT status field rotation bits in efifb driver
       (Hans de Goede)
    
     - mark expected switch fall-throughs in s3c-fb driver (Gustavo A. R.
       Silva)
    
     - remove fbdev mxsfb driver in favour of the drm version (Fabio
       Estevam)
    
     - remove broken rfbi code from omap2fb driver (me)
    
     - misc fixes (Arnd Bergmann, Shobhit Kukreti, Wei Yongjun, me)
    
     - misc cleanups (Gustavo A. R. Silva, Colin Ian King, me)
    
    * tag 'fbdev-v5.3' of git://github.com/bzolnier/linux: (62 commits)
      video: fbdev: imxfb: fix a typo in imxfb_probe()
      video: fbdev: s3c-fb: Mark expected switch fall-throughs
      video: fbdev: s3c-fb: fix sparse warnings about using incorrect types
      video: fbdev: don't print error message on framebuffer_alloc() failure
      video: fbdev: intelfb: return -ENOMEM on framebuffer_alloc() failure
      video: fbdev: s3c-fb: return -ENOMEM on framebuffer_alloc() failure
      vga_switcheroo: Depend upon fbcon being built-in, if enabled
      video: fbdev: omap2: remove rfbi
      video: fbdev: atmel_lcdfb: remove redundant initialization to variable ret
      video: fbdev-MMP: Use struct_size() in devm_kzalloc()
      video: fbdev: controlfb: fix warnings about comparing pointer to 0
      efifb: BGRT: Add check for new BGRT status field rotation bits
      jz4740_fb: fix DMA API abuse
      video: fbdev: pvr2fb: fix link error for pvr2fb_pci_exit
      video: fbdev: s3c-fb: add COMPILE_TEST support
      video: fbdev: imxfb: fix sparse warnings about using incorrect types
      video: fbdev: pvr2fb: fix build warning when compiling as module
      fbcon: Export fbcon_update_vcs
      backlight: simplify lcd notifier
      staging/olpc_dcon: Add drm conversion to TODO
      ...

commit 1e0cf16cdad1ba53e9eeee8746fe57de42f20c97
Author: Marc Zyngier <marc.zyngier@arm.com>
Date:   Fri Jul 5 23:35:56 2019 +0100

    KVM: arm/arm64: Initialise host's MPIDRs by reading the actual register
    
    As part of setting up the host context, we populate its
    MPIDR by using cpu_logical_map(). It turns out that contrary
    to arm64, cpu_logical_map() on 32bit ARM doesn't return the
    *full* MPIDR, but a truncated version.
    
    This leaves the host MPIDR slightly corrupted after the first
    run of a VM, since we won't correctly restore the MPIDR on
    exit. Oops.
    
    Since we cannot trust cpu_logical_map(), let's adopt a different
    strategy. We move the initialization of the host CPU context as
    part of the per-CPU initialization (which, in retrospect, makes
    a lot of sense), and directly read the MPIDR from the HW. This
    is guaranteed to work on both arm and arm64.
    
    Reported-by: Andre Przywara <Andre.Przywara@arm.com>
    Tested-by: Andre Przywara <Andre.Przywara@arm.com>
    Fixes: 32f139551954 ("arm/arm64: KVM: Statically configure the host's view of MPIDR")
    Signed-off-by: Marc Zyngier <marc.zyngier@arm.com>

commit 7e8ab1b268b1ab2d2956823f93c7f3c62b9c2b26
Author: Leonard Crestez <leonard.crestez@nxp.com>
Date:   Mon Mar 11 18:59:28 2019 +0000

    PCI: imx6: Simplify Kconfig depends on
    
    The imx6 driver can be used on imx6sx without enabling support for
    imx6q or imx7d but the "depends on" condition doesn't allow that.
    
    Instead of making the condition even longer just make it depend on
    "ARCH_MXC || COMPILE_TEST" instead.
    
    Signed-off-by: Leonard Crestez <leonard.crestez@nxp.com>
    Signed-off-by: Lorenzo Pieralisi <lorenzo.pieralisi@arm.com>
    Acked-by: Lucas Stach <l.stach@pengutronix.de>

commit a22719cce54bc18001a7c8be9c713ba629f5801c
Merge: 53e155f2bbd4 156bdac99061
Author: Dave Airlie <airlied@redhat.com>
Date:   Thu Jul 4 11:46:02 2019 +1000

    Merge tag 'exynos-drm-next-for-v5.3' of git://git.kernel.org/pub/scm/linux/kernel/git/daeinki/drm-exynos into drm-next
    
    - Drop the use of drmP.h header file
       drmP.h header file has been deprecated so this patch drops the use of
       this header, and instead includes appropriate header files required.
     - Add COMPILE_TEST flag
       This patch adds COMPILE_TEST dependency to exynos drm driver to
       increase build test coverage. And also, it includes vmalloc.h
       header file to fix one build warning which is introduced when
       building the Linux kernel using sh.
    
    Signed-off-by: Dave Airlie <airlied@redhat.com>
    
    From: Inki Dae <inki.dae@samsung.com>
    Link: https://patchwork.freedesktop.org/patch/msgid/CAAQKjZMdBdD8oEa0cNv78FjrpOqu20ozTTvuPEm_XnVo2gRhCQ@mail.gmail.com

commit c8ea9fce2baf7b643384f36f29e4194fa40d33a6
Author: Herbert Xu <herbert@gondor.apana.org.au>
Date:   Mon Jun 24 18:32:26 2019 +0800

    lib/mpi: Fix karactx leak in mpi_powm
    
    Sometimes mpi_powm will leak karactx because a memory allocation
    failure causes a bail-out that skips the freeing of karactx.  This
    patch moves the freeing of karactx to the end of the function like
    everything else so that it can't be skipped.
    
    Reported-by: syzbot+f7baccc38dcc1e094e77@syzkaller.appspotmail.com
    Fixes: cdec9cb5167a ("crypto: GnuPG based MPI lib - source files...")
    Cc: <stable@vger.kernel.org>
    Signed-off-by: Herbert Xu <herbert@gondor.apana.org.au>
    Reviewed-by: Eric Biggers <ebiggers@kernel.org>
    Signed-off-by: Herbert Xu <herbert@gondor.apana.org.au>

commit f8b5c72227618780f49e53fb77b0e7ddb2996552
Merge: c57582adfda3 ec9b4feb1e41
Author: Linus Torvalds <torvalds@linux-foundation.org>
Date:   Sat Jun 29 17:05:58 2019 +0800

    Merge tag 'arc-5.2-rc7' of git://git.kernel.org/pub/scm/linux/kernel/git/vgupta/arc
    
    Pull ARC fixes from Vineet Gupta:
    
     - hsdk platform unifying apertures
    
     - build system CROSS_COMPILE prefix
    
    * tag 'arc-5.2-rc7' of git://git.kernel.org/pub/scm/linux/kernel/git/vgupta/arc:
      ARC: [plat-hsdk]: unify memory apertures configuration
      ARC: build: Try to guess CROSS_COMPILE with cc-cross-prefix

commit c7ab138eb132e197c6f594b11ca8aa87755d2810
Author: Shahar S Matityahu <shahar.s.matityahu@intel.com>
Date:   Tue Apr 2 15:28:46 2019 +0300

    iwlwifi: dbg_ini: add consecutive trigger firing support
    
    When a dump trigger is fired, the driver sets IWL_FWRT_STATUS_DUMPING and
    aborts any consecutive dump collection.
    To allow consecutive triggers firing, use 5 dump workers and allocate
    them upon incoming dump collection requests.
    
    This functionality is needed since in ini debug mode each trigger may
    have entirely different memory regions to collect unlike the legacy
    mode in which all the triggers dump the same memory regions.
    
    Signed-off-by: Shahar S Matityahu <shahar.s.matityahu@intel.com>
    Signed-off-by: Luca Coelho <luciano.coelho@intel.com>

commit 1e08511d5d01884a3c9070afd52a47799312074a
Author: Vedang Patel <vedang.patel@intel.com>
Date:   Tue Jun 25 15:07:12 2019 -0700

    igb: clear out skb->tstamp after reading the txtime
    
    If a packet which is utilizing the launchtime feature (via SO_TXTIME socket
    option) also requests the hardware transmit timestamp, the hardware
    timestamp is not delivered to the userspace. This is because the value in
    skb->tstamp is mistaken as the software timestamp.
    
    Applications, like ptp4l, request a hardware timestamp by setting the
    SOF_TIMESTAMPING_TX_HARDWARE socket option. Whenever a new timestamp is
    detected by the driver (this work is done in igb_ptp_tx_work() which calls
    igb_ptp_tx_hwtstamps() in igb_ptp.c[1]), it will queue the timestamp in the
    ERR_QUEUE for the userspace to read. When the userspace is ready, it will
    issue a recvmsg() call to collect this timestamp.  The problem is in this
    recvmsg() call. If the skb->tstamp is not cleared out, it will be
    interpreted as a software timestamp and the hardware tx timestamp will not
    be successfully sent to the userspace. Look at skb_is_swtx_tstamp() and the
    callee function __sock_recv_timestamp() in net/socket.c for more details.
    
    Signed-off-by: Vedang Patel <vedang.patel@intel.com>
    Tested-by: Aaron Brown <aaron.f.brown@intel.com>
    Signed-off-by: David S. Miller <davem@davemloft.net>

commit 156bdac99061b4013c8e47799c6e574f7f84e9f4
Author: Sam Ravnborg <sam@ravnborg.org>
Date:   Thu Jun 27 20:00:54 2019 +0900

    drm/exynos: trigger build of all modules
    
    Add COMPILE_TEST dependency to force exynos driver to
    built for more than arm and to built modules
    that otherwise required other symbols to be de-selected.
    
    This will increase build coverage of the exynos driver
    thus allowing most trivial build errors to be detected/fixed early.
    
    This introduces one warning when built using sh:
    exynos7_drm_decon.c: In function decon_remove:
    exynos7_drm_decon.c:769:24: warning: unused variable ctx
      struct decon_context *ctx = dev_get_drvdata(&pdev->dev);
    
    This is due to the definition of iounmap() in sh,
    and nothing that exynos driver can fix.
    
    Include fix of exynos build for alpha.
    
    Signed-off-by: Sam Ravnborg <sam@ravnborg.org>
    Cc: Inki Dae <inki.dae@samsung.com>
    Cc: Joonyoung Shim <jy0922.shim@samsung.com>
    Cc: Seung-Woo Kim <sw0312.kim@samsung.com>
    Cc: Kyungmin Park <kyungmin.park@samsung.com>
    Cc: David Airlie <airlied@linux.ie>
    Cc: Daniel Vetter <daniel@ffwll.ch>
    Cc: Kukjin Kim <kgene@kernel.org>
    Cc: Krzysztof Kozlowski <krzk@kernel.org>
    Cc: Jingoo Han <jingoohan1@gmail.com>
    Signed-off-by: Inki Dae <inki.dae@samsung.com>

commit 58136856167d10adc2a190aff88d13b33eafb9e2
Author: Chandrakanth Patil <chandrakanth.patil@broadcom.com>
Date:   Tue Jun 25 16:34:30 2019 +0530

    scsi: megaraid_sas: Add support for MPI toolbox commands
    
    Added driver support to allow passthrough MPI toolbox type MFI commands to
    firmware based on firmware capability.
    
    Signed-off-by: Sumit Saxena <sumit.saxena@broadcom.com>
    Signed-off-by: Chandrakanth Patil <chandrakanth.patil@broadcom.com>
    Signed-off-by: Martin K. Petersen <martin.petersen@oracle.com>

commit 2040a857e436e5e942d3d2d893891d088dba87f1
Author: Deepak Ukey <deepak.ukey@microchip.com>
Date:   Mon Jun 24 13:52:27 2019 +0530

    scsi: pm80xx: Event log size through sysfs
    
    Added support to read event log size from MPI configuration table and
    export through sysfs.
    
    Signed-off-by: Deepak Ukey <deepak.ukey@microchip.com>
    Signed-off-by: Viswas G <Viswas.G@microchip.com>
    Reviewed-by: Jack Wang <jinpu.wang@cloud.ionos.com>
    Signed-off-by: Martin K. Petersen <martin.petersen@oracle.com>

commit acb4bb3f37f1fdec00421c4126bf1e2e276a892b
Author: Dmitry Osipenko <digetx@gmail.com>
Date:   Mon Jun 3 21:59:46 2019 +0300

    clocksource/drivers/tegra: Support COMPILE_TEST universally
    
    Remove build dependency on ARM for compile-testing to allow non-arch
    specific build-bots (like Intel's test robot) to compile the driver and
    report about problems.
    
    Signed-off-by: Dmitry Osipenko <digetx@gmail.com>
    Acked-By: Peter De Schrijver <pdeschrijver@nvidia.com>
    Signed-off-by: Daniel Lezcano <daniel.lezcano@linaro.org>

commit a7f71a2c8903f8599312f75233946287c558d9f6
Author: Vincenzo Frascino <vincenzo.frascino@arm.com>
Date:   Fri Jun 21 10:52:37 2019 +0100

    arm64: compat: Add vDSO
    
    Provide the arm64 compat (AArch32) vDSO in kernel/vdso32 in a similar
    way to what happens in kernel/vdso.
    
    The compat vDSO leverages on an adaptation of the arm architecture code
    with few changes:
    
     - Use of lib/vdso for gettimeofday
     - Implement a syscall based fallback
     - Introduce clock_getres() for the compat library
     - Implement trampolines
     - Implement elf note
    
    To build the compat vDSO a 32 bit compiler is required and needs to be
    specified via CONFIG_CROSS_COMPILE_COMPAT_VDSO.
    
    The code is not yet enabled as other prerequisites are missing.
    
    Signed-off-by: Vincenzo Frascino <vincenzo.frascino@arm.com>
    Signed-off-by: Thomas Gleixner <tglx@linutronix.de>
    Tested-by: Shijith Thotton <sthotton@marvell.com>
    Tested-by: Andre Przywara <andre.przywara@arm.com>
    Cc: linux-arch@vger.kernel.org
    Cc: linux-arm-kernel@lists.infradead.org
    Cc: linux-mips@vger.kernel.org
    Cc: linux-kselftest@vger.kernel.org
    Cc: Catalin Marinas <catalin.marinas@arm.com>
    Cc: Will Deacon <will.deacon@arm.com>
    Cc: Arnd Bergmann <arnd@arndb.de>
    Cc: Russell King <linux@armlinux.org.uk>
    Cc: Ralf Baechle <ralf@linux-mips.org>
    Cc: Paul Burton <paul.burton@mips.com>
    Cc: Daniel Lezcano <daniel.lezcano@linaro.org>
    Cc: Mark Salyzyn <salyzyn@android.com>
    Cc: Peter Collingbourne <pcc@google.com>
    Cc: Shuah Khan <shuah@kernel.org>
    Cc: Dmitry Safonov <0x7f454c46@gmail.com>
    Cc: Rasmus Villemoes <linux@rasmusvillemoes.dk>
    Cc: Huw Davies <huw@codeweavers.com>
    Link: https://lkml.kernel.org/r/20190621095252.32307-11-vincenzo.frascino@arm.com

commit eef4d8e9f06dd06496ea82400f26379c4de8797c
Author: YueHaibing <yuehaibing@huawei.com>
Date:   Sat Jun 15 03:45:53 2019 -0400

    media: meye: Fix build COMPILE_TEST error
    
    If COMPILE_TEST is y and SONY_LAPTOP is m,
    building fails as below:
    
    Reported-by: Hulk Robot <hulkci@huawei.com>
    Fixes: 6159e12e1177 ("media: meye: allow building it with COMPILE_TEST on non-x86")
    Signed-off-by: YueHaibing <yuehaibing@huawei.com>
    Signed-off-by: Hans Verkuil <hverkuil-cisco@xs4all.nl>
    Signed-off-by: Mauro Carvalho Chehab <mchehab+samsung@kernel.org>

commit 56fc5f48200fc432d80a9cffe1b2fe5fe7680f36
Author: Arnd Bergmann <arnd@arndb.de>
Date:   Fri Jun 21 15:13:13 2019 +0200

    video: fbdev: pvr2fb: fix link error for pvr2fb_pci_exit
    
    When the driver is built-in for PCI, we reference the exit function
    after discarding it:
    
    `pvr2fb_pci_exit' referenced in section `.ref.data' of drivers/video/fbdev/pvr2fb.o: defined in discarded section `.exit.text' of drivers/video/fbdev/pvr2fb.o
    
    Just remove the __exit annotation as the easiest workaround.
    
    Also apply the same workaround for pvr2fb_dc_exit().
    
    Fixes: 0f5a5712ad1e ("video: fbdev: pvr2fb: add COMPILE_TEST support")
    Signed-off-by: Arnd Bergmann <arnd@arndb.de>
    Cc: YueHaibing <yuehaibing@huawei.com>
    Cc: Ira Weiny <ira.weiny@intel.com>
    Cc: Andrew Morton <akpm@linux-foundation.org>
    [b.zolnierkie: remove __exit annotation also from pvr2fb_dc_exit()]
    Signed-off-by: Bartlomiej Zolnierkiewicz <b.zolnierkie@samsung.com>

commit f10effe5f77a9deb13c8fa3df6c2f103f04e6a0f
Author: Bartlomiej Zolnierkiewicz <b.zolnierkie@samsung.com>
Date:   Fri Jun 21 13:04:39 2019 +0200

    video: fbdev: s3c-fb: add COMPILE_TEST support
    
    Add COMPILE_TEST support to s3c-fb driver for better compile
    testing coverage.
    
    Acked-by: Jingoo Han <jingoohan1@gmail.com>
    Signed-off-by: Bartlomiej Zolnierkiewicz <b.zolnierkie@samsung.com>

commit 10715127e4f6f5e0e78f2e6d575e5238a3cc9a1f
Author: Bartlomiej Zolnierkiewicz <b.zolnierkie@samsung.com>
Date:   Fri Jun 21 13:04:38 2019 +0200

    video: fbdev: pvr2fb: fix build warning when compiling as module
    
    Add missing #ifndef MODULE around pvr2_get_param_val().
    
    Fixes: 0f5a5712ad1e ("video: fbdev: pvr2fb: add COMPILE_TEST support")
    Reported-by: Stephen Rothwell <sfr@canb.auug.org.au>
    Signed-off-by: Bartlomiej Zolnierkiewicz <b.zolnierkie@samsung.com>

commit 76e21533a48bb42d1fa894f93f6233bf4554f45e
Author: Fred Klassen <fklassen@appneta.com>
Date:   Mon Jun 17 12:05:07 2019 -0700

    net/udp_gso: Allow TX timestamp with UDP GSO
    
    Fixes an issue where TX Timestamps are not arriving on the error queue
    when UDP_SEGMENT CMSG type is combined with CMSG type SO_TIMESTAMPING.
    This can be illustrated with an updated updgso_bench_tx program which
    includes the '-T' option to test for this condition. It also introduces
    the '-P' option which will call poll() before reading the error queue.
    
        ./udpgso_bench_tx -4ucTPv -S 1472 -l2 -D 172.16.120.18
        poll timeout
        udp tx:      0 MB/s        1 calls/s      1 msg/s
    
    The "poll timeout" message above indicates that TX timestamp never
    arrived.
    
    This patch preserves tx_flags for the first UDP GSO segment. Only the
    first segment is timestamped, even though in some cases there may be
    benefital in timestamping both the first and last segment.
    
    Factors in deciding on first segment timestamp only:
    
    - Timestamping both first and last segmented is not feasible. Hardware
    can only have one outstanding TS request at a time.
    
    - Timestamping last segment may under report network latency of the
    previous segments. Even though the doorbell is suppressed, the ring
    producer counter has been incremented.
    
    - Timestamping the first segment has the upside in that it reports
    timestamps from the application's view, e.g. RTT.
    
    - Timestamping the first segment has the downside that it may
    underreport tx host network latency. It appears that we have to pick
    one or the other. And possibly follow-up with a config flag to choose
    behavior.
    
    v2: Remove tests as noted by Willem de Bruijn <willemb@google.com>
        Moving tests from net to net-next
    
    v3: Update only relevant tx_flag bits as per
        Willem de Bruijn <willemb@google.com>
    
    v4: Update comments and commit message as per
        Willem de Bruijn <willemb@google.com>
    
    Fixes: ee80d1ebe5ba ("udp: add udp gso")
    Signed-off-by: Fred Klassen <fklassen@appneta.com>
    Acked-by: Willem de Bruijn <willemb@google.com>
    Signed-off-by: David S. Miller <davem@davemloft.net>

commit 79ebc3c26010eba3b6eaaad0efdf1f8ec19aaf9d
Author: Fred Klassen <fklassen@appneta.com>
Date:   Mon Jun 17 12:08:35 2019 -0700

    net/udpgso_bench_tx: options to exercise TX CMSG
    
    This enhancement adds options that facilitate load testing with
    additional TX CMSG options, and to optionally print results of
    various send CMSG operations.
    
    These options are especially useful in isolating situations
    where error-queue messages are lost when combined with other
    CMSG operations (e.g. SO_ZEROCOPY).
    
    New options:
        -a - count all CMSG messages and match to sent messages
        -T - add TX CMSG that requests TX software timestamps
        -H - similar to -T except request TX hardware timestamps
        -P - call poll() before reading error queue
        -v - print detailed results
    
    v2: Enhancements as per Willem de Bruijn <willemb@google.com>
        - Updated control and buffer parameters for recvmsg
        - poll() parameter cleanup
        - fail on bad audit results
        - remove TOS options
        - improved reporting
    
    v3: Enhancements as per Willem de Bruijn <willemb@google.com>
        - add SOF_TIMESTAMPING_OPT_TSONLY to eliminate MSG_TRUNC
        - general code cleanup
    
    Signed-off-by: Fred Klassen <fklassen@appneta.com>
    Signed-off-by: David S. Miller <davem@davemloft.net>

commit 9de7eaddfa7f47fbb1cd9cdb9aab405599ef414e
Author: Arnd Bergmann <arnd@arndb.de>
Date:   Mon Jun 17 14:45:49 2019 +0200

    ASoC: SOF: disallow building without CONFIG_PCI again
    
    Compile-testing without PCI just causes warnings:
    
    sound/soc/sof/sof-pci-dev.c:330:13: error: 'sof_pci_remove' defined but not used [-Werror=unused-function]
     static void sof_pci_remove(struct pci_dev *pci)
                 ^~~~~~~~~~~~~~
    sound/soc/sof/sof-pci-dev.c:230:12: error: 'sof_pci_probe' defined but not used [-Werror=unused-function]
     static int sof_pci_probe(struct pci_dev *pci,
                ^~~~~~~~~~~~~
    
    I tried to fix this in a way that would still allow compile
    tests, but it got too ugly, so this just reverts the patch
    that allowed it in the first place.
    
    Most architectures do allow enabling PCI, so the value of the
    COMPILE_TEST alternative was not very high to start with.
    
    Fixes: e13ef82a9ab8 ("ASoC: SOF: add COMPILE_TEST for PCI options")
    Signed-off-by: Arnd Bergmann <arnd@arndb.de>
    Signed-off-by: Mark Brown <broonie@kernel.org>

commit 91d0a48a480a29257e9a787ca73dc62e85bfeb72
Merge: 930cfe0f129d 28c67157e637
Author: David S. Miller <davem@davemloft.net>
Date:   Sat Jun 15 13:43:07 2019 -0700

    Merge branch 'Reuse-ptp_qoriq-driver-for-dpaa2-ptp'
    
    Yangbo Lu says:
    
    ====================
    Reuse ptp_qoriq driver for dpaa2-ptp
    
    Although dpaa2-ptp.c driver is a fsl_mc_driver which
    is using MC APIs for register accessing, it's same IP
    block with eTSEC/DPAA/ENETC 1588 timer.
    This patch-set is to convert to reuse ptp_qoriq driver by
    using register ioremap and dropping related MC APIs.
    However the interrupts could only be handled by MC which
    fires MSIs to ARM cores. So the interrupt enabling and
    handling still rely on MC APIs. MC APIs for interrupt
    and PPS event support are also added by this patch-set.
    
    ---
    Changes for v2:
            - Allowed to compile with COMPILE_TEST.
    ====================
    
    Signed-off-by: David S. Miller <davem@davemloft.net>

commit 8099d7ca6e7b76282fef7565877f5c8f02f8ef4f
Author: Yangbo Lu <yangbo.lu@nxp.com>
Date:   Fri Jun 14 18:40:50 2019 +0800

    ptp: add QorIQ PTP support for DPAA2
    
    This patch is to add QorIQ PTP support for DPAA2.
    Although dpaa2-ptp.c driver is a fsl_mc_driver which
    is using MC APIs for register accessing, it's same
    IP block with eTSEC/DPAA/ENETC 1588 timer. We will
    convert to reuse ptp_qoriq driver by using register
    ioremap and dropping related MC APIs.
    Also allow to compile ptp_qoriq with COMPILE_TEST.
    
    Signed-off-by: Yangbo Lu <yangbo.lu@nxp.com>
    Signed-off-by: David S. Miller <davem@davemloft.net>

commit 6b9d226b8495deff2e1e702f0ad6cdbb228f3b27
Author: Randy Dunlap <rdunlap@infradead.org>
Date:   Fri Jun 14 14:47:48 2019 -0700

    soc: qcom: fix QCOM_AOSS_QMP dependency and build errors
    
    Fix Kconfig warning and subsequent build errors that are caused
    when PM_GENERIC_DOMAINS=y but CONFIG_PM is not set/enabled.
    
    WARNING: unmet direct dependencies detected for PM_GENERIC_DOMAINS
      Depends on [n]: PM [=n]
      Selected by [m]:
      - QCOM_AOSS_QMP [=m] && (ARCH_QCOM || COMPILE_TEST [=y]) && MAILBOX [=y] && COMMON_CLK [=y]
    
    Fixes these build errors:
    
    ../drivers/base/power/domain.c: In function genpd_queue_power_off_work:
    ../drivers/base/power/domain.c:485:13: error: pm_wq undeclared (first use in this function)
      queue_work(pm_wq, &genpd->power_off_work);
    ../drivers/base/power/domain.c:485:13: note: each undeclared identifier is reported only once for each function it appears in
    ../drivers/base/power/domain.c: In function genpd_dev_pm_qos_notifier:
    ../drivers/base/power/domain.c:675:25: error: struct dev_pm_info has no member named ignore_children
       if (!dev || dev->power.ignore_children)
    ../drivers/base/power/domain.c: In function rtpm_status_str:
    ../drivers/base/power/domain.c:2754:16: error: struct dev_pm_info has no member named runtime_error
      if (dev->power.runtime_error)
    ../drivers/base/power/domain.c:2756:21: error: struct dev_pm_info has no member named disable_depth
      else if (dev->power.disable_depth)
    ../drivers/base/power/domain.c:2758:21: error: struct dev_pm_info has no member named runtime_status
      else if (dev->power.runtime_status < ARRAY_SIZE(status_lookup))
    ../drivers/base/power/domain.c:2759:31: error: struct dev_pm_info has no member named runtime_status
       p = status_lookup[dev->power.runtime_status];
    ../drivers/base/power/domain_governor.c: In function default_suspend_ok:
    ../drivers/base/power/domain_governor.c:82:17: error: struct dev_pm_info has no member named ignore_children
    
    Signed-off-by: Randy Dunlap <rdunlap@infradead.org>
    Cc: Bjorn Andersson <bjorn.andersson@sonymobile.com>
    Cc: Bjorn Andersson <bjorn.andersson@linaro.org>
    Cc: Andy Gross <andy.gross@linaro.org>
    Cc: David Brown <david.brown@linaro.org>
    Signed-off-by: Bjorn Andersson <bjorn.andersson@linaro.org>

commit fd6b99fa41ddee9699cff1d0e04e90afa452b24d
Merge: c78ad1be4b4d 50f44ee7248a
Author: Linus Torvalds <torvalds@linux-foundation.org>
Date:   Fri Jun 14 06:08:46 2019 -1000

    Merge branch 'akpm' (patches from Andrew)
    
    Merge misc fixes from Andrew Morton:
     "16 fixes"
    
    * emailed patches from Andrew Morton <akpm@linux-foundation.org>:
      mm/devm_memremap_pages: fix final page put race
      PCI/P2PDMA: track pgmap references per resource, not globally
      lib/genalloc: introduce chunk owners
      PCI/P2PDMA: fix the gen_pool_add_virt() failure path
      mm/devm_memremap_pages: introduce devm_memunmap_pages
      drivers/base/devres: introduce devm_release_action()
      mm/vmscan.c: fix trying to reclaim unevictable LRU page
      coredump: fix race condition between collapse_huge_page() and core dumping
      mm/mlock.c: change count_mm_mlocked_page_nr return type
      mm: mmu_gather: remove __tlb_reset_range() for force flush
      fs/ocfs2: fix race in ocfs2_dentry_attach_lock()
      mm/vmscan.c: fix recent_rotated history
      mm/mlock.c: mlockall error for flag MCL_ONFAULT
      scripts/decode_stacktrace.sh: prefix addr2line with $CROSS_COMPILE
      mm/list_lru.c: fix memory leak in __memcg_init_list_lru_node
      mm: memcontrol: don't batch updates of local VM stats and events

commit bcb46a0e0e5c79291ffbc1e4b5d1d3d119e0f984
Merge: c11fb13a117e 17d304604a88
Author: Linus Torvalds <torvalds@linux-foundation.org>
Date:   Fri Jun 14 05:37:06 2019 -1000

    Merge tag 'sound-5.2-rc5' of git://git.kernel.org/pub/scm/linux/kernel/git/tiwai/sound
    
    Pull sound fixes from Takashi Iwai:
     "It might feel like deja vu to receive a bulk of changes at rc5, and it
      happens again; we've got a collection of fixes for ASoC. Most of fixes
      are targeted for the newly merged SOF (Sound Open Firmware) stuff and
      the relevant fixes for Intel platforms.
    
      Other than that, there are a few regression fixes for the recent ASoC
      core changes and HD-audio quirk, as well as a couple of FireWire fixes
      and for other ASoC codecs"
    
    * tag 'sound-5.2-rc5' of git://git.kernel.org/pub/scm/linux/kernel/git/tiwai/sound: (54 commits)
      Revert "ALSA: hda/realtek - Improve the headset mic for Acer Aspire laptops"
      ALSA: ice1712: Check correct return value to snd_i2c_sendbytes (EWS/DMX 6Fire)
      ALSA: oxfw: allow PCM capture for Stanton SCS.1m
      ALSA: firewire-motu: fix destruction of data for isochronous resources
      ASoC: Intel: sst: fix kmalloc call with wrong flags
      ASoC: core: Fix deadlock in snd_soc_instantiate_card()
      SoC: rt274: Fix internal jack assignment in set_jack callback
      ALSA: hdac: fix memory release for SST and SOF drivers
      ASoC: SOF: Intel: hda: use the defined ppcap functions
      ASoC: core: move DAI pre-links initiation to snd_soc_instantiate_card
      ASoC: Intel: cht_bsw_rt5672: fix kernel oops with platform_name override
      ASoC: Intel: cht_bsw_nau8824: fix kernel oops with platform_name override
      ASoC: Intel: bytcht_es8316: fix kernel oops with platform_name override
      ASoC: Intel: cht_bsw_max98090: fix kernel oops with platform_name override
      ASoC: sun4i-i2s: Add offset to RX channel select
      ASoC: sun4i-i2s: Fix sun8i tx channel offset mask
      ASoC: max98090: remove 24-bit format support if RJ is 0
      ASoC: da7219: Fix build error without CONFIG_I2C
      ASoC: SOF: Intel: hda: Fix COMPILE_TEST build error
      ASoC: SOF: fix DSP oops definitions in FW ABI
      ...

commit c04e32e911653442fc834be6e92e072aeebe01a1
Author: Manuel Traut <manut@linutronix.de>
Date:   Thu Jun 13 15:55:52 2019 -0700

    scripts/decode_stacktrace.sh: prefix addr2line with $CROSS_COMPILE
    
    At least for ARM64 kernels compiled with the crosstoolchain from
    Debian/stretch or with the toolchain from kernel.org the line number is
    not decoded correctly by 'decode_stacktrace.sh':
    
      $ echo "[  136.513051]  f1+0x0/0xc [kcrash]" | \
        CROSS_COMPILE=/opt/gcc-8.1.0-nolibc/aarch64-linux/bin/aarch64-linux- \
       ./scripts/decode_stacktrace.sh /scratch/linux-arm64/vmlinux \
                                      /scratch/linux-arm64 \
                                      /nfs/debian/lib/modules/4.20.0-devel
      [  136.513051] f1 (/linux/drivers/staging/kcrash/kcrash.c:68) kcrash
    
    If addr2line from the toolchain is used the decoded line number is correct:
    
      [  136.513051] f1 (/linux/drivers/staging/kcrash/kcrash.c:57) kcrash
    
    Link: http://lkml.kernel.org/r/20190527083425.3763-1-manut@linutronix.de
    Signed-off-by: Manuel Traut <manut@linutronix.de>
    Acked-by: Konstantin Khlebnikov <khlebnikov@yandex-team.ru>
    Signed-off-by: Andrew Morton <akpm@linux-foundation.org>
    Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>

commit 4419617e0d0cc6f6526439e16f3a880e7d292eaa
Author: Anders Roxell <anders.roxell@linaro.org>
Date:   Wed Jun 12 04:15:43 2019 -0400

    media: drivers: media: i2c: don't enable if CONFIG_DRM_I2C_ADV7511=n
    
    CONFIG_DRM_I2C_ADV7511 and CONFIG_VIDEO_ADV7511 bind to the same
    platform device, so whichever driver gets loaded first will be used on
    the device. So they shouldn't be enabled at the same time.
    
    Rework so that VIDEO_ADV7511 and VIDEO_COBALT depends on
    DRM_I2C_ADV7511=n or COMPILE_TEST.
    
    Suggested-by: Hans Verkuil <hans.verkuil@cisco.com>
    Signed-off-by: Anders Roxell <anders.roxell@linaro.org>
    Signed-off-by: Hans Verkuil <hverkuil-cisco@xs4all.nl>
    Signed-off-by: Mauro Carvalho Chehab <mchehab+samsung@kernel.org>

commit 2bc42bfba9b247abd93991195b71f35a484531d1
Author: Alexey Brodkin <Alexey.Brodkin@synopsys.com>
Date:   Mon Jun 3 09:31:19 2019 +0300

    ARC: build: Try to guess CROSS_COMPILE with cc-cross-prefix
    
    For a long time we used to hard-code CROSS_COMPILE prefix
    for ARC until it started to cause problems, so we decided to
    solely rely on CROSS_COMPILE externally set by a user:
    commit 40660f1fcee8 ("ARC: build: Don't set CROSS_COMPILE in arch's Makefile").
    
    While it works perfectly fine for build-systems where the prefix
    gets defined anyways for us human beings it's quite an annoying
    requirement especially given most of time the same one prefix
    "arc-linux-" is all what we need.
    
    It looks like finally we're getting the best of both worlds:
     1. W/o cross-toolchain we still may install headers, build .dtb etc
     2. W/ cross-toolchain get the kerne built with only ARCH=arc
    
    Inspired by [1] & [2].
    
    [1] http://lists.infradead.org/pipermail/linux-snps-arc/2019-May/005788.html
    [2] https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/commit/?id=fc2b47b55f17
    
    A side note: even though "cc-cross-prefix" does its job it pollutes
    console with output of "which" for all the prefixes it didn't manage to find
    a matching cross-compiler for like that:
    | # ARCH=arc make defconfig
    | which: no arceb-linux-gcc in (~/.local/bin:~/bin:/usr/bin:/usr/sbin)
    | *** Default configuration is based on 'nsim_hs_defconfig'
    
    Suggested-by: Vineet Gupta <vgupta@synopsys.com>
    Reviewed-by: Masahiro Yamada <yamada.masahiro@socionext.com>
    Signed-off-by: Alexey Brodkin <abrodkin@synopsys.com>
    Signed-off-by: Vineet Gupta <vgupta@synopsys.com>

commit 2659417876d58d58ec53a586d174f4fa18cc5352
Author: Fabio Estevam <festevam@gmail.com>
Date:   Wed Jun 5 16:53:33 2019 -0400

    media: Revert "media: staging/imx: Allow driver to build if COMPILE_TEST is enabled"
    
    Commit 020bc7354a6e ("media: staging/imx: Allow driver to build
    if COMPILE_TEST is enabled") incorrectly assumed that the imx media
    driver had no build time dependency with IMX_IPUV3_CORE.
    
    Building on x86_64 without IMX_IPUV3_CORE causes lots of build errors
    such as:
    
    All these definitions come from the imx ipu3 core driver, so make
    sure that imx media depends on IMX_IPUV3_CORE.
    
    This reverts commit 020bc7354a6ebec980e0aedf5bedf57b42f93aca.
    
    Reported-by: Randy Dunlap <rdunlap@infradead.org>
    Signed-off-by: Fabio Estevam <festevam@gmail.com>
    Acked-by: Randy Dunlap <rdunlap@infradead.org>
    Signed-off-by: Hans Verkuil <hverkuil-cisco@xs4all.nl>
    Signed-off-by: Mauro Carvalho Chehab <mchehab+samsung@kernel.org>

commit 0f5a5712ad1e3b8472b1c1459681dadad9277067
Author: Bartlomiej Zolnierkiewicz <b.zolnierkie@samsung.com>
Date:   Fri Jun 7 14:38:07 2019 +0200

    video: fbdev: pvr2fb: add COMPILE_TEST support
    
    Add COMPILE_TEST support to pvr2fb driver for better compile
    testing coverage.
    
    While at it:
    
    - mark pvr2fb_interrupt() and pvr2fb_common_init() with
      __maybe_unused tag (to silence build warnings when
      !SH_DREAMCAST)
    
    - convert mmio_base in struct pvr2fb_par to 'void __iomem *'
      from 'unsigned long' (needed to silence build warnings on
      ARM).
    
    - split pvr2_get_param() on pvr2_get_param_name() and
      pvr2_get_param_val() (needed to silence build warnings on
      x86).
    
    Signed-off-by: Bartlomiej Zolnierkiewicz <b.zolnierkie@samsung.com>

commit 767ceabc6cc6c9deec436bdeb1d16569c85afa2f
Author: Bartlomiej Zolnierkiewicz <b.zolnierkie@samsung.com>
Date:   Fri Jun 7 14:38:07 2019 +0200

    video: fbdev: da8xx-fb: add COMPILE_TEST support
    
    Add COMPILE_TEST support to da8xx-fb driver for better compile
    testing coverage.
    
    Signed-off-by: Bartlomiej Zolnierkiewicz <b.zolnierkie@samsung.com>

commit 552ccf6b259d290c0c8a149de8c114a818aa7edc
Author: Bartlomiej Zolnierkiewicz <b.zolnierkie@samsung.com>
Date:   Fri Jun 7 14:38:07 2019 +0200

    video: fbdev: gbefb: add COMPILE_TEST support
    
    Add COMPILE_TEST support to gbefb driver for better compile
    testing coverage.
    
    While at it convert bogus udelay() calls to mdelay() (needed to
    build driver on ARM) and remove dead x86 specific code.
    
    Signed-off-by: Bartlomiej Zolnierkiewicz <b.zolnierkie@samsung.com>

commit f0bab2e3f67507e5ed2458cb842ddedd1b39ab0a
Author: Bartlomiej Zolnierkiewicz <b.zolnierkie@samsung.com>
Date:   Fri Jun 7 14:38:06 2019 +0200

    video: fbdev: pxa168fb: add COMPILE_TEST support
    
    Add COMPILE_TEST support to pxa168fb driver for better compile
    testing coverage.
    
    Signed-off-by: Bartlomiej Zolnierkiewicz <b.zolnierkie@samsung.com>

commit b90b279e87a3cbc55b6976554dc432afdf670124
Author: Bartlomiej Zolnierkiewicz <b.zolnierkie@samsung.com>
Date:   Fri Jun 7 14:38:06 2019 +0200

    video: fbdev: imxfb: add COMPILE_TEST support
    
    Add COMPILE_TEST support to imxfb driver for better compile
    testing coverage.
    
    Cc: Shawn Guo <shawnguo@kernel.org>
    Cc: Sascha Hauer <s.hauer@pengutronix.de>
    Cc: Pengutronix Kernel Team <kernel@pengutronix.de>
    Cc: Fabio Estevam <festevam@gmail.com>
    Cc: Uwe Kleine-Knig <u.kleine-koenig@pengutronix.de>
    Cc: NXP Linux Team <linux-imx@nxp.com>
    Signed-off-by: Bartlomiej Zolnierkiewicz <b.zolnierkie@samsung.com>

commit 59c1ad914ef2d3470f74c626ece9521dbc9645a3
Author: Bartlomiej Zolnierkiewicz <b.zolnierkie@samsung.com>
Date:   Fri Jun 7 14:38:06 2019 +0200

    video: fbdev: atmel_lcdfb: add COMPILE_TEST support
    
    Add COMPILE_TEST support to atmel_lcdfb driver for better compile
    testing coverage.
    
    While at it fix improper use of UL (to silence build warnings on
    x86_64).
    
    Cc: Ludovic Desroches <ludovic.desroches@microchip.com>
    Acked-by: Alexandre Belloni <alexandre.belloni@bootlin.com>
    Signed-off-by: Bartlomiej Zolnierkiewicz <b.zolnierkie@samsung.com>

commit ad169f9f0dbb531cd68db921b351ccafcf684ae4
Author: YueHaibing <yuehaibing@huawei.com>
Date:   Fri May 31 22:25:26 2019 +0800

    ASoC: SOF: Intel: hda: Fix COMPILE_TEST build error
    
    while building without PCI:
    
    sound/soc/sof/intel/hda.o: In function `hda_dsp_probe':
    hda.c:(.text+0x79c): undefined reference to `pci_ioremap_bar'
    hda.c:(.text+0x79c): relocation truncated to fit: R_AARCH64_CALL26 against undefined symbol `pci_ioremap_bar'
    hda.c:(.text+0x7c4): undefined reference to `pci_ioremap_bar'
    hda.c:(.text+0x7c4): relocation truncated to fit: R_AARCH64_CALL26 against undefined symbol `pci_ioremap_bar'
    
    Reported-by: Hulk Robot <hulkci@huawei.com>
    Fixes: e13ef82a9ab8 ("ASoC: SOF: add COMPILE_TEST for PCI options")
    Signed-off-by: YueHaibing <yuehaibing@huawei.com>
    Acked-by: Pierre-Louis Bossart <pierre-louis.bossart@linux.intel.com>
    Signed-off-by: Mark Brown <broonie@kernel.org>

commit 91435fce9b24c15ce15b736a8a96db61d9564943
Author: Arnd Bergmann <arnd@arndb.de>
Date:   Tue Mar 5 08:29:48 2019 -0500

    media: staging: davinci_vpfe: disallow building with COMPILE_TEST
    
    [ Upstream commit 49dc762cffd8305a861ca649e82dc5533b3e3344 ]
    
    The driver should really call dm365_isif_setup_pinmux() through a callback,
    but uses a hack to include a davinci specific machine header file when
    compile testing instead. This works almost everywhere, but not on the
    ARM omap1 platform, which has another header named mach/mux.h. This
    causes a build failure:
    
    drivers/staging/media/davinci_vpfe/dm365_isif.c:2028:2: error: implicit declaration of function 'davinci_cfg_reg' [-Werror,-Wimplicit-function-declaration]
            davinci_cfg_reg(DM365_VIN_CAM_WEN);
            ^
    drivers/staging/media/davinci_vpfe/dm365_isif.c:2028:2: error: this function declaration is not a prototype [-Werror,-Wstrict-prototypes]
    drivers/staging/media/davinci_vpfe/dm365_isif.c:2028:18: error: use of undeclared identifier 'DM365_VIN_CAM_WEN'
            davinci_cfg_reg(DM365_VIN_CAM_WEN);
                            ^
    drivers/staging/media/davinci_vpfe/dm365_isif.c:2029:18: error: use of undeclared identifier 'DM365_VIN_CAM_VD'
            davinci_cfg_reg(DM365_VIN_CAM_VD);
                            ^
    drivers/staging/media/davinci_vpfe/dm365_isif.c:2030:18: error: use of undeclared identifier 'DM365_VIN_CAM_HD'
            davinci_cfg_reg(DM365_VIN_CAM_HD);
                            ^
    drivers/staging/media/davinci_vpfe/dm365_isif.c:2031:18: error: use of undeclared identifier 'DM365_VIN_YIN4_7_EN'
            davinci_cfg_reg(DM365_VIN_YIN4_7_EN);
                            ^
    drivers/staging/media/davinci_vpfe/dm365_isif.c:2032:18: error: use of undeclared identifier 'DM365_VIN_YIN0_3_EN'
            davinci_cfg_reg(DM365_VIN_YIN0_3_EN);
                            ^
    7 errors generated.
    
    Exclude omap1 from compile-testing, under the assumption that all others
    still work.
    
    Fixes: 4907c73deefe ("media: staging: davinci_vpfe: allow building with COMPILE_TEST")
    
    Signed-off-by: Arnd Bergmann <arnd@arndb.de>
    Signed-off-by: Hans Verkuil <hverkuil-cisco@xs4all.nl>
    Signed-off-by: Mauro Carvalho Chehab <mchehab+samsung@kernel.org>
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit 30f8da71c730491046836d50de4bdc5891eff57a
Author: Fabrice Gasnier <fabrice.gasnier@st.com>
Date:   Mon Apr 15 15:00:50 2019 +0200

    iio: adc: stm32-dfsdm: fix unmet direct dependencies detected
    
    [ Upstream commit ba7ecfe43d6bf12e2aa76705c45f7d187ae3d7c0 ]
    
    This fixes unmet direct dependencies seen when CONFIG_STM32_DFSDM_ADC
    is selected:
    
    WARNING: unmet direct dependencies detected for IIO_BUFFER_HW_CONSUMER
      Depends on [n]: IIO [=y] && IIO_BUFFER [=n]
      Selected by [y]:
      - STM32_DFSDM_ADC [=y] && IIO [=y] && (ARCH_STM32 [=y] && OF [=y] ||
        COMPILE_TEST [=n])
    
    Fixes: e2e6771c6462 ("IIO: ADC: add STM32 DFSDM sigma delta ADC support")
    
    Signed-off-by: Fabrice Gasnier <fabrice.gasnier@st.com>
    Signed-off-by: Jonathan Cameron <Jonathan.Cameron@huawei.com>
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit 12eb14776b3ac23874dc80f4cd87d06eb2dd0e99
Author: Arnd Bergmann <arnd@arndb.de>
Date:   Tue Mar 5 08:29:48 2019 -0500

    media: staging: davinci_vpfe: disallow building with COMPILE_TEST
    
    [ Upstream commit 49dc762cffd8305a861ca649e82dc5533b3e3344 ]
    
    The driver should really call dm365_isif_setup_pinmux() through a callback,
    but uses a hack to include a davinci specific machine header file when
    compile testing instead. This works almost everywhere, but not on the
    ARM omap1 platform, which has another header named mach/mux.h. This
    causes a build failure:
    
    drivers/staging/media/davinci_vpfe/dm365_isif.c:2028:2: error: implicit declaration of function 'davinci_cfg_reg' [-Werror,-Wimplicit-function-declaration]
            davinci_cfg_reg(DM365_VIN_CAM_WEN);
            ^
    drivers/staging/media/davinci_vpfe/dm365_isif.c:2028:2: error: this function declaration is not a prototype [-Werror,-Wstrict-prototypes]
    drivers/staging/media/davinci_vpfe/dm365_isif.c:2028:18: error: use of undeclared identifier 'DM365_VIN_CAM_WEN'
            davinci_cfg_reg(DM365_VIN_CAM_WEN);
                            ^
    drivers/staging/media/davinci_vpfe/dm365_isif.c:2029:18: error: use of undeclared identifier 'DM365_VIN_CAM_VD'
            davinci_cfg_reg(DM365_VIN_CAM_VD);
                            ^
    drivers/staging/media/davinci_vpfe/dm365_isif.c:2030:18: error: use of undeclared identifier 'DM365_VIN_CAM_HD'
            davinci_cfg_reg(DM365_VIN_CAM_HD);
                            ^
    drivers/staging/media/davinci_vpfe/dm365_isif.c:2031:18: error: use of undeclared identifier 'DM365_VIN_YIN4_7_EN'
            davinci_cfg_reg(DM365_VIN_YIN4_7_EN);
                            ^
    drivers/staging/media/davinci_vpfe/dm365_isif.c:2032:18: error: use of undeclared identifier 'DM365_VIN_YIN0_3_EN'
            davinci_cfg_reg(DM365_VIN_YIN0_3_EN);
                            ^
    7 errors generated.
    
    Exclude omap1 from compile-testing, under the assumption that all others
    still work.
    
    Fixes: 4907c73deefe ("media: staging: davinci_vpfe: allow building with COMPILE_TEST")
    
    Signed-off-by: Arnd Bergmann <arnd@arndb.de>
    Signed-off-by: Hans Verkuil <hverkuil-cisco@xs4all.nl>
    Signed-off-by: Mauro Carvalho Chehab <mchehab+samsung@kernel.org>
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit 15e048afc5a6f677e755bcbe25bd75bde8730061
Author: Fabrice Gasnier <fabrice.gasnier@st.com>
Date:   Mon Apr 15 15:00:50 2019 +0200

    iio: adc: stm32-dfsdm: fix unmet direct dependencies detected
    
    [ Upstream commit ba7ecfe43d6bf12e2aa76705c45f7d187ae3d7c0 ]
    
    This fixes unmet direct dependencies seen when CONFIG_STM32_DFSDM_ADC
    is selected:
    
    WARNING: unmet direct dependencies detected for IIO_BUFFER_HW_CONSUMER
      Depends on [n]: IIO [=y] && IIO_BUFFER [=n]
      Selected by [y]:
      - STM32_DFSDM_ADC [=y] && IIO [=y] && (ARCH_STM32 [=y] && OF [=y] ||
        COMPILE_TEST [=n])
    
    Fixes: e2e6771c6462 ("IIO: ADC: add STM32 DFSDM sigma delta ADC support")
    
    Signed-off-by: Fabrice Gasnier <fabrice.gasnier@st.com>
    Signed-off-by: Jonathan Cameron <Jonathan.Cameron@huawei.com>
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit 8f9123dc0d149753b3ef04ecbb6bbfb272c01d4e
Author: Arnd Bergmann <arnd@arndb.de>
Date:   Tue Mar 5 08:29:48 2019 -0500

    media: staging: davinci_vpfe: disallow building with COMPILE_TEST
    
    [ Upstream commit 49dc762cffd8305a861ca649e82dc5533b3e3344 ]
    
    The driver should really call dm365_isif_setup_pinmux() through a callback,
    but uses a hack to include a davinci specific machine header file when
    compile testing instead. This works almost everywhere, but not on the
    ARM omap1 platform, which has another header named mach/mux.h. This
    causes a build failure:
    
    drivers/staging/media/davinci_vpfe/dm365_isif.c:2028:2: error: implicit declaration of function 'davinci_cfg_reg' [-Werror,-Wimplicit-function-declaration]
            davinci_cfg_reg(DM365_VIN_CAM_WEN);
            ^
    drivers/staging/media/davinci_vpfe/dm365_isif.c:2028:2: error: this function declaration is not a prototype [-Werror,-Wstrict-prototypes]
    drivers/staging/media/davinci_vpfe/dm365_isif.c:2028:18: error: use of undeclared identifier 'DM365_VIN_CAM_WEN'
            davinci_cfg_reg(DM365_VIN_CAM_WEN);
                            ^
    drivers/staging/media/davinci_vpfe/dm365_isif.c:2029:18: error: use of undeclared identifier 'DM365_VIN_CAM_VD'
            davinci_cfg_reg(DM365_VIN_CAM_VD);
                            ^
    drivers/staging/media/davinci_vpfe/dm365_isif.c:2030:18: error: use of undeclared identifier 'DM365_VIN_CAM_HD'
            davinci_cfg_reg(DM365_VIN_CAM_HD);
                            ^
    drivers/staging/media/davinci_vpfe/dm365_isif.c:2031:18: error: use of undeclared identifier 'DM365_VIN_YIN4_7_EN'
            davinci_cfg_reg(DM365_VIN_YIN4_7_EN);
                            ^
    drivers/staging/media/davinci_vpfe/dm365_isif.c:2032:18: error: use of undeclared identifier 'DM365_VIN_YIN0_3_EN'
            davinci_cfg_reg(DM365_VIN_YIN0_3_EN);
                            ^
    7 errors generated.
    
    Exclude omap1 from compile-testing, under the assumption that all others
    still work.
    
    Fixes: 4907c73deefe ("media: staging: davinci_vpfe: allow building with COMPILE_TEST")
    
    Signed-off-by: Arnd Bergmann <arnd@arndb.de>
    Signed-off-by: Hans Verkuil <hverkuil-cisco@xs4all.nl>
    Signed-off-by: Mauro Carvalho Chehab <mchehab+samsung@kernel.org>
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit 3404d705d04133f3efff06da6724b93406964bd6
Author: Fabrice Gasnier <fabrice.gasnier@st.com>
Date:   Mon Apr 15 15:00:50 2019 +0200

    iio: adc: stm32-dfsdm: fix unmet direct dependencies detected
    
    [ Upstream commit ba7ecfe43d6bf12e2aa76705c45f7d187ae3d7c0 ]
    
    This fixes unmet direct dependencies seen when CONFIG_STM32_DFSDM_ADC
    is selected:
    
    WARNING: unmet direct dependencies detected for IIO_BUFFER_HW_CONSUMER
      Depends on [n]: IIO [=y] && IIO_BUFFER [=n]
      Selected by [y]:
      - STM32_DFSDM_ADC [=y] && IIO [=y] && (ARCH_STM32 [=y] && OF [=y] ||
        COMPILE_TEST [=n])
    
    Fixes: e2e6771c6462 ("IIO: ADC: add STM32 DFSDM sigma delta ADC support")
    
    Signed-off-by: Fabrice Gasnier <fabrice.gasnier@st.com>
    Signed-off-by: Jonathan Cameron <Jonathan.Cameron@huawei.com>
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit e13ef82a9ab83dd21d8dd43ef9f5e8bf5b101106
Author: Pierre-Louis Bossart <pierre-louis.bossart@linux.intel.com>
Date:   Thu May 30 06:50:15 2019 -0500

    ASoC: SOF: add COMPILE_TEST for PCI options
    
    Add COMPILE_TEST and use IS_ENABLED(CONFIG_PCI) to sort out
    cross-compilation issues.
    
    Signed-off-by: Pierre-Louis Bossart <pierre-louis.bossart@linux.intel.com>
    Signed-off-by: Mark Brown <broonie@kernel.org>

commit 8fe751d8fd5cbf19e9d7852c5b7d8ed818be1934
Author: Pierre-Louis Bossart <pierre-louis.bossart@linux.intel.com>
Date:   Thu May 30 06:50:14 2019 -0500

    ASoC: Intel: boards: Add COMPILE_TEST for new machine drivers
    
    We recently added COMPILE_TEST but new machine drivers were not
    updated. Fix.
    
    Signed-off-by: Pierre-Louis Bossart <pierre-louis.bossart@linux.intel.com>
    Signed-off-by: Mark Brown <broonie@kernel.org>

commit 536cfd2f375d36f4316c0b93bb9e0eaf78e0ef6c
Author: Pierre-Louis Bossart <pierre-louis.bossart@linux.intel.com>
Date:   Thu May 30 06:50:11 2019 -0500

    ASoC: Intel: use common helpers to detect CPUs
    
    We have duplicated code in multiple locations (atom, machine drivers,
    SOF) to detect Baytrail, Cherrytrail and other SOCs. This is not very
    elegant, and introduces dependencies on CONFIG_X86 that prevent
    COMPILE_TEST from working.
    
    Add common helpers to provide same functionality in a cleaner
    way. This will also help support the DMI-based quirks being introduced
    to handle SOF/SST autodetection.
    
    Reviewed-by: Takashi Iwai <tiwai@suse.de>
    Signed-off-by: Pierre-Louis Bossart <pierre-louis.bossart@linux.intel.com>
    Signed-off-by: Mark Brown <broonie@kernel.org>

commit ff455ad9a7f850daf874114e8d38c04aab9f39a2
Author: Herbert Xu <herbert@gondor.apana.org.au>
Date:   Thu May 23 14:35:30 2019 +0800

    crypto: ixp4xx - Fix cross-compile errors due to type mismatch
    
    This patch changes multiple uses of u32s to dma_addr_t where the
    physical address is used.  This fixes COMPILE_TEST errors on 64-bit
    platforms.
    
    Signed-off-by: Herbert Xu <herbert@gondor.apana.org.au>

commit 5a433fccafc73e1361f65c4423b0099bbd18f67f
Author: Mauro Carvalho Chehab <mchehab+samsung@kernel.org>
Date:   Wed May 29 09:43:02 2019 -0400

    media: staging: allegro: cleanup two warnings
    
    Sparse complains about two issues when building with i386
    and COMPILE_TEST:
    
            drivers/staging/media/allegro-dvt/allegro-core.c:1849:36: warning: constant 0xffffffff00000000UL is so big it is unsigned long long
            drivers/staging/media/allegro-dvt/allegro-core.c:865:24: error: incompatible types in comparison expression (different type sizes)
    
    Signed-off-by: Mauro Carvalho Chehab <mchehab+samsung@kernel.org>

commit 020bc7354a6ebec980e0aedf5bedf57b42f93aca
Author: Javier Martinez Canillas <javierm@redhat.com>
Date:   Tue Feb 19 04:01:04 2019 -0500

    media: staging/imx: Allow driver to build if COMPILE_TEST is enabled
    
    The driver has runtime but no build time dependency with IMX_IPUV3_CORE,
    so can be built for testing purposes if COMPILE_TEST option is enabled.
    
    This is useful to have more build coverage and make sure that the driver
    is not affected by changes that could cause build regressions.
    
    Signed-off-by: Javier Martinez Canillas <javierm@redhat.com>
    Signed-off-by: Mauro Carvalho Chehab <mchehab+samsung@kernel.org>

commit f7df8c92b4b90a891972fb782b3eaac836efa601
Author: Paul Walmsley <paul.walmsley@sifive.com>
Date:   Mon May 13 14:30:04 2019 -0700

    clk: sifive: restrict Kconfig scope for the FU540 PRCI driver
    
    Restrict Kconfig scope for SiFive clock and reset IP block drivers
    such that they won't appear on most configurations that are unlikely
    to support them.  This is based on a suggestion from Pavel Machek
    <pavel@ucw.cz>.  Ideally this should be dependent on
    CONFIG_ARCH_SIFIVE, but since that Kconfig directive does not yet
    exist, add dependencies on RISCV or COMPILE_TEST for now.
    
    Signed-off-by: Paul Walmsley <paul.walmsley@sifive.com>
    Signed-off-by: Paul Walmsley <paul@pwsan.com>
    Reported-by: Pavel Machek <pavel@ucw.cz>
    Cc: Michael Turquette <mturquette@baylibre.com>
    Acked-by: Pavel Machek <pavel@ucw.cz>
    Signed-off-by: Stephen Boyd <sboyd@kernel.org>

commit a13f950ef13ff1eaf2ce14f5462ca59c4b60fdd0
Merge: d9351ea14ddc ea7a5f90f103
Author: Linus Torvalds <torvalds@linux-foundation.org>
Date:   Sun May 19 11:11:20 2019 -0700

    Merge branch 'timers-urgent-for-linus' of git://git.kernel.org/pub/scm/linux/kernel/git/tip/tip
    
    Pull clocksource updates from Ingo Molnar:
     "Misc clocksource/clockevent driver updates that came in a bit late but
      are ready for v5.2"
    
    * 'timers-urgent-for-linus' of git://git.kernel.org/pub/scm/linux/kernel/git/tip/tip:
      misc: atmel_tclib: Do not probe already used TCBs
      clocksource/drivers/timer-atmel-tcb: Convert tc_clksrc_suspend|resume() to static
      clocksource/drivers/tcb_clksrc: Rename the file for consistency
      clocksource/drivers/timer-atmel-pit: Rework Kconfig option
      clocksource/drivers/tcb_clksrc: Move Kconfig option
      ARM: at91: Implement clocksource selection
      clocksource/drivers/tcb_clksrc: Use tcb as sched_clock
      clocksource/drivers/tcb_clksrc: Stop depending on atmel_tclib
      ARM: at91: move SoC specific definitions to SoC folder
      clocksource/drivers/timer-milbeaut: Cleanup common register accesses
      clocksource/drivers/timer-milbeaut: Add shutdown function
      clocksource/drivers/timer-milbeaut: Fix to enable one-shot timer
      clocksource/drivers/tegra: Rework for compensation of suspend time
      clocksource/drivers/sp804: Add COMPILE_TEST to CONFIG_ARM_TIMER_SP804
      clocksource/drivers/sun4i: Add a compatible for suniv
      dt-bindings: timer: Add Allwinner suniv timer

commit 902a6898bfb4878eb186d9223d12c903a5f60fa5
Author: Masahiro Yamada <yamada.masahiro@socionext.com>
Date:   Thu May 9 16:35:55 2019 +0900

    kbuild: terminate Kconfig when $(CC) or $(LD) is missing
    
    If the compiler specified by $(CC) is not present, the Kconfig stage
    sprinkles 'not found' messages, then succeeds.
    
      $ make CROSS_COMPILE=foo defconfig
      /bin/sh: 1: foogcc: not found
      /bin/sh: 1: foogcc: not found
      *** Default configuration is based on 'x86_64_defconfig'
      ./scripts/gcc-version.sh: 17: ./scripts/gcc-version.sh: foogcc: not found
      ./scripts/gcc-version.sh: 18: ./scripts/gcc-version.sh: foogcc: not found
      ./scripts/gcc-version.sh: 19: ./scripts/gcc-version.sh: foogcc: not found
      ./scripts/gcc-version.sh: 17: ./scripts/gcc-version.sh: foogcc: not found
      ./scripts/gcc-version.sh: 18: ./scripts/gcc-version.sh: foogcc: not found
      ./scripts/gcc-version.sh: 19: ./scripts/gcc-version.sh: foogcc: not found
      ./scripts/clang-version.sh: 11: ./scripts/clang-version.sh: foogcc: not found
      ./scripts/gcc-plugin.sh: 11: ./scripts/gcc-plugin.sh: foogcc: not found
      init/Kconfig:16:warning: 'GCC_VERSION': number is invalid
      #
      # configuration written to .config
      #
    
    Terminate parsing files immediately if $(CC) or $(LD) is not found.
    "make *config" will fail more nicely.
    
      $ make CROSS_COMPILE=foo defconfig
      *** Default configuration is based on 'x86_64_defconfig'
      scripts/Kconfig.include:34: compiler 'foogcc' not found
      make[1]: *** [scripts/kconfig/Makefile;82: defconfig] Error 1
      make: *** [Makefile;557: defconfig] Error 2
    
    Signed-off-by: Masahiro Yamada <yamada.masahiro@socionext.com>

commit ea7a5f90f103591f1f38dede52e731ec95ef3c55
Merge: 13e792a19d4e 8c9374068ef6
Author: Thomas Gleixner <tglx@linutronix.de>
Date:   Fri May 17 15:48:06 2019 +0200

    Merge tag 'timers-v5.2' of http://git.linaro.org/people/daniel.lezcano/linux into timers/core
    
    Pull clockevent updates from Daniel Lezcano:
    
     - Add compatible string for suniv for sun4i (Mesih Kilinc)
    
     - Add COMPILE_TEST option for sp804 (David Abdurachmanov)
    
     - Replace the compensation time when suspend happens on tegra with the one
       provided by the generic framework (Joseph Lo)
    
     - Cleanup, shutdown and oneshot mode fix on milbeaut timer (Sugaya Taichi)
    
     - Atmel TCB rework to fix boot failure on boards without PIT or misfunction
       on system using a preempt-rt kernel (Alexandre Belloni)

commit c011d23ba046826ccf8c4a4a6c1d01c9ccaa1403
Author: Paolo Bonzini <pbonzini@redhat.com>
Date:   Fri May 17 14:08:53 2019 +0200

    kvm: fix compilation on aarch64
    
    Commit e45adf665a53 ("KVM: Introduce a new guest mapping API", 2019-01-31)
    introduced a build failure on aarch64 defconfig:
    
    $ make -j$(nproc) ARCH=arm64 CROSS_COMPILE=aarch64-linux-gnu- O=out defconfig \
                    Image.gz
    ...
    ../arch/arm64/kvm/../../../virt/kvm/kvm_main.c:
        In function '__kvm_map_gfn':
    ../arch/arm64/kvm/../../../virt/kvm/kvm_main.c:1763:9: error:
        implicit declaration of function 'memremap'; did you mean 'memset_p'?
    ../arch/arm64/kvm/../../../virt/kvm/kvm_main.c:1763:46: error:
        'MEMREMAP_WB' undeclared (first use in this function)
    ../arch/arm64/kvm/../../../virt/kvm/kvm_main.c:
        In function 'kvm_vcpu_unmap':
    ../arch/arm64/kvm/../../../virt/kvm/kvm_main.c:1795:3: error:
        implicit declaration of function 'memunmap'; did you mean 'vm_munmap'?
    
    because these functions are declared in <linux/io.h> rather than <asm/io.h>,
    and the former was being pulled in already on x86 but not on aarch64.
    
    Reported-by: Nathan Chancellor <natechancellor@gmail.com>
    Signed-off-by: Paolo Bonzini <pbonzini@redhat.com>

commit e56aeab565e2d5e82cef892ed34ef9cbef4fd15e
Author: Alistair Strachan <astrachan@google.com>
Date:   Fri Aug 3 10:39:31 2018 -0700

    x86: vdso: Use $LD instead of $CC to link
    
    commit 379d98ddf41344273d9718556f761420f4dc80b3 upstream.
    
    The vdso{32,64}.so can fail to link with CC=clang when clang tries to find
    a suitable GCC toolchain to link these libraries with.
    
    /usr/bin/ld: arch/x86/entry/vdso/vclock_gettime.o:
      access beyond end of merged section (782)
    
    This happens because the host environment leaked into the cross compiler
    environment due to the way clang searches for suitable GCC toolchains.
    
    Clang is a retargetable compiler, and each invocation of it must provide
    --target=<something> --gcc-toolchain=<something> to allow it to find the
    correct binutils for cross compilation. These flags had been added to
    KBUILD_CFLAGS, but the vdso code uses CC and not KBUILD_CFLAGS (for various
    reasons) which breaks clang's ability to find the correct linker when cross
    compiling.
    
    Most of the time this goes unnoticed because the host linker is new enough
    to work anyway, or is incompatible and skipped, but this cannot be reliably
    assumed.
    
    This change alters the vdso makefile to just use LD directly, which
    bypasses clang and thus the searching problem. The makefile will just use
    ${CROSS_COMPILE}ld instead, which is always what we want. This matches the
    method used to link vmlinux.
    
    This drops references to DISABLE_LTO; this option doesn't seem to be set
    anywhere, and not knowing what its possible values are, it's not clear how
    to convert it from CC to LD flag.
    
    Signed-off-by: Alistair Strachan <astrachan@google.com>
    Signed-off-by: Thomas Gleixner <tglx@linutronix.de>
    Acked-by: Andy Lutomirski <luto@kernel.org>
    Cc: "H. Peter Anvin" <hpa@zytor.com>
    Cc: Greg Kroah-Hartman <gregkh@linuxfoundation.org>
    Cc: kernel-team@android.com
    Cc: joel@joelfernandes.org
    Cc: Andi Kleen <andi.kleen@intel.com>
    Link: https://lkml.kernel.org/r/20180803173931.117515-1-astrachan@google.com
    Signed-off-by: Nathan Chancellor <natechancellor@gmail.com>
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit 6a2abf951ed3970db129bf060863662121d4784f
Author: Jacky Bai <ping.bai@nxp.com>
Date:   Fri Apr 5 10:31:09 2019 -0700

    Input: snvs_pwrkey - make it depend on ARCH_MXC
    
    [ Upstream commit f06eba72274788db6a43012a05a99915c0283aef ]
    
    The SNVS power key is not only used on i.MX6SX and i.MX7D, it is also
    used by i.MX6UL and NXP's latest ARMv8 based i.MX8M series SOC. So
    update the config dependency to use ARCH_MXC, and add the COMPILE_TEST
    too.
    
    Signed-off-by: Jacky Bai <ping.bai@nxp.com>
    Reviewed-by: Dong Aisheng <aisheng.dong@nxp.com>
    Signed-off-by: Dmitry Torokhov <dmitry.torokhov@gmail.com>
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit 6ec8070b9d48294fbe865535c167a79527eaf357
Author: Talel Shenhar <talel@amazon.com>
Date:   Mon Apr 29 12:47:36 2019 +0300

    thermal: Fix build error of missing devm_ioremap_resource on UM
    
    The devres.o gets linked if HAS_IOMEM is present so on ARCH=um
    allyesconfig (COMPILE_TEST) failed on many files with:
    
    drivers/thermal/thermal_mmio.o:
    In function 'thermal_mmio_probe':thermal_mmio.c:(.text+0xe1):
    undefined reference to `devm_ioremap_resource'
    
    The users of devm_ioremap_resource() which are compile-testable
    should depend on HAS_IOMEM.
    
    Reported-by: kbuild test robot <lkp@intel.com>
    Signed-off-by: Talel Shenhar <talel@amazon.com>
    Signed-off-by: Eduardo Valentin <edubezval@gmail.com>

commit 8ca6ff16de55085e600c75afc946862a46472127
Author: Arnd Bergmann <arnd@arndb.de>
Date:   Tue Apr 16 14:24:59 2019 +0200

    mfd: sun6i-prcm: Fix build warning for non-OF configurations
    
    When CONFIG_OF is disabled, we get a harmless warning about an
    unused variable:
    
    drivers/mfd/sun6i-prcm.c: In function 'sun6i_prcm_probe':
    drivers/mfd/sun6i-prcm.c:151:22: error: unused variable 'np' [-Werror=unused-variable]
    
    Remove the variable and open-code the value in the only place
    it is used, so it can get left out as well without CONFIG_OF.
    
    Fixes: a05a2e7998ab ("mfd: sun6i-prcm: Allow to compile with COMPILE_TEST")
    Signed-off-by: Arnd Bergmann <arnd@arndb.de>
    Acked-by: Maxime Ripard <maxime.ripard@bootlin.com>
    Signed-off-by: Lee Jones <lee.jones@linaro.org>

commit 4c88519133bdd802fb0df4707b5a8c066af7154d
Author: Randy Dunlap <rdunlap@infradead.org>
Date:   Mon May 6 12:01:40 2019 -0700

    ASoC: sound/soc/sof/: fix kconfig dependency warning
    
    Fix kconfig warning for unmet dependency for IOSF_MBI when
    PCI is not set/enabled.  Fixes this warning:
    
    WARNING: unmet direct dependencies detected for IOSF_MBI
      Depends on [n]: PCI [=n]
      Selected by [y]:
      - SND_SOC_SOF_ACPI [=y] && SOUND [=y] && !UML && SND [=y] && SND_SOC [=y] && SND_SOC_SOF_TOPLEVEL [=y] && (ACPI [=y] || COMPILE_TEST [=n]) && X86 [=y]
    
    Signed-off-by: Randy Dunlap <rdunlap@infradead.org>
    Cc: Liam Girdwood <lgirdwood@gmail.com>
    Cc: Mark Brown <broonie@kernel.org>
    Cc: alsa-devel@alsa-project.org
    Acked-by: Pierre-Louis Bossart <pierre-louis.bossart@linux.intel.com>
    Signed-off-by: Mark Brown <broonie@kernel.org>

commit 345f16251063bcef5828f17fe90aa7f7a5019aab
Author: Guenter Roeck <linux@roeck-us.net>
Date:   Mon Apr 29 12:28:31 2019 -0700

    watchdog: Improve Kconfig entry ordering and dependencies
    
    HPWDT_NMI_DECODING depends on HP_WATCHDOG and should be next to it.
    This helps menuconfig identify HPWDT_NMI_DECODING as depending on
    HP_WATCHDOG.
    
    BCM_KONA_WDT_DEBUG depends on BCM_KONA_WDT which depends on COMPILE_TEST.
    Enabling BCM_KONA_WDT_DEBUG without BCM_KONA_WDT does not make sense,
    so drop the COMPILE_TEST dependency from it. This also improves
    menuconfig, which now properly associates BCM_KONA_WDT_DEBUG with
    BCM_KONA_WDT.
    
    Signed-off-by: Guenter Roeck <linux@roeck-us.net>
    Signed-off-by: Wim Van Sebroeck <wim@linux-watchdog.org>

commit 9a5795520b91e1ccba3cb581b67e1c1280dec734
Author: Sreekanth Reddy <sreekanth.reddy@broadcom.com>
Date:   Mon Mar 4 07:26:35 2019 -0500

    scsi: mpt3sas: Fix kernel panic during expander reset
    
    [ Upstream commit c2fe742ff6e77c5b4fe4ad273191ddf28fdea25e ]
    
    During expander reset handling, the driver invokes kernel function
    scsi_host_find_tag() to obtain outstanding requests associated with the
    scsi host managed by the driver. Driver loops from tag value zero to hba
    queue depth to obtain the outstanding scmds. But when blk-mq is enabled,
    the block layer may return stale entry for one or more requests. This may
    lead to kernel panic if the returned value is inaccessible or the memory
    pointed by the returned value is reused.
    
    Reference of upstream discussion:
    
            https://patchwork.kernel.org/patch/10734933/
    
    Instead of calling scsi_host_find_tag() API for each and every smid (smid
    is tag +1) from one to shost->can_queue, now driver will call this API (to
    obtain the outstanding scmd) only for those smid's which are outstanding at
    the driver level.
    
    Driver will determine whether this smid is outstanding at driver level by
    looking into it's corresponding MPI request frame, if its MPI request frame
    is empty, then it means that this smid is free and does not need to call
    scsi_host_find_tag() for it.  By doing this, driver will invoke
    scsi_host_find_tag() for only those tags which are outstanding at the
    driver level.
    
    Driver will check whether particular MPI request frame is empty or not by
    looking into the "DevHandle" field. If this field is zero then it means
    that this MPI request is empty. For active MPI request DevHandle must be
    non-zero.
    
    Also driver will memset the MPI request frame once the corresponding scmd
    is processed (i.e. just before calling
    scmd->done function).
    
    Signed-off-by: Sreekanth Reddy <sreekanth.reddy@broadcom.com>
    Signed-off-by: Martin K. Petersen <martin.petersen@oracle.com>
    Signed-off-by: Sasha Levin (Microsoft) <sashal@kernel.org>

commit 2c8c8ef8d3b433a6cf1207c4be2058c973ba9b05
Author: Sreekanth Reddy <sreekanth.reddy@broadcom.com>
Date:   Mon Mar 4 07:26:35 2019 -0500

    scsi: mpt3sas: Fix kernel panic during expander reset
    
    [ Upstream commit c2fe742ff6e77c5b4fe4ad273191ddf28fdea25e ]
    
    During expander reset handling, the driver invokes kernel function
    scsi_host_find_tag() to obtain outstanding requests associated with the
    scsi host managed by the driver. Driver loops from tag value zero to hba
    queue depth to obtain the outstanding scmds. But when blk-mq is enabled,
    the block layer may return stale entry for one or more requests. This may
    lead to kernel panic if the returned value is inaccessible or the memory
    pointed by the returned value is reused.
    
    Reference of upstream discussion:
    
            https://patchwork.kernel.org/patch/10734933/
    
    Instead of calling scsi_host_find_tag() API for each and every smid (smid
    is tag +1) from one to shost->can_queue, now driver will call this API (to
    obtain the outstanding scmd) only for those smid's which are outstanding at
    the driver level.
    
    Driver will determine whether this smid is outstanding at driver level by
    looking into it's corresponding MPI request frame, if its MPI request frame
    is empty, then it means that this smid is free and does not need to call
    scsi_host_find_tag() for it.  By doing this, driver will invoke
    scsi_host_find_tag() for only those tags which are outstanding at the
    driver level.
    
    Driver will check whether particular MPI request frame is empty or not by
    looking into the "DevHandle" field. If this field is zero then it means
    that this MPI request is empty. For active MPI request DevHandle must be
    non-zero.
    
    Also driver will memset the MPI request frame once the corresponding scmd
    is processed (i.e. just before calling
    scmd->done function).
    
    Signed-off-by: Sreekanth Reddy <sreekanth.reddy@broadcom.com>
    Signed-off-by: Martin K. Petersen <martin.petersen@oracle.com>
    Signed-off-by: Sasha Levin (Microsoft) <sashal@kernel.org>

commit 8293b3c6dafd4d7440eb0ddda3092008e169bf8b
Author: Manivannan Sadhasivam <manivannan.sadhasivam@linaro.org>
Date:   Thu Apr 25 14:02:24 2019 +0530

    pinctrl: Rework Kconfig dependency for BM1880 pinctrl driver
    
    Make the BM1880 SoC pinctrl driver depend on COMPILE_TEST to get compiler
    test coverage and also select this driver by default for ARCH_BITMAIN
    platform.
    
    Signed-off-by: Manivannan Sadhasivam <manivannan.sadhasivam@linaro.org>
    Signed-off-by: Linus Walleij <linus.walleij@linaro.org>

commit 2f982703bd00245af8455efad491ca45990bc0d8
Author: Alexandre Belloni <alexandre.belloni@bootlin.com>
Date:   Fri Apr 26 23:47:15 2019 +0200

    clocksource/drivers/timer-atmel-pit: Rework Kconfig option
    
    Allow building the PIT driver when COMPILE_TEST is enabled. Also remove its
    default value so it can be disabled.
    
    Signed-off-by: Alexandre Belloni <alexandre.belloni@bootlin.com>
    Signed-off-by: Daniel Lezcano <daniel.lezcano@linaro.org>

commit 6275f4947e2f13a13a509d9fec4e1e5b15152680
Author: Alexandre Belloni <alexandre.belloni@bootlin.com>
Date:   Fri Apr 26 23:47:14 2019 +0200

    clocksource/drivers/tcb_clksrc: Move Kconfig option
    
    Move the ATMEL_TCB_CLKSRC option to drivers/clocksource and make it silent
    if COMPILE_TEST is not selected.
    
    Cc: Arnd Bergmann <arnd@arndb.de>
    Signed-off-by: Alexandre Belloni <alexandre.belloni@bootlin.com>
    Signed-off-by: Daniel Lezcano <daniel.lezcano@linaro.org>

commit dfc82faad72520769ca146f857e65c23632eed5a
Author: David Abdurachmanov <david.abdurachmanov@gmail.com>
Date:   Mon Apr 8 10:07:45 2019 +0200

    clocksource/drivers/sp804: Add COMPILE_TEST to CONFIG_ARM_TIMER_SP804
    
    This is only used on arm and arm64 platforms. Add COMPILE_TEST option.
    
    Tested with 5.1-rc3+ on Fedora/RISCV. CONFIG_ARM_TIMER_SP804 no more shows
    up in riscv config.
    
    Signed-off-by: David Abdurachmanov <david.abdurachmanov@gmail.com>
    Signed-off-by: Daniel Lezcano <daniel.lezcano@linaro.org>

commit 164a263bf8d003e4cbb197d52b74d26df72604d7
Author: Mark Brown <broonie@kernel.org>
Date:   Wed Apr 10 17:38:00 2019 +0100

    ASoC: Intel: Make boards more available for compile test
    
    The Intel boards have very strict dependencies which make them less
    available for compile test than is desirable, with requirements for
    specific drivers that are only needed at runtime but not at build time.
    Relax this a bit if COMPILE_TEST is enabled to improve build coverage
    for these drivers.
    
    Signed-off-by: Mark Brown <broonie@kernel.org>
    Acked-by: Pierre-Louis Bossart <pierre-louis.bossart@linux.intel.com>
    Signed-off-by: Mark Brown <broonie@kernel.org>

commit 2a369ae003881612ef5c2f03adcfc0ddc4ea817e
Merge: ac97a359b72d 73f7375d3ed6
Author: David S. Miller <davem@davemloft.net>
Date:   Wed May 1 14:33:31 2019 -0400

    Merge branch 'net-ll_temac-x86_64-support'
    
    Esben Haabendal says:
    
    ====================
    net: ll_temac: x86_64 support
    
    This patch series adds support for use of ll_temac driver with
    platform_data configuration and fixes endianess and 64-bit problems so
    that it can be used on x86_64 platform.
    
    A few bugfixes are also included.
    
    Changes since v2:
      - Fixed lp->indirect_mutex initialization regression for OF
        platforms introduced in v2
    
    Changes since v1:
      - Make indirect_mutex specification mandatory when using platform_data
      - Move header to include/linux/platform_data
      - Enable COMPILE_TEST for XILINX_LL_TEMAC
      - Rebased to v5.1-rc7
    ====================
    
    Signed-off-by: David S. Miller <davem@davemloft.net>

commit 2c02c37e9d99aa9b57453cb3ca3044461b193c19
Author: Esben Haabendal <esben@geanix.com>
Date:   Tue Apr 30 09:17:53 2019 +0200

    net: ll_temac: Allow use on x86 platforms
    
    With little-endian and 64-bit support in place, the ll_temac driver can
    now be used on x86 and x86_64 platforms.
    
    And while at it, enable COMPILE_TEST also.
    
    Signed-off-by: Esben Haabendal <esben@geanix.com>
    Reviewed-by: Andrew Lunn <andrew@lunn.ch>
    Signed-off-by: David S. Miller <davem@davemloft.net>

commit 79739ad2d0ac5787a15a1acf7caaf34cd95bbf3c
Author: Alistair Strachan <astrachan@google.com>
Date:   Fri Aug 3 10:39:31 2018 -0700

    x86: vdso: Use $LD instead of $CC to link
    
    commit 379d98ddf41344273d9718556f761420f4dc80b3 upstream.
    
    The vdso{32,64}.so can fail to link with CC=clang when clang tries to find
    a suitable GCC toolchain to link these libraries with.
    
    /usr/bin/ld: arch/x86/entry/vdso/vclock_gettime.o:
      access beyond end of merged section (782)
    
    This happens because the host environment leaked into the cross compiler
    environment due to the way clang searches for suitable GCC toolchains.
    
    Clang is a retargetable compiler, and each invocation of it must provide
    --target=<something> --gcc-toolchain=<something> to allow it to find the
    correct binutils for cross compilation. These flags had been added to
    KBUILD_CFLAGS, but the vdso code uses CC and not KBUILD_CFLAGS (for various
    reasons) which breaks clang's ability to find the correct linker when cross
    compiling.
    
    Most of the time this goes unnoticed because the host linker is new enough
    to work anyway, or is incompatible and skipped, but this cannot be reliably
    assumed.
    
    This change alters the vdso makefile to just use LD directly, which
    bypasses clang and thus the searching problem. The makefile will just use
    ${CROSS_COMPILE}ld instead, which is always what we want. This matches the
    method used to link vmlinux.
    
    This drops references to DISABLE_LTO; this option doesn't seem to be set
    anywhere, and not knowing what its possible values are, it's not clear how
    to convert it from CC to LD flag.
    
    Signed-off-by: Alistair Strachan <astrachan@google.com>
    Signed-off-by: Thomas Gleixner <tglx@linutronix.de>
    Acked-by: Andy Lutomirski <luto@kernel.org>
    Cc: "H. Peter Anvin" <hpa@zytor.com>
    Cc: Greg Kroah-Hartman <gregkh@linuxfoundation.org>
    Cc: kernel-team@android.com
    Cc: joel@joelfernandes.org
    Cc: Andi Kleen <andi.kleen@intel.com>
    Link: https://lkml.kernel.org/r/20180803173931.117515-1-astrachan@google.com
    Signed-off-by: Nathan Chancellor <natechancellor@gmail.com>
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit f06eba72274788db6a43012a05a99915c0283aef
Author: Jacky Bai <ping.bai@nxp.com>
Date:   Fri Apr 5 10:31:09 2019 -0700

    Input: snvs_pwrkey - make it depend on ARCH_MXC
    
    The SNVS power key is not only used on i.MX6SX and i.MX7D, it is also
    used by i.MX6UL and NXP's latest ARMv8 based i.MX8M series SOC. So
    update the config dependency to use ARCH_MXC, and add the COMPILE_TEST
    too.
    
    Signed-off-by: Jacky Bai <ping.bai@nxp.com>
    Reviewed-by: Dong Aisheng <aisheng.dong@nxp.com>
    Signed-off-by: Dmitry Torokhov <dmitry.torokhov@gmail.com>

commit ba7ecfe43d6bf12e2aa76705c45f7d187ae3d7c0
Author: Fabrice Gasnier <fabrice.gasnier@st.com>
Date:   Mon Apr 15 15:00:50 2019 +0200

    iio: adc: stm32-dfsdm: fix unmet direct dependencies detected
    
    This fixes unmet direct dependencies seen when CONFIG_STM32_DFSDM_ADC
    is selected:
    
    WARNING: unmet direct dependencies detected for IIO_BUFFER_HW_CONSUMER
      Depends on [n]: IIO [=y] && IIO_BUFFER [=n]
      Selected by [y]:
      - STM32_DFSDM_ADC [=y] && IIO [=y] && (ARCH_STM32 [=y] && OF [=y] ||
        COMPILE_TEST [=n])
    
    Fixes: e2e6771c6462 ("IIO: ADC: add STM32 DFSDM sigma delta ADC support")
    
    Signed-off-by: Fabrice Gasnier <fabrice.gasnier@st.com>
    Signed-off-by: Jonathan Cameron <Jonathan.Cameron@huawei.com>

commit af5cd05de5dd38cf25d14ea4d30ae9b791d2420b
Author: Michael Ellerman <mpe@ellerman.id.au>
Date:   Thu Feb 7 16:16:52 2019 +1100

    powerpc: Fix defconfig choice logic when cross compiling
    
    Our logic for choosing defconfig doesn't work well in some situations.
    
    For example if you're on a ppc64le machine but you specify a non-empty
    CROSS_COMPILE, in order to use a non-default toolchain, then defconfig
    will give you ppc64_defconfig (big endian):
    
      $ make CROSS_COMPILE=~/toolchains/gcc-8/bin/powerpc-linux- defconfig
      *** Default configuration is based on 'ppc64_defconfig'
    
    This is because we assume that CROSS_COMPILE being set means we
    can't be on a ppc machine and rather than checking we just default to
    ppc64_defconfig.
    
    We should just ignore CROSS_COMPILE, instead check the machine with
    uname and if it's one of ppc, ppc64 or ppc64le then use that
    defconfig. If it's none of those then we fall back to ppc64_defconfig.
    
    Signed-off-by: Michael Ellerman <mpe@ellerman.id.au>

commit f9764dd4d3befedba403fbb20d99566f4d26829d
Merge: 240206fcab66 bb0925b283fe
Author: Linus Torvalds <torvalds@linux-foundation.org>
Date:   Fri Apr 19 11:08:43 2019 -0700

    Merge tag 'char-misc-5.1-rc6' of git://git.kernel.org/pub/scm/linux/kernel/git/gregkh/char-misc
    
    Pull char/misc fixes from Greg KH:
     "Here are four small misc driver fixes for 5.1-rc6.
    
      Nothing major at all, they fix up a Kconfig issues, a SPDX invalid
      license tag, and two tiny bugfixes.
    
      All have been in linux-next for a while with no reported issues"
    
    * tag 'char-misc-5.1-rc6' of git://git.kernel.org/pub/scm/linux/kernel/git/gregkh/char-misc:
      drivers: power: supply: goldfish_battery: Fix bogus SPDX identifier
      extcon: ptn5150: fix COMPILE_TEST dependencies
      misc: fastrpc: add checked value for dma_set_mask
      habanalabs: remove low credit limit of DMA #0

commit 69166f7a37dc0bde5a3c26945e3cdbfc740b0562
Author: Shahar S Matityahu <shahar.s.matityahu@intel.com>
Date:   Tue Mar 19 09:35:29 2019 +0200

    iwlwifi: dbg_ini: set dump bit only when trigger collection is certain
    
    In case the the trigger occurrences is zero or force_restart is set, the
    driver sets IWL_FWRT_STATUS_DUMPING without actually scheduling trigger
    collection. At this point no other dump collection can be performed.
    
    Solve this by setting IWL_FWRT_STATUS_DUMPING bit only when the driver
    is surely going to schedule dump collection
    
    Signed-off-by: Shahar S Matityahu <shahar.s.matityahu@intel.com>
    Signed-off-by: Luca Coelho <luciano.coelho@intel.com>

commit db594ba3fcf9b2b84d71ffcc62a54b49c21427da
Author: Steven Price <steven.price@arm.com>
Date:   Wed Apr 17 16:29:28 2019 +0100

    drm/panfrost: depend on !GENERIC_ATOMIC64 when using COMPILE_TEST
    
    Since panfrost has a 'select' on IOMMU_IO_PGTABLE_LPAE we must depend on
    the same set of flags. Otherwise IOMMU_IO_PGTABLE_LPAE will be forced on
    even though it cannot build (no support for cmpxchg64).
    
    This fixes the following warning from kconfig:
    
    WARNING: unmet direct dependencies detected for IOMMU_IO_PGTABLE_LPAE
      Depends on [n]: IOMMU_SUPPORT [=y] && (ARM || ARM64 || COMPILE_TEST [=y] && !GENERIC_ATOMIC64 [=y])
      Selected by [y]:
      - DRM_PANFROST [=y] && HAS_IOMEM [=y] && DRM [=y] && (ARM || ARM64 || COMPILE_TEST [=y]) && MMU [=y]
    
    Reported-by: kbuild test robot <lkp@intel.com>
    Signed-off-by: Steven Price <steven.price@arm.com>
    Signed-off-by: Rob Herring <robh@kernel.org>
    Link: https://patchwork.freedesktop.org/patch/msgid/20190417152928.10790-1-steven.price@arm.com

commit 3d4b1ffc7edb1f963b0223469b0e8b699a197c1f
Author: Alistair Strachan <astrachan@google.com>
Date:   Fri Aug 3 10:39:31 2018 -0700

    x86: vdso: Use $LD instead of $CC to link
    
    commit 379d98ddf41344273d9718556f761420f4dc80b3 upstream.
    
    The vdso{32,64}.so can fail to link with CC=clang when clang tries to find
    a suitable GCC toolchain to link these libraries with.
    
    /usr/bin/ld: arch/x86/entry/vdso/vclock_gettime.o:
      access beyond end of merged section (782)
    
    This happens because the host environment leaked into the cross compiler
    environment due to the way clang searches for suitable GCC toolchains.
    
    Clang is a retargetable compiler, and each invocation of it must provide
    --target=<something> --gcc-toolchain=<something> to allow it to find the
    correct binutils for cross compilation. These flags had been added to
    KBUILD_CFLAGS, but the vdso code uses CC and not KBUILD_CFLAGS (for various
    reasons) which breaks clang's ability to find the correct linker when cross
    compiling.
    
    Most of the time this goes unnoticed because the host linker is new enough
    to work anyway, or is incompatible and skipped, but this cannot be reliably
    assumed.
    
    This change alters the vdso makefile to just use LD directly, which
    bypasses clang and thus the searching problem. The makefile will just use
    ${CROSS_COMPILE}ld instead, which is always what we want. This matches the
    method used to link vmlinux.
    
    This drops references to DISABLE_LTO; this option doesn't seem to be set
    anywhere, and not knowing what its possible values are, it's not clear how
    to convert it from CC to LD flag.
    
    Signed-off-by: Alistair Strachan <astrachan@google.com>
    Signed-off-by: Thomas Gleixner <tglx@linutronix.de>
    Acked-by: Andy Lutomirski <luto@kernel.org>
    Cc: "H. Peter Anvin" <hpa@zytor.com>
    Cc: Greg Kroah-Hartman <gregkh@linuxfoundation.org>
    Cc: kernel-team@android.com
    Cc: joel@joelfernandes.org
    Cc: Andi Kleen <andi.kleen@intel.com>
    Link: https://lkml.kernel.org/r/20180803173931.117515-1-astrachan@google.com
    Signed-off-by: Nathan Chancellor <natechancellor@gmail.com>
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit 94c0c4f033eee2304a98cf30a141f9dae35d3a62
Author: Alistair Strachan <astrachan@google.com>
Date:   Fri Aug 3 10:39:31 2018 -0700

    x86: vdso: Use $LD instead of $CC to link
    
    The vdso{32,64}.so can fail to link with CC=clang when clang tries to find
    a suitable GCC toolchain to link these libraries with.
    
    /usr/bin/ld: arch/x86/entry/vdso/vclock_gettime.o:
      access beyond end of merged section (782)
    
    This happens because the host environment leaked into the cross compiler
    environment due to the way clang searches for suitable GCC toolchains.
    
    Clang is a retargetable compiler, and each invocation of it must provide
    --target=<something> --gcc-toolchain=<something> to allow it to find the
    correct binutils for cross compilation. These flags had been added to
    KBUILD_CFLAGS, but the vdso code uses CC and not KBUILD_CFLAGS (for various
    reasons) which breaks clang's ability to find the correct linker when cross
    compiling.
    
    Most of the time this goes unnoticed because the host linker is new enough
    to work anyway, or is incompatible and skipped, but this cannot be reliably
    assumed.
    
    This change alters the vdso makefile to just use LD directly, which
    bypasses clang and thus the searching problem. The makefile will just use
    ${CROSS_COMPILE}ld instead, which is always what we want. This matches the
    method used to link vmlinux.
    
    This drops references to DISABLE_LTO; this option doesn't seem to be set
    anywhere, and not knowing what its possible values are, it's not clear how
    to convert it from CC to LD flag.
    
    Signed-off-by: Alistair Strachan <astrachan@google.com>
    Signed-off-by: Thomas Gleixner <tglx@linutronix.de>
    Acked-by: Andy Lutomirski <luto@kernel.org>
    Cc: "H. Peter Anvin" <hpa@zytor.com>
    Cc: Greg Kroah-Hartman <gregkh@linuxfoundation.org>
    Cc: kernel-team@android.com
    Cc: joel@joelfernandes.org
    Cc: Andi Kleen <andi.kleen@intel.com>
    Link: https://lkml.kernel.org/r/20180803173931.117515-1-astrachan@google.com
    Signed-off-by: Nathan Chancellor <natechancellor@gmail.com>
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit 76356a966e332fa0f70d10fd74a66d518af8ce0a
Author: Joel Stanley <joel@jms.id.au>
Date:   Fri Apr 5 18:41:17 2019 +1030

    drm: aspeed: Clean up Kconfig options
    
    The GFX IP is inside of the ASPEED BMC SoC so there is little use
    enabling it on a kernel that does not support ASPEED.
    
    When building with COMPILE_TEST the architecture many not have CMA
    support, so to avoid breaking the build we only select these options if
    the architecture supports the contiguous allocator.
    
    I suspect the DRM_PANEL came from a cut/paste error.
    
    Fixes: 4f2a8f5898ec ("drm: Add ASPEED GFX driver")
    Reported-by: Stephen Rothwell <sfr@canb.auug.org.au>
    Reported-by: kernel test robot <lkp@intel.com>
    Signed-off-by: Joel Stanley <joel@jms.id.au>
    Signed-off-by: Daniel Vetter <daniel.vetter@ffwll.ch>
    Link: https://patchwork.freedesktop.org/patch/msgid/20190405081117.27339-1-joel@jms.id.au

commit bb0925b283fe558fa9530c9d0b6158e9b6c9dfa6
Merge: 2aae471d66c1 86baf800de84
Author: Greg Kroah-Hartman <gregkh@linuxfoundation.org>
Date:   Tue Apr 16 12:46:09 2019 +0200

    Merge tag 'extcon-fixes-for-5.1-rc4' of git://git.kernel.org/pub/scm/linux/kernel/git/chanwoo/extcon into char-misc-linus
    
    Chanwoo writes:
    
    Update extcon for v5.1-rc4
    
    Detailed description for this pull request:
    1. Fix the build issue of extcon-ptn5150.c driver by editing
       the module dependency in Kconfig.
    
    * tag 'extcon-fixes-for-5.1-rc4' of git://git.kernel.org/pub/scm/linux/kernel/git/chanwoo/extcon:
      extcon: ptn5150: fix COMPILE_TEST dependencies

commit a62520473f15750cd1432d36b377a06cd7cff8d2
Author: Paul Thomas <pthomas8589@gmail.com>
Date:   Mon Apr 8 15:37:54 2019 -0400

    net: macb driver, check for SKBTX_HW_TSTAMP
    
    Make sure SKBTX_HW_TSTAMP (i.e. SOF_TIMESTAMPING_TX_HARDWARE) has been
    enabled for this skb. It does fix the issue where normal socks that
    aren't expecting a timestamp will not wake up on select, but when a
    user does want a SOF_TIMESTAMPING_TX_HARDWARE it does work.
    
    Signed-off-by: Paul Thomas <pthomas8589@gmail.com>
    Signed-off-by: David S. Miller <davem@davemloft.net>

commit 86baf800de84eb89615c138d368b14bff5ee7d8a
Author: Arnd Bergmann <arnd@arndb.de>
Date:   Wed Mar 6 12:08:57 2019 +0100

    extcon: ptn5150: fix COMPILE_TEST dependencies
    
    The PTN5150 dependencies look like they were meant to do the
    right thing, but they actually should not allow building without
    I2C for compile testing, as that results in a Kconfig warning
    and subsequent build failure:
    
    WARNING: unmet direct dependencies detected for REGMAP_I2C
      Depends on [m]: I2C [=m]
      Selected by [y]:
      - EXTCON_PTN5150 [=y] && EXTCON [=y] && (I2C [=m] && GPIOLIB [=y] || COMPILE_TEST [=y])
      Selected by [m]:
      - EEPROM_AT24 [=m] && I2C [=m] && SYSFS [=y]
      - KEYBOARD_CAP11XX [=m] && !UML && INPUT [=y] && INPUT_KEYBOARD [=y] && OF [=y] && I2C [=m]
      - INPUT_DRV260X_HAPTICS [=m] && !UML && INPUT_MISC [=y] && INPUT [=y] && I2C [=m] && (GPIOLIB [=y] || COMPILE_TEST [=y])
      - ... [many others]
    
    Add parentheses around the expression so we can compile-test
    without GPIOLIB but not without I2C.
    
    Fixes: 4ed754de2d66 ("extcon: Add support for ptn5150 extcon driver")
    Signed-off-by: Arnd Bergmann <arnd@arndb.de>
    Signed-off-by: Chanwoo Choi <cw00.choi@samsung.com>

commit 9db6ce4ecefb03698cb2875c1a46b9513303a9bf
Merge: 145f47c7381d a05a2e7998ab
Author: Linus Torvalds <torvalds@linux-foundation.org>
Date:   Thu Apr 4 14:42:47 2019 -1000

    Merge tag 'mfd-fixes-5.1' of git://git.kernel.org/pub/scm/linux/kernel/git/lee/mfd
    
    Pull mfd fixes from Lee Jones:
    
     - Fix failed reads due to enabled IRQs when suspended; twl-core
    
     - Fix driver registration when using DT; sprd-sc27xx-spi
    
     - Fix `make allyesconfig` on x86_64; SUN6I_PRCM
    
    * tag 'mfd-fixes-5.1' of git://git.kernel.org/pub/scm/linux/kernel/git/lee/mfd:
      mfd: sun6i-prcm: Allow to compile with COMPILE_TEST
      mfd: sc27xx: Use SoC compatible string for PMIC devices
      mfd: twl-core: Disable IRQ while suspended

commit c2b997508078d907e431c77a72e03410c3002f68
Author: Gustavo A. R. Silva <gustavo@embeddedor.com>
Date:   Wed Mar 20 15:31:39 2019 -0500

    scsi: mptscsih: Mark expected switch fall-throughs
    
    In preparation to enabling -Wimplicit-fallthrough, mark switch cases
    where we are expecting to fall through.
    
    This patch fixes the following warnings:
    
    drivers/message/fusion/mptscsih.c: In function  mptscsih_io_done :
    drivers/message/fusion/mptscsih.c:741:7: warning: this statement may fall through [-Wimplicit-fallthrough=]
        if ( ioc->bus_type == SAS ) {
           ^
    drivers/message/fusion/mptscsih.c:790:3: note: here
       case MPI_IOCSTATUS_SCSI_TASK_TERMINATED: /* 0x0048 */
       ^~~~
    drivers/message/fusion/mptscsih.c:884:4: warning: this statement may fall through [-Wimplicit-fallthrough=]
        scsi_set_resid(sc, 0);
        ^~~~~~~~~~~~~~~~~~~~~
    drivers/message/fusion/mptscsih.c:885:3: note: here
       case MPI_IOCSTATUS_SCSI_RECOVERED_ERROR: /* 0x0040 */
       ^~~~
    
    Warning level 3 was used: -Wimplicit-fallthrough=3
    
    This patch is part of the ongoing efforts to enable
    -Wimplicit-fallthrough.
    
    Signed-off-by: Gustavo A. R. Silva <gustavo@embeddedor.com>
    Signed-off-by: Martin K. Petersen <martin.petersen@oracle.com>

commit a05a2e7998ab1badcf80aed47b5313934fd131fa
Author: Maxime Ripard <maxime.ripard@bootlin.com>
Date:   Fri Mar 22 10:16:50 2019 +0100

    mfd: sun6i-prcm: Allow to compile with COMPILE_TEST
    
    Since this driver only has a dependency on ARCH_SUNXI just because it
    doesn't make any sense to run it on something else, we can definitely
    enable it through COMPILE_TEST as well to get some build coverage.
    
    Signed-off-by: Maxime Ripard <maxime.ripard@bootlin.com>
    Signed-off-by: Lee Jones <lee.jones@linaro.org>

commit f661fa2804af6950d1b7f5ffa22f6a80dcf52958
Author: Randy Dunlap <rdunlap@infradead.org>
Date:   Wed Mar 27 08:43:19 2019 -0700

    ASoC: fix SND_SOC_LOCHNAGAR_SC kconfig warning
    
    Fix kconfig warning for SND_SOC_LOCHNAGAR_SC:
    
    WARNING: unmet direct dependencies detected for SND_SOC_LOCHNAGAR_SC
      Depends on [n]: SOUND [=y] && !UML && SND [=y] && SND_SOC [=m] && MFD_LOCHNAGAR [=n]
      Selected by [m]:
      - SND_SOC_ALL_CODECS [=m] && SOUND [=y] && !UML && SND [=y] && SND_SOC [=m] && COMPILE_TEST [=y]
    
    Signed-off-by: Randy Dunlap <rdunlap@infradead.org>
    Cc: Piotr Stankiewicz <piotrs@opensource.cirrus.com>
    Cc: Charles Keepax <ckeepax@opensource.cirrus.com>
    Cc: Richard Fitzgerald <rf@opensource.cirrus.com>
    Cc: patches@opensource.cirrus.com
    Cc: Liam Girdwood <lgirdwood@gmail.com>
    Cc: Mark Brown <broonie@kernel.org>
    Cc: alsa-devel@alsa-project.org
    Acked-by: Charles Keepax <ckeepax@opensource.cirrus.com>
    Signed-off-by: Mark Brown <broonie@kernel.org>

commit c2fe742ff6e77c5b4fe4ad273191ddf28fdea25e
Author: Sreekanth Reddy <sreekanth.reddy@broadcom.com>
Date:   Mon Mar 4 07:26:35 2019 -0500

    scsi: mpt3sas: Fix kernel panic during expander reset
    
    During expander reset handling, the driver invokes kernel function
    scsi_host_find_tag() to obtain outstanding requests associated with the
    scsi host managed by the driver. Driver loops from tag value zero to hba
    queue depth to obtain the outstanding scmds. But when blk-mq is enabled,
    the block layer may return stale entry for one or more requests. This may
    lead to kernel panic if the returned value is inaccessible or the memory
    pointed by the returned value is reused.
    
    Reference of upstream discussion:
    
            https://patchwork.kernel.org/patch/10734933/
    
    Instead of calling scsi_host_find_tag() API for each and every smid (smid
    is tag +1) from one to shost->can_queue, now driver will call this API (to
    obtain the outstanding scmd) only for those smid's which are outstanding at
    the driver level.
    
    Driver will determine whether this smid is outstanding at driver level by
    looking into it's corresponding MPI request frame, if its MPI request frame
    is empty, then it means that this smid is free and does not need to call
    scsi_host_find_tag() for it.  By doing this, driver will invoke
    scsi_host_find_tag() for only those tags which are outstanding at the
    driver level.
    
    Driver will check whether particular MPI request frame is empty or not by
    looking into the "DevHandle" field. If this field is zero then it means
    that this MPI request is empty. For active MPI request DevHandle must be
    non-zero.
    
    Also driver will memset the MPI request frame once the corresponding scmd
    is processed (i.e. just before calling
    scmd->done function).
    
    Signed-off-by: Sreekanth Reddy <sreekanth.reddy@broadcom.com>
    Signed-off-by: Martin K. Petersen <martin.petersen@oracle.com>

commit d0d443cddbefd5c9ab28b56c4a9463cac5f8ae17
Author: Igor Russkikh <Igor.Russkikh@aquantia.com>
Date:   Sat Mar 23 15:23:42 2019 +0000

    net: aquantia: enable driver build for arm64 or compile_test
    
    The driver is now constantly tested in our lab on aarch64 hardware:
    Jetson tx2, Pascal and Xavier tegra based hardware.
    Many of tegra smmu related HW bugs were fixed or workarounded already.
    
    Thus, add ARM64 into Kconfig.
    
    Add also COMPILE_TEST dependency.
    
    Signed-off-by: Igor Russkikh <igor.russkikh@aquantia.com>
    Signed-off-by: David S. Miller <davem@davemloft.net>

commit c8a23dfeb2d63e79a1cb60640007c04e6c4c39fb
Author: Michael J. Ruhl <michael.j.ruhl@intel.com>
Date:   Tue Feb 26 08:45:35 2019 -0800

    IB/hfi1: Close race condition on user context disable and close
    
    commit bc5add09764c123f58942a37c8335247e683d234 upstream.
    
    When disabling and removing a receive context, it is possible for an
    asynchronous event (i.e IRQ) to occur.  Because of this, there is a race
    between cleaning up the context, and the context being used by the
    asynchronous event.
    
    cpu 0  (context cleanup)
        rc->ref_count-- (ref_count == 0)
        hfi1_rcd_free()
    cpu 1  (IRQ (with rcd index))
            rcd_get_by_index()
            lock
            ref_count+++     <-- reference count race (WARNING)
            return rcd
            unlock
    cpu 0
        hfi1_free_ctxtdata() <-- incorrect free location
        lock
        remove rcd from array
        unlock
        free rcd
    
    This race will cause the following WARNING trace:
    
    WARNING: CPU: 0 PID: 175027 at include/linux/kref.h:52 hfi1_rcd_get_by_index+0x84/0xa0 [hfi1]
    CPU: 0 PID: 175027 Comm: IMB-MPI1 Kdump: loaded Tainted: G OE ------------ 3.10.0-957.el7.x86_64 #1
    Hardware name: Intel Corporation S2600KP/S2600KP, BIOS SE5C610.86B.11.01.0076.C4.111920150602 11/19/2015
    Call Trace:
      dump_stack+0x19/0x1b
      __warn+0xd8/0x100
      warn_slowpath_null+0x1d/0x20
      hfi1_rcd_get_by_index+0x84/0xa0 [hfi1]
      is_rcv_urgent_int+0x24/0x90 [hfi1]
      general_interrupt+0x1b6/0x210 [hfi1]
      __handle_irq_event_percpu+0x44/0x1c0
      handle_irq_event_percpu+0x32/0x80
      handle_irq_event+0x3c/0x60
      handle_edge_irq+0x7f/0x150
      handle_irq+0xe4/0x1a0
      do_IRQ+0x4d/0xf0
      common_interrupt+0x162/0x162
    
    The race can also lead to a use after free which could be similar to:
    
    general protection fault: 0000 1 SMP
    CPU: 71 PID: 177147 Comm: IMB-MPI1 Kdump: loaded Tainted: G W OE ------------ 3.10.0-957.el7.x86_64 #1
    Hardware name: Intel Corporation S2600KP/S2600KP, BIOS SE5C610.86B.11.01.0076.C4.111920150602 11/19/2015
    task: ffff9962a8098000 ti: ffff99717a508000 task.ti: ffff99717a508000 __kmalloc+0x94/0x230
    Call Trace:
      ? hfi1_user_sdma_process_request+0x9c8/0x1250 [hfi1]
      hfi1_user_sdma_process_request+0x9c8/0x1250 [hfi1]
      hfi1_aio_write+0xba/0x110 [hfi1]
      do_sync_readv_writev+0x7b/0xd0
      do_readv_writev+0xce/0x260
      ? handle_mm_fault+0x39d/0x9b0
      ? pick_next_task_fair+0x5f/0x1b0
      ? sched_clock_cpu+0x85/0xc0
      ? __schedule+0x13a/0x890
      vfs_writev+0x35/0x60
      SyS_writev+0x7f/0x110
      system_call_fastpath+0x22/0x27
    
    Use the appropriate kref API to verify access.
    
    Reorder context cleanup to ensure context removal before cleanup occurs
    correctly.
    
    Cc: stable@vger.kernel.org # v4.14.0+
    Fixes: f683c80ca68e ("IB/hfi1: Resolve kernel panics by reference counting receive contexts")
    Reviewed-by: Mike Marciniszyn <mike.marciniszyn@intel.com>
    Signed-off-by: Michael J. Ruhl <michael.j.ruhl@intel.com>
    Signed-off-by: Dennis Dalessandro <dennis.dalessandro@intel.com>
    Signed-off-by: Jason Gunthorpe <jgg@mellanox.com>
    Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>

commit 54674984d4780a8d7f2a938e69918b09e02fa79f
Author: Michael J. Ruhl <michael.j.ruhl@intel.com>
Date:   Tue Feb 26 08:45:35 2019 -0800

    IB/hfi1: Close race condition on user context disable and close
    
    commit bc5add09764c123f58942a37c8335247e683d234 upstream.
    
    When disabling and removing a receive context, it is possible for an
    asynchronous event (i.e IRQ) to occur.  Because of this, there is a race
    between cleaning up the context, and the context being used by the
    asynchronous event.
    
    cpu 0  (context cleanup)
        rc->ref_count-- (ref_count == 0)
        hfi1_rcd_free()
    cpu 1  (IRQ (with rcd index))
            rcd_get_by_index()
            lock
            ref_count+++     <-- reference count race (WARNING)
            return rcd
            unlock
    cpu 0
        hfi1_free_ctxtdata() <-- incorrect free location
        lock
        remove rcd from array
        unlock
        free rcd
    
    This race will cause the following WARNING trace:
    
    WARNING: CPU: 0 PID: 175027 at include/linux/kref.h:52 hfi1_rcd_get_by_index+0x84/0xa0 [hfi1]
    CPU: 0 PID: 175027 Comm: IMB-MPI1 Kdump: loaded Tainted: G OE ------------ 3.10.0-957.el7.x86_64 #1
    Hardware name: Intel Corporation S2600KP/S2600KP, BIOS SE5C610.86B.11.01.0076.C4.111920150602 11/19/2015
    Call Trace:
      dump_stack+0x19/0x1b
      __warn+0xd8/0x100
      warn_slowpath_null+0x1d/0x20
      hfi1_rcd_get_by_index+0x84/0xa0 [hfi1]
      is_rcv_urgent_int+0x24/0x90 [hfi1]
      general_interrupt+0x1b6/0x210 [hfi1]
      __handle_irq_event_percpu+0x44/0x1c0
      handle_irq_event_percpu+0x32/0x80
      handle_irq_event+0x3c/0x60
      handle_edge_irq+0x7f/0x150
      handle_irq+0xe4/0x1a0
      do_IRQ+0x4d/0xf0
      common_interrupt+0x162/0x162
    
    The race can also lead to a use after free which could be similar to:
    
    general protection fault: 0000 1 SMP
    CPU: 71 PID: 177147 Comm: IMB-MPI1 Kdump: loaded Tainted: G W OE ------------ 3.10.0-957.el7.x86_64 #1
    Hardware name: Intel Corporation S2600KP/S2600KP, BIOS SE5C610.86B.11.01.0076.C4.111920150602 11/19/2015
    task: ffff9962a8098000 ti: ffff99717a508000 task.ti: ffff99717a508000 __kmalloc+0x94/0x230
    Call Trace:
      ? hfi1_user_sdma_process_request+0x9c8/0x1250 [hfi1]
      hfi1_user_sdma_process_request+0x9c8/0x1250 [hfi1]
      hfi1_aio_write+0xba/0x110 [hfi1]
      do_sync_readv_writev+0x7b/0xd0
      do_readv_writev+0xce/0x260
      ? handle_mm_fault+0x39d/0x9b0
      ? pick_next_task_fair+0x5f/0x1b0
      ? sched_clock_cpu+0x85/0xc0
      ? __schedule+0x13a/0x890
      vfs_writev+0x35/0x60
      SyS_writev+0x7f/0x110
      system_call_fastpath+0x22/0x27
    
    Use the appropriate kref API to verify access.
    
    Reorder context cleanup to ensure context removal before cleanup occurs
    correctly.
    
    Cc: stable@vger.kernel.org # v4.14.0+
    Fixes: f683c80ca68e ("IB/hfi1: Resolve kernel panics by reference counting receive contexts")
    Reviewed-by: Mike Marciniszyn <mike.marciniszyn@intel.com>
    Signed-off-by: Michael J. Ruhl <michael.j.ruhl@intel.com>
    Signed-off-by: Dennis Dalessandro <dennis.dalessandro@intel.com>
    Signed-off-by: Jason Gunthorpe <jgg@mellanox.com>
    Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>

commit 5e89ae3d9ab7afd5332945255e79e2e2f3275a89
Author: Michael J. Ruhl <michael.j.ruhl@intel.com>
Date:   Tue Feb 26 08:45:35 2019 -0800

    IB/hfi1: Close race condition on user context disable and close
    
    commit bc5add09764c123f58942a37c8335247e683d234 upstream.
    
    When disabling and removing a receive context, it is possible for an
    asynchronous event (i.e IRQ) to occur.  Because of this, there is a race
    between cleaning up the context, and the context being used by the
    asynchronous event.
    
    cpu 0  (context cleanup)
        rc->ref_count-- (ref_count == 0)
        hfi1_rcd_free()
    cpu 1  (IRQ (with rcd index))
            rcd_get_by_index()
            lock
            ref_count+++     <-- reference count race (WARNING)
            return rcd
            unlock
    cpu 0
        hfi1_free_ctxtdata() <-- incorrect free location
        lock
        remove rcd from array
        unlock
        free rcd
    
    This race will cause the following WARNING trace:
    
    WARNING: CPU: 0 PID: 175027 at include/linux/kref.h:52 hfi1_rcd_get_by_index+0x84/0xa0 [hfi1]
    CPU: 0 PID: 175027 Comm: IMB-MPI1 Kdump: loaded Tainted: G OE ------------ 3.10.0-957.el7.x86_64 #1
    Hardware name: Intel Corporation S2600KP/S2600KP, BIOS SE5C610.86B.11.01.0076.C4.111920150602 11/19/2015
    Call Trace:
      dump_stack+0x19/0x1b
      __warn+0xd8/0x100
      warn_slowpath_null+0x1d/0x20
      hfi1_rcd_get_by_index+0x84/0xa0 [hfi1]
      is_rcv_urgent_int+0x24/0x90 [hfi1]
      general_interrupt+0x1b6/0x210 [hfi1]
      __handle_irq_event_percpu+0x44/0x1c0
      handle_irq_event_percpu+0x32/0x80
      handle_irq_event+0x3c/0x60
      handle_edge_irq+0x7f/0x150
      handle_irq+0xe4/0x1a0
      do_IRQ+0x4d/0xf0
      common_interrupt+0x162/0x162
    
    The race can also lead to a use after free which could be similar to:
    
    general protection fault: 0000 1 SMP
    CPU: 71 PID: 177147 Comm: IMB-MPI1 Kdump: loaded Tainted: G W OE ------------ 3.10.0-957.el7.x86_64 #1
    Hardware name: Intel Corporation S2600KP/S2600KP, BIOS SE5C610.86B.11.01.0076.C4.111920150602 11/19/2015
    task: ffff9962a8098000 ti: ffff99717a508000 task.ti: ffff99717a508000 __kmalloc+0x94/0x230
    Call Trace:
      ? hfi1_user_sdma_process_request+0x9c8/0x1250 [hfi1]
      hfi1_user_sdma_process_request+0x9c8/0x1250 [hfi1]
      hfi1_aio_write+0xba/0x110 [hfi1]
      do_sync_readv_writev+0x7b/0xd0
      do_readv_writev+0xce/0x260
      ? handle_mm_fault+0x39d/0x9b0
      ? pick_next_task_fair+0x5f/0x1b0
      ? sched_clock_cpu+0x85/0xc0
      ? __schedule+0x13a/0x890
      vfs_writev+0x35/0x60
      SyS_writev+0x7f/0x110
      system_call_fastpath+0x22/0x27
    
    Use the appropriate kref API to verify access.
    
    Reorder context cleanup to ensure context removal before cleanup occurs
    correctly.
    
    Cc: stable@vger.kernel.org # v4.14.0+
    Fixes: f683c80ca68e ("IB/hfi1: Resolve kernel panics by reference counting receive contexts")
    Reviewed-by: Mike Marciniszyn <mike.marciniszyn@intel.com>
    Signed-off-by: Michael J. Ruhl <michael.j.ruhl@intel.com>
    Signed-off-by: Dennis Dalessandro <dennis.dalessandro@intel.com>
    Signed-off-by: Jason Gunthorpe <jgg@mellanox.com>
    Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>

commit b47b8618fc8a21281893015b639978e12c992a4a
Author: Gustavo A. R. Silva <gustavo@embeddedor.com>
Date:   Mon Feb 11 16:45:30 2019 -0600

    scsi: mptfusion: mark expected switch fall-through
    
    In preparation to enabling -Wimplicit-fallthrough, mark switch cases where
    we are expecting to fall through.
    
    This patch fixes the following warning:
    
    drivers/message/fusion/mptbase.c: In function  mptbase_reply :
    drivers/message/fusion/mptbase.c:643:6: warning: this statement may fall through [-Wimplicit-fallthrough=]
       if (event != MPI_EVENT_EVENT_CHANGE)
          ^
    drivers/message/fusion/mptbase.c:646:2: note: here
      case MPI_FUNCTION_CONFIG:
      ^~~~
    
    Warning level 3 was used: -Wimplicit-fallthrough=3
    
    Notice that, in this particular case, the code comment is modified in
    accordance with what GCC is expecting to find.
    
    This patch is part of the ongoing efforts to enable
    -Wimplicit-fallthrough.
    
    Signed-off-by: Gustavo A. R. Silva <gustavo@embeddedor.com>
    Signed-off-by: Martin K. Petersen <martin.petersen@oracle.com>

commit 49dc762cffd8305a861ca649e82dc5533b3e3344
Author: Arnd Bergmann <arnd@arndb.de>
Date:   Tue Mar 5 08:29:48 2019 -0500

    media: staging: davinci_vpfe: disallow building with COMPILE_TEST
    
    The driver should really call dm365_isif_setup_pinmux() through a callback,
    but uses a hack to include a davinci specific machine header file when
    compile testing instead. This works almost everywhere, but not on the
    ARM omap1 platform, which has another header named mach/mux.h. This
    causes a build failure:
    
    drivers/staging/media/davinci_vpfe/dm365_isif.c:2028:2: error: implicit declaration of function 'davinci_cfg_reg' [-Werror,-Wimplicit-function-declaration]
            davinci_cfg_reg(DM365_VIN_CAM_WEN);
            ^
    drivers/staging/media/davinci_vpfe/dm365_isif.c:2028:2: error: this function declaration is not a prototype [-Werror,-Wstrict-prototypes]
    drivers/staging/media/davinci_vpfe/dm365_isif.c:2028:18: error: use of undeclared identifier 'DM365_VIN_CAM_WEN'
            davinci_cfg_reg(DM365_VIN_CAM_WEN);
                            ^
    drivers/staging/media/davinci_vpfe/dm365_isif.c:2029:18: error: use of undeclared identifier 'DM365_VIN_CAM_VD'
            davinci_cfg_reg(DM365_VIN_CAM_VD);
                            ^
    drivers/staging/media/davinci_vpfe/dm365_isif.c:2030:18: error: use of undeclared identifier 'DM365_VIN_CAM_HD'
            davinci_cfg_reg(DM365_VIN_CAM_HD);
                            ^
    drivers/staging/media/davinci_vpfe/dm365_isif.c:2031:18: error: use of undeclared identifier 'DM365_VIN_YIN4_7_EN'
            davinci_cfg_reg(DM365_VIN_YIN4_7_EN);
                            ^
    drivers/staging/media/davinci_vpfe/dm365_isif.c:2032:18: error: use of undeclared identifier 'DM365_VIN_YIN0_3_EN'
            davinci_cfg_reg(DM365_VIN_YIN0_3_EN);
                            ^
    7 errors generated.
    
    Exclude omap1 from compile-testing, under the assumption that all others
    still work.
    
    Fixes: 4907c73deefe ("media: staging: davinci_vpfe: allow building with COMPILE_TEST")
    
    Signed-off-by: Arnd Bergmann <arnd@arndb.de>
    Signed-off-by: Hans Verkuil <hverkuil-cisco@xs4all.nl>
    Signed-off-by: Mauro Carvalho Chehab <mchehab+samsung@kernel.org>

commit 28d747f266fb73cd28a1b9a174cc3738fc177b00
Merge: 80b98e92ebcb c71bb9f86666
Author: Linus Torvalds <torvalds@linux-foundation.org>
Date:   Sun Mar 17 13:25:26 2019 -0700

    Merge tag 'kbuild-v5.1-2' of git://git.kernel.org/pub/scm/linux/kernel/git/masahiroy/linux-kbuild
    
    Pull more Kbuild updates from Masahiro Yamada:
    
     - add more Build-Depends to Debian source package
    
     - prefix header search paths with $(srctree)/
    
     - make modpost show verbose section mismatch warnings
    
     - avoid hard-coded CROSS_COMPILE for h8300
    
     - fix regression for Debian make-kpkg command
    
     - add semantic patch to detect missing put_device()
    
     - fix some warnings of 'make deb-pkg'
    
     - optimize NOSTDINC_FLAGS evaluation
    
     - add warnings about redundant generic-y
    
     - clean up Makefiles and scripts
    
    * tag 'kbuild-v5.1-2' of git://git.kernel.org/pub/scm/linux/kernel/git/masahiroy/linux-kbuild:
      kconfig: remove stale lxdialog/.gitignore
      kbuild: force all architectures except um to include mandatory-y
      kbuild: warn redundant generic-y
      Revert "modsign: Abort modules_install when signing fails"
      kbuild: Make NOSTDINC_FLAGS a simply expanded variable
      kbuild: deb-pkg: avoid implicit effects
      coccinelle: semantic code search for missing put_device()
      kbuild: pkg: grep include/config/auto.conf instead of $KCONFIG_CONFIG
      kbuild: deb-pkg: introduce is_enabled and if_enabled_echo to builddeb
      kbuild: deb-pkg: add CONFIG_ prefix to kernel config options
      kbuild: add workaround for Debian make-kpkg
      kbuild: source include/config/auto.conf instead of ${KCONFIG_CONFIG}
      unicore32: simplify linker script generation for decompressor
      h8300: use cc-cross-prefix instead of hardcoding h8300-unknown-linux-
      kbuild: move archive command to scripts/Makefile.lib
      modpost: always show verbose warning for section mismatch
      ia64: prefix header search path with $(srctree)/
      libfdt: prefix header search paths with $(srctree)/
      deb-pkg: generate correct build dependencies

commit 851ca779d110f694b5d078bc4af06d3ad37169e8
Merge: b5dd0c658c31 4b057e73f28f
Author: Linus Torvalds <torvalds@linux-foundation.org>
Date:   Fri Mar 8 08:23:15 2019 -0800

    Merge tag 'drm-next-2019-03-06' of git://anongit.freedesktop.org/drm/drm
    
    Pull drm updates from Dave Airlie:
     "This is the main drm pull request for the 5.1 merge window.
    
      The big changes I'd highlight are:
       - nouveau has HMM support now, there is finally an in-tree user so we
         can quieten down the rip it out people.
       - i915 now enables fastboot by default on Skylake+
       - Displayport Multistream support has been refactored and should
         hopefully be more reliable.
    
      Core:
       - header cleanups aiming towards removing drmP.h
       - dma-buf fence seqnos to 64-bits
       - common helper for DP mst hotplug for radeon,i915,amdgpu + new
         refcounting scheme
       - MST i2c improvements
       - drm_syncobj_cb removal
       - ARM FB compression fourcc
       - P010 + P016 fourcc
       - allwinner tiled format modifier
       - i2c over aux I2C_M_STOP support
       - DRM_AUTH handling fixes
    
      TTM:
       - ref/unref renaming
    
      New driver:
       - ARM komeda display driver
    
      scheduler:
       - refactor mirror list handling
       - rework hw fence processing
       - 0 run queue entity fix
    
      bridge:
       - TI DS90C185 LVDS bridge
       - thc631lvdm83d bridge improvements
       - cadence + allwinner DSI ported to generic phy
    
      panels:
       - Sitronix ST7701 panel
       - Kingdisplay KD097D04
       - LeMaker BL035-RGB-002
       - PDA 91-00156-A0
       - Innolux EE101IA-01D
    
      i915:
       - Enable fastboot by default on SKL+/VLV/CHV
       - Export RPCS configuration for ICL media driver
       - Coffelake PCI ID
       - CNL clocks setup fixes
       - ACPI/PMIC support for MIPI/DSI
       - Per-engine WA init for all engines
       - Shrinker locking fixes
       - Kerneldoc updates
       - Lots of ring improvements and reset fixes
       - Coffeelake GVT Support
       - VFIO GVT EDID Region support
       - runtime PM wakeref tracking
       - ILK->IVB primary plane enable delays
       - userptr mutex locking fixes
       - DSI fixes
       - LVDS/TV cleanups
       - HW readout fixes
       - LUT robustness fixes
       - ICL display and watermark fixes
       - gem mmap race fix
    
      amdgpu:
       - add scheduled dependencies interface
       - DCC on scanout surfaces
       - vega10/20 BACO support
       - Multiple IH rings on soc15
       - XGMI locking fixes
       - DC i2c/aux cleanups
       - runtime SMU debug interface
       - Kexec improvmeents
       - SR-IOV fixes
       - DC freesync + ABM fixes
       - GDS fixes
       - GPUVM fixes
       - vega20 PCIE DPM switching fixes
       - Context priority handling fixes
    
      radeon:
       - fix missing break in evergreen parser
    
      nouveau:
       - SVM support via HMM
    
      msm:
       - QCOM Compressed modifier support
    
      exynos:
       - s5pv210 rotator support
    
      imx:
       - zpos property support
       - pending update fixes
    
      v3d:
       - cache flush improvments
    
      vc4:
       - reflection support
       - HDMI overscan support
    
      tegra:
       - CEC refactoring
       - HDMI audio fixes
       - Tegra186 prep work
       - SOR crossbar device tree fixes
    
      sun4i:
       - implicit fencing support
       - YUV and scalar support improvements
       - A23 support
       - tiling fixes
    
      atmel-hlcdc:
       - clipping and rotation property fixes
    
      qxl:
       - BO and PRIME improvements
       - generic fbdev emulation
    
      dw-hdmi:
       - HDMI 2.0 2160p
       - YUV420 ouput
    
      rockchip:
       - implicit fencing support
       - reflection proerties
    
      virtio-gpu:
       - use generic fbdev emulation
    
      tilcdc:
       - cpufreq vs crtc init fix
    
      rcar-du:
       - R8A774C0 support
       - D3/E3 RGB output routing fixes and DPAD0 support
       - RA87744 LVDS support
    
      bochs:
       - atomic and generic fbdev emulation
       - ID mismatch error on bochs load
    
      meson:
       - remove firmware fbs"
    
    * tag 'drm-next-2019-03-06' of git://anongit.freedesktop.org/drm/drm: (1130 commits)
      drm/amd/display: Use vrr friendly pageflip throttling in DC.
      drm/imx: only send commit done event when all state has been applied
      drm/imx: allow building under COMPILE_TEST
      drm/imx: imx-tve: depend on COMMON_CLK
      drm/imx: ipuv3-plane: add zpos property
      drm/imx: ipuv3-plane: add function to query atomic update status
      gpu: ipu-v3: prg: add function to get channel configure status
      gpu: ipu-v3: pre: add double buffer status readback
      drm/amdgpu: Bump amdgpu version for context priority override.
      drm/amdgpu/powerplay: fix typo in BACO header guards
      drm/amdgpu/powerplay: fix return codes in BACO code
      drm/amdgpu: add missing license on baco files
      drm/bochs: Fix the ID mismatch error
      drm/nouveau/dmem: use dma addresses during migration copies
      drm/nouveau/dmem: use physical vram addresses during migration copies
      drm/nouveau/dmem: extend copy function to allow direct use of physical addresses
      drm/nouveau/svm: new ioctl to migrate process memory to GPU memory
      drm/nouveau/dmem: device memory helpers for SVM
      drm/nouveau/svm: initial support for shared virtual memory
      drm/nouveau: prepare for enabling svm with existing userspace interfaces
      ...

commit bc5add09764c123f58942a37c8335247e683d234
Author: Michael J. Ruhl <michael.j.ruhl@intel.com>
Date:   Tue Feb 26 08:45:35 2019 -0800

    IB/hfi1: Close race condition on user context disable and close
    
    When disabling and removing a receive context, it is possible for an
    asynchronous event (i.e IRQ) to occur.  Because of this, there is a race
    between cleaning up the context, and the context being used by the
    asynchronous event.
    
    cpu 0  (context cleanup)
        rc->ref_count-- (ref_count == 0)
        hfi1_rcd_free()
    cpu 1  (IRQ (with rcd index))
            rcd_get_by_index()
            lock
            ref_count+++     <-- reference count race (WARNING)
            return rcd
            unlock
    cpu 0
        hfi1_free_ctxtdata() <-- incorrect free location
        lock
        remove rcd from array
        unlock
        free rcd
    
    This race will cause the following WARNING trace:
    
    WARNING: CPU: 0 PID: 175027 at include/linux/kref.h:52 hfi1_rcd_get_by_index+0x84/0xa0 [hfi1]
    CPU: 0 PID: 175027 Comm: IMB-MPI1 Kdump: loaded Tainted: G OE ------------ 3.10.0-957.el7.x86_64 #1
    Hardware name: Intel Corporation S2600KP/S2600KP, BIOS SE5C610.86B.11.01.0076.C4.111920150602 11/19/2015
    Call Trace:
      dump_stack+0x19/0x1b
      __warn+0xd8/0x100
      warn_slowpath_null+0x1d/0x20
      hfi1_rcd_get_by_index+0x84/0xa0 [hfi1]
      is_rcv_urgent_int+0x24/0x90 [hfi1]
      general_interrupt+0x1b6/0x210 [hfi1]
      __handle_irq_event_percpu+0x44/0x1c0
      handle_irq_event_percpu+0x32/0x80
      handle_irq_event+0x3c/0x60
      handle_edge_irq+0x7f/0x150
      handle_irq+0xe4/0x1a0
      do_IRQ+0x4d/0xf0
      common_interrupt+0x162/0x162
    
    The race can also lead to a use after free which could be similar to:
    
    general protection fault: 0000 1 SMP
    CPU: 71 PID: 177147 Comm: IMB-MPI1 Kdump: loaded Tainted: G W OE ------------ 3.10.0-957.el7.x86_64 #1
    Hardware name: Intel Corporation S2600KP/S2600KP, BIOS SE5C610.86B.11.01.0076.C4.111920150602 11/19/2015
    task: ffff9962a8098000 ti: ffff99717a508000 task.ti: ffff99717a508000 __kmalloc+0x94/0x230
    Call Trace:
      ? hfi1_user_sdma_process_request+0x9c8/0x1250 [hfi1]
      hfi1_user_sdma_process_request+0x9c8/0x1250 [hfi1]
      hfi1_aio_write+0xba/0x110 [hfi1]
      do_sync_readv_writev+0x7b/0xd0
      do_readv_writev+0xce/0x260
      ? handle_mm_fault+0x39d/0x9b0
      ? pick_next_task_fair+0x5f/0x1b0
      ? sched_clock_cpu+0x85/0xc0
      ? __schedule+0x13a/0x890
      vfs_writev+0x35/0x60
      SyS_writev+0x7f/0x110
      system_call_fastpath+0x22/0x27
    
    Use the appropriate kref API to verify access.
    
    Reorder context cleanup to ensure context removal before cleanup occurs
    correctly.
    
    Cc: stable@vger.kernel.org # v4.14.0+
    Fixes: f683c80ca68e ("IB/hfi1: Resolve kernel panics by reference counting receive contexts")
    Reviewed-by: Mike Marciniszyn <mike.marciniszyn@intel.com>
    Signed-off-by: Michael J. Ruhl <michael.j.ruhl@intel.com>
    Signed-off-by: Dennis Dalessandro <dennis.dalessandro@intel.com>
    Signed-off-by: Jason Gunthorpe <jgg@mellanox.com>

commit 6baec880d7a53cbc2841123e56ee31e830df9b49
Author: Arnd Bergmann <arnd@arndb.de>
Date:   Thu Feb 28 16:21:58 2019 -0800

    kasan: turn off asan-stack for clang-8 and earlier
    
    Building an arm64 allmodconfig kernel with clang results in over 140
    warnings about overly large stack frames, the worst ones being:
    
      drivers/gpu/drm/panel/panel-sitronix-st7789v.c:196:12: error: stack frame size of 20224 bytes in function 'st7789v_prepare'
      drivers/video/fbdev/omap2/omapfb/displays/panel-tpo-td028ttec1.c:196:12: error: stack frame size of 13120 bytes in function 'td028ttec1_panel_enable'
      drivers/usb/host/max3421-hcd.c:1395:1: error: stack frame size of 10048 bytes in function 'max3421_spi_thread'
      drivers/net/wan/slic_ds26522.c:209:12: error: stack frame size of 9664 bytes in function 'slic_ds26522_probe'
      drivers/crypto/ccp/ccp-ops.c:2434:5: error: stack frame size of 8832 bytes in function 'ccp_run_cmd'
      drivers/media/dvb-frontends/stv0367.c:1005:12: error: stack frame size of 7840 bytes in function 'stv0367ter_algo'
    
    None of these happen with gcc today, and almost all of these are the
    result of a single known issue in llvm.  Hopefully it will eventually
    get fixed with the clang-9 release.
    
    In the meantime, the best idea I have is to turn off asan-stack for
    clang-8 and earlier, so we can produce a kernel that is safe to run.
    
    I have posted three patches that address the frame overflow warnings
    that are not addressed by turning off asan-stack, so in combination with
    this change, we get much closer to a clean allmodconfig build, which in
    turn is necessary to do meaningful build regression testing.
    
    It is still possible to turn on the CONFIG_ASAN_STACK option on all
    versions of clang, and it's always enabled for gcc, but when
    CONFIG_COMPILE_TEST is set, the option remains invisible, so
    allmodconfig and randconfig builds (which are normally done with a
    forced CONFIG_COMPILE_TEST) will still result in a mostly clean build.
    
    Link: http://lkml.kernel.org/r/20190222222950.3997333-1-arnd@arndb.de
    Link: https://bugs.llvm.org/show_bug.cgi?id=38809
    Signed-off-by: Arnd Bergmann <arnd@arndb.de>
    Reviewed-by: Qian Cai <cai@lca.pw>
    Reviewed-by: Mark Brown <broonie@kernel.org>
    Acked-by: Andrey Ryabinin <aryabinin@virtuozzo.com>
    Cc: Dmitry Vyukov <dvyukov@google.com>
    Cc: Nick Desaulniers <ndesaulniers@google.com>
    Cc: Kostya Serebryany <kcc@google.com>
    Cc: Andrey Konovalov <andreyknvl@google.com>
    Signed-off-by: Andrew Morton <akpm@linux-foundation.org>
    Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>

commit 7fbd5d784f75750199c21918da9b2fc92af371e6
Merge: fbac3c48fa6b a0ea4ffff266
Author: Dave Airlie <airlied@redhat.com>
Date:   Thu Feb 28 12:53:11 2019 +1000

    Merge tag 'imx-drm-next-2019-02-22' of git://git.pengutronix.de/pza/linux into drm-next
    
    drm/imx: handle pending updates better, add plane zpos property support
    
    - Add a mechanism to only send commit done events once all pending
      updates have been applied. This closes a small race window where
      already armed events could fire even though the double buffered
      hardware update just missed the update window.
    - Add plane zpos property support to allow placing the overlay plane
      behind the primary plane.
    - Allow building imx-drm on all platforms under COMPILE_TEST.
    
    Signed-off-by: Dave Airlie <airlied@redhat.com>
    
    From: Philipp Zabel <pza@pengutronix.de>
    Link: https://patchwork.freedesktop.org/patch/msgid/20190222112350.m3ucezilqx6cyest@pengutronix.de

commit 7850b51b6c21812be96d0200b74cff1f40587d98
Author: Gustavo A. R. Silva <gustavo@embeddedor.com>
Date:   Fri Feb 15 15:54:14 2019 -0600

    scsi: mpt3sas: Add missing breaks in switch statements
    
    Fix the following warnings by adding the proper missing breaks:
    
    drivers/scsi/mpt3sas/mpt3sas_base.c: In function  _base_display_OEMs_branding :
    drivers/scsi/mpt3sas/mpt3sas_base.c:3548:4: warning: this statement may fall through [-Wimplicit-fallthrough=]
        switch (ioc->pdev->subsystem_device) {
        ^~~~~~
    drivers/scsi/mpt3sas/mpt3sas_base.c:3566:3: note: here
       case MPI2_MFGPAGE_DEVID_SAS2308_2:
       ^~~~
    drivers/scsi/mpt3sas/mpt3sas_base.c:3567:4: warning: this statement may fall through [-Wimplicit-fallthrough=]
        switch (ioc->pdev->subsystem_device) {
        ^~~~~~
    drivers/scsi/mpt3sas/mpt3sas_base.c:3601:3: note: here
       case MPI25_MFGPAGE_DEVID_SAS3008:
       ^~~~
    drivers/scsi/mpt3sas/mpt3sas_base.c:3735:4: warning: this statement may fall through [-Wimplicit-fallthrough=]
        switch (ioc->pdev->subsystem_device) {
        ^~~~~~
    drivers/scsi/mpt3sas/mpt3sas_base.c:3745:3: note: here
       case MPI2_MFGPAGE_DEVID_SAS2308_2:
       ^~~~
    drivers/scsi/mpt3sas/mpt3sas_base.c:3746:4: warning: this statement may fall through [-Wimplicit-fallthrough=]
        switch (ioc->pdev->subsystem_device) {
        ^~~~~~
    drivers/scsi/mpt3sas/mpt3sas_base.c:3768:3: note: here
       default:
       ^~~~~~~
    
    Warning level 3 was used: -Wimplicit-fallthrough=3
    
    This patch is part of the ongoing efforts to enable
    -Wimplicit-fallthrough.
    
    Signed-off-by: Gustavo A. R. Silva <gustavo@embeddedor.com>
    Signed-off-by: Martin K. Petersen <martin.petersen@oracle.com>

commit bd55f96fa9fc29702ec30d75a4290bdadb00209d
Author: Masahiro Yamada <yamada.masahiro@socionext.com>
Date:   Wed Feb 20 13:23:56 2019 +0900

    kbuild: refactor cc-cross-prefix implementation
    
    - $(word 1, <text>) is equivalent to $(firstword <text>)
    
     - hardcode "gcc" instead of $(CC)
    
     - minimize the shell script part
    
    A little more notes in case $(filter-out -%, ...) is not clear.
    
    arch/mips/Makefile passes prefixes depending on the configuration.
    
    CROSS_COMPILE := $(call cc-cross-prefix, $(tool-archpref)-linux- \
        $(tool-archpref)-linux-gnu- $(tool-archpref)-unknown-linux-gnu-)
    
    In the Kconfig stage (e.g. when you run 'make defconfig'), neither
    CONFIG_32BIT nor CONFIG_64BIT is defined. So, $(tool-archpref) is
    empty. As a result, "-linux -linux-gnu- -unknown-linux-gnu" is passed
    into cc-cross-prefix. The command 'which' assumes arguments starting
    with a hyphen as command options, then emits the following messages:
    
      Illegal option -l
      Illegal option -l
      Illegal option -u
    
    I think it is strange to define CROSS_COMPILE depending on the CONFIG
    options since you need to feed $(CC) to Kconfig, but it is how MIPS
    Makefile currently works. Anyway, it would not hurt to filter-out
    invalid strings beforehand.
    
    Signed-off-by: Masahiro Yamada <yamada.masahiro@socionext.com>

commit b098b0228598af3ca2fd02892c4b976185988e7d
Author: Masahiro Yamada <yamada.masahiro@socionext.com>
Date:   Mon Nov 27 21:15:13 2017 +0900

    kbuild: move cc-option and cc-disable-warning after incl. arch Makefile
    
    commit cfe17c9bbe6a673fdafdab179c32b355ed447f66 upstream.
    
    Geert reported commit ae6b289a3789 ("kbuild: Set KBUILD_CFLAGS before
    incl. arch Makefile") broke cross-compilation using a cross-compiler
    that supports less compiler options than the host compiler.
    
    For example,
    
      cc1: error: unrecognized command line option "-Wno-unused-but-set-variable"
    
    This problem happens on architectures that setup CROSS_COMPILE in their
    arch/*/Makefile.
    
    Move the cc-option and cc-disable-warning back to the original position,
    but keep the Clang target options untouched.
    
    Fixes: ae6b289a3789 ("kbuild: Set KBUILD_CFLAGS before incl. arch Makefile")
    Reported-by: Geert Uytterhoeven <geert@linux-m68k.org>
    Signed-off-by: Masahiro Yamada <yamada.masahiro@socionext.com>
    Tested-by: Geert Uytterhoeven <geert@linux-m68k.org>
    [nc: Backport to 4.9; adjust context due to a previous backport]
    Signed-off-by: Nathan Chancellor <natechancellor@gmail.com>
    Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>

commit f6019702d9646da03c11bb5c9bd89e23ccc4e14d
Author: Philipp Zabel <p.zabel@pengutronix.de>
Date:   Mon Nov 5 16:36:27 2018 +0100

    drm/imx: allow building under COMPILE_TEST
    
    Allow to compile-test imx-drm on other platforms.
    
    Signed-off-by: Philipp Zabel <p.zabel@pengutronix.de>
    Reviewed-by: Linus Walleij <linus.walleij@linaro.org>

commit 2acef9c333ec3e60541517694ea88f44a7980f28
Author: Philipp Zabel <p.zabel@pengutronix.de>
Date:   Fri Jan 18 12:37:14 2019 +0100

    drm/imx: imx-tve: depend on COMMON_CLK
    
    Since the TVE provides a clock to the DI, the driver can only be
    compiled if the common clock framework is enabled. With the COMMON_CLK
    dependency in place, it will be possible to allow building the other
    parts of imx-drm under COMPILE_TEST on architectures that do not select
    the common clock framework.
    
    Signed-off-by: Philipp Zabel <p.zabel@pengutronix.de>
    Reviewed-by: Linus Walleij <linus.walleij@linaro.org>

commit 32f139551954512bfdf9d558341af453bb8b12b4
Author: Marc Zyngier <marc.zyngier@arm.com>
Date:   Sat Jan 19 15:29:54 2019 +0000

    arm/arm64: KVM: Statically configure the host's view of MPIDR
    
    We currently eagerly save/restore MPIDR. It turns out to be
    slightly pointless:
    - On the host, this value is known as soon as we're scheduled on a
      physical CPU
    - In the guest, this value cannot change, as it is set by KVM
      (and this is a read-only register)
    
    The result of the above is that we can perfectly avoid the eager
    saving of MPIDR_EL1, and only keep the restore. We just have
    to setup the host contexts appropriately at boot time.
    
    Signed-off-by: Marc Zyngier <marc.zyngier@arm.com>
    Acked-by: Christoffer Dall <christoffer.dall@arm.com>
    Signed-off-by: Christoffer Dall <christoffer.dall@arm.com>

commit f9bcc9f3ee4fbbe8f11dfec76745476f5780517e
Author: Vivien Didelot <vivien.didelot@savoirfairelinux.com>
Date:   Thu Feb 14 11:15:35 2019 -0500

    net: ethernet: freescale: set FEC ethtool regs version
    
    Currently the ethtool_regs version is set to 0 for FEC devices.
    
    Use this field to store the register dump version exposed by the
    kernel. The choosen version 2 corresponds to the kernel compile test:
    
            #if defined(CONFIG_M523x) || defined(CONFIG_M527x)
            || defined(CONFIG_M528x) || defined(CONFIG_M520x)
            || defined(CONFIG_M532x) || defined(CONFIG_ARM)
            || defined(CONFIG_ARM64) || defined(CONFIG_COMPILE_TEST)
    
    and version 1 corresponds to the opposite. Binaries of ethtool unaware
    of this version will dump the whole set as usual.
    
    Signed-off-by: Vivien Didelot <vivien.didelot@gmail.com>
    Signed-off-by: David S. Miller <davem@davemloft.net>

commit ca5e9aba753ed15d173c7a7b88e4d402b7ca8121
Author: Deepa Dinamani <deepa.kernel@gmail.com>
Date:   Tue Feb 12 19:26:03 2019 -0800

    time: Add time_types.h
    
    sys/time.h is the mandated include for many time related
    defines. However, linux/time.h overlaps sys/time.h
    significantly and this makes including both from userspace
    or one from the other impossible.
    
    This also means that userspace can get away with including
    sys/time.h whenever it needs linux/time.h and this is what's
    been happening in the user world usually.
    
    But, we have new data types that we plan to use in the uapi time
    interfaces also defined in the linux/time.h. But, we are unable
    to use these types when sys/time.h is included.
    
    Hence, move the new types to a new header, time_types.h.
    We intend to eventually have all the uapi defines that the kernel
    uses defined in this header.
    Note that the plan is to replace uapi interfaces with timeval to
    use __kernel_old_timeval, timespec to use __kernel_old_timespec etc.
    
    Reported-by: Ran Rozenstein <ranro@mellanox.com>
    Fixes: 9718475e6908 ("socket: Add SO_TIMESTAMPING_NEW")
    Signed-off-by: Deepa Dinamani <deepa.kernel@gmail.com>
    Signed-off-by: David S. Miller <davem@davemloft.net>

commit a35e4e7ca77a9f1dca8b57333721903ba7d5feec
Author: YueHaibing <yuehaibing@huawei.com>
Date:   Sat Nov 24 18:16:41 2018 +0800

    net: aquantia: return 'err' if set MPI_DEINIT state fails
    
    [ Upstream commit 4e3c7c00bba0636b97eb23d582c20b0f5d95ce20 ]
    
    Fixes gcc '-Wunused-but-set-variable' warning:
    
    drivers/net/ethernet/aquantia/atlantic/hw_atl/hw_atl_utils.c:260:7:
     warning: variable 'err' set but not used [-Wunused-but-set-variable]
    
    'err' should be returned while set MPI_DEINIT state fails
    in hw_atl_utils_soft_reset.
    
    Fixes: cce96d1883da ("net: aquantia: Regression on reset with 1.x firmware")
    Signed-off-by: YueHaibing <yuehaibing@huawei.com>
    Signed-off-by: David S. Miller <davem@davemloft.net>
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit d65fbc4fe9a9688ad2e63c92befe2be5e66c9b5b
Author: YueHaibing <yuehaibing@huawei.com>
Date:   Sat Nov 24 18:16:41 2018 +0800

    net: aquantia: return 'err' if set MPI_DEINIT state fails
    
    [ Upstream commit 4e3c7c00bba0636b97eb23d582c20b0f5d95ce20 ]
    
    Fixes gcc '-Wunused-but-set-variable' warning:
    
    drivers/net/ethernet/aquantia/atlantic/hw_atl/hw_atl_utils.c:260:7:
     warning: variable 'err' set but not used [-Wunused-but-set-variable]
    
    'err' should be returned while set MPI_DEINIT state fails
    in hw_atl_utils_soft_reset.
    
    Fixes: cce96d1883da ("net: aquantia: Regression on reset with 1.x firmware")
    Signed-off-by: YueHaibing <yuehaibing@huawei.com>
    Signed-off-by: David S. Miller <davem@davemloft.net>
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit 4836b4637ef080c2764c44ee40ed354cdb991d79
Author: Jiong Wang <jiong.wang@netronome.com>
Date:   Mon Feb 11 12:01:19 2019 +0000

    selftests: bpf: extend sub-register mode compilation to all bpf object files
    
    At the moment, we only do extra sub-register mode compilation on bpf object
    files used by "test_progs". These object files are really loaded and
    executed.
    
    This patch further extends sub-register mode compilation to all bpf object
    files, even those without corresponding runtime tests. Because this could
    help testing LLVM sub-register code-gen, kernel bpf selftest has much more
    C testcases with reasonable size and complexity compared with LLVM
    testsuite which only contains unit tests.
    
    There were some file duplication inside BPF_OBJ_FILES_DUAL_COMPILE which
    is removed now.
    
    Reviewed-by: Jakub Kicinski <jakub.kicinski@netronome.com>
    Signed-off-by: Jiong Wang <jiong.wang@netronome.com>
    Signed-off-by: Alexei Starovoitov <ast@kernel.org>

commit edcd3ed182f804ebec71b063bab32c424ddd8b6a
Author: Paul Cercueil <paul@crapouillou.net>
Date:   Thu Feb 7 10:31:42 2019 -0300

    ASoC: codecs: Kconfig: Show knob, and depend on MIPS || COMPILE_TEST
    
    Show the knob to enable or disable the jz4740-codec driver, add a
    proper description, and add a dependency on MIPS || COMPILE_TEST, as
    this driver is only useful on MIPS.
    
    Signed-off-by: Paul Cercueil <paul@crapouillou.net>
    Signed-off-by: Mark Brown <broonie@kernel.org>

commit eb9c7ce560453349652394ce493ac2d2b47f2b65
Author: Suganath Prabu S <suganath-prabu.subramani@broadcom.com>
Date:   Tue Jan 29 07:14:42 2019 -0500

    scsi: mpt3sas: Add support for ATLAS PCIe switch
    
    Add Atlas PCIe Switch Management Port device PNPID,
    Vendor Id: 0x1000
    device Id: 0x00B2
    
    This device is based on MPI 2.6 spec and it exposes one SES device to
    accept management commands for the PCIe switch.
    
    Signed-off-by: Suganath Prabu S <suganath-prabu.subramani@broadcom.com>
    Signed-off-by: Martin K. Petersen <martin.petersen@oracle.com>

commit 1244790d178bb09cfb59a70fa3d294d342631736
Author: Suganath Prabu S <suganath-prabu.subramani@broadcom.com>
Date:   Tue Jan 29 07:14:40 2019 -0500

    scsi: mpt3sas: Rename mpi endpoint device ID macro.
    
    MPI Endpoint is a PCIe switch based on MPI2.
    
    Renaming device ID macro from MPI2_MFGPAGE_DEVID_SAS2308_MPI_EP to
    MPI2_MFGPAGE_DEVID_SWITCH_MPI_EP.
    
    Signed-off-by: Suganath Prabu S <suganath-prabu.subramani@broadcom.com>
    Signed-off-by: Martin K. Petersen <martin.petersen@oracle.com>

commit ff7653f94b523d5d87f2f00cbf21a9d9f6de889c
Author: David S. Miller <davem@davemloft.net>
Date:   Sun Feb 3 20:25:31 2019 -0800

    net: Fix fall through warning in y2038 tstamp changes.
    
    net/core/sock.c: In function 'sock_setsockopt':
    net/core/sock.c:914:3: warning: this statement may fall through [-Wimplicit-fallthrough=]
       sock_set_flag(sk, SOCK_TSTAMP_NEW);
       ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    net/core/sock.c:915:2: note: here
      case SO_TIMESTAMPING_OLD:
      ^~~~
    
    Fixes: 9718475e6908 ("socket: Add SO_TIMESTAMPING_NEW")
    Reported-by: Stephen Rothwell <sfr@canb.auug.org.au>
    Signed-off-by: David S. Miller <davem@davemloft.net>

commit a98dc6aee784a5daf84a4781dcf02feab9ad5999
Merge: 3f8cfd0d95e6 a9beb86ae6e5
Author: David S. Miller <davem@davemloft.net>
Date:   Sun Feb 3 11:17:31 2019 -0800

    Merge branch 'net-y2038-safe-socket-timestamps'
    
    Deepa Dinamani says:
    
    ====================
    net: y2038-safe socket timestamps
    
    The series introduces new socket timestamps that are
    y2038 safe.
    
    The time data types used for the existing socket timestamp
    options: SO_TIMESTAMP, SO_TIMESTAMPNS and SO_TIMESTAMPING
    are not y2038 safe. The series introduces SO_TIMESTAMP_NEW,
    SO_TIMESTAMPNS_NEW and SO_TIMESTAMPING_NEW to replace these.
    These new timestamps can be used on all architectures.
    
    The alternative considered was to extend the sys_setsockopt()
    by using the flags. We did not receive any strong opinions about
    either of the approaches. Hence, this was chosen, as glibc folks
    preferred this.
    
    The series does not deal with updating the internal kernel socket
    calls like rxrpc to make them y2038 safe. This will be dealt
    with separately.
    
    Note that the timestamps behavior already does not match the
    man page specific behavior:
    SIOCGSTAMP
        This ioctl should only be used if the socket option SO_TIMESTAMP
            is not set on the socket. Otherwise, it returns the timestamp of
            the last packet that was received while SO_TIMESTAMP was not set,
            or it fails if no such packet has been received,
            (i.e., ioctl(2) returns -1 with errno set to ENOENT).
    
    The recommendation is to update the man page to remove the above statement.
    
    The overview of the socket timestamp series is as below:
    1. Delete asm specific socket.h when possible.
    2. Support SO/SCM_TIMESTAMP* options only in userspace.
    3. Rename current SO/SCM_TIMESTAMP* to SO/SCM_TIMESTAMP*_OLD.
    3. Alter socket options so that SOCK_RCVTSTAMPNS does
       not rely on SOCK_RCVTSTAMP.
    4. Introduce y2038 safe types for socket timestamp.
    5. Introduce new y2038 safe socket options SO/SCM_TIMESTAMP*_NEW.
    6. Intorduce new y2038 safe socket timeout options.
    
    Changes since v4:
    * Fixed the typo in calling sock_get_timeout()
    
    Changes since v3:
    * Rebased onto net-next and fixups as per review comments
    * Merged the socket timeout series
    * Integrated Arnd's patch to simplify compat handling of timeout syscalls
    
    Changes since v2:
    * Removed extra functions to reduce diff churn as per code review
    
    Changes since v1:
    * Dropped the change to disentangle sock flags
    * Renamed sock_timeval to __kernel_sock_timeval
    * Updated a few comments
    * Added documentation changes
    ====================
    
    Signed-off-by: David S. Miller <davem@davemloft.net>

commit 9718475e69084de15c3930ce35672a7dc6da866b
Author: Deepa Dinamani <deepa.kernel@gmail.com>
Date:   Sat Feb 2 07:34:51 2019 -0800

    socket: Add SO_TIMESTAMPING_NEW
    
    Add SO_TIMESTAMPING_NEW variant of socket timestamp options.
    This is the y2038 safe versions of the SO_TIMESTAMPING_OLD
    for all architectures.
    
    Signed-off-by: Deepa Dinamani <deepa.kernel@gmail.com>
    Acked-by: Willem de Bruijn <willemb@google.com>
    Cc: chris@zankel.net
    Cc: fenghua.yu@intel.com
    Cc: rth@twiddle.net
    Cc: tglx@linutronix.de
    Cc: ubraun@linux.ibm.com
    Cc: linux-alpha@vger.kernel.org
    Cc: linux-arch@vger.kernel.org
    Cc: linux-ia64@vger.kernel.org
    Cc: linux-mips@linux-mips.org
    Cc: linux-s390@vger.kernel.org
    Cc: linux-xtensa@linux-xtensa.org
    Cc: sparclinux@vger.kernel.org
    Signed-off-by: David S. Miller <davem@davemloft.net>

commit 7f1bc6e95d7840d4305595b3e4025cddda88cee5
Author: Deepa Dinamani <deepa.kernel@gmail.com>
Date:   Sat Feb 2 07:34:46 2019 -0800

    sockopt: Rename SO_TIMESTAMP* to SO_TIMESTAMP*_OLD
    
    SO_TIMESTAMP, SO_TIMESTAMPNS and SO_TIMESTAMPING options, the
    way they are currently defined, are not y2038 safe.
    Subsequent patches in the series add new y2038 safe versions
    of these options which provide 64 bit timestamps on all
    architectures uniformly.
    Hence, rename existing options with OLD tag suffixes.
    
    Also note that kernel will not use the untagged SO_TIMESTAMP*
    and SCM_TIMESTAMP* options internally anymore.
    
    Signed-off-by: Deepa Dinamani <deepa.kernel@gmail.com>
    Acked-by: Willem de Bruijn <willemb@google.com>
    Cc: deller@gmx.de
    Cc: dhowells@redhat.com
    Cc: jejb@parisc-linux.org
    Cc: ralf@linux-mips.org
    Cc: rth@twiddle.net
    Cc: linux-afs@lists.infradead.org
    Cc: linux-alpha@vger.kernel.org
    Cc: linux-arch@vger.kernel.org
    Cc: linux-mips@linux-mips.org
    Cc: linux-parisc@vger.kernel.org
    Cc: linux-rdma@vger.kernel.org
    Cc: sparclinux@vger.kernel.org
    Signed-off-by: David S. Miller <davem@davemloft.net>

commit 7cbc2b421ee33bdc17aede8bc5ff0dee72e78147
Author: Stephen Rothwell <sfr@canb.auug.org.au>
Date:   Fri Feb 1 13:37:59 2019 +1100

    firmware: intel_stratix10_service: remove COMPILE_TEST
    
    This does not build yet ...
    
    Cc: Richard Gong <richard.gong@intel.com>
    Fixes: 095ff29d2b88 ("firmware: intel_stratix10_service: add hardware dependency")
    Signed-off-by: Stephen Rothwell <sfr@canb.auug.org.au>
    Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>

commit 3ef84346c56141c72a28efcad2ddf17809533832
Author: Jiong Wang <jiong.wang@netronome.com>
Date:   Sat Jan 26 12:26:14 2019 -0500

    selftests: bpf: makefile support sub-register code-gen test mode
    
    This patch enables testing some eBPF programs under sub-register
    compilation mode.
    
    Only enable this when there is BPF_JMP32 support on both LLVM and kernel.
    This is because only after BPF_JMP32 added, code-gen for complex program
    under sub-register mode will be clean enough to pass verification.
    
    This patch splits TEST_GEN_FILES into BPF_OBJ_FILES and
    BPF_OBJ_FILES_DUAL_COMPILE. The latter are those objects we would like to
    compile for both default and sub-register mode. They are also objects used
    by "test_progs".
    
    Reviewed-by: Jakub Kicinski <jakub.kicinski@netronome.com>
    Signed-off-by: Jiong Wang <jiong.wang@netronome.com>
    Signed-off-by: Alexei Starovoitov <ast@kernel.org>

commit 232fadcbe5e0044d4fbdce26a5d5ae3fc5d145b1
Author: Sam Ravnborg <sam@ravnborg.org>
Date:   Sat Jan 19 09:40:10 2019 +0100

    drm/hisilicon/kirin: prepare for drmP.h removal from drm_modeset_helper.h
    
    The use of drmP.h is discouraged and removal of it from
    drm_modeset_helper.h caused kirin to fail to build.
    
    This patch introduce the necessary fixes to prepare for the
    drmP.h removal from drm_modeset_helper.h.
    List of include files sorted alphabetically.
    
    Build tested on arm x86 allmodconfig using the following hack
    to the Kconfig file:
    
    | -       depends on DRM && OF && ARM64
    | +       depends on DRM && OF && (ARM64 || (X86_64 && COMPILE_TEST))
    
    Build failed on 32bit ARM - so the X86_64 hack was required.
    The COMPILE_TEST hack is not submitted as the preferred fix
    is something where we have coverage on 32bit ARM too.
    
    v2:
    - Sort list of include files
    
    Signed-off-by: Sam Ravnborg <sam@ravnborg.org>
    Cc: Xinliang Liu <z.liuxinliang@hisilicon.com>
    Cc: Rongrong Zou <zourongrong@gmail.com>
    Cc: Xinwei Kong <kong.kongxinwei@hisilicon.com>
    Cc: Chen Feng <puck.chen@hisilicon.com>
    Cc: David Airlie <airlied@linux.ie>
    Cc: Daniel Vetter <daniel@ffwll.ch>
    Signed-off-by: Daniel Vetter <daniel.vetter@ffwll.ch>
    Link: https://patchwork.freedesktop.org/patch/msgid/20190119084014.5355-3-sam@ravnborg.org

commit eeedd3527d80333fd6587a3db260395f05f312d0
Author: Stanislav Fomichev <sdf@google.com>
Date:   Tue Jan 15 13:13:46 2019 -0800

    libbpf: don't define CC and AR
    
    We are already including tools/scripts/Makefile.include which correctly
    handles CROSS_COMPILE, no need to define our own vars.
    
    See related commit 7ed1c1901fe5 ("tools: fix cross-compile var clobbering")
    for more details.
    
    Signed-off-by: Stanislav Fomichev <sdf@google.com>
    Signed-off-by: Daniel Borkmann <daniel@iogearbox.net>

commit 4add635b4e00dd7d6aad83a937afdf1957196da6
Author: Anders Roxell <anders.roxell@linaro.org>
Date:   Mon Jan 14 10:30:04 2019 -0800

    Input: raspberrypi-ts - fix link error
    
    Fix link error when TOUCHSCREEN_RASPBERRYPI_FW is enabled as a module and
    the dependent module is built-in.  The 'depends on RASPBERRYPI_FIRMWARE' by
    itself prevents the touchscreen driver from being built-in when the
    firmware is configured as a module.  However, the '|| COMPILE_TEST' still
    allows it unless we explicitly prevent that configuration with
    '|| (RASPBERRYPI_FIRMWARE=n && COMPILE_TEST)'.
    
    ld: drivers/input/touchscreen/raspberrypi-ts.o: in function `rpi_ts_probe':
    raspberrypi-ts.c:(.text+0x3a8): undefined reference to `rpi_firmware_get'
    ld: raspberrypi-ts.c:(.text+0x3a8): relocation truncated to fit: R_AARCH64_CALL26 against undefined symbol `rpi_firmware_get'
    ld: raspberrypi-ts.c:(.text+0x4c8): undefined reference to `rpi_firmware_property'
    ld: raspberrypi-ts.c:(.text+0x4c8): relocation truncated to fit: R_AARCH64_CALL26 against undefined symbol `rpi_firmware_property'
    
    Rework so that TOUCHSCREEN_RASPBERRYPI_FW depends on
    RASPBERRYPI_FIRMWARE=n if COMPILE_TEST is enabled.
    
    Fixes: 0b9f28fed3f7 ("Input: add official Raspberry Pi's touchscreen driver")
    Suggested-by: Arnd Bergmann <arnd@arndb.de>
    Signed-off-by: Anders Roxell <anders.roxell@linaro.org>
    Signed-off-by: Dmitry Torokhov <dmitry.torokhov@gmail.com>

commit acef5e0165912c459a9ae98a25f0f87908ced0f9
Author: Corentin Labbe <clabbe@baylibre.com>
Date:   Tue Jan 8 12:52:50 2019 +0000

    powerpc/dts: Build virtex dtbs
    
    I wanted to test the virtex440-ml507 qemu machine and found that the
    dtb for it was not built.
    
    All powerpc dtbs are only built when CONFIG_OF_ALL_DTBS is set which
    depend on COMPILE_TEST.
    
    This patch enables building of the virtex dtbs when
    CONFIG_XILINX_VIRTEX440_GENERIC_BOARD is enabled.
    
    Signed-off-by: Corentin Labbe <clabbe@baylibre.com>
    [mpe: Put both targets on a single line]
    Signed-off-by: Michael Ellerman <mpe@ellerman.id.au>

commit b76db5ad2f97acfe14993caad0431904eed37dea
Author: Lukas Wunner <lukas@wunner.de>
Date:   Thu Nov 29 15:14:49 2018 +0100

    spi: bcm2835: Unbreak the build of esoteric configs
    
    commit 29bdedfd9cf40e59456110ca417a8cb672ac9b92 upstream.
    
    Commit e82b0b382845 ("spi: bcm2835: Fix race on DMA termination") broke
    the build with COMPILE_TEST=y on arches whose cmpxchg() requires 32-bit
    operands (xtensa, older arm ISAs).
    
    Fix by changing the dma_pending flag's type from bool to unsigned int.
    
    Fixes: e82b0b382845 ("spi: bcm2835: Fix race on DMA termination")
    Signed-off-by: Lukas Wunner <lukas@wunner.de>
    Signed-off-by: Mark Brown <broonie@kernel.org>
    Cc: Frank Pavlic <f.pavlic@kunbus.de>
    Cc: Martin Sperl <kernel@martin.sperl.org>
    Cc: Noralf Trnnes <noralf@tronnes.org>
    Cc: Sudip Mukherjee <sudipm.mukherjee@gmail.com>
    Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>

commit 59ed81e1eede2cb90010ee923c853a58535aff85
Author: Jiri Slaby <jslaby@suse.cz>
Date:   Tue Apr 24 09:43:44 2018 +0200

    tools: power/acpi, revert to LD = gcc
    
    commit 755396163148b50fe1afb4bdd3365e47f3ff7a42 upstream.
    
    Commit 7ed1c1901fe5 (tools: fix cross-compile var clobbering) removed
    setting of LD to $(CROSS_COMPILE)gcc. This broke build of acpica
    (acpidump) in power/acpi:
     ld: unrecognized option '-D_LINUX'
    
    The tools pass CFLAGS to the linker (incl. -D_LINUX), so revert this
    particular change and let LD be $(CC) again. Note that the old behaviour
    was a bit different, it used $(CROSS_COMPILE)gcc which was eliminated by
    the commit 7ed1c1901fe5. We use $(CC) for that reason.
    
    Fixes: 7ed1c1901fe5 (tools: fix cross-compile var clobbering)
    Signed-off-by: Jiri Slaby <jslaby@suse.cz>
    Cc: 4.16+ <stable@vger.kernel.org> # 4.16+
    Signed-off-by: Rafael J. Wysocki <rafael.j.wysocki@intel.com>
    Cc: Sudip Mukherjee <sudipm.mukherjee@gmail.com>
    Cc: Martin Kelly <martin@martingkelly.com>
    Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>

commit 5ee254ef76e8c5f052487a5c3e0cd5fcfa805ec7
Author: Martin Kelly <martin@martingkelly.com>
Date:   Wed Feb 21 14:45:12 2018 -0800

    tools: fix cross-compile var clobbering
    
    commit 7ed1c1901fe52e6c5828deb155920b44b0adabb1 upstream.
    
    Currently a number of Makefiles break when used with toolchains that
    pass extra flags in CC and other cross-compile related variables (such
    as --sysroot).
    
    Thus we get this error when we use a toolchain that puts --sysroot in
    the CC var:
    
      ~/src/linux/tools$ make iio
      [snip]
      iio_event_monitor.c:18:10: fatal error: unistd.h: No such file or directory
        #include <unistd.h>
                 ^~~~~~~~~~
    
    This occurs because we clobber several env vars related to
    cross-compiling with lines like this:
    
      CC = $(CROSS_COMPILE)gcc
    
    Although this will point to a valid cross-compiler, we lose any extra
    flags that might exist in the CC variable, which can break toolchains
    that rely on them (for example, those that use --sysroot).
    
    This easily shows up using a Yocto SDK:
    
      $ . [snip]/sdk/environment-setup-cortexa8hf-neon-poky-linux-gnueabi
    
      $ echo $CC
      arm-poky-linux-gnueabi-gcc -march=armv7-a -mfpu=neon -mfloat-abi=hard
      -mcpu=cortex-a8
      --sysroot=[snip]/sdk/sysroots/cortexa8hf-neon-poky-linux-gnueabi
    
      $ echo $CROSS_COMPILE
      arm-poky-linux-gnueabi-
    
      $ echo ${CROSS_COMPILE}gcc
      krm-poky-linux-gnueabi-gcc
    
    Although arm-poky-linux-gnueabi-gcc is a cross-compiler, we've lost the
    --sysroot and other flags that enable us to find the right libraries to
    link against, so we can't find unistd.h and other libraries and headers.
    Normally with the --sysroot flag we would find unistd.h in the sdk
    directory in the sysroot:
    
      $ find [snip]/sdk/sysroots -path '*/usr/include/unistd.h'
      [snip]/sdk/sysroots/cortexa8hf-neon-poky-linux-gnueabi/usr/include/unistd.h
    
    The perf Makefile adds CC = $(CROSS_COMPILE)gcc if and only if CC is not
    already set, and it compiles correctly with the above toolchain.
    
    So, generalize the logic that perf uses in the common Makefile and
    remove the manual CC = $(CROSS_COMPILE)gcc lines from each Makefile.
    
    Note that this patch does not fix cross-compile for all the tools (some
    have other bugs), but it does fix it for all except usb and acpi, which
    still have other unrelated issues.
    
    I tested both with and without the patch on native and cross-build and
    there appear to be no regressions.
    
    Link: http://lkml.kernel.org/r/20180107214028.23771-1-martin@martingkelly.com
    Signed-off-by: Martin Kelly <martin@martingkelly.com>
    Acked-by: Mark Brown <broonie@kernel.org>
    Cc: Tejun Heo <tj@kernel.org>
    Cc: Li Zefan <lizefan@huawei.com>
    Cc: Johannes Weiner <hannes@cmpxchg.org>
    Cc: Linus Walleij <linus.walleij@linaro.org>
    Cc: "K. Y. Srinivasan" <kys@microsoft.com>
    Cc: Haiyang Zhang <haiyangz@microsoft.com>
    Cc: Stephen Hemminger <sthemmin@microsoft.com>
    Cc: Jonathan Cameron <jic23@kernel.org>
    Cc: Pali Rohar <pali.rohar@gmail.com>
    Cc: Richard Purdie <rpurdie@rpsys.net>
    Cc: Jacek Anaszewski <jacek.anaszewski@gmail.com>
    Cc: Pavel Machek <pavel@ucw.cz>
    Cc: Peter Zijlstra <peterz@infradead.org>
    Cc: Ingo Molnar <mingo@redhat.com>
    Cc: Arnaldo Carvalho de Melo <acme@kernel.org>
    Cc: Robert Moore <robert.moore@intel.com>
    Cc: Lv Zheng <lv.zheng@intel.com>
    Cc: "Rafael J. Wysocki" <rafael.j.wysocki@intel.com>
    Cc: Greg Kroah-Hartman <gregkh@linuxfoundation.org>
    Cc: Valentina Manea <valentina.manea.m@gmail.com>
    Cc: Shuah Khan <shuah@kernel.org>
    Cc: Mario Limonciello <mario.limonciello@dell.com>
    Signed-off-by: Andrew Morton <akpm@linux-foundation.org>
    Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>
    Cc: Ignat Korchagin <ignat@cloudflare.com>
    Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>

commit 2d2d478576d71000b29c52668c5712c825ee9af8
Author: Ryder Lee <ryder.lee@mediatek.com>
Date:   Wed Jan 9 10:13:55 2019 +0800

    pinctrl: mediatek: fix Kconfig build errors for moore core
    
    on i386 or x86_64:
    
    Lots of build errors for drivers/pinctrl/mediatek/pinctrl-moore.c when
    CONFIG_OF is not enabled (but COMPILE_TEST is).
    
    first this:
    WARNING: unmet direct dependencies detected for PINCTRL_MTK_MOORE
      Depends on [n]: PINCTRL [=y] && (ARCH_MEDIATEK || COMPILE_TEST [=y])
      && OF [=n]
      Selected by [y]:
      - PINCTRL_MT7623 [=y] && PINCTRL [=y] &&
      (ARCH_MEDIATEK || COMPILE_TEST [=y]) && (MACH_MT7623 || COMPILE_TEST [=y])
    
    and then:
    ../drivers/pinctrl/mediatek/pinctrl-moore.c:22:44: error: array type has
       incomplete element type
       static const struct pinconf_generic_params mtk_custom_bindings[] = {
    (etc)
    
    Fixes: b5af33df50e9 ("pinctrl: mediatek: improve Kconfig dependencies")
    Cc: stable@vger.kernel.org
    Reported-by: Randy Dunlap <rdunlap@infradead.org>
    Signed-off-by: Ryder Lee <ryder.lee@mediatek.com>
    Acked-by: Sean Wang <sean.wang@kernel.org>
    Signed-off-by: Linus Walleij <linus.walleij@linaro.org>

commit 0206131811fa6e4b3ed64b5f1c107e2815dcab42
Author: Ravi Bangoria <ravi.bangoria@linux.ibm.com>
Date:   Thu Jan 10 15:19:35 2019 +0530

    perf powerpc: Rework syscall table generation
    
    Commit aff850393200 ("powerpc: add system call table generation
    support") changed how systemcall table is generated for powerpc.
    Incorporate these changes into perf as well.
    
    Committer testing:
    
      $ podman run --entrypoint=/bin/sh --privileged -v /home/acme/git:/git --rm -ti docker.io/acmel/linux-perf-tools-build-ubuntu:18.04-x-powerpc64
      perfbuilder@d7a7af166a80:/git/perf$ head -2 /etc/os-release
      NAME="Ubuntu"
      VERSION="18.04.1 LTS (Bionic Beaver)"
      perfbuilder@d7a7af166a80:/git/perf$
      perfbuilder@d7a7af166a80:/git/perf$ make ARCH=powerpc CROSS_COMPILE=powerpc64-linux-gnu- EXTRA_CFLAGS= -C /git/linux/tools/perf O=/tmp/build/perf
      make: Entering directory '/git/linux/tools/perf'
        BUILD:   Doing 'make -j8' parallel build
        HOSTCC   /tmp/build/perf/fixdep.o
        HOSTLD   /tmp/build/perf/fixdep-in.o
        LINK     /tmp/build/perf/fixdep
      Warning: Kernel ABI header at 'tools/include/uapi/linux/mman.h' differs from latest version at 'include/uapi/linux/mman.h'
      diff -u tools/include/uapi/linux/mman.h include/uapi/linux/mman.h
      sh: 1: command: Illegal option -c
    
      Auto-detecting system features:
      ...                         dwarf: [ on  ]
      ...            dwarf_getlocations: [ on  ]
      ...                         glibc: [ on  ]
      ...                          gtk2: [ OFF ]
      ...                      libaudit: [ OFF ]
      ...                        libbfd: [ OFF ]
      ...                        libelf: [ on  ]
      ...                       libnuma: [ OFF ]
      ...        numa_num_possible_cpus: [ OFF ]
      ...                       libperl: [ OFF ]
      ...                     libpython: [ OFF ]
      ...                      libslang: [ OFF ]
      ...                     libcrypto: [ OFF ]
      ...                     libunwind: [ OFF ]
      ...            libdw-dwarf-unwind: [ on  ]
      ...                          zlib: [ on  ]
      ...                          lzma: [ OFF ]
      ...                     get_cpuid: [ OFF ]
      ...                           bpf: [ on  ]
    
      Makefile.config:445: No sys/sdt.h found, no SDT events are defined, please install systemtap-sdt-devel or systemtap-sdt-dev
      Makefile.config:491: No libunwind found. Please install libunwind-dev[el] >= 1.1 and/or set LIBUNWIND_DIR
      Makefile.config:583: No libcrypto.h found, disables jitted code injection, please install libssl-devel or libssl-dev
      Makefile.config:598: slang not found, disables TUI support. Please install slang-devel, libslang-dev or libslang2-dev
      Makefile.config:612: GTK2 not found, disables GTK2 support. Please install gtk2-devel or libgtk2.0-dev
      Makefile.config:639: Missing perl devel files. Disabling perl scripting support, please install perl-ExtUtils-Embed/libperl-dev
      Makefile.config:666: No python interpreter was found: disables Python support - please install python-devel/python-dev
      Makefile.config:721: No bfd.h/libbfd found, please install binutils-dev[el]/zlib-static/libiberty-dev to gain symbol demangling
      Makefile.config:750: No liblzma found, disables xz kernel module decompression, please install xz-devel/liblzma-dev
      Makefile.config:763: No numa.h found, disables 'perf bench numa mem' benchmark, please install numactl-devel/libnuma-devel/libnuma-dev
      Makefile.config:814: No libbabeltrace found, disables 'perf data' CTF format support, please install libbabeltrace-dev[el]/libbabeltrace-ctf-dev
      Makefile.config:840: No alternatives command found, you need to set JDIR= to point to the root of your Java directory
        GEN      /tmp/build/perf/common-cmds.h
      <SNIP>
        CC       /tmp/build/perf/util/syscalltbl.o
      <SNIP>
        LD       /tmp/build/perf/libperf-in.o
        AR       /tmp/build/perf/libperf.a
        LINK     /tmp/build/perf/perf
      make: Leaving directory '/git/linux/tools/perf'
      perfbuilder@d7a7af166a80:/git/perf$ head /tmp/build/perf/arch/powerpc/include/generated/asm/syscalls_64.c
      static const char *syscalltbl_powerpc_64[] = {
            [0] = "restart_syscall",
            [1] = "exit",
            [2] = "fork",
            [3] = "read",
            [4] = "write",
            [5] = "open",
            [6] = "close",
            [7] = "waitpid",
            [8] = "creat",
      perfbuilder@d7a7af166a80:/git/perf$ tail /tmp/build/perf/arch/powerpc/include/generated/asm/syscalls_64.c
            [381] = "pwritev2",
            [382] = "kexec_file_load",
            [383] = "statx",
            [384] = "pkey_alloc",
            [385] = "pkey_free",
            [386] = "pkey_mprotect",
            [387] = "rseq",
            [388] = "io_pgetevents",
      };
      #define SYSCALLTBL_POWERPC_64_MAX_ID 388
      perfbuilder@d7a7af166a80:/git/perf$ head /tmp/build/perf/arch/powerpc/include/generated/asm/syscalls_32.c
      static const char *syscalltbl_powerpc_32[] = {
            [0] = "restart_syscall",
            [1] = "exit",
            [2] = "fork",
            [3] = "read",
            [4] = "write",
            [5] = "open",
            [6] = "close",
            [7] = "waitpid",
            [8] = "creat",
      perfbuilder@d7a7af166a80:/git/perf$ tail /tmp/build/perf/arch/powerpc/include/generated/asm/syscalls_32.c
            [381] = "pwritev2",
            [382] = "kexec_file_load",
            [383] = "statx",
            [384] = "pkey_alloc",
            [385] = "pkey_free",
            [386] = "pkey_mprotect",
            [387] = "rseq",
            [388] = "io_pgetevents",
      };
      #define SYSCALLTBL_POWERPC_32_MAX_ID 388
      perfbuilder@d7a7af166a80:/git/perf$
    
    Signed-off-by: Ravi Bangoria <ravi.bangoria@linux.ibm.com>
    Reported-by: Arnaldo Carvalho de Melo <acme@redhat.com>
    Tested-by: Arnaldo Carvalho de Melo <acme@redhat.com>
    Cc: Jiri Olsa <jolsa@redhat.com>
    Cc: Michael Ellerman <mpe@ellerman.id.au>
    Cc: Namhyung Kim <namhyung@kernel.org>
    Cc: linuxppc-dev@lists.ozlabs.org
    Link: http://lkml.kernel.org/r/20190110094936.3132-1-ravi.bangoria@linux.ibm.com
    Signed-off-by: Arnaldo Carvalho de Melo <acme@redhat.com>

commit 14a5a1e46b1e177750c0e040e849b9729c6ee5db
Author: Lukas Wunner <lukas@wunner.de>
Date:   Thu Nov 29 15:14:49 2018 +0100

    spi: bcm2835: Unbreak the build of esoteric configs
    
    commit 29bdedfd9cf40e59456110ca417a8cb672ac9b92 upstream.
    
    Commit e82b0b382845 ("spi: bcm2835: Fix race on DMA termination") broke
    the build with COMPILE_TEST=y on arches whose cmpxchg() requires 32-bit
    operands (xtensa, older arm ISAs).
    
    Fix by changing the dma_pending flag's type from bool to unsigned int.
    
    Fixes: e82b0b382845 ("spi: bcm2835: Fix race on DMA termination")
    Signed-off-by: Lukas Wunner <lukas@wunner.de>
    Signed-off-by: Mark Brown <broonie@kernel.org>
    Cc: Frank Pavlic <f.pavlic@kunbus.de>
    Cc: Martin Sperl <kernel@martin.sperl.org>
    Cc: Noralf Trnnes <noralf@tronnes.org>
    Cc: Sudip Mukherjee <sudipm.mukherjee@gmail.com>
    Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>

commit feb0be15ee8b70c0f819a5010652705109b1e128
Author: Lukas Wunner <lukas@wunner.de>
Date:   Thu Nov 29 15:14:49 2018 +0100

    spi: bcm2835: Unbreak the build of esoteric configs
    
    commit 29bdedfd9cf40e59456110ca417a8cb672ac9b92 upstream.
    
    Commit e82b0b382845 ("spi: bcm2835: Fix race on DMA termination") broke
    the build with COMPILE_TEST=y on arches whose cmpxchg() requires 32-bit
    operands (xtensa, older arm ISAs).
    
    Fix by changing the dma_pending flag's type from bool to unsigned int.
    
    Fixes: e82b0b382845 ("spi: bcm2835: Fix race on DMA termination")
    Signed-off-by: Lukas Wunner <lukas@wunner.de>
    Signed-off-by: Mark Brown <broonie@kernel.org>
    Cc: Frank Pavlic <f.pavlic@kunbus.de>
    Cc: Martin Sperl <kernel@martin.sperl.org>
    Cc: Noralf Trnnes <noralf@tronnes.org>
    Cc: Sudip Mukherjee <sudipm.mukherjee@gmail.com>
    Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>

commit 0dacf0458c02fa9fdd19813c86ee66809d5e0db1
Author: Lukas Wunner <lukas@wunner.de>
Date:   Thu Nov 29 15:14:49 2018 +0100

    spi: bcm2835: Unbreak the build of esoteric configs
    
    commit 29bdedfd9cf40e59456110ca417a8cb672ac9b92 upstream.
    
    Commit e82b0b382845 ("spi: bcm2835: Fix race on DMA termination") broke
    the build with COMPILE_TEST=y on arches whose cmpxchg() requires 32-bit
    operands (xtensa, older arm ISAs).
    
    Fix by changing the dma_pending flag's type from bool to unsigned int.
    
    Fixes: e82b0b382845 ("spi: bcm2835: Fix race on DMA termination")
    Signed-off-by: Lukas Wunner <lukas@wunner.de>
    Signed-off-by: Mark Brown <broonie@kernel.org>
    Cc: Frank Pavlic <f.pavlic@kunbus.de>
    Cc: Martin Sperl <kernel@martin.sperl.org>
    Cc: Noralf Trnnes <noralf@tronnes.org>
    Cc: Sudip Mukherjee <sudipm.mukherjee@gmail.com>
    Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>

commit 0b7a78688a4c51c2de363960de1afaa9d0f081e0
Author: Lukas Wunner <lukas@wunner.de>
Date:   Thu Nov 29 15:14:49 2018 +0100

    spi: bcm2835: Unbreak the build of esoteric configs
    
    commit 29bdedfd9cf40e59456110ca417a8cb672ac9b92 upstream.
    
    Commit e82b0b382845 ("spi: bcm2835: Fix race on DMA termination") broke
    the build with COMPILE_TEST=y on arches whose cmpxchg() requires 32-bit
    operands (xtensa, older arm ISAs).
    
    Fix by changing the dma_pending flag's type from bool to unsigned int.
    
    Fixes: e82b0b382845 ("spi: bcm2835: Fix race on DMA termination")
    Signed-off-by: Lukas Wunner <lukas@wunner.de>
    Signed-off-by: Mark Brown <broonie@kernel.org>
    Cc: Frank Pavlic <f.pavlic@kunbus.de>
    Cc: Martin Sperl <kernel@martin.sperl.org>
    Cc: Noralf Trnnes <noralf@tronnes.org>
    Cc: Sudip Mukherjee <sudipm.mukherjee@gmail.com>
    Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>

commit ed6ccf10f24bdfc1955bc8b976ddedc370fc3869
Author: Christoph Hellwig <hch@lst.de>
Date:   Wed Dec 26 07:52:13 2018 +0100

    dma-mapping: properly stub out the DMA API for !CONFIG_HAS_DMA
    
    This avoids link failures in drivers using the DMA API, when they
    are compiled for user mode Linux with CONFIG_COMPILE_TEST=y.
    
    Fixes: 356da6d0cd ("dma-mapping: bypass indirect calls for dma-direct")
    Signed-off-by: Christoph Hellwig <hch@lst.de>

commit eaa76499711535fd64d747cc4ef0d78ab0fd41c6
Merge: b3cc2bfe7244 f366d3854ec0
Author: Linus Torvalds <torvalds@linux-foundation.org>
Date:   Tue Dec 25 12:49:46 2018 -0800

    Merge tag 'mtd/for-4.21' of git://git.infradead.org/linux-mtd
    
    Pull mtd updates from Boris Brezillon:
     "SPI NOR Core changes:
       - Parse the 4BAIT SFDP section
       - Add a bunch of SPI NOR entries to the flash_info table
       - Add the concept of SFDP fixups and use it to fix a bug on MX25L25635F
       - A bunch of minor cleanups/comestic changes
    
      NAND core changes:
       - kernel-doc miscellaneous fixes.
       - Third batch of fixes/cleanup to the raw NAND core impacting various
         controller drivers (ams-delta, marvell, fsmc, denali, tegra,
         vf610):
          * Stop to pass mtd_info objects to internal functions
          * Reorganize code to avoid forward declarations
          * Drop useless test in nand_legacy_set_defaults()
          * Move nand_exec_op() to internal.h
          * Add nand_[de]select_target() helpers
          * Pass the CS line to be selected in struct nand_operation
          * Make ->select_chip() optional when ->exec_op() is implemented
          * Deprecate the ->select_chip() hook
          * Move the ->exec_op() method to nand_controller_ops
          * Move ->setup_data_interface() to nand_controller_ops
          * Deprecate the dummy_controller field
          * Fix JEDEC detection
          * Provide a helper for polling GPIO R/B pin
    
      Raw NAND chip drivers changes:
       - Macronix:
          * Flag 1.8V AC chips with a broken GET_FEATURES(TIMINGS)
    
      Raw NAND controllers drivers changes:
       - Ams-delta:
          * Fix the error path
          * SPDX tag added
          * May be compiled with COMPILE_TEST=y
          * Conversion to ->exec_op() interface
          * Drop .IOADDR_R/W use
          * Use GPIO API for data I/O
       - Denali:
          * Remove denali_reset_banks()
          * Remove ->dev_ready() hook
          * Include <linux/bits.h> instead of <linux/bitops.h>
          * Changes to comply with the above fixes/cleanup done in the core.
       - FSMC:
          * Add an SPDX tag to replace the license text
          * Make conversion from chip to fsmc consistent
          * Fix unchecked return value in fsmc_read_page_hwecc
          * Changes to comply with the above fixes/cleanup done in the core.
       - Marvell:
          * Prevent timeouts on a loaded machine (fix)
          * Changes to comply with the above fixes/cleanup done in the core.
       - OMAP2:
          * Pass the parent of pdev to dma_request_chan() (fix)
       - R852:
          * Use generic DMA API
       - sh_flctl:
          * Convert to SPDX identifiers
       - Sunxi:
          * Write pageprog related opcodes to the right register: WCMD_SET (fix)
       - Tegra:
          * Stop implementing ->select_chip()
       - VF610:
          * Add an SPDX tag to replace the license text
          * Changes to comply with the above fixes/cleanup done in the core.
       - Various trivial/spelling/coding style fixes.
    
      SPI-NAND drivers changes:
       - Remove the depreacated mt29f_spinand driver from staging.
       - Add support for:
          * Toshiba TC58CVG2S0H
          * GigaDevice GD5FxGQ4xA
          * Winbond W25N01GV
    
      JFFS2 changes:
       - Fix a lockdep issue
    
      MTD changes:
       - Rework the physmap driver to merge gpio-addr-flash and physmap_of
         in it
       - Add a new compatible for RedBoot partitions
       - Make sub-partitions RW if the parent partition was RO because of a
         mis-alignment
       - Add pinctrl support to the
       - Addition of /* fall-through */ comments where appropriate
       - Various minor fixes and cleanups
    
      Other changes:
       - Update my email address"
    
    * tag 'mtd/for-4.21' of git://git.infradead.org/linux-mtd: (108 commits)
      mtd: rawnand: sunxi: Write pageprog related opcodes to WCMD_SET
      MAINTAINERS: Update my email address
      mtd: rawnand: marvell: prevent timeouts on a loaded machine
      mtd: rawnand: omap2: Pass the parent of pdev to dma_request_chan()
      mtd: rawnand: Fix JEDEC detection
      mtd: spi-nor: Add support for is25lp016d
      mtd: spi-nor: parse SFDP 4-byte Address Instruction Table
      mtd: spi-nor: Add 4B_OPCODES flag to is25lp256
      mtd: spi-nor: Add an SPDX tag to spi-nor.{c,h}
      mtd: spi-nor: Make the enable argument passed to set_byte() a bool
      mtd: spi-nor: Stop passing flash_info around
      mtd: spi-nor: Avoid forward declaration of internal functions
      mtd: spi-nor: Drop inline on all internal helpers
      mtd: spi-nor: Add a post BFPT fixup for MX25L25635E
      mtd: spi-nor: Add a post BFPT parsing fixup hook
      mtd: spi-nor: Add the SNOR_F_4B_OPCODES flag
      mtd: spi-nor: cast to u64 to avoid uint overflows
      mtd: spi-nor: Add support for IS25LP032/064
      mtd: spi-nor: add entry for mt35xu512aba flash
      mtd: spi-nor: add macros related to MICRON flash
      ...

commit 7085f47fcdc599cb387a472e4cd9def739954119
Author: Willem de Bruijn <willemb@google.com>
Date:   Thu Dec 20 16:22:52 2018 -0500

    selftests: expand txtimestamp with cmsg support
    
    Commit 3dd17e63f513 ("sock: accept SO_TIMESTAMPING flags in socket
    cmsg") added support for passing tx timestamping options per-call
    in sendmsg.
    
    Expand the txtimestamp test with support for this feature.
    
    Signed-off-by: Willem de Bruijn <willemb@google.com>
    Acked-by: Soheil Hassas Yeganeh <soheil@google.com>
    Signed-off-by: David S. Miller <davem@davemloft.net>

commit e9462fffddad94ee4cb50f6000989133bd15fb96
Author: Geert Uytterhoeven <geert@linux-m68k.org>
Date:   Thu Dec 20 19:13:09 2018 +0100

    fbdev: Remove depends on HAS_DMA in case of platform dependency
    
    Remove dependencies on HAS_DMA where a Kconfig symbol depends on another
    symbol that implies HAS_DMA, and, optionally, on "|| COMPILE_TEST".
    In most cases this other symbol is an architecture or platform specific
    symbol, or PCI.
    
    Generic symbols and drivers without platform dependencies keep their
    dependencies on HAS_DMA, to prevent compiling subsystems or drivers that
    cannot work anyway.
    
    This simplifies the dependencies, and allows to improve compile-testing.
    
    Signed-off-by: Geert Uytterhoeven <geert@linux-m68k.org>
    Reviewed-by: Mark Brown <broonie@kernel.org>
    Acked-by: Robin Murphy <robin.murphy@arm.com>
    Signed-off-by: Bartlomiej Zolnierkiewicz <b.zolnierkie@samsung.com>

commit 72e7bcc2cdf82bf03caaa5e6c9b0134c2fc2ee7d
Author: Joel Stanley <joel@jms.id.au>
Date:   Mon Nov 12 15:58:06 2018 +1030

    powerpc/32: Avoid unsupported flags with clang
    
    When building for ppc32 with clang these flags are unsupported:
    
      -ffixed-r2 and -mmultiple
    
    llvm's lib/Target/PowerPC/PPCRegisterInfo.cpp marks r2 as reserved on
    when building for SVR4ABI and !ppc64:
    
      // The SVR4 ABI reserves r2 and r13
      if (Subtarget.isSVR4ABI()) {
        // We only reserve r2 if we need to use the TOC pointer. If we have no
        // explicit uses of the TOC pointer (meaning we're a leaf function with
        // no constant-pool loads, etc.) and we have no potential uses inside an
        // inline asm block, then we can treat r2 has an ordinary callee-saved
        // register.
        const PPCFunctionInfo *FuncInfo = MF.getInfo<PPCFunctionInfo>();
        if (!TM.isPPC64() || FuncInfo->usesTOCBasePtr() || MF.hasInlineAsm())
          markSuperRegs(Reserved, PPC::R2);  // System-reserved register
        markSuperRegs(Reserved, PPC::R13); // Small Data Area pointer register
      }
    
    This means we can safely omit -ffixed-r2 when building for 32-bit
    targets.
    
    The -mmultiple/-mno-multiple flags are not supported by clang, so
    platforms that might support multiple miss out on using multiple word
    instructions.
    
    We wrap these flags in cc-option so that when Clang gains support the
    kernel will be able use these flags.
    
    Clang 8 can then build a ppc44x_defconfig which boots in Qemu:
    
      make CC=clang-8 ARCH=powerpc CROSS_COMPILE=powerpc-linux-gnu-  ppc44x_defconfig
      ./scripts/config -e CONFIG_DEVTMPFS -d DEVTMPFS_MOUNT
      make CC=clang-8 ARCH=powerpc CROSS_COMPILE=powerpc-linux-gnu-
    
      qemu-system-ppc -M bamboo \
       -kernel arch/powerpc/boot/zImage \
       -dtb arch/powerpc/boot/dts/bamboo.dtb \
       -initrd ~/ppc32-440-rootfs.cpio \
       -nographic -serial stdio -monitor pty -append "console=ttyS0"
    
    Link: https://github.com/ClangBuiltLinux/linux/issues/261
    Link: https://bugs.llvm.org/show_bug.cgi?id=39556
    Link: https://bugs.llvm.org/show_bug.cgi?id=39555
    Signed-off-by: Joel Stanley <joel@jms.id.au>
    Reviewed-by: Nick Desaulniers <ndesaulniers@google.com>
    Signed-off-by: Michael Ellerman <mpe@ellerman.id.au>

commit 9e88b9312acb9b80554c48b58668fb144720333a
Author: Ivan Babrou <ivan@cloudflare.com>
Date:   Wed Dec 19 12:08:03 2018 -0800

    tools: bpftool: do not force gcc as CC
    
    This allows transparent cross-compilation with CROSS_COMPILE by
    relying on 7ed1c1901fe5 ("tools: fix cross-compile var clobbering").
    
    Signed-off-by: Ivan Babrou <ivan@cloudflare.com>
    Signed-off-by: Daniel Borkmann <daniel@iogearbox.net>

commit ccec4a4a4f27b22e51ec6a143319db49b7570581
Merge: 7677ea0e8843 732774437ae0
Author: Boris Brezillon <boris.brezillon@bootlin.com>
Date:   Tue Dec 18 19:59:16 2018 +0100

    Merge tag 'nand/for-4.21' of git://git.infradead.org/linux-mtd into mtd/next
    
    NAND core changes:
    - kernel-doc miscellaneous fixes.
    - Third batch of fixes/cleanup to the raw NAND core impacting various
      controller drivers (ams-delta, marvell, fsmc, denali, tegra, vf610):
      * Stopping to pass mtd_info objects to internal functions
      * Reorganizing code to avoid forward declarations
      * Dropping useless test in nand_legacy_set_defaults()
      * Moving nand_exec_op() to internal.h
      * Adding nand_[de]select_target() helpers
      * Passing the CS line to be selected in struct nand_operation
      * Making ->select_chip() optional when ->exec_op() is implemented
      * Deprecating the ->select_chip() hook
      * Moving the ->exec_op() method to nand_controller_ops
      * Moving ->setup_data_interface() to nand_controller_ops
      * Deprecating the dummy_controller field
      * Fixing JEDEC detection
      * Providing a helper for polling GPIO R/B pin
    
    Raw NAND chip drivers changes:
    - Macronix:
      * Flagging 1.8V AC chips with a broken GET_FEATURES(TIMINGS)
    
    Raw NAND controllers drivers changes:
    - Ams-delta:
      * Fixing the error path
      * SPDX tag added
      * May be compiled with COMPILE_TEST=y
      * Conversion to ->exec_op() interface
      * Dropping .IOADDR_R/W use
      * Use GPIO API for data I/O
    - Denali:
      * Removing denali_reset_banks()
      * Removing ->dev_ready() hook
      * Including <linux/bits.h> instead of <linux/bitops.h>
      * Changes to comply with the above fixes/cleanup done in the core.
    - FSMC:
      * Adding an SPDX tag to replace the license text
      * Making conversion from chip to fsmc consistent
      * Fixing unchecked return value in fsmc_read_page_hwecc
      * Changes to comply with the above fixes/cleanup done in the core.
    - Marvell:
      * Preventing timeouts on a loaded machine (fix)
      * Changes to comply with the above fixes/cleanup done in the core.
    - OMAP2:
      * Pass the parent of pdev to dma_request_chan() (fix)
    - R852:
      * Use generic DMA API
    - sh_flctl:
      * Converting to SPDX identifiers
    - Sunxi:
      * Write pageprog related opcodes to the right register: WCMD_SET (fix)
    - Tegra:
      * Stop implementing ->select_chip()
    - VF610:
      * Adding an SPDX tag to replace the license text
      * Changes to comply with the above fixes/cleanup done in the core.
    - Various trivial/spelling/coding style fixes.
    
    SPI-NAND drivers changes:
    - Removing the depreacated mt29f_spinand driver from staging.
    - Adding support for:
      * Toshiba TC58CVG2S0H
      * GigaDevice GD5FxGQ4xA
      * Winbond W25N01GV

commit b33299017ca7a303fa650e007ebfbcf57527fc8c
Merge: 255fe81a6ad4 8f932f762e79
Author: David S. Miller <davem@davemloft.net>
Date:   Mon Dec 17 23:27:01 2018 -0800

    Merge branch 'net-SO_TIMESTAMPING-fixes'
    
    Willem de Bruijn says:
    
    ====================
    net: SO_TIMESTAMPING fixes
    
    Fix two omissions:
    
    - tx timestamping is missing for AF_INET6/SOCK_RAW/IPPROTO_RAW
    - SOF_TIMESTAMPING_OPT_ID is missing for IPPROTO_RAW, PF_PACKET, CAN
    
    Discovered while expanding the selftest in
    
      tools/testing/selftests/networking/timestamping/txtimestamp.c
    
    Will send the test patchset to net-next once the fixes make it to that
    branch. For now, it is available at
    
      https://github.com/wdebruij/linux/commits/txtimestamp-test-1
    ====================
    
    Signed-off-by: David S. Miller <davem@davemloft.net>

commit 8f932f762e7928d250e21006b00ff9b7718b0a64
Author: Willem de Bruijn <willemb@google.com>
Date:   Mon Dec 17 12:24:00 2018 -0500

    net: add missing SOF_TIMESTAMPING_OPT_ID support
    
    SOF_TIMESTAMPING_OPT_ID is supported on TCP, UDP and RAW sockets.
    But it was missing on RAW with IPPROTO_IP, PF_PACKET and CAN.
    
    Add skb_setup_tx_timestamp that configures both tx_flags and tskey
    for these paths that do not need corking or use bytestream keys.
    
    Fixes: 09c2d251b707 ("net-timestamp: add key to disambiguate concurrent datagrams")
    Signed-off-by: Willem de Bruijn <willemb@google.com>
    Acked-by: Soheil Hassas Yeganeh <soheil@google.com>
    Signed-off-by: David S. Miller <davem@davemloft.net>

commit 7e6fc0b317c4cbd504434395edd7a99bd69e440e
Author: Han Xu <b45815@freescale.com>
Date:   Fri Oct 23 13:18:28 2015 -0500

    mtd: fsl-quadspi: fix macro collision problems with READ/WRITE
    
    commit 04850c4d8613127a9b488321c0ad83bff7519311 upstream.
    
    Change the READ/WRITE to FSL_READ/FSL_WRITE to resolve any possible
    namespace collisions with READ/WRITE macros (e.g., from <linux/fs.h>).
    
    Problems have been seen, for example, on mips:
    
    >> drivers/mtd/spi-nor/fsl-quadspi.c:186:5: error: 'LUT_0' undeclared (first use in this function)
          ((LUT_##ins) << INSTR0_SHIFT))
            ^
    >> drivers/mtd/spi-nor/fsl-quadspi.c:188:30: note: in expansion of macro 'LUT0'
    
    On SPARC:
    
    drivers/mtd/spi-nor/fsl-quadspi.c: In function 'fsl_qspi_init_lut':
    drivers/mtd/spi-nor/fsl-quadspi.c:369:1: error: 'LUT_0' undeclared (first use in this function)
    drivers/mtd/spi-nor/fsl-quadspi.c:418:1: error: pasting "LUT_" and "(" does not give a valid preprocessing token
    drivers/mtd/spi-nor/fsl-quadspi.c:418:2: error: implicit declaration of function 'LUT_'
    
    And surely on others.
    
    Fixes: d26a22d06708 ("mtd: fsl-quadspi: allow building for other ARCHes with COMPILE_TEST")
    Reported-by: Guenter Roeck <linux@roeck-us.net>
    Reported-by: kbuild test robot <fengguang.wu@intel.com>
    Signed-off-by: Han Xu <b45815@freescale.com>
    [Brian: rewrote commit description]
    Signed-off-by: Brian Norris <computersforpeace@gmail.com>
    Signed-off-by: Ben Hutchings <ben@decadent.org.uk>

commit 0641d6135565d91f60daf0f1955a9c76d80f59f5
Author: Dan Carpenter <dan.carpenter@oracle.com>
Date:   Wed Aug 8 14:57:24 2018 +0300

    powerpc: Fix size calculation using resource_size()
    
    commit c42d3be0c06f0c1c416054022aa535c08a1f9b39 upstream.
    
    The problem is the the calculation should be "end - start + 1" but the
    plus one is missing in this calculation.
    
    Fixes: 8626816e905e ("powerpc: add support for MPIC message register API")
    Signed-off-by: Dan Carpenter <dan.carpenter@oracle.com>
    Reviewed-by: Tyrel Datwyler <tyreld@linux.vnet.ibm.com>
    Signed-off-by: Michael Ellerman <mpe@ellerman.id.au>
    Signed-off-by: Ben Hutchings <ben@decadent.org.uk>

commit 4722a3e6b716d9d4594c3cf3856b03bbd24a59a8
Author: Masahiro Yamada <yamada.masahiro@socionext.com>
Date:   Fri Dec 7 20:33:54 2018 +0900

    microblaze: fix multiple bugs in arch/microblaze/boot/Makefile
    
    This commit fixes some build issues.
    
    The first issue is the breakage of linux.bin.ub target since commit
    ece97f3a5fb5 ("microblaze: Fix simpleImage format generation")
    because the addition of UIMAGE_{IN,OUT} affected it.
    
    make ARCH=microblaze CROSS_COMPILE=microblaze-linux- linux.bin.ub
      [ snip ]
      OBJCOPY arch/microblaze/boot/linux.bin
      UIMAGE  arch/microblaze/boot/linux.bin.ub.ub
    /usr/bin/mkimage: Can't open arch/microblaze/boot/linux.bin.ub: No such file or directory
    make[1]: *** [arch/microblaze/boot/Makefile;14: arch/microblaze/boot/linux.bin.ub] Error 1
    make: *** [arch/microblaze/Makefile;83: linux.bin.ub] Error 2
    
    The second issue is the use of the "if_changed" multiple times for
    the same target.
    
    As commit 92a4728608a8 ("x86/boot: Fix if_changed build flip/flop bug")
    pointed out, this never works properly. Moreover, generating multiple
    images as a side-effect is confusing.
    
    Let's split the build recipe for each image.
    
    simpleImage.<dt>*.unstrip is just a copy of vmlinux.
    
    simpleImage.<dt> and simpleImage.<dt>.ub are created in the same way
    as linux.bin and linux.bin.ub, respectively.
    
    I kept simpleImage.* recipes independent of linux.bin.* ones to not
    change the behavior.
    
    Lastly, this commit fixes "make ARCH=microblaze clean". Previously,
    it only cleaned up the unstrip image. Now, all the simpleImage files
    are cleaned.
    
    Signed-off-by: Masahiro Yamada <yamada.masahiro@socionext.com>
    Signed-off-by: Michal Simek <michal.simek@xilinx.com>

commit bafcc61d998c1ca18f556d92a0e95335ac68c7da
Author: Masahiro Yamada <yamada.masahiro@socionext.com>
Date:   Fri Dec 7 20:33:52 2018 +0900

    microblaze: adjust the help to the real behavior
    
    "make ARCH=microblaze help" mentions simpleImage.<dt>.unstrip,
    but it is not a real Make target. It does not work because Makefile
    assumes "system.unstrip" is the name of DT.
    
    $ make ARCH=microblaze CROSS_COMPILE=microblaze-linux- simpleImage.system.unstrip
      [ snip ]
    make[1]: *** No rule to make target 'arch/microblaze/boot/dts/system.unstrip.dtb', needed by 'arch/microblaze/boot/dts/system.dtb'.  Stop.
    make: *** [Makefile;1060: arch/microblaze/boot/dts] Error 2
    make: *** Waiting for unfinished jobs....
    
    simpleImage.<dt> works like a phony target that generates multiple
    images. Reflect the real behavior. I removed the DT directory path
    information because it is already explained a few lines below.
    
    While I am here, I deleted the redundant *_defconfig explanation.
    
    The top-level Makefile caters to list available defconfig files:
    
      mmu_defconfig            - Build for mmu
      nommu_defconfig          - Build for nommu
    
    Signed-off-by: Masahiro Yamada <yamada.masahiro@socionext.com>
    Signed-off-by: Michal Simek <michal.simek@xilinx.com>

commit fbb080a1fcad340a6337d850ce4ff21f84635b03
Author: Boris Brezillon <boris.brezillon@bootlin.com>
Date:   Sun Nov 11 08:55:08 2018 +0100

    mtd: rawnand: ams-delta: Allow this driver to be compiled when COMPILE_TEST=y
    
    Drop the asm and mach headers inclusion and allow this driver to be
    compiled when COMPILE_TEST=y in order to increase compile-test
    coverage.
    
    Signed-off-by: Boris Brezillon <boris.brezillon@bootlin.com>
    Tested-by: Janusz Krzysztofik <jmkrzyszt@gmail.com>
    Signed-off-by: Miquel Raynal <miquel.raynal@bootlin.com>

commit c820518f6ca150d099aaeb7b71ad9e96c61113c0
Author: Geert Uytterhoeven <geert@linux-m68k.org>
Date:   Fri Jun 22 13:04:19 2018 +0200

    firewire: Remove depends on HAS_DMA in case of platform dependency
    
    Remove dependencies on HAS_DMA where a Kconfig symbol depends on another
    symbol that implies HAS_DMA, and, optionally, on "|| COMPILE_TEST".
    In most cases this other symbol is an architecture or platform specific
    symbol, or PCI.
    
    Generic symbols and drivers without platform dependencies keep their
    dependencies on HAS_DMA, to prevent compiling subsystems or drivers that
    cannot work anyway.
    
    This simplifies the dependencies, and allows to improve compile-testing.
    
    Signed-off-by: Geert Uytterhoeven <geert@linux-m68k.org>
    Reviewed-by: Mark Brown <broonie@kernel.org>
    Acked-by: Robin Murphy <robin.murphy@arm.com>
    Signed-off-by: Stefan Richter <stefanr@s5r6.in-berlin.de>

commit 0be66f394efdfb832f01248a0e043ae56c886cc1
Merge: 1e8518aa6593 2b45ebef39a2
Author: Olof Johansson <olof@lixom.net>
Date:   Fri Nov 30 15:47:23 2018 -0800

    Merge tag 'amlogic-drivers' of https://git.kernel.org/pub/scm/linux/kernel/git/khilman/linux-amlogic into next/drivers
    
    Amlogic SoC drivers for v4.21
    - new clock measurement driver and bindings
    - COMPILE_TEST fix
    
    * tag 'amlogic-drivers' of https://git.kernel.org/pub/scm/linux/kernel/git/khilman/linux-amlogic:
      soc: amlogic: Add Meson Clock Measure driver
      dt-bindings: amlogic: Add Internal Clock Measurer bindings
      drivers: soc: Allow building the amlogic drivers without ARCH_MESON
    
    Signed-off-by: Olof Johansson <olof@lixom.net>

commit 29bdedfd9cf40e59456110ca417a8cb672ac9b92
Author: Lukas Wunner <lukas@wunner.de>
Date:   Thu Nov 29 15:14:49 2018 +0100

    spi: bcm2835: Unbreak the build of esoteric configs
    
    Commit e82b0b382845 ("spi: bcm2835: Fix race on DMA termination") broke
    the build with COMPILE_TEST=y on arches whose cmpxchg() requires 32-bit
    operands (xtensa, older arm ISAs).
    
    Fix by changing the dma_pending flag's type from bool to unsigned int.
    
    Fixes: e82b0b382845 ("spi: bcm2835: Fix race on DMA termination")
    Signed-off-by: Lukas Wunner <lukas@wunner.de>
    Signed-off-by: Mark Brown <broonie@kernel.org>
    Cc: Frank Pavlic <f.pavlic@kunbus.de>
    Cc: Martin Sperl <kernel@martin.sperl.org>
    Cc: Noralf Trnnes <noralf@tronnes.org>

commit 4e3c7c00bba0636b97eb23d582c20b0f5d95ce20
Author: YueHaibing <yuehaibing@huawei.com>
Date:   Sat Nov 24 18:16:41 2018 +0800

    net: aquantia: return 'err' if set MPI_DEINIT state fails
    
    Fixes gcc '-Wunused-but-set-variable' warning:
    
    drivers/net/ethernet/aquantia/atlantic/hw_atl/hw_atl_utils.c:260:7:
     warning: variable 'err' set but not used [-Wunused-but-set-variable]
    
    'err' should be returned while set MPI_DEINIT state fails
    in hw_atl_utils_soft_reset.
    
    Fixes: cce96d1883da ("net: aquantia: Regression on reset with 1.x firmware")
    Signed-off-by: YueHaibing <yuehaibing@huawei.com>
    Signed-off-by: David S. Miller <davem@davemloft.net>

commit 0925fe3d2eb6907dd2bf6e6521be6c8d52045c2d
Author: Masahiro Yamada <yamada.masahiro@socionext.com>
Date:   Mon Nov 27 21:15:13 2017 +0900

    kbuild: move cc-option and cc-disable-warning after incl. arch Makefile
    
    commit cfe17c9bbe6a673fdafdab179c32b355ed447f66 upstream.
    
    Geert reported commit ae6b289a3789 ("kbuild: Set KBUILD_CFLAGS before
    incl. arch Makefile") broke cross-compilation using a cross-compiler
    that supports less compiler options than the host compiler.
    
    For example,
    
      cc1: error: unrecognized command line option "-Wno-unused-but-set-variable"
    
    This problem happens on architectures that setup CROSS_COMPILE in their
    arch/*/Makefile.
    
    Move the cc-option and cc-disable-warning back to the original position,
    but keep the Clang target options untouched.
    
    Fixes: ae6b289a3789 ("kbuild: Set KBUILD_CFLAGS before incl. arch Makefile")
    Reported-by: Geert Uytterhoeven <geert@linux-m68k.org>
    Signed-off-by: Masahiro Yamada <yamada.masahiro@socionext.com>
    Tested-by: Geert Uytterhoeven <geert@linux-m68k.org>
    [nc: Adjust context]
    Signed-off-by: Nathan Chancellor <natechancellor@gmail.com>
    Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>

commit 7e6782271fd832c5ae1e038147ede8e27195cc95
Author: Stephen Mallon <stephen.mallon@sydney.edu.au>
Date:   Tue Nov 20 19:15:02 2018 +1100

    tcp: Fix SOF_TIMESTAMPING_RX_HARDWARE to use the latest timestamp during TCP coalescing
    
    [ Upstream commit cadf9df27e7cf40e390e060a1c71bb86ecde798b ]
    
    During tcp coalescing ensure that the skb hardware timestamp refers to the
    highest sequence number data.
    Previously only the software timestamp was updated during coalescing.
    
    Signed-off-by: Stephen Mallon <stephen.mallon@sydney.edu.au>
    Signed-off-by: Eric Dumazet <edumazet@google.com>
    Signed-off-by: David S. Miller <davem@davemloft.net>
    Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>

commit 901c46620f2fb8f93e0888b658e424f38e706cba
Author: Christophe Leroy <christophe.leroy@c-s.fr>
Date:   Fri Oct 19 06:12:50 2018 +0000

    powerpc/msi: Fix compile error on mpc83xx
    
    commit 0f99153def98134403c9149128e59d3e1786cf04 upstream.
    
    mpic_get_primary_version() is not defined when not using MPIC.
    The compile error log like:
    
    arch/powerpc/sysdev/built-in.o: In function `fsl_of_msi_probe':
    fsl_msi.c:(.text+0x150c): undefined reference to `fsl_mpic_primary_get_version'
    
    Signed-off-by: Jia Hongtao <hongtao.jia@freescale.com>
    Signed-off-by: Scott Wood <scottwood@freescale.com>
    Reported-by: Radu Rendec <radu.rendec@gmail.com>
    Fixes: 807d38b73b6 ("powerpc/mpic: Add get_version API both for internal and external use")
    Cc: stable@vger.kernel.org
    Signed-off-by: Christophe Leroy <christophe.leroy@c-s.fr>
    Signed-off-by: Michael Ellerman <mpe@ellerman.id.au>
    Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>

commit cadf9df27e7cf40e390e060a1c71bb86ecde798b
Author: Stephen Mallon <stephen.mallon@sydney.edu.au>
Date:   Tue Nov 20 19:15:02 2018 +1100

    tcp: Fix SOF_TIMESTAMPING_RX_HARDWARE to use the latest timestamp during TCP coalescing
    
    During tcp coalescing ensure that the skb hardware timestamp refers to the
    highest sequence number data.
    Previously only the software timestamp was updated during coalescing.
    
    Signed-off-by: Stephen Mallon <stephen.mallon@sydney.edu.au>
    Signed-off-by: Eric Dumazet <edumazet@google.com>
    Signed-off-by: David S. Miller <davem@davemloft.net>

commit 7ef091768df9d4da21c78e4bd8a00d002adde23a
Author: Mike Marciniszyn <mike.marciniszyn@intel.com>
Date:   Fri May 18 17:07:01 2018 -0700

    IB/qib: Fix DMA api warning with debug kernel
    
    commit 0252f73334f9ef68868e4684200bea3565a4fcee upstream.
    
    The following error occurs in a debug build when running MPI PSM:
    
    [  307.415911] WARNING: CPU: 4 PID: 23867 at lib/dma-debug.c:1158
    check_unmap+0x4ee/0xa20
    [  307.455661] ib_qib 0000:05:00.0: DMA-API: device driver failed to check map
    error[device address=0x00000000df82b000] [size=4096 bytes] [mapped as page]
    [  307.517494] Modules linked in:
    [  307.531584]  ib_isert iscsi_target_mod ib_srpt target_core_mod rpcrdma
    sunrpc ib_srp scsi_transport_srp scsi_tgt ib_iser libiscsi ib_ipoib
    scsi_transport_iscsi rdma_ucm ib_ucm ib_uverbs ib_umad rdma_cm ib_cm iw_cm
    ib_qib intel_powerclamp coretemp rdmavt intel_rapl iosf_mbi kvm_intel kvm
    irqbypass crc32_pclmul ghash_clmulni_intel ipmi_ssif ib_core aesni_intel sg
    ipmi_si lrw gf128mul dca glue_helper ipmi_devintf iTCO_wdt gpio_ich hpwdt
    iTCO_vendor_support ablk_helper hpilo acpi_power_meter cryptd ipmi_msghandler
    ie31200_edac shpchp pcc_cpufreq lpc_ich pcspkr ip_tables xfs libcrc32c sd_mod
    crc_t10dif crct10dif_generic mgag200 i2c_algo_bit drm_kms_helper syscopyarea
    sysfillrect sysimgblt fb_sys_fops ttm ahci crct10dif_pclmul crct10dif_common
    drm crc32c_intel libahci tg3 libata serio_raw ptp i2c_core
    [  307.846113]  pps_core dm_mirror dm_region_hash dm_log dm_mod
    [  307.866505] CPU: 4 PID: 23867 Comm: mpitests-IMB-MP Kdump: loaded Not
    tainted 3.10.0-862.el7.x86_64.debug #1
    [  307.911178] Hardware name: HP ProLiant DL320e Gen8, BIOS J05 11/09/2013
    [  307.944206] Call Trace:
    [  307.956973]  [<ffffffffbd9e915b>] dump_stack+0x19/0x1b
    [  307.982201]  [<ffffffffbd2a2f58>] __warn+0xd8/0x100
    [  308.005999]  [<ffffffffbd2a2fdf>] warn_slowpath_fmt+0x5f/0x80
    [  308.034260]  [<ffffffffbd5f667e>] check_unmap+0x4ee/0xa20
    [  308.060801]  [<ffffffffbd41acaa>] ? page_add_file_rmap+0x2a/0x1d0
    [  308.090689]  [<ffffffffbd5f6c4d>] debug_dma_unmap_page+0x9d/0xb0
    [  308.120155]  [<ffffffffbd4082e0>] ? might_fault+0xa0/0xb0
    [  308.146656]  [<ffffffffc07761a5>] qib_tid_free.isra.14+0x215/0x2a0 [ib_qib]
    [  308.180739]  [<ffffffffc0776bf4>] qib_write+0x894/0x1280 [ib_qib]
    [  308.210733]  [<ffffffffbd540b00>] ? __inode_security_revalidate+0x70/0x80
    [  308.244837]  [<ffffffffbd53c2b7>] ? security_file_permission+0x27/0xb0
    [  308.266025] qib_ib0.8006: multicast join failed for
    ff12:401b:8006:0000:0000:0000:ffff:ffff, status -22
    [  308.323421]  [<ffffffffbd46f5d3>] vfs_write+0xc3/0x1f0
    [  308.347077]  [<ffffffffbd492a5c>] ? fget_light+0xfc/0x510
    [  308.372533]  [<ffffffffbd47045a>] SyS_write+0x8a/0x100
    [  308.396456]  [<ffffffffbd9ff355>] system_call_fastpath+0x1c/0x21
    
    The code calls a qib_map_page() which has never correctly tested for a
    mapping error.
    
    Fix by testing for pci_dma_mapping_error() in all cases and properly
    handling the failure in the caller.
    
    Additionally, streamline qib_map_page() arguments to satisfy just
    the single caller.
    
    Reviewed-by: Alex Estrin <alex.estrin@intel.com>
    Tested-by: Don Dutile <ddutile@redhat.com>
    Reviewed-by: Don Dutile <ddutile@redhat.com>
    Signed-off-by: Mike Marciniszyn <mike.marciniszyn@intel.com>
    Signed-off-by: Dennis Dalessandro <dennis.dalessandro@intel.com>
    Signed-off-by: Doug Ledford <dledford@redhat.com>
    [bwh: Backported to 3.16: adjust context]
    Signed-off-by: Ben Hutchings <ben@decadent.org.uk>

commit 0035168323cada6fed717d4eb1415156d300fd65
Author: Michael Ellerman <mpe@ellerman.id.au>
Date:   Tue Apr 17 00:39:02 2018 +1000

    powerpc/lib: Fix feature fixup test of external branch
    
    commit 32810d91325ec76b8ef4df463f8a0e9baf353322 upstream.
    
    The expected case for this test was wrong, the source of the alternate
    code sequence is:
    
      FTR_SECTION_ELSE
      2:    or      2,2,2
            PPC_LCMPI       r3,1
            beq     3f
            blt     2b
            b       3f
            b       1b
      ALT_FTR_SECTION_END(0, 1)
      3:    or      1,1,1
            or      2,2,2
      4:    or      3,3,3
    
    So when it's patched the '3' label should still be on the 'or 1,1,1',
    and the 4 label is irrelevant and can be removed.
    
    Fixes: 362e7701fd18 ("powerpc: Add self-tests of the feature fixup code")
    Signed-off-by: Michael Ellerman <mpe@ellerman.id.au>
    Signed-off-by: Ben Hutchings <ben@decadent.org.uk>

commit e8bd8fca6773ef49390269bd467bf940a0841ccf
Author: Yousuk Seung <ysseung@google.com>
Date:   Thu Nov 15 16:44:12 2018 -0800

    tcp: add SRTT to SCM_TIMESTAMPING_OPT_STATS
    
    Add TCP_NLA_SRTT to SCM_TIMESTAMPING_OPT_STATS that reports the smoothed
    round trip time in microseconds (tcp_sock.srtt_us >> 3).
    
    Signed-off-by: Yousuk Seung <ysseung@google.com>
    Signed-off-by: Eric Dumazet <edumazet@google.com>
    Acked-by: Soheil Hassas Yeganeh <soheil@google.com>
    Acked-by: Neal Cardwell <ncardwell@google.com>
    Acked-by: Yuchung Cheng <ycheng@google.com>
    Signed-off-by: David S. Miller <davem@davemloft.net>

commit 41bb5769b7f4b7a85e4b92c37429228279b4f569
Author: Maxime Jourdan <mjourdan@baylibre.com>
Date:   Mon Nov 12 17:46:54 2018 +0100

    drivers: soc: Allow building the amlogic drivers without ARCH_MESON
    
    The current condition makes it difficult to compile the amlogic/
    drivers with COMPILE_TEST, or without ARCH_MESON in general.
    
    Fixes kbuild errors with patch series that depend on drivers in that
    directory, for instance the meson video decoder.
    
    Signed-off-by: Maxime Jourdan <mjourdan@baylibre.com>
    Signed-off-by: Kevin Hilman <khilman@baylibre.com>

commit 7c68024a82a2f71e79ef29edccd6e8ce1d2f44f4
Author: Olof Johansson <olof@lixom.net>
Date:   Thu Nov 1 19:57:28 2018 -0700

    pinctrl: mediatek: Fix dependencies for EINT_MTK
    
    Fixes the following config-time warning:
    
    WARNING: unmet direct dependencies detected for EINT_MTK
      Depends on [n]: PINCTRL [=y] && (ARCH_MEDIATEK [=y] || COMPILE_TEST [=n]) && (PINCTRL_MTK [=n] || PINCTRL_MTK_MOORE [=n] || COMPILE_TEST [=n])
      Selected by [y]:
      - PINCTRL_MTK_PARIS [=y] && PINCTRL [=y] && OF [=y] && (ARCH_MEDIATEK [=y] || COMPILE_TEST [=n])
    
    Fixes: 805250982bb5 ("pinctrl: mediatek: add pinctrl-paris that implements the vendor dt-bindings")
    Signed-off-by: Olof Johansson <olof@lixom.net>
    Acked-by: Sean Wang <sean.wang@kernel.org>
    Signed-off-by: Linus Walleij <linus.walleij@linaro.org>

commit 38b57496ae2c0370c339be19255d4d53f2742642
Author: Christophe Leroy <christophe.leroy@c-s.fr>
Date:   Fri Oct 19 06:12:50 2018 +0000

    powerpc/msi: Fix compile error on mpc83xx
    
    commit 0f99153def98134403c9149128e59d3e1786cf04 upstream.
    
    mpic_get_primary_version() is not defined when not using MPIC.
    The compile error log like:
    
    arch/powerpc/sysdev/built-in.o: In function `fsl_of_msi_probe':
    fsl_msi.c:(.text+0x150c): undefined reference to `fsl_mpic_primary_get_version'
    
    Signed-off-by: Jia Hongtao <hongtao.jia@freescale.com>
    Signed-off-by: Scott Wood <scottwood@freescale.com>
    Reported-by: Radu Rendec <radu.rendec@gmail.com>
    Fixes: 807d38b73b6 ("powerpc/mpic: Add get_version API both for internal and external use")
    Cc: stable@vger.kernel.org
    Signed-off-by: Christophe Leroy <christophe.leroy@c-s.fr>
    Signed-off-by: Michael Ellerman <mpe@ellerman.id.au>
    Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>

commit dfed53c894d5578031175d11bc56e3031ce0991b
Author: Christophe Leroy <christophe.leroy@c-s.fr>
Date:   Fri Oct 19 06:12:50 2018 +0000

    powerpc/msi: Fix compile error on mpc83xx
    
    commit 0f99153def98134403c9149128e59d3e1786cf04 upstream.
    
    mpic_get_primary_version() is not defined when not using MPIC.
    The compile error log like:
    
    arch/powerpc/sysdev/built-in.o: In function `fsl_of_msi_probe':
    fsl_msi.c:(.text+0x150c): undefined reference to `fsl_mpic_primary_get_version'
    
    Signed-off-by: Jia Hongtao <hongtao.jia@freescale.com>
    Signed-off-by: Scott Wood <scottwood@freescale.com>
    Reported-by: Radu Rendec <radu.rendec@gmail.com>
    Fixes: 807d38b73b6 ("powerpc/mpic: Add get_version API both for internal and external use")
    Cc: stable@vger.kernel.org
    Signed-off-by: Christophe Leroy <christophe.leroy@c-s.fr>
    Signed-off-by: Michael Ellerman <mpe@ellerman.id.au>
    Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>

commit c0668860758ead905b998dc78e9e61a814ff43fa
Author: Christophe Leroy <christophe.leroy@c-s.fr>
Date:   Fri Oct 19 06:12:50 2018 +0000

    powerpc/msi: Fix compile error on mpc83xx
    
    commit 0f99153def98134403c9149128e59d3e1786cf04 upstream.
    
    mpic_get_primary_version() is not defined when not using MPIC.
    The compile error log like:
    
    arch/powerpc/sysdev/built-in.o: In function `fsl_of_msi_probe':
    fsl_msi.c:(.text+0x150c): undefined reference to `fsl_mpic_primary_get_version'
    
    Signed-off-by: Jia Hongtao <hongtao.jia@freescale.com>
    Signed-off-by: Scott Wood <scottwood@freescale.com>
    Reported-by: Radu Rendec <radu.rendec@gmail.com>
    Fixes: 807d38b73b6 ("powerpc/mpic: Add get_version API both for internal and external use")
    Cc: stable@vger.kernel.org
    Signed-off-by: Christophe Leroy <christophe.leroy@c-s.fr>
    Signed-off-by: Michael Ellerman <mpe@ellerman.id.au>
    Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>

commit 7607e1dad579cfb16a4a025f1cd06d9e7b04c2d1
Author: Christophe Leroy <christophe.leroy@c-s.fr>
Date:   Fri Oct 19 06:12:50 2018 +0000

    powerpc/msi: Fix compile error on mpc83xx
    
    commit 0f99153def98134403c9149128e59d3e1786cf04 upstream.
    
    mpic_get_primary_version() is not defined when not using MPIC.
    The compile error log like:
    
    arch/powerpc/sysdev/built-in.o: In function `fsl_of_msi_probe':
    fsl_msi.c:(.text+0x150c): undefined reference to `fsl_mpic_primary_get_version'
    
    Signed-off-by: Jia Hongtao <hongtao.jia@freescale.com>
    Signed-off-by: Scott Wood <scottwood@freescale.com>
    Reported-by: Radu Rendec <radu.rendec@gmail.com>
    Fixes: 807d38b73b6 ("powerpc/mpic: Add get_version API both for internal and external use")
    Cc: stable@vger.kernel.org
    Signed-off-by: Christophe Leroy <christophe.leroy@c-s.fr>
    Signed-off-by: Michael Ellerman <mpe@ellerman.id.au>
    Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>

commit c7f454d93d0caca9655a8c6e64a18c1febca4f6c
Author: Tony Lindgren <tony@atomide.com>
Date:   Mon Dec 1 11:10:15 2014 -0800

    usb: musb: Fix randconfig build issues for Kconfig options
    
    [ Upstream commit c0442479652b99b62dd1ffccb34231caff25751c ]
    
    Commit 82c02f58ba3a ("usb: musb: Allow multiple glue layers to be
    built in") enabled selecting multiple glue layers, which in turn
    exposed things more for randconfig builds. If NOP_USB_XCEIV is
    built-in and TUSB6010 is a loadable module, we will get:
    
    drivers/built-in.o: In function `tusb_remove':
    tusb6010.c:(.text+0x16a817): undefined reference to `usb_phy_generic_unregister'
    drivers/built-in.o: In function `tusb_probe':
    tusb6010.c:(.text+0x16b24e): undefined reference to `usb_phy_generic_register'
    make: *** [vmlinux] Error 1
    
    Let's fix this the same way as commit 70c1ff4b3c86 ("usb: musb:
    tusb-dma can't be built-in if tusb is not").
    
    And while at it, let's not allow selecting the glue layers except
    on platforms really using them unless COMPILE_TEST is specified:
    
    - TUSB6010 is in practise only used on omaps
    
    - DSPS is only used on TI platforms
    
    - UX500 is only used on STE platforms
    
    Cc: Linus Walleij <linus.walleij@linaro.org>
    Reported-by: Jim Davis <jim.epost@gmail.com>
    Signed-off-by: Tony Lindgren <tony@atomide.com>
    Signed-off-by: Felipe Balbi <balbi@ti.com>
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit 70e9f504774b35aacd7b43d873b51ec5260e58ad
Author: Paul E. McKenney <paulmck@linux.vnet.ibm.com>
Date:   Thu Sep 6 10:26:07 2018 -0700

    rcutorture: Add cross-compile capability to initrd.sh
    
    This adds the CROSS_COMPILE environment to the initrd.sh script's
    gcc command to enable cross compilation.
    
    Reported-by: Willy Tarreau <w@1wt.eu>
    Signed-off-by: Paul E. McKenney <paulmck@linux.vnet.ibm.com>

commit ff92b9dd9268507e23fc10cc4341626cef50367c
Author: Suganath Prabu <suganath-prabu.subramani@broadcom.com>
Date:   Thu Oct 25 19:33:40 2018 +0530

    scsi: mpt3sas: Update MPI headers to support Aero controllers
    
    Updating MPI headers to the latest version 2.6.7 to add support to the
    driver to detect the new 3816 and 3916 chip based controllers.  Separate
    out firmware image data from mpi2_ioc.h to new file mpi2_image.h
    
    Signed-off-by: Suganath Prabu <suganath-prabu.subramani@broadcom.com>
    Signed-off-by: Martin K. Petersen <martin.petersen@oracle.com>

commit 3c3bec81e267a6be198c540ea8d6f80e8f51b433
Author: Paul Burton <paul.burton@mips.com>
Date:   Mon Aug 20 15:36:17 2018 -0700

    compiler.h: Allow arch-specific asm/compiler.h
    
    [ Upstream commit 04f264d3a8b0eb25d378127bd78c3c9a0261c828 ]
    
    We have a need to override the definition of
    barrier_before_unreachable() for MIPS, which means we either need to add
    architecture-specific code into linux/compiler-gcc.h or we need to allow
    the architecture to provide a header that can define the macro before
    the generic definition. The latter seems like the better approach.
    
    A straightforward approach to the per-arch header is to make use of
    asm-generic to provide a default empty header & adjust architectures
    which don't need anything specific to make use of that by adding the
    header to generic-y. Unfortunately this doesn't work so well due to
    commit 28128c61e08e ("kconfig.h: Include compiler types to avoid missed
    struct attributes") which caused linux/compiler_types.h to be included
    in the compilation of every C file via the -include linux/kconfig.h flag
    in c_flags.
    
    Because the -include flag is present for all C files we compile, we need
    the architecture-provided header to be present before any C files are
    compiled. If any C files can be compiled prior to the asm-generic header
    wrappers being generated then we hit a build failure due to missing
    header. Such cases do exist - one pointed out by the kbuild test robot
    is the compilation of arch/ia64/kernel/nr-irqs.c, which occurs as part
    of the archprepare target [1].
    
    This leaves us with a few options:
    
      1) Use generic-y & fix any build failures we find by enforcing
         ordering such that the asm-generic target occurs before any C
         compilation, such that linux/compiler_types.h can always include
         the generated asm-generic wrapper which in turn includes the empty
         asm-generic header. This would rely on us finding all the
         problematic cases - I don't know for sure that the ia64 issue is
         the only one.
    
      2) Add an actual empty header to each architecture, so that we don't
         need the generated asm-generic wrapper. This seems messy.
    
      3) Give up & add #ifdef CONFIG_MIPS or similar to
         linux/compiler_types.h. This seems messy too.
    
      4) Include the arch header only when it's actually needed, removing
         the need for the asm-generic wrapper for all other architectures.
    
    This patch allows us to use approach 4, by including an asm/compiler.h
    header from linux/compiler_types.h after the inclusion of the
    compiler-specific linux/compiler-*.h header(s). We do this
    conditionally, only when CONFIG_HAVE_ARCH_COMPILER_H is selected, in
    order to avoid the need for asm-generic wrappers & the associated build
    ordering issue described above. The asm/compiler.h header is included
    after the generic linux/compiler-*.h header(s) for consistency with the
    way linux/compiler-intel.h & linux/compiler-clang.h are included after
    the linux/compiler-gcc.h header that they override.
    
    [1] https://lists.01.org/pipermail/kbuild-all/2018-August/051175.html
    
    Signed-off-by: Paul Burton <paul.burton@mips.com>
    Reviewed-by: Masahiro Yamada <yamada.masahiro@socionext.com>
    Patchwork: https://patchwork.linux-mips.org/patch/20269/
    Cc: Arnd Bergmann <arnd@arndb.de>
    Cc: James Hogan <jhogan@kernel.org>
    Cc: Masahiro Yamada <yamada.masahiro@socionext.com>
    Cc: Ralf Baechle <ralf@linux-mips.org>
    Cc: linux-arch@vger.kernel.org
    Cc: linux-kbuild@vger.kernel.org
    Cc: linux-mips@linux-mips.org
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit f18ed65d70f019aae09437e5b6a317d365571208
Author: Paul Burton <paul.burton@mips.com>
Date:   Mon Aug 20 15:36:18 2018 -0700

    MIPS: Workaround GCC __builtin_unreachable reordering bug
    
    [ Upstream commit 906d441febc0de974b2a6ef848a8f058f3bfada3 ]
    
    Some versions of GCC for the MIPS architecture suffer from a bug which
    can lead to instructions from beyond an unreachable statement being
    incorrectly reordered into earlier branch delay slots if the unreachable
    statement is the only content of a case in a switch statement. This can
    lead to seemingly random behaviour, such as invalid memory accesses from
    incorrectly reordered loads or stores, and link failures on microMIPS
    builds.
    
    See this potential GCC fix for details:
    
        https://gcc.gnu.org/ml/gcc-patches/2015-09/msg00360.html
    
    Runtime problems resulting from this bug were initially observed using a
    maltasmvp_defconfig v4.4 kernel built using GCC 4.9.2 (from a Codescape
    SDK 2015.06-05 toolchain), with the result being an address exception
    taken after log messages about the L1 caches (during probe of the L2
    cache):
    
        Initmem setup node 0 [mem 0x0000000080000000-0x000000009fffffff]
        VPE topology {2,2} total 4
        Primary instruction cache 64kB, VIPT, 4-way, linesize 32 bytes.
        Primary data cache 64kB, 4-way, PIPT, no aliases, linesize 32 bytes
        <AdEL exception here>
    
    This is early enough that the kernel exception vectors are not in use,
    so any further output depends upon the bootloader. This is reproducible
    in QEMU where no further output occurs - ie. the system hangs here.
    Given the nature of the bug it may potentially be hit with differing
    symptoms. The bug is known to affect GCC versions as recent as 7.3, and
    it is unclear whether GCC 8 fixed it or just happens not to encounter
    the bug in the testcase found at the link above due to differing
    optimizations.
    
    This bug can be worked around by placing a volatile asm statement, which
    GCC is prevented from reordering past, prior to the
    __builtin_unreachable call.
    
    That was actually done already for other reasons by commit 173a3efd3edb
    ("bug.h: work around GCC PR82365 in BUG()"), but creates problems for
    microMIPS builds due to the lack of a .insn directive. The microMIPS ISA
    allows for interlinking with regular MIPS32 code by repurposing bit 0 of
    the program counter as an ISA mode bit. To switch modes one changes the
    value of this bit in the PC. However typical branch instructions encode
    their offsets as multiples of 2-byte instruction halfwords, which means
    they cannot change ISA mode - this must be done using either an indirect
    branch (a jump-register in MIPS terminology) or a dedicated jalx
    instruction. In order to ensure that regular branches don't attempt to
    target code in a different ISA which they can't actually switch to, the
    linker will check that branch targets are code in the same ISA as the
    branch.
    
    Unfortunately our empty asm volatile statements don't qualify as code,
    and the link for microMIPS builds fails with errors such as:
    
        arch/mips/mm/dma-default.s:3265: Error: branch to a symbol in another ISA mode
        arch/mips/mm/dma-default.s:5027: Error: branch to a symbol in another ISA mode
    
    Resolve this by adding a .insn directive within the asm statement which
    declares that what comes next is code. This may or may not be true,
    since we don't really know what comes next, but as this code is in an
    unreachable path anyway that doesn't matter since we won't execute it.
    
    We do this in asm/compiler.h & select CONFIG_HAVE_ARCH_COMPILER_H in
    order to have this included by linux/compiler_types.h after
    linux/compiler-gcc.h. This will result in asm/compiler.h being included
    in all C compilations via the -include linux/compiler_types.h argument
    in c_flags, which should be harmless.
    
    Signed-off-by: Paul Burton <paul.burton@mips.com>
    Fixes: 173a3efd3edb ("bug.h: work around GCC PR82365 in BUG()")
    Patchwork: https://patchwork.linux-mips.org/patch/20270/
    Cc: James Hogan <jhogan@kernel.org>
    Cc: Ralf Baechle <ralf@linux-mips.org>
    Cc: Arnd Bergmann <arnd@arndb.de>
    Cc: linux-mips@linux-mips.org
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit 755b72711bbc5986efe3ef76f38c64a81b7af591
Author: Paul Burton <paul.burton@mips.com>
Date:   Mon Aug 20 15:36:17 2018 -0700

    compiler.h: Allow arch-specific asm/compiler.h
    
    [ Upstream commit 04f264d3a8b0eb25d378127bd78c3c9a0261c828 ]
    
    We have a need to override the definition of
    barrier_before_unreachable() for MIPS, which means we either need to add
    architecture-specific code into linux/compiler-gcc.h or we need to allow
    the architecture to provide a header that can define the macro before
    the generic definition. The latter seems like the better approach.
    
    A straightforward approach to the per-arch header is to make use of
    asm-generic to provide a default empty header & adjust architectures
    which don't need anything specific to make use of that by adding the
    header to generic-y. Unfortunately this doesn't work so well due to
    commit 28128c61e08e ("kconfig.h: Include compiler types to avoid missed
    struct attributes") which caused linux/compiler_types.h to be included
    in the compilation of every C file via the -include linux/kconfig.h flag
    in c_flags.
    
    Because the -include flag is present for all C files we compile, we need
    the architecture-provided header to be present before any C files are
    compiled. If any C files can be compiled prior to the asm-generic header
    wrappers being generated then we hit a build failure due to missing
    header. Such cases do exist - one pointed out by the kbuild test robot
    is the compilation of arch/ia64/kernel/nr-irqs.c, which occurs as part
    of the archprepare target [1].
    
    This leaves us with a few options:
    
      1) Use generic-y & fix any build failures we find by enforcing
         ordering such that the asm-generic target occurs before any C
         compilation, such that linux/compiler_types.h can always include
         the generated asm-generic wrapper which in turn includes the empty
         asm-generic header. This would rely on us finding all the
         problematic cases - I don't know for sure that the ia64 issue is
         the only one.
    
      2) Add an actual empty header to each architecture, so that we don't
         need the generated asm-generic wrapper. This seems messy.
    
      3) Give up & add #ifdef CONFIG_MIPS or similar to
         linux/compiler_types.h. This seems messy too.
    
      4) Include the arch header only when it's actually needed, removing
         the need for the asm-generic wrapper for all other architectures.
    
    This patch allows us to use approach 4, by including an asm/compiler.h
    header from linux/compiler_types.h after the inclusion of the
    compiler-specific linux/compiler-*.h header(s). We do this
    conditionally, only when CONFIG_HAVE_ARCH_COMPILER_H is selected, in
    order to avoid the need for asm-generic wrappers & the associated build
    ordering issue described above. The asm/compiler.h header is included
    after the generic linux/compiler-*.h header(s) for consistency with the
    way linux/compiler-intel.h & linux/compiler-clang.h are included after
    the linux/compiler-gcc.h header that they override.
    
    [1] https://lists.01.org/pipermail/kbuild-all/2018-August/051175.html
    
    Signed-off-by: Paul Burton <paul.burton@mips.com>
    Reviewed-by: Masahiro Yamada <yamada.masahiro@socionext.com>
    Patchwork: https://patchwork.linux-mips.org/patch/20269/
    Cc: Arnd Bergmann <arnd@arndb.de>
    Cc: James Hogan <jhogan@kernel.org>
    Cc: Masahiro Yamada <yamada.masahiro@socionext.com>
    Cc: Ralf Baechle <ralf@linux-mips.org>
    Cc: linux-arch@vger.kernel.org
    Cc: linux-kbuild@vger.kernel.org
    Cc: linux-mips@linux-mips.org
    Signed-off-by: Sasha Levin <sashal@kernel.org>

commit a978a5b8d83f795e107a2ff759b28643739be70e
Author: Linus Torvalds <torvalds@linux-foundation.org>
Date:   Wed Oct 24 08:11:35 2018 +0100

    net/kconfig: Make QCOM_QMI_HELPERS available when COMPILE_TEST
    
    The networking merge brought in the experimental support for the
    Qualcomm ath10k system NOC, which selects QCOM_QMI_HELPERS as a
    dependency.
    
    But the ATH10K_SNOC option (which selects QCOM_QMI_HELPERS) depends on
    ARCH_QCOM || COMPILE_TEST in order to get wider build testing than just
    the unusual QCOM architecture build, while the QCOM_QMI_HELPERS option
    doesn't have that COMPILE_TEST option and is limited to only ARCH_QCOM.
    
    As a result, a "make allmodconfig" complains
    
      WARNING: unmet direct dependencies detected for QCOM_QMI_HELPERS
        Depends on [n]: ARCH_QCOM && NET [=y]
        Selected by [m]:
        - ATH10K_SNOC [=m] && NETDEVICES [=y] && WLAN [=y] && WLAN_VENDOR_ATH [=y] && ATH10K [=m] && (ARCH_QCOM || COMPILE_TEST [=y])
    
    Fix the config-time warning by making QCOM_QMI_HELPERS available when
    COMPILE_TEST, since the result seems to build fine.
    
    Cc: Bjorn Andersson <bjorn.andersson@linaro.org>
    Cc: Govind Singh <govinds@codeaurora.org>
    Cc: Kalle Valo <kvalo@codeaurora.org>
    Cc: David Miller <davem@davemloft.net>
    Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>

commit 0f99153def98134403c9149128e59d3e1786cf04
Author: Christophe Leroy <christophe.leroy@c-s.fr>
Date:   Fri Oct 19 06:12:50 2018 +0000

    powerpc/msi: Fix compile error on mpc83xx
    
    mpic_get_primary_version() is not defined when not using MPIC.
    The compile error log like:
    
    arch/powerpc/sysdev/built-in.o: In function `fsl_of_msi_probe':
    fsl_msi.c:(.text+0x150c): undefined reference to `fsl_mpic_primary_get_version'
    
    Signed-off-by: Jia Hongtao <hongtao.jia@freescale.com>
    Signed-off-by: Scott Wood <scottwood@freescale.com>
    Reported-by: Radu Rendec <radu.rendec@gmail.com>
    Fixes: 807d38b73b6 ("powerpc/mpic: Add get_version API both for internal and external use")
    Cc: stable@vger.kernel.org
    Signed-off-by: Christophe Leroy <christophe.leroy@c-s.fr>
    Signed-off-by: Michael Ellerman <mpe@ellerman.id.au>

commit 5d4c6663ebf6988bdb67676436234041ba715585
Author: Alexey Brodkin <abrodkin@synopsys.com>
Date:   Sun Sep 16 23:47:57 2018 +0300

    ARC: build: Don't set CROSS_COMPILE in arch's Makefile
    
    commit 40660f1fcee8d524a60b5101538e42b1f39f106d upstream.
    
    There's not much sense in doing that because if user or
    his build-system didn't set CROSS_COMPILE we still may
    very well make incorrect guess.
    
    But as it turned out setting CROSS_COMPILE is not as harmless
    as one may think: with recent changes that implemented automatic
    discovery of __host__ gcc features unconditional setup of
    CROSS_COMPILE leads to failures on execution of "make xxx_defconfig"
    with absent cross-compiler, for more info see [1].
    
    Set CROSS_COMPILE as well gets in the way if we want only to build
    .dtb's (again with absent cross-compiler which is not really needed
    for building .dtb's), see [2].
    
    Note, we had to change LIBGCC assignment type from ":=" to "="
    so that is is resolved on its usage, otherwise if it is resolved
    at declaration time with missing CROSS_COMPILE we're getting this
    error message from host GCC:
    
    | gcc: error: unrecognized command line option -mmedium-calls
    | gcc: error: unrecognized command line option -mno-sdata
    
    [1] http://lists.infradead.org/pipermail/linux-snps-arc/2018-September/004308.html
    [2] http://lists.infradead.org/pipermail/linux-snps-arc/2018-September/004320.html
    
    Signed-off-by: Alexey Brodkin <abrodkin@synopsys.com>
    Cc: Masahiro Yamada <yamada.masahiro@socionext.com>
    Cc: Rob Herring <robh@kernel.org>
    Signed-off-by: Vineet Gupta <vgupta@synopsys.com>
    Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>

commit 7b9f716d55500d72d9db5b6e47c72e1b4da30ddd
Author: Alexey Brodkin <abrodkin@synopsys.com>
Date:   Sun Sep 16 23:47:57 2018 +0300

    ARC: build: Don't set CROSS_COMPILE in arch's Makefile
    
    commit 40660f1fcee8d524a60b5101538e42b1f39f106d upstream.
    
    There's not much sense in doing that because if user or
    his build-system didn't set CROSS_COMPILE we still may
    very well make incorrect guess.
    
    But as it turned out setting CROSS_COMPILE is not as harmless
    as one may think: with recent changes that implemented automatic
    discovery of __host__ gcc features unconditional setup of
    CROSS_COMPILE leads to failures on execution of "make xxx_defconfig"
    with absent cross-compiler, for more info see [1].
    
    Set CROSS_COMPILE as well gets in the way if we want only to build
    .dtb's (again with absent cross-compiler which is not really needed
    for building .dtb's), see [2].
    
    Note, we had to change LIBGCC assignment type from ":=" to "="
    so that is is resolved on its usage, otherwise if it is resolved
    at declaration time with missing CROSS_COMPILE we're getting this
    error message from host GCC:
    
    | gcc: error: unrecognized command line option -mmedium-calls
    | gcc: error: unrecognized command line option -mno-sdata
    
    [1] http://lists.infradead.org/pipermail/linux-snps-arc/2018-September/004308.html
    [2] http://lists.infradead.org/pipermail/linux-snps-arc/2018-September/004320.html
    
    Signed-off-by: Alexey Brodkin <abrodkin@synopsys.com>
    Cc: Masahiro Yamada <yamada.masahiro@socionext.com>
    Cc: Rob Herring <robh@kernel.org>
    Signed-off-by: Vineet Gupta <vgupta@synopsys.com>
    Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>

commit 645ad2d5cccc4d52bd66f6132bd846211bdd6e48
Author: Alexey Brodkin <abrodkin@synopsys.com>
Date:   Sun Sep 16 23:47:57 2018 +0300

    ARC: build: Don't set CROSS_COMPILE in arch's Makefile
    
    commit 40660f1fcee8d524a60b5101538e42b1f39f106d upstream.
    
    There's not much sense in doing that because if user or
    his build-system didn't set CROSS_COMPILE we still may
    very well make incorrect guess.
    
    But as it turned out setting CROSS_COMPILE is not as harmless
    as one may think: with recent changes that implemented automatic
    discovery of __host__ gcc features unconditional setup of
    CROSS_COMPILE leads to failures on execution of "make xxx_defconfig"
    with absent cross-compiler, for more info see [1].
    
    Set CROSS_COMPILE as well gets in the way if we want only to build
    .dtb's (again with absent cross-compiler which is not really needed
    for building .dtb's), see [2].
    
    Note, we had to change LIBGCC assignment type from ":=" to "="
    so that is is resolved on its usage, otherwise if it is resolved
    at declaration time with missing CROSS_COMPILE we're getting this
    error message from host GCC:
    
    | gcc: error: unrecognized command line option -mmedium-calls
    | gcc: error: unrecognized command line option -mno-sdata
    
    [1] http://lists.infradead.org/pipermail/linux-snps-arc/2018-September/004308.html
    [2] http://lists.infradead.org/pipermail/linux-snps-arc/2018-September/004320.html
    
    Signed-off-by: Alexey Brodkin <abrodkin@synopsys.com>
    Cc: Masahiro Yamada <yamada.masahiro@socionext.com>
    Cc: Rob Herring <robh@kernel.org>
    Signed-off-by: Vineet Gupta <vgupta@synopsys.com>
    Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>

commit b12cef51b537d869f423c0f4bb2d2245ce2e5619
Author: Ioana Radulescu <ruxandra.radulescu@nxp.com>
Date:   Fri Oct 12 16:27:25 2018 +0000

    dpaa2-eth: Fix Kconfig dependencies
    
    Both ARCH_LAYERSCAPE and COMPILE_TEST dependencies are already implied
    through the FSL_MC_BUS dep, so there's no need to state it explicitly.
    
    Also, the fsl-mc bus depends on COMPILE_TEST only for some
    architectures (arm, arm64, ppc, x86), so it's not correct to
    claim build support unconditionally.
    
    Signed-off-by: Ioana Radulescu <ruxandra.radulescu@nxp.com>
    Signed-off-by: Ioana Ciornei <ioana.ciornei@nxp.com>
    Signed-off-by: David S. Miller <davem@davemloft.net>

commit a7c0b4b80f02d748031c785e30d380cfa7fd41ee
Author: Randy Dunlap <rdunlap@infradead.org>
Date:   Fri Oct 12 20:46:29 2018 -0700

    gpio: fix SNPS_CREG kconfig dependency warning
    
    Fix kconfig warning for GPIO_SNPS_CREG:
    
    WARNING: unmet direct dependencies detected for OF_GPIO
      Depends on [n]: GPIOLIB [=y] && OF [=n] && HAS_IOMEM [=y]
      Selected by [y]:
      - GPIO_SNPS_CREG [=y] && GPIOLIB [=y] && HAS_IOMEM [=y] && (ARC || COMPILE_TEST [=y])
    
    Drivers in drivers/gpio/Kconfig depend on OF_GPIO, not select it.
    This prevents attempting to build when OF is not enabled.
    
    Signed-off-by: Randy Dunlap <rdunlap@infradead.org>
    Cc: Linus Walleij <linus.walleij@linaro.org>
    Cc: linux-gpio@vger.kernel.org
    Cc: Eugeniy Paltsev <Eugeniy.Paltsev@synopsys.com>
    Signed-off-by: Linus Walleij <linus.walleij@linaro.org>

commit 01f7e0293f214aece9c56151d8b91fa516063833
Author: Han Xu <b45815@freescale.com>
Date:   Fri Oct 23 13:18:28 2015 -0500

    mtd: fsl-quadspi: fix macro collision problems with READ/WRITE
    
    commit 04850c4d8613127a9b488321c0ad83bff7519311 upstream.
    
    Change the READ/WRITE to FSL_READ/FSL_WRITE to resolve any possible
    namespace collisions with READ/WRITE macros (e.g., from <linux/fs.h>).
    
    Problems have been seen, for example, on mips:
    
    >> drivers/mtd/spi-nor/fsl-quadspi.c:186:5: error: 'LUT_0' undeclared (first use in this function)
          ((LUT_##ins) << INSTR0_SHIFT))
            ^
    >> drivers/mtd/spi-nor/fsl-quadspi.c:188:30: note: in expansion of macro 'LUT0'
    
    On SPARC:
    
    drivers/mtd/spi-nor/fsl-quadspi.c: In function 'fsl_qspi_init_lut':
    drivers/mtd/spi-nor/fsl-quadspi.c:369:1: error: 'LUT_0' undeclared (first use in this function)
    drivers/mtd/spi-nor/fsl-quadspi.c:418:1: error: pasting "LUT_" and "(" does not give a valid preprocessing token
    drivers/mtd/spi-nor/fsl-quadspi.c:418:2: error: implicit declaration of function 'LUT_'
    
    And surely on others.
    
    Fixes: d26a22d06708 ("mtd: fsl-quadspi: allow building for other ARCHes with COMPILE_TEST")
    Reported-by: Guenter Roeck <linux@roeck-us.net>
    Reported-by: kbuild test robot <fengguang.wu@intel.com>
    Signed-off-by: Han Xu <b45815@freescale.com>
    [Brian: rewrote commit description]
    Signed-off-by: Brian Norris <computersforpeace@gmail.com>
    Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>

commit a6deaa99591098a3e558978c6cec0054fd1d3b97
Merge: e40a826a6cbc 1f2cf1b39b93
Author: David S. Miller <davem@davemloft.net>
Date:   Wed Oct 10 10:06:03 2018 -0700

    Merge branch 'octeontx2-af-Add-RVU-Admin-Function-driver'
    
    Sunil Goutham says:
    
    ====================
    octeontx2-af: Add RVU Admin Function driver
    
    Resource virtualization unit (RVU) on Marvell's OcteonTX2 SOC maps HW
    resources from the network, crypto and other functional blocks into
    PCI-compatible physical and virtual functions. Each functional block
    again has multiple local functions (LFs) for provisioning to PCI devices.
    RVU supports multiple PCIe SRIOV physical functions (PFs) and virtual
    functions (VFs). PF0 is called the administrative / admin function (AF)
    and has privileges to provision RVU functional block's LFs to each of the
    PF/VF.
    
    RVU managed networking functional blocks
     - Network pool allocator (NPA)
     - Network interface controller (NIX)
     - Network parser CAM (NPC)
     - Schedule/Synchronize/Order unit (SSO)
    
    RVU managed non-networking functional blocks
     - Crypto accelerator (CPT)
     - Scheduled timers unit (TIM)
     - Schedule/Synchronize/Order unit (SSO)
       Used for both networking and non networking usecases
     - Compression (upcoming in future variants of the silicons)
    
    Resource provisioning examples
     - A PF/VF with NIX-LF & NPA-LF resources works as a pure network device
     - A PF/VF with CPT-LF resource works as a pure cyrpto offload device.
    
    This admin function driver neither receives any data nor processes it i.e
    no I/O, a configuration only driver.
    
    PF/VFs communicates with AF via a shared memory region (mailbox). Upon
    receiving requests from PF/VF, AF does resource provisioning and other
    HW configuration. AF is always attached to host, but PF/VFs may be used
    by host kernel itself, or attached to VMs or to userspace applications
    like DPDK etc. So AF has to handle provisioning/configuration requests
    sent by any device from any domain.
    
    This patch series adds logic for the following
     - RVU AF driver with functional blocks provisioning support.
     - Mailbox infrastructure for communication between AF and PFs.
     - CGX (MAC controller) driver which communicates with firmware for
       managing  physical ethernet interfaces. AF collects info from this
       driver and forwards the same to the PF/VFs uaing these interfaces.
    
    This is the first set of patches out of 80+ patches.
    
    Changes from v8:
     1 Removed unnecessary typecasts in entire series
       - Suggested by David Miller
     2 Added COMPILE_TEST to AF driver
       - Suggested by Arnd Bergmann
     3 Changed udelay() to usleep_range() in rvu_poll_reg
       - Suggested by Arnd Bergmann
     4 MSIX vector base IOMMU mapping is done using dma_map_resource()
       API instead of dma_map_single() as it accepts physical address.
       - Issue pointed by Arnd Bergmann
    
    Changes from v7:
     1 Removed unnecessary typecasts in mbox infra code.
       - Suggested by David Miller
     2 Fixed MAINTAINERS patch
       - Suggested by Joe Perches
    
    Changes from v6:
     Fixed ordering of local variables from longest to shortest line.
       - Suggested by David Miller
    
    Changes from v5:
     Modified bitfield based command structures to bitmasks for communication
     with firmware, to address endianness issues.
       - Suggested by Arnd Bergmann
    
    Changes from v4:
     1 Removed module author/version/description from CGX driver as it's now
       merged with AF driver module.
       - Suggested by Arnd Bergmann
     2 Added big-endian bitfields for CGX's kernel <=> firmware communication
       command structures.
       - Suggested by Arnd Bergmann
    
    Changes from v3:
     Moved driver from drivers/soc to drivers/net/ethernet
       - Suggested by Arnd Bergmann
     https://patchwork.kernel.org/cover/10587635/
    
    Changes from v2:
     No changes, submitted again with netdev mailing list in loop.
       - Suggested by Arnd Bergmann and Andrew Lunn
    
    Changes from v1:
     1 Merged RVU admin function and CGX drivers into a single module
       - Suggested by Arnd Bergmann
     2 Pulled mbox communication APIs into a separate module to remove
       admin function driver dependency in a VM where AF is not attached.
       - Suggested by Arnd Bergmann
    ====================
    
    Reviewed-by: Arnd Bergmann <arnd@arndb.de>
    Signed-off-by: David S. Miller <davem@davemloft.net>

commit 64c5e530ac2cab7e710c3bd08ef8594a016e4f9a
Merge: 0854ba5ff5c9 c58a584f05e3
Author: Greg Kroah-Hartman <gregkh@linuxfoundation.org>
Date:   Tue Oct 9 09:17:46 2018 +0200

    Merge tag 'arc-4.19-rc8' of git://git.kernel.org/pub/scm/linux/kernel/git/vgupta/arc
    
    Vineet writes:
       "ARC updates for 4.19-rc8
        - Fix clone syscall to update Thread pointer register
        - Make/build updates (needed for AGL/OE builds)   [Alexey]
        - Typo fix [Colin Ian King]"
    
    * tag 'arc-4.19-rc8' of git://git.kernel.org/pub/scm/linux/kernel/git/vgupta/arc:
      ARC: clone syscall to setp r25 as thread pointer
      ARC: build: Don't set CROSS_COMPILE in arch's Makefile
      ARC: fix spelling mistake "entires" -> "entries"
      ARC: build: Get rid of toolchain check
      ARCv2: build: use mcpu=hs38 iso generic mcpu=archs

commit 58b1e729b33acc558f2abb9e1e0178f060685c57
Author: Yangbo Lu <yangbo.lu@nxp.com>
Date:   Mon Oct 8 15:44:27 2018 +0800

    net: dpaa2: fix dependency of config FSL_DPAA2_ETH
    
    The NETDEVICES dependency and ETHERNET dependency hadn't
    been required since dpaa2-eth was moved out of staging.
    Also allowed COMPILE_TEST for dpaa2-eth.
    
    Signed-off-by: Yangbo Lu <yangbo.lu@nxp.com>
    Signed-off-by: David S. Miller <davem@davemloft.net>

commit 626f92a00b7e4b43c8eebebb5d80817633342aab
Author: Rob Herring <robh@kernel.org>
Date:   Tue Aug 21 15:41:19 2018 -0500

    c6x: enable building all dtbs
    
    Enable the 'dtbs' target for c6x. This allows building all the dts
    files in arch/c6x/boot/dts/ for enabled platforms or when
    COMPILE_TEST and OF_ALL_DTBS are enabled.
    
    Cc: Mark Salter <msalter@redhat.com>
    Cc: Aurelien Jacquiot <jacquiot.aurelien@gmail.com>
    Cc: linux-c6x-dev@linux-c6x.org
    Signed-off-by: Rob Herring <robh@kernel.org>

commit 27e88af4e94ee853261972aca1a364c4c567123d
Author: Rob Herring <robh@kernel.org>
Date:   Thu Aug 2 15:32:21 2018 -0600

    powerpc: enable building all dtbs
    
    Enable the 'dtbs' target for powerpc. This allows building all the dts
    files in arch/powerpc/boot/dts/ when COMPILE_TEST and OF_ALL_DTBS are
    enabled.
    
    Cc: Benjamin Herrenschmidt <benh@kernel.crashing.org>
    Cc: Paul Mackerras <paulus@samba.org>
    Cc: Michael Ellerman <mpe@ellerman.id.au>
    Cc: linuxppc-dev@lists.ozlabs.org
    Signed-off-by: Rob Herring <robh@kernel.org>

commit a91c614510478598051e8c49adb9863ee47959ec
Author: Rob Herring <robh@kernel.org>
Date:   Wed Aug 1 11:49:58 2018 -0600

    nios2: fix building all dtbs
    
    nios2 has a 'dtbs' target, but nothing is added to 'dtb-*' targets and
    no dtbs were getting built. This enables building all the dts files in
    arch/nios2/boot/dts/ when COMPILE_TEST and OF_ALL_DTBS are enabled.
    
    Cc: Ley Foon Tan <lftan@altera.com>
    Cc: nios2-dev@lists.rocketboards.org
    Signed-off-by: Rob Herring <robh@kernel.org>

commit 64d20b774f49b31e9d5ebe413d5c3d37195e9a64
Merge: 68b679b339e2 579fde69dc14
Author: Arnd Bergmann <arnd@arndb.de>
Date:   Tue Oct 2 10:11:05 2018 +0200

    Merge tag 'qcom-drivers-for-4.20' of git://git.kernel.org/pub/scm/linux/kernel/git/agross/linux into next/drivers
    
    Qualcomm ARM Based Driver Updates for v4.20
    
    * Refactor of SCM compatibles and clock requirements
    * SMEM cleanup
    * Add LLCC EDAC driver
    * Fixes for GENI clocks and macros
    * Fix includes for llcc-slice and smem
    * String overflow fixes for APR and wcnss_ctrl
    * Fixup for COMPILE_TEST of qcom driver Kconfigs
    * Cleanup of Kconfig depends of rpmh, smd_rpm, smsm, and smp2p
    * Add SCM dependencies to SPM and rmtfs-mem
    
    * tag 'qcom-drivers-for-4.20' of git://git.kernel.org/pub/scm/linux/kernel/git/agross/linux: (38 commits)
      soc: qcom: geni: geni_se_clk_freq_match() should always accept multiples
      soc: qcom: geni: Don't ignore clk_round_rate() errors in geni_se_clk_tbl_get()
      soc: qcom: geni: Make version macros simpler
      dt-bindings: firmware: scm: Add MSM8998 and SDM845
      firmware: qcom: scm: Refactor clock handling
      dt-bindings: firmware: scm: Refactor compatibles and clocks
      soc: qcom: smem: a few last cleanups
      soc: qcom: smem: verify partition host ids match
      soc: qcom: smem: small change in global entry loop
      soc: qcom: smem: verify partition offset_free_uncached
      soc: qcom: smem: verify partition header size
      soc: qcom: smem: introduce qcom_smem_partition_header()
      soc: qcom: smem: require order of host ids to match
      soc: qcom: smem: verify both host ids in partition header
      soc: qcom: smem: small refactor in qcom_smem_enumerate_partitions()
      soc: qcom: smem: always ignore partitions with 0 offset or size
      soc: qcom: smem: initialize region struct only when successful
      soc: qcom: smem: rename variable in qcom_smem_get_global()
      drivers: qcom: rpmh-rsc: clear wait_for_compl after use
      soc: qcom: rmtfs-mem: Validate that scm is available
      ...
    
    Signed-off-by: Arnd Bergmann <arnd@arndb.de>

commit 227db588a8a6f7f86e0ac8a8883689b7b20cecf3
Merge: 86e762d96713 69a8c2452caa
Author: Arnd Bergmann <arnd@arndb.de>
Date:   Tue Oct 2 09:59:03 2018 +0200

    Merge tag 'sunxi-drivers-for-4.20' of git://git.kernel.org/pub/scm/linux/kernel/git/sunxi/linux into next/drivers
    
    Allwinner drivers changes for 4.20
    
    The H6 is now supported in our SRAM driver bindings, and we have a small
    Makefile change for the SRAM driver to build it without building the
    ARCH_SUNXI architecture, especially relevant for the COMPILE_TEST case.
    
    * tag 'sunxi-drivers-for-4.20' of git://git.kernel.org/pub/scm/linux/kernel/git/sunxi/linux:
      dt-bindings: sunxi-sram: add binding for Allwinner H6 SRAM C
      drivers: soc: Allow building the sunxi driver without ARCH_SUNXI
    
    Signed-off-by: Arnd Bergmann <arnd@arndb.de>

commit 9376b1e7b62523c84fde34908af01a85b8d0468a
Author: Ard Biesheuvel <ard.biesheuvel@linaro.org>
Date:   Thu Sep 27 15:07:37 2018 +0200

    arm64: remove unused asm/compiler.h header file
    
    arm64 does not define CONFIG_HAVE_ARCH_COMPILER_H, nor does it keep
    anything useful in its copy of asm/compiler.h, so let's remove it
    before anybody starts using it.
    
    Acked-by: Will Deacon <will.deacon@arm.com>
    Signed-off-by: Ard Biesheuvel <ard.biesheuvel@linaro.org>
    Signed-off-by: Catalin Marinas <catalin.marinas@arm.com>

commit 53c156ab9d8aae2083d3c895365a3e39b864a5a7
Author: Arnd Bergmann <arnd@arndb.de>
Date:   Wed Sep 26 14:59:40 2018 +0200

    ASoC: atmel: add SND_SOC_I2C_AND_SPI dependency
    
    Selecting SND_SOC_WM8731 is only allowed when all its dependencies
    are already there:
    
    WARNING: unmet direct dependencies detected for SND_SOC_WM8731
      Depends on [m]: SOUND [=y] && !UML && SND [=y] && SND_SOC [=y] && SND_SOC_I2C_AND_SPI [=m]
      Selected by [y]:
      - SND_SOC_MIKROE_PROTO [=y] && SOUND [=y] && !UML && SND [=y] && SND_SOC [=y] && SND_ATMEL_SOC [=y] && OF [=y]
      Selected by [m]:
      - SND_AT91_SOC_SAM9X5_WM8731 [=m] && SOUND [=y] && !UML && SND [=y] && SND_SOC [=y] && SND_ATMEL_SOC [=y] && (ARCH_AT91 [=y] || COMPILE_TEST [=y]) && ATMEL_SSC [=y] && SND_SOC_I2C_AND_SPI [=m]
      - SND_SOC_ALL_CODECS [=m] && SOUND [=y] && !UML && SND [=y] && SND_SOC [=y] && COMPILE_TEST [=y] && SND_SOC_I2C_AND_SPI [=m]
    
    Fixes: a45f8853a5f9 ("ASoC: Add driver for PROTO Audio CODEC (with a WM8731)")
    Signed-off-by: Arnd Bergmann <arnd@arndb.de>
    Reviewed-by: Codrin Ciubotariu <codrin.ciubotariu@microchip.com>
    Signed-off-by: Mark Brown <broonie@kernel.org>

commit 01a16afcdd8e2451e120b7a515bffb228972294a
Author: Arnd Bergmann <arnd@arndb.de>
Date:   Tue Jul 24 19:11:27 2018 +0200

    omapfb: rename omap2 module to omap2fb.ko
    
    [ Upstream commit 4bcd8c90ac0f27d3d76fcfc50582ff3685059de9 ]
    
    In a kernel configuration with both CONFIG_FB_OMAP=m and CONFIG_FB_OMAP2=m,
    Kbuild fails to point out that we have two modules with the same name (omapfb.ko),
    but instead fails with a cryptic error message like:
    
    ERROR: "omapfb_register_panel" [drivers/video/fbdev/omap/lcd_osk.ko] undefined!
    
    This can now happen when building a randconfig kernel with CONFIG_ARCH_OMAP1,
    as the omap1 fbdev driver depends on that, whiel the omap2 fbdev driver can
    now be built anywhere with CONFIG_COMPILE_TEST.
    
    The solution is to rename one of the two modules, so for consistency with
    the directory naming I decided to rename the omap2 version to omap2fb.ko.
    
    Fixes: 7378f1149884 ("media: omap2: omapfb: allow building it with COMPILE_TEST")
    Signed-off-by: Arnd Bergmann <arnd@arndb.de>
    Acked-by: Tony Lindgren <tony@atomide.com>
    Cc: Mauro Carvalho Chehab <mchehab@s-opensource.com>
    Signed-off-by: Bartlomiej Zolnierkiewicz <b.zolnierkie@samsung.com>
    Signed-off-by: Sasha Levin <alexander.levin@microsoft.com>
    Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>

commit e8b53e57272c5bdd84c29491bd0a74e1e710bc46
Author: Masahiro Yamada <yamada.masahiro@socionext.com>
Date:   Fri Jul 20 16:46:34 2018 +0900

    kbuild: do not update config when running install targets
    
    [ Upstream commit d79424137a7312d381d131d707a462440c0e8df9 ]
    
    "make syncconfig" is automatically invoked when any of the following
    happens:
    
     - .config is updated
     - any of Kconfig files is updated
     - any of environment variables referenced in Kconfig is changed
    
    Then, it updates configuration files such as include/config/auto.conf
    include/generated/autoconf.h, etc.
    
    Even install targets (install, modules_install, etc.) are no exception.
    However, they should never ever modify the source tree.  Install
    targets are often run with root privileges.  Once those configuration
    files are owned by root, "make mrproper" would end up with permission
    error.
    
    Install targets should just copy things blindly.  They should not care
    whether the configuration is up-to-date or not.  This makes more sense
    because we are interested in the configuration that was used in the
    previous kernel building.
    
    This issue has existed since before, but rarely happened.  I expect
    more chance where people are hit by this; with the new Kconfig syntax
    extension, the .config now contains the compiler information.  If you
    cross-compile the kernel with CROSS_COMPILE, but forget to pass it
    for "make install", you meet "any of environment variables referenced
    in Kconfig is changed" because $(CC) is referenced in Kconfig.
    Another scenario is the compiler upgrade before the installation.
    
    Install targets need the configuration.  "make modules_install" refer
    to CONFIG_MODULES etc.  "make dtbs_install" also needs CONFIG_ARCH_*
    to decide which dtb files to install.  However, the auto-update of
    the configuration files should be avoided.  We already do this for
    external modules.
    
    Now, Make targets are categorized into 3 groups:
    
    [1] Do not need the kernel configuration at all
    
        help, coccicheck, headers_install etc.
    
    [2] Need the latest kernel configuration
    
        If new config options are added, Kconfig will show prompt to
        ask user's selection.
    
        Build targets such as vmlinux, in-kernel modules are the cases.
    
    [3] Need the kernel configuration, but do not want to update it
    
        Install targets except headers_install, and external modules
        are the cases.
    
    Signed-off-by: Masahiro Yamada <yamada.masahiro@socionext.com>
    Signed-off-by: Sasha Levin <alexander.levin@microsoft.com>
    Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>

commit f0d26e4807275d45e9e01b35b5071f3824107f29
Author: Dan Carpenter <dan.carpenter@oracle.com>
Date:   Wed Aug 8 14:57:24 2018 +0300

    powerpc: Fix size calculation using resource_size()
    
    [ Upstream commit c42d3be0c06f0c1c416054022aa535c08a1f9b39 ]
    
    The problem is the the calculation should be "end - start + 1" but the
    plus one is missing in this calculation.
    
    Fixes: 8626816e905e ("powerpc: add support for MPIC message register API")
    Signed-off-by: Dan Carpenter <dan.carpenter@oracle.com>
    Reviewed-by: Tyrel Datwyler <tyreld@linux.vnet.ibm.com>
    Signed-off-by: Michael Ellerman <mpe@ellerman.id.au>
    Signed-off-by: Sasha Levin <alexander.levin@microsoft.com>
    Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>

commit 40660f1fcee8d524a60b5101538e42b1f39f106d
Author: Alexey Brodkin <abrodkin@synopsys.com>
Date:   Sun Sep 16 23:47:57 2018 +0300

    ARC: build: Don't set CROSS_COMPILE in arch's Makefile
    
    There's not much sense in doing that because if user or
    his build-system didn't set CROSS_COMPILE we still may
    very well make incorrect guess.
    
    But as it turned out setting CROSS_COMPILE is not as harmless
    as one may think: with recent changes that implemented automatic
    discovery of __host__ gcc features unconditional setup of
    CROSS_COMPILE leads to failures on execution of "make xxx_defconfig"
    with absent cross-compiler, for more info see [1].
    
    Set CROSS_COMPILE as well gets in the way if we want only to build
    .dtb's (again with absent cross-compiler which is not really needed
    for building .dtb's), see [2].
    
    Note, we had to change LIBGCC assignment type from ":=" to "="
    so that is is resolved on its usage, otherwise if it is resolved
    at declaration time with missing CROSS_COMPILE we're getting this
    error message from host GCC:
    
    | gcc: error: unrecognized command line option -mmedium-calls
    | gcc: error: unrecognized command line option -mno-sdata
    
    [1] http://lists.infradead.org/pipermail/linux-snps-arc/2018-September/004308.html
    [2] http://lists.infradead.org/pipermail/linux-snps-arc/2018-September/004320.html
    
    Signed-off-by: Alexey Brodkin <abrodkin@synopsys.com>
    Cc: Masahiro Yamada <yamada.masahiro@socionext.com>
    Cc: Rob Herring <robh@kernel.org>
    Signed-off-by: Vineet Gupta <vgupta@synopsys.com>

commit 324493fba77500592bbaa66421729421f139d4b5
Author: Randy Dunlap <rdunlap@infradead.org>
Date:   Tue Aug 14 12:02:31 2018 -0400

    media: platform: fix cros-ec-cec build error
    
    Fix build when MFD_CROS_EC is not enabled but COMPILE_TEST=y.
    Fixes this build error:
    
    ERROR: "cros_ec_cmd_xfer_status" [drivers/media/platform/cros-ec-cec/cros-ec-cec.ko] undefined!
    
    Signed-off-by: Randy Dunlap <rdunlap@infradead.org>
    Cc: Neil Armstrong <narmstrong@baylibre.com>
    Signed-off-by: Hans Verkuil <hans.verkuil@cisco.com>
    Signed-off-by: Mauro Carvalho Chehab <mchehab+samsung@kernel.org>

commit 6f3bddbfb636ec091ec3bc516c4794fb3dac6ef2
Author: Dan Carpenter <dan.carpenter@oracle.com>
Date:   Wed Aug 8 14:57:24 2018 +0300

    powerpc: Fix size calculation using resource_size()
    
    [ Upstream commit c42d3be0c06f0c1c416054022aa535c08a1f9b39 ]
    
    The problem is the the calculation should be "end - start + 1" but the
    plus one is missing in this calculation.
    
    Fixes: 8626816e905e ("powerpc: add support for MPIC message register API")
    Signed-off-by: Dan Carpenter <dan.carpenter@oracle.com>
    Reviewed-by: Tyrel Datwyler <tyreld@linux.vnet.ibm.com>
    Signed-off-by: Michael Ellerman <mpe@ellerman.id.au>
    Signed-off-by: Sasha Levin <alexander.levin@microsoft.com>
    Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>

commit af675a6eefe905585bf954d0db309fdc022c6af2
Author: Dan Carpenter <dan.carpenter@oracle.com>
Date:   Wed Aug 8 14:57:24 2018 +0300

    powerpc: Fix size calculation using resource_size()
    
    [ Upstream commit c42d3be0c06f0c1c416054022aa535c08a1f9b39 ]
    
    The problem is the the calculation should be "end - start + 1" but the
    plus one is missing in this calculation.
    
    Fixes: 8626816e905e ("powerpc: add support for MPIC message register API")
    Signed-off-by: Dan Carpenter <dan.carpenter@oracle.com>
    Reviewed-by: Tyrel Datwyler <tyreld@linux.vnet.ibm.com>
    Signed-off-by: Michael Ellerman <mpe@ellerman.id.au>
    Signed-off-by: Sasha Levin <alexander.levin@microsoft.com>
    Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>

commit c80c4c93e47ede426bd4ba6ba6ee242862dbdc49
Author: Dan Carpenter <dan.carpenter@oracle.com>
Date:   Wed Aug 8 14:57:24 2018 +0300

    powerpc: Fix size calculation using resource_size()
    
    [ Upstream commit c42d3be0c06f0c1c416054022aa535c08a1f9b39 ]
    
    The problem is the the calculation should be "end - start + 1" but the
    plus one is missing in this calculation.
    
    Fixes: 8626816e905e ("powerpc: add support for MPIC message register API")
    Signed-off-by: Dan Carpenter <dan.carpenter@oracle.com>
    Reviewed-by: Tyrel Datwyler <tyreld@linux.vnet.ibm.com>
    Signed-off-by: Michael Ellerman <mpe@ellerman.id.au>
    Signed-off-by: Sasha Levin <alexander.levin@microsoft.com>
    Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>

commit f675ab001e78e6bff87bfd0018175119c3a5796b
Author: Dan Carpenter <dan.carpenter@oracle.com>
Date:   Wed Aug 8 14:57:24 2018 +0300

    powerpc: Fix size calculation using resource_size()
    
    [ Upstream commit c42d3be0c06f0c1c416054022aa535c08a1f9b39 ]
    
    The problem is the the calculation should be "end - start + 1" but the
    plus one is missing in this calculation.
    
    Fixes: 8626816e905e ("powerpc: add support for MPIC message register API")
    Signed-off-by: Dan Carpenter <dan.carpenter@oracle.com>
    Reviewed-by: Tyrel Datwyler <tyreld@linux.vnet.ibm.com>
    Signed-off-by: Michael Ellerman <mpe@ellerman.id.au>
    Signed-off-by: Sasha Levin <alexander.levin@microsoft.com>
    Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>

commit ccfb464cd106890cfa51070f75921a273e2852e5
Author: Niklas Cassel <niklas.cassel@linaro.org>
Date:   Wed Aug 29 09:57:23 2018 +0200

    soc: qcom: Allow COMPILE_TEST of qcom SoC Kconfigs
    
    Since commit cab673583d96 ("soc: Unconditionally include qcom Makefile"),
    we unconditionally include the soc/qcom/Makefile.
    
    This opens up the possibility to compile test the code even when building
    for other architectures.
    
    Allow COMPILE_TEST for all qcom SoC Kconfigs, except for two Kconfigs
    that depend on QCOM_SCM, since that triggers lots of build errors in
    qcom_scm.
    
    Signed-off-by: Niklas Cassel <niklas.cassel@linaro.org>
    Reviewed-by: Vivek Gautam <vivek.gautam@codeaurora.org>
    Reviewed-by: Vinod Koul <vkoul@kernel.org>
    Reviewed-by: Bjorn Andersson <bjorn.andersson@linaro.org>
    Signed-off-by: Andy Gross <andy.gross@linaro.org>

commit 15d8daf7bc2d1415f14f3cc3378226fc7d836156
Author: Andrew Lunn <andrew@lunn.ch>
Date:   Wed Sep 12 01:53:10 2018 +0200

    net: phy: bcm63xx: Allow to be built with COMPILE_TEST
    
    There is nothing in this driver which prevents it to be compiled for
    other architectures. Add COMPILE_TEST so we get better compile test
    coverage.
    
    Signed-off-by: Andrew Lunn <andrew@lunn.ch>
    Reviewed-by: Florian Fainelli <f.fainelli@gmail.com>
    Signed-off-by: David S. Miller <davem@davemloft.net>

commit 72349b62a571effd6faadd0600b8e657dd87afbf
Author: Deepak Ukey <deepak.ukey@microchip.com>
Date:   Tue Sep 11 14:18:04 2018 +0530

    scsi: pm80xx: Fixed system hang issue during kexec boot
    
    When the firmware is not responding, execution of kexec boot causes a system
    hang. When firmware assertion happened, driver get notified with interrupt
    vector updated in MPI configuration table. Then, the driver will read
    scratchpad register and set controller_fatal_error flag to true.
    
    Signed-off-by: Deepak Ukey <deepak.ukey@microchip.com>
    Signed-off-by: Viswas G <Viswas.G@microchip.com>
    Acked-by: Jack Wang <jinpu.wang@profitbricks.com>
    Signed-off-by: Martin K. Petersen <martin.petersen@oracle.com>

commit 90d23222cf5158d6cc724347e8940b4a87779e30
Author: Vinod Koul <vkoul@kernel.org>
Date:   Tue Sep 11 11:36:33 2018 +0530

    dmaengine: Revert "dmaengine: add COMPILE_TEST for the drivers"
    
    We have build failures attributed to turning on COMPILE_TEST, so revert
    commit 90082cd397aeb: ("dmaengine: add COMPILE_TEST for the drivers")
    while we fix these.
    
    Signed-off-by: Vinod Koul <vkoul@kernel.org>

commit f1908735f141f662fbf04436e6efc1560418b5a0
Author: Niklas Cassel <niklas.cassel@linaro.org>
Date:   Tue Jun 12 13:39:06 2018 +0200

    ath10k: allow ATH10K_SNOC with COMPILE_TEST
    
    ATH10K_SNOC builds just fine with COMPILE_TEST, so make that possible.
    
    Signed-off-by: Niklas Cassel <niklas.cassel@linaro.org>
    Signed-off-by: Kalle Valo <kvalo@codeaurora.org>

commit 90082cd397aebc8ce375904024d7c80d1258df85
Author: Huang Shijie <sjhuang@iluvatar.ai>
Date:   Mon Aug 6 16:52:31 2018 +0800

    dmaengine: add COMPILE_TEST for the drivers
    
    We can do the compiling test with COMPILE_TEST.
    This patch adds the COMPILE_TEST for the drivers.
    
    Signed-off-by: Huang Shijie <sjhuang@iluvatar.ai>
    Acked-by: Linus Walleij <linus.walleij@linaro.org>
    Acked-by: Robert Jarzmik <robert.jarzmik@free.fr>
    Signed-off-by: Vinod Koul <vkoul@kernel.org>

commit 815f0ddb346c196018d4d8f8f55c12b83da1de3f
Author: Nick Desaulniers <ndesaulniers@google.com>
Date:   Wed Aug 22 16:37:24 2018 -0700

    include/linux/compiler*.h: make compiler-*.h mutually exclusive
    
    Commit cafa0010cd51 ("Raise the minimum required gcc version to 4.6")
    recently exposed a brittle part of the build for supporting non-gcc
    compilers.
    
    Both Clang and ICC define __GNUC__, __GNUC_MINOR__, and
    __GNUC_PATCHLEVEL__ for quick compatibility with code bases that haven't
    added compiler specific checks for __clang__ or __INTEL_COMPILER.
    
    This is brittle, as they happened to get compatibility by posing as a
    certain version of GCC.  This broke when upgrading the minimal version
    of GCC required to build the kernel, to a version above what ICC and
    Clang claim to be.
    
    Rather than always including compiler-gcc.h then undefining or
    redefining macros in compiler-intel.h or compiler-clang.h, let's
    separate out the compiler specific macro definitions into mutually
    exclusive headers, do more proper compiler detection, and keep shared
    definitions in compiler_types.h.
    
    Fixes: cafa0010cd51 ("Raise the minimum required gcc version to 4.6")
    Reported-by: Masahiro Yamada <yamada.masahiro@socionext.com>
    Suggested-by: Eli Friedman <efriedma@codeaurora.org>
    Suggested-by: Joe Perches <joe@perches.com>
    Signed-off-by: Nick Desaulniers <ndesaulniers@google.com>
    Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>

commit 906d441febc0de974b2a6ef848a8f058f3bfada3
Author: Paul Burton <paul.burton@mips.com>
Date:   Mon Aug 20 15:36:18 2018 -0700

    MIPS: Workaround GCC __builtin_unreachable reordering bug
    
    Some versions of GCC for the MIPS architecture suffer from a bug which
    can lead to instructions from beyond an unreachable statement being
    incorrectly reordered into earlier branch delay slots if the unreachable
    statement is the only content of a case in a switch statement. This can
    lead to seemingly random behaviour, such as invalid memory accesses from
    incorrectly reordered loads or stores, and link failures on microMIPS
    builds.
    
    See this potential GCC fix for details:
    
        https://gcc.gnu.org/ml/gcc-patches/2015-09/msg00360.html
    
    Runtime problems resulting from this bug were initially observed using a
    maltasmvp_defconfig v4.4 kernel built using GCC 4.9.2 (from a Codescape
    SDK 2015.06-05 toolchain), with the result being an address exception
    taken after log messages about the L1 caches (during probe of the L2
    cache):
    
        Initmem setup node 0 [mem 0x0000000080000000-0x000000009fffffff]
        VPE topology {2,2} total 4
        Primary instruction cache 64kB, VIPT, 4-way, linesize 32 bytes.
        Primary data cache 64kB, 4-way, PIPT, no aliases, linesize 32 bytes
        <AdEL exception here>
    
    This is early enough that the kernel exception vectors are not in use,
    so any further output depends upon the bootloader. This is reproducible
    in QEMU where no further output occurs - ie. the system hangs here.
    Given the nature of the bug it may potentially be hit with differing
    symptoms. The bug is known to affect GCC versions as recent as 7.3, and
    it is unclear whether GCC 8 fixed it or just happens not to encounter
    the bug in the testcase found at the link above due to differing
    optimizations.
    
    This bug can be worked around by placing a volatile asm statement, which
    GCC is prevented from reordering past, prior to the
    __builtin_unreachable call.
    
    That was actually done already for other reasons by commit 173a3efd3edb
    ("bug.h: work around GCC PR82365 in BUG()"), but creates problems for
    microMIPS builds due to the lack of a .insn directive. The microMIPS ISA
    allows for interlinking with regular MIPS32 code by repurposing bit 0 of
    the program counter as an ISA mode bit. To switch modes one changes the
    value of this bit in the PC. However typical branch instructions encode
    their offsets as multiples of 2-byte instruction halfwords, which means
    they cannot change ISA mode - this must be done using either an indirect
    branch (a jump-register in MIPS terminology) or a dedicated jalx
    instruction. In order to ensure that regular branches don't attempt to
    target code in a different ISA which they can't actually switch to, the
    linker will check that branch targets are code in the same ISA as the
    branch.
    
    Unfortunately our empty asm volatile statements don't qualify as code,
    and the link for microMIPS builds fails with errors such as:
    
        arch/mips/mm/dma-default.s:3265: Error: branch to a symbol in another ISA mode
        arch/mips/mm/dma-default.s:5027: Error: branch to a symbol in another ISA mode
    
    Resolve this by adding a .insn directive within the asm statement which
    declares that what comes next is code. This may or may not be true,
    since we don't really know what comes next, but as this code is in an
    unreachable path anyway that doesn't matter since we won't execute it.
    
    We do this in asm/compiler.h & select CONFIG_HAVE_ARCH_COMPILER_H in
    order to have this included by linux/compiler_types.h after
    linux/compiler-gcc.h. This will result in asm/compiler.h being included
    in all C compilations via the -include linux/compiler_types.h argument
    in c_flags, which should be harmless.
    
    Signed-off-by: Paul Burton <paul.burton@mips.com>
    Fixes: 173a3efd3edb ("bug.h: work around GCC PR82365 in BUG()")
    Patchwork: https://patchwork.linux-mips.org/patch/20270/
    Cc: James Hogan <jhogan@kernel.org>
    Cc: Ralf Baechle <ralf@linux-mips.org>
    Cc: Arnd Bergmann <arnd@arndb.de>
    Cc: linux-mips@linux-mips.org

commit 04f264d3a8b0eb25d378127bd78c3c9a0261c828
Author: Paul Burton <paul.burton@mips.com>
Date:   Mon Aug 20 15:36:17 2018 -0700

    compiler.h: Allow arch-specific asm/compiler.h
    
    We have a need to override the definition of
    barrier_before_unreachable() for MIPS, which means we either need to add
    architecture-specific code into linux/compiler-gcc.h or we need to allow
    the architecture to provide a header that can define the macro before
    the generic definition. The latter seems like the better approach.
    
    A straightforward approach to the per-arch header is to make use of
    asm-generic to provide a default empty header & adjust architectures
    which don't need anything specific to make use of that by adding the
    header to generic-y. Unfortunately this doesn't work so well due to
    commit 28128c61e08e ("kconfig.h: Include compiler types to avoid missed
    struct attributes") which caused linux/compiler_types.h to be included
    in the compilation of every C file via the -include linux/kconfig.h flag
    in c_flags.
    
    Because the -include flag is present for all C files we compile, we need
    the architecture-provided header to be present before any C files are
    compiled. If any C files can be compiled prior to the asm-generic header
    wrappers being generated then we hit a build failure due to missing
    header. Such cases do exist - one pointed out by the kbuild test robot
    is the compilation of arch/ia64/kernel/nr-irqs.c, which occurs as part
    of the archprepare target [1].
    
    This leaves us with a few options:
    
      1) Use generic-y & fix any build failures we find by enforcing
         ordering such that the asm-generic target occurs before any C
         compilation, such that linux/compiler_types.h can always include
         the generated asm-generic wrapper which in turn includes the empty
         asm-generic header. This would rely on us finding all the
         problematic cases - I don't know for sure that the ia64 issue is
         the only one.
    
      2) Add an actual empty header to each architecture, so that we don't
         need the generated asm-generic wrapper. This seems messy.
    
      3) Give up & add #ifdef CONFIG_MIPS or similar to
         linux/compiler_types.h. This seems messy too.
    
      4) Include the arch header only when it's actually needed, removing
         the need for the asm-generic wrapper for all other architectures.
    
    This patch allows us to use approach 4, by including an asm/compiler.h
    header from linux/compiler_types.h after the inclusion of the
    compiler-specific linux/compiler-*.h header(s). We do this
    conditionally, only when CONFIG_HAVE_ARCH_COMPILER_H is selected, in
    order to avoid the need for asm-generic wrappers & the associated build
    ordering issue described above. The asm/compiler.h header is included
    after the generic linux/compiler-*.h header(s) for consistency with the
    way linux/compiler-intel.h & linux/compiler-clang.h are included after
    the linux/compiler-gcc.h header that they override.
    
    [1] https://lists.01.org/pipermail/kbuild-all/2018-August/051175.html
    
    Signed-off-by: Paul Burton <paul.burton@mips.com>
    Reviewed-by: Masahiro Yamada <yamada.masahiro@socionext.com>
    Patchwork: https://patchwork.linux-mips.org/patch/20269/
    Cc: Arnd Bergmann <arnd@arndb.de>
    Cc: James Hogan <jhogan@kernel.org>
    Cc: Masahiro Yamada <yamada.masahiro@socionext.com>
    Cc: Ralf Baechle <ralf@linux-mips.org>
    Cc: linux-arch@vger.kernel.org
    Cc: linux-kbuild@vger.kernel.org
    Cc: linux-mips@linux-mips.org

commit 13bf2cf9e2d1e0e56088ec6342c2726704100647
Merge: bbd60bffaf78 3257d86182cc
Author: Linus Torvalds <torvalds@linux-foundation.org>
Date:   Sat Aug 18 15:55:59 2018 -0700

    Merge tag 'dmaengine-4.19-rc1' of git://git.infradead.org/users/vkoul/slave-dma
    
    Pull DMAengine updates from Vinod Koul:
     "This round brings couple of framework changes, a new driver and usual
      driver updates:
    
       - new managed helper for dmaengine framework registration
    
       - split dmaengine pause capability to pause and resume and allow
         drivers to report that individually
    
       - update dma_request_chan_by_mask() to handle deferred probing
    
       - move imx-sdma to use virt-dma
    
       - new driver for Actions Semi Owl family S900 controller
    
       - minor updates to intel, renesas, mv_xor, pl330 etc"
    
    * tag 'dmaengine-4.19-rc1' of git://git.infradead.org/users/vkoul/slave-dma: (46 commits)
      dmaengine: Add Actions Semi Owl family S900 DMA driver
      dt-bindings: dmaengine: Add binding for Actions Semi Owl SoCs
      dmaengine: sh: rcar-dmac: Should not stop the DMAC by rcar_dmac_sync_tcr()
      dmaengine: mic_x100_dma: use the new helper to simplify the code
      dmaengine: add a new helper dmaenginem_async_device_register
      dmaengine: imx-sdma: add memcpy interface
      dmaengine: imx-sdma: add SDMA_BD_MAX_CNT to replace '0xffff'
      dmaengine: dma_request_chan_by_mask() to handle deferred probing
      dmaengine: pl330: fix irq race with terminate_all
      dmaengine: Revert "dmaengine: mv_xor_v2: enable COMPILE_TEST"
      dmaengine: mv_xor_v2: use {lower,upper}_32_bits to configure HW descriptor address
      dmaengine: mv_xor_v2: enable COMPILE_TEST
      dmaengine: mv_xor_v2: move unmap to before callback
      dmaengine: mv_xor_v2: convert callback to helper function
      dmaengine: mv_xor_v2: kill the tasklets upon exit
      dmaengine: mv_xor_v2: explicitly freeup irq
      dmaengine: sh: rcar-dmac: Add dma_pause operation
      dmaengine: sh: rcar-dmac: add a new function to clear CHCR.DE with barrier
      dmaengine: idma64: Support dmaengine_terminate_sync()
      dmaengine: hsu: Support dmaengine_terminate_sync()
      ...

commit f863ae594d33e57aa12cdde47e767e6e7942ee51
Author: Arnd Bergmann <arnd@arndb.de>
Date:   Tue Jul 24 11:35:59 2018 +0200

    media: platform: cros-ec-cec: Fix dependency on MFD_CROS_EC
    
    Without the MFD driver, we run into a link error:
    
    drivers/media/platform/cros-ec-cec/cros-ec-cec.o: In function `cros_ec_cec_transmit':
    cros-ec-cec.c:(.text+0x474): undefined reference to `cros_ec_cmd_xfer_status'
    drivers/media/platform/cros-ec-cec/cros-ec-cec.o: In function `cros_ec_cec_set_log_addr':
    cros-ec-cec.c:(.text+0x60b): undefined reference to `cros_ec_cmd_xfer_status'
    drivers/media/platform/cros-ec-cec/cros-ec-cec.o: In function `cros_ec_cec_adap_enable':
    cros-ec-cec.c:(.text+0x77d): undefined reference to `cros_ec_cmd_xfer_status'
    
    As we can compile-test all the dependency, the extra '| COMPILE_TEST' is
    not needed to get the build coverage, and we can simply turn MFD_CROS_EC
    into a hard dependency to make it build in all configurations.
    
    Fixes: cd70de2d356e ("media: platform: Add ChromeOS EC CEC driver")
    Signed-off-by: Arnd Bergmann <arnd@arndb.de>
    Signed-off-by: Lee Jones <lee.jones@linaro.org>

commit c2fc71c9b74c1e87336a27dba1a5edc69d2690f1
Merge: 57ee3196ce7c 9805d4bcf8f9
Author: Linus Torvalds <torvalds@linux-foundation.org>
Date:   Tue Aug 14 10:57:44 2018 -0700

    Merge tag 'mtd/for-4.19' of git://git.infradead.org/linux-mtd
    
    Pull mtd updates from Boris Brezillon:
     "JFFS2 changes:
       - Support 64-bit timestamps
    
      MTD core changes:
       - Support sub-partitions
       - Clarify mtd_oob_ops documentation
       - Make Kconfig formatting consistent
       - Fix potential overflows in mtdchar_{write,read}()
       - Fallback to ->_{read,write}() when ->_{read,write}_oob() is missing
         and no OOB data were requested
       - Remove VLA usage in the bch lib
    
      MTD driver changes:
       - Use mtd_device_register() instead of mtd_device_parse_register()
         where applicable
       - Use proper printk format to print physical addresses in the
         solutionengine driver
       - Add missing mtd_set_of_node() call in the powernv driver
       - Remove unneeded variables in a few drivers
       - Plug the TRX part parser to the DT partition parsers logic
       - Check ioremap_cache() return code in the gpio-addr-flash driver
       - Stop using VMLINUX_SYMBOL_STR() in gen_probe.c
    
      SPI NOR core changes:
       - Apply reset hacks only when reset is explicitly marked as broken in
         the DT
    
       SPI NOR driver changes:
       - Minor cleanup/fixes in the m25p80 driver
       - Release flash_np in the nxp-spifi driver
       - Add suspend/resume hooks to the atmel-quadspi driver
       - Include gpio/consumer.h instead of gpio.h in the atmel-quadspi
         driver
       - Use %pK instead of %p in the stm32-quadspi driver
       - Improve timeout handling in the cadence-quadspi driver
       - Use mtd_device_register() instead of mtd_device_parse_register() in
         the intel-spi driver
    
      NAND core changes:
       - Add the SPI-NAND framework.
       - Create a helper to find the best ECC configuration.
       - Create NAND controller operations.
       - Allocate dynamically ONFI parameters structure.
       - Add defines for ONFI version bits.
       - Add manufacturer fixup for ONFI parameter page.
       - Add an option to specify NAND chip as a boot device.
       - Add Reed-Solomon error correction algorithm.
       - Better name for the controller structure.
       - Remove unused caller_is_module() definition.
       - Make subop helpers return unsigned values.
       - Expose _notsupp() helpers for raw page accessors.
       - Add default values for dynamic timings.
       - Kill the chip->scan_bbt() hook.
       - Rename nand_default_bbt() into nand_create_bbt().
       - Start to clean the nand_chip structure.
       - Remove stale prototype from rawnand.h.
    
      Raw NAND controllers drivers changes:
       - Qcom: structuring cleanup.
       - Denali: use core helper to find the best ECC configuration.
       - Possible build of almost all drivers by adding a dependency on
         COMPILE_TEST for almost all of them in Kconfig, implies various
         fixes, Kconfig cleanup, GPIO headers inclusion cleanup, and even
         changes in sparc64 and ia64 architectures.
       - Clean the ->probe() functions error path of a lot of drivers.
       - Migrate all drivers to use nand_scan() instead of
         nand_scan_ident()/nand_scan_tail() pair.
       - Use mtd_device_register() where applicable to simplify the code.
       - Marvell:
          * Handle on-die ECC.
          * Better clocks handling.
          * Remove bogus comment.
          * Add suspend and resume support.
       - Tegra: add NAND controller driver.
       - Atmel:
          * Add module param to avoid using dma.
          * Drop Wenyou Yang from MAINTAINERS.
       - Denali: optimize timings handling.
       - FSMC: Stop using chip->read_buf().
       - FSL:
          * Switch to SPDX license tag identifiers.
          * Fix qualifiers in MXC init functions.
    
      Raw NAND chip drivers changes:
       - Micron:
          * Add fixup for ONFI revision.
          * Update ecc_stats.corrected.
          * Make ECC activation stateful.
          * Avoid enabling/disabling ECC when it can't be disabled.
          * Get the actual number of bitflips.
          * Allow forced on-die ECC.
          * Support 8/512 on-die ECC.
          * Fix on-die ECC detection logic.
       - Hynix:
          * Fix decoding the OOB size on H27UCG8T2BTR.
          * Use ->exec_op() in hynix_nand_reg_write_op()"
    
    * tag 'mtd/for-4.19' of git://git.infradead.org/linux-mtd: (188 commits)
      mtd: rawnand: atmel: Select GENERIC_ALLOCATOR
      MAINTAINERS: drop Wenyou Yang from Atmel NAND driver support
      mtd: rawnand: allocate dynamically ONFI parameters during detection
      mtd: spi-nor: only apply reset hacks to broken hardware
      mtd: spi-nor: cadence-quadspi: fix timeout handling
      mtd: spi-nor: atmel-quadspi: Include gpio/consumer.h instead of gpio.h
      mtd: spi-nor: intel-spi: use mtd_device_register()
      mtd: spi-nor: stm32-quadspi: replace "%p" with "%pK"
      mtd: spi-nor: atmel-quadspi: add suspend/resume hooks
      mtd: rawnand: allocate model parameter dynamically
      mtd: rawnand: do not export nand_scan_[ident|tail]() anymore
      mtd: rawnand: txx9ndfmc: convert driver to nand_scan()
      mtd: rawnand: txx9ndfmc: clarify ECC parameters assignation
      mtd: rawnand: tegra: convert driver to nand_scan()
      mtd: rawnand: jz4740: convert driver to nand_scan()
      mtd: rawnand: jz4740: group nand_scan_{ident, tail} calls
      mtd: rawnand: jz4740: fix probe function error path
      mtd: rawnand: docg4: convert driver to nand_scan()
      mtd: rawnand: do not execute nand_scan_ident() if maxchips is zero
      mtd: rawnand: atmel: convert driver to nand_scan()
      ...

commit 486edfb1039dc413c4806d11accdedc8a4aa573b
Author: Jason Gunthorpe <jgg@mellanox.com>
Date:   Mon Aug 13 20:04:37 2018 -0600

    IB/ucm: Fix compiling ucm.c
    
    Even though this interface is marked CONFIG_BROKEN we still expect it to
    compile, at least until we delete it completely.
    
    Also mark INFINIBAND_USER_ACCESS_UCM with COMPILE_TEST so these situations
    can be detected.
    
    Fixes: e7ff98aefc9e ("RDMA/cma: Constify path record, ib_cm_event, listen_id pointers")
    Signed-off-by: Jason Gunthorpe <jgg@mellanox.com>

commit 9805d4bcf8f98dbeb1a66c3195f2ea8b917a083e
Author: Boris Brezillon <boris.brezillon@bootlin.com>
Date:   Sat Aug 11 15:47:12 2018 +0200

    mtd: rawnand: atmel: Select GENERIC_ALLOCATOR
    
    The driver uses genalloc functions. Select GENERIC_ALLOCATOR to prevent
    build errors when selected through COMPILE_TEST.
    
    Fixes: 88a40e7dca00 ("mtd: rawnand: atmel: Allow selection of this driver when COMPILE_TEST=y")
    Reported-by: Randy Dunlap <rdunlap@infradead.org>
    Signed-off-by: Boris Brezillon <boris.brezillon@bootlin.com>
    Acked-by: Miquel Raynal <miquel.raynal@bootlin.com>
    Acked-by: Randy Dunlap <rdunlap@infradead.org>

commit da86748bf60068e0d6ad56e5c919ca7e6782c4ba
Merge: 76a832254ab0 ed128e8b757b
Author: Boris Brezillon <boris.brezillon@bootlin.com>
Date:   Sat Aug 11 12:15:19 2018 +0200

    Merge tag 'nand/for-4.19' of git://git.infradead.org/linux-mtd into mtd/next
    
    Pull NAND updates from Miquel Raynal:
    
    "
     NAND core changes:
     - Add the SPI-NAND framework.
     - Create a helper to find the best ECC configuration.
     - Create NAND controller operations.
     - Allocate dynamically ONFI parameters structure.
     - Add defines for ONFI version bits.
     - Add manufacturer fixup for ONFI parameter page.
     - Add an option to specify NAND chip as a boot device.
     - Add Reed-Solomon error correction algorithm.
     - Better name for the controller structure.
     - Remove unused caller_is_module() definition.
     - Make subop helpers return unsigned values.
     - Expose _notsupp() helpers for raw page accessors.
     - Add default values for dynamic timings.
     - Kill the chip->scan_bbt() hook.
     - Rename nand_default_bbt() into nand_create_bbt().
     - Start to clean the nand_chip structure.
     - Remove stale prototype from rawnand.h.
    
     Raw NAND controllers drivers changes:
     - Qcom: structuring cleanup.
     - Denali: use core helper to find the best ECC configuration.
     - Possible build of almost all drivers by adding a dependency on
       COMPILE_TEST for almost all of them in Kconfig, implies various
       fixes, Kconfig cleanup, GPIO headers inclusion cleanup, and even
       changes in sparc64 and ia64 architectures.
     - Clean the ->probe() functions error path of a lot of drivers.
     - Migrate all drivers to use nand_scan() instead of
       nand_scan_ident()/nand_scan_tail() pair.
     - Use mtd_device_register() where applicable to simplify the code.
     - Marvell:
       * Handle on-die ECC.
       * Better clocks handling.
       * Remove bogus comment.
       * Add suspend and resume support.
     - Tegra: add NAND controller driver.
     - Atmel:
       * Add module param to avoid using dma.
       * Drop Wenyou Yang from MAINTAINERS.
     - Denali: optimize timings handling.
     - FSMC: Stop using chip->read_buf().
     - FSL:
       * Switch to SPDX license tag identifiers.
       * Fix qualifiers in MXC init functions.
    
     Raw NAND chip drivers changes:
     - Micron:
       * Add fixup for ONFI revision.
       * Update ecc_stats.corrected.
       * Make ECC activation stateful.
       * Avoid enabling/disabling ECC when it can't be disabled.
       * Get the actual number of bitflips.
       * Allow forced on-die ECC.
       * Support 8/512 on-die ECC.
       * Fix on-die ECC detection logic.
     - Hynix:
       * Fix decoding the OOB size on H27UCG8T2BTR.
       * Use ->exec_op() in hynix_nand_reg_write_op().
    "

commit c42d3be0c06f0c1c416054022aa535c08a1f9b39
Author: Dan Carpenter <dan.carpenter@oracle.com>
Date:   Wed Aug 8 14:57:24 2018 +0300

    powerpc: Fix size calculation using resource_size()
    
    The problem is the the calculation should be "end - start + 1" but the
    plus one is missing in this calculation.
    
    Fixes: 8626816e905e ("powerpc: add support for MPIC message register API")
    Signed-off-by: Dan Carpenter <dan.carpenter@oracle.com>
    Reviewed-by: Tyrel Datwyler <tyreld@linux.vnet.ibm.com>
    Signed-off-by: Michael Ellerman <mpe@ellerman.id.au>

commit 12aea518a202bc7c947553840f1d93f8129b41b2
Author: Johannes Thumshirn <jthumshirn@suse.de>
Date:   Fri Aug 3 18:35:17 2018 +0200

    watchdog: fix dependencies of menz69_wdt.o
    
    Currently menz69_wdt.ko has a dependency on MCB or COMPILE_TEST. But
    it actually needs symbols exported by MCB so the || COMPILE_TEST is
    wrong.
    
    Signed-off-by: Johannes Thumshirn <jthumshirn@suse.de>
    Reported-by: Randy Dunlap <rdunlap@infradead.org>
    Signed-off-by: Guenter Roeck <linux@roeck-us.net>
    Signed-off-by: Wim Van Sebroeck <wim@linux-watchdog.org>

commit 379d98ddf41344273d9718556f761420f4dc80b3
Author: Alistair Strachan <astrachan@google.com>
Date:   Fri Aug 3 10:39:31 2018 -0700

    x86: vdso: Use $LD instead of $CC to link
    
    The vdso{32,64}.so can fail to link with CC=clang when clang tries to find
    a suitable GCC toolchain to link these libraries with.
    
    /usr/bin/ld: arch/x86/entry/vdso/vclock_gettime.o:
      access beyond end of merged section (782)
    
    This happens because the host environment leaked into the cross compiler
    environment due to the way clang searches for suitable GCC toolchains.
    
    Clang is a retargetable compiler, and each invocation of it must provide
    --target=<something> --gcc-toolchain=<something> to allow it to find the
    correct binutils for cross compilation. These flags had been added to
    KBUILD_CFLAGS, but the vdso code uses CC and not KBUILD_CFLAGS (for various
    reasons) which breaks clang's ability to find the correct linker when cross
    compiling.
    
    Most of the time this goes unnoticed because the host linker is new enough
    to work anyway, or is incompatible and skipped, but this cannot be reliably
    assumed.
    
    This change alters the vdso makefile to just use LD directly, which
    bypasses clang and thus the searching problem. The makefile will just use
    ${CROSS_COMPILE}ld instead, which is always what we want. This matches the
    method used to link vmlinux.
    
    This drops references to DISABLE_LTO; this option doesn't seem to be set
    anywhere, and not knowing what its possible values are, it's not clear how
    to convert it from CC to LD flag.
    
    Signed-off-by: Alistair Strachan <astrachan@google.com>
    Signed-off-by: Thomas Gleixner <tglx@linutronix.de>
    Acked-by: Andy Lutomirski <luto@kernel.org>
    Cc: "H. Peter Anvin" <hpa@zytor.com>
    Cc: Greg Kroah-Hartman <gregkh@linuxfoundation.org>
    Cc: kernel-team@android.com
    Cc: joel@joelfernandes.org
    Cc: Andi Kleen <andi.kleen@intel.com>
    Link: https://lkml.kernel.org/r/20180803173931.117515-1-astrachan@google.com

commit 09c2f95ad404bc6e9995f5bce04ae85d0fffc534
Author: Sreekanth Reddy <sreekanth.reddy@broadcom.com>
Date:   Tue Jul 31 01:36:36 2018 -0400

    scsi: mpt3sas: Swap I/O memory read value back to cpu endianness
    
    Swap the I/O memory read value back to cpu endianness before storing it in
    a data structures which are defined in the MPI headers where u8 components
    are not defined in the endianness order.
    
    In this area from day one mpt3sas driver is using le32_to_cpu() &
    cpu_to_le32() APIs. But in commit cf6bf9710c
    (mpt3sas: Bug fix for big endian systems) we have removed these APIs
    before reading I/O memory which we should haven't done it. So
    in this patch I am correcting it by adding these APIs back
    before accessing I/O memory.
    
    Signed-off-by: Sreekanth Reddy <sreekanth.reddy@broadcom.com>
    Reviewed-by: Andy Shevchenko <andriy.shevchenko@linux.intel.com>
    Signed-off-by: Martin K. Petersen <martin.petersen@oracle.com>

commit 7ec65372ca534217b53fd208500cf7aac223a383
Author: Wei Wang <weiwan@google.com>
Date:   Tue Jul 31 17:46:24 2018 -0700

    tcp: add stat of data packet reordering events
    
    Introduce a new TCP stats to record the number of reordering events seen
    and expose it in both tcp_info (TCP_INFO) and opt_stats
    (SOF_TIMESTAMPING_OPT_STATS).
    Application can use this stats to track the frequency of the reordering
    events in addition to the existing reordering stats which tracks the
    magnitude of the latest reordering event.
    
    Note: this new stats tracks reordering events triggered by ACKs, which
    could often be fewer than the actual number of packets being delivered
    out-of-order.
    
    Signed-off-by: Wei Wang <weiwan@google.com>
    Signed-off-by: Eric Dumazet <edumazet@google.com>
    Acked-by: Neal Cardwell <ncardwell@google.com>
    Acked-by: Soheil Hassas Yeganeh <soheil@google.com>
    Acked-by: Yuchung Cheng <ycheng@google.com>
    Signed-off-by: David S. Miller <davem@davemloft.net>

commit 7e10b6554ff2ce7f86d5d3eec3af5db8db482caa
Author: Wei Wang <weiwan@google.com>
Date:   Tue Jul 31 17:46:23 2018 -0700

    tcp: add dsack blocks received stats
    
    Introduce a new TCP stat to record the number of DSACK blocks received
    (RFC4989 tcpEStatsStackDSACKDups) and expose it in both tcp_info
    (TCP_INFO) and opt_stats (SOF_TIMESTAMPING_OPT_STATS).
    
    Signed-off-by: Wei Wang <weiwan@google.com>
    Signed-off-by: Eric Dumazet <edumazet@google.com>
    Acked-by: Neal Cardwell <ncardwell@google.com>
    Acked-by: Soheil Hassas Yeganeh <soheil@google.com>
    Acked-by: Yuchung Cheng <ycheng@google.com>
    Signed-off-by: David S. Miller <davem@davemloft.net>

commit fb31c9b9f6c85b1bad569ecedbde78d9e37cd87b
Author: Wei Wang <weiwan@google.com>
Date:   Tue Jul 31 17:46:22 2018 -0700

    tcp: add data bytes retransmitted stats
    
    Introduce a new TCP stat to record the number of bytes retransmitted
    (RFC4898 tcpEStatsPerfOctetsRetrans) and expose it in both tcp_info
    (TCP_INFO) and opt_stats (SOF_TIMESTAMPING_OPT_STATS).
    
    Signed-off-by: Wei Wang <weiwan@google.com>
    Signed-off-by: Eric Dumazet <edumazet@google.com>
    Acked-by: Neal Cardwell <ncardwell@google.com>
    Acked-by: Soheil Hassas Yeganeh <soheil@google.com>
    Acked-by: Yuchung Cheng <ycheng@google.com>
    Signed-off-by: David S. Miller <davem@davemloft.net>

commit ba113c3aa79a7f941ac162d05a3620bdc985c58d
Author: Wei Wang <weiwan@google.com>
Date:   Tue Jul 31 17:46:21 2018 -0700

    tcp: add data bytes sent stats
    
    Introduce a new TCP stat to record the number of bytes sent
    (RFC4898 tcpEStatsPerfHCDataOctetsOut) and expose it in both tcp_info
    (TCP_INFO) and opt_stats (SOF_TIMESTAMPING_OPT_STATS).
    
    Signed-off-by: Wei Wang <weiwan@google.com>
    Signed-off-by: Eric Dumazet <edumazet@google.com>
    Acked-by: Neal Cardwell <ncardwell@google.com>
    Acked-by: Soheil Hassas Yeganeh <soheil@google.com>
    Acked-by: Yuchung Cheng <ycheng@google.com>
    Signed-off-by: David S. Miller <davem@davemloft.net>

commit 044e7ca20496b3c728c7ec87b778bf8cca8f012b
Author: kbuild test robot <fengguang.wu@intel.com>
Date:   Tue Jul 31 13:06:58 2018 +0200

    fbdev: omap2: omapfb: fix ifnullfree.cocci warnings
    
    drivers/video/fbdev/omap2/omapfb/dss/core.c:141:2-26: WARNING: NULL check before some freeing functions is not needed.
    
     NULL check before some freeing functions is not needed.
    
     Based on checkpatch warning
     "kfree(NULL) is safe this check is probably not required"
     and kfreeaddr.cocci by Julia Lawall.
    
    Generated by: scripts/coccinelle/free/ifnullfree.cocci
    
    Fixes: 7378f1149884 ("media: omap2: omapfb: allow building it with COMPILE_TEST")
    Signed-off-by: kbuild test robot <fengguang.wu@intel.com>
    Cc: Mauro Carvalho Chehab <m.chehab@samsung.com>
    Cc: Laurent Pinchart <laurent.pinchart@ideasonboard.com>
    Cc: Arnd Bergmann <arnd@arndb.de>
    Signed-off-by: Bartlomiej Zolnierkiewicz <b.zolnierkie@samsung.com>

commit 6e7f3997bd546c3b36bc7f9ecee0d54dac22a2b3
Author: kbuild test robot <fengguang.wu@intel.com>
Date:   Tue Jul 31 13:06:58 2018 +0200

    fbdev: omap2: omapfb: fix bugon.cocci warnings
    
    drivers/video/fbdev/omap2/omapfb/dss/dss_features.c:895:2-5: WARNING: Use BUG_ON instead of if condition followed by BUG.
    Please make sure the condition has no side effects (see conditional BUG_ON definition in include/asm-generic/bug.h)
    
     Use BUG_ON instead of a if condition followed by BUG.
    
    Semantic patch information:
     This makes an effort to find cases where BUG() follows an if
     condition on an expression and replaces the if condition and BUG()
     with a BUG_ON having the conditional expression of the if statement
     as argument.
    
    Generated by: scripts/coccinelle/misc/bugon.cocci
    
    Fixes: 7378f1149884 ("media: omap2: omapfb: allow building it with COMPILE_TEST")
    Signed-off-by: kbuild test robot <fengguang.wu@intel.com>
    Cc: Mauro Carvalho Chehab <m.chehab@samsung.com>
    Signed-off-by: Bartlomiej Zolnierkiewicz <b.zolnierkie@samsung.com>

commit cb653fe849f9fdcf24ce3c612e3fb0da5e610241
Author: kbuild test robot <fengguang.wu@intel.com>
Date:   Tue Jul 31 13:06:58 2018 +0200

    fbdev: omap2: omapfb: fix boolreturn.cocci warnings
    
    drivers/video/fbdev/omap2/omapfb/omapfb-main.c:290:9-10: WARNING: return of 0/1 in function 'cmp_var_to_colormode' with return type bool
    
     Return statements in functions returning bool should use
     true/false instead of 1/0.
    Generated by: scripts/coccinelle/misc/boolreturn.cocci
    
    Fixes: 7378f1149884 ("media: omap2: omapfb: allow building it with COMPILE_TEST")
    Signed-off-by: kbuild test robot <fengguang.wu@intel.com>
    Cc: Mauro Carvalho Chehab <m.chehab@samsung.com>
    Cc: Dan Carpenter <dan.carpenter@oracle.com>
    Signed-off-by: Bartlomiej Zolnierkiewicz <b.zolnierkie@samsung.com>

commit 16909c81c6298c2db5587340106523e0a6c2bfe2
Author: Anders Roxell <anders.roxell@linaro.org>
Date:   Wed Jul 25 11:19:28 2018 +0200

    drivers/memory/Kconfig: Add CONFIG_OF dependency
    
    JZ4780_NEMC doesn't depend on OF, and if OF isn't enabled we get this
    error:
    drivers/memory/jz4780-nemc.c: In function jz4780_nemc_num_banks:
    drivers/memory/jz4780-nemc.c:72:10: error: implicit declaration of
     function of_read_number; did you mean down_read_nested?
     [-Werror=implicit-function-declaration]
       bank = of_read_number(prop, 1);
              ^~~~~~~~~~~~~~
              down_read_nested
    
    Make JZ4780_NEMC depend on OF.
    
    Fixes: ab99e11062c1 ("memory: jz4780-nemc: Allow selection of this driver when COMPILE_TEST=y")
    Reported-by: Randy Dunlap <rdunlap@infradead.org>
    Signed-off-by: Anders Roxell <anders.roxell@linaro.org>
    Acked-by: Randy Dunlap <rdunlap@infradead.org>
    Signed-off-by: Miquel Raynal <miquel.raynal@bootlin.com>

commit d05a9524d7ec513648ad5e0fbd944e6ff3ddbd84
Author: Boris Brezillon <boris.brezillon@bootlin.com>
Date:   Fri Jul 20 00:38:13 2018 +0200

    mtd: rawnand: jz4740: Include gpio/consumer.h instead of gpio.h
    
    GPIO consumers should no longer include <linux/gpio.h>, and instead
    include <linux/gpio/consumer.h>.
    
    Also, explicitly include <include/io.h> since it seems to be missing
    after switching to <linux/gpio/consumer.h>.
    
    This fixes a build error when selecting the driver without selecting
    GPIOLIB, which can happen when COMPILE_TEST=y.
    
    Fixes: 6968e07e8169 ("mtd: rawnand: jz4740: Allow selection of this driver when COMPILE_TEST=y")
    Reported-by: Miquel Raynal <miquel.raynal@bootlin.com>
    Signed-off-by: Boris Brezillon <boris.brezillon@bootlin.com>
    Signed-off-by: Miquel Raynal <miquel.raynal@bootlin.com>

commit d166541e9031daff120cac212f1917eff93c07d3
Author: Boris Brezillon <boris.brezillon@bootlin.com>
Date:   Wed Jul 18 10:56:51 2018 +0200

    mtd: rawnand: orion: Handle cases where __LINUX_ARM_ARCH__ is not defined
    
    Make sure __LINUX_ARM_ARCH__ is defined before testing its value.
    This is needed if we want to allow selection of this driver when
    COMPILE_TEST=y.
    
    Signed-off-by: Boris Brezillon <boris.brezillon@bootlin.com>
    Signed-off-by: Miquel Raynal <miquel.raynal@bootlin.com>

commit a29d4d8c5669a658b5a091b38205c13084967ce7
Author: Masahiro Yamada <yamada.masahiro@socionext.com>
Date:   Fri Jul 20 16:46:35 2018 +0900

    kbuild: do not update config for 'make kernelrelease'
    
    'make kernelrelease' depends on CONFIG_LOCALVERSION(_AUTO), but
    for the same reason as install targets, we do not want to update
    the configuration just for printing the kernelrelease string.
    
    This is likely to happen when you compiled the kernel with
    CROSS_COMPILE, but forget to pass it to 'make kernelrelease'.
    
    Signed-off-by: Masahiro Yamada <yamada.masahiro@socionext.com>

commit d79424137a7312d381d131d707a462440c0e8df9
Author: Masahiro Yamada <yamada.masahiro@socionext.com>
Date:   Fri Jul 20 16:46:34 2018 +0900

    kbuild: do not update config when running install targets
    
    "make syncconfig" is automatically invoked when any of the following
    happens:
    
     - .config is updated
     - any of Kconfig files is updated
     - any of environment variables referenced in Kconfig is changed
    
    Then, it updates configuration files such as include/config/auto.conf
    include/generated/autoconf.h, etc.
    
    Even install targets (install, modules_install, etc.) are no exception.
    However, they should never ever modify the source tree.  Install
    targets are often run with root privileges.  Once those configuration
    files are owned by root, "make mrproper" would end up with permission
    error.
    
    Install targets should just copy things blindly.  They should not care
    whether the configuration is up-to-date or not.  This makes more sense
    because we are interested in the configuration that was used in the
    previous kernel building.
    
    This issue has existed since before, but rarely happened.  I expect
    more chance where people are hit by this; with the new Kconfig syntax
    extension, the .config now contains the compiler information.  If you
    cross-compile the kernel with CROSS_COMPILE, but forget to pass it
    for "make install", you meet "any of environment variables referenced
    in Kconfig is changed" because $(CC) is referenced in Kconfig.
    Another scenario is the compiler upgrade before the installation.
    
    Install targets need the configuration.  "make modules_install" refer
    to CONFIG_MODULES etc.  "make dtbs_install" also needs CONFIG_ARCH_*
    to decide which dtb files to install.  However, the auto-update of
    the configuration files should be avoided.  We already do this for
    external modules.
    
    Now, Make targets are categorized into 3 groups:
    
    [1] Do not need the kernel configuration at all
    
        help, coccicheck, headers_install etc.
    
    [2] Need the latest kernel configuration
    
        If new config options are added, Kconfig will show prompt to
        ask user's selection.
    
        Build targets such as vmlinux, in-kernel modules are the cases.
    
    [3] Need the kernel configuration, but do not want to update it
    
        Install targets except headers_install, and external modules
        are the cases.
    
    Signed-off-by: Masahiro Yamada <yamada.masahiro@socionext.com>

commit 4bcde3a53edd9444dcfbf17b0dbc999fd5b781bf
Author: Vinod Koul <vkoul@kernel.org>
Date:   Wed Jul 25 17:54:08 2018 +0530

    dmaengine: Revert "dmaengine: mv_xor_v2: enable COMPILE_TEST"
    
    This reverts commit 31d5e6b72439: ("dmaengine: mv_xor_v2: enable
    COMPILE_TEST") as enabling causing bunch of build failures.
    
    Signed-off-by: Vinod Koul <vkoul@kernel.org>

commit 4bcd8c90ac0f27d3d76fcfc50582ff3685059de9
Author: Arnd Bergmann <arnd@arndb.de>
Date:   Tue Jul 24 19:11:27 2018 +0200

    omapfb: rename omap2 module to omap2fb.ko
    
    In a kernel configuration with both CONFIG_FB_OMAP=m and CONFIG_FB_OMAP2=m,
    Kbuild fails to point out that we have two modules with the same name (omapfb.ko),
    but instead fails with a cryptic error message like:
    
    ERROR: "omapfb_register_panel" [drivers/video/fbdev/omap/lcd_osk.ko] undefined!
    
    This can now happen when building a randconfig kernel with CONFIG_ARCH_OMAP1,
    as the omap1 fbdev driver depends on that, whiel the omap2 fbdev driver can
    now be built anywhere with CONFIG_COMPILE_TEST.
    
    The solution is to rename one of the two modules, so for consistency with
    the directory naming I decided to rename the omap2 version to omap2fb.ko.
    
    Fixes: 7378f1149884 ("media: omap2: omapfb: allow building it with COMPILE_TEST")
    Signed-off-by: Arnd Bergmann <arnd@arndb.de>
    Acked-by: Tony Lindgren <tony@atomide.com>
    Cc: Mauro Carvalho Chehab <mchehab@s-opensource.com>
    Signed-off-by: Bartlomiej Zolnierkiewicz <b.zolnierkie@samsung.com>

commit 06060ea7fb5b6b9b4c3251e0dcabbcca8ad91674
Author: Shaokun Zhang <zhangshaokun@hisilicon.com>
Date:   Thu Jul 19 19:26:40 2018 +0800

    drivers/perf: hisi: update the sccl_id/ccl_id when MT is supported
    
    MT bit in MPIDR_EL1 is now supported in certain HiSilicon platforms, so
    the mapping between sccl_id/ccl_id and affinity level needs to be updated
    from the generic encoding we originally used.
    
    Cc: John Garry <john.garry@huawei.com>
    Cc: Will Deacon <will.deacon@arm.com>
    Cc: Mark Rutland <mark.rutland@arm.com>
    Signed-off-by: Shaokun Zhang <zhangshaokun@hisilicon.com>
    [will: fixed comment]
    Signed-off-by: Will Deacon <will.deacon@arm.com>

commit a0b1561f846191a1967e8f5a26d8ef59c1b9162a
Author: Niklas Cassel <niklas.cassel@linaro.org>
Date:   Tue Jun 12 15:23:13 2018 +0200

    firmware: qcom: scm: add a dummy qcom_scm_assign_mem()
    
    Add a dummy qcom_scm_assign_mem() to enable building drivers when
    CONFIG_COMPILE_TEST=y && CONFIG_QCOM_SCM=n.
    
    All other qcom_scm_* functions already have a dummy version.
    
    Signed-off-by: Niklas Cassel <niklas.cassel@linaro.org>
    Reviewed-by: Bjorn Andersson <bjorn.andersson@linaro.org>
    Signed-off-by: Andy Gross <andy.gross@linaro.org>

commit 31d5e6b72439c188ccf09c0b2ba5a7a6d4db9582
Author: Hanna Hawa <hannah@marvell.com>
Date:   Tue Jul 17 13:30:03 2018 +0300

    dmaengine: mv_xor_v2: enable COMPILE_TEST
    
    To get more coverage, enable COMPILE_TEST for this driver.
    
    Signed-off-by: Hanna Hawa <hannah@marvell.com>
    Reviewed-by: Thomas Petazzoni <thomas.petazzoni@bootlin.com>
    Signed-off-by: Vinod Koul <vkoul@kernel.org>

commit ab99e11062c187533db08078ccae799faed8873e
Author: Boris Brezillon <boris.brezillon@bootlin.com>
Date:   Mon Jul 9 22:09:45 2018 +0200

    memory: jz4780-nemc: Allow selection of this driver when COMPILE_TEST=y
    
    It just makes maintainers' life easier by allowing them to compile-test
    this driver without having MACH_JZ4780 enabled.
    
    We also need to add a dependency on HAS_IOMEM to make sure the
    driver compiles correctly.
    
    Signed-off-by: Boris Brezillon <boris.brezillon@bootlin.com>
    Acked-by: Paul Burton <paul.burton@mips.com>
    Signed-off-by: Miquel Raynal <miquel.raynal@bootlin.com>

commit 6968e07e816906cd4b8150ef2e3af533664f734b
Author: Boris Brezillon <boris.brezillon@bootlin.com>
Date:   Mon Jul 9 22:09:43 2018 +0200

    mtd: rawnand: jz4740: Allow selection of this driver when COMPILE_TEST=y
    
    It just makes NAND maintainers' life easier by allowing them to
    compile-test this driver without having MACH_JZ4740 enabled.
    
    We also need to add a dependency on HAS_IOMEM to make sure the driver
    compiles correctly.
    
    Signed-off-by: Boris Brezillon <boris.brezillon@bootlin.com>
    Acked-by: Paul Burton <paul.burton@mips.com>
    Signed-off-by: Miquel Raynal <miquel.raynal@bootlin.com>

commit e65e3a50702f4e7a01c0b36ff08d6ed8dde7ee7b
Author: Boris Brezillon <boris.brezillon@bootlin.com>
Date:   Mon Jul 9 22:09:42 2018 +0200

    MIPS: jz4740: Move jz4740_nand.h header to include/linux/platform_data/jz4740
    
    This way we will be able to compile the jz4740_nand driver when
    COMPILE_TEST=y.
    
    Signed-off-by: Boris Brezillon <boris.brezillon@bootlin.com>
    Acked-by: Paul Burton <paul.burton@mips.com>
    Signed-off-by: Miquel Raynal <miquel.raynal@bootlin.com>

commit eaea2e7300a23e9e40d15ff9b80c7407e3e7802c
Author: Boris Brezillon <boris.brezillon@bootlin.com>
Date:   Mon Jul 9 22:09:41 2018 +0200

    mtd: rawnand: txx9ndfmc: Allow selection of this driver when COMPILE_TEST=y
    
    It just makes NAND maintainers' life easier by allowing them to
    compile-test this driver without having SOC_TX4938 or SOC_TX4939
    enabled.
    
    We also need to add a dependency on HAS_IOMEM to make sure the driver
    compiles correctly.
    
    Signed-off-by: Boris Brezillon <boris.brezillon@bootlin.com>
    Acked-by: Paul Burton <paul.burton@mips.com>
    Signed-off-by: Miquel Raynal <miquel.raynal@bootlin.com>

commit dc2865ac3527d76fe04ee1f1a3ffc101a60faba0
Author: Boris Brezillon <boris.brezillon@bootlin.com>
Date:   Mon Jul 9 22:09:40 2018 +0200

    MIPS: txx9: Move the ndfc.h header to include/linux/platform_data/txx9
    
    This way we will be able to compile the ndfmc driver when
    COMPILE_TEST=y.
    
    Signed-off-by: Boris Brezillon <boris.brezillon@bootlin.com>
    Acked-by: Paul Burton <paul.burton@mips.com>
    Signed-off-by: Miquel Raynal <miquel.raynal@bootlin.com>

commit a6be5051cdca8069abfe016a70ce9243ba1a2c0d
Author: Boris Brezillon <boris.brezillon@bootlin.com>
Date:   Mon Jul 9 22:09:39 2018 +0200

    mtd: rawnand: fsl_ifc: Allow selection of this driver when COMPILE_TEST=y
    
    It just makes maintainers' life easier by allowing them to compile-test
    this driver without having FSL_SOC, ARCH_LAYERSCAPE or SOC_LS1021A
    enabled.
    
    We also need to add a dependency on HAS_IOMEM to make sure the
    driver compiles correctly.
    
    Signed-off-by: Boris Brezillon <boris.brezillon@bootlin.com>
    Signed-off-by: Miquel Raynal <miquel.raynal@bootlin.com>

commit b30a2bd4ee9d3933ce397ab83a0b713e9423ec99
Author: Boris Brezillon <boris.brezillon@bootlin.com>
Date:   Mon Jul 9 22:09:37 2018 +0200

    memory: fsl_ifc: Allow selection of this driver when COMPILE_TEST=y
    
    It just makes maintainers' life easier by allowing them to compile-test
    this driver without having FSL_SOC, ARCH_LAYERSCAPE or SOC_LS1021A
    enabled.
    
    We also need to add a dependency on HAS_IOMEM to make sure the
    driver compiles correctly.
    
    Signed-off-by: Boris Brezillon <boris.brezillon@bootlin.com>
    Signed-off-by: Miquel Raynal <miquel.raynal@bootlin.com>

commit 17c09ed706de451b7b449fd57198675349b58105
Author: Boris Brezillon <boris.brezillon@bootlin.com>
Date:   Mon Jul 9 22:09:36 2018 +0200

    mtd: rawnand: fsmc: Allow selection of this driver when COMPILE_TEST=y
    
    It just makes NAND maintainers' life easier by allowing them to
    compile-test this driver without having PLAT_SPEAR, ARCH_NOMADIK,
    ARCH_U8500 or MACH_U300 enabled.
    
    We also need to add a dependency on HAS_IOMEM to make sure the driver
    compiles correctly.
    
    Signed-off-by: Boris Brezillon <boris.brezillon@bootlin.com>
    Signed-off-by: Miquel Raynal <miquel.raynal@bootlin.com>

commit f55824c6faef1df97439094a30b9f21fd2ce60a8
Author: Boris Brezillon <boris.brezillon@bootlin.com>
Date:   Mon Jul 9 22:09:35 2018 +0200

    mtd: rawnand: fsmc: Use uintptr_t casts instead of unsigned ones
    
    uintptr_t should be used when casting a pointer to an unsigned int so
    that the code compiles without warnings even on 64-bit architectures.
    
    This is needed if we want to allow selection of this driver when
    COMPILE_TEST=y.
    
    Signed-off-by: Boris Brezillon <boris.brezillon@bootlin.com>
    Signed-off-by: Miquel Raynal <miquel.raynal@bootlin.com>

commit 8f3931ed975e1d775b87ce85d65ecacd54138359
Author: Boris Brezillon <boris.brezillon@bootlin.com>
Date:   Mon Jul 9 22:09:34 2018 +0200

    mtd: rawnand: fscm: Avoid collision on PC def when compiling for MIPS
    
    We want to allow this driver to be selected when COMPILE_TEST=y, this
    means the driver can be compiled for any arch, including MIPS. When
    compiling this driver for MIPS, we end up with a collision on the 'PC'
    macro definition (also defined in arch/mips/include/asm/ptrace.h).
    
    Prefix the fsmc one with FSMC_ to avoid this problem.
    
    Signed-off-by: Boris Brezillon <boris.brezillon@bootlin.com>
    Signed-off-by: Miquel Raynal <miquel.raynal@bootlin.com>

commit e37db6df41f5d45e43d5544b2cfadeed1710f086
Author: Boris Brezillon <boris.brezillon@bootlin.com>
Date:   Mon Jul 9 22:09:33 2018 +0200

    mtd: rawnand: sunxi: Allow selection of this driver when COMPILE_TEST=y
    
    It just makes NAND maintainers' life easier by allowing them to
    compile-test this driver without having ARCH_SUNXI enabled.
    
    We also need to add a dependency on HAS_IOMEM to make sure the driver
    compiles correctly.
    
    Signed-off-by: Boris Brezillon <boris.brezillon@bootlin.com>
    Signed-off-by: Miquel Raynal <miquel.raynal@bootlin.com>

commit cf3e3fd2e94f4648f17fbd5e0e26409d5d1face9
Author: Boris Brezillon <boris.brezillon@bootlin.com>
Date:   Mon Jul 9 22:09:31 2018 +0200

    mtd: rawnand: sunxi: Add an U suffix to NFC_PAGE_OP definition
    
    Fixes the "warning: large integer implicitly truncated to unsigned type
    [-Woverflow]" warning when compiled for x86.
    
    This is needed in order to allow compiling this driver when
    COMPILE_TEST=y.
    
    Reported-by: Stephen Rothwell <sfr@canb.auug.org.au>
    Signed-off-by: Boris Brezillon <boris.brezillon@bootlin.com>
    Signed-off-by: Miquel Raynal <miquel.raynal@bootlin.com>

commit b9221470b081c4dc52de859d47e2431e76b1fac2
Author: Boris Brezillon <boris.brezillon@bootlin.com>
Date:   Mon Jul 9 22:09:30 2018 +0200

    mtd: rawnand: davinci: Allow selection of this driver when COMPILE_TEST=y
    
    It just makes NAND maintainers' life easier by allowing them to
    compile-test this driver without having ARCH_DAVINCI or ARCH_KEYSTONE
    enabled.
    
    We also need to add a dependency on HAS_IOMEM to make sure the
    driver compiles correctly.
    
    Signed-off-by: Boris Brezillon <boris.brezillon@bootlin.com>
    Signed-off-by: Miquel Raynal <miquel.raynal@bootlin.com>

commit cc53d5ca38c02e05efd20ba8af1759d1005aa454
Author: Boris Brezillon <boris.brezillon@bootlin.com>
Date:   Mon Jul 9 22:09:29 2018 +0200

    mtd: rawnand: davinci: Use uintptr_t casts instead of unsigned ones
    
    uintptr_t should be used when casting a pointer to an unsigned int so
    that the code compiles without warnings even on 64-bit architectures.
    
    This is needed if we want to allow selection of this driver when
    COMPILE_TEST=y.
    
    Reported-by: Stephen Rothwell <sfr@canb.auug.org.au>
    Signed-off-by: Boris Brezillon <boris.brezillon@bootlin.com>
    Signed-off-by: Miquel Raynal <miquel.raynal@bootlin.com>

commit c5b76d8dd2bf318d9e6b4b3a480b9e96c01b31c8
Author: Boris Brezillon <boris.brezillon@bootlin.com>
Date:   Mon Jul 9 22:09:28 2018 +0200

    mtd: rawnand: davinci: Stop doing iomem pointer <-> u32 conversions
    
    There is no point in doing this sort of conversion since we can
    replace |= by += operations which are perfectly valid on pointers.
    
    This is done in preparation of COMPILE_TEST addition to the NAND_DAVINCI
    Kconfig entry, since building for x86 generates several warnings because
    of inappropriate u32 <-> void * conversions (pointers are 64-bit large
    on x86_64).
    
    Reported-by: Stephen Rothwell <sfr@canb.auug.org.au>
    Signed-off-by: Boris Brezillon <boris.brezillon@bootlin.com>
    Signed-off-by: Miquel Raynal <miquel.raynal@bootlin.com>

commit 88a40e7dca00fef96e4396c3e8c0077ab96b15a6
Author: Boris Brezillon <boris.brezillon@bootlin.com>
Date:   Mon Jul 9 22:09:24 2018 +0200

    mtd: rawnand: atmel: Allow selection of this driver when COMPILE_TEST=y
    
    It just makes NAND maintainers' life easier by allowing them to
    compile-test this driver without having ARCH_AT91 enabled.
    
    We also need to add a dependency on HAS_IOMEM to make sure the driver
    compiles correctly.
    
    Signed-off-by: Boris Brezillon <boris.brezillon@bootlin.com>
    Signed-off-by: Miquel Raynal <miquel.raynal@bootlin.com>

commit e6848511d06189cd28f83e5aef580510699fb2b4
Author: Boris Brezillon <boris.brezillon@bootlin.com>
Date:   Mon Jul 9 22:09:22 2018 +0200

    mtd: rawnand: atmel: Use uintptr_t casts instead of unsigned int
    
    When casting a pointer to an unsigned int, uintptr_t should be used to
    cope with the pointer size differences between 32-bit and 64-bit
    architectures.
    
    This is needed if we want to allow compilation of this driver when
    COMPILE_TEST=y.
    
    Reported-by: Stephen Rothwell <sfr@canb.auug.org.au>
    Signed-off-by: Boris Brezillon <boris.brezillon@bootlin.com>
    Signed-off-by: Miquel Raynal <miquel.raynal@bootlin.com>

commit a58d0b4d512aceb06d8a968c1d19318c77faa6b0
Author: Boris Brezillon <boris.brezillon@bootlin.com>
Date:   Thu Jul 5 11:45:16 2018 +0200

    bcma: Allow selection of this driver when COMPILE_TEST=y
    
    This allows us to increase compile-test coverage without having to build
    a kernel for MIPS.  That's particularly interesting for subsystem
    maintainers that want to test as many drivers as possible in a single
    build.
    
    We also add a dependency on HAS_IOMEM in BCMA_HOST_SOC to make sure the
    driver is not selected when the arch does not implement IO accessors.
    
    Signed-off-by: Boris Brezillon <boris.brezillon@bootlin.com>
    Acked-by: Kalle Valo <kvalo@codeaurora.org>
    Signed-off-by: Miquel Raynal <miquel.raynal@bootlin.com>

commit d4de09e5bb08138f06b6d27cd0246d32866b0c68
Author: Boris Brezillon <boris.brezillon@bootlin.com>
Date:   Thu Jul 5 11:45:13 2018 +0200

    mtd: rawnand: nuc900: Allow selection of this driver when COMPILE_TEST=y
    
    It just makes NAND maintainers' life easier by allowing them to
    compile-test this driver without having ARCH_W90X900 enabled.
    
    We also need to add a dependency on HAS_IOMEM to make sure the driver
    compiles correctly.
    
    Signed-off-by: Boris Brezillon <boris.brezillon@bootlin.com>
    Signed-off-by: Miquel Raynal <miquel.raynal@bootlin.com>

commit b2d55fe2ad5a47676292b1ef211fe4f9f14133ec
Author: Boris Brezillon <boris.brezillon@bootlin.com>
Date:   Thu Jul 5 11:45:11 2018 +0200

    mtd: rawnand: qcom: Allow selection of this driver when COMPILE_TEST=y
    
    It just makes NAND maintainers' life easier by allowing them to
    compile-test this driver without having ARCH_QCOM enabled.
    
    We also need to add a dependency on HAS_IOMEM to make sure the driver
    compiles correctly.
    
    Signed-off-by: Boris Brezillon <boris.brezillon@bootlin.com>
    Signed-off-by: Miquel Raynal <miquel.raynal@bootlin.com>

commit 434bc2e148aa5a6052cbc038f485fa3284a477d0
Author: Boris Brezillon <boris.brezillon@bootlin.com>
Date:   Thu Jul 5 11:45:08 2018 +0200

    mtd: rawnand: mxc: Allow selection of this driver when COMPILE_TEST=y
    
    It just makes NAND maintainers' life easier by allowing them to
    compile-test this driver without having ARCH_MXC enabled.
    
    We also need to add a dependency on HAS_IOMEM to make sure the
    driver compiles correctly.
    
    Signed-off-by: Boris Brezillon <boris.brezillon@bootlin.com>
    Signed-off-by: Miquel Raynal <miquel.raynal@bootlin.com>

commit c03f3cf37e54fee8c04c531dae1c81ebc8f58723
Author: Boris Brezillon <boris.brezillon@bootlin.com>
Date:   Thu Jul 5 11:45:07 2018 +0200

    mtd: rawnand: mxc: Avoid inclusion of asm/mach headers
    
    asm/mach/flash.h does not seem to be needed, drop this #include to make
    the code completely machine and arch independent and allow one to
    compile it when COMPILE_TEST=y.
    
    Signed-off-by: Boris Brezillon <boris.brezillon@bootlin.com>
    Signed-off-by: Miquel Raynal <miquel.raynal@bootlin.com>

commit 0beb48724120ae13fe87d344a78fb430e077fed9
Author: Boris Brezillon <boris.brezillon@bootlin.com>
Date:   Thu Jul 5 11:45:04 2018 +0200

    mtd: rawnand: brcmnand: Allow selection of this driver when COMPILE_TEST=y
    
    It just makes NAND maintainers' life easier by allowing them to
    compile-test this driver without having ARM, ARM64 or MIPS enabled.
    
    We also need to add a dependency on HAS_IOMEM to make sure the driver
    compiles correctly.
    
    Signed-off-by: Boris Brezillon <boris.brezillon@bootlin.com>
    Signed-off-by: Miquel Raynal <miquel.raynal@bootlin.com>

commit ee70e5e796ff30e486bef4800a633df8e14d6245
Author: Boris Brezillon <boris.brezillon@bootlin.com>
Date:   Thu Jul 5 11:45:03 2018 +0200

    mtd: rawnand: lpc32xx: Allow selection of these drivers when COMPILE_TEST=y
    
    It just makes NAND maintainers' life easier by allowing them to
    compile-test these drivers without having ARCH_LPC32XX enabled.
    
    We also need to add a dependency on HAS_IOMEM to make sure the driver
    compiles correctly.
    
    Signed-off-by: Boris Brezillon <boris.brezillon@bootlin.com>
    Signed-off-by: Miquel Raynal <miquel.raynal@bootlin.com>

commit 18331b98102925f17be13421e153b050b8df01d3
Author: Boris Brezillon <boris.brezillon@bootlin.com>
Date:   Thu Jul 5 11:45:02 2018 +0200

    mtd: rawnand: sharpsl: Allow selection of this driver when COMPILE_TEST=y
    
    It just makes NAND maintainers' life easier by allowing them to
    compile-test this driver without having ARCH_PXA enabled.
    
    We also need to add a dependency on HAS_IOMEM to make sure the driver
    compiles correctly.
    
    Signed-off-by: Boris Brezillon <boris.brezillon@bootlin.com>
    Signed-off-by: Miquel Raynal <miquel.raynal@bootlin.com>

commit b22a8b075dbc755dd483e1d318c8f2933464583e
Author: Boris Brezillon <boris.brezillon@bootlin.com>
Date:   Thu Jul 5 11:45:01 2018 +0200

    mtd: rawnand: sharpsl: Remove inclusion of mach and asm headers
    
    We don't need mach/hardware.h and sm/mach-types.h, and asm/io.h can be
    replaced by linux/io.h.
    
    Now that we removed those inclusions, we're ready to allow selection of
    this driver when COMPILE_TEST=y.
    
    Signed-off-by: Boris Brezillon <boris.brezillon@bootlin.com>
    Signed-off-by: Miquel Raynal <miquel.raynal@bootlin.com>

commit 31ac1a53eb7f4407decbbbe65d8232311705029e
Author: Boris Brezillon <boris.brezillon@bootlin.com>
Date:   Thu Jul 5 11:44:59 2018 +0200

    mtd: rawnand: omap2: Allow selection of this driver when COMPILE_TEST=y
    
    It just makes NAND maintainers' life easier by allowing them to
    compile-test this driver without having ARCH_OMAP2PLUS or ARCH_KEYSTONE
    enabled.
    
    We also need to add a dependency on HAS_IOMEM to make sure the driver
    compiles correctly.
    
    Signed-off-by: Boris Brezillon <boris.brezillon@bootlin.com>
    Signed-off-by: Miquel Raynal <miquel.raynal@bootlin.com>

commit 45e9f40f466955c9880d59683531f6d1366b97cd
Author: Boris Brezillon <boris.brezillon@bootlin.com>
Date:   Thu Jul 5 11:44:57 2018 +0200

    mtd: rawnand: Add 'depends on HAS_IOMEM' where missing
    
    When COMPILE_TEST is allowed and the platform needs uses the iomem API
    we need to add an explicit dependency on HAS_IOMEM to avoid selection
    of these drivers when building for an arch that has no iomem support
    (this is the case of arch/um).
    
    Signed-off-by: Boris Brezillon <boris.brezillon@bootlin.com>
    Signed-off-by: Miquel Raynal <miquel.raynal@bootlin.com>

commit 591217d19b00bfdc48c19b65c667523d3f61ff33
Author: Geert Uytterhoeven <geert@linux-m68k.org>
Date:   Thu Jun 21 21:00:16 2018 +0200

    misc: ti-st: Allow compile test of GPIO consumers if !GPIOLIB
    
    The GPIO subsystem provides dummy GPIO consumer functions if GPIOLIB is
    not enabled. Hence drivers that depend on GPIOLIB, but use GPIO consumer
    functionality only, can still be compiled if GPIOLIB is not enabled.
    
    Relax the dependency on GPIOLIB if COMPILE_TEST is enabled, where
    appropriate.
    
    Signed-off-by: Geert Uytterhoeven <geert@linux-m68k.org>
    Acked-by: Linus Walleij <linus.walleij@linaro.org>
    Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>

commit 987553894f0ce8c1d83578136603a89009f42d35
Author: Greentime Hu <greentime@andestech.com>
Date:   Thu Jul 5 16:13:47 2018 +0800

    nds32: fix build error "relocation truncated to fit: R_NDS32_25_PCREL_RELA" when
    make allyesconfig
    
    It will cause a linking error because the jump assembly code were using j,
    however it may be not enough to jump to the destination. We have to change it
    with pseudo instruction b. In that way, assembler will generate a set of safe
    assembly codes to make sure the destination is able to jump.
    
    Toolchain:
    https://mirrors.edge.kernel.org/pub/tools/crosstool/files/bin/x86_64/8.1.0/x86_64-gcc-8.1.0-nolibc-nds32le-linux.tar.gz
    
    Command:
    PATH=/NOBACKUP/atcsqa06/greentime/os/toolchain-kernel.org/gcc-8.1.0-nolibc/nds32le-linux/bin:$PATH ARCH=nds32 CROSS_COMPILE=nds32le-linux- make allyesconfig
    PATH=/NOBACKUP/atcsqa06/greentime/os/toolchain-kernel.org/gcc-8.1.0-nolibc/nds32le-linux/bin:$PATH ARCH=nds32 CROSS_COMPILE=nds32le-linux- make -j8
    
      MODPOST vmlinux.o
    WARNING: EXPORT symbol "copy_page" [vmlinux] version generation failed, symbol will not be versioned.
    WARNING: EXPORT symbol "clear_page" [vmlinux] version generation failed, symbol will not be versioned.
    nds32le-linux-ld: kernel/futex.o:(.fixup+0x4): relocation truncated to fit: R_NDS32_25_PCREL_RELA against `.text'
    nds32le-linux-ld: kernel/futex.o:(.fixup+0xaa): relocation truncated to fit: R_NDS32_25_PCREL_RELA against `.text'
    nds32le-linux-ld: kernel/futex.o:(.fixup+0xb0): relocation truncated to fit: R_NDS32_25_PCREL_RELA against `.text'
    nds32le-linux-ld: kernel/futex.o:(.fixup+0xb6): relocation truncated to fit: R_NDS32_25_PCREL_RELA against `.text'
    nds32le-linux-ld: kernel/futex.o:(.fixup+0xbc): relocation truncated to fit: R_NDS32_25_PCREL_RELA against `.text'
    nds32le-linux-ld: kernel/futex.o:(.fixup+0xc4): relocation truncated to fit: R_NDS32_25_PCREL_RELA against `.text'
    Makefile:1010: recipe for target 'vmlinux' failed
    make: *** [vmlinux] Error 1
    
    Signed-off-by: Greentime Hu <greentime@andestech.com>

commit ffa15404faa7d3b77e2caef33a03e1ba29deb507
Author: Mike Marciniszyn <mike.marciniszyn@intel.com>
Date:   Fri May 18 17:07:01 2018 -0700

    IB/qib: Fix DMA api warning with debug kernel
    
    commit 0252f73334f9ef68868e4684200bea3565a4fcee upstream.
    
    The following error occurs in a debug build when running MPI PSM:
    
    [  307.415911] WARNING: CPU: 4 PID: 23867 at lib/dma-debug.c:1158
    check_unmap+0x4ee/0xa20
    [  307.455661] ib_qib 0000:05:00.0: DMA-API: device driver failed to check map
    error[device address=0x00000000df82b000] [size=4096 bytes] [mapped as page]
    [  307.517494] Modules linked in:
    [  307.531584]  ib_isert iscsi_target_mod ib_srpt target_core_mod rpcrdma
    sunrpc ib_srp scsi_transport_srp scsi_tgt ib_iser libiscsi ib_ipoib
    scsi_transport_iscsi rdma_ucm ib_ucm ib_uverbs ib_umad rdma_cm ib_cm iw_cm
    ib_qib intel_powerclamp coretemp rdmavt intel_rapl iosf_mbi kvm_intel kvm
    irqbypass crc32_pclmul ghash_clmulni_intel ipmi_ssif ib_core aesni_intel sg
    ipmi_si lrw gf128mul dca glue_helper ipmi_devintf iTCO_wdt gpio_ich hpwdt
    iTCO_vendor_support ablk_helper hpilo acpi_power_meter cryptd ipmi_msghandler
    ie31200_edac shpchp pcc_cpufreq lpc_ich pcspkr ip_tables xfs libcrc32c sd_mod
    crc_t10dif crct10dif_generic mgag200 i2c_algo_bit drm_kms_helper syscopyarea
    sysfillrect sysimgblt fb_sys_fops ttm ahci crct10dif_pclmul crct10dif_common
    drm crc32c_intel libahci tg3 libata serio_raw ptp i2c_core
    [  307.846113]  pps_core dm_mirror dm_region_hash dm_log dm_mod
    [  307.866505] CPU: 4 PID: 23867 Comm: mpitests-IMB-MP Kdump: loaded Not
    tainted 3.10.0-862.el7.x86_64.debug #1
    [  307.911178] Hardware name: HP ProLiant DL320e Gen8, BIOS J05 11/09/2013
    [  307.944206] Call Trace:
    [  307.956973]  [<ffffffffbd9e915b>] dump_stack+0x19/0x1b
    [  307.982201]  [<ffffffffbd2a2f58>] __warn+0xd8/0x100
    [  308.005999]  [<ffffffffbd2a2fdf>] warn_slowpath_fmt+0x5f/0x80
    [  308.034260]  [<ffffffffbd5f667e>] check_unmap+0x4ee/0xa20
    [  308.060801]  [<ffffffffbd41acaa>] ? page_add_file_rmap+0x2a/0x1d0
    [  308.090689]  [<ffffffffbd5f6c4d>] debug_dma_unmap_page+0x9d/0xb0
    [  308.120155]  [<ffffffffbd4082e0>] ? might_fault+0xa0/0xb0
    [  308.146656]  [<ffffffffc07761a5>] qib_tid_free.isra.14+0x215/0x2a0 [ib_qib]
    [  308.180739]  [<ffffffffc0776bf4>] qib_write+0x894/0x1280 [ib_qib]
    [  308.210733]  [<ffffffffbd540b00>] ? __inode_security_revalidate+0x70/0x80
    [  308.244837]  [<ffffffffbd53c2b7>] ? security_file_permission+0x27/0xb0
    [  308.266025] qib_ib0.8006: multicast join failed for
    ff12:401b:8006:0000:0000:0000:ffff:ffff, status -22
    [  308.323421]  [<ffffffffbd46f5d3>] vfs_write+0xc3/0x1f0
    [  308.347077]  [<ffffffffbd492a5c>] ? fget_light+0xfc/0x510
    [  308.372533]  [<ffffffffbd47045a>] SyS_write+0x8a/0x100
    [  308.396456]  [<ffffffffbd9ff355>] system_call_fastpath+0x1c/0x21
    
    The code calls a qib_map_page() which has never correctly tested for a
    mapping error.
    
    Fix by testing for pci_dma_mapping_error() in all cases and properly
    handling the failure in the caller.
    
    Additionally, streamline qib_map_page() arguments to satisfy just
    the single caller.
    
    Cc: <stable@vger.kernel.org>
    Reviewed-by: Alex Estrin <alex.estrin@intel.com>
    Tested-by: Don Dutile <ddutile@redhat.com>
    Reviewed-by: Don Dutile <ddutile@redhat.com>
    Signed-off-by: Mike Marciniszyn <mike.marciniszyn@intel.com>
    Signed-off-by: Dennis Dalessandro <dennis.dalessandro@intel.com>
    Signed-off-by: Doug Ledford <dledford@redhat.com>
    Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>

commit e884ed82995ad9d31b6fa93bbaa7870a584700dd
Author: Mike Marciniszyn <mike.marciniszyn@intel.com>
Date:   Fri May 18 17:07:01 2018 -0700

    IB/qib: Fix DMA api warning with debug kernel
    
    commit 0252f73334f9ef68868e4684200bea3565a4fcee upstream.
    
    The following error occurs in a debug build when running MPI PSM:
    
    [  307.415911] WARNING: CPU: 4 PID: 23867 at lib/dma-debug.c:1158
    check_unmap+0x4ee/0xa20
    [  307.455661] ib_qib 0000:05:00.0: DMA-API: device driver failed to check map
    error[device address=0x00000000df82b000] [size=4096 bytes] [mapped as page]
    [  307.517494] Modules linked in:
    [  307.531584]  ib_isert iscsi_target_mod ib_srpt target_core_mod rpcrdma
    sunrpc ib_srp scsi_transport_srp scsi_tgt ib_iser libiscsi ib_ipoib
    scsi_transport_iscsi rdma_ucm ib_ucm ib_uverbs ib_umad rdma_cm ib_cm iw_cm
    ib_qib intel_powerclamp coretemp rdmavt intel_rapl iosf_mbi kvm_intel kvm
    irqbypass crc32_pclmul ghash_clmulni_intel ipmi_ssif ib_core aesni_intel sg
    ipmi_si lrw gf128mul dca glue_helper ipmi_devintf iTCO_wdt gpio_ich hpwdt
    iTCO_vendor_support ablk_helper hpilo acpi_power_meter cryptd ipmi_msghandler
    ie31200_edac shpchp pcc_cpufreq lpc_ich pcspkr ip_tables xfs libcrc32c sd_mod
    crc_t10dif crct10dif_generic mgag200 i2c_algo_bit drm_kms_helper syscopyarea
    sysfillrect sysimgblt fb_sys_fops ttm ahci crct10dif_pclmul crct10dif_common
    drm crc32c_intel libahci tg3 libata serio_raw ptp i2c_core
    [  307.846113]  pps_core dm_mirror dm_region_hash dm_log dm_mod
    [  307.866505] CPU: 4 PID: 23867 Comm: mpitests-IMB-MP Kdump: loaded Not
    tainted 3.10.0-862.el7.x86_64.debug #1
    [  307.911178] Hardware name: HP ProLiant DL320e Gen8, BIOS J05 11/09/2013
    [  307.944206] Call Trace:
    [  307.956973]  [<ffffffffbd9e915b>] dump_stack+0x19/0x1b
    [  307.982201]  [<ffffffffbd2a2f58>] __warn+0xd8/0x100
    [  308.005999]  [<ffffffffbd2a2fdf>] warn_slowpath_fmt+0x5f/0x80
    [  308.034260]  [<ffffffffbd5f667e>] check_unmap+0x4ee/0xa20
    [  308.060801]  [<ffffffffbd41acaa>] ? page_add_file_rmap+0x2a/0x1d0
    [  308.090689]  [<ffffffffbd5f6c4d>] debug_dma_unmap_page+0x9d/0xb0
    [  308.120155]  [<ffffffffbd4082e0>] ? might_fault+0xa0/0xb0
    [  308.146656]  [<ffffffffc07761a5>] qib_tid_free.isra.14+0x215/0x2a0 [ib_qib]
    [  308.180739]  [<ffffffffc0776bf4>] qib_write+0x894/0x1280 [ib_qib]
    [  308.210733]  [<ffffffffbd540b00>] ? __inode_security_revalidate+0x70/0x80
    [  308.244837]  [<ffffffffbd53c2b7>] ? security_file_permission+0x27/0xb0
    [  308.266025] qib_ib0.8006: multicast join failed for
    ff12:401b:8006:0000:0000:0000:ffff:ffff, status -22
    [  308.323421]  [<ffffffffbd46f5d3>] vfs_write+0xc3/0x1f0
    [  308.347077]  [<ffffffffbd492a5c>] ? fget_light+0xfc/0x510
    [  308.372533]  [<ffffffffbd47045a>] SyS_write+0x8a/0x100
    [  308.396456]  [<ffffffffbd9ff355>] system_call_fastpath+0x1c/0x21
    
    The code calls a qib_map_page() which has never correctly tested for a
    mapping error.
    
    Fix by testing for pci_dma_mapping_error() in all cases and properly
    handling the failure in the caller.
    
    Additionally, streamline qib_map_page() arguments to satisfy just
    the single caller.
    
    Cc: <stable@vger.kernel.org>
    Reviewed-by: Alex Estrin <alex.estrin@intel.com>
    Tested-by: Don Dutile <ddutile@redhat.com>
    Reviewed-by: Don Dutile <ddutile@redhat.com>
    Signed-off-by: Mike Marciniszyn <mike.marciniszyn@intel.com>
    Signed-off-by: Dennis Dalessandro <dennis.dalessandro@intel.com>
    Signed-off-by: Doug Ledford <dledford@redhat.com>
    Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>

commit 9321e8303406e2a194ba8e88fa8b57ee360f3f00
Author: Mike Marciniszyn <mike.marciniszyn@intel.com>
Date:   Fri May 18 17:07:01 2018 -0700

    IB/qib: Fix DMA api warning with debug kernel
    
    commit 0252f73334f9ef68868e4684200bea3565a4fcee upstream.
    
    The following error occurs in a debug build when running MPI PSM:
    
    [  307.415911] WARNING: CPU: 4 PID: 23867 at lib/dma-debug.c:1158
    check_unmap+0x4ee/0xa20
    [  307.455661] ib_qib 0000:05:00.0: DMA-API: device driver failed to check map
    error[device address=0x00000000df82b000] [size=4096 bytes] [mapped as page]
    [  307.517494] Modules linked in:
    [  307.531584]  ib_isert iscsi_target_mod ib_srpt target_core_mod rpcrdma
    sunrpc ib_srp scsi_transport_srp scsi_tgt ib_iser libiscsi ib_ipoib
    scsi_transport_iscsi rdma_ucm ib_ucm ib_uverbs ib_umad rdma_cm ib_cm iw_cm
    ib_qib intel_powerclamp coretemp rdmavt intel_rapl iosf_mbi kvm_intel kvm
    irqbypass crc32_pclmul ghash_clmulni_intel ipmi_ssif ib_core aesni_intel sg
    ipmi_si lrw gf128mul dca glue_helper ipmi_devintf iTCO_wdt gpio_ich hpwdt
    iTCO_vendor_support ablk_helper hpilo acpi_power_meter cryptd ipmi_msghandler
    ie31200_edac shpchp pcc_cpufreq lpc_ich pcspkr ip_tables xfs libcrc32c sd_mod
    crc_t10dif crct10dif_generic mgag200 i2c_algo_bit drm_kms_helper syscopyarea
    sysfillrect sysimgblt fb_sys_fops ttm ahci crct10dif_pclmul crct10dif_common
    drm crc32c_intel libahci tg3 libata serio_raw ptp i2c_core
    [  307.846113]  pps_core dm_mirror dm_region_hash dm_log dm_mod
    [  307.866505] CPU: 4 PID: 23867 Comm: mpitests-IMB-MP Kdump: loaded Not
    tainted 3.10.0-862.el7.x86_64.debug #1
    [  307.911178] Hardware name: HP ProLiant DL320e Gen8, BIOS J05 11/09/2013
    [  307.944206] Call Trace:
    [  307.956973]  [<ffffffffbd9e915b>] dump_stack+0x19/0x1b
    [  307.982201]  [<ffffffffbd2a2f58>] __warn+0xd8/0x100
    [  308.005999]  [<ffffffffbd2a2fdf>] warn_slowpath_fmt+0x5f/0x80
    [  308.034260]  [<ffffffffbd5f667e>] check_unmap+0x4ee/0xa20
    [  308.060801]  [<ffffffffbd41acaa>] ? page_add_file_rmap+0x2a/0x1d0
    [  308.090689]  [<ffffffffbd5f6c4d>] debug_dma_unmap_page+0x9d/0xb0
    [  308.120155]  [<ffffffffbd4082e0>] ? might_fault+0xa0/0xb0
    [  308.146656]  [<ffffffffc07761a5>] qib_tid_free.isra.14+0x215/0x2a0 [ib_qib]
    [  308.180739]  [<ffffffffc0776bf4>] qib_write+0x894/0x1280 [ib_qib]
    [  308.210733]  [<ffffffffbd540b00>] ? __inode_security_revalidate+0x70/0x80
    [  308.244837]  [<ffffffffbd53c2b7>] ? security_file_permission+0x27/0xb0
    [  308.266025] qib_ib0.8006: multicast join failed for
    ff12:401b:8006:0000:0000:0000:ffff:ffff, status -22
    [  308.323421]  [<ffffffffbd46f5d3>] vfs_write+0xc3/0x1f0
    [  308.347077]  [<ffffffffbd492a5c>] ? fget_light+0xfc/0x510
    [  308.372533]  [<ffffffffbd47045a>] SyS_write+0x8a/0x100
    [  308.396456]  [<ffffffffbd9ff355>] system_call_fastpath+0x1c/0x21
    
    The code calls a qib_map_page() which has never correctly tested for a
    mapping error.
    
    Fix by testing for pci_dma_mapping_error() in all cases and properly
    handling the failure in the caller.
    
    Additionally, streamline qib_map_page() arguments to satisfy just
    the single caller.
    
    Cc: <stable@vger.kernel.org>
    Reviewed-by: Alex Estrin <alex.estrin@intel.com>
    Tested-by: Don Dutile <ddutile@redhat.com>
    Reviewed-by: Don Dutile <ddutile@redhat.com>
    Signed-off-by: Mike Marciniszyn <mike.marciniszyn@intel.com>
    Signed-off-by: Dennis Dalessandro <dennis.dalessandro@intel.com>
    Signed-off-by: Doug Ledford <dledford@redhat.com>
    Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>

commit 586ff170c7281af3b6a9f7af23d1fb18949fa2fa
Author: Mike Marciniszyn <mike.marciniszyn@intel.com>
Date:   Fri May 18 17:07:01 2018 -0700

    IB/qib: Fix DMA api warning with debug kernel
    
    commit 0252f73334f9ef68868e4684200bea3565a4fcee upstream.
    
    The following error occurs in a debug build when running MPI PSM:
    
    [  307.415911] WARNING: CPU: 4 PID: 23867 at lib/dma-debug.c:1158
    check_unmap+0x4ee/0xa20
    [  307.455661] ib_qib 0000:05:00.0: DMA-API: device driver failed to check map
    error[device address=0x00000000df82b000] [size=4096 bytes] [mapped as page]
    [  307.517494] Modules linked in:
    [  307.531584]  ib_isert iscsi_target_mod ib_srpt target_core_mod rpcrdma
    sunrpc ib_srp scsi_transport_srp scsi_tgt ib_iser libiscsi ib_ipoib
    scsi_transport_iscsi rdma_ucm ib_ucm ib_uverbs ib_umad rdma_cm ib_cm iw_cm
    ib_qib intel_powerclamp coretemp rdmavt intel_rapl iosf_mbi kvm_intel kvm
    irqbypass crc32_pclmul ghash_clmulni_intel ipmi_ssif ib_core aesni_intel sg
    ipmi_si lrw gf128mul dca glue_helper ipmi_devintf iTCO_wdt gpio_ich hpwdt
    iTCO_vendor_support ablk_helper hpilo acpi_power_meter cryptd ipmi_msghandler
    ie31200_edac shpchp pcc_cpufreq lpc_ich pcspkr ip_tables xfs libcrc32c sd_mod
    crc_t10dif crct10dif_generic mgag200 i2c_algo_bit drm_kms_helper syscopyarea
    sysfillrect sysimgblt fb_sys_fops ttm ahci crct10dif_pclmul crct10dif_common
    drm crc32c_intel libahci tg3 libata serio_raw ptp i2c_core
    [  307.846113]  pps_core dm_mirror dm_region_hash dm_log dm_mod
    [  307.866505] CPU: 4 PID: 23867 Comm: mpitests-IMB-MP Kdump: loaded Not
    tainted 3.10.0-862.el7.x86_64.debug #1
    [  307.911178] Hardware name: HP ProLiant DL320e Gen8, BIOS J05 11/09/2013
    [  307.944206] Call Trace:
    [  307.956973]  [<ffffffffbd9e915b>] dump_stack+0x19/0x1b
    [  307.982201]  [<ffffffffbd2a2f58>] __warn+0xd8/0x100
    [  308.005999]  [<ffffffffbd2a2fdf>] warn_slowpath_fmt+0x5f/0x80
    [  308.034260]  [<ffffffffbd5f667e>] check_unmap+0x4ee/0xa20
    [  308.060801]  [<ffffffffbd41acaa>] ? page_add_file_rmap+0x2a/0x1d0
    [  308.090689]  [<ffffffffbd5f6c4d>] debug_dma_unmap_page+0x9d/0xb0
    [  308.120155]  [<ffffffffbd4082e0>] ? might_fault+0xa0/0xb0
    [  308.146656]  [<ffffffffc07761a5>] qib_tid_free.isra.14+0x215/0x2a0 [ib_qib]
    [  308.180739]  [<ffffffffc0776bf4>] qib_write+0x894/0x1280 [ib_qib]
    [  308.210733]  [<ffffffffbd540b00>] ? __inode_security_revalidate+0x70/0x80
    [  308.244837]  [<ffffffffbd53c2b7>] ? security_file_permission+0x27/0xb0
    [  308.266025] qib_ib0.8006: multicast join failed for
    ff12:401b:8006:0000:0000:0000:ffff:ffff, status -22
    [  308.323421]  [<ffffffffbd46f5d3>] vfs_write+0xc3/0x1f0
    [  308.347077]  [<ffffffffbd492a5c>] ? fget_light+0xfc/0x510
    [  308.372533]  [<ffffffffbd47045a>] SyS_write+0x8a/0x100
    [  308.396456]  [<ffffffffbd9ff355>] system_call_fastpath+0x1c/0x21
    
    The code calls a qib_map_page() which has never correctly tested for a
    mapping error.
    
    Fix by testing for pci_dma_mapping_error() in all cases and properly
    handling the failure in the caller.
    
    Additionally, streamline qib_map_page() arguments to satisfy just
    the single caller.
    
    Cc: <stable@vger.kernel.org>
    Reviewed-by: Alex Estrin <alex.estrin@intel.com>
    Tested-by: Don Dutile <ddutile@redhat.com>
    Reviewed-by: Don Dutile <ddutile@redhat.com>
    Signed-off-by: Mike Marciniszyn <mike.marciniszyn@intel.com>
    Signed-off-by: Dennis Dalessandro <dennis.dalessandro@intel.com>
    Signed-off-by: Doug Ledford <dledford@redhat.com>
    Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>

commit d55bac2754476624f23bdf3b908d117f3cdf469b
Author: Geert Uytterhoeven <geert@linux-m68k.org>
Date:   Fri Jun 22 13:03:07 2018 +0200

    ata: Remove depends on HAS_DMA in case of platform dependency
    
    Remove dependencies on HAS_DMA where a Kconfig symbol depends on another
    symbol that implies HAS_DMA, and, optionally, on "|| COMPILE_TEST".
    In most cases this other symbol is an architecture or platform specific
    symbol, or PCI.
    
    Generic symbols and drivers without platform dependencies keep their
    dependencies on HAS_DMA, to prevent compiling subsystems or drivers that
    cannot work anyway.
    
    This simplifies the dependencies, and allows to improve compile-testing.
    
    Signed-off-by: Geert Uytterhoeven <geert@linux-m68k.org>
    Reviewed-by: Mark Brown <broonie@kernel.org>
    Acked-by: Robin Murphy <robin.murphy@arm.com>
    Signed-off-by: Tejun Heo <tj@kernel.org>

commit 6f3de8388efcede60a7aee04022c4d02719f44c8
Author: Arnd Bergmann <arnd@arndb.de>
Date:   Fri May 25 11:25:08 2018 -0400

    media: omap3isp: fix warning for !CONFIG_PM
    
    The final version of the COMPILE_TEST patch for this driver missed
    one warning about suspend/resume functions that can now appear
    on platforms that don't always set CONFIG_PM:
    
    drivers/media/platform/omap3isp/isp.c:1008:13: error: 'isp_resume_modules' defined but not used [-Werror=unused-function]
     static void isp_resume_modules(struct isp_device *isp)
                 ^~~~~~~~~~~~~~~~~~
    drivers/media/platform/omap3isp/isp.c:974:12: error: 'isp_suspend_modules' defined but not used [-Werror=unused-function]
     static int isp_suspend_modules(struct isp_device *isp)
    
    This marks the respective functions as __maybe_unused as an easy
    workaround.
    
    Fixes: 243131134be4 ("media: omap3isp: Allow it to build with COMPILE_TEST")
    
    Signed-off-by: Arnd Bergmann <arnd@arndb.de>
    Signed-off-by: Sakari Ailus <sakari.ailus@linux.intel.com>
    Signed-off-by: Mauro Carvalho Chehab <mchehab+samsung@kernel.org>

commit 72b2884d62962e62079a940e58aee9a67074d304
Author: Sergio Paracuellos <sergio.paracuellos@gmail.com>
Date:   Mon Jun 18 11:36:07 2018 +0200

    staging: mt7621-gpio: add COMPILE_TEST
    
    This driver is actually platform-agnostic.  Add COMPILE_TEST for
    the compilation test coverage.
    
    Signed-off-by: Sergio Paracuellos <sergio.paracuellos@gmail.com>
    Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>

commit 3a358e22844d4a88d872891c77d7eee4fbca5f37
Author: Geert Uytterhoeven <geert@linux-m68k.org>
Date:   Thu Jun 21 20:54:42 2018 +0200

    w1: Allow compile test of GPIO consumers if !GPIOLIB
    
    The GPIO subsystem provides dummy GPIO consumer functions if GPIOLIB is
    not enabled. Hence drivers that depend on GPIOLIB, but use GPIO consumer
    functionality only, can still be compiled if GPIOLIB is not enabled.
    
    Relax the dependency on GPIOLIB if COMPILE_TEST is enabled, where
    appropriate.
    
    Signed-off-by: Geert Uytterhoeven <geert@linux-m68k.org>
    Acked-by: Linus Walleij <linus.walleij@linaro.org>
    Acked-by: Evgeniy Polyakov <zbr@ioremap.net>
    Signed-off-by: Linus Walleij <linus.walleij@linaro.org>

commit 5126aec542fecf68dac877ea9da47d3777edcbfb
Author: Geert Uytterhoeven <geert@linux-m68k.org>
Date:   Fri Jun 22 13:05:01 2018 +0200

    iio: adc: Remove depends on HAS_DMA in case of platform dependency
    
    Remove dependencies on HAS_DMA where a Kconfig symbol depends on another
    symbol that implies HAS_DMA, and, optionally, on "|| COMPILE_TEST".
    In most cases this other symbol is an architecture or platform specific
    symbol, or PCI.
    
    Generic symbols and drivers without platform dependencies keep their
    dependencies on HAS_DMA, to prevent compiling subsystems or drivers that
    cannot work anyway.
    
    This simplifies the dependencies, and allows to improve compile-testing.
    
    Signed-off-by: Geert Uytterhoeven <geert@linux-m68k.org>
    Reviewed-by: Mark Brown <broonie@kernel.org>
    Acked-by: Robin Murphy <robin.murphy@arm.com>
    Signed-off-by: Jonathan Cameron <Jonathan.Cameron@huawei.com>

commit e020797b7def11c8feeb3ee5c1f48c12cb959def
Author: Geert Uytterhoeven <geert@linux-m68k.org>
Date:   Fri Jun 22 13:08:43 2018 +0200

    net: Remove depends on HAS_DMA in case of platform dependency
    
    Remove dependencies on HAS_DMA where a Kconfig symbol depends on another
    symbol that implies HAS_DMA, and, optionally, on "|| COMPILE_TEST".
    In most cases this other symbol is an architecture or platform specific
    symbol, or PCI.
    
    Generic symbols and drivers without platform dependencies keep their
    dependencies on HAS_DMA, to prevent compiling subsystems or drivers that
    cannot work anyway.
    
    This simplifies the dependencies, and allows to improve compile-testing.
    
    Signed-off-by: Geert Uytterhoeven <geert@linux-m68k.org>
    Reviewed-by: Mark Brown <broonie@kernel.org>
    Acked-by: Robin Murphy <robin.murphy@arm.com>
    Signed-off-by: David S. Miller <davem@davemloft.net>

commit d55207e37a35f811e1d93ae83d4dcaaaecde053d
Author: Geert Uytterhoeven <geert@linux-m68k.org>
Date:   Thu Jun 21 20:58:00 2018 +0200

    net: phy: Allow compile test of GPIO consumers if !GPIOLIB
    
    The GPIO subsystem provides dummy GPIO consumer functions if GPIOLIB is
    not enabled. Hence drivers that depend on GPIOLIB, but use GPIO consumer
    functionality only, can still be compiled if GPIOLIB is not enabled.
    
    Relax the dependency on GPIOLIB if COMPILE_TEST is enabled, where
    appropriate.
    
    Signed-off-by: Geert Uytterhoeven <geert@linux-m68k.org>
    Acked-by: Linus Walleij <linus.walleij@linaro.org>
    Signed-off-by: David S. Miller <davem@davemloft.net>

commit 0ae52ddf5bd7f685bb43d7687290f6c2eeacfb31
Author: Geert Uytterhoeven <geert@linux-m68k.org>
Date:   Fri Jun 22 13:05:35 2018 +0200

    lightnvm: Remove depends on HAS_DMA in case of platform dependency
    
    Remove dependencies on HAS_DMA where a Kconfig symbol depends on another
    symbol that implies HAS_DMA, and, optionally, on "|| COMPILE_TEST".
    In most cases this other symbol is an architecture or platform specific
    symbol, or PCI.
    
    Generic symbols and drivers without platform dependencies keep their
    dependencies on HAS_DMA, to prevent compiling subsystems or drivers that
    cannot work anyway.
    
    This simplifies the dependencies, and allows to improve compile-testing.
    
    Signed-off-by: Geert Uytterhoeven <geert@linux-m68k.org>
    Reviewed-by: Mark Brown <broonie@kernel.org>
    Acked-by: Robin Murphy <robin.murphy@arm.com>
    Reviewed-by: Matias Bjrling <mb@lightnvm.io>
    Signed-off-by: Jens Axboe <axboe@kernel.dk>

commit 2b48be65685a23f4ffc7a06858992bc31e98e198
Author: Chaitra P B <chaitra.basappa@broadcom.com>
Date:   Thu May 31 06:34:51 2018 -0400

    scsi: mpt3sas: As per MPI-spec, use combined reply queue for SAS3.5 controllers when HBA supports more than 16 MSI-x vectors.
    
    Presently driver is using combined reply queue feature when MSI-x vectors >
    8 for both SAS3 and SAS3.5 controllers.  But as per MPI-spec,
    
    1. For SAS3 controllers, driver should use combined reply queue when HBA
    supports more than 8 MSI-x vectors.
    
    2. For SAS3.5 controllers, driver should use combined reply queue when HBA
    supports more than 16 MSI-x vectors.
    
    Modified driver code to use combined reply queue for SAS3 controllers when
    HBA supports > 8 MSI-x vectors and for SAS3.5 controllers when HBA supports
    > 16 MSI-x vectors.
    
    Signed-off-by: Chaitra P B <chaitra.basappa@broadcom.com>
    Signed-off-by: Martin K. Petersen <martin.petersen@oracle.com>

commit fa25a8b46e7f4abba6c7acab95c7791b841a9c48
Author: Arnd Bergmann <arnd@arndb.de>
Date:   Fri Feb 16 16:25:53 2018 +0100

    mm: hide a #warning for COMPILE_TEST
    
    commit af27d9403f5b80685b79c88425086edccecaf711 upstream.
    
    We get a warning about some slow configurations in randconfig kernels:
    
      mm/memory.c:83:2: error: #warning Unfortunate NUMA and NUMA Balancing config, growing page-frame for last_cpupid. [-Werror=cpp]
    
    The warning is reasonable by itself, but gets in the way of randconfig
    build testing, so I'm hiding it whenever CONFIG_COMPILE_TEST is set.
    
    The warning was added in 2013 in commit 75980e97dacc ("mm: fold
    page->_last_nid into page->flags where possible").
    
    Signed-off-by: Arnd Bergmann <arnd@arndb.de>
    Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>
    Signed-off-by: Ben Hutchings <ben@decadent.org.uk>

commit 644f2639aef0c7a9a4f59b679375719d720d5461
Merge: 35773c93817c 85ebd164de56
Author: Linus Torvalds <torvalds@linux-foundation.org>
Date:   Sun Jun 17 05:00:24 2018 +0900

    Merge tag 'fbdev-v4.18' of git://github.com/bzolnier/linux
    
    Pull fbdev updates from Bartlomiej Zolnierkiewicz:
     "There is nothing really major here, few small fixes, some cleanups and
      dead drivers removal:
    
       - mark omapfb drivers as orphans in MAINTAINERS file (Tomi Valkeinen)
    
       - add missing module license tags to omap/omapfb driver (Arnd
         Bergmann)
    
       - add missing GPIOLIB dependendy to omap2/omapfb driver (Arnd
         Bergmann)
    
       - convert savagefb, aty128fb & radeonfb drivers to use msleep & co.
         (Jia-Ju Bai)
    
       - allow COMPILE_TEST build for viafb driver (media part was reviewed
         by media subsystem Maintainer)
    
       - remove unused MERAM support from sh_mobile_lcdcfb and shmob-drm
         drivers (drm parts were acked by shmob-drm driver Maintainer)
    
       - remove unused auo_k190xfb drivers
    
       - misc cleanups (Souptick Joarder, Wolfram Sang, Markus Elfring, Andy
         Shevchenko, Colin Ian King)"
    
    * tag 'fbdev-v4.18' of git://github.com/bzolnier/linux: (26 commits)
      fb_omap2: add gpiolib dependency
      video/omap: add module license tags
      MAINTAINERS: make omapfb orphan
      video: fbdev: pxafb: match_string() conversion fixup
      video: fbdev: nvidia: fix spelling mistake: "scaleing" -> "scaling"
      video: fbdev: fix spelling mistake: "frambuffer" -> "framebuffer"
      video: fbdev: pxafb: Convert to use match_string() helper
      video: fbdev: via: allow COMPILE_TEST build
      video: fbdev: remove unused sh_mobile_meram driver
      drm: shmobile: remove unused MERAM support
      video: fbdev: sh_mobile_lcdcfb: remove unused MERAM support
      video: fbdev: remove unused auo_k190xfb drivers
      video: omap: Improve a size determination in omapfb_do_probe()
      video: sm501fb: Improve a size determination in sm501fb_probe()
      video: fbdev-MMP: Improve a size determination in path_init()
      video: fbdev-MMP: Delete an error message for a failed memory allocation in two functions
      video: auo_k190x: Delete an error message for a failed memory allocation in auok190x_common_probe()
      video: sh_mobile_lcdcfb: Delete an error message for a failed memory allocation in two functions
      video: sh_mobile_meram: Delete an error message for a failed memory allocation in sh_mobile_meram_probe()
      video: fbdev: sh_mobile_meram: Drop SUPERH platform dependency
      ...

commit be779f03d563981c65cc7417cc5e0dbbc5b89d30
Merge: d290ef9305eb 00979ce4fcc9
Author: Linus Torvalds <torvalds@linux-foundation.org>
Date:   Wed Jun 13 08:40:34 2018 -0700

    Merge tag 'kbuild-v4.18-2' of git://git.kernel.org/pub/scm/linux/kernel/git/masahiroy/linux-kbuild
    
    Pull more Kbuild updates from Masahiro Yamada:
    
     - fix some bugs introduced by the recent Kconfig syntax extension
    
     - add some symbols about compiler information in Kconfig, such as
       CC_IS_GCC, CC_IS_CLANG, GCC_VERSION, etc.
    
     - test compiler capability for the stack protector in Kconfig, and
       clean-up Makefile
    
     - test compiler capability for GCC-plugins in Kconfig, and clean-up
       Makefile
    
     - allow to enable GCC-plugins for COMPILE_TEST
    
     - test compiler capability for KCOV in Kconfig and correct dependency
    
     - remove auto-detect mode of the GCOV format, which is now more nicely
       handled in Kconfig
    
     - test compiler capability for mprofile-kernel on PowerPC, and clean-up
       Makefile
    
     - misc cleanups
    
    * tag 'kbuild-v4.18-2' of git://git.kernel.org/pub/scm/linux/kernel/git/masahiroy/linux-kbuild:
      linux/linkage.h: replace VMLINUX_SYMBOL_STR() with __stringify()
      kconfig: fix localmodconfig
      sh: remove no-op macro VMLINUX_SYMBOL()
      powerpc/kbuild: move -mprofile-kernel check to Kconfig
      Documentation: kconfig: add recommended way to describe compiler support
      gcc-plugins: disable GCC_PLUGIN_STRUCTLEAK_BYREF_ALL for COMPILE_TEST
      gcc-plugins: allow to enable GCC_PLUGINS for COMPILE_TEST
      gcc-plugins: test plugin support in Kconfig and clean up Makefile
      gcc-plugins: move GCC version check for PowerPC to Kconfig
      kcov: test compiler capability in Kconfig and correct dependency
      gcov: remove CONFIG_GCOV_FORMAT_AUTODETECT
      arm64: move GCC version check for ARCH_SUPPORTS_INT128 to Kconfig
      kconfig: add CC_IS_CLANG and CLANG_VERSION
      kconfig: add CC_IS_GCC and GCC_VERSION
      stack-protector: test compiler capability in Kconfig and drop AUTO mode
      kbuild: fix endless syncconfig in case arch Makefile sets CROSS_COMPILE

commit 883cad5ba8cc2d9b740b4ad0a8a91063c99c75a3
Merge: 8d08c0554244 556c242045f0
Author: Linus Torvalds <torvalds@linux-foundation.org>
Date:   Mon Jun 11 07:20:17 2018 -0700

    Merge tag 'mfd-next-4.18' of git://git.kernel.org/pub/scm/linux/kernel/git/lee/mfd
    
    Pull MFD updates from Lee Jones:
     "New Device Support:
       - Add support for AXP813 ADC to AXP20x
       - Add support for PM8005, PM8998 and PMI8998
    
      New Functionality:
       - Add support for Battery Power Supply to AXP813
       - Add support for SYSCON to SPARD SC27XX SPI
       - Add support for RTC to ChromeOS Embedded-Controller
    
      Fix-ups:
       - Remove unused code; exynos{4,5}-pmu, cros_ec, cros_ec_acpi_gpe
       - Remove duplicate error messages (-ENOMEM, etc); htc-i2cpld,
            janz-cmodio, max8997, rc5t583, sm501, smsc-ece1099, abx500-core,
            si476x-i2c, ti_am335x_tscadc, tps65090, tps6586x, tps65910,
            tps80031, twl6030-irq, viperboard
       - Succinctly use ptr to struct in sizeof(); rc5t583, abx500-core,
            sm501, smsc-ece1099
       - Simplify syntax for NULL ptr checking; abx500-core, sm501
       - No not unnecessarily initialise variables; tps65910, tps65910
       - Reorganise and simplify driver data; omap-usb-tll
       - Move to SPDX license statement; tps68470
       - Probe ADCs via DT; axp20x
       - Use new GPIOD API; arizona-core
       - Constify things; axp20x
       - Reduce code-size (use MACROS, etc); axp20x, omap-usb-host
       - Add DT support/docs; motorola-cpcap
       - Remove VLAs; rave-sp
       - Use devm_* managed resources; cros_ec
       - Interrogate HW for firmware version; rave-sp
       - Provide ACPI support for ChromeOS Embedded-Controller
    
      Bug Fixes:
       - Reorder ordered (enum) device list; tps65218
       - Only accept valid data from the offset; rave-sp
       - Refrain from copying junk from failed SPI read; cros_ec_dev
       - Fix potential memory leaks; pcf50633-core
       - Fix clock initialisation; twl-core
       - Fix build-issue; tps65911
       - Fix off-by-one error; tps65911
       - Fix code ordering issues; intel-lpss
       - Fix COMPILE_TEST related issues; pwm-stm32
       - Fix broken MMC card detection; asic3
       - Fix clocking related issues; intel-lpss-pci"
    
    * tag 'mfd-next-4.18' of git://git.kernel.org/pub/scm/linux/kernel/git/lee/mfd: (84 commits)
      mfd: cros_ec: Remove unused __remove function
      mfd: wm97xx-core: Platform data can be NULL
      mfd: cros_ec_dev: Don't advertise junk features on failure
      mfd: cros_ec: Use devm_kzalloc for private data
      mfd: intel-lpss: Fix Intel Cannon Lake LPSS I2C input clock
      mfd: asic3: Fix broken MMC card detection
      mfd: timberdale: Fix spelling mistake "Uknown" -> "Unknown"
      mfd: omap-usb-host: Use match_string() helper
      mfd: stm32-timers: Fix pwm-stm32 linker issue with COMPILE_TEST
      pwm: stm32: Initialize raw local variables
      mfd: arizona: Update DT doc to support more standard Reset binding
      dt-bindings: mfd: Add bindings for DA9063L
      mfd: intel-lpss: Correct names of RESETS register bits
      mfd: qcom-spmi-pmic: Add support for pm8005, pm8998 and pmi8998
      mfd: intel-lpss: Program REMAP register in PIO mode
      mfd: cros_ec_i2c: Moving the system sleep pm ops to late
      mfd: cros_ec_i2c: Add ACPI module device table
      mfd: cros_ec_dev: Register shutdown function for debugfs
      mfd: cros_ec_dev: Register cros-ec-rtc driver as a subdevice
      mfd: cros_ec: Don't try to grab log when suspended
      ...

commit caa91ba53eb1c92d00abdf5b6c67a310d2b4c2d9
Author: Masahiro Yamada <yamada.masahiro@socionext.com>
Date:   Fri Jun 1 13:32:00 2018 +0900

    gcc-plugins: disable GCC_PLUGIN_STRUCTLEAK_BYREF_ALL for COMPILE_TEST
    
    We have enabled GCC_PLUGINS for COMPILE_TEST, but allmodconfig now
    produces new warnings.
    
      CC [M]  drivers/net/wireless/broadcom/brcm80211/brcmsmac/phy/phy_n.o
    drivers/net/wireless/broadcom/brcm80211/brcmsmac/phy/phy_n.c: In function wlc_phy_workarounds_nphy_rev7:
    drivers/net/wireless/broadcom/brcm80211/brcmsmac/phy/phy_n.c:16563:1: warning: the frame size of 3128 bytes is larger than 2048 bytes [-Wframe-larger-than=]
     }
     ^
    drivers/net/wireless/broadcom/brcm80211/brcmsmac/phy/phy_n.c: In function wlc_phy_workarounds_nphy_rev3:
    drivers/net/wireless/broadcom/brcm80211/brcmsmac/phy/phy_n.c:16905:1: warning: the frame size of 2800 bytes is larger than 2048 bytes [-Wframe-larger-than=]
     }
     ^
    drivers/net/wireless/broadcom/brcm80211/brcmsmac/phy/phy_n.c: In function wlc_phy_cal_txiqlo_nphy:
    drivers/net/wireless/broadcom/brcm80211/brcmsmac/phy/phy_n.c:26033:1: warning: the frame size of 2488 bytes is larger than 2048 bytes [-Wframe-larger-than=]
     }
     ^
    
    It looks like GCC_PLUGIN_STRUCTLEAK_BYREF_ALL is causing this.
    Add "depends on !COMPILE_TEST" to not dirturb the compile test.
    
    Reported-by: Stephen Rothwell <sfr@canb.auug.org.au>
    Suggested-by: Kees Cook <keescook@chromium.org>
    Signed-off-by: Masahiro Yamada <yamada.masahiro@socionext.com>

commit 1658dcee3d43edde9c971b6e88fee64ab9fc67e0
Author: Masahiro Yamada <yamada.masahiro@socionext.com>
Date:   Mon May 28 18:22:07 2018 +0900

    gcc-plugins: allow to enable GCC_PLUGINS for COMPILE_TEST
    
    Now that the compiler's plugin support is checked in Kconfig,
    all{yes,mod}config will not be bothered.
    
    Remove 'depends on !COMPILE_TEST' for GCC_PLUGINS.
    
    'depends on !COMPILE_TEST' for the following three are still kept:
      GCC_PLUGIN_CYC_COMPLEXITY
      GCC_PLUGIN_STRUCTLEAK_VERBOSE
      GCC_PLUGIN_RANDSTRUCT_PERFORMANCE
    
    Kees suggested to do so because the first two are too noisy, and the
    last one would reduce the compile test coverage.  I commented the
    reasons in arch/Kconfig.
    
    Signed-off-by: Masahiro Yamada <yamada.masahiro@socionext.com>
    Acked-by: Kees Cook <keescook@chromium.org>

commit 315bab4e972d9795529b764718d475492db40c0f
Author: Masahiro Yamada <yamada.masahiro@socionext.com>
Date:   Fri Jun 8 09:21:43 2018 +0900

    kbuild: fix endless syncconfig in case arch Makefile sets CROSS_COMPILE
    
    Commit 21c54b774744 ("kconfig: show compiler version text in the top
    comment") was intended to detect the compiler upgrade, but Geert
    reported a breakage on the m68k build.
    
    The compiler upgrade is detected by the change of the environment
    variable, CC_VERSION_TEXT, which contains the first line of the output
    from $(CC) --version.  Currently, this works well when CROSS_COMPILE
    is given via the environment variable or the Make command line.
    
    However, some architectures such as m68k can specify CROSS_COMPILE
    from arch/$(SRCARCH)/Makefile as well.  In this case, "make ARCH=m68k"
    ends up with endless syncconfig loop.
    
      $ make ARCH=m68k defconfig
      *** Default configuration is based on 'multi_defconfig'
      #
      # configuration written to .config
      #
      $ make ARCH=m68k
      scripts/kconfig/conf  --syncconfig Kconfig
      scripts/kconfig/conf  --syncconfig Kconfig
      scripts/kconfig/conf  --syncconfig Kconfig
      scripts/kconfig/conf  --syncconfig Kconfig
    
    Things are happening like this:
    
    Because arch/$(SRCARCH)/Makefile is included after CC_VERSION_TEXT
    is set, it contains the host compiler version in the defconfig phase.
    
    To create or update auto.conf, the following line is triggered:
    
    include/config/%.conf: $(KCONFIG_CONFIG) include/config/auto.conf.cmd
            $(Q)$(MAKE) -f $(srctree)/Makefile syncconfig
    
    This recurses the top Makefile after arch/$(SRCARCH)/Makefile is
    included.  CROSS_COMPILE is set to a m68k toolchain prefix and
    exported to the recursed Make.  Then, syncconfig is invoked with
    the target compiler version in CC_VERSION_TEXT.
    
    The Make will restart because auto.conf and auto.conf.cmd have been
    updated.  At this point, CROSS_COMPILE is reset, so CC_VERSION_TEXT
    is set to the host compiler version again.  Then, syncconfig is
    triggered due to the change of CC_VERSION_TEXT.  This loop continues
    eternally.
    
    To fix this problem, $(CC_VERSION_TEXT) must be evaluated only after
    arch/$(SRCARCH)/Makefile.  Setting it earlier is OK as long as it is
    defined by using the '=' operator instead of ':='.
    
    For the defconfig phase, $(CC_VERSION_TEXT) is evaluated when Kbuild
    descends into scripts/kconfig/, so it contains the target compiler
    version correctly.
    
    include/config/auto.conf.cmd references $(CC_VERSION_TEXT) as well,
    so it must be included after arch/$(SRCARCH)/Makefile.
    
    Fixes: 21c54b774744 ("kconfig: show compiler version text in the top comment")
    Reported-by: Geert Uytterhoeven <geert@linux-m68k.org>
    Signed-off-by: Masahiro Yamada <yamada.masahiro@socionext.com>
    Tested-by: Geert Uytterhoeven <geert@linux-m68k.org>

commit cbdc61ae1fa5d824fcfd59282b040f21144999ab
Author: Vasily Averin <vvs@virtuozzo.com>
Date:   Thu Jun 7 17:10:51 2018 -0700

    lib/mpi: headers cleanup
    
    MPI headers contain definitions for huge number of non-existing
    functions.
    
    Most part of these functions was removed in 2012 by Dmitry Kasatkin
     - 7cf4206a99d1 ("Remove unused code from MPI library")
     - 9e235dcaf4f6 ("Revert "crypto: GnuPG based MPI lib - additional ...")
     - bc95eeadf5c6 ("lib/mpi: removed unused functions")
    however headers wwere not updated properly.
    
    Also I deleted some unused macros.
    
    Link: http://lkml.kernel.org/r/fb2fc1ef-1185-f0a3-d8d0-173d2f97bbaf@virtuozzo.com
    Signed-off-by: Vasily Averin <vvs@virtuozzo.com>
    Reviewed-by: Andrew Morton <akpm@linux-foundation.org>
    Cc: Dmitry Kasatkin <dmitry.kasatkin@huawei.com>
    Signed-off-by: Andrew Morton <akpm@linux-foundation.org>
    Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>

commit 3a3869f1c443383ef8354ffa0e5fb8df65d8b549
Merge: 3036bc45364f 488ad6d3678b
Author: Linus Torvalds <torvalds@linux-foundation.org>
Date:   Thu Jun 7 12:45:58 2018 -0700

    Merge tag 'pci-v4.18-changes' of git://git.kernel.org/pub/scm/linux/kernel/git/helgaas/pci
    
    Pull PCI updates from Bjorn Helgaas:
    
      - unify AER decoding for native and ACPI CPER sources (Alexandru
        Gagniuc)
    
      - add TLP header info to AER tracepoint (Thomas Tai)
    
      - add generic pcie_wait_for_link() interface (Oza Pawandeep)
    
      - handle AER ERR_FATAL by removing and re-enumerating devices, as
        Downstream Port Containment does (Oza Pawandeep)
    
      - factor out common code between AER and DPC recovery (Oza Pawandeep)
    
      - stop triggering DPC for ERR_NONFATAL errors (Oza Pawandeep)
    
      - share ERR_FATAL recovery path between AER and DPC (Oza Pawandeep)
    
      - disable ASPM L1.2 substate if we don't have LTR (Bjorn Helgaas)
    
      - respect platform ownership of LTR (Bjorn Helgaas)
    
      - clear interrupt status in top half to avoid interrupt storm (Oza
        Pawandeep)
    
      - neaten pci=earlydump output (Andy Shevchenko)
    
      - avoid errors when extended config space inaccessible (Gilles Buloz)
    
      - prevent sysfs disable of device while driver attached (Christoph
        Hellwig)
    
      - use core interface to report PCIe link properties in bnx2x, bnxt_en,
        cxgb4, ixgbe (Bjorn Helgaas)
    
      - remove unused pcie_get_minimum_link() (Bjorn Helgaas)
    
      - fix use-before-set error in ibmphp (Dan Carpenter)
    
      - fix pciehp timeouts caused by Command Completed errata (Bjorn
        Helgaas)
    
      - fix refcounting in pnv_php hotplug (Julia Lawall)
    
      - clear pciehp Presence Detect and Data Link Layer Status Changed on
        resume so we don't miss hotplug events (Mika Westerberg)
    
      - only request pciehp control if we support it, so platform can use
        ACPI hotplug otherwise (Mika Westerberg)
    
      - convert SHPC to be builtin only (Mika Westerberg)
    
      - request SHPC control via _OSC if we support it (Mika Westerberg)
    
      - simplify SHPC handoff from firmware (Mika Westerberg)
    
      - fix an SHPC quirk that mistakenly included *all* AMD bridges as well
        as devices from any vendor with device ID 0x7458 (Bjorn Helgaas)
    
      - assign a bus number even to non-native hotplug bridges to leave
        space for acpiphp additions, to fix a common Thunderbolt xHCI
        hot-add failure (Mika Westerberg)
    
      - keep acpiphp from scanning native hotplug bridges, to fix common
        Thunderbolt hot-add failures (Mika Westerberg)
    
      - improve "partially hidden behind bridge" messages from core (Mika
        Westerberg)
    
      - add macros for PCIe Link Control 2 register (Frederick Lawler)
    
      - replace IB/hfi1 custom macros with PCI core versions (Frederick
        Lawler)
    
      - remove dead microblaze and xtensa code (Bjorn Helgaas)
    
      - use dev_printk() when possible in xtensa and mips (Bjorn Helgaas)
    
      - remove unused pcie_port_acpi_setup() and portdrv_acpi.c (Bjorn
        Helgaas)
    
      - add managed interface to get PCI host bridge resources from OF (Jan
        Kiszka)
    
      - add support for unbinding generic PCI host controller (Jan Kiszka)
    
      - fix memory leaks when unbinding generic PCI host controller (Jan
        Kiszka)
    
      - request legacy VGA framebuffer only for VGA devices to avoid false
        device conflicts (Bjorn Helgaas)
    
      - turn on PCI_COMMAND_IO & PCI_COMMAND_MEMORY in pci_enable_device()
        like everybody else, not in pcibios_fixup_bus() (Bjorn Helgaas)
    
      - add generic enable function for simple SR-IOV hardware (Alexander
        Duyck)
    
      - use generic SR-IOV enable for ena, nvme (Alexander Duyck)
    
      - add ACS quirk for Intel 7th & 8th Gen mobile (Alex Williamson)
    
      - add ACS quirk for Intel 300 series (Mika Westerberg)
    
      - enable register clock for Armada 7K/8K (Gregory CLEMENT)
    
      - reduce Keystone "link already up" log level (Fabio Estevam)
    
      - move private DT functions to drivers/pci/ (Rob Herring)
    
      - factor out dwc CONFIG_PCI Kconfig dependencies (Rob Herring)
    
      - add DesignWare support to the endpoint test driver (Gustavo
        Pimentel)
    
      - add DesignWare support for endpoint mode (Gustavo Pimentel)
    
      - use devm_ioremap_resource() instead of devm_ioremap() in dra7xx and
        artpec6 (Gustavo Pimentel)
    
      - fix Qualcomm bitwise NOT issue (Dan Carpenter)
    
      - add Qualcomm runtime PM support (Srinivas Kandagatla)
    
      - fix DesignWare enumeration below bridges (Koen Vandeputte)
    
      - use usleep() instead of mdelay() in endpoint test (Jia-Ju Bai)
    
      - add configfs entries for pci_epf_driver device IDs (Kishon Vijay
        Abraham I)
    
      - clean up pci_endpoint_test driver (Gustavo Pimentel)
    
      - update Layerscape maintainer email addresses (Minghuan Lian)
    
      - add COMPILE_TEST to improve build test coverage (Rob Herring)
    
      - fix Hyper-V bus registration failure caused by domain/serial number
        confusion (Sridhar Pitchai)
    
      - improve Hyper-V refcounting and coding style (Stephen Hemminger)
    
      - avoid potential Hyper-V hang waiting for a response that will never
        come (Dexuan Cui)
    
      - implement Mediatek chained IRQ handling (Honghui Zhang)
    
      - fix vendor ID & class type for Mediatek MT7622 (Honghui Zhang)
    
      - add Mobiveil PCIe host controller driver (Subrahmanya Lingappa)
    
      - add Mobiveil MSI support (Subrahmanya Lingappa)
    
      - clean up clocks, MSI, IRQ mappings in R-Car probe failure paths
        (Marek Vasut)
    
      - poll more frequently (5us vs 5ms) while waiting for R-Car data link
        active (Marek Vasut)
    
      - use generic OF parsing interface in R-Car (Vladimir Zapolskiy)
    
      - add R-Car V3H (R8A77980) "compatible" string (Sergei Shtylyov)
    
      - add R-Car gen3 PHY support (Sergei Shtylyov)
    
      - improve R-Car PHYRDY polling (Sergei Shtylyov)
    
      - clean up R-Car macros (Marek Vasut)
    
      - use runtime PM for R-Car controller clock (Dien Pham)
    
      - update arm64 defconfig for Rockchip (Shawn Lin)
    
      - refactor Rockchip code to facilitate both root port and endpoint
        mode (Shawn Lin)
    
      - add Rockchip endpoint mode driver (Shawn Lin)
    
      - support VMD "membar shadow" feature (Jon Derrick)
    
      - support VMD bus number offsets (Jon Derrick)
    
      - add VMD "no AER source ID" quirk for more device IDs (Jon Derrick)
    
      - remove unnecessary host controller CONFIG_PCIEPORTBUS Kconfig
        selections (Bjorn Helgaas)
    
      - clean up quirks.c organization and whitespace (Bjorn Helgaas)
    
    * tag 'pci-v4.18-changes' of git://git.kernel.org/pub/scm/linux/kernel/git/helgaas/pci: (144 commits)
      PCI/AER: Replace struct pcie_device with pci_dev
      PCI/AER: Remove unused parameters
      PCI: qcom: Include gpio/consumer.h
      PCI: Improve "partially hidden behind bridge" log message
      PCI: Improve pci_scan_bridge() and pci_scan_bridge_extend() doc
      PCI: Move resource distribution for single bridge outside loop
      PCI: Account for all bridges on bus when distributing bus numbers
      ACPI / hotplug / PCI: Drop unnecessary parentheses
      ACPI / hotplug / PCI: Mark stale PCI devices disconnected
      ACPI / hotplug / PCI: Don't scan bridges managed by native hotplug
      PCI: hotplug: Add hotplug_is_native()
      PCI: shpchp: Add shpchp_is_native()
      PCI: shpchp: Fix AMD POGO identification
      PCI: mobiveil: Add MSI support
      PCI: mobiveil: Add Mobiveil PCIe Host Bridge IP driver
      PCI/AER: Decode Error Source Requester ID
      PCI/AER: Remove aer_recover_work_func() forward declaration
      PCI/DPC: Use the generic pcie_do_fatal_recovery() path
      PCI/AER: Pass service type to pcie_do_fatal_recovery()
      PCI/DPC: Disable ERR_NONFATAL handling by DPC
      ...

commit 3036bc45364f98515a2c446d7fac2c34dcfbeff4
Merge: c90fca951e90 48a8bbc7ca49
Author: Linus Torvalds <torvalds@linux-foundation.org>
Date:   Thu Jun 7 12:34:37 2018 -0700

    Merge tag 'media/v4.18-2' of git://git.kernel.org/pub/scm/linux/kernel/git/mchehab/linux-media
    
    Pull media updates from Mauro Carvalho Chehab:
    
     - remove of atomisp driver from staging, as nobody would have time to
       dedicate huge efforts to fix all the problems there. Also, we have a
       feeling that the driver may not even run the way it is.
    
     - move Zoran driver to staging, in order to be either fixed to use VB2
       and the proper media kAPIs or to be removed
    
     - remove videobuf-dvb driver, with is unused for a while
    
     - some V4L2 documentation fixes/improvements
    
     - new sensor drivers: imx258 and ov7251
    
     - a new driver was added to allow using I2C transparent drivers
    
     - several improvements at the ddbridge driver
    
     - several improvements at the ISDB pt1 driver, making it more coherent
       with the DVB framework
    
     - added a new platform driver for MIPI CSI-2 RX: cadence
    
     - now, all media drivers can be compiled on x86 with COMPILE_TEST
    
     - almost all media drivers now build on non-x86 architectures with
       COMPILE_TEST
    
     - lots of other random stuff: cleanups, support for new board models,
       bug fixes, etc
    
    * tag 'media/v4.18-2' of git://git.kernel.org/pub/scm/linux/kernel/git/mchehab/linux-media: (464 commits)
      media: omap2: fix compile-testing with FB_OMAP2=m
      media: media/radio/Kconfig: add back RADIO_ISA
      media: v4l2-ioctl.c: fix missing unlock in __video_do_ioctl()
      media: pxa_camera: ignore -ENOIOCTLCMD from v4l2_subdev_call for s_power
      media: arch: sh: migor: Fix TW9910 PDN gpio
      media: staging: tegra-vde: Reset VDE regardless of memory client resetting failure
      media: marvel-ccic: mmp: select VIDEOBUF2_VMALLOC/DMA_CONTIG
      media: marvel-ccic: allow ccic and mmp drivers to coexist
      media: uvcvideo: Prevent setting unavailable flags
      media: ddbridge: conditionally enable fast TS for stv0910-equipped bridges
      media: dvb-frontends/stv0910: make TS speed configurable
      media: ddbridge/mci: add identifiers to function definition arguments
      media: ddbridge/mci: protect against out-of-bounds array access in stop()
      media: rc: ensure input/lirc device can be opened after register
      media: rc: nuvoton: Keep device enabled during reg init
      media: rc: nuvoton: Keep track of users on CIR enable/disable
      media: rc: nuvoton: Tweak the interrupt enabling dance
      media: uvcvideo: Support realtek's UVC 1.5 device
      media: uvcvideo: Fix driver reference counting
      media: gspca_zc3xx: Enable short exposure times for OV7648
      ...

commit 5db844eee501224f29bd67d6fea1ad4e3dd6cdde
Merge: bf79d7d0997a 7c3b479eece6
Author: Bjorn Helgaas <bhelgaas@google.com>
Date:   Wed Jun 6 16:10:33 2018 -0500

    Merge branch 'lorenzo/pci/host/misc'
    
      - update Layerscape maintainer email addresses (Minghuan Lian)
    
      - add COMPILE_TEST to improve build test coverage (Rob Herring)
    
    * lorenzo/pci/host/misc:
      MAINTAINERS: Update Layerscape PCIe driver maintainers list
      PCI: Improve host drivers compile test coverage
    
    # Conflicts:
    #       drivers/pci/dwc/Kconfig

commit 48a8bbc7ca494709522621929f8407ab823d73fc
Author: Arnd Bergmann <arnd@arndb.de>
Date:   Fri May 25 11:25:12 2018 -0400

    media: omap2: fix compile-testing with FB_OMAP2=m
    
    Compile-testing with FB_OMAP2=m results in a link error:
    
    drivers/media/platform/omap/omap_vout.o: In function `vidioc_streamoff':
    omap_vout.c:(.text+0x1028): undefined reference to `omap_dispc_unregister_isr'
    drivers/media/platform/omap/omap_vout.o: In function `omap_vout_release':
    omap_vout.c:(.text+0x1330): undefined reference to `omap_dispc_unregister_isr'
    drivers/media/platform/omap/omap_vout.o: In function `vidioc_streamon':
    omap_vout.c:(.text+0x2dd4): undefined reference to `omap_dispc_register_isr'
    drivers/media/platform/omap/omap_vout.o: In function `omap_vout_remove':
    
    In order to enable compile-testing but still keep the correct dependency,
    this changes the Kconfig logic so we only allow CONFIG_COMPILE_TEST
    building when FB_OMAP is completely disabled, or have use the old
    dependency on FB_OMAP to ensure VIDEO_OMAP2_VOUT is also a loadable
    module when FB_OMAP2 is.
    
    Fixes: d8555fd2f452 ("media: omap2: allow building it with COMPILE_TEST && DRM_OMAP")
    
    Signed-off-by: Arnd Bergmann <arnd@arndb.de>
    Signed-off-by: Hans Verkuil <hans.verkuil@cisco.com>
    Signed-off-by: Mauro Carvalho Chehab <mchehab+samsung@kernel.org>

commit 0ad39cb3d70fb4324d127aeceee7f63e3f71605c
Merge: 8715ee75fe6f 2ae89c7a82ea
Author: Linus Torvalds <torvalds@linux-foundation.org>
Date:   Wed Jun 6 11:31:45 2018 -0700

    Merge tag 'kconfig-v4.18' of git://git.kernel.org/pub/scm/linux/kernel/git/masahiroy/linux-kbuild
    
    Pull Kconfig updates from Masahiro Yamada:
     "Kconfig now supports new functionality to perform textual
      substitution. It has been a while since Linus suggested to move
      compiler option tests from makefiles to Kconfig. Finally, here it is.
    
      The implementation has been generalized into a Make-like macro
      language.
    
      Some built-in functions such as 'shell' are provided. Variables and
      user-defined functions are also supported so that 'cc-option',
      'ld-option', etc. are implemented as macros.
    
      Summary:
    
       - refactor package checks for building {m,n,q,g}conf
    
       - remove unused/unmaintained localization support
    
       - remove Kbuild cache
    
       - drop CONFIG_CROSS_COMPILE support
    
       - replace 'option env=' with direct variable expansion
    
       - add built-in functions such as 'shell'
    
       - support variables and user-defined functions
    
       - add helper macros as as 'cc-option'
    
       - add unit tests and a document of the new macro language
    
       - add 'testconfig' to help
    
       - fix warnings from GCC 8.1"
    
    * tag 'kconfig-v4.18' of git://git.kernel.org/pub/scm/linux/kernel/git/masahiroy/linux-kbuild: (30 commits)
      kconfig: Avoid format overflow warning from GCC 8.1
      kbuild: Move last word of nconfig help to the previous line
      kconfig: Add testconfig into make help output
      kconfig: add basic helper macros to scripts/Kconfig.include
      kconfig: show compiler version text in the top comment
      kconfig: test: add Kconfig macro language tests
      Documentation: kconfig: document a new Kconfig macro language
      kconfig: error out if a recursive variable references itself
      kconfig: add 'filename' and 'lineno' built-in variables
      kconfig: add 'info', 'warning-if', and 'error-if' built-in functions
      kconfig: expand lefthand side of assignment statement
      kconfig: support append assignment operator
      kconfig: support simply expanded variable
      kconfig: support user-defined function and recursively expanded variable
      kconfig: begin PARAM state only when seeing a command keyword
      kconfig: replace $(UNAME_RELEASE) with function call
      kconfig: add 'shell' built-in function
      kconfig: add built-in function support
      kconfig: make default prompt of mainmenu less specific
      kconfig: remove sym_expand_string_value()
      ...

commit 19ed70c0b329497bdff48e9c3d5dbadcecf1ea02
Author: Geert Uytterhoeven <geert@linux-m68k.org>
Date:   Tue Apr 17 19:49:11 2018 +0200

    mailbox: Remove depends on HAS_DMA in case of platform dependency
    
    Remove dependencies on HAS_DMA where a Kconfig symbol depends on another
    symbol that implies HAS_DMA, and, optionally, on "|| COMPILE_TEST".
    In most cases this other symbol is an architecture or platform specific
    symbol, or PCI.
    
    Generic symbols and drivers without platform dependencies keep their
    dependencies on HAS_DMA, to prevent compiling subsystems or drivers that
    cannot work anyway.
    
    This simplifies the dependencies, and allows to improve compile-testing.
    
    Signed-off-by: Geert Uytterhoeven <geert@linux-m68k.org>
    Reviewed-by: Mark Brown <broonie@kernel.org>
    Acked-by: Robin Murphy <robin.murphy@arm.com>
    Signed-off-by: Jassi Brar <jaswinder.singh@linaro.org>

commit d968e5041fefbc7c4d545cabbc692b11cc49050d
Author: Arnd Bergmann <arnd@arndb.de>
Date:   Fri May 25 18:04:54 2018 +0200

    pwm: stm32: Enforce dependency on CONFIG_MFD_STM32_TIMERS
    
    When compile-testing the PWM driver without also enabling the
    stm32_timers MFD, we run into a link error:
    
            drivers/pwm/pwm-stm32.o: In function `stm32_pwm_raw_capture.isra.6':
            pwm-stm32.c:(.text+0xcb0): undefined reference to `stm32_timers_dma_burst_read'
    
    We don't need the '|| COMPILE_TEST' here, since stm32_timers itself
    can be built with CONFIG_COMPILE_TEST on all architectures, so we do
    get the coverage through allmodconfig and randconfig builds even
    when we make it a hard dependency.
    
    Fixes: 7edf7369205b ("pwm: Add driver for STM32 plaftorm")
    Signed-off-by: Arnd Bergmann <arnd@arndb.de>
    Signed-off-by: Thierry Reding <thierry.reding@gmail.com>

commit 8d7ab3a0d72d3c98bcd12ff553c5ead0b5e32c31
Author: Hans Verkuil <hverkuil@xs4all.nl>
Date:   Mon Jun 4 08:47:53 2018 -0400

    media: media/radio/Kconfig: add back RADIO_ISA
    
    Patch 258c524bdaab inadvertently removed the 'select RADIO_ISA' line for
    the RADIO_RTRACK.
    
    Fixes: 258c524bdaab ("radio: allow building ISA drivers with COMPILE_TEST")
    
    Reported-by: Randy Dunlap <rdunlap@infradead.org>
    Signed-off-by: Hans Verkuil <hans.verkuil@cisco.com>
    Signed-off-by: Mauro Carvalho Chehab <mchehab+samsung@kernel.org>

commit d95c9760d9c8e046b09b54a3bb6dd0c9aa7a0eff
Author: Fabrice Gasnier <fabrice.gasnier@st.com>
Date:   Fri May 18 17:24:03 2018 +0200

    mfd: stm32-timers: Fix pwm-stm32 linker issue with COMPILE_TEST
    
    This is seen when COMPILE_TEST=y and MFD_STM32_TIMERS=n.
    drivers/pwm/pwm-stm32.o: In function 'stm32_pwm_raw_capture':
    pwm-stm32.c:... undefined reference to 'stm32_timers_dma_burst_read'
    Fixes: 0c6609805b63 ("mfd: stm32-timers: Add support for DMAs")
    
    Signed-off-by: Fabrice Gasnier <fabrice.gasnier@st.com>
    Reported-by: Randy Dunlap <rdunlap@infradead.org>
    Tested-by: Randy Dunlap <rdunlap@infradead.org>
    
    Signed-off-by: Lee Jones <lee.jones@linaro.org>

commit a3b51be3cdac4844b2d8bb7c4dad95e191a05697
Author: Fabrice Gasnier <fabrice.gasnier@st.com>
Date:   Fri May 18 17:24:04 2018 +0200

    pwm: stm32: Initialize raw local variables
    
    This removes build warning when COMPILE_TEST=y and MFD_STM32_TIMERS=n
    in drivers/pwm/pwm-stm32.c. In function 'stm32_pwm_capture' 'raw_prd' and
    'raw_dty' may be used uninitialized in this function
    [-Wmaybe-uninitialized]
    
    Signed-off-by: Fabrice Gasnier <fabrice.gasnier@st.com>
    Acked-by: Thierry Reding <thierry.reding@gmail.com>
    Tested-by: Randy Dunlap <rdunlap@infradead.org>
    Signed-off-by: Lee Jones <lee.jones@linaro.org>

commit af3901cbbd3de182aafb8ee553c825c0074df6a2
Author: Nicholas Piggin <npiggin@gmail.com>
Date:   Wed May 30 22:19:20 2018 +1000

    powerpc/kbuild: Remove CROSS32 defines from top level powerpc Makefile
    
    Switch VDSO32 build over to use CROSS32_COMPILE directly, and have
    it pass in -m32 after the standard c_flags. This allows endianness
    overrides to be removed and the endian and bitness flags moved into
    standard flags variables.
    
    Signed-off-by: Nicholas Piggin <npiggin@gmail.com>
    Signed-off-by: Michael Ellerman <mpe@ellerman.id.au>

commit e2b3e493784fe07eac385611acbaaf7bff86c496
Author: Arnd Bergmann <arnd@arndb.de>
Date:   Wed May 30 23:51:54 2018 +0200

    net: ti: cpsw: include gpio/consumer.h
    
    On platforms that don't always enable CONFIG_GPIOLIB, we run into
    a build failure:
    
    drivers/net/ethernet/ti/cpsw.c: In function 'cpsw_probe':
    drivers/net/ethernet/ti/cpsw.c:3006:9: error: implicit declaration of function 'devm_gpiod_get_array_optional' [-Werror=implicit-function-declaration]
      mode = devm_gpiod_get_array_optional(&pdev->dev, "mode", GPIOD_OUT_LOW);
             ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    drivers/net/ethernet/ti/cpsw.c:3006:59: error: 'GPIOD_OUT_LOW' undeclared (first use in this function); did you mean 'GPIOF_INIT_LOW'?
      mode = devm_gpiod_get_array_optional(&pdev->dev, "mode", GPIOD_OUT_LOW);
    
    Since we cannot rely on this to be visible from gpio.h, we have to include
    gpio/consumer.h directly.
    
    Fixes: 2652113ff043 ("net: ethernet: ti: Allow most drivers with COMPILE_TEST")
    Signed-off-by: Arnd Bergmann <arnd@arndb.de>
    Signed-off-by: David S. Miller <davem@davemloft.net>

commit 37c9102f216c2ecd4296de1027fbfc4fa7d73877
Author: Arnd Bergmann <arnd@arndb.de>
Date:   Mon May 28 17:50:20 2018 +0200

    net: davinci: fix building davinci mdio code without CONFIG_OF
    
    Test-building this driver on targets without CONFIG_OF revealed a build
    failure:
    
    drivers/net/ethernet/ti/davinci_mdio.c: In function 'davinci_mdio_probe':
    drivers/net/ethernet/ti/davinci_mdio.c:380:9: error: implicit declaration of function 'davinci_mdio_probe_dt'; did you mean 'davinci_mdio_probe'? [-Werror=implicit-function-declaration]
    
    This adjusts the #ifdef logic in the driver to make it build in
    all configurations.
    
    Fixes: 2652113ff043 ("net: ethernet: ti: Allow most drivers with COMPILE_TEST")
    Signed-off-by: Arnd Bergmann <arnd@arndb.de>
    Acked-by: Sekhar Nori <nsekhar@ti.com>
    Signed-off-by: David S. Miller <davem@davemloft.net>

commit 3ded9f2b35f02ca00523c79f88f6cf5050622384
Author: Arnd Bergmann <arnd@arndb.de>
Date:   Mon May 28 17:49:46 2018 +0200

    net: ethernet: freescale: fix false-positive string overflow warning
    
    While compile-testing on arm64 with gcc-8.1, I ran into a build diagnostic:
    
    drivers/net/ethernet/freescale/fec_main.c: In function 'fec_probe':
    drivers/net/ethernet/freescale/fec_main.c:3517:25: error: '%d' directive writing between 1 and 10 bytes into a region of size 5 [-Werror=format-overflow=]
       sprintf(irq_name, "int%d", i);
                             ^~
    drivers/net/ethernet/freescale/fec_main.c:3517:21: note: directive argument in the range [0, 2147483646]
       sprintf(irq_name, "int%d", i);
                         ^~~~~~~
    drivers/net/ethernet/freescale/fec_main.c:3517:3: note: 'sprintf' output between 5 and 14 bytes into a destination of size 8
       sprintf(irq_name, "int%d", i);
       ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    
    It appears this has never shown on ppc32 or arm32 for an unknown reason, but
    now gcc fails to identify that the 'irq_cnt' loop index has an upper bound
    of 3, and instead uses a bogus range.
    
    To work around the warning, this changes the sprintf to snprintf with the
    correct buffer length.
    
    Fixes: 78cc6e7ef957 ("net: ethernet: freescale: Allow FEC with COMPILE_TEST")
    Signed-off-by: Arnd Bergmann <arnd@arndb.de>
    Acked-by: Fugang Duan <fugang.duan@nxp.com>
    Signed-off-by: David S. Miller <davem@davemloft.net>

commit 4cff79e933265e2fb9f00cefefaf5af85d9147f7
Author: Geert Uytterhoeven <geert@linux-m68k.org>
Date:   Thu May 17 13:18:12 2018 -0400

    media: Remove depends on HAS_DMA in case of platform dependency
    
    Remove dependencies on HAS_DMA where a Kconfig symbol depends on another
    symbol that implies HAS_DMA, and, optionally, on "|| COMPILE_TEST".
    In most cases this other symbol is an architecture or platform specific
    symbol, or PCI.
    
    Generic symbols and drivers without platform dependencies keep their
    dependencies on HAS_DMA, to prevent compiling subsystems or drivers that
    cannot work anyway.
    
    This simplifies the dependencies, and allows to improve compile-testing.
    
    Note:
      - The various VIDEOBUF*DMA* symbols had to loose their dependencies on
        HAS_DMA, as they are selected by several individual drivers.
    
    Signed-off-by: Geert Uytterhoeven <geert@linux-m68k.org>
    Reviewed-by: Mark Brown <broonie@kernel.org>
    Acked-by: Robin Murphy <robin.murphy@arm.com>
    Signed-off-by: Hans Verkuil <hans.verkuil@cisco.com>
    Signed-off-by: Mauro Carvalho Chehab <mchehab+samsung@kernel.org>

commit 21c54b774744719c386fbdc829b0e7759edb8ece
Author: Masahiro Yamada <yamada.masahiro@socionext.com>
Date:   Mon May 28 18:21:58 2018 +0900

    kconfig: show compiler version text in the top comment
    
    The kernel configuration phase is now tightly coupled with the compiler
    in use.  It will be nice to show the compiler information in Kconfig.
    
    The compiler information will be displayed like this:
    
      $ make ARCH=arm64 CROSS_COMPILE=aarch64-linux-gnu- config
      scripts/kconfig/conf  --oldaskconfig Kconfig
      *
      * Linux/arm64 4.16.0-rc1 Kernel Configuration
      *
      *
      * Compiler: aarch64-linux-gnu-gcc (Linaro GCC 7.2-2017.11) 7.2.1 20171011
      *
      *
      * General setup
      *
      Compile also drivers which will not load (COMPILE_TEST) [N/y/?]
    
    If you use GUI methods such as menuconfig, it will be displayed in the
    top menu.
    
    This is simply implemented by using the 'comment' statement.  So, it
    will be saved into the .config file as well.
    
    This commit has a very important meaning.  If the compiler is upgraded,
    Kconfig must be re-run since different compilers have different sets
    of supported options.
    
    All referenced environments are written to include/config/auto.conf.cmd
    so that any environment change triggers syncconfig, and prompt the user
    to input new values if needed.
    
    With this commit, something like follows will be added to
    include/config/auto.conf.cmd
    
      ifneq "$(CC_VERSION_TEXT)" "aarch64-linux-gnu-gcc (Linaro GCC 7.2-2017.11) 7.2.1 20171011"
      include/config/auto.conf: FORCE
      endif
    
    Signed-off-by: Masahiro Yamada <yamada.masahiro@socionext.com>
    Reviewed-by: Kees Cook <keescook@chromium.org>

commit f1089c92da791034af73478159626007cba7f092
Author: Masahiro Yamada <yamada.masahiro@socionext.com>
Date:   Mon May 28 18:21:39 2018 +0900

    kbuild: remove CONFIG_CROSS_COMPILE support
    
    Kbuild provides a couple of ways to specify CROSS_COMPILE:
    
    [1] Command line
    [2] Environment
    [3] arch/*/Makefile (only some architectures)
    [4] CONFIG_CROSS_COMPILE
    
    [4] is problematic for the compiler capability tests in Kconfig.
    CONFIG_CROSS_COMPILE allows users to change the compiler prefix from
    'make menuconfig', etc.  It means, the compiler options would have
    to be all re-calculated everytime CONFIG_CROSS_COMPILE is changed.
    
    To avoid complexity and performance issues, I'd like to evaluate
    the shell commands statically, i.e. only parsing Kconfig files.
    
    I guess the majority is [1] or [2].  Currently, there are only
    5 defconfig files that specify CONFIG_CROSS_COMPILE.
      arch/arm/configs/lpc18xx_defconfig
      arch/hexagon/configs/comet_defconfig
      arch/nds32/configs/defconfig
      arch/openrisc/configs/or1ksim_defconfig
      arch/openrisc/configs/simple_smp_defconfig
    
    Signed-off-by: Masahiro Yamada <yamada.masahiro@socionext.com>
    Reviewed-by: Kees Cook <keescook@chromium.org>

commit 5ab99d48dae22ed7662d8c52adfff49a64495cc1
Author: Arnd Bergmann <arnd@arndb.de>
Date:   Fri May 25 18:09:13 2018 +0200

    ARM: stm32: Don't select DMA unconditionally on STM32MP157C
    
    The patch that enabled these had no useful changelog that explains
    why it is done, and it causes a build warning:
    
    WARNING: unmet direct dependencies detected for STM32_DMA
      Depends on [n]: DMADEVICES [=n] && (ARCH_STM32 [=y] || COMPILE_TEST [=y])
      Selected by [y]:
      - MACH_STM32MP157 [=y] && ARCH_STM32 [=y] && ARCH_MULTI_V7 [=y]
    
    Generally, platforms should not select arbitrary drivers, so let's
    just revert that change.
    
    Fixes: de6037fa207f ("ARM: stm32: Select DMA, DMAMUX and MDMA support on STM32MP157C")
    Signed-off-by: Arnd Bergmann <arnd@arndb.de>
    Signed-off-by: Olof Johansson <olof@lixom.net>

commit cab673583d9657d070f18fe41492099660fc8d6b
Author: Guenter Roeck <groeck@chromium.org>
Date:   Wed Apr 18 16:28:47 2018 -0700

    soc: Unconditionally include qcom Makefile
    
    Incoming Qualcomm changes for GENI, i2c [1], and cmd-db [2] are enabled
    with COMPILE_TEST in drivers/soc/qcom. For this to work, the Makefile
    in that directory has to be included unconditionally, rather than only
    if ARCH_QCOM is enabled.
    
    Example of the errors seen on allmodconfig with the GENI, i2c, and
    cmd-db patches applied:
    
    Kernel: arch/x86/boot/bzImage is ready  (#1)
    ERROR: "geni_se_select_mode" [drivers/tty/serial/qcom_geni_serial.ko] undefined!
    ERROR: "geni_se_init" [drivers/tty/serial/qcom_geni_serial.ko] undefined!
    ERROR: "geni_se_config_packing" [drivers/tty/serial/qcom_geni_serial.ko] undefined!
    ERROR: "geni_se_resources_on" [drivers/tty/serial/qcom_geni_serial.ko] undefined!
    ERROR: "geni_se_resources_off" [drivers/tty/serial/qcom_geni_serial.ko] undefined!
    ERROR: "geni_se_tx_dma_unprep" [drivers/i2c/busses/i2c-qcom-geni.ko] undefined!
    ERROR: "geni_se_tx_dma_prep" [drivers/i2c/busses/i2c-qcom-geni.ko] undefined!
    ERROR: "geni_se_rx_dma_unprep" [drivers/i2c/busses/i2c-qcom-geni.ko] undefined!
    ERROR: "geni_se_rx_dma_prep" [drivers/i2c/busses/i2c-qcom-geni.ko] undefined!
    ERROR: "geni_se_select_mode" [drivers/i2c/busses/i2c-qcom-geni.ko] undefined!
    ERROR: "geni_se_config_packing" [drivers/i2c/busses/i2c-qcom-geni.ko] undefined!
    ERROR: "geni_se_init" [drivers/i2c/busses/i2c-qcom-geni.ko] undefined!
    ERROR: "geni_se_resources_off" [drivers/i2c/busses/i2c-qcom-geni.ko] undefined!
    ERROR: "geni_se_resources_on" [drivers/i2c/busses/i2c-qcom-geni.ko] undefined!
    make[1]: *** [scripts/Makefile.modpost:92: __modpost] Error 1
    make: *** [Makefile:1237: modules] Error 2
    
    [1] https://patchwork.ozlabs.org/cover/893437/
    [2] https://lkml.org/lkml/2018/4/10/714
    
    Signed-off-by: Guenter Roeck <groeck@chromium.org>
    Signed-off-by: Evan Green <evgreen@chromium.org>
    Signed-off-by: Andy Gross <andy.gross@linaro.org>

commit 500413c5097d981b1b6e639bf2183abc1db6c24a
Author: Arnd Bergmann <arnd@arndb.de>
Date:   Fri May 25 18:02:32 2018 +0200

    ASoC: omap: fix compile-test building
    
    The newly introduced driver causes a harmless Kconfig warning when
    compile-testing random configurations:
    
    WARNING: unmet direct dependencies detected for SND_SDMA_SOC
      Depends on [n]: SOUND [=y] && !UML && SND [=y] && SND_SOC [=y] && DMA_OMAP [=n]
      Selected by [y]:
      - SND_OMAP_SOC [=y] && SOUND [=y] && !UML && SND [=y] && SND_SOC [=y] && (ARCH_OMAP [=y] && DMA_OMAP [=n] || ARM [=y] && COMPILE_TEST [=y])
    
    By simply allow build testing without DMA_OMAP, we can shut up that warning.
    
    Fixes: dde637f2daf1 ("ASoC: omap: Introduce the generic_dmaengine_pcm based sdma-pcm")
    Signed-off-by: Arnd Bergmann <arnd@arndb.de>
    Signed-off-by: Mark Brown <broonie@kernel.org>

commit 0252f73334f9ef68868e4684200bea3565a4fcee
Author: Mike Marciniszyn <mike.marciniszyn@intel.com>
Date:   Fri May 18 17:07:01 2018 -0700

    IB/qib: Fix DMA api warning with debug kernel
    
    The following error occurs in a debug build when running MPI PSM:
    
    [  307.415911] WARNING: CPU: 4 PID: 23867 at lib/dma-debug.c:1158
    check_unmap+0x4ee/0xa20
    [  307.455661] ib_qib 0000:05:00.0: DMA-API: device driver failed to check map
    error[device address=0x00000000df82b000] [size=4096 bytes] [mapped as page]
    [  307.517494] Modules linked in:
    [  307.531584]  ib_isert iscsi_target_mod ib_srpt target_core_mod rpcrdma
    sunrpc ib_srp scsi_transport_srp scsi_tgt ib_iser libiscsi ib_ipoib
    scsi_transport_iscsi rdma_ucm ib_ucm ib_uverbs ib_umad rdma_cm ib_cm iw_cm
    ib_qib intel_powerclamp coretemp rdmavt intel_rapl iosf_mbi kvm_intel kvm
    irqbypass crc32_pclmul ghash_clmulni_intel ipmi_ssif ib_core aesni_intel sg
    ipmi_si lrw gf128mul dca glue_helper ipmi_devintf iTCO_wdt gpio_ich hpwdt
    iTCO_vendor_support ablk_helper hpilo acpi_power_meter cryptd ipmi_msghandler
    ie31200_edac shpchp pcc_cpufreq lpc_ich pcspkr ip_tables xfs libcrc32c sd_mod
    crc_t10dif crct10dif_generic mgag200 i2c_algo_bit drm_kms_helper syscopyarea
    sysfillrect sysimgblt fb_sys_fops ttm ahci crct10dif_pclmul crct10dif_common
    drm crc32c_intel libahci tg3 libata serio_raw ptp i2c_core
    [  307.846113]  pps_core dm_mirror dm_region_hash dm_log dm_mod
    [  307.866505] CPU: 4 PID: 23867 Comm: mpitests-IMB-MP Kdump: loaded Not
    tainted 3.10.0-862.el7.x86_64.debug #1
    [  307.911178] Hardware name: HP ProLiant DL320e Gen8, BIOS J05 11/09/2013
    [  307.944206] Call Trace:
    [  307.956973]  [<ffffffffbd9e915b>] dump_stack+0x19/0x1b
    [  307.982201]  [<ffffffffbd2a2f58>] __warn+0xd8/0x100
    [  308.005999]  [<ffffffffbd2a2fdf>] warn_slowpath_fmt+0x5f/0x80
    [  308.034260]  [<ffffffffbd5f667e>] check_unmap+0x4ee/0xa20
    [  308.060801]  [<ffffffffbd41acaa>] ? page_add_file_rmap+0x2a/0x1d0
    [  308.090689]  [<ffffffffbd5f6c4d>] debug_dma_unmap_page+0x9d/0xb0
    [  308.120155]  [<ffffffffbd4082e0>] ? might_fault+0xa0/0xb0
    [  308.146656]  [<ffffffffc07761a5>] qib_tid_free.isra.14+0x215/0x2a0 [ib_qib]
    [  308.180739]  [<ffffffffc0776bf4>] qib_write+0x894/0x1280 [ib_qib]
    [  308.210733]  [<ffffffffbd540b00>] ? __inode_security_revalidate+0x70/0x80
    [  308.244837]  [<ffffffffbd53c2b7>] ? security_file_permission+0x27/0xb0
    [  308.266025] qib_ib0.8006: multicast join failed for
    ff12:401b:8006:0000:0000:0000:ffff:ffff, status -22
    [  308.323421]  [<ffffffffbd46f5d3>] vfs_write+0xc3/0x1f0
    [  308.347077]  [<ffffffffbd492a5c>] ? fget_light+0xfc/0x510
    [  308.372533]  [<ffffffffbd47045a>] SyS_write+0x8a/0x100
    [  308.396456]  [<ffffffffbd9ff355>] system_call_fastpath+0x1c/0x21
    
    The code calls a qib_map_page() which has never correctly tested for a
    mapping error.
    
    Fix by testing for pci_dma_mapping_error() in all cases and properly
    handling the failure in the caller.
    
    Additionally, streamline qib_map_page() arguments to satisfy just
    the single caller.
    
    Cc: <stable@vger.kernel.org>
    Reviewed-by: Alex Estrin <alex.estrin@intel.com>
    Tested-by: Don Dutile <ddutile@redhat.com>
    Reviewed-by: Don Dutile <ddutile@redhat.com>
    Signed-off-by: Mike Marciniszyn <mike.marciniszyn@intel.com>
    Signed-off-by: Dennis Dalessandro <dennis.dalessandro@intel.com>
    Signed-off-by: Doug Ledford <dledford@redhat.com>

commit a890908a85122c57d76cd27f522982c89329394d
Author: Arnd Bergmann <arnd@arndb.de>
Date:   Fri Feb 16 16:26:57 2018 +0100

    radeon: hide pointless #warning when compile testing
    
    [ Upstream commit c02216acf4177c4411d33735c81cad687790fa59 ]
    
    In randconfig testing, we sometimes get this warning:
    
    drivers/gpu/drm/radeon/radeon_object.c: In function 'radeon_bo_create':
    drivers/gpu/drm/radeon/radeon_object.c:242:2: error: #warning Please enable CONFIG_MTRR and CONFIG_X86_PAT for better performance thanks to write-combining [-Werror=cpp]
     #warning Please enable CONFIG_MTRR and CONFIG_X86_PAT for better performance \
    
    This is rather annoying since almost all other code produces no build-time
    output unless we have found a real bug. We already fixed this in the
    amdgpu driver in commit 31bb90f1cd08 ("drm/amdgpu: shut up #warning for
    compile testing") by adding a CONFIG_COMPILE_TEST check last year and
    agreed to do the same here, but both Michel and I then forgot about it
    until I came across the issue again now.
    
    For stable kernels, as this is one of very few remaining randconfig
    warnings in 4.14.
    
    Cc: stable@vger.kernel.org
    Link: https://patchwork.kernel.org/patch/9550009/
    Signed-off-by: Arnd Bergmann <arnd@arndb.de>
    Signed-off-by: Michel Dnzer <michel.daenzer@amd.com>
    Signed-off-by: Alex Deucher <alexander.deucher@amd.com>
    Signed-off-by: Sasha Levin <alexander.levin@microsoft.com>

commit eedfdeb536f8529cab193a794bc84aa1f94d294f
Author: Robert Jarzmik <robert.jarzmik@free.fr>
Date:   Mon Jun 5 13:59:15 2017 +0200

    tags: honor COMPILED_SOURCE with apart output directory
    
    [ Upstream commit cbf52a3e6a8a92beec6e0c70abf4111cd8f8faf7 ]
    
    When the kernel is compiled with an "O=" argument, the object files are
    not in the source tree, but in the build tree.
    
    This patch fixes O= build by looking for object files in the build tree.
    
    Fixes: 923e02ecf3f8 ("scripts/tags.sh: Support compiled source")
    Signed-off-by: Robert Jarzmik <robert.jarzmik@free.fr>
    Signed-off-by: Masahiro Yamada <yamada.masahiro@socionext.com>
    Signed-off-by: Sasha Levin <alexander.levin@microsoft.com>

commit e3bb946cd922b773fdc03252aefbf2472d1d530c
Merge: 6f6e434aa267 c79c3850440c
Author: David S. Miller <davem@davemloft.net>
Date:   Mon May 21 16:17:11 2018 -0400

    Merge branch 'TI-Ethernet-driver-warnings-fixes'
    
    Florian Fainelli says:
    
    ====================
    TI Ethernet driver warnings fixes
    
    This patch series attempts to fix properly the warnings observed with turning
    on COMPILE_TEST and TI Ethernet drivers on 64-bit hosts.
    
    Since I don't have any of this hardware, please review carefully for possible
    breakage!
    ====================
    
    Signed-off-by: David S. Miller <davem@davemloft.net>

commit 8a1ece26d370e38817da5232195896b727dba3cd
Author: Chunyan Zhang <chunyan.zhang@spreadtrum.com>
Date:   Mon May 7 17:04:47 2018 +0800

    clocksource/drivers/sprd: Fix Kconfig dependency
    
    SPRD arch doesn't select SPRD_TIMER, so this config would not
    appear even if ARCH_SPRD is set but COMPILE_TEST not.
    
    Fix the dependency of this config with SPRD arch, and set a
    default value for it, also leave other choices for EXPERT.
    
    Signed-off-by: Chunyan Zhang <chunyan.zhang@spreadtrum.com>
    Signed-off-by: Daniel Lezcano <daniel.lezcano@linaro.org>

commit 538e2de104cfb4ef1acb35af42427bff42adbe4d
Merge: 33fa382324eb 3c0596f8bec0
Author: David S. Miller <davem@davemloft.net>
Date:   Thu May 17 17:11:07 2018 -0400

    Merge branch 'net-Allow-more-drivers-with-COMPILE_TEST'
    
    Florian Fainelli says:
    
    ====================
    net: Allow more drivers with COMPILE_TEST
    
    This patch series includes more drivers to be build tested with COMPILE_TEST
    enabled. This helps cover some of the issues I just ran into with missing
    a driver *sigh*.
    
    Chanves in v3:
    
    - drop the TI Keystone NETCP driver from the COMPILE_TEST additions
    
    Changes in v2:
    
    - allow FEC to build outside of CONFIG_ARM/ARM64 by defining a layout of
      registers, this is not meant to run, so this is not a real issue if we
      are not matching the correct register layout
    ====================
    
    Signed-off-by: David S. Miller <davem@davemloft.net>

commit 3c0596f8bec016210e9f470411f70a1a8ea41bcd
Author: Florian Fainelli <f.fainelli@gmail.com>
Date:   Thu May 17 13:07:45 2018 -0700

    net: phy: Allow MDIO_MOXART and MDIO_SUN4I with COMPILE_TEST
    
    Those drivers build just fine with COMPILE_TEST, so make that possible.
    
    Signed-off-by: Florian Fainelli <f.fainelli@gmail.com>
    Signed-off-by: David S. Miller <davem@davemloft.net>

commit 78cc6e7ef957037d7562e56d4463cf26da4e9e0e
Author: Florian Fainelli <f.fainelli@gmail.com>
Date:   Thu May 17 13:07:44 2018 -0700

    net: ethernet: freescale: Allow FEC with COMPILE_TEST
    
    The Freescale FEC driver builds fine with COMPILE_TEST, so make that
    possible.
    
    Signed-off-by: Florian Fainelli <f.fainelli@gmail.com>
    Signed-off-by: David S. Miller <davem@davemloft.net>

commit 2652113ff043ca2ce1cb3be529b5ca9270c421d4
Author: Florian Fainelli <f.fainelli@gmail.com>
Date:   Thu May 17 13:07:43 2018 -0700

    net: ethernet: ti: Allow most drivers with COMPILE_TEST
    
    Most of the TI drivers build just fine with COMPILE_TEST, cpmac (AR7) is
    the exception because it uses a header file from
    arch/mips/include/asm/mach-ar7/ar7.h and keystone netcp which requires
    help from drivers/soc/ti/ for queue management helpers.
    
    Signed-off-by: Florian Fainelli <f.fainelli@gmail.com>
    Signed-off-by: David S. Miller <davem@davemloft.net>

commit 37c3ec2d810f87eac73822f76b30391a83bded19
Author: Jeremy Linton <jeremy.linton@arm.com>
Date:   Fri May 11 18:58:07 2018 -0500

    arm64: topology: divorce MC scheduling domain from core_siblings
    
    Now that we have an accurate view of the physical topology
    we need to represent it correctly to the scheduler. Generally MC
    should equal the LLC in the system, but there are a number of
    special cases that need to be dealt with.
    
    In the case of NUMA in socket, we need to assure that the sched
    domain we build for the MC layer isn't larger than the DIE above it.
    Similarly for LLC's that might exist in cross socket interconnect or
    directory hardware we need to assure that MC is shrunk to the socket
    or NUMA node.
    
    This patch builds a sibling mask for the LLC, and then picks the
    smallest of LLC, socket siblings, or NUMA node siblings, which
    gives us the behavior described above. This is ever so slightly
    different than the similar alternative where we look for a cache
    layer less than or equal to the socket/NUMA siblings.
    
    The logic to pick the MC layer affects all arm64 machines, but
    only changes the behavior for DT/MPIDR systems if the NUMA domain
    is smaller than the core siblings (generally set to the cluster).
    Potentially this fixes a possible bug in DT systems, but really
    it only affects ACPI systems where the core siblings is correctly
    set to the socket siblings. Thus all currently available ACPI
    systems should have MC equal to LLC, including the NUMA in socket
    machines where the LLC is partitioned between the NUMA nodes.
    
    Tested-by: Ard Biesheuvel <ard.biesheuvel@linaro.org>
    Tested-by: Vijaya Kumar K <vkilari@codeaurora.org>
    Tested-by: Xiongfeng Wang <wangxiongfeng2@huawei.com>
    Tested-by: Tomasz Nowicki <Tomasz.Nowicki@cavium.com>
    Acked-by: Sudeep Holla <sudeep.holla@arm.com>
    Acked-by: Ard Biesheuvel <ard.biesheuvel@linaro.org>
    Acked-by: Morten Rasmussen <morten.rasmussen@arm.com>
    Signed-off-by: Jeremy Linton <jeremy.linton@arm.com>
    Signed-off-by: Catalin Marinas <catalin.marinas@arm.com>

commit 598041f39f3b2c0327a44d8289d27bac35fe7b6a
Author: Bartlomiej Zolnierkiewicz <b.zolnierkie@samsung.com>
Date:   Tue May 15 12:41:10 2018 +0200

    video: fbdev: via: allow COMPILE_TEST build
    
    This patch allows viafb driver to be build on !X86 archs
    using COMPILE_TEST config option.
    
    Since via-camera driver (VIDEO_VIA_CAMERA) depends on viafb
    it also needs a little fixup.
    
    Cc: Florian Tobias Schandinat <FlorianSchandinat@gmx.de>
    Reviewed-by: Mauro Carvalho Chehab <mchehab+samsung@kernel.org>
    Signed-off-by: Bartlomiej Zolnierkiewicz <b.zolnierkie@samsung.com>

commit 789ba28013ce23dbf5e9f5f014f4233b35523bf3
Author: Mel Gorman <mgorman@techsingularity.net>
Date:   Wed May 9 17:31:15 2018 +0100

    Revert "sched/numa: Delay retrying placement for automatic NUMA balance after wake_affine()"
    
    This reverts commit 7347fc87dfe6b7315e74310ee1243dc222c68086.
    
    Srikar Dronamra pointed out that while the commit in question did show
    a performance improvement on ppc64, it did so at the cost of disabling
    active CPU migration by automatic NUMA balancing which was not the intent.
    The issue was that a serious flaw in the logic failed to ever active balance
    if SD_WAKE_AFFINE was disabled on scheduler domains. Even when it's enabled,
    the logic is still bizarre and against the original intent.
    
    Investigation showed that fixing the patch in either the way he suggested,
    using the correct comparison for jiffies values or introducing a new
    numa_migrate_deferred variable in task_struct all perform similarly to a
    revert with a mix of gains and losses depending on the workload, machine
    and socket count.
    
    The original intent of the commit was to handle a problem whereby
    wake_affine, idle balancing and automatic NUMA balancing disagree on the
    appropriate placement for a task. This was particularly true for cases where
    a single task was a massive waker of tasks but where wake_wide logic did
    not apply.  This was particularly noticeable when a futex (a barrier) woke
    all worker threads and tried pulling the wakees to the waker nodes. In that
    specific case, it could be handled by tuning MPI or openMP appropriately,
    but the behavior is not illogical and was worth attempting to fix. However,
    the approach was wrong. Given that we're at rc4 and a fix is not obvious,
    it's better to play safe, revert this commit and retry later.
    
    Signed-off-by: Mel Gorman <mgorman@techsingularity.net>
    Signed-off-by: Peter Zijlstra (Intel) <peterz@infradead.org>
    Reviewed-by: Srikar Dronamraju <srikar@linux.vnet.ibm.com>
    Cc: Linus Torvalds <torvalds@linux-foundation.org>
    Cc: Thomas Gleixner <tglx@linutronix.de>
    Cc: efault@gmx.de
    Cc: ggherdovich@suse.cz
    Cc: hpa@zytor.com
    Cc: matt@codeblueprint.co.uk
    Cc: mpe@ellerman.id.au
    Link: http://lkml.kernel.org/r/20180509163115.6fnnyeg4vdm2ct4v@techsingularity.net
    Signed-off-by: Ingo Molnar <mingo@kernel.org>

commit 32810d91325ec76b8ef4df463f8a0e9baf353322
Author: Michael Ellerman <mpe@ellerman.id.au>
Date:   Tue Apr 17 00:39:02 2018 +1000

    powerpc/lib: Fix feature fixup test of external branch
    
    The expected case for this test was wrong, the source of the alternate
    code sequence is:
    
      FTR_SECTION_ELSE
      2:    or      2,2,2
            PPC_LCMPI       r3,1
            beq     3f
            blt     2b
            b       3f
            b       1b
      ALT_FTR_SECTION_END(0, 1)
      3:    or      1,1,1
            or      2,2,2
      4:    or      3,3,3
    
    So when it's patched the '3' label should still be on the 'or 1,1,1',
    and the 4 label is irrelevant and can be removed.
    
    Fixes: 362e7701fd18 ("powerpc: Add self-tests of the feature fixup code")
    Signed-off-by: Michael Ellerman <mpe@ellerman.id.au>

commit 5f308e6f0f77a8320fc84929f96198857a320b07
Author: Jiri Slaby <jslaby@suse.cz>
Date:   Tue Apr 24 09:43:44 2018 +0200

    tools: power/acpi, revert to LD = gcc
    
    commit 755396163148b50fe1afb4bdd3365e47f3ff7a42 upstream.
    
    Commit 7ed1c1901fe5 (tools: fix cross-compile var clobbering) removed
    setting of LD to $(CROSS_COMPILE)gcc. This broke build of acpica
    (acpidump) in power/acpi:
     ld: unrecognized option '-D_LINUX'
    
    The tools pass CFLAGS to the linker (incl. -D_LINUX), so revert this
    particular change and let LD be $(CC) again. Note that the old behaviour
    was a bit different, it used $(CROSS_COMPILE)gcc which was eliminated by
    the commit 7ed1c1901fe5. We use $(CC) for that reason.
    
    Fixes: 7ed1c1901fe5 (tools: fix cross-compile var clobbering)
    Signed-off-by: Jiri Slaby <jslaby@suse.cz>
    Cc: 4.16+ <stable@vger.kernel.org> # 4.16+
    Signed-off-by: Rafael J. Wysocki <rafael.j.wysocki@intel.com>
    Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>

commit 267d901a7d59b19d1a1dbd021ba49a097fbe53af
Author: Doug Oucharek <dougso@me.com>
Date:   Mon May 7 20:18:06 2018 -0700

    staging: lustre: o2iblnd: Enable Multiple OPA Endpoints between Nodes
    
    OPA driver optimizations are based on the MPI model where it is
    expected to have multiple endpoints between two given nodes. To
    enable this optimization for Lustre, we need to make it possible,
    via an LND-specific tuneable, to create multiple endpoints and to
    balance the traffic over them.
    
    Both sides of a connection must have this patch for it to work.
    Only the active side of the connection (usually the client)
    needs to have the new tuneable set > 1.
    
    Signed-off-by: Doug Oucharek <doug.s.oucharek@intel.com>
    Intel-bug-id: https://jira.hpdd.intel.com/browse/LU-8943
    Reviewed-on: https://review.whamcloud.com/25168
    Reviewed-by: Amir Shehata <amir.shehata@intel.com>
    Reviewed-by: Dmitry Eremin <dmitry.eremin@intel.com>
    Reviewed-by: James Simmons <uja.ornl@yahoo.com>
    Reviewed-by: Oleg Drokin <oleg.drokin@intel.com>
    Signed-off-by: Doug Oucharek <dougso@me.com>
    Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>

commit 65928d1f4130a48732034c2f31b2b0790694537f
Author: Chaitra P B <chaitra.basappa@broadcom.com>
Date:   Tue Apr 24 05:28:40 2018 -0400

    scsi: mpt3sas: Update MPI Headers
    
    Update MPI Files to support protocol level reset for NVMe device.
    
    Signed-off-by: Chaitra P B <chaitra.basappa@broadcom.com>
    Signed-off-by: Suganath Prabu S <suganath-prabu.subramani@broadcom.com>
    Signed-off-by: Martin K. Petersen <martin.petersen@oracle.com>

commit f10379aad39e9da8bc7d1822e251b5f0673067ef
Author: Mauro Carvalho Chehab <mchehab+samsung@kernel.org>
Date:   Fri May 4 16:49:32 2018 -0400

    media: include/video/omapfb_dss.h: use IS_ENABLED()
    
    Just checking for ifdefs cause build issues as reported by
    kernel test:
    
    config: openrisc-allmodconfig (attached as .config)
    compiler: or1k-linux-gcc (GCC) 6.0.0 20160327 (experimental)
    
    All errors (new ones prefixed by >>):
    
       drivers/video/fbdev/omap2/omapfb/omapfb-main.c: In function 'omapfb_init_connections':
    >> drivers/video/fbdev/omap2/omapfb/omapfb-main.c:2396:8: error: implicit declaration of function 'omapdss_find_mgr_from_display' [-Werror=implicit-function-declaration]
         mgr = omapdss_find_mgr_from_display(def_dssdev);
               ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~
       drivers/video/fbdev/omap2/omapfb/omapfb-main.c:2396:6: warning: assignment makes pointer from integer without a cast [-Wint-conversion]
         mgr = omapdss_find_mgr_from_display(def_dssdev);
             ^
       drivers/video/fbdev/omap2/omapfb/omapfb-main.c: In function 'omapfb_find_default_display':
    >> drivers/video/fbdev/omap2/omapfb/omapfb-main.c:2430:13: error: implicit declaration of function 'omapdss_get_default_display_name' [-Werror=implicit-function-declaration]
         def_name = omapdss_get_default_display_name();
                    ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
       drivers/video/fbdev/omap2/omapfb/omapfb-main.c:2430:11: warning: assignment makes pointer from integer without a cast [-Wint-conversion]
         def_name = omapdss_get_default_display_name();
                  ^
    
    So, use IS_ENABLED() instead.
    
    Fixes: 771f7be87ff9 ("media: omapfb: omapfb_dss.h: add stubs to build with COMPILE_TEST && DRM_OMAP")
    
    Cc: Bartlomiej Zolnierkiewicz <b.zolnierkie@samsung.com>
    Cc: Randy Dunlap <rdunlap@infradead.org>
    Cc: tomi.valkeinen@ti.com
    Cc: linux-omap@vger.kernel.org
    Cc: linux-fbdev@vger.kernel.org
    Signed-off-by: Mauro Carvalho Chehab <mchehab+samsung@kernel.org>

commit 6159e12e11770fb25e748af90f6c5206c1df09ee
Author: Mauro Carvalho Chehab <mchehab@s-opensource.com>
Date:   Fri Apr 20 11:55:13 2018 -0400

    media: meye: allow building it with COMPILE_TEST on non-x86
    
    This driver depends on sony-laptop driver, but this is available
    only for x86. So, add a stub function, in order to allow building
    it on non-x86 too.
    
    Signed-off-by: Mauro Carvalho Chehab <mchehab@s-opensource.com>
    Signed-off-by: Mauro Carvalho Chehab <mchehab+samsung@kernel.org>

commit 530d47388496a1d086fd481dbf8fcada6add3be8
Author: Anders Roxell <anders.roxell@linaro.org>
Date:   Mon Apr 23 15:31:39 2018 -0400

    media: drivers: media: platform: make VIDEO_VIU depend on I2C
    
    Commit 7378f1149884 ("media: omap2: omapfb: allow building it with
    COMPILE_TEST") broke compilation without CONFIG_I2C selected.
    drivers/media/platform/fsl-viu.c: In function viu_of_probe:
    drivers/media/platform/fsl-viu.c:1452:7: error: implicit declaration of function i2c_get_adapter; did you mean i2c_lock_adapter? [-Werror=implicit-function-declaration]
      ad = i2c_get_adapter(0);
           ^~~~~~~~~~~~~~~
           i2c_lock_adapter
    drivers/media/platform/fsl-viu.c:1452:5: warning: assignment makes pointer from integer without a cast [-Wint-conversion]
      ad = i2c_get_adapter(0);
         ^
    drivers/media/platform/fsl-viu.c:1534:2: error: implicit declaration of function i2c_put_adapter; did you mean i2c_lock_adapter? [-Werror=implicit-function-declaration]
      i2c_put_adapter(ad);
      ^~~~~~~~~~~~~~~
      i2c_lock_adapter
    
    Added I2C dependency in order to make all configurations work again.
    
    Signed-off-by: Anders Roxell <anders.roxell@linaro.org>
    Signed-off-by: Mauro Carvalho Chehab <mchehab+samsung@kernel.org>

commit d8555fd2f45235ad58efed2f70667f0df99db001
Author: Mauro Carvalho Chehab <mchehab@s-opensource.com>
Date:   Fri Apr 20 13:42:52 2018 -0400

    media: omap2: allow building it with COMPILE_TEST && DRM_OMAP
    
    Now that FB_OMAP has stubs, the omap2 media drivers can be
    built on ARM with COMPILE_TEST && DRM_OMAP.
    
    Signed-off-by: Mauro Carvalho Chehab <mchehab@s-opensource.com>
    Signed-off-by: Mauro Carvalho Chehab <mchehab+samsung@kernel.org>

commit 771f7be87ff921e9a3d744febd606af39a150e14
Author: Mauro Carvalho Chehab <mchehab@s-opensource.com>
Date:   Fri Apr 20 13:42:51 2018 -0400

    media: omapfb: omapfb_dss.h: add stubs to build with COMPILE_TEST && DRM_OMAP
    
    Add stubs for omapfb_dss.h, in the case it is included by
    some driver when CONFIG_FB_OMAP2 is not defined, with can
    happen on ARM when DRM_OMAP is not 'n'.
    
    That allows building such driver(s) with COMPILE_TEST.
    
    Signed-off-by: Mauro Carvalho Chehab <mchehab@s-opensource.com>
    Acked-by: Bartlomiej Zolnierkiewicz <b.zolnierkie@samsung.com>
    Signed-off-by: Mauro Carvalho Chehab <mchehab+samsung@kernel.org>

commit a31d19f88932d92ac8674e21409c08ca82607920
Author: Mauro Carvalho Chehab <mchehab@s-opensource.com>
Date:   Fri Apr 20 13:42:50 2018 -0400

    media: ipu3: allow building it with COMPILE_TEST on non-x86 archs
    
    Despite depending on ACPI, this driver builds fine on non-x86
    archtecture with COMPILE_TEST, as it doesn't depend on
    ACPI-specific functions/structs.
    
    Signed-off-by: Mauro Carvalho Chehab <mchehab@s-opensource.com>
    Acked-by: Sakari Ailus <sakari.ailus@linux.intel.com>
    Signed-off-by: Mauro Carvalho Chehab <mchehab+samsung@kernel.org>

commit 6ba0b22d206888aa524675a69ee796af9118fec2
Author: Mauro Carvalho Chehab <mchehab@s-opensource.com>
Date:   Fri Apr 20 13:42:49 2018 -0400

    media: rc: allow build pnp-dependent drivers with COMPILE_TEST
    
    The pnp header already provide enough stub to build those
    drivers with COMPILE_TEST on non-x86 archs.
    
    Signed-off-by: Mauro Carvalho Chehab <mchehab@s-opensource.com>
    Acked-by: Sean Young <sean@mess.org>
    Signed-off-by: Mauro Carvalho Chehab <mchehab+samsung@kernel.org>

commit 516af1e2e4af336a2602025a591f5f986b411ab7
Author: Mauro Carvalho Chehab <mchehab@s-opensource.com>
Date:   Fri Apr 20 08:32:14 2018 -0400

    media: sta2x11_vip: allow build with COMPILE_TEST
    
    This driver doesn't use any weird API. So, allow building it
    with COMPILE_TEST.
    
    Signed-off-by: Mauro Carvalho Chehab <mchehab@s-opensource.com>
    Signed-off-by: Mauro Carvalho Chehab <mchehab+samsung@kernel.org>

commit 258c524bdaab5b5eff847f8967891279bf37fbe1
Author: Mauro Carvalho Chehab <mchehab@s-opensource.com>
Date:   Fri Apr 20 08:32:13 2018 -0400

    media: radio: allow building ISA drivers with COMPILE_TEST
    
    Several radio devices only build on i386, because they depend
    on ISA. Allow them to build on other archs by adding a
    COMPILE_TEST check.
    
    Signed-off-by: Mauro Carvalho Chehab <mchehab@s-opensource.com>
    Signed-off-by: Mauro Carvalho Chehab <mchehab+samsung@kernel.org>

commit 02489a1216d93abf76d45bc257cf27ecf00098c9
Author: Anders Roxell <anders.roxell@linaro.org>
Date:   Fri Apr 20 13:25:51 2018 +0200

    drivers: omap2: Kconfig: make FB_OMAP2_DSS_INIT depend on OF
    
    Commit 7378f1149884 ("media: omap2: omapfb: allow building it with
    COMPILE_TEST") broke compilation without CONFIG_OF selected.
      CC      drivers/video/fbdev/core/fbmem.o
    drivers/video/fbdev/omap2/omapfb/dss/omapdss-boot-init.c: In function omapdss_update_prop:
    drivers/video/fbdev/omap2/omapfb/dss/omapdss-boot-init.c:68:2: error: implicit declaration of function of_update_property; did you mean of_get_property? [-Werror=implicit-function-declaration]
      of_update_property(node, prop);
      ^~~~~~~~~~~~~~~~~~
      of_get_property
    cc1: some warnings being treated as errors
    scripts/Makefile.build:312: recipe for target 'drivers/video/fbdev/omap2/omapfb/dss/omapdss-boot-init.o' failed
    make[7]: *** [drivers/video/fbdev/omap2/omapfb/dss/omapdss-boot-init.o] Error 1
    scripts/Makefile.build:559: recipe for target 'drivers/video/fbdev/omap2/omapfb/dss' failed
    make[6]: *** [drivers/video/fbdev/omap2/omapfb/dss] Error 2
    make[6]: *** Waiting for unfinished jobs....
    
    Add OF dependency in order to make all configurations work again.
    
    of_update_property() has no inline stub, and that that could be added as
    an alternative.
    
    Signed-off-by: Anders Roxell <anders.roxell@linaro.org>
    Acked-by: Randy Dunlap <rdunlap@infradead.org>
    Tested-by: Randy Dunlap <rdunlap@infradead.org>
    Acked-by: Bartlomiej Zolnierkiewicz <b.zolnierkie@samsung.com>
    Signed-off-by: Mauro Carvalho Chehab <mchehab+samsung@kernel.org>

commit 755396163148b50fe1afb4bdd3365e47f3ff7a42
Author: Jiri Slaby <jslaby@suse.cz>
Date:   Tue Apr 24 09:43:44 2018 +0200

    tools: power/acpi, revert to LD = gcc
    
    Commit 7ed1c1901fe5 (tools: fix cross-compile var clobbering) removed
    setting of LD to $(CROSS_COMPILE)gcc. This broke build of acpica
    (acpidump) in power/acpi:
     ld: unrecognized option '-D_LINUX'
    
    The tools pass CFLAGS to the linker (incl. -D_LINUX), so revert this
    particular change and let LD be $(CC) again. Note that the old behaviour
    was a bit different, it used $(CROSS_COMPILE)gcc which was eliminated by
    the commit 7ed1c1901fe5. We use $(CC) for that reason.
    
    Fixes: 7ed1c1901fe5 (tools: fix cross-compile var clobbering)
    Signed-off-by: Jiri Slaby <jslaby@suse.cz>
    Cc: 4.16+ <stable@vger.kernel.org> # 4.16+
    Signed-off-by: Rafael J. Wysocki <rafael.j.wysocki@intel.com>

commit 48e6f7652dd8c502005decb331910ca0d097c1a9
Author: Geert Uytterhoeven <geert@linux-m68k.org>
Date:   Tue Apr 17 19:49:09 2018 +0200

    iommu: Remove depends on HAS_DMA in case of platform dependency
    
    Remove dependencies on HAS_DMA where a Kconfig symbol depends on another
    symbol that implies HAS_DMA, and, optionally, on "|| COMPILE_TEST".
    In most cases this other symbol is an architecture or platform specific
    symbol, or PCI.
    
    Generic symbols and drivers without platform dependencies keep their
    dependencies on HAS_DMA, to prevent compiling subsystems or drivers that
    cannot work anyway.
    
    This simplifies the dependencies, and allows to improve compile-testing.
    
    Signed-off-by: Geert Uytterhoeven <geert@linux-m68k.org>
    Reviewed-by: Mark Brown <broonie@kernel.org>
    Acked-by: Robin Murphy <robin.murphy@arm.com>
    Acked-by: Joerg Roedel <jroedel@suse.de>
    Signed-off-by: Joerg Roedel <jroedel@suse.de>

commit 1d6efe08c80d84b1f39845707288ffd4df239c3b
Author: Geert Uytterhoeven <geert@linux-m68k.org>
Date:   Tue Apr 17 19:49:13 2018 +0200

    mmc: Remove depends on HAS_DMA in case of platform dependency
    
    Remove dependencies on HAS_DMA where a Kconfig symbol depends on another
    symbol that implies HAS_DMA, and, optionally, on "|| COMPILE_TEST".
    In most cases this other symbol is an architecture or platform specific
    symbol, or PCI.
    
    Generic symbols and drivers without platform dependencies keep their
    dependencies on HAS_DMA, to prevent compiling subsystems or drivers that
    cannot work anyway.
    
    This simplifies the dependencies, and allows to improve compile-testing.
    
    Signed-off-by: Geert Uytterhoeven <geert@linux-m68k.org>
    Reviewed-by: Mark Brown <broonie@kernel.org>
    Acked-by: Robin Murphy <robin.murphy@arm.com>
    Signed-off-by: Ulf Hansson <ulf.hansson@linaro.org>

commit ea813dce6771ef3b56702fc14ac7595aa89ae404
Author: Manivannan Sadhasivam <manivannan.sadhasivam@linaro.org>
Date:   Tue May 1 08:30:47 2018 +0530

    pinctrl: actions: Fix Kconfig dependency and help text
    
    1. Fix Kconfig dependency for Actions Semi S900 pinctrl driver which
    generates below warning in x86:
    
    WARNING: unmet direct dependencies detected for PINCTRL_OWL
      Depends on [n]: PINCTRL [=y] && (ARCH_ACTIONS || COMPILE_TEST [=n]) && OF [=n]
      Selected by [y]:
      - PINCTRL_S900 [=y] && PINCTRL [=y]
    
    2. Add help text for OWL pinctrl driver
    
    Signed-off-by: Manivannan Sadhasivam <manivannan.sadhasivam@linaro.org>
    Reported-by: Randy Dunlap <rdunlap@infradead.org>
    Tested-by: Randy Dunlap <rdunlap@infradead.org>
    Acked-by: Randy Dunlap <rdunlap@infradead.org>
    Signed-off-by: Linus Walleij <linus.walleij@linaro.org>

commit 51bc085d6454214b02dba7a259ee1fdfe3ee8d9f
Author: Rob Herring <robh@kernel.org>
Date:   Thu Apr 5 14:31:54 2018 -0500

    PCI: Improve host drivers compile test coverage
    
    Add COMPILE_TEST on driver config options with it. Some ARM drivers
    still have arch dependencies, so we have to keep those dependent on ARM.
    
    Cc: Lorenzo Pieralisi <lorenzo.pieralisi@arm.com>
    Cc: Bjorn Helgaas <bhelgaas@google.com>
    Cc: linux-pci@vger.kernel.org
    Signed-off-by: Rob Herring <robh@kernel.org>
    [lorenzo.pieralisi@arm.com: rebased, updated log]
    Signed-off-by: Lorenzo Pieralisi <lorenzo.pieralisi@arm.com>

commit 3c2b8df02c726f166d7fc4a7260cc4acde489b4a
Author: Yangbo Lu <yangbo.lu@nxp.com>
Date:   Thu Apr 26 18:23:49 2018 +0800

    staging: fsl-dpaa2/rtc: support phc_index of ethtool_ts_info
    
    This patch is to support phc_index of ethtool_ts_info.
    Also make the rtc drvier depend on FSL_DPAA2_ETH because
    this driver is only useful when PTP programs are getting
    hardware time stamps on the PTP Ethernet packets using the
    SO_TIMESTAMPING API.
    
    Signed-off-by: Yangbo Lu <yangbo.lu@nxp.com>
    Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>

commit ee1b23d1dfab7f75a18a9de36ef8d1a150f94db0
Author: Geert Uytterhoeven <geert@linux-m68k.org>
Date:   Tue Apr 17 19:49:03 2018 +0200

    crypto: drivers - Remove depends on HAS_DMA in case of platform dependency
    
    Remove dependencies on HAS_DMA where a Kconfig symbol depends on another
    symbol that implies HAS_DMA, and, optionally, on "|| COMPILE_TEST".
    In most cases this other symbol is an architecture or platform specific
    symbol, or PCI.
    
    Generic symbols and drivers without platform dependencies keep their
    dependencies on HAS_DMA, to prevent compiling subsystems or drivers that
    cannot work anyway.
    
    This simplifies the dependencies, and allows to improve compile-testing.
    
    Signed-off-by: Geert Uytterhoeven <geert@linux-m68k.org>
    Reviewed-by: Mark Brown <broonie@kernel.org>
    Acked-by: Robin Murphy <robin.murphy@arm.com>
    Acked-by: Herbert Xu <herbert@gondor.apana.org.au>
    Signed-off-by: Herbert Xu <herbert@gondor.apana.org.au>

commit 41a5985f173bf1f93d2634fc93d8aa53683067f9
Author: Geert Uytterhoeven <geert@linux-m68k.org>
Date:   Tue Apr 17 19:49:16 2018 +0200

    remoteproc: Remove depends on HAS_DMA in case of platform dependency
    
    Remove dependencies on HAS_DMA where a Kconfig symbol depends on another
    symbol that implies HAS_DMA, and, optionally, on "|| COMPILE_TEST".
    In most cases this other symbol is an architecture or platform specific
    symbol, or PCI.
    
    Generic symbols and drivers without platform dependencies keep their
    dependencies on HAS_DMA, to prevent compiling subsystems or drivers that
    cannot work anyway.
    
    This simplifies the dependencies, and allows to improve compile-testing.
    
    Signed-off-by: Geert Uytterhoeven <geert@linux-m68k.org>
    Reviewed-by: Mark Brown <broonie@kernel.org>
    Acked-by: Robin Murphy <robin.murphy@arm.com>
    Acked-by: Bjorn Andersson <bjorn.andersson@linaro.org>
    Signed-off-by: Bjorn Andersson <bjorn.andersson@linaro.org>

commit f83eb6b57f5ae7f4d1bc668f198655e854a90432
Author: Arnd Bergmann <arnd@arndb.de>
Date:   Fri Feb 16 16:26:57 2018 +0100

    radeon: hide pointless #warning when compile testing
    
    commit c02216acf4177c4411d33735c81cad687790fa59 upstream.
    
    In randconfig testing, we sometimes get this warning:
    
    drivers/gpu/drm/radeon/radeon_object.c: In function 'radeon_bo_create':
    drivers/gpu/drm/radeon/radeon_object.c:242:2: error: #warning Please enable CONFIG_MTRR and CONFIG_X86_PAT for better performance thanks to write-combining [-Werror=cpp]
     #warning Please enable CONFIG_MTRR and CONFIG_X86_PAT for better performance \
    
    This is rather annoying since almost all other code produces no build-time
    output unless we have found a real bug. We already fixed this in the
    amdgpu driver in commit 31bb90f1cd08 ("drm/amdgpu: shut up #warning for
    compile testing") by adding a CONFIG_COMPILE_TEST check last year and
    agreed to do the same here, but both Michel and I then forgot about it
    until I came across the issue again now.
    
    For stable kernels, as this is one of very few remaining randconfig
    warnings in 4.14.
    
    Cc: stable@vger.kernel.org
    Link: https://patchwork.kernel.org/patch/9550009/
    Signed-off-by: Arnd Bergmann <arnd@arndb.de>
    Signed-off-by: Michel Dnzer <michel.daenzer@amd.com>
    Signed-off-by: Alex Deucher <alexander.deucher@amd.com>
    Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>

commit 21ab37de5c92f8bb28b4b23c40455fbb229fa20c
Author: Geert Uytterhoeven <geert@linux-m68k.org>
Date:   Tue Apr 17 19:49:19 2018 +0200

    staging: vc04_services: Remove depends on HAS_DMA in case of platform dependency
    
    Remove dependencies on HAS_DMA where a Kconfig symbol depends on another
    symbol that implies HAS_DMA, and, optionally, on "|| COMPILE_TEST".
    In most cases this other symbol is an architecture or platform specific
    symbol, or PCI.
    
    Generic symbols and drivers without platform dependencies keep their
    dependencies on HAS_DMA, to prevent compiling subsystems or drivers that
    cannot work anyway.
    
    This simplifies the dependencies, and allows to improve compile-testing.
    
    Signed-off-by: Geert Uytterhoeven <geert@linux-m68k.org>
    Reviewed-by: Mark Brown <broonie@kernel.org>
    Acked-by: Robin Murphy <robin.murphy@arm.com>
    Acked-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>
    Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>

commit 84d84c5b8ff1a91bbd463a84df65b16ea60dff5d
Author: Geert Uytterhoeven <geert@linux-m68k.org>
Date:   Tue Apr 17 19:49:06 2018 +0200

    fpga: Remove depends on HAS_DMA in case of platform dependency
    
    Remove dependencies on HAS_DMA where a Kconfig symbol depends on another
    symbol that implies HAS_DMA, and, optionally, on "|| COMPILE_TEST".
    In most cases this other symbol is an architecture or platform specific
    symbol, or PCI.
    
    Generic symbols and drivers without platform dependencies keep their
    dependencies on HAS_DMA, to prevent compiling subsystems or drivers that
    cannot work anyway.
    
    This simplifies the dependencies, and allows to improve compile-testing.
    
    Signed-off-by: Geert Uytterhoeven <geert@linux-m68k.org>
    Reviewed-by: Mark Brown <broonie@kernel.org>
    Acked-by: Robin Murphy <robin.murphy@arm.com>
    Acked-by: Alan Tull <atull@kernel.org>
    Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>

commit d6810a82c7c7e3b262db5e9e67f6bd81b41f3840
Author: Geert Uytterhoeven <geert@linux-m68k.org>
Date:   Tue Apr 17 19:49:17 2018 +0200

    serial: Remove depends on HAS_DMA in case of platform dependency
    
    Remove dependencies on HAS_DMA where a Kconfig symbol depends on another
    symbol that implies HAS_DMA, and, optionally, on "|| COMPILE_TEST".
    In most cases this other symbol is an architecture or platform specific
    symbol, or PCI.
    
    Generic symbols and drivers without platform dependencies keep their
    dependencies on HAS_DMA, to prevent compiling subsystems or drivers that
    cannot work anyway.
    
    This simplifies the dependencies, and allows to improve compile-testing.
    
    Signed-off-by: Geert Uytterhoeven <geert@linux-m68k.org>
    Reviewed-by: Mark Brown <broonie@kernel.org>
    Acked-by: Robin Murphy <robin.murphy@arm.com>
    Acked-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>
    Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>

commit cd91a0e9d38fa85ad8e95ca7849ce4adc00e3caa
Author: Geert Uytterhoeven <geert@linux-m68k.org>
Date:   Tue Apr 17 19:49:20 2018 +0200

    usb: Remove depends on HAS_DMA in case of platform dependency
    
    Remove dependencies on HAS_DMA where a Kconfig symbol depends on another
    symbol that implies HAS_DMA, and, optionally, on "|| COMPILE_TEST".
    In most cases this other symbol is an architecture or platform specific
    symbol, or PCI.
    
    Generic symbols and drivers without platform dependencies keep their
    dependencies on HAS_DMA, to prevent compiling subsystems or drivers that
    cannot work anyway.
    
    This simplifies the dependencies, and allows to improve compile-testing.
    
    Signed-off-by: Geert Uytterhoeven <geert@linux-m68k.org>
    Reviewed-by: Mark Brown <broonie@kernel.org>
    Acked-by: Robin Murphy <robin.murphy@arm.com>
    Acked-by: Felipe Balbi <felipe.balbi@linux.intel.com> [drivers/usb/gadget/]
    Acked-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>
    Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>

commit 7db782bc180efabf6d6628d428be163dc19513ad
Author: Geert Uytterhoeven <geert@linux-m68k.org>
Date:   Tue Apr 17 19:49:14 2018 +0200

    mtd: Remove depends on HAS_DMA in case of platform dependency
    
    Remove dependencies on HAS_DMA where a Kconfig symbol depends on another
    symbol that implies HAS_DMA, and, optionally, on "|| COMPILE_TEST".
    In most cases this other symbol is an architecture or platform specific
    symbol, or PCI.
    
    Generic symbols and drivers without platform dependencies keep their
    dependencies on HAS_DMA, to prevent compiling subsystems or drivers that
    cannot work anyway.
    
    This simplifies the dependencies, and allows to improve compile-testing.
    
    Signed-off-by: Geert Uytterhoeven <geert@linux-m68k.org>
    Reviewed-by: Mark Brown <broonie@kernel.org>
    Acked-by: Robin Murphy <robin.murphy@arm.com>
    Signed-off-by: Boris Brezillon <boris.brezillon@bootlin.com>

commit c2d94c5214905fd67ddfd7ad21729ca129e4e02d
Merge: 87ef12027b9b fae764912153
Author: Linus Torvalds <torvalds@linux-foundation.org>
Date:   Fri Apr 20 08:01:38 2018 -0700

    Merge branch 'for-linus' of git://git.kernel.org/pub/scm/linux/kernel/git/s390/linux
    
    Pull s390 fixes and kexec-file-load from Martin Schwidefsky:
     "After the common code kexec patches went in via Andrew we can now push
      the architecture parts to implement the kexec-file-load system call.
    
      Plus a few more bug fixes and cleanups, this includes an update to the
      default configurations"
    
    * 'for-linus' of git://git.kernel.org/pub/scm/linux/kernel/git/s390/linux:
      s390/signal: cleanup uapi struct sigaction
      s390: rename default_defconfig to debug_defconfig
      s390: remove gcov defconfig
      s390: update defconfig
      s390: add support for IBM z14 Model ZR1
      s390: remove couple of duplicate includes
      s390/boot: remove unused COMPILE_VERSION and ccflags-y
      s390/nospec: include cpu.h
      s390/decompressor: Ignore file vmlinux.bin.full
      s390/kexec_file: add generated files to .gitignore
      s390/Kconfig: Move kexec config options to "Processor type and features"
      s390/kexec_file: Add ELF loader
      s390/kexec_file: Add crash support to image loader
      s390/kexec_file: Add image loader
      s390/kexec_file: Add kexec_file_load system call
      s390/kexec_file: Add purgatory
      s390/kexec_file: Prepare setup.h for kexec_file_load
      s390/smsgiucv: disable SMSG on module unload
      s390/sclp: avoid potential usage of uninitialized value

commit da112f13996de6e8dc0011f77ce8f7d0353dd14e
Author: Mauro Carvalho Chehab <mchehab@s-opensource.com>
Date:   Fri Apr 20 08:53:49 2018 -0400

    media: sound, isapnp: allow building more drivers with COMPILE_TEST
    
    Drivers that depend on ISAPNP currently can't be built with
    COMPILE_TEST. However, looking at isapnp.h, there are already
    stubs there to allow drivers to include it even when isa
    PNP is not supported.
    
    So, remove such dependencies when COMPILE_TEST.
    
    Acked-by: Takashi Iwai <tiwai@suse.de>
    Signed-off-by: Mauro Carvalho Chehab <mchehab@s-opensource.com>

commit e39fbc26ab6ae6cbb76752b4d357ffedd911a1c6
Author: Mauro Carvalho Chehab <mchehab@s-opensource.com>
Date:   Fri Apr 20 06:54:58 2018 -0400

    media: sound, media: allow building ISA drivers it with COMPILE_TEST
    
    All sound drivers that don't depend on PNP can be safelly
    build with COMPILE_TEST, as ISA provides function stubs to
    be used for such purposes.
    
    As a side effect, with this change, the radio-miropcm20
    can now be built outside i386 with COMPILE_TEST.
    
    It should be noticed that ISAPNP currently depends on ISA.
    So, on drivers that depend on it, we need to add an
    explicit dependency on ISA, at least until another patch
    removes it.
    
    Acked-by: Takashi Iwai <tiwai@suse.de>
    Signed-off-by: Mauro Carvalho Chehab <mchehab@s-opensource.com>

commit 243131134be4bf577647110d39c64fc406c608b0
Author: Arnd Bergmann <arnd@arndb.de>
Date:   Mon Apr 9 05:48:01 2018 -0400

    media: omap3isp: Allow it to build with COMPILE_TEST
    
    There aren't much things required for it to build with COMPILE_TEST.
    It just needs to not compile the code that depends on arm-specific
    iommu implementation.
    
    Co-developed-by: Mauro Carvalho Chehab <mchehab@s-opensource.com>
    
    Signed-off-by: Arnd Bergmann <arnd@arndb.de>
    Acked-by: Sakari Ailus <sakari.ailus@linux.intel.com>
    Acked-by: Hans Verkuil <hans.verkuil@cisco.com>
    Signed-off-by: Mauro Carvalho Chehab <mchehab@s-opensource.com>

commit ba37e6dd017e1b8129707f225cb751ba3125db21
Author: Laurent Pinchart <laurent.pinchart@ideasonboard.com>
Date:   Sat Apr 7 07:40:08 2018 -0400

    media: omap3isp: Enable driver compilation on ARM with COMPILE_TEST
    
    The omap3isp driver can't be compiled on non-ARM platforms but has no
    compile-time dependency on OMAP. It however requires common clock
    framework support, which isn't provided by all ARM platforms.
    
    Drop the OMAP dependency when COMPILE_TEST is set and add ARM and
    COMMON_CLK dependencies.
    
    Signed-off-by: Laurent Pinchart <laurent.pinchart@ideasonboard.com>
    Acked-by: Sakari Ailus <sakari.ailus@linux.intel.com>
    Acked-by: Hans Verkuil <hans.verkuil@cisco.com>
    Signed-off-by: Mauro Carvalho Chehab <mchehab@s-opensource.com>

commit c7f1770f369ae0ec632b3ddc2bd6677b0e485128
Author: Mauro Carvalho Chehab <mchehab@s-opensource.com>
Date:   Thu Apr 5 10:54:14 2018 -0400

    media: omap: omap-iommu.h: allow building drivers with COMPILE_TEST
    
    Drivers that depend on omap-iommu.h (currently, just omap3isp)
    need a stub implementation in order to be built with COMPILE_TEST.
    
    Acked-by: Sakari Ailus <sakari.ailus@linux.intel.com>
    Acked-by: Hans Verkuil <hans.verkuil@cisco.com>
    Acked-by: Arnd Bergmann <arnd@arndb.de>
    Acked-by: Tony Lindgren <tony@atomide.com>
    Signed-off-by: Mauro Carvalho Chehab <mchehab@s-opensource.com>

commit cacf021760ee51ef163b1094c9163a863be6b104
Author: Arnd Bergmann <arnd@arndb.de>
Date:   Fri Feb 16 16:26:57 2018 +0100

    radeon: hide pointless #warning when compile testing
    
    commit c02216acf4177c4411d33735c81cad687790fa59 upstream.
    
    In randconfig testing, we sometimes get this warning:
    
    drivers/gpu/drm/radeon/radeon_object.c: In function 'radeon_bo_create':
    drivers/gpu/drm/radeon/radeon_object.c:242:2: error: #warning Please enable CONFIG_MTRR and CONFIG_X86_PAT for better performance thanks to write-combining [-Werror=cpp]
     #warning Please enable CONFIG_MTRR and CONFIG_X86_PAT for better performance \
    
    This is rather annoying since almost all other code produces no build-time
    output unless we have found a real bug. We already fixed this in the
    amdgpu driver in commit 31bb90f1cd08 ("drm/amdgpu: shut up #warning for
    compile testing") by adding a CONFIG_COMPILE_TEST check last year and
    agreed to do the same here, but both Michel and I then forgot about it
    until I came across the issue again now.
    
    For stable kernels, as this is one of very few remaining randconfig
    warnings in 4.14.
    
    Cc: stable@vger.kernel.org
    Link: https://patchwork.kernel.org/patch/9550009/
    Signed-off-by: Arnd Bergmann <arnd@arndb.de>
    Signed-off-by: Michel Dnzer <michel.daenzer@amd.com>
    Signed-off-by: Alex Deucher <alexander.deucher@amd.com>
    Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>

commit bda73d4ec943c4f7479603a59cad09a07c6c729a
Merge: 32e43779fc01 861928f4e60e
Author: David S. Miller <davem@davemloft.net>
Date:   Thu Apr 19 16:11:12 2018 -0400

    Merge branch 'Amiga-xsurf100'
    
    Michael Schmitz says:
    
    ====================
    New network driver for Amiga X-Surf 100 (m68k)
    
    [This is a resend of my v3 series which was based on the wrong version and
    tree. Only substantial change is to Asix AX99796B PHY driver.]
    
    This patch series adds support for the Individual Computers X-Surf 100
    network card for m68k Amiga, a network adapter based on the AX88796 chip set.
    
    The driver was originally written for kernel version 3.19 by Michael Karcher
    (see CC:), and adapted to 4.16+ for submission to netdev by me. Questions
    regarding motivation for some of the changes are probably best directed at
    Michael Karcher.
    
    The driver has been tested by Adrian <glaubitz@physik.fu-berlin.de> who will
    send his Tested-by tag separately.
    
    A few changes to the ax88796 driver were required:
    - to read the MAC address, some setup of the ax99796 chip must be done,
    - attach to the MII bus only on device open to allow module unloading,
    - allow to supersede ax_block_input/ax_block_output by card-specific
      optimized code,
    - use an optional interrupt status callback to allow easier sharing of the
      card interrupt,
    - set IRQF_SHARED if platform IRQ resource is marked shareable
    
    The Asix Electronix PHY used on the X-Surf 100 is buggy, and causes the
    software reset to hang if the previous command sent to the PHY was also
    a soft reset. This bug requires addition of a PHY driver for Asix PHYs
    to provide a fixed .soft_reset function, included in this series.
    
    Some additional cleanup:
    - do not attempt to free IRQ in ax_remove (complements 82533ad9a1c),
    - clear platform drvdata on probe fail and module remove.
    
    Changes since v1:
    
    Raised in review by Andrew Lunn:
    - move MII code around to avoid need for forward declaration,
    - combine patches 2 and 7 to add cleanup in error path
    
    Changes since v2:
    
    - corrected authorship attribution to Michael Karcher
    
    Suggested by Geert Uytterhoeven:
    - use ei_local->reset_8390() instead of duplicating ax_reset_8390(),
    - use %pR to format struct resource pointers,
    - assign pdev and xs100 pointers in declaration,
    - don't split error messages,
    - change Kconfig logic to only require XSURF100 set on Amiga
    
    Suggested by Andrew Lunn:
    - add COMPILE_TEST to ax88796 Kconfig options,
    - use new Asix PHY driver for X-Surf 100
    
    Suggested by Andrew Lunn/Finn Thain:
    - declare struct sk_buff in ax88796.h,
    - correct whitespace error in ax88796.h
    
    Changes since v3:
    
    - various checkpatch cleanup
    
    Andrew Lunn:
    - don't duplicate genphy_soft_reset in Asix PHY driver, just call
      genphy_soft_reset after writing zero to control register
    ====================
    
    Signed-off-by: David S. Miller <davem@davemloft.net>

commit feb5f2ec646483fb66f9ad7218b1aad2a93a2a5c
Author: Yuchung Cheng <ycheng@google.com>
Date:   Tue Apr 17 23:18:49 2018 -0700

    tcp: export packets delivery info
    
    Export data delivered and delivered with CE marks to
    1) SNMP TCPDelivered and TCPDeliveredCE
    2) getsockopt(TCP_INFO)
    3) Timestamping API SOF_TIMESTAMPING_OPT_STATS
    
    Note that for SCM_TSTAMP_ACK, the delivery info in
    SOF_TIMESTAMPING_OPT_STATS is reported before the info
    was fully updated on the ACK.
    
    These stats help application monitor TCP delivery and ECN status
    on per host, per connection, even per message level.
    
    Signed-off-by: Yuchung Cheng <ycheng@google.com>
    Reviewed-by: Neal Cardwell <ncardwell@google.com>
    Reviewed-by: Soheil Hassas Yeganeh <soheil@google.com>
    Reviewed-by: Eric Dumazet <edumazet@google.com>
    Signed-off-by: David S. Miller <davem@davemloft.net>

commit 8e52e2f41c43d53b35fcd053acf3101982da9b7c
Author: Arnd Bergmann <arnd@arndb.de>
Date:   Fri Feb 16 16:26:57 2018 +0100

    radeon: hide pointless #warning when compile testing
    
    commit c02216acf4177c4411d33735c81cad687790fa59 upstream.
    
    In randconfig testing, we sometimes get this warning:
    
    drivers/gpu/drm/radeon/radeon_object.c: In function 'radeon_bo_create':
    drivers/gpu/drm/radeon/radeon_object.c:242:2: error: #warning Please enable CONFIG_MTRR and CONFIG_X86_PAT for better performance thanks to write-combining [-Werror=cpp]
     #warning Please enable CONFIG_MTRR and CONFIG_X86_PAT for better performance \
    
    This is rather annoying since almost all other code produces no build-time
    output unless we have found a real bug. We already fixed this in the
    amdgpu driver in commit 31bb90f1cd08 ("drm/amdgpu: shut up #warning for
    compile testing") by adding a CONFIG_COMPILE_TEST check last year and
    agreed to do the same here, but both Michel and I then forgot about it
    until I came across the issue again now.
    
    For stable kernels, as this is one of very few remaining randconfig
    warnings in 4.14.
    
    Cc: stable@vger.kernel.org
    Link: https://patchwork.kernel.org/patch/9550009/
    Signed-off-by: Arnd Bergmann <arnd@arndb.de>
    Signed-off-by: Michel Dnzer <michel.daenzer@amd.com>
    Signed-off-by: Alex Deucher <alexander.deucher@amd.com>
    Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>

commit 0bf649dc6b8dff4a2871f61b7da4cb6d2fcca4b1
Author: Arnd Bergmann <arnd@arndb.de>
Date:   Fri Feb 16 16:26:57 2018 +0100

    radeon: hide pointless #warning when compile testing
    
    commit c02216acf4177c4411d33735c81cad687790fa59 upstream.
    
    In randconfig testing, we sometimes get this warning:
    
    drivers/gpu/drm/radeon/radeon_object.c: In function 'radeon_bo_create':
    drivers/gpu/drm/radeon/radeon_object.c:242:2: error: #warning Please enable CONFIG_MTRR and CONFIG_X86_PAT for better performance thanks to write-combining [-Werror=cpp]
     #warning Please enable CONFIG_MTRR and CONFIG_X86_PAT for better performance \
    
    This is rather annoying since almost all other code produces no build-time
    output unless we have found a real bug. We already fixed this in the
    amdgpu driver in commit 31bb90f1cd08 ("drm/amdgpu: shut up #warning for
    compile testing") by adding a CONFIG_COMPILE_TEST check last year and
    agreed to do the same here, but both Michel and I then forgot about it
    until I came across the issue again now.
    
    For stable kernels, as this is one of very few remaining randconfig
    warnings in 4.14.
    
    Cc: stable@vger.kernel.org
    Link: https://patchwork.kernel.org/patch/9550009/
    Signed-off-by: Arnd Bergmann <arnd@arndb.de>
    Signed-off-by: Michel Dnzer <michel.daenzer@amd.com>
    Signed-off-by: Alex Deucher <alexander.deucher@amd.com>
    Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>

commit bcbba7bb54e9a7c6ed35bbd5514e0507d8c495cb
Author: Colin Ian King <colin.king@canonical.com>
Date:   Wed Apr 18 12:30:38 2018 +0100

    scsi: mptfc: fix spelling mistake in macro names
    
    Rename macros MPI_FCPORTPAGE0_SUPPORT_SPEED_UKNOWN and
    MPI_FCPORTPAGE0_CURRENT_SPEED_UKNOWN to add in missing N in UNKNOWN
    
    Signed-off-by: Colin Ian King <colin.king@canonical.com>
    Signed-off-by: Martin K. Petersen <martin.petersen@oracle.com>

commit e5b43ed2f06ed8729ac22047a0ac1c5c4bc40003
Author: Geert Uytterhoeven <geert@linux-m68k.org>
Date:   Tue Apr 17 19:49:18 2018 +0200

    spi: Remove depends on HAS_DMA in case of platform dependency
    
    Remove dependencies on HAS_DMA where a Kconfig symbol depends on another
    symbol that implies HAS_DMA, and, optionally, on "|| COMPILE_TEST".
    In most cases this other symbol is an architecture or platform specific
    symbol, or PCI.
    
    Generic symbols and drivers without platform dependencies keep their
    dependencies on HAS_DMA, to prevent compiling subsystems or drivers that
    cannot work anyway.
    
    This simplifies the dependencies, and allows to improve compile-testing.
    
    Signed-off-by: Geert Uytterhoeven <geert@linux-m68k.org>
    Reviewed-by: Mark Brown <broonie@kernel.org>
    Acked-by: Robin Murphy <robin.murphy@arm.com>
    Acked-by: Mark Brown <broonie@kernel.org>
    Signed-off-by: Mark Brown <broonie@kernel.org>

commit 221dd96c30a7c65b24ead7fdd7645abb99506ce2
Author: Geert Uytterhoeven <geert@linux-m68k.org>
Date:   Tue Apr 17 19:49:01 2018 +0200

    ASoC: Remove depends on HAS_DMA in case of platform dependency
    
    Remove dependencies on HAS_DMA where a Kconfig symbol depends on another
    symbol that implies HAS_DMA, and, optionally, on "|| COMPILE_TEST".
    In most cases this other symbol is an architecture or platform specific
    symbol, or PCI.
    
    Generic symbols and drivers without platform dependencies keep their
    dependencies on HAS_DMA, to prevent compiling subsystems or drivers that
    cannot work anyway.
    
    This simplifies the dependencies, and allows to improve compile-testing.
    
    Note:
      - The various SND_SOC_LPASS_* symbols had to loose their dependencies
        on HAS_DMA, as they are selected by SND_SOC_STORM and/or
        SND_SOC_APQ8016_SBC.
    
    Signed-off-by: Geert Uytterhoeven <geert@linux-m68k.org>
    Reviewed-by: Mark Brown <broonie@kernel.org>
    Acked-by: Robin Murphy <robin.murphy@arm.com>
    Acked-by: Mark Brown <broonie@kernel.org>
    Signed-off-by: Mark Brown <broonie@kernel.org>

commit 14a8f0d88cfb58071da2e5ff99eddcef0f87e2cc
Author: Geert Uytterhoeven <geert@linux-m68k.org>
Date:   Tue Apr 17 19:49:07 2018 +0200

    i2c: Remove depends on HAS_DMA in case of platform dependency
    
    Remove dependencies on HAS_DMA where a Kconfig symbol depends on another
    symbol that implies HAS_DMA, and, optionally, on "|| COMPILE_TEST".
    In most cases this other symbol is an architecture or platform specific
    symbol, or PCI.
    
    Generic symbols and drivers without platform dependencies keep their
    dependencies on HAS_DMA, to prevent compiling subsystems or drivers that
    cannot work anyway.
    
    This simplifies the dependencies, and allows to improve compile-testing.
    
    Signed-off-by: Geert Uytterhoeven <geert@linux-m68k.org>
    Reviewed-by: Mark Brown <broonie@kernel.org>
    Acked-by: Robin Murphy <robin.murphy@arm.com>
    Signed-off-by: Wolfram Sang <wsa@the-dreams.de>

commit 34b2ea1c9e6a6bc5cb57e447dda4196d46da69e8
Author: Mauro Carvalho Chehab <mchehab@s-opensource.com>
Date:   Wed Apr 11 09:33:18 2018 -0400

    media: platform: fix some 64-bits warnings
    
    The omap/omap3 and viu drivers are for 32 bit platforms only.
    There, a pointer has 32 bits. Now that those drivers build
    for 64 bits with COMPILE_TEST, they produce the following
    warnings:
    
    drivers/media/platform/omap/omap_vout_vrfb.c: In function 'omap_vout_allocate_vrfb_buffers':
    drivers/media/platform/omap/omap_vout_vrfb.c:57:10: warning: cast to pointer from integer of different size [-Wint-to-pointer-cast]
       memset((void *) vout->smsshado_virt_addr[i], 0,
              ^
    drivers/media/platform/fsl-viu.c: In function 'viu_setup_preview':
    drivers/media/platform/fsl-viu.c:753:28: warning: cast from pointer to integer of different size [-Wpointer-to-int-cast]
      reg_val.field_base_addr = (u32)dev->ovbuf.base;
                                ^
    drivers/media/platform/omap/omap_vout.c: In function 'omap_vout_get_userptr':
    drivers/media/platform/omap/omap_vout.c:209:25: warning: cast to pointer from integer of different size [-Wint-to-pointer-cast]
       *physp = virt_to_phys((void *)virtp);
                             ^
    drivers/media/platform/omap3isp/ispccdc.c: In function 'ccdc_config':
    drivers/media/platform/omap3isp/ispccdc.c:738:9: warning: cast to pointer from integer of different size [-Wint-to-pointer-cast]
             (__force void __user *)fpc.fpcaddr,
             ^
    
    Add some typecasts to remove those warnings when building for
    64 bits.
    
    Signed-off-by: Mauro Carvalho Chehab <mchehab@s-opensource.com>

commit 4907c73deefea512620f7ba8199c99e30f4f65fc
Author: Mauro Carvalho Chehab <mchehab@s-opensource.com>
Date:   Thu Apr 5 14:07:28 2018 -0400

    media: staging: davinci_vpfe: allow building with COMPILE_TEST
    
    This is a little bit hashish, but this driver is at staging,
    so it won't become worse.
    
    With this small change at Makefile, we can now build it with
    COMPILE_TEST.
    
    Signed-off-by: Mauro Carvalho Chehab <mchehab@s-opensource.com>

commit 58757984ca3c73284a45dd53ac66f1414057cd09
Author: Mauro Carvalho Chehab <mchehab@s-opensource.com>
Date:   Thu Apr 5 15:08:12 2018 -0400

    media: si470x: allow build both USB and I2C at the same time
    
    Currently, either USB or I2C is built. Change it to allow
    having both enabled at the same time.
    
    The main reason is that COMPILE_TEST all[yes/mod]builds will
    now contain all drivers under drivers/media.
    
    Signed-off-by: Mauro Carvalho Chehab <mchehab@s-opensource.com>

commit 84fc727ed49ca2e940f2369ffde6e2c317d85335
Author: Mauro Carvalho Chehab <mchehab@s-opensource.com>
Date:   Thu Apr 5 14:11:54 2018 -0400

    media: omap4iss: make it build with COMPILE_TEST
    
    This driver compile as-is with COMPILE_TEST.
    
    Signed-off-by: Mauro Carvalho Chehab <mchehab@s-opensource.com>

commit 7f8e175aba2bc9bdc67304b7a6f6122aebf0e8cd
Author: Mauro Carvalho Chehab <mchehab@s-opensource.com>
Date:   Thu Apr 5 12:51:07 2018 -0400

    media: omap: allow building it with COMPILE_TEST
    
    Now that we have stubs for omap FB driver, let it build with
    COMPILE_TEST.
    
    Signed-off-by: Mauro Carvalho Chehab <mchehab@s-opensource.com>

commit 7378f1149884b183631c6c16c0f1c62bcd7d759d
Author: Mauro Carvalho Chehab <mchehab@s-opensource.com>
Date:   Thu Apr 5 13:28:26 2018 -0400

    media: omap2: omapfb: allow building it with COMPILE_TEST
    
    This driver builds cleanly with COMPILE_TEST, and it is
    needed in order to allow building drivers/media omap2
    driver.
    
    So, change the logic there to allow building it.
    
    Acked-by: Tomi Valkeinen <tomi.valkeinen@ti.com>
    Signed-off-by: Mauro Carvalho Chehab <mchehab@s-opensource.com>

commit 05c90900e24be491102a6018e242ee7ca602918b
Author: Mauro Carvalho Chehab <mchehab@s-opensource.com>
Date:   Thu Apr 5 12:31:39 2018 -0400

    media: davinci: allow build vpbe_display with COMPILE_TEST
    
    Except for some includes (with doesn't seem to be used), this
    driver builds fine with COMPILE_TEST.
    
    So, add checks there to avoid building it if ARCH_DAVINCI
    is not selected.
    
    Signed-off-by: Mauro Carvalho Chehab <mchehab@s-opensource.com>

commit b8952ee685505787cdc8406d04a48c1023781439
Author: Mauro Carvalho Chehab <mchehab@s-opensource.com>
Date:   Thu Apr 5 12:21:39 2018 -0400

    media: davinci: allow building isif code
    
    The only reason why this driver doesn't build with COMPILE_TEST
    is because it includes mach/mux.h. It turns that none of the
    macros defined there are used.
    
    So, get rid of it, in order to allow it to build with
    COMPILE_TEST.
    
    Signed-off-by: Mauro Carvalho Chehab <mchehab@s-opensource.com>

commit b29c0ddad64e6f7d9c0a29e68333c0b25d3eacdd
Author: Mauro Carvalho Chehab <mchehab@s-opensource.com>
Date:   Thu Apr 5 11:37:19 2018 -0400

    media: exymos4-is: allow compile test for EXYNOS FIMC-LITE
    
    There's nothing that prevents building this driver with
    COMPILE_TEST. So, enable it.
    
    While here, make the Kconfig dependency cleaner by removing
    the unneeded if block.
    
    Signed-off-by: Mauro Carvalho Chehab <mchehab@s-opensource.com>

commit b5d9f09e93152e2bc46c829709364e1634338f2f
Author: Mauro Carvalho Chehab <mchehab@s-opensource.com>
Date:   Thu Apr 5 11:17:31 2018 -0400

    media: cec_gpio: allow building CEC_GPIO with COMPILE_TEST
    
    At least on i386, building with allyesconfig doesn't enable
    PREEMPT, causing cec_gpio to not build.
    
    Signed-off-by: Mauro Carvalho Chehab <mchehab@s-opensource.com>

commit 29d750686331a1a9ceeb97e81d3770f57bed5f72
Author: Mauro Carvalho Chehab <mchehab@s-opensource.com>
Date:   Thu Apr 5 10:40:59 2018 -0400

    media: fsl-viu: allow building it with COMPILE_TEST
    
    There aren't many things that would be needed to allow it
    to build with compile test.
    
    Add the needed bits.
    
    Signed-off-by: Mauro Carvalho Chehab <mchehab@s-opensource.com>

commit c65bbb51c6e98a1956c08faab81941ec558ef0ba
Author: Vasily Gorbik <gor@linux.ibm.com>
Date:   Wed Apr 11 10:24:29 2018 +0200

    s390/boot: remove unused COMPILE_VERSION and ccflags-y
    
    ccflags-y has no effect (no code is built in that directory,
    arch/s390/boot/compressed/Makefile defines its own KBUILD_CFLAGS).
    Removing ccflags-y together with COMPILE_VERSION.
    
    Reviewed-by: Heiko Carstens <heiko.carstens@de.ibm.com>
    Signed-off-by: Vasily Gorbik <gor@linux.ibm.com>
    Signed-off-by: Martin Schwidefsky <schwidefsky@de.ibm.com>

commit 7cfbe9ba85101aa413d337fe5fd2946bf210b8c0
Author: Robert Jarzmik <robert.jarzmik@free.fr>
Date:   Mon Jun 5 13:59:15 2017 +0200

    tags: honor COMPILED_SOURCE with apart output directory
    
    
    [ Upstream commit cbf52a3e6a8a92beec6e0c70abf4111cd8f8faf7 ]
    
    When the kernel is compiled with an "O=" argument, the object files are
    not in the source tree, but in the build tree.
    
    This patch fixes O= build by looking for object files in the build tree.
    
    Fixes: 923e02ecf3f8 ("scripts/tags.sh: Support compiled source")
    Signed-off-by: Robert Jarzmik <robert.jarzmik@free.fr>
    Signed-off-by: Masahiro Yamada <yamada.masahiro@socionext.com>
    Signed-off-by: Sasha Levin <alexander.levin@microsoft.com>
    Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>

commit 04e22d2e31777698ffb463740496db13c3b5aa22
Author: Robert Jarzmik <robert.jarzmik@free.fr>
Date:   Mon Jun 5 13:59:15 2017 +0200

    tags: honor COMPILED_SOURCE with apart output directory
    
    
    [ Upstream commit cbf52a3e6a8a92beec6e0c70abf4111cd8f8faf7 ]
    
    When the kernel is compiled with an "O=" argument, the object files are
    not in the source tree, but in the build tree.
    
    This patch fixes O= build by looking for object files in the build tree.
    
    Fixes: 923e02ecf3f8 ("scripts/tags.sh: Support compiled source")
    Signed-off-by: Robert Jarzmik <robert.jarzmik@free.fr>
    Signed-off-by: Masahiro Yamada <yamada.masahiro@socionext.com>
    Signed-off-by: Sasha Levin <alexander.levin@microsoft.com>
    Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>

commit 8339488663f23b7d59413f756a6507879d83b4bf
Author: Robert Jarzmik <robert.jarzmik@free.fr>
Date:   Mon Jun 5 13:59:15 2017 +0200

    tags: honor COMPILED_SOURCE with apart output directory
    
    
    [ Upstream commit cbf52a3e6a8a92beec6e0c70abf4111cd8f8faf7 ]
    
    When the kernel is compiled with an "O=" argument, the object files are
    not in the source tree, but in the build tree.
    
    This patch fixes O= build by looking for object files in the build tree.
    
    Fixes: 923e02ecf3f8 ("scripts/tags.sh: Support compiled source")
    Signed-off-by: Robert Jarzmik <robert.jarzmik@free.fr>
    Signed-off-by: Masahiro Yamada <yamada.masahiro@socionext.com>
    Signed-off-by: Sasha Levin <alexander.levin@microsoft.com>
    Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>

commit c979024a1bb359988dc6b50a26dd3bb0789fd54f
Author: Shanker Donthineni <shankerd@codeaurora.org>
Date:   Tue Dec 5 13:16:21 2017 -0600

    irqchip/gic-v3: Fix the driver probe() fail due to disabled GICC entry
    
    
    [ Upstream commit ebe2f8718007d5a1238bb3cb8141b5bb2b4d5773 ]
    
    The ACPI specification says OS shouldn't attempt to use GICC configuration
    parameters if the flag ACPI_MADT_ENABLED is cleared. The ARM64-SMP code
    skips the disabled GICC entries but not causing any issue. However the
    current GICv3 driver probe bails out causing kernel panic() instead of
    skipping the disabled GICC interfaces. This issue happens on systems
    where redistributor regions are not in the always-on power domain and
    one of GICC interface marked with ACPI_MADT_ENABLED=0.
    
    This patch does the two things to fix the panic.
      - Don't return an error in gic_acpi_match_gicc() for disabled GICC entry.
      - No need to keep GICR region information for disabled GICC entry.
    
    Observed kernel crash on QDF2400 platform GICC entry is disabled.
    Kernel crash traces:
      Kernel panic - not syncing: No interrupt controller found.
      CPU: 0 PID: 0 Comm: swapper/0 Not tainted 4.13.5 #26
      [<ffff000008087770>] dump_backtrace+0x0/0x218
      [<ffff0000080879dc>] show_stack+0x14/0x20
      [<ffff00000883b078>] dump_stack+0x98/0xb8
      [<ffff0000080c5c14>] panic+0x118/0x26c
      [<ffff000008b62348>] init_IRQ+0x24/0x2c
      [<ffff000008b609fc>] start_kernel+0x230/0x394
      [<ffff000008b601e4>] __primary_switched+0x64/0x6c
      ---[ end Kernel panic - not syncing: No interrupt controller found.
    
    Disabled GICC subtable example:
                       Subtable Type : 0B [Generic Interrupt Controller]
                              Length : 50
                            Reserved : 0000
                CPU Interface Number : 0000003D
                       Processor UID : 0000003D
               Flags (decoded below) : 00000000
                   Processor Enabled : 0
     Performance Interrupt Trig Mode : 0
     Virtual GIC Interrupt Trig Mode : 0
            Parking Protocol Version : 00000000
               Performance Interrupt : 00000017
                      Parked Address : 0000000000000000
                        Base Address : 0000000000000000
            Virtual GIC Base Address : 0000000000000000
         Hypervisor GIC Base Address : 0000000000000000
               Virtual GIC Interrupt : 00000019
          Redistributor Base Address : 0000FFFF88F40000
                           ARM MPIDR : 000000000000000D
                    Efficiency Class : 00
                            Reserved : 000000
    Signed-off-by: Shanker Donthineni <shankerd@codeaurora.org>
    Signed-off-by: Marc Zyngier <marc.zyngier@arm.com>
    
    Signed-off-by: Sasha Levin <alexander.levin@microsoft.com>
    Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>

commit 04568f4df2280cd7f42ce4a9da2789a3eacb779c
Author: Shanker Donthineni <shankerd@codeaurora.org>
Date:   Tue Dec 5 13:16:21 2017 -0600

    irqchip/gic-v3: Fix the driver probe() fail due to disabled GICC entry
    
    
    [ Upstream commit ebe2f8718007d5a1238bb3cb8141b5bb2b4d5773 ]
    
    The ACPI specification says OS shouldn't attempt to use GICC configuration
    parameters if the flag ACPI_MADT_ENABLED is cleared. The ARM64-SMP code
    skips the disabled GICC entries but not causing any issue. However the
    current GICv3 driver probe bails out causing kernel panic() instead of
    skipping the disabled GICC interfaces. This issue happens on systems
    where redistributor regions are not in the always-on power domain and
    one of GICC interface marked with ACPI_MADT_ENABLED=0.
    
    This patch does the two things to fix the panic.
      - Don't return an error in gic_acpi_match_gicc() for disabled GICC entry.
      - No need to keep GICR region information for disabled GICC entry.
    
    Observed kernel crash on QDF2400 platform GICC entry is disabled.
    Kernel crash traces:
      Kernel panic - not syncing: No interrupt controller found.
      CPU: 0 PID: 0 Comm: swapper/0 Not tainted 4.13.5 #26
      [<ffff000008087770>] dump_backtrace+0x0/0x218
      [<ffff0000080879dc>] show_stack+0x14/0x20
      [<ffff00000883b078>] dump_stack+0x98/0xb8
      [<ffff0000080c5c14>] panic+0x118/0x26c
      [<ffff000008b62348>] init_IRQ+0x24/0x2c
      [<ffff000008b609fc>] start_kernel+0x230/0x394
      [<ffff000008b601e4>] __primary_switched+0x64/0x6c
      ---[ end Kernel panic - not syncing: No interrupt controller found.
    
    Disabled GICC subtable example:
                       Subtable Type : 0B [Generic Interrupt Controller]
                              Length : 50
                            Reserved : 0000
                CPU Interface Number : 0000003D
                       Processor UID : 0000003D
               Flags (decoded below) : 00000000
                   Processor Enabled : 0
     Performance Interrupt Trig Mode : 0
     Virtual GIC Interrupt Trig Mode : 0
            Parking Protocol Version : 00000000
               Performance Interrupt : 00000017
                      Parked Address : 0000000000000000
                        Base Address : 0000000000000000
            Virtual GIC Base Address : 0000000000000000
         Hypervisor GIC Base Address : 0000000000000000
               Virtual GIC Interrupt : 00000019
          Redistributor Base Address : 0000FFFF88F40000
                           ARM MPIDR : 000000000000000D
                    Efficiency Class : 00
                            Reserved : 000000
    Signed-off-by: Shanker Donthineni <shankerd@codeaurora.org>
    Signed-off-by: Marc Zyngier <marc.zyngier@arm.com>
    
    Signed-off-by: Sasha Levin <alexander.levin@microsoft.com>
    Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>

commit 03e965ebd983f659ac7e242ce7f4b7f3d3ab5867
Author: Shanker Donthineni <shankerd@codeaurora.org>
Date:   Tue Dec 5 13:16:21 2017 -0600

    irqchip/gic-v3: Fix the driver probe() fail due to disabled GICC entry
    
    
    [ Upstream commit ebe2f8718007d5a1238bb3cb8141b5bb2b4d5773 ]
    
    The ACPI specification says OS shouldn't attempt to use GICC configuration
    parameters if the flag ACPI_MADT_ENABLED is cleared. The ARM64-SMP code
    skips the disabled GICC entries but not causing any issue. However the
    current GICv3 driver probe bails out causing kernel panic() instead of
    skipping the disabled GICC interfaces. This issue happens on systems
    where redistributor regions are not in the always-on power domain and
    one of GICC interface marked with ACPI_MADT_ENABLED=0.
    
    This patch does the two things to fix the panic.
      - Don't return an error in gic_acpi_match_gicc() for disabled GICC entry.
      - No need to keep GICR region information for disabled GICC entry.
    
    Observed kernel crash on QDF2400 platform GICC entry is disabled.
    Kernel crash traces:
      Kernel panic - not syncing: No interrupt controller found.
      CPU: 0 PID: 0 Comm: swapper/0 Not tainted 4.13.5 #26
      [<ffff000008087770>] dump_backtrace+0x0/0x218
      [<ffff0000080879dc>] show_stack+0x14/0x20
      [<ffff00000883b078>] dump_stack+0x98/0xb8
      [<ffff0000080c5c14>] panic+0x118/0x26c
      [<ffff000008b62348>] init_IRQ+0x24/0x2c
      [<ffff000008b609fc>] start_kernel+0x230/0x394
      [<ffff000008b601e4>] __primary_switched+0x64/0x6c
      ---[ end Kernel panic - not syncing: No interrupt controller found.
    
    Disabled GICC subtable example:
                       Subtable Type : 0B [Generic Interrupt Controller]
                              Length : 50
                            Reserved : 0000
                CPU Interface Number : 0000003D
                       Processor UID : 0000003D
               Flags (decoded below) : 00000000
                   Processor Enabled : 0
     Performance Interrupt Trig Mode : 0
     Virtual GIC Interrupt Trig Mode : 0
            Parking Protocol Version : 00000000
               Performance Interrupt : 00000017
                      Parked Address : 0000000000000000
                        Base Address : 0000000000000000
            Virtual GIC Base Address : 0000000000000000
         Hypervisor GIC Base Address : 0000000000000000
               Virtual GIC Interrupt : 00000019
          Redistributor Base Address : 0000FFFF88F40000
                           ARM MPIDR : 000000000000000D
                    Efficiency Class : 00
                            Reserved : 000000
    Signed-off-by: Shanker Donthineni <shankerd@codeaurora.org>
    Signed-off-by: Marc Zyngier <marc.zyngier@arm.com>
    
    Signed-off-by: Sasha Levin <alexander.levin@microsoft.com>
    Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>

commit 92e830f25fc0be447486a4658887ded68ef824f5
Author: Arnd Bergmann <arnd@arndb.de>
Date:   Wed Apr 4 14:44:54 2018 +0200

    x86/olpc: Fix inconsistent MFD_CS5535 configuration
    
    This Kconfig warning appeared after a fix to the Kconfig validation.
    The GPIO_CS5535 driver depends on the MFD_CS5535 driver, but the former
    is selected in places where the latter is not:
    
    WARNING: unmet direct dependencies detected for GPIO_CS5535
      Depends on [m]: GPIOLIB [=y] && (X86 [=y] || MIPS || COMPILE_TEST [=y]) && MFD_CS5535 [=m]
      Selected by [y]:
      - OLPC_XO1_SCI [=y] && X86_32 [=y] && OLPC [=y] && OLPC_XO1_PM [=y] && INPUT [=y]=y
    
    The warning does seem appropriate, since the GPIO_CS5535 driver won't
    work unless MFD_CS5535 is also present. However, there is no link time
    dependency between the two, so this caused no problems during randconfig
    testing before.
    
    This changes the 'select GPIO_CS5535' to 'depends on GPIO_CS5535' to
    avoid the issue, at the expense of making it harder to configure the
    driver (one now has to select the dependencies first).
    
    The 'select MFD_CORE' part is completely redundant, since we already
    depend on MFD_CS5535 here, so I'm removing that as well.
    
    Ideally, the private symbols exported by that cs5535 gpio driver would
    just be converted to gpiolib interfaces so we could expletely avoid
    this dependency.
    
    Signed-off-by: Arnd Bergmann <arnd@arndb.de>
    Acked-by: Thomas Gleixner <tglx@linutronix.de>
    Cc: Andrew Morton <akpm@linux-foundation.org>
    Cc: Linus Torvalds <torvalds@linux-foundation.org>
    Cc: Masahiro Yamada <yamada.masahiro@socionext.com>
    Cc: Peter Zijlstra <peterz@infradead.org>
    Cc: linux-kbuild@vger.kernel.org
    Fixes: f622f8279581 ("kconfig: warn unmet direct dependency of tristate symbols selected by y")
    Link: http://lkml.kernel.org/r/20180404124539.3817101-1-arnd@arndb.de
    Signed-off-by: Ingo Molnar <mingo@kernel.org>

commit 0734e00ef9e48e78c5c3ce1648572f160d07e323
Merge: 4608f064532c 615b2665fd20
Author: Linus Torvalds <torvalds@linux-foundation.org>
Date:   Tue Apr 3 15:48:04 2018 -0700

    Merge branch 'parisc-4.17-1' of git://git.kernel.org/pub/scm/linux/kernel/git/deller/parisc-linux
    
    Pull parisc updates from Helge Deller:
     "Lots of small enhancements and fixes in this patchset:
    
       - improved the x86-64 compatibility for PCI cards by returning -1UL
         for timed out MMIO transactions (instead of crashing)
    
       - fixed HPMC handler for PAT machines: size needs to be multiple of 16
    
       - prepare machine_power_off() to be able to turn rp3410 and c8000
         machines off via IMPI
    
       - added code to extract machine info for usage with qemu
    
       - some init sections fixes
    
       - lots of fixes for sparse-, ubsan- and uninitalized variables
         warnings"
    
    * 'parisc-4.17-1' of git://git.kernel.org/pub/scm/linux/kernel/git/deller/parisc-linux:
      parisc: Fix out of array access in match_pci_device()
      parisc: Add code generator for Qemu/SeaBIOS machine info
      parisc/pci: Switch LBA PCI bus from Hard Fail to Soft Fail mode
      parisc: Fix HPMC handler by increasing size to multiple of 16 bytes
      parisc: Directly call machine_power_off() in power button driver
      parisc: machine_power_off() should call pm_power_off()
      parisc/Kconfig: SMP kernels boot on all machines
      parisc: Silence uninitialized variable warning in dbl_to_sgl_fcnvff()
      parisc: Move various functions and strings to init section
      parisc: Convert MAP_TYPE to cover 4 bits on parisc
      parisc: Force to various endian types for sparse
      parisc/gscps2: Fix sparse warnings
      parisc/led: Fix sparse warnings
      parisc/parport_gsc: Use NULL to avoid sparse warning
      parisc/stifb: Use fb_memset() to avoid sparse warning

commit da2827a298f8a2159f31466759cbba2dd4f1b65f
Author: Arnd Bergmann <arnd@arndb.de>
Date:   Fri Mar 9 22:45:26 2018 +0100

    usb: isp1362: remove blackfin arch glue
    
    The blackfin architecture is getting removed, and this is the last
    remaining architecture specific setting, so the various hacks
    can be removed now.
    
    From all I can tell, there are no remaining in-tree users of the
    driver, but it could be used by out-of-tree platform ports.
    I've marked the driver as 'depends on COMPILE_TEST', short of
    removing it outright.
    
    It was originally written for some ARM PXA machines using the same
    chip, but that platform never really worked and the code has been
    removed a long time ago.
    
    Acked-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>
    Acked-by: Aaron Wu <aaron.wu@analog.com>
    Signed-off-by: Arnd Bergmann <arnd@arndb.de>

commit f8f69dc0b4e070d4a4d39889a85424913cc922d5
Author: Masahiro Yamada <yamada.masahiro@socionext.com>
Date:   Tue Mar 13 18:56:08 2018 +0900

    kconfig: make unmet dependency warnings readable
    
    Currently, the unmet dependency warnings end up with endlessly long
    expressions, most of which are false positives.
    
    Here is test code to demonstrate how it currently works.
    
    [Test Case]
    
      config DEP1
              def_bool y
    
      config DEP2
              bool "DEP2"
    
      config A
              bool "A"
              select E
    
      config B
              bool "B"
              depends on DEP2
              select E
    
      config C
              bool "C"
              depends on DEP1 && DEP2
              select E
    
      config D
              def_bool n
              select E
    
      config E
              bool
              depends on DEP1 && DEP2
    
    [Result]
    
      $ make config
      scripts/kconfig/conf  --oldaskconfig Kconfig
      *
      * Linux Kernel Configuration
      *
      DEP2 (DEP2) [N/y/?] (NEW) n
      A (A) [N/y/?] (NEW) y
      warning: (A && B && D) selects E which has unmet direct
      dependencies (DEP1 && DEP2)
    
    Here, I see some points to be improved.
    
    First, '(A || B || D)' would make more sense than '(A && B && D)'.
    I am not sure if this is intentional, but expr_simplify_unmet_dep()
    turns OR expressions into AND, like follows:
    
            case E_OR:
                    return expr_alloc_and(
    
    Second, we see false positives.  'A' is a real unmet dependency.
    'B' is false positive because 'DEP1' is fixed to 'y', and 'B' depends
    on 'DEP2'.  'C' was correctly dropped by expr_simplify_unmet_dep().
    'D' is also false positive because it has no chance to be enabled.
    Current expr_simplify_unmet_dep() cannot avoid those false positives.
    
    After all, I decided to use the same helpers as used for printing
    reverse dependencies in the help.
    
    With this commit, unreadable warnings (most of the reported symbols are
    false positives) in the real world:
    
    $ make ARCH=score allyesconfig
    scripts/kconfig/conf  --allyesconfig Kconfig
    warning: (HWSPINLOCK_QCOM && AHCI_MTK && STMMAC_PLATFORM &&
     DWMAC_IPQ806X && DWMAC_LPC18XX && DWMAC_OXNAS && DWMAC_ROCKCHIP &&
     DWMAC_SOCFPGA && DWMAC_STI && TI_CPSW && PINCTRL_GEMINI &&
     PINCTRL_OXNAS && PINCTRL_ROCKCHIP && PINCTRL_DOVE &&
     PINCTRL_ARMADA_37XX && PINCTRL_STM32 && S3C2410_WATCHDOG &&
     VIDEO_OMAP3 && VIDEO_S5P_FIMC && USB_XHCI_MTK && RTC_DRV_AT91SAM9 &&
     LPC18XX_DMAMUX && VIDEO_OMAP4 && COMMON_CLK_GEMINI &&
     COMMON_CLK_ASPEED && COMMON_CLK_NXP && COMMON_CLK_OXNAS &&
     COMMON_CLK_BOSTON && QCOM_ADSP_PIL && QCOM_Q6V5_PIL && QCOM_GSBI &&
     ATMEL_EBI && ST_IRQCHIP && RESET_IMX7 && PHY_HI6220_USB &&
     PHY_RALINK_USB && PHY_ROCKCHIP_PCIE && PHY_DA8XX_USB) selects
     MFD_SYSCON which has unmet direct dependencies (HAS_IOMEM)
    warning: (PINCTRL_AT91 && PINCTRL_AT91PIO4 && PINCTRL_OXNAS &&
     PINCTRL_PISTACHIO && PINCTRL_PIC32 && PINCTRL_MESON &&
     PINCTRL_NOMADIK && PINCTRL_MTK && PINCTRL_MT7622 && GPIO_TB10X)
     selects OF_GPIO which has unmet direct dependencies (GPIOLIB && OF &&
     HAS_IOMEM)
    warning: (FAULT_INJECTION_STACKTRACE_FILTER && LATENCYTOP && LOCKDEP)
     selects FRAME_POINTER which has unmet direct dependencies
     (DEBUG_KERNEL && (CRIS || M68K || FRV || UML || SUPERH || BLACKFIN ||
     MN10300 || METAG) || ARCH_WANT_FRAME_POINTERS)
    
    will be turned into:
    
    $ make ARCH=score allyesconfig
    scripts/kconfig/conf  --allyesconfig Kconfig
    
    WARNING: unmet direct dependencies detected for MFD_SYSCON
      Depends on [n]: HAS_IOMEM [=n]
      Selected by [y]:
      - PINCTRL_STM32 [=y] && PINCTRL [=y] && (ARCH_STM32 ||
     COMPILE_TEST [=y]) && OF [=y]
      - RTC_DRV_AT91SAM9 [=y] && RTC_CLASS [=y] && (ARCH_AT91 ||
     COMPILE_TEST [=y])
      - RESET_IMX7 [=y] && RESET_CONTROLLER [=y]
      - PHY_HI6220_USB [=y] && (ARCH_HISI && ARM64 ||
     COMPILE_TEST [=y])
      - PHY_RALINK_USB [=y] && (RALINK || COMPILE_TEST [=y])
      - PHY_ROCKCHIP_PCIE [=y] && (ARCH_ROCKCHIP && OF [=y] ||
     COMPILE_TEST [=y])
    
    WARNING: unmet direct dependencies detected for OF_GPIO
      Depends on [n]: GPIOLIB [=y] && OF [=y] && HAS_IOMEM [=n]
      Selected by [y]:
      - PINCTRL_MTK [=y] && PINCTRL [=y] && (ARCH_MEDIATEK ||
     COMPILE_TEST [=y]) && OF [=y]
      - PINCTRL_MT7622 [=y] && PINCTRL [=y] && (ARCH_MEDIATEK ||
     COMPILE_TEST [=y]) && OF [=y] && (ARM64 || COMPILE_TEST [=y])
    
    WARNING: unmet direct dependencies detected for FRAME_POINTER
      Depends on [n]: DEBUG_KERNEL [=y] && (CRIS || M68K || FRV || UML ||
     SUPERH || BLACKFIN || MN10300 || METAG) || ARCH_WANT_FRAME_POINTERS [=n]
      Selected by [y]:
      - LATENCYTOP [=y] && DEBUG_KERNEL [=y] && STACKTRACE_SUPPORT [=y] &&
     PROC_FS [=y] && !MIPS && !PPC && !S390 && !MICROBLAZE && !ARM_UNWIND &&
     !ARC && !X86
    
    Signed-off-by: Masahiro Yamada <yamada.masahiro@socionext.com>
    Reviewed-by: Petr Vorel <petr.vorel@gmail.com>

commit f73d0b37846adf58313bfe2bf0c2b9fe59f00c77
Author: Tatyana Nikolova <tatyana.e.nikolova@intel.com>
Date:   Mon Mar 12 17:14:02 2018 -0500

    RDMA/core: Do not use invalid destination in determining port reuse
    
    commit 9dea9a2ff61c5efb4d4937ae23b14babd25a5547 upstream.
    
    cma_port_is_unique() allows local port reuse if the quad (source
    address and port, destination address and port) for this connection
    is unique. However, if the destination info is zero or unspecified, it
    can't make a correct decision but still allows port reuse. For example,
    sometimes rdma_bind_addr() is called with unspecified destination and
    reusing the port can lead to creating a connection with a duplicate quad,
    after the destination is resolved. The issue manifests when MPI scale-up
    tests hang after the duplicate quad is used.
    
    Set the destination address family and add checks for zero destination
    address and port to prevent source port reuse based on invalid destination.
    
    Fixes: 19b752a19dce ("IB/cma: Allow port reuse for rdma_id")
    Reviewed-by: Sean Hefty <sean.hefty@intel.com>
    Signed-off-by: Tatyana Nikolova <tatyana.e.nikolova@intel.com>
    Signed-off-by: Shiraz Saleem <shiraz.saleem@intel.com>
    Signed-off-by: Doug Ledford <dledford@redhat.com>
    Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>

commit 02db484a058353a2513e00604f5b05e42d8d2384
Author: Tatyana Nikolova <tatyana.e.nikolova@intel.com>
Date:   Mon Mar 12 17:14:02 2018 -0500

    RDMA/core: Do not use invalid destination in determining port reuse
    
    commit 9dea9a2ff61c5efb4d4937ae23b14babd25a5547 upstream.
    
    cma_port_is_unique() allows local port reuse if the quad (source
    address and port, destination address and port) for this connection
    is unique. However, if the destination info is zero or unspecified, it
    can't make a correct decision but still allows port reuse. For example,
    sometimes rdma_bind_addr() is called with unspecified destination and
    reusing the port can lead to creating a connection with a duplicate quad,
    after the destination is resolved. The issue manifests when MPI scale-up
    tests hang after the duplicate quad is used.
    
    Set the destination address family and add checks for zero destination
    address and port to prevent source port reuse based on invalid destination.
    
    Fixes: 19b752a19dce ("IB/cma: Allow port reuse for rdma_id")
    Reviewed-by: Sean Hefty <sean.hefty@intel.com>
    Signed-off-by: Tatyana Nikolova <tatyana.e.nikolova@intel.com>
    Signed-off-by: Shiraz Saleem <shiraz.saleem@intel.com>
    Signed-off-by: Doug Ledford <dledford@redhat.com>
    Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>

commit d0f0fb25d6c7a7c299d9bdaa2a11e96e4102e944
Author: Igor Russkikh <igor.russkikh@aquantia.com>
Date:   Tue Mar 20 14:40:32 2018 +0300

    net: aquantia: Fix a regression with reset on old firmware
    
    FW 1.5.58 and below needs a fixed delay even after 0x18 register
    is filled. Otherwise, setting MPI_INIT state too fast causes
    traffic hang.
    
    Signed-off-by: Igor Russkikh <igor.russkikh@aquantia.com>
    Signed-off-by: David S. Miller <davem@davemloft.net>

commit 3565a3d01e14c33d29512ca8129365cbe38df809
Author: Geert Uytterhoeven <geert@linux-m68k.org>
Date:   Fri Mar 16 14:51:50 2018 +0100

    scsi: hisi_sas: Remove depends on HAS_DMA in case of platform dependency
    
    Remove dependencies on HAS_DMA where a Kconfig symbol depends on another
    symbol that implies HAS_DMA, and, optionally, on "|| COMPILE_TEST".  In
    most cases this other symbol is an architecture or platform specific
    symbol, or PCI.
    
    Generic symbols and drivers without platform dependencies keep their
    dependencies on HAS_DMA, to prevent compiling subsystems or drivers that
    cannot work anyway.
    
    This simplifies the dependencies, and allows to improve compile-testing.
    
    Signed-off-by: Geert Uytterhoeven <geert@linux-m68k.org>
    Reviewed-by: Mark Brown <broonie@kernel.org>
    Acked-by: Robin Murphy <robin.murphy@arm.com>
    Acked-by: John Garry <john.garry@huawei.com>
    Signed-off-by: Martin K. Petersen <martin.petersen@oracle.com>

commit ad9133a8010fd7bc4f034efb98cee6fd341700a5
Author: James Hogan <jhogan@kernel.org>
Date:   Tue Dec 5 23:31:35 2017 +0000

    lib/mpi: Fix umul_ppmm() for MIPS64r6
    
    [ Upstream commit bbc25bee37d2b32cf3a1fab9195b6da3a185614a ]
    
    Current MIPS64r6 toolchains aren't able to generate efficient
    DMULU/DMUHU based code for the C implementation of umul_ppmm(), which
    performs an unsigned 64 x 64 bit multiply and returns the upper and
    lower 64-bit halves of the 128-bit result. Instead it widens the 64-bit
    inputs to 128-bits and emits a __multi3 intrinsic call to perform a 128
    x 128 multiply. This is both inefficient, and it results in a link error
    since we don't include __multi3 in MIPS linux.
    
    For example commit 90a53e4432b1 ("cfg80211: implement regdb signature
    checking") merged in v4.15-rc1 recently broke the 64r6_defconfig and
    64r6el_defconfig builds by indirectly selecting MPILIB. The same build
    errors can be reproduced on older kernels by enabling e.g. CRYPTO_RSA:
    
    lib/mpi/generic_mpih-mul1.o: In function `mpihelp_mul_1':
    lib/mpi/generic_mpih-mul1.c:50: undefined reference to `__multi3'
    lib/mpi/generic_mpih-mul2.o: In function `mpihelp_addmul_1':
    lib/mpi/generic_mpih-mul2.c:49: undefined reference to `__multi3'
    lib/mpi/generic_mpih-mul3.o: In function `mpihelp_submul_1':
    lib/mpi/generic_mpih-mul3.c:49: undefined reference to `__multi3'
    lib/mpi/mpih-div.o In function `mpihelp_divrem':
    lib/mpi/mpih-div.c:205: undefined reference to `__multi3'
    lib/mpi/mpih-div.c:142: undefined reference to `__multi3'
    
    Therefore add an efficient MIPS64r6 implementation of umul_ppmm() using
    inline assembly and the DMULU/DMUHU instructions, to prevent __multi3
    calls being emitted.
    
    Fixes: 7fd08ca58ae6 ("MIPS: Add build support for the MIPS R6 ISA")
    Signed-off-by: James Hogan <jhogan@kernel.org>
    Cc: Ralf Baechle <ralf@linux-mips.org>
    Cc: Herbert Xu <herbert@gondor.apana.org.au>
    Cc: "David S. Miller" <davem@davemloft.net>
    Cc: linux-mips@linux-mips.org
    Cc: linux-crypto@vger.kernel.org
    Signed-off-by: Herbert Xu <herbert@gondor.apana.org.au>
    Signed-off-by: Sasha Levin <alexander.levin@microsoft.com>

commit fc7563b3400ab925a32fce9e88db5dd3ddfc6bb0
Author: Christoffer Dall <christoffer.dall@linaro.org>
Date:   Tue Mar 15 19:43:45 2016 +0100

    KVM: arm64: Defer saving/restoring 64-bit sysregs to vcpu load/put on VHE
    
    Some system registers do not affect the host kernel's execution and can
    therefore be loaded when we are about to run a VCPU and we don't have to
    restore the host state to the hardware before the time when we are
    actually about to return to userspace or schedule out the VCPU thread.
    
    The EL1 system registers and the userspace state registers only
    affecting EL0 execution do not need to be saved and restored on every
    switch between the VM and the host, because they don't affect the host
    kernel's execution.
    
    We mark all registers which are now deffered as such in the
    vcpu_{read,write}_sys_reg accessors in sys-regs.c to ensure the most
    up-to-date copy is always accessed.
    
    Note MPIDR_EL1 (controlled via VMPIDR_EL2) is accessed from other vcpu
    threads, for example via the GIC emulation, and therefore must be
    declared as immediate, which is fine as the guest cannot modify this
    value.
    
    The 32-bit sysregs can also be deferred but we do this in a separate
    patch as it requires a bit more infrastructure.
    
    Reviewed-by: Andrew Jones <drjones@redhat.com>
    Signed-off-by: Christoffer Dall <christoffer.dall@linaro.org>
    Signed-off-by: Marc Zyngier <marc.zyngier@arm.com>

commit 53794570049d314742f156c99022914840a3d5ab
Author: Yousuk Seung <ysseung@google.com>
Date:   Fri Mar 16 10:51:49 2018 -0700

    net-tcp_bbr: set tp->snd_ssthresh to BDP upon STARTUP exit
    
    Set tp->snd_ssthresh to BDP upon STARTUP exit. This allows us
    to check if a BBR flow exited STARTUP and the BDP at the
    time of STARTUP exit with SCM_TIMESTAMPING_OPT_STATS. Since BBR does not
    use snd_ssthresh this fix has no impact on BBR's behavior.
    
    Signed-off-by: Yousuk Seung <ysseung@google.com>
    Signed-off-by: Neal Cardwell <ncardwell@google.com>
    Signed-off-by: Priyaranjan Jha <priyarjha@google.com>
    Signed-off-by: Soheil Hassas Yeganeh <soheil@google.com>
    Signed-off-by: Yuchung Cheng <ycheng@google.com>
    Signed-off-by: David S. Miller <davem@davemloft.net>

commit 7156d194a0772f733865267e7207e0b08f81b02b
Author: Yousuk Seung <ysseung@google.com>
Date:   Fri Mar 16 10:51:07 2018 -0700

    tcp: add snd_ssthresh stat in SCM_TIMESTAMPING_OPT_STATS
    
    This patch adds TCP_NLA_SND_SSTHRESH stat into SCM_TIMESTAMPING_OPT_STATS
    that reports tcp_sock.snd_ssthresh.
    
    Signed-off-by: Yousuk Seung <ysseung@google.com>
    Signed-off-by: Neal Cardwell <ncardwell@google.com>
    Signed-off-by: Priyaranjan Jha <priyarjha@google.com>
    Signed-off-by: Soheil Hassas Yeganeh <soheil@google.com>
    Signed-off-by: Yuchung Cheng <ycheng@google.com>
    Reviewed-by: Eric Dumazet <edumazet@google.com>
    Signed-off-by: David S. Miller <davem@davemloft.net>

commit 3945bbe1525f3c5f6612d8e905760b540b514c49
Author: Masahiro Yamada <yamada.masahiro@socionext.com>
Date:   Mon Nov 27 21:15:13 2017 +0900

    kbuild: move cc-option and cc-disable-warning after incl. arch Makefile
    
    commit cfe17c9bbe6a673fdafdab179c32b355ed447f66 upstream.
    
    Geert reported commit ae6b289a3789 ("kbuild: Set KBUILD_CFLAGS before
    incl. arch Makefile") broke cross-compilation using a cross-compiler
    that supports less compiler options than the host compiler.
    
    For example,
    
      cc1: error: unrecognized command line option "-Wno-unused-but-set-variable"
    
    This problem happens on architectures that setup CROSS_COMPILE in their
    arch/*/Makefile.
    
    Move the cc-option and cc-disable-warning back to the original position,
    but keep the Clang target options untouched.
    
    Fixes: ae6b289a3789 ("kbuild: Set KBUILD_CFLAGS before incl. arch Makefile")
    Reported-by: Geert Uytterhoeven <geert@linux-m68k.org>
    Signed-off-by: Masahiro Yamada <yamada.masahiro@socionext.com>
    Tested-by: Geert Uytterhoeven <geert@linux-m68k.org>
    Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>

commit 9dea9a2ff61c5efb4d4937ae23b14babd25a5547
Author: Tatyana Nikolova <tatyana.e.nikolova@intel.com>
Date:   Mon Mar 12 17:14:02 2018 -0500

    RDMA/core: Do not use invalid destination in determining port reuse
    
    cma_port_is_unique() allows local port reuse if the quad (source
    address and port, destination address and port) for this connection
    is unique. However, if the destination info is zero or unspecified, it
    can't make a correct decision but still allows port reuse. For example,
    sometimes rdma_bind_addr() is called with unspecified destination and
    reusing the port can lead to creating a connection with a duplicate quad,
    after the destination is resolved. The issue manifests when MPI scale-up
    tests hang after the duplicate quad is used.
    
    Set the destination address family and add checks for zero destination
    address and port to prevent source port reuse based on invalid destination.
    
    Fixes: 19b752a19dce ("IB/cma: Allow port reuse for rdma_id")
    Reviewed-by: Sean Hefty <sean.hefty@intel.com>
    Signed-off-by: Tatyana Nikolova <tatyana.e.nikolova@intel.com>
    Signed-off-by: Shiraz Saleem <shiraz.saleem@intel.com>
    Signed-off-by: Doug Ledford <dledford@redhat.com>

commit 01d675f159e0f0792947fb823cf2425da4d747ad
Author: Fabrizio Castro <fabrizio.castro@bp.renesas.com>
Date:   Mon Feb 12 17:44:19 2018 +0000

    ARM: shmobile: rcar-gen2: Add watchdog support
    
    This patch adds watchdog support by installing shmobile_boot_vector_gen2
    to ICRAM1 when enough memory is available, in which case we also keep a
    copy of MPIDR to complete the reset vector logic.
    
    Signed-off-by: Fabrizio Castro <fabrizio.castro@bp.renesas.com>
    Signed-off-by: Ramesh Shanmugasundaram <ramesh.shanmugasundaram@bp.renesas.com>
    Signed-off-by: Simon Horman <horms+renesas@verge.net.au>

commit 6f9e09fd6488de7661ee20efb5d8ab4e05a59735
Author: Arnd Bergmann <arnd@arndb.de>
Date:   Thu Mar 1 14:07:07 2018 +0100

    scsi: mpt3sas: clarify mmio pointer types
    
    The newly added code mixes up phys_addr_t/resource_size_t with dma_addr_t
    and void pointers, as seen from these compiler warning:
    
    drivers/scsi/mpt3sas/mpt3sas_base.c: In function '_base_get_chain_phys':
    drivers/scsi/mpt3sas/mpt3sas_base.c:235:21: error: cast to pointer from integer of different size [-Werror=int-to-pointer-cast]
      base_chain_phys  = (void *)ioc->chip_phys + MPI_FRAME_START_OFFSET +
                         ^
    drivers/scsi/mpt3sas/mpt3sas_base.c: In function '_clone_sg_entries':
    drivers/scsi/mpt3sas/mpt3sas_base.c:427:20: error: cast from pointer to integer of different size [-Werror=pointer-to-int-cast]
        sgel->Address = (dma_addr_t)dst_addr_phys;
                        ^
    drivers/scsi/mpt3sas/mpt3sas_base.c:438:7: error: cast from pointer to integer of different size [-Werror=pointer-to-int-cast]
           (dma_addr_t)buff_ptr_phys;
           ^
    drivers/scsi/mpt3sas/mpt3sas_base.c:444:10: error: cast from pointer to integer of different size [-Werror=pointer-to-int-cast]
              (dma_addr_t)buff_ptr_phys;
    
    Both dma_addr_t and phys_addr_t may be wider than a pointer, so we must
    avoid the conversion to pointer types. This also helps readability.
    
    A second problem is treating MMIO addresses from a 'struct resource'
    as addresses that can be used for DMA on that device. In almost all
    cases, those are the same, but on some of the more obscure architectures,
    PCI memory address 0 is mapped into the CPU address space at a nonzero
    offset. I don't have a good fix for that, so I'm adding a comment here,
    plus a WARN_ON() that triggers whenever the phys_addr_t number is
    outside of the low 32-bit address space and causes a straight overflow
    when assigned to the 32-bit sgel->Address.
    
    Fixes: 182ac784b41f ("scsi: mpt3sas: Introduce Base function for cloning.")
    Signed-off-by: Arnd Bergmann <arnd@arndb.de>
    Acked-by: Sreekanth Reddy <Sreekanth.Reddy@broadcom.com>
    Signed-off-by: Martin K. Petersen <martin.petersen@oracle.com>

commit be631892948060f44b1ceee3132be1266932071e
Author: Priyaranjan Jha <priyarjha@google.com>
Date:   Sun Mar 4 10:38:36 2018 -0800

    tcp: add ca_state stat in SCM_TIMESTAMPING_OPT_STATS
    
    This patch adds TCP_NLA_CA_STATE stat into SCM_TIMESTAMPING_OPT_STATS.
    It reports ca_state of socket, when timestamp is generated.
    
    Signed-off-by: Priyaranjan Jha <priyarjha@google.com>
    Signed-off-by: Neal Cardwell <ncardwell@google.com>
    Signed-off-by: Yuchung Cheng <ycheng@google.com>
    Signed-off-by: Soheil Hassas Yeganeh <soheil@google.com>
    Signed-off-by: David S. Miller <davem@davemloft.net>

commit 87ecc95d81d951b0984f2eb9c5c118cb68d0dce8
Author: Priyaranjan Jha <priyarjha@google.com>
Date:   Sun Mar 4 10:38:35 2018 -0800

    tcp: add send queue size stat in SCM_TIMESTAMPING_OPT_STATS
    
    This patch adds TCP_NLA_SENDQ_SIZE stat into SCM_TIMESTAMPING_OPT_STATS.
    It reports no. of bytes present in send queue, when timestamp is
    generated.
    
    Signed-off-by: Priyaranjan Jha <priyarjha@google.com>
    Signed-off-by: Neal Cardwell <ncardwell@google.com>
    Signed-off-by: Yuchung Cheng <ycheng@google.com>
    Signed-off-by: Soheil Hassas Yeganeh <soheil@google.com>
    Signed-off-by: David S. Miller <davem@davemloft.net>

commit 977eb18fa3de04c84cb30e7a41b17b03bc62f8da
Author: Arnd Bergmann <arnd@arndb.de>
Date:   Fri Feb 16 16:25:53 2018 +0100

    mm: hide a #warning for COMPILE_TEST
    
    [ Upstream commit af27d9403f5b80685b79c88425086edccecaf711 ]
    
    We get a warning about some slow configurations in randconfig kernels:
    
      mm/memory.c:83:2: error: #warning Unfortunate NUMA and NUMA Balancing config, growing page-frame for last_cpupid. [-Werror=cpp]
    
    The warning is reasonable by itself, but gets in the way of randconfig
    build testing, so I'm hiding it whenever CONFIG_COMPILE_TEST is set.
    
    The warning was added in 2013 in commit 75980e97dacc ("mm: fold
    page->_last_nid into page->flags where possible").
    
    Cc: stable@vger.kernel.org
    Signed-off-by: Arnd Bergmann <arnd@arndb.de>
    Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>
    Signed-off-by: Sasha Levin <alexander.levin@microsoft.com>

commit 22d5e20c6a5538ec69b499562299412c1c19291d
Author: James Hogan <jhogan@kernel.org>
Date:   Tue Dec 5 23:31:35 2017 +0000

    lib/mpi: Fix umul_ppmm() for MIPS64r6
    
    
    [ Upstream commit bbc25bee37d2b32cf3a1fab9195b6da3a185614a ]
    
    Current MIPS64r6 toolchains aren't able to generate efficient
    DMULU/DMUHU based code for the C implementation of umul_ppmm(), which
    performs an unsigned 64 x 64 bit multiply and returns the upper and
    lower 64-bit halves of the 128-bit result. Instead it widens the 64-bit
    inputs to 128-bits and emits a __multi3 intrinsic call to perform a 128
    x 128 multiply. This is both inefficient, and it results in a link error
    since we don't include __multi3 in MIPS linux.
    
    For example commit 90a53e4432b1 ("cfg80211: implement regdb signature
    checking") merged in v4.15-rc1 recently broke the 64r6_defconfig and
    64r6el_defconfig builds by indirectly selecting MPILIB. The same build
    errors can be reproduced on older kernels by enabling e.g. CRYPTO_RSA:
    
    lib/mpi/generic_mpih-mul1.o: In function `mpihelp_mul_1':
    lib/mpi/generic_mpih-mul1.c:50: undefined reference to `__multi3'
    lib/mpi/generic_mpih-mul2.o: In function `mpihelp_addmul_1':
    lib/mpi/generic_mpih-mul2.c:49: undefined reference to `__multi3'
    lib/mpi/generic_mpih-mul3.o: In function `mpihelp_submul_1':
    lib/mpi/generic_mpih-mul3.c:49: undefined reference to `__multi3'
    lib/mpi/mpih-div.o In function `mpihelp_divrem':
    lib/mpi/mpih-div.c:205: undefined reference to `__multi3'
    lib/mpi/mpih-div.c:142: undefined reference to `__multi3'
    
    Therefore add an efficient MIPS64r6 implementation of umul_ppmm() using
    inline assembly and the DMULU/DMUHU instructions, to prevent __multi3
    calls being emitted.
    
    Fixes: 7fd08ca58ae6 ("MIPS: Add build support for the MIPS R6 ISA")
    Signed-off-by: James Hogan <jhogan@kernel.org>
    Cc: Ralf Baechle <ralf@linux-mips.org>
    Cc: Herbert Xu <herbert@gondor.apana.org.au>
    Cc: "David S. Miller" <davem@davemloft.net>
    Cc: linux-mips@linux-mips.org
    Cc: linux-crypto@vger.kernel.org
    Signed-off-by: Herbert Xu <herbert@gondor.apana.org.au>
    Signed-off-by: Sasha Levin <alexander.levin@verizon.com>
    Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>

commit d9868db6588f587266d9c112ea14a6c2f89f0f67
Author: James Hogan <jhogan@kernel.org>
Date:   Tue Dec 5 23:31:35 2017 +0000

    lib/mpi: Fix umul_ppmm() for MIPS64r6
    
    
    [ Upstream commit bbc25bee37d2b32cf3a1fab9195b6da3a185614a ]
    
    Current MIPS64r6 toolchains aren't able to generate efficient
    DMULU/DMUHU based code for the C implementation of umul_ppmm(), which
    performs an unsigned 64 x 64 bit multiply and returns the upper and
    lower 64-bit halves of the 128-bit result. Instead it widens the 64-bit
    inputs to 128-bits and emits a __multi3 intrinsic call to perform a 128
    x 128 multiply. This is both inefficient, and it results in a link error
    since we don't include __multi3 in MIPS linux.
    
    For example commit 90a53e4432b1 ("cfg80211: implement regdb signature
    checking") merged in v4.15-rc1 recently broke the 64r6_defconfig and
    64r6el_defconfig builds by indirectly selecting MPILIB. The same build
    errors can be reproduced on older kernels by enabling e.g. CRYPTO_RSA:
    
    lib/mpi/generic_mpih-mul1.o: In function `mpihelp_mul_1':
    lib/mpi/generic_mpih-mul1.c:50: undefined reference to `__multi3'
    lib/mpi/generic_mpih-mul2.o: In function `mpihelp_addmul_1':
    lib/mpi/generic_mpih-mul2.c:49: undefined reference to `__multi3'
    lib/mpi/generic_mpih-mul3.o: In function `mpihelp_submul_1':
    lib/mpi/generic_mpih-mul3.c:49: undefined reference to `__multi3'
    lib/mpi/mpih-div.o In function `mpihelp_divrem':
    lib/mpi/mpih-div.c:205: undefined reference to `__multi3'
    lib/mpi/mpih-div.c:142: undefined reference to `__multi3'
    
    Therefore add an efficient MIPS64r6 implementation of umul_ppmm() using
    inline assembly and the DMULU/DMUHU instructions, to prevent __multi3
    calls being emitted.
    
    Fixes: 7fd08ca58ae6 ("MIPS: Add build support for the MIPS R6 ISA")
    Signed-off-by: James Hogan <jhogan@kernel.org>
    Cc: Ralf Baechle <ralf@linux-mips.org>
    Cc: Herbert Xu <herbert@gondor.apana.org.au>
    Cc: "David S. Miller" <davem@davemloft.net>
    Cc: linux-mips@linux-mips.org
    Cc: linux-crypto@vger.kernel.org
    Signed-off-by: Herbert Xu <herbert@gondor.apana.org.au>
    Signed-off-by: Sasha Levin <alexander.levin@microsoft.com>
    Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>

commit 0db6b1db4f27f1a9f42c37579aee125334ce702e
Author: James Hogan <jhogan@kernel.org>
Date:   Tue Dec 5 23:31:35 2017 +0000

    lib/mpi: Fix umul_ppmm() for MIPS64r6
    
    
    [ Upstream commit bbc25bee37d2b32cf3a1fab9195b6da3a185614a ]
    
    Current MIPS64r6 toolchains aren't able to generate efficient
    DMULU/DMUHU based code for the C implementation of umul_ppmm(), which
    performs an unsigned 64 x 64 bit multiply and returns the upper and
    lower 64-bit halves of the 128-bit result. Instead it widens the 64-bit
    inputs to 128-bits and emits a __multi3 intrinsic call to perform a 128
    x 128 multiply. This is both inefficient, and it results in a link error
    since we don't include __multi3 in MIPS linux.
    
    For example commit 90a53e4432b1 ("cfg80211: implement regdb signature
    checking") merged in v4.15-rc1 recently broke the 64r6_defconfig and
    64r6el_defconfig builds by indirectly selecting MPILIB. The same build
    errors can be reproduced on older kernels by enabling e.g. CRYPTO_RSA:
    
    lib/mpi/generic_mpih-mul1.o: In function `mpihelp_mul_1':
    lib/mpi/generic_mpih-mul1.c:50: undefined reference to `__multi3'
    lib/mpi/generic_mpih-mul2.o: In function `mpihelp_addmul_1':
    lib/mpi/generic_mpih-mul2.c:49: undefined reference to `__multi3'
    lib/mpi/generic_mpih-mul3.o: In function `mpihelp_submul_1':
    lib/mpi/generic_mpih-mul3.c:49: undefined reference to `__multi3'
    lib/mpi/mpih-div.o In function `mpihelp_divrem':
    lib/mpi/mpih-div.c:205: undefined reference to `__multi3'
    lib/mpi/mpih-div.c:142: undefined reference to `__multi3'
    
    Therefore add an efficient MIPS64r6 implementation of umul_ppmm() using
    inline assembly and the DMULU/DMUHU instructions, to prevent __multi3
    calls being emitted.
    
    Fixes: 7fd08ca58ae6 ("MIPS: Add build support for the MIPS R6 ISA")
    Signed-off-by: James Hogan <jhogan@kernel.org>
    Cc: Ralf Baechle <ralf@linux-mips.org>
    Cc: Herbert Xu <herbert@gondor.apana.org.au>
    Cc: "David S. Miller" <davem@davemloft.net>
    Cc: linux-mips@linux-mips.org
    Cc: linux-crypto@vger.kernel.org
    Signed-off-by: Herbert Xu <herbert@gondor.apana.org.au>
    Signed-off-by: Sasha Levin <alexander.levin@microsoft.com>
    Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>

commit faec5f7bcca3a2e81aa7bd8412b22e808df508c3
Author: Alexandre Belloni <alexandre.belloni@bootlin.com>
Date:   Mon Feb 12 23:47:56 2018 +0100

    rtc: tx4939: extend test coverage
    
    The rtc-tx4939 driver now compiles correctly on other architectures, add
    COMPILE_TEST to improve code coverage.
    
    Signed-off-by: Alexandre Belloni <alexandre.belloni@bootlin.com>

commit 53177c75177ecfd71b01da9d5b16ddd1610b1919
Author: Arnd Bergmann <arnd@arndb.de>
Date:   Mon Apr 25 17:35:29 2016 +0200

    gcov: disable for COMPILE_TEST
    
    [ Upstream commit cc622420798c4bcf093785d872525087a7798db9 ]
    
    Enabling gcov is counterproductive to compile testing: it significantly
    increases the kernel image size, compile time, and it produces lots
    of false positive "may be used uninitialized" warnings as the result
    of missed optimizations.
    
    This is in line with how UBSAN_SANITIZE_ALL and PROFILE_ALL_BRANCHES
    work, both of which have similar problems.
    
    With an ARM allmodconfig kernel, I see the build time drop from
    283 minutes CPU time to 225 minutes, and the vmlinux size drops
    from 43MB to 26MB.
    
    Signed-off-by: Arnd Bergmann <arnd@arndb.de>
    Acked-by: Peter Oberparleiter <oberpar@linux.vnet.ibm.com>
    Signed-off-by: Michal Marek <mmarek@suse.com>
    Signed-off-by: Sasha Levin <alexander.levin@microsoft.com>

commit e5747439366c1079257083f231f5dd9a84bf0fd7
Author: Suganath Prabu Subramani <suganath-prabu.subramani@broadcom.com>
Date:   Wed Feb 7 02:51:49 2018 -0800

    scsi: mpt3sas: Introduce function to clone mpi request.
    
    1) Added function _base_clone_mpi_to_sys_mem to clone
    MPI request into system BAR0 mapped region.
    
    2) Separate out MPI Endpoint IO submissions to function
    _base_put_smid_mpi_ep_scsi_io.
    
    3) MPI EP requests are submitted in two 32 bit MMIO writes.
    from _base_mpi_ep_writeq.
    
     For 32 bit Arch,_base_writeq function is identical
    to _base_mpi_ep_writeq, Removed duplicate code as suggested.
    
    Signed-off-by: Suganath Prabu S <suganath-prabu.subramani@broadcom.com>
    Signed-off-by: Martin K. Petersen <martin.petersen@oracle.com>

commit 22ae5a3c2599381cf7aaa5aca25c515a3166adcc
Author: Suganath Prabu Subramani <suganath-prabu.subramani@broadcom.com>
Date:   Wed Feb 7 02:51:47 2018 -0800

    scsi: mpt3sas: Introduce API to get BAR0 mapped buffer address
    
    For MPI Endpoint/Mcpu, driver should double buffer data buffer/SGLs.
    This is normally copied from host to internal memory of IOC by DMA
    engine of PCI device. Since the interface to DMA from host to mCPU is
    not present for Mcpu/MPI Endpoint device, driver does double copy of
    those buffers directly to the mCPU memory region via BAR0 region.
    
    Introduced API to calculate and return BAR0 mapped host buffer's
    physical and virtual address for the provided smid.
    
    Signed-off-by: Suganath Prabu S <suganath-prabu.subramani@broadcom.com>
    Signed-off-by: Martin K. Petersen <martin.petersen@oracle.com>

commit 0448f0195124e33f11d15b7d1e1cab959989eee7
Author: Suganath Prabu Subramani <suganath-prabu.subramani@broadcom.com>
Date:   Wed Feb 7 02:51:46 2018 -0800

    scsi: mpt3sas: Configure reply post queue depth, DMA and sgl tablesize.
    
    This configures shost max sector to 128, single reply descriptor post
    queue, sgl table size to 16 and 32 bit DMA for MPI Endpoint and it
    supports 64K as max IO.
    
    Signed-off-by: Suganath Prabu S <suganath-prabu.subramani@broadcom.com>
    Signed-off-by: Martin K. Petersen <martin.petersen@oracle.com>

commit c520691b38cde1d94f53e5782feba892f5645043
Author: Suganath Prabu Subramani <suganath-prabu.subramani@broadcom.com>
Date:   Wed Feb 7 02:51:45 2018 -0800

    scsi: mpt3sas: Add PCI device ID for Andromeda.
    
    Add device ID and flag for Andromeda/MPI Endpoint.
    
    [mkp: typo]
    
    Signed-off-by: Suganath Prabu S <suganath-prabu.subramani@broadcom.com>
    Signed-off-by: Martin K. Petersen <martin.petersen@oracle.com>

commit c02216acf4177c4411d33735c81cad687790fa59
Author: Arnd Bergmann <arnd@arndb.de>
Date:   Fri Feb 16 16:26:57 2018 +0100

    radeon: hide pointless #warning when compile testing
    
    In randconfig testing, we sometimes get this warning:
    
    drivers/gpu/drm/radeon/radeon_object.c: In function 'radeon_bo_create':
    drivers/gpu/drm/radeon/radeon_object.c:242:2: error: #warning Please enable CONFIG_MTRR and CONFIG_X86_PAT for better performance thanks to write-combining [-Werror=cpp]
     #warning Please enable CONFIG_MTRR and CONFIG_X86_PAT for better performance \
    
    This is rather annoying since almost all other code produces no build-time
    output unless we have found a real bug. We already fixed this in the
    amdgpu driver in commit 31bb90f1cd08 ("drm/amdgpu: shut up #warning for
    compile testing") by adding a CONFIG_COMPILE_TEST check last year and
    agreed to do the same here, but both Michel and I then forgot about it
    until I came across the issue again now.
    
    For stable kernels, as this is one of very few remaining randconfig
    warnings in 4.14.
    
    Cc: stable@vger.kernel.org
    Link: https://patchwork.kernel.org/patch/9550009/
    Signed-off-by: Arnd Bergmann <arnd@arndb.de>
    Signed-off-by: Michel Dnzer <michel.daenzer@amd.com>
    Signed-off-by: Alex Deucher <alexander.deucher@amd.com>

commit 8943c7a18fb7b7b2dde2ffe384c3889372826456
Author: Philipp Zabel <p.zabel@pengutronix.de>
Date:   Tue Dec 19 06:42:32 2017 -0500

    media: imx: allow to build with COMPILE_TEST
    
    Allow building this driver for other platforms under COMPILE_TEST.
    
    Suggested-by: Mauro Carvalho Chehab <mchehab@s-opensource.com>
    Signed-off-by: Philipp Zabel <p.zabel@pengutronix.de>
    Acked-by: Steve Longerbeam <steve_longerbeam@mentor.com>
    Signed-off-by: Hans Verkuil <hans.verkuil@cisco.com>
    Signed-off-by: Mauro Carvalho Chehab <mchehab@s-opensource.com>

commit a22f1d801ad4987508b8c1b701c4926f733ac18b
Author: Thierry Reding <treding@nvidia.com>
Date:   Tue Feb 20 11:29:03 2018 +0100

    drm/pl111: Remove reverse dependency on DRM_DUMB_VGA_DAC
    
    DRM_DUMB_VGA_DAC is a user-visible symbol. Selecting it can cause unmet
    direct dependencies such as this (on i386, randconfig):
    
            warning: (DRM_PL111) selects DRM_DUMB_VGA_DAC which has unmet direct dependencies (HAS_IOMEM && DRM && DRM_BRIDGE && OF)
    
    This is because DRM_DUMB_VGA_DAC depends on OF while DRM_PL111 does not.
    It does indirectly depend on OF via the ARM and ARM64 dependencies, but
    since it can also be enabled under COMPILE_TEST, randconfig can find a
    case where DRM_PL111 is selected without pulling in OF and not meeting
    the dependency for DRM_DUMB_VGA_DAC.
    
    Since select is "heavy handed", DRM_DUMB_VGA_DAC is going to be enabled
    regardless of the above warning and causes the following build error:
    
            ../drivers/gpu/drm/bridge/dumb-vga-dac.c: In function 'dumb_vga_probe':
            ../drivers/gpu/drm/bridge/dumb-vga-dac.c:207:13: error: 'struct drm_bridge' has no member named 'of_node'
              vga->bridge.of_node = pdev->dev.of_node;
    
    See Documentation/kbuild/kconfig-language.txt, "reverse dependencies".
    
    Fixes: 49f81d80ab84 ("drm/pl111: Support handling bridge timings")
    Reported-by: Randy Dunlap <rdunlap@infradead.org>
    Reviewed-by: Eric Anholt <eric@anholt.net>
    Cc: Laurent Pinchart <laurent.pinchart@ideasonboard.com>
    Cc: Archit Taneja <architt@codeaurora.org>
    Cc: Eric Anholt <eric@anholt.net>
    Signed-off-by: Thierry Reding <treding@nvidia.com>
    Signed-off-by: Archit Taneja <archit@cradlewise.com>
    Link: https://patchwork.freedesktop.org/patch/msgid/20180220102903.27787-1-thierry.reding@gmail.com

commit ef3af3465ab4ed02b0d3ca5243752d3ef1d98eda
Author: Arnd Bergmann <arnd@arndb.de>
Date:   Mon Feb 19 11:13:20 2018 +0100

    kasan: rework Kconfig settings
    
    commit e7c52b84fb18f08ce49b6067ae6285aca79084a8 upstream.
    
    We get a lot of very large stack frames using gcc-7.0.1 with the default
    -fsanitize-address-use-after-scope --param asan-stack=1 options, which can
    easily cause an overflow of the kernel stack, e.g.
    
      drivers/gpu/drm/i915/gvt/handlers.c:2434:1: warning: the frame size of 46176 bytes is larger than 3072 bytes
      drivers/net/wireless/ralink/rt2x00/rt2800lib.c:5650:1: warning: the frame size of 23632 bytes is larger than 3072 bytes
      lib/atomic64_test.c:250:1: warning: the frame size of 11200 bytes is larger than 3072 bytes
      drivers/gpu/drm/i915/gvt/handlers.c:2621:1: warning: the frame size of 9208 bytes is larger than 3072 bytes
      drivers/media/dvb-frontends/stv090x.c:3431:1: warning: the frame size of 6816 bytes is larger than 3072 bytes
      fs/fscache/stats.c:287:1: warning: the frame size of 6536 bytes is larger than 3072 bytes
    
    To reduce this risk, -fsanitize-address-use-after-scope is now split out
    into a separate CONFIG_KASAN_EXTRA Kconfig option, leading to stack
    frames that are smaller than 2 kilobytes most of the time on x86_64.  An
    earlier version of this patch also prevented combining KASAN_EXTRA with
    KASAN_INLINE, but that is no longer necessary with gcc-7.0.1.
    
    All patches to get the frame size below 2048 bytes with CONFIG_KASAN=y
    and CONFIG_KASAN_EXTRA=n have been merged by maintainers now, so we can
    bring back that default now.  KASAN_EXTRA=y still causes lots of
    warnings but now defaults to !COMPILE_TEST to disable it in
    allmodconfig, and it remains disabled in all other defconfigs since it
    is a new option.  I arbitrarily raise the warning limit for KASAN_EXTRA
    to 3072 to reduce the noise, but an allmodconfig kernel still has around
    50 warnings on gcc-7.
    
    I experimented a bit more with smaller stack frames and have another
    follow-up series that reduces the warning limit for 64-bit architectures
    to 1280 bytes (without CONFIG_KASAN).
    
    With earlier versions of this patch series, I also had patches to address
    the warnings we get with KASAN and/or KASAN_EXTRA, using a
    "noinline_if_stackbloat" annotation.
    
    That annotation now got replaced with a gcc-8 bugfix (see
    https://gcc.gnu.org/bugzilla/show_bug.cgi?id=81715) and a workaround for
    older compilers, which means that KASAN_EXTRA is now just as bad as
    before and will lead to an instant stack overflow in a few extreme
    cases.
    
    This reverts parts of commit 3f181b4d8652 ("lib/Kconfig.debug: disable
    -Wframe-larger-than warnings with KASAN=y").  Two patches in linux-next
    should be merged first to avoid introducing warnings in an allmodconfig
    build:
      3cd890dbe2a4 ("media: dvb-frontends: fix i2c access helpers for KASAN")
      16c3ada89cff ("media: r820t: fix r820t_write_reg for KASAN")
    
    Do we really need to backport this?
    
    I think we do: without this patch, enabling KASAN will lead to
    unavoidable kernel stack overflow in certain device drivers when built
    with gcc-7 or higher on linux-4.10+ or any version that contains a
    backport of commit c5caf21ab0cf8.  Most people are probably still on
    older compilers, but it will get worse over time as they upgrade their
    distros.
    
    The warnings we get on kernels older than this should all be for code
    that uses dangerously large stack frames, though most of them do not
    cause an actual stack overflow by themselves.The asan-stack option was
    added in linux-4.0, and commit 3f181b4d8652 ("lib/Kconfig.debug:
    disable -Wframe-larger-than warnings with KASAN=y") effectively turned
    off the warning for allmodconfig kernels, so I would like to see this
    fix backported to any kernels later than 4.0.
    
    I have done dozens of fixes for individual functions with stack frames
    larger than 2048 bytes with asan-stack, and I plan to make sure that
    all those fixes make it into the stable kernels as well (most are
    already there).
    
    Part of the complication here is that asan-stack (from 4.0) was
    originally assumed to always require much larger stacks, but that
    turned out to be a combination of multiple gcc bugs that we have now
    worked around and fixed, but sanitize-address-use-after-scope (from
    v4.10) has a much higher inherent stack usage and also suffers from at
    least three other problems that we have analyzed but not yet fixed
    upstream, each of them makes the stack usage more severe than it should
    be.
    
    Link: http://lkml.kernel.org/r/20171221134744.2295529-1-arnd@arndb.de
    Signed-off-by: Arnd Bergmann <arnd@arndb.de>
    Acked-by: Andrey Ryabinin <aryabinin@virtuozzo.com>
    Cc: Mauro Carvalho Chehab <mchehab@kernel.org>
    Cc: Andrey Ryabinin <aryabinin@virtuozzo.com>
    Cc: Alexander Potapenko <glider@google.com>
    Cc: Dmitry Vyukov <dvyukov@google.com>
    Cc: Andrey Konovalov <andreyknvl@google.com>
    Cc: <stable@vger.kernel.org>
    Signed-off-by: Andrew Morton <akpm@linux-foundation.org>
    Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>
    [arnd: rebase to v4.9; only re-enable warning]
    Signed-off-by: Arnd Bergmann <arnd@arndb.de>
    Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>

commit 0ffa39fb594e22e974da2101d92d8967a7777253
Author: Arnd Bergmann <arnd@arndb.de>
Date:   Tue Feb 20 12:55:09 2018 +0100

    kasan: rework Kconfig settings
    
    commit e7c52b84fb18f08ce49b6067ae6285aca79084a8 upstream.
    
    We get a lot of very large stack frames using gcc-7.0.1 with the default
    -fsanitize-address-use-after-scope --param asan-stack=1 options, which can
    easily cause an overflow of the kernel stack, e.g.
    
      drivers/gpu/drm/i915/gvt/handlers.c:2434:1: warning: the frame size of 46176 bytes is larger than 3072 bytes
      drivers/net/wireless/ralink/rt2x00/rt2800lib.c:5650:1: warning: the frame size of 23632 bytes is larger than 3072 bytes
      lib/atomic64_test.c:250:1: warning: the frame size of 11200 bytes is larger than 3072 bytes
      drivers/gpu/drm/i915/gvt/handlers.c:2621:1: warning: the frame size of 9208 bytes is larger than 3072 bytes
      drivers/media/dvb-frontends/stv090x.c:3431:1: warning: the frame size of 6816 bytes is larger than 3072 bytes
      fs/fscache/stats.c:287:1: warning: the frame size of 6536 bytes is larger than 3072 bytes
    
    To reduce this risk, -fsanitize-address-use-after-scope is now split out
    into a separate CONFIG_KASAN_EXTRA Kconfig option, leading to stack
    frames that are smaller than 2 kilobytes most of the time on x86_64.  An
    earlier version of this patch also prevented combining KASAN_EXTRA with
    KASAN_INLINE, but that is no longer necessary with gcc-7.0.1.
    
    All patches to get the frame size below 2048 bytes with CONFIG_KASAN=y
    and CONFIG_KASAN_EXTRA=n have been merged by maintainers now, so we can
    bring back that default now.  KASAN_EXTRA=y still causes lots of
    warnings but now defaults to !COMPILE_TEST to disable it in
    allmodconfig, and it remains disabled in all other defconfigs since it
    is a new option.  I arbitrarily raise the warning limit for KASAN_EXTRA
    to 3072 to reduce the noise, but an allmodconfig kernel still has around
    50 warnings on gcc-7.
    
    I experimented a bit more with smaller stack frames and have another
    follow-up series that reduces the warning limit for 64-bit architectures
    to 1280 bytes (without CONFIG_KASAN).
    
    With earlier versions of this patch series, I also had patches to address
    the warnings we get with KASAN and/or KASAN_EXTRA, using a
    "noinline_if_stackbloat" annotation.
    
    That annotation now got replaced with a gcc-8 bugfix (see
    https://gcc.gnu.org/bugzilla/show_bug.cgi?id=81715) and a workaround for
    older compilers, which means that KASAN_EXTRA is now just as bad as
    before and will lead to an instant stack overflow in a few extreme
    cases.
    
    This reverts parts of commit 3f181b4d8652 ("lib/Kconfig.debug: disable
    -Wframe-larger-than warnings with KASAN=y").  Two patches in linux-next
    should be merged first to avoid introducing warnings in an allmodconfig
    build:
      3cd890dbe2a4 ("media: dvb-frontends: fix i2c access helpers for KASAN")
      16c3ada89cff ("media: r820t: fix r820t_write_reg for KASAN")
    
    Do we really need to backport this?
    
    I think we do: without this patch, enabling KASAN will lead to
    unavoidable kernel stack overflow in certain device drivers when built
    with gcc-7 or higher on linux-4.10+ or any version that contains a
    backport of commit c5caf21ab0cf8.  Most people are probably still on
    older compilers, but it will get worse over time as they upgrade their
    distros.
    
    The warnings we get on kernels older than this should all be for code
    that uses dangerously large stack frames, though most of them do not
    cause an actual stack overflow by themselves.The asan-stack option was
    added in linux-4.0, and commit 3f181b4d8652 ("lib/Kconfig.debug:
    disable -Wframe-larger-than warnings with KASAN=y") effectively turned
    off the warning for allmodconfig kernels, so I would like to see this
    fix backported to any kernels later than 4.0.
    
    I have done dozens of fixes for individual functions with stack frames
    larger than 2048 bytes with asan-stack, and I plan to make sure that
    all those fixes make it into the stable kernels as well (most are
    already there).
    
    Part of the complication here is that asan-stack (from 4.0) was
    originally assumed to always require much larger stacks, but that
    turned out to be a combination of multiple gcc bugs that we have now
    worked around and fixed, but sanitize-address-use-after-scope (from
    v4.10) has a much higher inherent stack usage and also suffers from at
    least three other problems that we have analyzed but not yet fixed
    upstream, each of them makes the stack usage more severe than it should
    be.
    
    Link: http://lkml.kernel.org/r/20171221134744.2295529-1-arnd@arndb.de
    Signed-off-by: Arnd Bergmann <arnd@arndb.de>
    Acked-by: Andrey Ryabinin <aryabinin@virtuozzo.com>
    Cc: Mauro Carvalho Chehab <mchehab@kernel.org>
    Cc: Andrey Ryabinin <aryabinin@virtuozzo.com>
    Cc: Alexander Potapenko <glider@google.com>
    Cc: Dmitry Vyukov <dvyukov@google.com>
    Cc: Andrey Konovalov <andreyknvl@google.com>
    Cc: <stable@vger.kernel.org>
    Signed-off-by: Andrew Morton <akpm@linux-foundation.org>
    Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>
    [arnd: rebase to v4.4; only re-enable warning]
    Signed-off-by: Arnd Bergmann <arnd@arndb.de>
    Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>

commit 65738c6b461a8bb0b056e024299738f7cc9a28b7
Merge: 2bd06ce77ce2 9f416319f40c
Author: Linus Torvalds <torvalds@linux-foundation.org>
Date:   Fri Feb 23 15:01:01 2018 -0800

    Merge tag 'arm64-fixes' of git://git.kernel.org/pub/scm/linux/kernel/git/arm64/linux
    
    Pull arm64 fixes from Catalin Marinas:
     "arm64 and perf fixes:
    
       - build error when accessing MPIDR_HWID_BITMASK from .S
    
       - fix CTR_EL0 field definitions
    
       - remove/disable some kernel messages on user faults (unhandled
         signals, unimplemented syscalls)
    
       - fix kernel page fault in unwind_frame() with function graph tracing
    
       - fix perf sleeping while atomic errors when booting with ACPI"
    
    * tag 'arm64-fixes' of git://git.kernel.org/pub/scm/linux/kernel/git/arm64/linux:
      arm64: fix unwind_frame() for filtered out fn for function graph tracing
      arm64: Enforce BBM for huge IO/VMAP mappings
      arm64: perf: correct PMUVer probing
      arm_pmu: acpi: request IRQs up-front
      arm_pmu: note IRQs and PMUs per-cpu
      arm_pmu: explicitly enable/disable SPIs at hotplug
      arm_pmu: acpi: check for mismatched PPIs
      arm_pmu: add armpmu_alloc_atomic()
      arm_pmu: fold platform helpers into platform code
      arm_pmu: kill arm_pmu_platdata
      ARM: ux500: remove PMU IRQ bouncer
      arm64: __show_regs: Only resolve kernel symbols when running at EL1
      arm64: Remove unimplemented syscall log message
      arm64: Disable unhandled signal log messages by default
      arm64: cpufeature: Fix CTR_EL0 field definitions
      arm64: uaccess: Formalise types for access_ok()
      arm64: Fix compilation error while accessing MPIDR_HWID_BITMASK from .S files

commit 6d046d9e75af120ce704f8d354d960bd0ad403ad
Author: Arnd Bergmann <arnd@arndb.de>
Date:   Fri Feb 16 16:25:53 2018 +0100

    mm: hide a #warning for COMPILE_TEST
    
    commit af27d9403f5b80685b79c88425086edccecaf711 upstream.
    
    We get a warning about some slow configurations in randconfig kernels:
    
      mm/memory.c:83:2: error: #warning Unfortunate NUMA and NUMA Balancing config, growing page-frame for last_cpupid. [-Werror=cpp]
    
    The warning is reasonable by itself, but gets in the way of randconfig
    build testing, so I'm hiding it whenever CONFIG_COMPILE_TEST is set.
    
    The warning was added in 2013 in commit 75980e97dacc ("mm: fold
    page->_last_nid into page->flags where possible").
    
    Cc: stable@vger.kernel.org
    Signed-off-by: Arnd Bergmann <arnd@arndb.de>
    Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>
    Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>

commit 7318454518ad56ad38b60dbb3d185fd14d0d0b93
Author: Arnd Bergmann <arnd@arndb.de>
Date:   Fri Feb 16 16:25:53 2018 +0100

    mm: hide a #warning for COMPILE_TEST
    
    commit af27d9403f5b80685b79c88425086edccecaf711 upstream.
    
    We get a warning about some slow configurations in randconfig kernels:
    
      mm/memory.c:83:2: error: #warning Unfortunate NUMA and NUMA Balancing config, growing page-frame for last_cpupid. [-Werror=cpp]
    
    The warning is reasonable by itself, but gets in the way of randconfig
    build testing, so I'm hiding it whenever CONFIG_COMPILE_TEST is set.
    
    The warning was added in 2013 in commit 75980e97dacc ("mm: fold
    page->_last_nid into page->flags where possible").
    
    Cc: stable@vger.kernel.org
    Signed-off-by: Arnd Bergmann <arnd@arndb.de>
    Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>
    Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>

commit 568c61facce6b0bddbfa04ec634b34904c6e2f1c
Author: Arnd Bergmann <arnd@arndb.de>
Date:   Fri Feb 16 16:25:53 2018 +0100

    mm: hide a #warning for COMPILE_TEST
    
    commit af27d9403f5b80685b79c88425086edccecaf711 upstream.
    
    We get a warning about some slow configurations in randconfig kernels:
    
      mm/memory.c:83:2: error: #warning Unfortunate NUMA and NUMA Balancing config, growing page-frame for last_cpupid. [-Werror=cpp]
    
    The warning is reasonable by itself, but gets in the way of randconfig
    build testing, so I'm hiding it whenever CONFIG_COMPILE_TEST is set.
    
    The warning was added in 2013 in commit 75980e97dacc ("mm: fold
    page->_last_nid into page->flags where possible").
    
    Cc: stable@vger.kernel.org
    Signed-off-by: Arnd Bergmann <arnd@arndb.de>
    Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>
    Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>

commit 327b199512b4c4b7bc7375604f1b6d050fec881e
Author: Arnd Bergmann <arnd@arndb.de>
Date:   Fri Feb 16 16:25:53 2018 +0100

    mm: hide a #warning for COMPILE_TEST
    
    commit af27d9403f5b80685b79c88425086edccecaf711 upstream.
    
    We get a warning about some slow configurations in randconfig kernels:
    
      mm/memory.c:83:2: error: #warning Unfortunate NUMA and NUMA Balancing config, growing page-frame for last_cpupid. [-Werror=cpp]
    
    The warning is reasonable by itself, but gets in the way of randconfig
    build testing, so I'm hiding it whenever CONFIG_COMPILE_TEST is set.
    
    The warning was added in 2013 in commit 75980e97dacc ("mm: fold
    page->_last_nid into page->flags where possible").
    
    Cc: stable@vger.kernel.org
    Signed-off-by: Arnd Bergmann <arnd@arndb.de>
    Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>
    Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>

commit 7ed1c1901fe52e6c5828deb155920b44b0adabb1
Author: Martin Kelly <martin@martingkelly.com>
Date:   Wed Feb 21 14:45:12 2018 -0800

    tools: fix cross-compile var clobbering
    
    Currently a number of Makefiles break when used with toolchains that
    pass extra flags in CC and other cross-compile related variables (such
    as --sysroot).
    
    Thus we get this error when we use a toolchain that puts --sysroot in
    the CC var:
    
      ~/src/linux/tools$ make iio
      [snip]
      iio_event_monitor.c:18:10: fatal error: unistd.h: No such file or directory
        #include <unistd.h>
                 ^~~~~~~~~~
    
    This occurs because we clobber several env vars related to
    cross-compiling with lines like this:
    
      CC = $(CROSS_COMPILE)gcc
    
    Although this will point to a valid cross-compiler, we lose any extra
    flags that might exist in the CC variable, which can break toolchains
    that rely on them (for example, those that use --sysroot).
    
    This easily shows up using a Yocto SDK:
    
      $ . [snip]/sdk/environment-setup-cortexa8hf-neon-poky-linux-gnueabi
    
      $ echo $CC
      arm-poky-linux-gnueabi-gcc -march=armv7-a -mfpu=neon -mfloat-abi=hard
      -mcpu=cortex-a8
      --sysroot=[snip]/sdk/sysroots/cortexa8hf-neon-poky-linux-gnueabi
    
      $ echo $CROSS_COMPILE
      arm-poky-linux-gnueabi-
    
      $ echo ${CROSS_COMPILE}gcc
      krm-poky-linux-gnueabi-gcc
    
    Although arm-poky-linux-gnueabi-gcc is a cross-compiler, we've lost the
    --sysroot and other flags that enable us to find the right libraries to
    link against, so we can't find unistd.h and other libraries and headers.
    Normally with the --sysroot flag we would find unistd.h in the sdk
    directory in the sysroot:
    
      $ find [snip]/sdk/sysroots -path '*/usr/include/unistd.h'
      [snip]/sdk/sysroots/cortexa8hf-neon-poky-linux-gnueabi/usr/include/unistd.h
    
    The perf Makefile adds CC = $(CROSS_COMPILE)gcc if and only if CC is not
    already set, and it compiles correctly with the above toolchain.
    
    So, generalize the logic that perf uses in the common Makefile and
    remove the manual CC = $(CROSS_COMPILE)gcc lines from each Makefile.
    
    Note that this patch does not fix cross-compile for all the tools (some
    have other bugs), but it does fix it for all except usb and acpi, which
    still have other unrelated issues.
    
    I tested both with and without the patch on native and cross-build and
    there appear to be no regressions.
    
    Link: http://lkml.kernel.org/r/20180107214028.23771-1-martin@martingkelly.com
    Signed-off-by: Martin Kelly <martin@martingkelly.com>
    Acked-by: Mark Brown <broonie@kernel.org>
    Cc: Tejun Heo <tj@kernel.org>
    Cc: Li Zefan <lizefan@huawei.com>
    Cc: Johannes Weiner <hannes@cmpxchg.org>
    Cc: Linus Walleij <linus.walleij@linaro.org>
    Cc: "K. Y. Srinivasan" <kys@microsoft.com>
    Cc: Haiyang Zhang <haiyangz@microsoft.com>
    Cc: Stephen Hemminger <sthemmin@microsoft.com>
    Cc: Jonathan Cameron <jic23@kernel.org>
    Cc: Pali Rohar <pali.rohar@gmail.com>
    Cc: Richard Purdie <rpurdie@rpsys.net>
    Cc: Jacek Anaszewski <jacek.anaszewski@gmail.com>
    Cc: Pavel Machek <pavel@ucw.cz>
    Cc: Peter Zijlstra <peterz@infradead.org>
    Cc: Ingo Molnar <mingo@redhat.com>
    Cc: Arnaldo Carvalho de Melo <acme@kernel.org>
    Cc: Robert Moore <robert.moore@intel.com>
    Cc: Lv Zheng <lv.zheng@intel.com>
    Cc: "Rafael J. Wysocki" <rafael.j.wysocki@intel.com>
    Cc: Greg Kroah-Hartman <gregkh@linuxfoundation.org>
    Cc: Valentina Manea <valentina.manea.m@gmail.com>
    Cc: Shuah Khan <shuah@kernel.org>
    Cc: Mario Limonciello <mario.limonciello@dell.com>
    Signed-off-by: Andrew Morton <akpm@linux-foundation.org>
    Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>

commit 04c4927359b1f09310bfee92e7187c9022be3e00
Author: Bhupesh Sharma <bhsharma@redhat.com>
Date:   Mon Feb 19 12:09:54 2018 +0530

    arm64: Fix compilation error while accessing MPIDR_HWID_BITMASK from .S files
    
    Since commit e1a50de37860 (arm64: cputype: Silence Sparse warnings),
    compilation of arm64 architecture is broken with the following error
    messages:
    
      AR      arch/arm64/kernel/built-in.o
      arch/arm64/kernel/head.S: Assembler messages:
      arch/arm64/kernel/head.S:677: Error: found 'L', expected: ')'
      arch/arm64/kernel/head.S:677: Error: found 'L', expected: ')'
      arch/arm64/kernel/head.S:677: Error: found 'L', expected: ')'
      arch/arm64/kernel/head.S:677: Error: junk at end of line, first
      unrecognized character is `L'
      arch/arm64/kernel/head.S:677: Error: unexpected characters following
      instruction at operand 2 -- `movz x1,:abs_g1_s:0xff00ffffffUL'
      arch/arm64/kernel/head.S:677: Error: unexpected characters following
      instruction at operand 2 -- `movk x1,:abs_g0_nc:0xff00ffffffUL'
    
    This patch fixes the same by using the UL() macro correctly for
    assigning the MPIDR_HWID_BITMASK macro value.
    
    Fixes: e1a50de37860 ("arm64: cputype: Silence Sparse warnings")
    Acked-by: Arnd Bergmann <arnd@arndb.de>
    Acked-by: Robin Murphy <robin.murphy@arm.com>
    Signed-off-by: Bhupesh Sharma <bhsharma@redhat.com>
    Signed-off-by: Catalin Marinas <catalin.marinas@arm.com>

commit e1a50de37860b3a93a9d643b09638db5aff47650
Author: Robin Murphy <robin.murphy@arm.com>
Date:   Fri Feb 16 17:04:23 2018 +0000

    arm64: cputype: Silence Sparse warnings
    
    Sparse makes a fair bit of noise about our MPIDR mask being implicitly
    long - let's explicitly describe it as such rather than just relying on
    the value forcing automatic promotion.
    
    Signed-off-by: Robin Murphy <robin.murphy@arm.com>
    Signed-off-by: Catalin Marinas <catalin.marinas@arm.com>

commit 062cd3463c176c71d23e6ca92cda76500ad158d3
Author: Arnd Bergmann <arnd@arndb.de>
Date:   Tue Feb 6 15:41:41 2018 -0800

    kasan: rework Kconfig settings
    
    commit e7c52b84fb18f08ce49b6067ae6285aca79084a8 upstream.
    
    We get a lot of very large stack frames using gcc-7.0.1 with the default
    -fsanitize-address-use-after-scope --param asan-stack=1 options, which can
    easily cause an overflow of the kernel stack, e.g.
    
      drivers/gpu/drm/i915/gvt/handlers.c:2434:1: warning: the frame size of 46176 bytes is larger than 3072 bytes
      drivers/net/wireless/ralink/rt2x00/rt2800lib.c:5650:1: warning: the frame size of 23632 bytes is larger than 3072 bytes
      lib/atomic64_test.c:250:1: warning: the frame size of 11200 bytes is larger than 3072 bytes
      drivers/gpu/drm/i915/gvt/handlers.c:2621:1: warning: the frame size of 9208 bytes is larger than 3072 bytes
      drivers/media/dvb-frontends/stv090x.c:3431:1: warning: the frame size of 6816 bytes is larger than 3072 bytes
      fs/fscache/stats.c:287:1: warning: the frame size of 6536 bytes is larger than 3072 bytes
    
    To reduce this risk, -fsanitize-address-use-after-scope is now split out
    into a separate CONFIG_KASAN_EXTRA Kconfig option, leading to stack
    frames that are smaller than 2 kilobytes most of the time on x86_64.  An
    earlier version of this patch also prevented combining KASAN_EXTRA with
    KASAN_INLINE, but that is no longer necessary with gcc-7.0.1.
    
    All patches to get the frame size below 2048 bytes with CONFIG_KASAN=y
    and CONFIG_KASAN_EXTRA=n have been merged by maintainers now, so we can
    bring back that default now.  KASAN_EXTRA=y still causes lots of
    warnings but now defaults to !COMPILE_TEST to disable it in
    allmodconfig, and it remains disabled in all other defconfigs since it
    is a new option.  I arbitrarily raise the warning limit for KASAN_EXTRA
    to 3072 to reduce the noise, but an allmodconfig kernel still has around
    50 warnings on gcc-7.
    
    I experimented a bit more with smaller stack frames and have another
    follow-up series that reduces the warning limit for 64-bit architectures
    to 1280 bytes (without CONFIG_KASAN).
    
    With earlier versions of this patch series, I also had patches to address
    the warnings we get with KASAN and/or KASAN_EXTRA, using a
    "noinline_if_stackbloat" annotation.
    
    That annotation now got replaced with a gcc-8 bugfix (see
    https://gcc.gnu.org/bugzilla/show_bug.cgi?id=81715) and a workaround for
    older compilers, which means that KASAN_EXTRA is now just as bad as
    before and will lead to an instant stack overflow in a few extreme
    cases.
    
    This reverts parts of commit 3f181b4d8652 ("lib/Kconfig.debug: disable
    -Wframe-larger-than warnings with KASAN=y").  Two patches in linux-next
    should be merged first to avoid introducing warnings in an allmodconfig
    build:
      3cd890dbe2a4 ("media: dvb-frontends: fix i2c access helpers for KASAN")
      16c3ada89cff ("media: r820t: fix r820t_write_reg for KASAN")
    
    Do we really need to backport this?
    
    I think we do: without this patch, enabling KASAN will lead to
    unavoidable kernel stack overflow in certain device drivers when built
    with gcc-7 or higher on linux-4.10+ or any version that contains a
    backport of commit c5caf21ab0cf8.  Most people are probably still on
    older compilers, but it will get worse over time as they upgrade their
    distros.
    
    The warnings we get on kernels older than this should all be for code
    that uses dangerously large stack frames, though most of them do not
    cause an actual stack overflow by themselves.The asan-stack option was
    added in linux-4.0, and commit 3f181b4d8652 ("lib/Kconfig.debug:
    disable -Wframe-larger-than warnings with KASAN=y") effectively turned
    off the warning for allmodconfig kernels, so I would like to see this
    fix backported to any kernels later than 4.0.
    
    I have done dozens of fixes for individual functions with stack frames
    larger than 2048 bytes with asan-stack, and I plan to make sure that
    all those fixes make it into the stable kernels as well (most are
    already there).
    
    Part of the complication here is that asan-stack (from 4.0) was
    originally assumed to always require much larger stacks, but that
    turned out to be a combination of multiple gcc bugs that we have now
    worked around and fixed, but sanitize-address-use-after-scope (from
    v4.10) has a much higher inherent stack usage and also suffers from at
    least three other problems that we have analyzed but not yet fixed
    upstream, each of them makes the stack usage more severe than it should
    be.
    
    Link: http://lkml.kernel.org/r/20171221134744.2295529-1-arnd@arndb.de
    Signed-off-by: Arnd Bergmann <arnd@arndb.de>
    Acked-by: Andrey Ryabinin <aryabinin@virtuozzo.com>
    Cc: Mauro Carvalho Chehab <mchehab@kernel.org>
    Cc: Andrey Ryabinin <aryabinin@virtuozzo.com>
    Cc: Alexander Potapenko <glider@google.com>
    Cc: Dmitry Vyukov <dvyukov@google.com>
    Cc: Andrey Konovalov <andreyknvl@google.com>
    Signed-off-by: Andrew Morton <akpm@linux-foundation.org>
    Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>
    Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>

commit 8caab9edccf57540770352825f9d3fa2d8343ae2
Author: Matt Redfearn <matt.redfearn@mips.com>
Date:   Tue Nov 14 10:52:54 2017 +0000

    watchdog: indydog: Add dependency on SGI_HAS_INDYDOG
    
    commit 24f8d233074badd4c18e4dafd2fb97d65838afed upstream.
    
    Commit da2a68b3eb47 ("watchdog: Enable COMPILE_TEST where possible")
    enabled building the Indy watchdog driver when COMPILE_TEST is enabled.
    However, the driver makes reference to symbols that are only defined for
    certain platforms are selected in the config. These platforms select
    SGI_HAS_INDYDOG. Without this, link time errors result, for example
    when building a MIPS allyesconfig.
    
    drivers/watchdog/indydog.o: In function `indydog_write':
    indydog.c:(.text+0x18): undefined reference to `sgimc'
    indydog.c:(.text+0x1c): undefined reference to `sgimc'
    drivers/watchdog/indydog.o: In function `indydog_start':
    indydog.c:(.text+0x54): undefined reference to `sgimc'
    indydog.c:(.text+0x58): undefined reference to `sgimc'
    drivers/watchdog/indydog.o: In function `indydog_stop':
    indydog.c:(.text+0xa4): undefined reference to `sgimc'
    drivers/watchdog/indydog.o:indydog.c:(.text+0xa8): more undefined
    references to `sgimc' follow
    make: *** [Makefile:1005: vmlinux] Error 1
    
    Fix this by ensuring that CONFIG_INDIDOG can only be selected when the
    necessary dependent platform symbols are built in.
    
    Fixes: da2a68b3eb47 ("watchdog: Enable COMPILE_TEST where possible")
    Signed-off-by: Matt Redfearn <matt.redfearn@mips.com>
    Signed-off-by: Ralf Baechle <ralf@linux-mips.org>
    Suggested-by: James Hogan <james.hogan@mips.com>
    Reviewed-by: Guenter Roeck <linux@roeck-us.net>
    Signed-off-by: Guenter Roeck <linux@roeck-us.net>
    Signed-off-by: Wim Van Sebroeck <wim@iguana.be>
    Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>

commit b6de976631b2809ad70c412fb791fc13e531e9ee
Author: Arnd Bergmann <arnd@arndb.de>
Date:   Tue Feb 6 15:41:41 2018 -0800

    kasan: rework Kconfig settings
    
    commit e7c52b84fb18f08ce49b6067ae6285aca79084a8 upstream.
    
    We get a lot of very large stack frames using gcc-7.0.1 with the default
    -fsanitize-address-use-after-scope --param asan-stack=1 options, which can
    easily cause an overflow of the kernel stack, e.g.
    
      drivers/gpu/drm/i915/gvt/handlers.c:2434:1: warning: the frame size of 46176 bytes is larger than 3072 bytes
      drivers/net/wireless/ralink/rt2x00/rt2800lib.c:5650:1: warning: the frame size of 23632 bytes is larger than 3072 bytes
      lib/atomic64_test.c:250:1: warning: the frame size of 11200 bytes is larger than 3072 bytes
      drivers/gpu/drm/i915/gvt/handlers.c:2621:1: warning: the frame size of 9208 bytes is larger than 3072 bytes
      drivers/media/dvb-frontends/stv090x.c:3431:1: warning: the frame size of 6816 bytes is larger than 3072 bytes
      fs/fscache/stats.c:287:1: warning: the frame size of 6536 bytes is larger than 3072 bytes
    
    To reduce this risk, -fsanitize-address-use-after-scope is now split out
    into a separate CONFIG_KASAN_EXTRA Kconfig option, leading to stack
    frames that are smaller than 2 kilobytes most of the time on x86_64.  An
    earlier version of this patch also prevented combining KASAN_EXTRA with
    KASAN_INLINE, but that is no longer necessary with gcc-7.0.1.
    
    All patches to get the frame size below 2048 bytes with CONFIG_KASAN=y
    and CONFIG_KASAN_EXTRA=n have been merged by maintainers now, so we can
    bring back that default now.  KASAN_EXTRA=y still causes lots of
    warnings but now defaults to !COMPILE_TEST to disable it in
    allmodconfig, and it remains disabled in all other defconfigs since it
    is a new option.  I arbitrarily raise the warning limit for KASAN_EXTRA
    to 3072 to reduce the noise, but an allmodconfig kernel still has around
    50 warnings on gcc-7.
    
    I experimented a bit more with smaller stack frames and have another
    follow-up series that reduces the warning limit for 64-bit architectures
    to 1280 bytes (without CONFIG_KASAN).
    
    With earlier versions of this patch series, I also had patches to address
    the warnings we get with KASAN and/or KASAN_EXTRA, using a
    "noinline_if_stackbloat" annotation.
    
    That annotation now got replaced with a gcc-8 bugfix (see
    https://gcc.gnu.org/bugzilla/show_bug.cgi?id=81715) and a workaround for
    older compilers, which means that KASAN_EXTRA is now just as bad as
    before and will lead to an instant stack overflow in a few extreme
    cases.
    
    This reverts parts of commit 3f181b4d8652 ("lib/Kconfig.debug: disable
    -Wframe-larger-than warnings with KASAN=y").  Two patches in linux-next
    should be merged first to avoid introducing warnings in an allmodconfig
    build:
      3cd890dbe2a4 ("media: dvb-frontends: fix i2c access helpers for KASAN")
      16c3ada89cff ("media: r820t: fix r820t_write_reg for KASAN")
    
    Do we really need to backport this?
    
    I think we do: without this patch, enabling KASAN will lead to
    unavoidable kernel stack overflow in certain device drivers when built
    with gcc-7 or higher on linux-4.10+ or any version that contains a
    backport of commit c5caf21ab0cf8.  Most people are probably still on
    older compilers, but it will get worse over time as they upgrade their
    distros.
    
    The warnings we get on kernels older than this should all be for code
    that uses dangerously large stack frames, though most of them do not
    cause an actual stack overflow by themselves.The asan-stack option was
    added in linux-4.0, and commit 3f181b4d8652 ("lib/Kconfig.debug:
    disable -Wframe-larger-than warnings with KASAN=y") effectively turned
    off the warning for allmodconfig kernels, so I would like to see this
    fix backported to any kernels later than 4.0.
    
    I have done dozens of fixes for individual functions with stack frames
    larger than 2048 bytes with asan-stack, and I plan to make sure that
    all those fixes make it into the stable kernels as well (most are
    already there).
    
    Part of the complication here is that asan-stack (from 4.0) was
    originally assumed to always require much larger stacks, but that
    turned out to be a combination of multiple gcc bugs that we have now
    worked around and fixed, but sanitize-address-use-after-scope (from
    v4.10) has a much higher inherent stack usage and also suffers from at
    least three other problems that we have analyzed but not yet fixed
    upstream, each of them makes the stack usage more severe than it should
    be.
    
    Link: http://lkml.kernel.org/r/20171221134744.2295529-1-arnd@arndb.de
    Signed-off-by: Arnd Bergmann <arnd@arndb.de>
    Acked-by: Andrey Ryabinin <aryabinin@virtuozzo.com>
    Cc: Mauro Carvalho Chehab <mchehab@kernel.org>
    Cc: Andrey Ryabinin <aryabinin@virtuozzo.com>
    Cc: Alexander Potapenko <glider@google.com>
    Cc: Dmitry Vyukov <dvyukov@google.com>
    Cc: Andrey Konovalov <andreyknvl@google.com>
    Signed-off-by: Andrew Morton <akpm@linux-foundation.org>
    Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>
    Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>

commit e4fb3fda25d6935a78ec4ed57b89a299e238c917
Author: Matt Redfearn <matt.redfearn@mips.com>
Date:   Tue Nov 14 10:52:54 2017 +0000

    watchdog: indydog: Add dependency on SGI_HAS_INDYDOG
    
    commit 24f8d233074badd4c18e4dafd2fb97d65838afed upstream.
    
    Commit da2a68b3eb47 ("watchdog: Enable COMPILE_TEST where possible")
    enabled building the Indy watchdog driver when COMPILE_TEST is enabled.
    However, the driver makes reference to symbols that are only defined for
    certain platforms are selected in the config. These platforms select
    SGI_HAS_INDYDOG. Without this, link time errors result, for example
    when building a MIPS allyesconfig.
    
    drivers/watchdog/indydog.o: In function `indydog_write':
    indydog.c:(.text+0x18): undefined reference to `sgimc'
    indydog.c:(.text+0x1c): undefined reference to `sgimc'
    drivers/watchdog/indydog.o: In function `indydog_start':
    indydog.c:(.text+0x54): undefined reference to `sgimc'
    indydog.c:(.text+0x58): undefined reference to `sgimc'
    drivers/watchdog/indydog.o: In function `indydog_stop':
    indydog.c:(.text+0xa4): undefined reference to `sgimc'
    drivers/watchdog/indydog.o:indydog.c:(.text+0xa8): more undefined
    references to `sgimc' follow
    make: *** [Makefile:1005: vmlinux] Error 1
    
    Fix this by ensuring that CONFIG_INDIDOG can only be selected when the
    necessary dependent platform symbols are built in.
    
    Fixes: da2a68b3eb47 ("watchdog: Enable COMPILE_TEST where possible")
    Signed-off-by: Matt Redfearn <matt.redfearn@mips.com>
    Signed-off-by: Ralf Baechle <ralf@linux-mips.org>
    Suggested-by: James Hogan <james.hogan@mips.com>
    Reviewed-by: Guenter Roeck <linux@roeck-us.net>
    Signed-off-by: Guenter Roeck <linux@roeck-us.net>
    Signed-off-by: Wim Van Sebroeck <wim@iguana.be>
    Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>

commit af27d9403f5b80685b79c88425086edccecaf711
Author: Arnd Bergmann <arnd@arndb.de>
Date:   Fri Feb 16 16:25:53 2018 +0100

    mm: hide a #warning for COMPILE_TEST
    
    We get a warning about some slow configurations in randconfig kernels:
    
      mm/memory.c:83:2: error: #warning Unfortunate NUMA and NUMA Balancing config, growing page-frame for last_cpupid. [-Werror=cpp]
    
    The warning is reasonable by itself, but gets in the way of randconfig
    build testing, so I'm hiding it whenever CONFIG_COMPILE_TEST is set.
    
    The warning was added in 2013 in commit 75980e97dacc ("mm: fold
    page->_last_nid into page->flags where possible").
    
    Cc: stable@vger.kernel.org
    Signed-off-by: Arnd Bergmann <arnd@arndb.de>
    Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>

commit 16d3d10d29f753d0247d94f5e889e93dd13f56bb
Author: Liu, Changcheng <changcheng.liu@intel.com>
Date:   Thu Dec 14 15:32:48 2017 -0800

    scripts/faddr2line: fix CROSS_COMPILE unset error
    
    commit 4cc90b4cc3d4955f79eae4f7f9d64e67e17b468e upstream.
    
    faddr2line hit var unbound error when CROSS_COMPILE isn't set since
    nounset option is set in bash script.
    
    Link: http://lkml.kernel.org/r/20171206013022.GA83929@sofia
    Fixes: 95a879825419 ("scripts/faddr2line: extend usage on generic arch")
    Signed-off-by: Liu Changcheng <changcheng.liu@intel.com>
    Reported-by: Richard Weinberger <richard.weinberger@gmail.com>
    Reviewed-by: Richard Weinberger <richard@nod.at>
    Cc: Thomas Gleixner <tglx@linutronix.de>
    Cc: Greg Kroah-Hartman <gregkh@linuxfoundation.org>
    Cc: Philippe Ombredanne <pombredanne@nexb.com>
    Cc: NeilBrown <neilb@suse.com>
    Signed-off-by: Andrew Morton <akpm@linux-foundation.org>
    Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>
    Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>

commit e7c52b84fb18f08ce49b6067ae6285aca79084a8
Author: Arnd Bergmann <arnd@arndb.de>
Date:   Tue Feb 6 15:41:41 2018 -0800

    kasan: rework Kconfig settings
    
    We get a lot of very large stack frames using gcc-7.0.1 with the default
    -fsanitize-address-use-after-scope --param asan-stack=1 options, which can
    easily cause an overflow of the kernel stack, e.g.
    
      drivers/gpu/drm/i915/gvt/handlers.c:2434:1: warning: the frame size of 46176 bytes is larger than 3072 bytes
      drivers/net/wireless/ralink/rt2x00/rt2800lib.c:5650:1: warning: the frame size of 23632 bytes is larger than 3072 bytes
      lib/atomic64_test.c:250:1: warning: the frame size of 11200 bytes is larger than 3072 bytes
      drivers/gpu/drm/i915/gvt/handlers.c:2621:1: warning: the frame size of 9208 bytes is larger than 3072 bytes
      drivers/media/dvb-frontends/stv090x.c:3431:1: warning: the frame size of 6816 bytes is larger than 3072 bytes
      fs/fscache/stats.c:287:1: warning: the frame size of 6536 bytes is larger than 3072 bytes
    
    To reduce this risk, -fsanitize-address-use-after-scope is now split out
    into a separate CONFIG_KASAN_EXTRA Kconfig option, leading to stack
    frames that are smaller than 2 kilobytes most of the time on x86_64.  An
    earlier version of this patch also prevented combining KASAN_EXTRA with
    KASAN_INLINE, but that is no longer necessary with gcc-7.0.1.
    
    All patches to get the frame size below 2048 bytes with CONFIG_KASAN=y
    and CONFIG_KASAN_EXTRA=n have been merged by maintainers now, so we can
    bring back that default now.  KASAN_EXTRA=y still causes lots of
    warnings but now defaults to !COMPILE_TEST to disable it in
    allmodconfig, and it remains disabled in all other defconfigs since it
    is a new option.  I arbitrarily raise the warning limit for KASAN_EXTRA
    to 3072 to reduce the noise, but an allmodconfig kernel still has around
    50 warnings on gcc-7.
    
    I experimented a bit more with smaller stack frames and have another
    follow-up series that reduces the warning limit for 64-bit architectures
    to 1280 bytes (without CONFIG_KASAN).
    
    With earlier versions of this patch series, I also had patches to address
    the warnings we get with KASAN and/or KASAN_EXTRA, using a
    "noinline_if_stackbloat" annotation.
    
    That annotation now got replaced with a gcc-8 bugfix (see
    https://gcc.gnu.org/bugzilla/show_bug.cgi?id=81715) and a workaround for
    older compilers, which means that KASAN_EXTRA is now just as bad as
    before and will lead to an instant stack overflow in a few extreme
    cases.
    
    This reverts parts of commit 3f181b4d8652 ("lib/Kconfig.debug: disable
    -Wframe-larger-than warnings with KASAN=y").  Two patches in linux-next
    should be merged first to avoid introducing warnings in an allmodconfig
    build:
      3cd890dbe2a4 ("media: dvb-frontends: fix i2c access helpers for KASAN")
      16c3ada89cff ("media: r820t: fix r820t_write_reg for KASAN")
    
    Do we really need to backport this?
    
    I think we do: without this patch, enabling KASAN will lead to
    unavoidable kernel stack overflow in certain device drivers when built
    with gcc-7 or higher on linux-4.10+ or any version that contains a
    backport of commit c5caf21ab0cf8.  Most people are probably still on
    older compilers, but it will get worse over time as they upgrade their
    distros.
    
    The warnings we get on kernels older than this should all be for code
    that uses dangerously large stack frames, though most of them do not
    cause an actual stack overflow by themselves.The asan-stack option was
    added in linux-4.0, and commit 3f181b4d8652 ("lib/Kconfig.debug:
    disable -Wframe-larger-than warnings with KASAN=y") effectively turned
    off the warning for allmodconfig kernels, so I would like to see this
    fix backported to any kernels later than 4.0.
    
    I have done dozens of fixes for individual functions with stack frames
    larger than 2048 bytes with asan-stack, and I plan to make sure that
    all those fixes make it into the stable kernels as well (most are
    already there).
    
    Part of the complication here is that asan-stack (from 4.0) was
    originally assumed to always require much larger stacks, but that
    turned out to be a combination of multiple gcc bugs that we have now
    worked around and fixed, but sanitize-address-use-after-scope (from
    v4.10) has a much higher inherent stack usage and also suffers from at
    least three other problems that we have analyzed but not yet fixed
    upstream, each of them makes the stack usage more severe than it should
    be.
    
    Link: http://lkml.kernel.org/r/20171221134744.2295529-1-arnd@arndb.de
    Signed-off-by: Arnd Bergmann <arnd@arndb.de>
    Acked-by: Andrey Ryabinin <aryabinin@virtuozzo.com>
    Cc: Mauro Carvalho Chehab <mchehab@kernel.org>
    Cc: Andrey Ryabinin <aryabinin@virtuozzo.com>
    Cc: Alexander Potapenko <glider@google.com>
    Cc: Dmitry Vyukov <dvyukov@google.com>
    Cc: Andrey Konovalov <andreyknvl@google.com>
    Cc: <stable@vger.kernel.org>
    Signed-off-by: Andrew Morton <akpm@linux-foundation.org>
    Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>

commit 3758d94e951332186183a6e20bfac257183965da
Author: Arnd Bergmann <arnd@arndb.de>
Date:   Mon Apr 25 17:35:29 2016 +0200

    gcov: disable for COMPILE_TEST
    
    commit cc622420798c4bcf093785d872525087a7798db9 upstream.
    
    Enabling gcov is counterproductive to compile testing: it significantly
    increases the kernel image size, compile time, and it produces lots
    of false positive "may be used uninitialized" warnings as the result
    of missed optimizations.
    
    This is in line with how UBSAN_SANITIZE_ALL and PROFILE_ALL_BRANCHES
    work, both of which have similar problems.
    
    With an ARM allmodconfig kernel, I see the build time drop from
    283 minutes CPU time to 225 minutes, and the vmlinux size drops
    from 43MB to 26MB.
    
    Signed-off-by: Arnd Bergmann <arnd@arndb.de>
    Acked-by: Peter Oberparleiter <oberpar@linux.vnet.ibm.com>
    Signed-off-by: Michal Marek <mmarek@suse.com>
    Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>

commit bc4e118355caf83f472a5d31b850e73adddcf0ab
Merge: 1c7385dbf8c5 0f89ffefa4e1
Author: Linus Torvalds <torvalds@linux-foundation.org>
Date:   Mon Jan 29 10:59:24 2018 -0800

    Merge tag 'mfd-next-4.16' of git://git.kernel.org/pub/scm/linux/kernel/git/lee/mfd
    
    Pull MFD updates from Lee Jones:
     "New Drivers:
       - Add support for RAVE Supervisory Processor
    
      Moved drivers:
       - Move Realtek Card Reader Driver to Misc
    
      New Device Support:
       - Add support for Pinctrl to axp20x
    
      New Functionality:
       - Add resume support to atmel-flexcom
    
      Fix-ups:
       - Split MFD (mfd) and userspace handlers (platform) in cros_ec
       - Fix trivial (whitespace, spelling) issue(s) in pcf50633-core
       - Clean-up error handling in ab8500-debugfs
       - General tidying up in tmio_core
       - Kconfig fix-ups for qcom-pm8xxx
       - Licensing changes (SPDX) to stm32-lptimer, stm32-timers
       - Device Tree fixups in mc13xxx
       - Simplify/remove unused code in cros_ec_spi, axp20x, ti_am335x_tscadc,
         kempld-core, intel_soc_pmic_core.c, ab8500-debugfs"
    
    * tag 'mfd-next-4.16' of git://git.kernel.org/pub/scm/linux/kernel/git/lee/mfd: (32 commits)
      mfd: lpc_ich: Do not touch SPI-NOR write protection bit on Apollo Lake
      mfd: axp20x: Mark axp288 CHRG_BAK_CTRL register volatile
      mfd: ab8500: Introduce DEFINE_SHOW_ATTRIBUTE() macro
      atmel_flexcom: Support resuming after a chip reset
      mfd: Remove duplicate includes
      dt-bindings: mfd: mc13xxx: Add the unit address to sysled
      mfd: stm32: Adopt SPDX identifier
      mfd: axp20x: Add pinctrl cell for AXP813
      mfd: pm8xxx: Make elegible for COMPILE_TEST
      mfd: kempld-core: Use resource_size function on resource object
      mfd: tmio: Move register macros to tmio_core.c
      mfd: cros ec: spi: Simplify delay handling between SPI messages
      mfd: palmas: Assign the right powerhold mask for tps65917
      mfd: ab8500-debugfs: Use common error handling code in ab8500_print_modem_registers()
      mfd: ti_am335x_tscadc: Remove redundant assignment to node
      mfd: pcf50633: Fix spelling mistake: 'Falied' -> 'Failed'
      dt-bindings: watchdog: Add bindings for RAVE SP watchdog driver
      watchdog: Add RAVE SP watchdog driver
      mfd: Add driver for RAVE Supervisory Processor
      serdev: Introduce devm_serdev_device_open()
      ...

commit 9c3afb33ae587723d2acda044a352670ec8d5b82
Author: Martin Habets <mhabets@solarflare.com>
Date:   Thu Jan 25 17:24:56 2018 +0000

    sfc: add function to determine which TX timestamping method to use
    
    Use MC capability MC_CMD_GET_CAPABILITIES_V2_OUT_TX_MAC_TIMESTAMPING to
     detect whether the NIC supports timestamping packets sent out the main
     datapath.
    
    Signed-off-by: Martin Habets <mhabets@solarflare.com>
    Signed-off-by: Edward Cree <ecree@solarflare.com>
    Signed-off-by: David S. Miller <davem@davemloft.net>

commit e6c591e7a430197777a6456a3cd2db38fffd7647
Author: Arnd Bergmann <arnd@arndb.de>
Date:   Mon Apr 25 17:35:29 2016 +0200

    gcov: disable for COMPILE_TEST
    
    commit cc622420798c4bcf093785d872525087a7798db9 upstream.
    
    Enabling gcov is counterproductive to compile testing: it significantly
    increases the kernel image size, compile time, and it produces lots
    of false positive "may be used uninitialized" warnings as the result
    of missed optimizations.
    
    This is in line with how UBSAN_SANITIZE_ALL and PROFILE_ALL_BRANCHES
    work, both of which have similar problems.
    
    With an ARM allmodconfig kernel, I see the build time drop from
    283 minutes CPU time to 225 minutes, and the vmlinux size drops
    from 43MB to 26MB.
    
    Signed-off-by: Arnd Bergmann <arnd@arndb.de>
    Acked-by: Peter Oberparleiter <oberpar@linux.vnet.ibm.com>
    Signed-off-by: Michal Marek <mmarek@suse.com>
    Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>

commit 22079ee4501d99492b34482a555f90e6bf39590f
Merge: 852b0a89026f 36c1681678b5
Author: Linus Torvalds <torvalds@linux-foundation.org>
Date:   Sat Jan 13 13:24:56 2018 -0800

    Merge tag 'kbuild-fixes-v4.15' of git://git.kernel.org/pub/scm/linux/kernel/git/masahiroy/linux-kbuild
    
    Pull Kbuild fixes from Masahiro Yamada:
    
     - fix cross-compilation for architectures that setup CROSS_COMPILE in
       their arch Makefile
    
     - fix Kconfig rational operators for bool / tristate
    
     - drop a gperf-generated file from .gitignore
    
    * tag 'kbuild-fixes-v4.15' of git://git.kernel.org/pub/scm/linux/kernel/git/masahiroy/linux-kbuild:
      genksyms: drop *.hash.c from .gitignore
      kconfig: fix relational operators for bool and tristate symbols
      kbuild: move cc-option and cc-disable-warning after incl. arch Makefile

commit 67549d46d42eed58731028bebe304bc8cbd7af01
Merge: 02776b9b5399 541676078b52
Author: Linus Torvalds <torvalds@linux-foundation.org>
Date:   Fri Jan 12 10:23:59 2018 -0800

    Merge branch 'sched-urgent-for-linus' of git://git.kernel.org/pub/scm/linux/kernel/git/tip/tip
    
    Pull scheduler fixes from Ingo Molnar:
     "A Kconfig fix, a build fix and a membarrier bug fix"
    
    * 'sched-urgent-for-linus' of git://git.kernel.org/pub/scm/linux/kernel/git/tip/tip:
      membarrier: Disable preemption when calling smp_call_function_many()
      sched/isolation: Make CONFIG_CPU_ISOLATION=y depend on SMP or COMPILE_TEST
      ia64, sched/cputime: Fix build error if CONFIG_VIRT_CPU_ACCOUNTING_NATIVE=y

commit bc27360b3c7aedfc385f7fc0527a42918bdeba51
Author: Sean Wang <sean.wang@mediatek.com>
Date:   Fri Jan 5 16:14:06 2018 +0800

    clk: mediatek: adjust dependency of reset.c to avoid unexpectedly being built
    
    Changes from v1->v2:
    Add 'select RESET_CONTROLLER' under COMMON_CLK_MEDIATEK and enable
    reset.c to be built when COMMON_CLK_MEDIATEK is selected. That should
    be quite reasonable because the reset controller is tightly embedded
    inside and exported from these clock subsystems. At least it can be found
    on infracfg and pericfg subsystem that both are really fundamental block
    lots of devices must depend on.
    
    commit 74cb0d6dde8 ("clk: mediatek: fixup test-building of MediaTek clock
    drivers") can let the build system looking into the directory where the
    clock drivers resides and then allow test-building the drivers.
    
    But the change also gives rise to certain incorrect behavior which is
    reset.c being built even not depending on either COMPILE_TEST or
    ARCH_MEDIATEK alternative dependency. To get rid of reset.c being built
    unexpectedly on the other platforms, it would be a good change that the
    file should be built depending on its own specific configuration rather
    than just on generic RESET_CONTROLLER one.
    
    Signed-off-by: Sean Wang <sean.wang@mediatek.com>
    Cc: Jean Delvare <jdelvare@suse.de>
    Signed-off-by: Stephen Boyd <sboyd@codeaurora.org>

commit 7332dec055f2457c386032f7e9b2991eb05c2a0a
Author: Mel Gorman <mgorman@techsingularity.net>
Date:   Tue Dec 19 08:59:47 2017 +0000

    sched/fair: Only immediately migrate tasks due to interrupts if prev and target CPUs share cache
    
    If waking from an idle CPU due to an interrupt then it's possible that
    the waker task will be pulled to wake on the current CPU. Unfortunately,
    depending on the type of interrupt and IRQ configuration, there may not
    be a strong relationship between the CPU an interrupt was delivered on
    and the CPU a task was running on. For example, the interrupts could all
    be delivered to CPUs on one particular node due to the machine topology
    or IRQ affinity configuration. Another example is an interrupt for an IO
    completion which can be delivered to any CPU where there is no guarantee
    the data is either cache hot or even local.
    
    This patch was motivated by the observation that an IO workload was
    being pulled cross-node on a frequent basis when IO completed.  From a
    wakeup latency perspective, it's still useful to know that an idle CPU is
    immediately available for use but lets only consider an automatic migration
    if the CPUs share cache to limit damage due to NUMA migrations. Migrations
    may still occur if wake_affine_weight determines it's appropriate.
    
    These are the throughput results for dbench running on ext4 comparing
    4.15-rc3 and this patch on a 2-socket machine where interrupts due to IO
    completions can happen on any CPU.
    
                              4.15.0-rc3             4.15.0-rc3
                                 vanilla            lessmigrate
    Hmean     1        854.64 (   0.00%)      865.01 (   1.21%)
    Hmean     2       1229.60 (   0.00%)     1274.44 (   3.65%)
    Hmean     4       1591.81 (   0.00%)     1628.08 (   2.28%)
    Hmean     8       1845.04 (   0.00%)     1831.80 (  -0.72%)
    Hmean     16      2038.61 (   0.00%)     2091.44 (   2.59%)
    Hmean     32      2327.19 (   0.00%)     2430.29 (   4.43%)
    Hmean     64      2570.61 (   0.00%)     2568.54 (  -0.08%)
    Hmean     128     2481.89 (   0.00%)     2499.28 (   0.70%)
    Stddev    1         14.31 (   0.00%)        5.35 (  62.65%)
    Stddev    2         21.29 (   0.00%)       11.09 (  47.92%)
    Stddev    4          7.22 (   0.00%)        6.80 (   5.92%)
    Stddev    8         26.70 (   0.00%)        9.41 (  64.76%)
    Stddev    16        22.40 (   0.00%)       20.01 (  10.70%)
    Stddev    32        45.13 (   0.00%)       44.74 (   0.85%)
    Stddev    64        93.10 (   0.00%)       93.18 (  -0.09%)
    Stddev    128      184.28 (   0.00%)      177.85 (   3.49%)
    
    Note the small increase in throughput for low thread counts but also
    note that the standard deviation for each sample during the test run is
    lower. The throughput figures for dbench can be misleading so the benchmark
    is actually modified to time the latency of the processing of one load
    file with many samples taken. The difference in latency is
    
                               4.15.0-rc3             4.15.0-rc3
                                  vanilla            lessmigrate
    Amean      1         21.71 (   0.00%)       21.47 (   1.08%)
    Amean      2         30.89 (   0.00%)       29.58 (   4.26%)
    Amean      4         47.54 (   0.00%)       46.61 (   1.97%)
    Amean      8         82.71 (   0.00%)       82.81 (  -0.12%)
    Amean      16       149.45 (   0.00%)      145.01 (   2.97%)
    Amean      32       265.49 (   0.00%)      248.43 (   6.42%)
    Amean      64       463.23 (   0.00%)      463.55 (  -0.07%)
    Amean      128      933.97 (   0.00%)      935.50 (  -0.16%)
    Stddev     1          1.58 (   0.00%)        1.54 (   2.26%)
    Stddev     2          2.84 (   0.00%)        2.95 (  -4.15%)
    Stddev     4          6.78 (   0.00%)        6.85 (  -0.99%)
    Stddev     8         16.85 (   0.00%)       16.37 (   2.85%)
    Stddev     16        41.59 (   0.00%)       41.04 (   1.32%)
    Stddev     32       111.05 (   0.00%)      105.11 (   5.35%)
    Stddev     64       285.94 (   0.00%)      288.01 (  -0.72%)
    Stddev     128      803.39 (   0.00%)      809.73 (  -0.79%)
    
    It's a small improvement which is not surprising given that migrations that
    migrate to a different node as not that common. However, it is noticeable
    in the CPU migration statistics which are reduced by 24%.
    
    There was a query for v1 of this patch about NAS so here are the results
    for C-class using MPI for parallelisation on the same machine
    
    nas-mpi
                          4.15.0-rc3             4.15.0-rc3
                             vanilla                  noirq
    Time cg.C       24.25 (   0.00%)       23.17 (   4.45%)
    Time ep.C        8.22 (   0.00%)        8.29 (  -0.85%)
    Time ft.C       22.67 (   0.00%)       20.34 (  10.28%)
    Time is.C        1.42 (   0.00%)        1.47 (  -3.52%)
    Time lu.C       55.62 (   0.00%)       54.81 (   1.46%)
    Time mg.C        7.93 (   0.00%)        7.91 (   0.25%)
    
              4.15.0-rc3  4.15.0-rc3
                 vanilla  noirq-v1r1
    User         3799.96     3748.34
    System        672.10      626.15
    Elapsed        91.91       79.49
    
    lu.C sees a small gain, ft.C a large gain and ep.C and is.C see small
    regressions but in terms of absolute time, the difference is small and
    likely within run-to-run variance. System CPU usage is slightly reduced.
    
    schbench from Facebook was also requested. This is a bit of a mixed bag but
    it's important to note that this workload should not be heavily impacted
    by wakeups from interrupt context.
    
                                     4.15.0-rc3             4.15.0-rc3
                                        vanilla             noirq-v1r1
    Lat 50.00th-qrtle-1        41.00 (   0.00%)       41.00 (   0.00%)
    Lat 75.00th-qrtle-1        42.00 (   0.00%)       42.00 (   0.00%)
    Lat 90.00th-qrtle-1        43.00 (   0.00%)       44.00 (  -2.33%)
    Lat 95.00th-qrtle-1        44.00 (   0.00%)       46.00 (  -4.55%)
    Lat 99.00th-qrtle-1        57.00 (   0.00%)       58.00 (  -1.75%)
    Lat 99.50th-qrtle-1        59.00 (   0.00%)       59.00 (   0.00%)
    Lat 99.90th-qrtle-1        67.00 (   0.00%)       78.00 ( -16.42%)
    Lat 50.00th-qrtle-2        40.00 (   0.00%)       51.00 ( -27.50%)
    Lat 75.00th-qrtle-2        45.00 (   0.00%)       56.00 ( -24.44%)
    Lat 90.00th-qrtle-2        53.00 (   0.00%)       59.00 ( -11.32%)
    Lat 95.00th-qrtle-2        57.00 (   0.00%)       61.00 (  -7.02%)
    Lat 99.00th-qrtle-2        67.00 (   0.00%)       71.00 (  -5.97%)
    Lat 99.50th-qrtle-2        69.00 (   0.00%)       74.00 (  -7.25%)
    Lat 99.90th-qrtle-2        83.00 (   0.00%)       77.00 (   7.23%)
    Lat 50.00th-qrtle-4        51.00 (   0.00%)       51.00 (   0.00%)
    Lat 75.00th-qrtle-4        57.00 (   0.00%)       56.00 (   1.75%)
    Lat 90.00th-qrtle-4        60.00 (   0.00%)       59.00 (   1.67%)
    Lat 95.00th-qrtle-4        62.00 (   0.00%)       62.00 (   0.00%)
    Lat 99.00th-qrtle-4        73.00 (   0.00%)       72.00 (   1.37%)
    Lat 99.50th-qrtle-4        76.00 (   0.00%)       74.00 (   2.63%)
    Lat 99.90th-qrtle-4        85.00 (   0.00%)       78.00 (   8.24%)
    Lat 50.00th-qrtle-8        54.00 (   0.00%)       58.00 (  -7.41%)
    Lat 75.00th-qrtle-8        59.00 (   0.00%)       62.00 (  -5.08%)
    Lat 90.00th-qrtle-8        65.00 (   0.00%)       66.00 (  -1.54%)
    Lat 95.00th-qrtle-8        67.00 (   0.00%)       70.00 (  -4.48%)
    Lat 99.00th-qrtle-8        78.00 (   0.00%)       79.00 (  -1.28%)
    Lat 99.50th-qrtle-8        81.00 (   0.00%)       80.00 (   1.23%)
    Lat 99.90th-qrtle-8       116.00 (   0.00%)       83.00 (  28.45%)
    Lat 50.00th-qrtle-16       65.00 (   0.00%)       64.00 (   1.54%)
    Lat 75.00th-qrtle-16       77.00 (   0.00%)       71.00 (   7.79%)
    Lat 90.00th-qrtle-16       83.00 (   0.00%)       82.00 (   1.20%)
    Lat 95.00th-qrtle-16       87.00 (   0.00%)       87.00 (   0.00%)
    Lat 99.00th-qrtle-16       95.00 (   0.00%)       96.00 (  -1.05%)
    Lat 99.50th-qrtle-16       99.00 (   0.00%)      103.00 (  -4.04%)
    Lat 99.90th-qrtle-16      104.00 (   0.00%)      122.00 ( -17.31%)
    Lat 50.00th-qrtle-32       71.00 (   0.00%)       73.00 (  -2.82%)
    Lat 75.00th-qrtle-32       91.00 (   0.00%)       92.00 (  -1.10%)
    Lat 90.00th-qrtle-32      108.00 (   0.00%)      107.00 (   0.93%)
    Lat 95.00th-qrtle-32      118.00 (   0.00%)      115.00 (   2.54%)
    Lat 99.00th-qrtle-32      134.00 (   0.00%)      129.00 (   3.73%)
    Lat 99.50th-qrtle-32      138.00 (   0.00%)      133.00 (   3.62%)
    Lat 99.90th-qrtle-32      149.00 (   0.00%)      146.00 (   2.01%)
    Lat 50.00th-qrtle-39       83.00 (   0.00%)       81.00 (   2.41%)
    Lat 75.00th-qrtle-39      105.00 (   0.00%)      102.00 (   2.86%)
    Lat 90.00th-qrtle-39      120.00 (   0.00%)      119.00 (   0.83%)
    Lat 95.00th-qrtle-39      129.00 (   0.00%)      128.00 (   0.78%)
    Lat 99.00th-qrtle-39      153.00 (   0.00%)      149.00 (   2.61%)
    Lat 99.50th-qrtle-39      166.00 (   0.00%)      156.00 (   6.02%)
    Lat 99.90th-qrtle-39    12304.00 (   0.00%)    12848.00 (  -4.42%)
    
    When heavily loaded (e.g. 99.50th-qrtle-39 indicates 39 threads), there
    are small gains in many cases. Otherwise it depends on the quartile used
    where it can be bad -- e.g. 75.00th-qrtle-2. However, even these results
    are probably a co-incidence. For this workload, much depends on what node
    the threads get placed on and their relative locality and not wakeups from
    interrupt context. A larger component on how it behaves would be automatic
    NUMA balancing where a fault incurred to measure locality would be a much
    larger contributer to latency than the wakeup path.
    
    This is the results from an almost identical machine that happened to run
    the same test.  They only differ in terms of storage which is irrelevant
    for this test.
    
                                     4.15.0-rc3             4.15.0-rc3
                                        vanilla             noirq-v1r1
    Lat 50.00th-qrtle-1        41.00 (   0.00%)       41.00 (   0.00%)
    Lat 75.00th-qrtle-1        42.00 (   0.00%)       42.00 (   0.00%)
    Lat 90.00th-qrtle-1        44.00 (   0.00%)       43.00 (   2.27%)
    Lat 95.00th-qrtle-1        53.00 (   0.00%)       45.00 (  15.09%)
    Lat 99.00th-qrtle-1        59.00 (   0.00%)       58.00 (   1.69%)
    Lat 99.50th-qrtle-1        60.00 (   0.00%)       59.00 (   1.67%)
    Lat 99.90th-qrtle-1        86.00 (   0.00%)       61.00 (  29.07%)
    Lat 50.00th-qrtle-2        52.00 (   0.00%)       41.00 (  21.15%)
    Lat 75.00th-qrtle-2        57.00 (   0.00%)       46.00 (  19.30%)
    Lat 90.00th-qrtle-2        60.00 (   0.00%)       53.00 (  11.67%)
    Lat 95.00th-qrtle-2        62.00 (   0.00%)       57.00 (   8.06%)
    Lat 99.00th-qrtle-2        73.00 (   0.00%)       68.00 (   6.85%)
    Lat 99.50th-qrtle-2        74.00 (   0.00%)       71.00 (   4.05%)
    Lat 99.90th-qrtle-2        90.00 (   0.00%)       75.00 (  16.67%)
    Lat 50.00th-qrtle-4        57.00 (   0.00%)       52.00 (   8.77%)
    Lat 75.00th-qrtle-4        60.00 (   0.00%)       58.00 (   3.33%)
    Lat 90.00th-qrtle-4        62.00 (   0.00%)       62.00 (   0.00%)
    Lat 95.00th-qrtle-4        65.00 (   0.00%)       65.00 (   0.00%)
    Lat 99.00th-qrtle-4        76.00 (   0.00%)       75.00 (   1.32%)
    Lat 99.50th-qrtle-4        77.00 (   0.00%)       77.00 (   0.00%)
    Lat 99.90th-qrtle-4        87.00 (   0.00%)       81.00 (   6.90%)
    Lat 50.00th-qrtle-8        59.00 (   0.00%)       57.00 (   3.39%)
    Lat 75.00th-qrtle-8        63.00 (   0.00%)       62.00 (   1.59%)
    Lat 90.00th-qrtle-8        66.00 (   0.00%)       67.00 (  -1.52%)
    Lat 95.00th-qrtle-8        68.00 (   0.00%)       70.00 (  -2.94%)
    Lat 99.00th-qrtle-8        79.00 (   0.00%)       80.00 (  -1.27%)
    Lat 99.50th-qrtle-8        80.00 (   0.00%)       84.00 (  -5.00%)
    Lat 99.90th-qrtle-8        84.00 (   0.00%)       90.00 (  -7.14%)
    Lat 50.00th-qrtle-16       65.00 (   0.00%)       65.00 (   0.00%)
    Lat 75.00th-qrtle-16       77.00 (   0.00%)       75.00 (   2.60%)
    Lat 90.00th-qrtle-16       84.00 (   0.00%)       83.00 (   1.19%)
    Lat 95.00th-qrtle-16       88.00 (   0.00%)       87.00 (   1.14%)
    Lat 99.00th-qrtle-16       97.00 (   0.00%)       96.00 (   1.03%)
    Lat 99.50th-qrtle-16      100.00 (   0.00%)      104.00 (  -4.00%)
    Lat 99.90th-qrtle-16      110.00 (   0.00%)      126.00 ( -14.55%)
    Lat 50.00th-qrtle-32       70.00 (   0.00%)       71.00 (  -1.43%)
    Lat 75.00th-qrtle-32       92.00 (   0.00%)       94.00 (  -2.17%)
    Lat 90.00th-qrtle-32      110.00 (   0.00%)      110.00 (   0.00%)
    Lat 95.00th-qrtle-32      121.00 (   0.00%)      118.00 (   2.48%)
    Lat 99.00th-qrtle-32      135.00 (   0.00%)      137.00 (  -1.48%)
    Lat 99.50th-qrtle-32      140.00 (   0.00%)      146.00 (  -4.29%)
    Lat 99.90th-qrtle-32      150.00 (   0.00%)      160.00 (  -6.67%)
    Lat 50.00th-qrtle-39       80.00 (   0.00%)       71.00 (  11.25%)
    Lat 75.00th-qrtle-39      102.00 (   0.00%)       91.00 (  10.78%)
    Lat 90.00th-qrtle-39      118.00 (   0.00%)      108.00 (   8.47%)
    Lat 95.00th-qrtle-39      128.00 (   0.00%)      117.00 (   8.59%)
    Lat 99.00th-qrtle-39      149.00 (   0.00%)      133.00 (  10.74%)
    Lat 99.50th-qrtle-39      160.00 (   0.00%)      139.00 (  13.12%)
    Lat 99.90th-qrtle-39    13808.00 (   0.00%)     4920.00 (  64.37%)
    
    Despite being nearly identical, it showed a variety of major gains so
    I'm not convinced that heavy emphasis should be placed on this particular
    workload in terms of evaluating this particular patch. Further evidence of
    this is the fact that testing on a UMA machine showed small gains/losses
    even though the patch should be a no-op on UMA.
    
    Signed-off-by: Mel Gorman <mgorman@techsingularity.net>
    Signed-off-by: Peter Zijlstra (Intel) <peterz@infradead.org>
    Cc: Linus Torvalds <torvalds@linux-foundation.org>
    Cc: Matt Fleming <matt@codeblueprint.co.uk>
    Cc: Peter Zijlstra <peterz@infradead.org>
    Cc: Thomas Gleixner <tglx@linutronix.de>
    Link: http://lkml.kernel.org/r/20171219085947.13136-2-mgorman@techsingularity.net
    Signed-off-by: Ingo Molnar <mingo@kernel.org>

commit 414a2dc138838642d28938506e31ad461648b898
Author: Geert Uytterhoeven <geert@linux-m68k.org>
Date:   Tue Jan 2 12:13:10 2018 +0100

    sched/isolation: Make CONFIG_CPU_ISOLATION=y depend on SMP or COMPILE_TEST
    
    On uniprocessor systems, critical and non-critical tasks cannot be
    isolated, as there is only a single CPU core.  Hence enabling CPU
    isolation by default on such systems does not make much sense.
    
    Instead of changing the default for !SMP, fix this by making the feature
    depend on SMP, with an override for compile-testing.  Note that its sole
    selector (NO_HZ_FULL) already depends on SMP.
    
    This decreases kernel size for a default uniprocessor kernel by ca. 1 KiB.
    
    Signed-off-by: Geert Uytterhoeven <geert@linux-m68k.org>
    Acked-by: Nicolas Pitre <nico@linaro.org>
    Cc: Frederic Weisbecker <frederic@kernel.org>
    Cc: Linus Torvalds <torvalds@linux-foundation.org>
    Cc: Peter Zijlstra <peterz@infradead.org>
    Cc: Thomas Gleixner <tglx@linutronix.de>
    Fixes: 2c43838c99d9d23f ("sched/isolation: Enable CONFIG_CPU_ISOLATION=y by default")
    Link: http://lkml.kernel.org/r/1514891590-20782-1-git-send-email-geert@linux-m68k.org
    Signed-off-by: Ingo Molnar <mingo@kernel.org>

commit a23670df27829558965a3b96a43bd67ed3064988
Author: Linus Walleij <linus.walleij@linaro.org>
Date:   Wed Nov 29 09:00:43 2017 +0100

    mfd: pm8xxx: Make elegible for COMPILE_TEST
    
    This should be enabled so that we get full compile coverage
    of the PM8xxx MFD core with the different subdrivers.
    
    Tested on the build servers.
    
    Suggested-by: Jonathan Cameron <jic23@kernel.org>
    Signed-off-by: Linus Walleij <linus.walleij@linaro.org>
    Signed-off-by: Lee Jones <lee.jones@linaro.org>

commit b0caa1333b6d2d928a00304e9fb6674526c37b79
Merge: bcd21a4786ea 4cfea3c1f271
Author: Dave Airlie <airlied@redhat.com>
Date:   Fri Jan 5 11:33:24 2018 +1000

    Merge tag 'imx-drm-next-2018-01-02' of git://git.pengutronix.de/git/pza/linux into drm-next
    
    drm/imx: format modifier support
    
    - Add tiled prefetch support to PRE
    - Add format modifier support to PRG and imx-drm-core
    - Use runtime PM to control PRG clock
    - Allow building ipu-v3 under COMPILE_TEST
    
    * tag 'imx-drm-next-2018-01-02' of git://git.pengutronix.de/git/pza/linux:
      gpu: ipu-v3: allow to build with COMPILE_TEST
      drm/imx: advertise supported plane format modifiers
      drm/imx: add FB modifier support
      gpu: ipu-v3: prg: add modifier support
      gpu: ipu-v3: pre: add tiled prefetch support
      gpu: ipu-v3: prg: switch to runtime PM

commit ebe2f8718007d5a1238bb3cb8141b5bb2b4d5773
Author: Shanker Donthineni <shankerd@codeaurora.org>
Date:   Tue Dec 5 13:16:21 2017 -0600

    irqchip/gic-v3: Fix the driver probe() fail due to disabled GICC entry
    
    The ACPI specification says OS shouldn't attempt to use GICC configuration
    parameters if the flag ACPI_MADT_ENABLED is cleared. The ARM64-SMP code
    skips the disabled GICC entries but not causing any issue. However the
    current GICv3 driver probe bails out causing kernel panic() instead of
    skipping the disabled GICC interfaces. This issue happens on systems
    where redistributor regions are not in the always-on power domain and
    one of GICC interface marked with ACPI_MADT_ENABLED=0.
    
    This patch does the two things to fix the panic.
      - Don't return an error in gic_acpi_match_gicc() for disabled GICC entry.
      - No need to keep GICR region information for disabled GICC entry.
    
    Observed kernel crash on QDF2400 platform GICC entry is disabled.
    Kernel crash traces:
      Kernel panic - not syncing: No interrupt controller found.
      CPU: 0 PID: 0 Comm: swapper/0 Not tainted 4.13.5 #26
      [<ffff000008087770>] dump_backtrace+0x0/0x218
      [<ffff0000080879dc>] show_stack+0x14/0x20
      [<ffff00000883b078>] dump_stack+0x98/0xb8
      [<ffff0000080c5c14>] panic+0x118/0x26c
      [<ffff000008b62348>] init_IRQ+0x24/0x2c
      [<ffff000008b609fc>] start_kernel+0x230/0x394
      [<ffff000008b601e4>] __primary_switched+0x64/0x6c
      ---[ end Kernel panic - not syncing: No interrupt controller found.
    
    Disabled GICC subtable example:
                       Subtable Type : 0B [Generic Interrupt Controller]
                              Length : 50
                            Reserved : 0000
                CPU Interface Number : 0000003D
                       Processor UID : 0000003D
               Flags (decoded below) : 00000000
                   Processor Enabled : 0
     Performance Interrupt Trig Mode : 0
     Virtual GIC Interrupt Trig Mode : 0
            Parking Protocol Version : 00000000
               Performance Interrupt : 00000017
                      Parked Address : 0000000000000000
                        Base Address : 0000000000000000
            Virtual GIC Base Address : 0000000000000000
         Hypervisor GIC Base Address : 0000000000000000
               Virtual GIC Interrupt : 00000019
          Redistributor Base Address : 0000FFFF88F40000
                           ARM MPIDR : 000000000000000D
                    Efficiency Class : 00
                            Reserved : 000000
    Signed-off-by: Shanker Donthineni <shankerd@codeaurora.org>
    Signed-off-by: Marc Zyngier <marc.zyngier@arm.com>

commit 81ac38847a1d7fdd74a232cae195ff8f0fb4ab21
Author: Georgi Djakov <georgi.djakov@linaro.org>
Date:   Tue Dec 5 17:47:01 2017 +0200

    clk: qcom: Add APCS clock controller support
    
    Add a driver for the APCS clock controller. It is part of the APCS
    hardware block, which among other things implements also a combined
    mux and half integer divider functionality. It can choose between a
    fixed-rate clock or the dedicated APCS (A53) PLL. The source and the
    divider can be set both at the same time.
    
    This is required for enabling CPU frequency scaling on MSM8916-based
    platforms.
    
    Signed-off-by: Georgi Djakov <georgi.djakov@linaro.org>
    Acked-by: Bjorn Andersson <bjorn.andersson@linaro.org>
    Tested-by: Amit Kucheria <amit.kucheria@linaro.org>
    [sboyd@codeaurora.org: Include rcg header for parent_map, drop
    multiple unneeded includes, add COMPILE_TEST to APCS depends,
    made tristate/modular]
    Signed-off-by: Stephen Boyd <sboyd@codeaurora.org>

commit 6d95d05bafbafc88a13d81e7ad63fcb899de499d
Author: Sreekanth Reddy <sreekanth.reddy@broadcom.com>
Date:   Tue Oct 10 18:41:18 2017 +0530

    scsi: mpt3sas: Fix IO error occurs on pulling out a drive from RAID1 volume created on two SATA drive
    
    
    [ Upstream commit 2ce9a3645299ba1752873d333d73f67620f4550b ]
    
    Whenever an I/O for a RAID volume fails with IOCStatus
    MPI2_IOCSTATUS_SCSI_IOC_TERMINATED and SCSIStatus equal to
    (MPI2_SCSI_STATE_TERMINATED | MPI2_SCSI_STATE_NO_SCSI_STATUS) then
    return the I/O to SCSI midlayer with "DID_RESET" (i.e. retry the IO
    infinite times) set in the host byte.
    
    Previously, the driver was completing the I/O with "DID_SOFT_ERROR"
    which causes the I/O to be quickly retried. However, firmware needed
    more time and hence I/Os were failing.
    
    Signed-off-by: Sreekanth Reddy <Sreekanth.Reddy@broadcom.com>
    Reviewed-by: Tomas Henzl <thenzl@redhat.com>
    Signed-off-by: Martin K. Petersen <martin.petersen@oracle.com>
    Signed-off-by: Sasha Levin <alexander.levin@verizon.com>
    Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>

commit b40eeea31afd1c07f37734fa19ef1c45f5e98011
Author: Sreekanth Reddy <sreekanth.reddy@broadcom.com>
Date:   Tue Oct 10 18:41:18 2017 +0530

    scsi: mpt3sas: Fix IO error occurs on pulling out a drive from RAID1 volume created on two SATA drive
    
    
    [ Upstream commit 2ce9a3645299ba1752873d333d73f67620f4550b ]
    
    Whenever an I/O for a RAID volume fails with IOCStatus
    MPI2_IOCSTATUS_SCSI_IOC_TERMINATED and SCSIStatus equal to
    (MPI2_SCSI_STATE_TERMINATED | MPI2_SCSI_STATE_NO_SCSI_STATUS) then
    return the I/O to SCSI midlayer with "DID_RESET" (i.e. retry the IO
    infinite times) set in the host byte.
    
    Previously, the driver was completing the I/O with "DID_SOFT_ERROR"
    which causes the I/O to be quickly retried. However, firmware needed
    more time and hence I/Os were failing.
    
    Signed-off-by: Sreekanth Reddy <Sreekanth.Reddy@broadcom.com>
    Reviewed-by: Tomas Henzl <thenzl@redhat.com>
    Signed-off-by: Martin K. Petersen <martin.petersen@oracle.com>
    Signed-off-by: Sasha Levin <alexander.levin@verizon.com>
    Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>

commit a916c4152a4ba0c42cd2350dc04251417ca73507
Author: Sreekanth Reddy <sreekanth.reddy@broadcom.com>
Date:   Tue Oct 10 18:41:18 2017 +0530

    scsi: mpt3sas: Fix IO error occurs on pulling out a drive from RAID1 volume created on two SATA drive
    
    
    [ Upstream commit 2ce9a3645299ba1752873d333d73f67620f4550b ]
    
    Whenever an I/O for a RAID volume fails with IOCStatus
    MPI2_IOCSTATUS_SCSI_IOC_TERMINATED and SCSIStatus equal to
    (MPI2_SCSI_STATE_TERMINATED | MPI2_SCSI_STATE_NO_SCSI_STATUS) then
    return the I/O to SCSI midlayer with "DID_RESET" (i.e. retry the IO
    infinite times) set in the host byte.
    
    Previously, the driver was completing the I/O with "DID_SOFT_ERROR"
    which causes the I/O to be quickly retried. However, firmware needed
    more time and hence I/Os were failing.
    
    Signed-off-by: Sreekanth Reddy <Sreekanth.Reddy@broadcom.com>
    Reviewed-by: Tomas Henzl <thenzl@redhat.com>
    Signed-off-by: Martin K. Petersen <martin.petersen@oracle.com>
    Signed-off-by: Sasha Levin <alexander.levin@verizon.com>
    Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>

commit bbc25bee37d2b32cf3a1fab9195b6da3a185614a
Author: James Hogan <jhogan@kernel.org>
Date:   Tue Dec 5 23:31:35 2017 +0000

    lib/mpi: Fix umul_ppmm() for MIPS64r6
    
    Current MIPS64r6 toolchains aren't able to generate efficient
    DMULU/DMUHU based code for the C implementation of umul_ppmm(), which
    performs an unsigned 64 x 64 bit multiply and returns the upper and
    lower 64-bit halves of the 128-bit result. Instead it widens the 64-bit
    inputs to 128-bits and emits a __multi3 intrinsic call to perform a 128
    x 128 multiply. This is both inefficient, and it results in a link error
    since we don't include __multi3 in MIPS linux.
    
    For example commit 90a53e4432b1 ("cfg80211: implement regdb signature
    checking") merged in v4.15-rc1 recently broke the 64r6_defconfig and
    64r6el_defconfig builds by indirectly selecting MPILIB. The same build
    errors can be reproduced on older kernels by enabling e.g. CRYPTO_RSA:
    
    lib/mpi/generic_mpih-mul1.o: In function `mpihelp_mul_1':
    lib/mpi/generic_mpih-mul1.c:50: undefined reference to `__multi3'
    lib/mpi/generic_mpih-mul2.o: In function `mpihelp_addmul_1':
    lib/mpi/generic_mpih-mul2.c:49: undefined reference to `__multi3'
    lib/mpi/generic_mpih-mul3.o: In function `mpihelp_submul_1':
    lib/mpi/generic_mpih-mul3.c:49: undefined reference to `__multi3'
    lib/mpi/mpih-div.o In function `mpihelp_divrem':
    lib/mpi/mpih-div.c:205: undefined reference to `__multi3'
    lib/mpi/mpih-div.c:142: undefined reference to `__multi3'
    
    Therefore add an efficient MIPS64r6 implementation of umul_ppmm() using
    inline assembly and the DMULU/DMUHU instructions, to prevent __multi3
    calls being emitted.
    
    Fixes: 7fd08ca58ae6 ("MIPS: Add build support for the MIPS R6 ISA")
    Signed-off-by: James Hogan <jhogan@kernel.org>
    Cc: Ralf Baechle <ralf@linux-mips.org>
    Cc: Herbert Xu <herbert@gondor.apana.org.au>
    Cc: "David S. Miller" <davem@davemloft.net>
    Cc: linux-mips@linux-mips.org
    Cc: linux-crypto@vger.kernel.org
    Signed-off-by: Herbert Xu <herbert@gondor.apana.org.au>

commit 74cb0d6dde85fef197aca3b2976487e99934309d
Author: Sean Wang <sean.wang@mediatek.com>
Date:   Wed Dec 20 14:42:59 2017 +0800

    clk: mediatek: fixup test-building of MediaTek clock drivers
    
    Let the build system looking into the directiory where the clock drivers
    resides for the COMPILE_TEST alternative dependency allows test-building
    the drivers.
    
    Signed-off-by: Sean Wang <sean.wang@mediatek.com>
    Signed-off-by: Stephen Boyd <sboyd@codeaurora.org>

commit 4cfea3c1f2718d945ca44c1aaac47d8d513c4478
Author: Philipp Zabel <p.zabel@pengutronix.de>
Date:   Tue Dec 19 12:32:53 2017 +0100

    gpu: ipu-v3: allow to build with COMPILE_TEST
    
    Add missing include <linux/sizes.h> in ipu-cpmem and ipu-ic, select
    BITREVERSE for ipu-cpmem and GENERIC_ALLOCATOR for ipu-pre, and allow
    to build if COMPILE_TEST is enabled.
    
    Signed-off-by: Philipp Zabel <p.zabel@pengutronix.de>

commit e578afab6e5f57e7ed22a42d261942b4ac923ffd
Author: Masahiro Yamada <yamada.masahiro@socionext.com>
Date:   Sat Nov 25 01:24:37 2017 +0900

    mmc: renesas_sdhi: remove wrong depends on to enable compile test
    
    ARCH_RENESAS is a stronger condition than (ARM || ARM64).
    If ARCH_RENESAS is enabled, (ARM || ARM64) is met as well.
    
    What is worse, the first depends on line prevents COMPILE_TEST from
    enabling this driver.  It should be removed.
    
    Signed-off-by: Masahiro Yamada <yamada.masahiro@socionext.com>
    Acked-by: Wolfram Sang <wsa+renesas@sang-engineering.com>
    Reviewed-by: Geert Uytterhoeven <geert+renesas@glider.be>
    Signed-off-by: Ulf Hansson <ulf.hansson@linaro.org>

commit 0c36fc0dfb4c0fa068d077b9e2806ef87d0221a7
Author: Wolfram Sang <wsa+renesas@sang-engineering.com>
Date:   Mon Dec 18 01:00:21 2017 +0100

    mmc: tmio: use ioread* for repeated access to a register
    
    Not all archs define reads* and writes*. Switch to ioread*_rep and
    friends which is defined everywhere, so we can enable COMPILE_TEST after
    that.
    
    Signed-off-by: Wolfram Sang <wsa+renesas@sang-engineering.com>
    Signed-off-by: Ulf Hansson <ulf.hansson@linaro.org>

commit 24f8d233074badd4c18e4dafd2fb97d65838afed
Author: Matt Redfearn <matt.redfearn@mips.com>
Date:   Tue Nov 14 10:52:54 2017 +0000

    watchdog: indydog: Add dependency on SGI_HAS_INDYDOG
    
    Commit da2a68b3eb47 ("watchdog: Enable COMPILE_TEST where possible")
    enabled building the Indy watchdog driver when COMPILE_TEST is enabled.
    However, the driver makes reference to symbols that are only defined for
    certain platforms are selected in the config. These platforms select
    SGI_HAS_INDYDOG. Without this, link time errors result, for example
    when building a MIPS allyesconfig.
    
    drivers/watchdog/indydog.o: In function `indydog_write':
    indydog.c:(.text+0x18): undefined reference to `sgimc'
    indydog.c:(.text+0x1c): undefined reference to `sgimc'
    drivers/watchdog/indydog.o: In function `indydog_start':
    indydog.c:(.text+0x54): undefined reference to `sgimc'
    indydog.c:(.text+0x58): undefined reference to `sgimc'
    drivers/watchdog/indydog.o: In function `indydog_stop':
    indydog.c:(.text+0xa4): undefined reference to `sgimc'
    drivers/watchdog/indydog.o:indydog.c:(.text+0xa8): more undefined
    references to `sgimc' follow
    make: *** [Makefile:1005: vmlinux] Error 1
    
    Fix this by ensuring that CONFIG_INDIDOG can only be selected when the
    necessary dependent platform symbols are built in.
    
    Fixes: da2a68b3eb47 ("watchdog: Enable COMPILE_TEST where possible")
    Signed-off-by: Matt Redfearn <matt.redfearn@mips.com>
    Cc: <stable@vger.kernel.org> # 4.11 +
    Signed-off-by: Ralf Baechle <ralf@linux-mips.org>
    Suggested-by: James Hogan <james.hogan@mips.com>
    Reviewed-by: Guenter Roeck <linux@roeck-us.net>
    Signed-off-by: Guenter Roeck <linux@roeck-us.net>
    Signed-off-by: Wim Van Sebroeck <wim@iguana.be>

commit 18d40eae7fb60ab1efa2a607b4b8a2d86036876a
Merge: d455df0bcc00 7c2c11b208be
Author: Linus Torvalds <torvalds@linux-foundation.org>
Date:   Thu Dec 14 16:35:20 2017 -0800

    Merge branch 'akpm' (patches from Andrew)
    
    Merge misc fixes from Andrew Morton:
     "17 fixes"
    
    * emailed patches from Andrew Morton <akpm@linux-foundation.org>:
      arch: define weak abort()
      mm, oom_reaper: fix memory corruption
      kernel: make groups_sort calling a responsibility group_info allocators
      mm/frame_vector.c: release a semaphore in 'get_vaddr_frames()'
      tools/slabinfo-gnuplot: force to use bash shell
      kcov: fix comparison callback signature
      mm/slab.c: do not hash pointers when debugging slab
      mm/page_alloc.c: avoid excessive IRQ disabled times in free_unref_page_list()
      mm/memory.c: mark wp_huge_pmd() inline to prevent build failure
      scripts/faddr2line: fix CROSS_COMPILE unset error
      Documentation/vm/zswap.txt: update with same-value filled page feature
      exec: avoid gcc-8 warning for get_task_comm
      autofs: fix careless error in recent commit
      string.h: workaround for increased stack usage
      mm/kmemleak.c: make cond_resched() rate-limiting more efficient
      lib/rbtree,drm/mm: add rbtree_replace_node_cached()
      include/linux/idr.h: add #include <linux/bug.h>

commit 4cc90b4cc3d4955f79eae4f7f9d64e67e17b468e
Author: Liu, Changcheng <changcheng.liu@intel.com>
Date:   Thu Dec 14 15:32:48 2017 -0800

    scripts/faddr2line: fix CROSS_COMPILE unset error
    
    faddr2line hit var unbound error when CROSS_COMPILE isn't set since
    nounset option is set in bash script.
    
    Link: http://lkml.kernel.org/r/20171206013022.GA83929@sofia
    Fixes: 95a879825419 ("scripts/faddr2line: extend usage on generic arch")
    Signed-off-by: Liu Changcheng <changcheng.liu@intel.com>
    Reported-by: Richard Weinberger <richard.weinberger@gmail.com>
    Reviewed-by: Richard Weinberger <richard@nod.at>
    Cc: Thomas Gleixner <tglx@linutronix.de>
    Cc: Greg Kroah-Hartman <gregkh@linuxfoundation.org>
    Cc: Philippe Ombredanne <pombredanne@nexb.com>
    Cc: NeilBrown <neilb@suse.com>
    Signed-off-by: Andrew Morton <akpm@linux-foundation.org>
    Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>

commit cfe17c9bbe6a673fdafdab179c32b355ed447f66
Author: Masahiro Yamada <yamada.masahiro@socionext.com>
Date:   Mon Nov 27 21:15:13 2017 +0900

    kbuild: move cc-option and cc-disable-warning after incl. arch Makefile
    
    Geert reported commit ae6b289a3789 ("kbuild: Set KBUILD_CFLAGS before
    incl. arch Makefile") broke cross-compilation using a cross-compiler
    that supports less compiler options than the host compiler.
    
    For example,
    
      cc1: error: unrecognized command line option "-Wno-unused-but-set-variable"
    
    This problem happens on architectures that setup CROSS_COMPILE in their
    arch/*/Makefile.
    
    Move the cc-option and cc-disable-warning back to the original position,
    but keep the Clang target options untouched.
    
    Fixes: ae6b289a3789 ("kbuild: Set KBUILD_CFLAGS before incl. arch Makefile")
    Reported-by: Geert Uytterhoeven <geert@linux-m68k.org>
    Signed-off-by: Masahiro Yamada <yamada.masahiro@socionext.com>
    Tested-by: Geert Uytterhoeven <geert@linux-m68k.org>

commit ce922b7b4a5178279eb5453e7fcb0b116c757f1e
Author: Eric Biggers <ebiggers@google.com>
Date:   Tue Nov 7 14:15:27 2017 -0800

    lib/mpi: call cond_resched() from mpi_powm() loop
    
    commit 1d9ddde12e3c9bab7f3d3484eb9446315e3571ca upstream.
    
    On a non-preemptible kernel, if KEYCTL_DH_COMPUTE is called with the
    largest permitted inputs (16384 bits), the kernel spends 10+ seconds
    doing modular exponentiation in mpi_powm() without rescheduling.  If all
    threads do it, it locks up the system.  Moreover, it can cause
    rcu_sched-stall warnings.
    
    Notwithstanding the insanity of doing this calculation in kernel mode
    rather than in userspace, fix it by calling cond_resched() as each bit
    from the exponent is processed.  It's still noninterruptible, but at
    least it's preemptible now.
    
    Do the cond_resched() once per bit rather than once per MPI limb because
    each limb might still easily take 100+ milliseconds on slow CPUs.
    
    Signed-off-by: Eric Biggers <ebiggers@google.com>
    Signed-off-by: Herbert Xu <herbert@gondor.apana.org.au>
    Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>

commit 443d26a6f791506ca6fdab58b355ba7e170f741e
Author: Eric Biggers <ebiggers@google.com>
Date:   Tue Nov 7 14:15:27 2017 -0800

    lib/mpi: call cond_resched() from mpi_powm() loop
    
    commit 1d9ddde12e3c9bab7f3d3484eb9446315e3571ca upstream.
    
    On a non-preemptible kernel, if KEYCTL_DH_COMPUTE is called with the
    largest permitted inputs (16384 bits), the kernel spends 10+ seconds
    doing modular exponentiation in mpi_powm() without rescheduling.  If all
    threads do it, it locks up the system.  Moreover, it can cause
    rcu_sched-stall warnings.
    
    Notwithstanding the insanity of doing this calculation in kernel mode
    rather than in userspace, fix it by calling cond_resched() as each bit
    from the exponent is processed.  It's still noninterruptible, but at
    least it's preemptible now.
    
    Do the cond_resched() once per bit rather than once per MPI limb because
    each limb might still easily take 100+ milliseconds on slow CPUs.
    
    Signed-off-by: Eric Biggers <ebiggers@google.com>
    Signed-off-by: Herbert Xu <herbert@gondor.apana.org.au>
    Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>

commit 4fdb1637b2083824403de119b07c6bfe6560915d
Author: Eric Biggers <ebiggers@google.com>
Date:   Tue Nov 7 14:15:27 2017 -0800

    lib/mpi: call cond_resched() from mpi_powm() loop
    
    commit 1d9ddde12e3c9bab7f3d3484eb9446315e3571ca upstream.
    
    On a non-preemptible kernel, if KEYCTL_DH_COMPUTE is called with the
    largest permitted inputs (16384 bits), the kernel spends 10+ seconds
    doing modular exponentiation in mpi_powm() without rescheduling.  If all
    threads do it, it locks up the system.  Moreover, it can cause
    rcu_sched-stall warnings.
    
    Notwithstanding the insanity of doing this calculation in kernel mode
    rather than in userspace, fix it by calling cond_resched() as each bit
    from the exponent is processed.  It's still noninterruptible, but at
    least it's preemptible now.
    
    Do the cond_resched() once per bit rather than once per MPI limb because
    each limb might still easily take 100+ milliseconds on slow CPUs.
    
    Signed-off-by: Eric Biggers <ebiggers@google.com>
    Signed-off-by: Herbert Xu <herbert@gondor.apana.org.au>
    Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>

commit 03a2209fe340efa020eb76bcaa74b93356fc952a
Author: Eric Biggers <ebiggers@google.com>
Date:   Tue Nov 7 14:15:27 2017 -0800

    lib/mpi: call cond_resched() from mpi_powm() loop
    
    commit 1d9ddde12e3c9bab7f3d3484eb9446315e3571ca upstream.
    
    On a non-preemptible kernel, if KEYCTL_DH_COMPUTE is called with the
    largest permitted inputs (16384 bits), the kernel spends 10+ seconds
    doing modular exponentiation in mpi_powm() without rescheduling.  If all
    threads do it, it locks up the system.  Moreover, it can cause
    rcu_sched-stall warnings.
    
    Notwithstanding the insanity of doing this calculation in kernel mode
    rather than in userspace, fix it by calling cond_resched() as each bit
    from the exponent is processed.  It's still noninterruptible, but at
    least it's preemptible now.
    
    Do the cond_resched() once per bit rather than once per MPI limb because
    each limb might still easily take 100+ milliseconds on slow CPUs.
    
    Signed-off-by: Eric Biggers <ebiggers@google.com>
    Signed-off-by: Herbert Xu <herbert@gondor.apana.org.au>
    Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>

commit aa15fe4d6a7f34b76b562cff5f4c4b86663e83d9
Author: Eric Biggers <ebiggers@google.com>
Date:   Sun Nov 5 18:30:44 2017 -0800

    crypto: dh - Fix double free of ctx->p
    
    commit 12d41a023efb01b846457ccdbbcbe2b65a87d530 upstream.
    
    When setting the secret with the software Diffie-Hellman implementation,
    if allocating 'g' failed (e.g. if it was longer than
    MAX_EXTERN_MPI_BITS), then 'p' was freed twice: once immediately, and
    once later when the crypto_kpp tfm was destroyed.
    
    Fix it by using dh_free_ctx() (renamed to dh_clear_ctx()) in the error
    paths, as that correctly sets the pointers to NULL.
    
    KASAN report:
    
        MPI: mpi too large (32760 bits)
        ==================================================================
        BUG: KASAN: use-after-free in mpi_free+0x131/0x170
        Read of size 4 at addr ffff88006c7cdf90 by task reproduce_doubl/367
    
        CPU: 1 PID: 367 Comm: reproduce_doubl Not tainted 4.14.0-rc7-00040-g05298abde6fe #7
        Hardware name: QEMU Standard PC (i440FX + PIIX, 1996), BIOS Bochs 01/01/2011
        Call Trace:
         dump_stack+0xb3/0x10b
         ? mpi_free+0x131/0x170
         print_address_description+0x79/0x2a0
         ? mpi_free+0x131/0x170
         kasan_report+0x236/0x340
         ? akcipher_register_instance+0x90/0x90
         __asan_report_load4_noabort+0x14/0x20
         mpi_free+0x131/0x170
         ? akcipher_register_instance+0x90/0x90
         dh_exit_tfm+0x3d/0x140
         crypto_kpp_exit_tfm+0x52/0x70
         crypto_destroy_tfm+0xb3/0x250
         __keyctl_dh_compute+0x640/0xe90
         ? kasan_slab_free+0x12f/0x180
         ? dh_data_from_key+0x240/0x240
         ? key_create_or_update+0x1ee/0xb20
         ? key_instantiate_and_link+0x440/0x440
         ? lock_contended+0xee0/0xee0
         ? kfree+0xcf/0x210
         ? SyS_add_key+0x268/0x340
         keyctl_dh_compute+0xb3/0xf1
         ? __keyctl_dh_compute+0xe90/0xe90
         ? SyS_add_key+0x26d/0x340
         ? entry_SYSCALL_64_fastpath+0x5/0xbe
         ? trace_hardirqs_on_caller+0x3f4/0x560
         SyS_keyctl+0x72/0x2c0
         entry_SYSCALL_64_fastpath+0x1f/0xbe
        RIP: 0033:0x43ccf9
        RSP: 002b:00007ffeeec96158 EFLAGS: 00000246 ORIG_RAX: 00000000000000fa
        RAX: ffffffffffffffda RBX: 000000000248b9b9 RCX: 000000000043ccf9
        RDX: 00007ffeeec96170 RSI: 00007ffeeec96160 RDI: 0000000000000017
        RBP: 0000000000000046 R08: 0000000000000000 R09: 0248b9b9143dc936
        R10: 0000000000001000 R11: 0000000000000246 R12: 0000000000000000
        R13: 0000000000409670 R14: 0000000000409700 R15: 0000000000000000
    
        Allocated by task 367:
         save_stack_trace+0x16/0x20
         kasan_kmalloc+0xeb/0x180
         kmem_cache_alloc_trace+0x114/0x300
         mpi_alloc+0x4b/0x230
         mpi_read_raw_data+0xbe/0x360
         dh_set_secret+0x1dc/0x460
         __keyctl_dh_compute+0x623/0xe90
         keyctl_dh_compute+0xb3/0xf1
         SyS_keyctl+0x72/0x2c0
         entry_SYSCALL_64_fastpath+0x1f/0xbe
    
        Freed by task 367:
         save_stack_trace+0x16/0x20
         kasan_slab_free+0xab/0x180
         kfree+0xb5/0x210
         mpi_free+0xcb/0x170
         dh_set_secret+0x2d7/0x460
         __keyctl_dh_compute+0x623/0xe90
         keyctl_dh_compute+0xb3/0xf1
         SyS_keyctl+0x72/0x2c0
         entry_SYSCALL_64_fastpath+0x1f/0xbe
    
    Fixes: 802c7f1c84e4 ("crypto: dh - Add DH software implementation")
    Signed-off-by: Eric Biggers <ebiggers@google.com>
    Reviewed-by: Tudor Ambarus <tudor.ambarus@microchip.com>
    Signed-off-by: Herbert Xu <herbert@gondor.apana.org.au>
    Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>

commit 4a7e0231242040513f4b78117e83aa85028ff053
Author: Tudor-Dan Ambarus <tudor.ambarus@microchip.com>
Date:   Thu May 25 10:18:07 2017 +0300

    crypto: dh - fix memleak in setkey
    
    commit ee34e2644a78e2561742bea8c4bdcf83cabf90a7 upstream.
    
    setkey can be called multiple times during the existence
    of the transformation object. In case of multiple setkey calls,
    the old key was not freed and we leaked memory.
    Free the old MPI key if any.
    
    Signed-off-by: Tudor Ambarus <tudor.ambarus@microchip.com>
    Signed-off-by: Herbert Xu <herbert@gondor.apana.org.au>
    Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>

commit 81eabe0af17631acf193c84ec785ca92fd98ad08
Author: Eric Biggers <ebiggers@google.com>
Date:   Sun Nov 5 18:30:44 2017 -0800

    crypto: dh - Fix double free of ctx->p
    
    commit 12d41a023efb01b846457ccdbbcbe2b65a87d530 upstream.
    
    When setting the secret with the software Diffie-Hellman implementation,
    if allocating 'g' failed (e.g. if it was longer than
    MAX_EXTERN_MPI_BITS), then 'p' was freed twice: once immediately, and
    once later when the crypto_kpp tfm was destroyed.
    
    Fix it by using dh_free_ctx() (renamed to dh_clear_ctx()) in the error
    paths, as that correctly sets the pointers to NULL.
    
    KASAN report:
    
        MPI: mpi too large (32760 bits)
        ==================================================================
        BUG: KASAN: use-after-free in mpi_free+0x131/0x170
        Read of size 4 at addr ffff88006c7cdf90 by task reproduce_doubl/367
    
        CPU: 1 PID: 367 Comm: reproduce_doubl Not tainted 4.14.0-rc7-00040-g05298abde6fe #7
        Hardware name: QEMU Standard PC (i440FX + PIIX, 1996), BIOS Bochs 01/01/2011
        Call Trace:
         dump_stack+0xb3/0x10b
         ? mpi_free+0x131/0x170
         print_address_description+0x79/0x2a0
         ? mpi_free+0x131/0x170
         kasan_report+0x236/0x340
         ? akcipher_register_instance+0x90/0x90
         __asan_report_load4_noabort+0x14/0x20
         mpi_free+0x131/0x170
         ? akcipher_register_instance+0x90/0x90
         dh_exit_tfm+0x3d/0x140
         crypto_kpp_exit_tfm+0x52/0x70
         crypto_destroy_tfm+0xb3/0x250
         __keyctl_dh_compute+0x640/0xe90
         ? kasan_slab_free+0x12f/0x180
         ? dh_data_from_key+0x240/0x240
         ? key_create_or_update+0x1ee/0xb20
         ? key_instantiate_and_link+0x440/0x440
         ? lock_contended+0xee0/0xee0
         ? kfree+0xcf/0x210
         ? SyS_add_key+0x268/0x340
         keyctl_dh_compute+0xb3/0xf1
         ? __keyctl_dh_compute+0xe90/0xe90
         ? SyS_add_key+0x26d/0x340
         ? entry_SYSCALL_64_fastpath+0x5/0xbe
         ? trace_hardirqs_on_caller+0x3f4/0x560
         SyS_keyctl+0x72/0x2c0
         entry_SYSCALL_64_fastpath+0x1f/0xbe
        RIP: 0033:0x43ccf9
        RSP: 002b:00007ffeeec96158 EFLAGS: 00000246 ORIG_RAX: 00000000000000fa
        RAX: ffffffffffffffda RBX: 000000000248b9b9 RCX: 000000000043ccf9
        RDX: 00007ffeeec96170 RSI: 00007ffeeec96160 RDI: 0000000000000017
        RBP: 0000000000000046 R08: 0000000000000000 R09: 0248b9b9143dc936
        R10: 0000000000001000 R11: 0000000000000246 R12: 0000000000000000
        R13: 0000000000409670 R14: 0000000000409700 R15: 0000000000000000
    
        Allocated by task 367:
         save_stack_trace+0x16/0x20
         kasan_kmalloc+0xeb/0x180
         kmem_cache_alloc_trace+0x114/0x300
         mpi_alloc+0x4b/0x230
         mpi_read_raw_data+0xbe/0x360
         dh_set_secret+0x1dc/0x460
         __keyctl_dh_compute+0x623/0xe90
         keyctl_dh_compute+0xb3/0xf1
         SyS_keyctl+0x72/0x2c0
         entry_SYSCALL_64_fastpath+0x1f/0xbe
    
        Freed by task 367:
         save_stack_trace+0x16/0x20
         kasan_slab_free+0xab/0x180
         kfree+0xb5/0x210
         mpi_free+0xcb/0x170
         dh_set_secret+0x2d7/0x460
         __keyctl_dh_compute+0x623/0xe90
         keyctl_dh_compute+0xb3/0xf1
         SyS_keyctl+0x72/0x2c0
         entry_SYSCALL_64_fastpath+0x1f/0xbe
    
    Fixes: 802c7f1c84e4 ("crypto: dh - Add DH software implementation")
    Signed-off-by: Eric Biggers <ebiggers@google.com>
    Reviewed-by: Tudor Ambarus <tudor.ambarus@microchip.com>
    Signed-off-by: Herbert Xu <herbert@gondor.apana.org.au>
    Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>

commit a37b2a1cc6e99812190dac5a790affe7368d81a6
Author: Eric Biggers <ebiggers@google.com>
Date:   Sun Nov 5 18:30:44 2017 -0800

    crypto: dh - Fix double free of ctx->p
    
    commit 12d41a023efb01b846457ccdbbcbe2b65a87d530 upstream.
    
    When setting the secret with the software Diffie-Hellman implementation,
    if allocating 'g' failed (e.g. if it was longer than
    MAX_EXTERN_MPI_BITS), then 'p' was freed twice: once immediately, and
    once later when the crypto_kpp tfm was destroyed.
    
    Fix it by using dh_free_ctx() (renamed to dh_clear_ctx()) in the error
    paths, as that correctly sets the pointers to NULL.
    
    KASAN report:
    
        MPI: mpi too large (32760 bits)
        ==================================================================
        BUG: KASAN: use-after-free in mpi_free+0x131/0x170
        Read of size 4 at addr ffff88006c7cdf90 by task reproduce_doubl/367
    
        CPU: 1 PID: 367 Comm: reproduce_doubl Not tainted 4.14.0-rc7-00040-g05298abde6fe #7
        Hardware name: QEMU Standard PC (i440FX + PIIX, 1996), BIOS Bochs 01/01/2011
        Call Trace:
         dump_stack+0xb3/0x10b
         ? mpi_free+0x131/0x170
         print_address_description+0x79/0x2a0
         ? mpi_free+0x131/0x170
         kasan_report+0x236/0x340
         ? akcipher_register_instance+0x90/0x90
         __asan_report_load4_noabort+0x14/0x20
         mpi_free+0x131/0x170
         ? akcipher_register_instance+0x90/0x90
         dh_exit_tfm+0x3d/0x140
         crypto_kpp_exit_tfm+0x52/0x70
         crypto_destroy_tfm+0xb3/0x250
         __keyctl_dh_compute+0x640/0xe90
         ? kasan_slab_free+0x12f/0x180
         ? dh_data_from_key+0x240/0x240
         ? key_create_or_update+0x1ee/0xb20
         ? key_instantiate_and_link+0x440/0x440
         ? lock_contended+0xee0/0xee0
         ? kfree+0xcf/0x210
         ? SyS_add_key+0x268/0x340
         keyctl_dh_compute+0xb3/0xf1
         ? __keyctl_dh_compute+0xe90/0xe90
         ? SyS_add_key+0x26d/0x340
         ? entry_SYSCALL_64_fastpath+0x5/0xbe
         ? trace_hardirqs_on_caller+0x3f4/0x560
         SyS_keyctl+0x72/0x2c0
         entry_SYSCALL_64_fastpath+0x1f/0xbe
        RIP: 0033:0x43ccf9
        RSP: 002b:00007ffeeec96158 EFLAGS: 00000246 ORIG_RAX: 00000000000000fa
        RAX: ffffffffffffffda RBX: 000000000248b9b9 RCX: 000000000043ccf9
        RDX: 00007ffeeec96170 RSI: 00007ffeeec96160 RDI: 0000000000000017
        RBP: 0000000000000046 R08: 0000000000000000 R09: 0248b9b9143dc936
        R10: 0000000000001000 R11: 0000000000000246 R12: 0000000000000000
        R13: 0000000000409670 R14: 0000000000409700 R15: 0000000000000000
    
        Allocated by task 367:
         save_stack_trace+0x16/0x20
         kasan_kmalloc+0xeb/0x180
         kmem_cache_alloc_trace+0x114/0x300
         mpi_alloc+0x4b/0x230
         mpi_read_raw_data+0xbe/0x360
         dh_set_secret+0x1dc/0x460
         __keyctl_dh_compute+0x623/0xe90
         keyctl_dh_compute+0xb3/0xf1
         SyS_keyctl+0x72/0x2c0
         entry_SYSCALL_64_fastpath+0x1f/0xbe
    
        Freed by task 367:
         save_stack_trace+0x16/0x20
         kasan_slab_free+0xab/0x180
         kfree+0xb5/0x210
         mpi_free+0xcb/0x170
         dh_set_secret+0x2d7/0x460
         __keyctl_dh_compute+0x623/0xe90
         keyctl_dh_compute+0xb3/0xf1
         SyS_keyctl+0x72/0x2c0
         entry_SYSCALL_64_fastpath+0x1f/0xbe
    
    Fixes: 802c7f1c84e4 ("crypto: dh - Add DH software implementation")
    Signed-off-by: Eric Biggers <ebiggers@google.com>
    Reviewed-by: Tudor Ambarus <tudor.ambarus@microchip.com>
    Signed-off-by: Herbert Xu <herbert@gondor.apana.org.au>
    Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>

commit dfd4c4935de8ac39f22e0f65972140405fd27942
Author: Vasily Gorbik <gor@linux.vnet.ibm.com>
Date:   Mon Nov 13 16:58:34 2017 +0100

    s390/kbuild: get rid of a warning when compiling with KCOV
    
    This change fixes the following warning:
    warning: (KCOV) selects GCC_PLUGINS which has unmet direct dependencies
    (HAVE_GCC_PLUGINS && !COMPILE_TEST)
    
    Signed-off-by: Vasily Gorbik <gor@linux.vnet.ibm.com>
    Signed-off-by: Heiko Carstens <heiko.carstens@de.ibm.com>

commit 4f8117a2da4dd48688123db5bc83c8691f2e322b
Author: Michael Ellerman <mpe@ellerman.id.au>
Date:   Wed Jul 26 23:19:04 2017 +1000

    powerpc/boot: Fix 64-bit boot wrapper build with non-biarch compiler
    
    commit 65c5ec11c25eff6ba6e9b1cbfff014875fddd1e0 upstream.
    
    Historically the boot wrapper was always built 32-bit big endian, even
    for 64-bit kernels. That was because old firmwares didn't necessarily
    support booting a 64-bit image. Because of that arch/powerpc/boot/Makefile
    uses CROSS32CC for compilation.
    
    However when we added 64-bit little endian support, we also added
    support for building the boot wrapper 64-bit. However we kept using
    CROSS32CC, because in most cases it is just CC and everything works.
    
    However if the user doesn't specify CROSS32_COMPILE (which no one ever
    does AFAIK), and CC is *not* biarch (32/64-bit capable), then CROSS32CC
    becomes just "gcc". On native systems that is probably OK, but if we're
    cross building it definitely isn't, leading to eg:
    
      gcc ... -m64 -mlittle-endian -mabi=elfv2 ... arch/powerpc/boot/cpm-serial.c
      gcc: error: unrecognized argument in option -mabi=elfv2
      gcc: error: unrecognized command line option -mlittle-endian
      make: *** [zImage] Error 2
    
    To fix it, stop using CROSS32CC, because we may or may not be building
    32-bit. Instead setup a BOOTCC, which defaults to CC, and only use
    CROSS32_COMPILE if it's set and we're building for 32-bit.
    
    Fixes: 147c05168fc8 ("powerpc/boot: Add support for 64bit little endian wrapper")
    Signed-off-by: Michael Ellerman <mpe@ellerman.id.au>
    Reviewed-by: Cyril Bur <cyrilbur@gmail.com>
    [bwh: Backported to 3.16: adjust context]
    Signed-off-by: Ben Hutchings <ben@decadent.org.uk>

commit 1d9ddde12e3c9bab7f3d3484eb9446315e3571ca
Author: Eric Biggers <ebiggers@google.com>
Date:   Tue Nov 7 14:15:27 2017 -0800

    lib/mpi: call cond_resched() from mpi_powm() loop
    
    On a non-preemptible kernel, if KEYCTL_DH_COMPUTE is called with the
    largest permitted inputs (16384 bits), the kernel spends 10+ seconds
    doing modular exponentiation in mpi_powm() without rescheduling.  If all
    threads do it, it locks up the system.  Moreover, it can cause
    rcu_sched-stall warnings.
    
    Notwithstanding the insanity of doing this calculation in kernel mode
    rather than in userspace, fix it by calling cond_resched() as each bit
    from the exponent is processed.  It's still noninterruptible, but at
    least it's preemptible now.
    
    Do the cond_resched() once per bit rather than once per MPI limb because
    each limb might still easily take 100+ milliseconds on slow CPUs.
    
    Cc: <stable@vger.kernel.org> # v4.12+
    Signed-off-by: Eric Biggers <ebiggers@google.com>
    Signed-off-by: Herbert Xu <herbert@gondor.apana.org.au>

commit 12d41a023efb01b846457ccdbbcbe2b65a87d530
Author: Eric Biggers <ebiggers@google.com>
Date:   Sun Nov 5 18:30:44 2017 -0800

    crypto: dh - Fix double free of ctx->p
    
    When setting the secret with the software Diffie-Hellman implementation,
    if allocating 'g' failed (e.g. if it was longer than
    MAX_EXTERN_MPI_BITS), then 'p' was freed twice: once immediately, and
    once later when the crypto_kpp tfm was destroyed.
    
    Fix it by using dh_free_ctx() (renamed to dh_clear_ctx()) in the error
    paths, as that correctly sets the pointers to NULL.
    
    KASAN report:
    
        MPI: mpi too large (32760 bits)
        ==================================================================
        BUG: KASAN: use-after-free in mpi_free+0x131/0x170
        Read of size 4 at addr ffff88006c7cdf90 by task reproduce_doubl/367
    
        CPU: 1 PID: 367 Comm: reproduce_doubl Not tainted 4.14.0-rc7-00040-g05298abde6fe #7
        Hardware name: QEMU Standard PC (i440FX + PIIX, 1996), BIOS Bochs 01/01/2011
        Call Trace:
         dump_stack+0xb3/0x10b
         ? mpi_free+0x131/0x170
         print_address_description+0x79/0x2a0
         ? mpi_free+0x131/0x170
         kasan_report+0x236/0x340
         ? akcipher_register_instance+0x90/0x90
         __asan_report_load4_noabort+0x14/0x20
         mpi_free+0x131/0x170
         ? akcipher_register_instance+0x90/0x90
         dh_exit_tfm+0x3d/0x140
         crypto_kpp_exit_tfm+0x52/0x70
         crypto_destroy_tfm+0xb3/0x250
         __keyctl_dh_compute+0x640/0xe90
         ? kasan_slab_free+0x12f/0x180
         ? dh_data_from_key+0x240/0x240
         ? key_create_or_update+0x1ee/0xb20
         ? key_instantiate_and_link+0x440/0x440
         ? lock_contended+0xee0/0xee0
         ? kfree+0xcf/0x210
         ? SyS_add_key+0x268/0x340
         keyctl_dh_compute+0xb3/0xf1
         ? __keyctl_dh_compute+0xe90/0xe90
         ? SyS_add_key+0x26d/0x340
         ? entry_SYSCALL_64_fastpath+0x5/0xbe
         ? trace_hardirqs_on_caller+0x3f4/0x560
         SyS_keyctl+0x72/0x2c0
         entry_SYSCALL_64_fastpath+0x1f/0xbe
        RIP: 0033:0x43ccf9
        RSP: 002b:00007ffeeec96158 EFLAGS: 00000246 ORIG_RAX: 00000000000000fa
        RAX: ffffffffffffffda RBX: 000000000248b9b9 RCX: 000000000043ccf9
        RDX: 00007ffeeec96170 RSI: 00007ffeeec96160 RDI: 0000000000000017
        RBP: 0000000000000046 R08: 0000000000000000 R09: 0248b9b9143dc936
        R10: 0000000000001000 R11: 0000000000000246 R12: 0000000000000000
        R13: 0000000000409670 R14: 0000000000409700 R15: 0000000000000000
    
        Allocated by task 367:
         save_stack_trace+0x16/0x20
         kasan_kmalloc+0xeb/0x180
         kmem_cache_alloc_trace+0x114/0x300
         mpi_alloc+0x4b/0x230
         mpi_read_raw_data+0xbe/0x360
         dh_set_secret+0x1dc/0x460
         __keyctl_dh_compute+0x623/0xe90
         keyctl_dh_compute+0xb3/0xf1
         SyS_keyctl+0x72/0x2c0
         entry_SYSCALL_64_fastpath+0x1f/0xbe
    
        Freed by task 367:
         save_stack_trace+0x16/0x20
         kasan_slab_free+0xab/0x180
         kfree+0xb5/0x210
         mpi_free+0xcb/0x170
         dh_set_secret+0x2d7/0x460
         __keyctl_dh_compute+0x623/0xe90
         keyctl_dh_compute+0xb3/0xf1
         SyS_keyctl+0x72/0x2c0
         entry_SYSCALL_64_fastpath+0x1f/0xbe
    
    Fixes: 802c7f1c84e4 ("crypto: dh - Add DH software implementation")
    Cc: <stable@vger.kernel.org> # v4.8+
    Signed-off-by: Eric Biggers <ebiggers@google.com>
    Reviewed-by: Tudor Ambarus <tudor.ambarus@microchip.com>
    Signed-off-by: Herbert Xu <herbert@gondor.apana.org.au>

commit ab86ba2f8c3ab075833357c8ddc1b1ecd6b599a6
Author: Jean Delvare <jdelvare@suse.de>
Date:   Thu Oct 5 11:17:43 2017 +0200

    soc: Allow test-building of MediaTek drivers
    
    The COMPILE_TEST alternative dependency allows test-building the
    drivers but only as long as the build system itself will look into
    the directory where the drivers reside.
    
    Signed-off-by: Jean Delvare <jdelvare@suse.de>
    Cc: Sean Wang <sean.wang@mediatek.com>
    Cc: Matthias Brugger <matthias.bgg@gmail.com>
    Acked-by: Sean Wang <sean.wang@mediatek.com>
    Signed-off-by: Matthias Brugger <matthias.bgg@gmail.com>

commit 31d7b359a94b8c96e54c6e3b438e6c7b65b9acb1
Author: Sean Wang <sean.wang@mediatek.com>
Date:   Thu Oct 5 11:17:49 2017 +0800

    soc: mediatek: place Kconfig for all SoC drivers under menu
    
    Add cleanup for placing all Kconfig for all MediaTek SoC drivers under
    the independent menu as other SoCs vendor usually did. Since the menu
    would be shown depending on "ARCH_MEDIATEK || COMPILE_TEST" selected and
    MTK_PMIC_WRAP is still safe compiling with the case of "COMPILE_TEST"
    only, the superfluous dependency for those items under the menu also is
    also being removed for the sake of simplicity.
    
    Signed-off-by: Sean Wang <sean.wang@mediatek.com>
    Reviewed-by: Jean Delvare <jdelvare@suse.de>
    Signed-off-by: Matthias Brugger <matthias.bgg@gmail.com>

commit d9ee91c1b1fe56b905b767f4a0063d3624e1a1cf
Author: Thomas Gleixner <tglx@linutronix.de>
Date:   Fri Oct 20 11:15:36 2017 +0200

    irqchip/meson: Disable COMPILE_TEST
    
    The driver fails to compile with CONFIG_COMPILE_TEST=y on x86:
    
    irq-meson-gpio.c: In function meson_gpio_irq_parse_dt:
    irq-meson-gpio.c:343:8: error: implicit declaration of function
                                   of_property_read_variable_u32_array
      ret = of_property_read_variable_u32_array(node,
    
    Adding COMPILE_TEST to a driver requires at least compile testing it for
    x86....
    
    Reported-by: Ingo Molnar <mingo@kernel.org>
    Signed-off-by: Thomas Gleixner <tglx@linutronix.de>
    Cc: Heiner Kallweit <hkallweit1@gmail.com>
    Cc: Jerome Brunet <jbrunet@baylibre.com>
    Cc: Marc Zyngier <marc.zyngier@arm.com>

commit 80d47a91e5db96e5db391aaad414fb6ceb40e7c0
Author: Mikko Perttunen <mperttunen@nvidia.com>
Date:   Mon Jul 24 19:29:17 2017 +0300

    firmware: tegra: Add stubs when BPMP not enabled
    
    Add static inline stubs to bpmp.h when CONFIG_BPMP is not enabled.
    This allows building BPMP-related drivers with COMPILE_TEST.
    
    Signed-off-by: Mikko Perttunen <mperttunen@nvidia.com>
    Signed-off-by: Thierry Reding <treding@nvidia.com>

commit 24fff017e141ff62fc84676ff557705f7635a578
Author: Viswas G <Viswas.G@microsemi.com>
Date:   Wed Oct 18 11:39:08 2017 +0530

    scsi: pm80xx: ILA and inactive firmware version through sysfs
    
    Added support to read ILA version and inactive firmware version from MPI
    configuration table and export through sysfs.
    
    Signed-off-by: Deepak Ukey <deepak.ukey@microsemi.com>
    Signed-off-by: Viswas G <Viswas.G@microsemi.com>
    Acked-by: Jack Wang <jinpu.wang@profitbricks.com>
    Signed-off-by: Martin K. Petersen <martin.petersen@oracle.com>

commit 90e7a70199184ed5f3081981c7cffed771b84bb3
Author: Sreekanth Reddy <sreekanth.reddy@broadcom.com>
Date:   Tue Oct 10 18:41:19 2017 +0530

    scsi: mpt3sas: Updated MPI headers to v2.00.48
    
    Updated MPI headers to v2.00.48
    
    Signed-off-by: Sreekanth Reddy <Sreekanth.Reddy@broadcom.com>
    Reviewed-by: Tomas Henzl <thenzl@redhat.com>
    Signed-off-by: Martin K. Petersen <martin.petersen@oracle.com>

commit 2ce9a3645299ba1752873d333d73f67620f4550b
Author: Sreekanth Reddy <sreekanth.reddy@broadcom.com>
Date:   Tue Oct 10 18:41:18 2017 +0530

    scsi: mpt3sas: Fix IO error occurs on pulling out a drive from RAID1 volume created on two SATA drive
    
    Whenever an I/O for a RAID volume fails with IOCStatus
    MPI2_IOCSTATUS_SCSI_IOC_TERMINATED and SCSIStatus equal to
    (MPI2_SCSI_STATE_TERMINATED | MPI2_SCSI_STATE_NO_SCSI_STATUS) then
    return the I/O to SCSI midlayer with "DID_RESET" (i.e. retry the IO
    infinite times) set in the host byte.
    
    Previously, the driver was completing the I/O with "DID_SOFT_ERROR"
    which causes the I/O to be quickly retried. However, firmware needed
    more time and hence I/Os were failing.
    
    Signed-off-by: Sreekanth Reddy <Sreekanth.Reddy@broadcom.com>
    Reviewed-by: Tomas Henzl <thenzl@redhat.com>
    Signed-off-by: Martin K. Petersen <martin.petersen@oracle.com>

commit b99b199378afac7675876adc170d82d7a4442330
Author: Sreekanth Reddy <sreekanth.reddy@broadcom.com>
Date:   Tue Oct 10 18:41:14 2017 +0530

    scsi: mpt3sas: Processing of Cable Exception events
    
    Earlier Active Cable Exception event with reason code "Cable Degraded
    (0x02))" was added only for Active Cable. Now this event is extended to
    Passive cable too. Re-arranged display message accordingly.
    
    Also added Cable Exception Event event for SAS3008 & SAS3108 HBAs
    (i.e. MPI 2.5 spec supporting HBAs). Previously, this event was enabled
    only for MPI 2.6 spec supporting HBA devices.
    
    [mkp: typos]
    
    Signed-off-by: Sreekanth Reddy <Sreekanth.Reddy@broadcom.com>
    Reviewed-by: Tomas Henzl <thenzl@redhat.com>
    Signed-off-by: Martin K. Petersen <martin.petersen@oracle.com>

commit 703937f005ea09ac2b6da593a9cec0befcb7b22a
Author: Andrey Ryabinin <aryabinin@virtuozzo.com>
Date:   Thu Nov 24 13:23:10 2016 +0000

    mpi: Fix NULL ptr dereference in mpi_powm() [ver #3]
    
    commit f5527fffff3f002b0a6b376163613b82f69de073 upstream.
    
    This fixes CVE-2016-8650.
    
    If mpi_powm() is given a zero exponent, it wants to immediately return
    either 1 or 0, depending on the modulus.  However, if the result was
    initalised with zero limb space, no limbs space is allocated and a
    NULL-pointer exception ensues.
    
    Fix this by allocating a minimal amount of limb space for the result when
    the 0-exponent case when the result is 1 and not touching the limb space
    when the result is 0.
    
    This affects the use of RSA keys and X.509 certificates that carry them.
    
    BUG: unable to handle kernel NULL pointer dereference at           (null)
    IP: [<ffffffff8138ce5d>] mpi_powm+0x32/0x7e6
    PGD 0
    Oops: 0002 [#1] SMP
    Modules linked in:
    CPU: 3 PID: 3014 Comm: keyctl Not tainted 4.9.0-rc6-fscache+ #278
    Hardware name: ASUS All Series/H97-PLUS, BIOS 2306 10/09/2014
    task: ffff8804011944c0 task.stack: ffff880401294000
    RIP: 0010:[<ffffffff8138ce5d>]  [<ffffffff8138ce5d>] mpi_powm+0x32/0x7e6
    RSP: 0018:ffff880401297ad8  EFLAGS: 00010212
    RAX: 0000000000000000 RBX: ffff88040868bec0 RCX: ffff88040868bba0
    RDX: ffff88040868b260 RSI: ffff88040868bec0 RDI: ffff88040868bee0
    RBP: ffff880401297ba8 R08: 0000000000000000 R09: 0000000000000000
    R10: 0000000000000047 R11: ffffffff8183b210 R12: 0000000000000000
    R13: ffff8804087c7600 R14: 000000000000001f R15: ffff880401297c50
    FS:  00007f7a7918c700(0000) GS:ffff88041fb80000(0000) knlGS:0000000000000000
    CS:  0010 DS: 0000 ES: 0000 CR0: 0000000080050033
    CR2: 0000000000000000 CR3: 0000000401250000 CR4: 00000000001406e0
    Stack:
     ffff88040868bec0 0000000000000020 ffff880401297b00 ffffffff81376cd4
     0000000000000100 ffff880401297b10 ffffffff81376d12 ffff880401297b30
     ffffffff81376f37 0000000000000100 0000000000000000 ffff880401297ba8
    Call Trace:
     [<ffffffff81376cd4>] ? __sg_page_iter_next+0x43/0x66
     [<ffffffff81376d12>] ? sg_miter_get_next_page+0x1b/0x5d
     [<ffffffff81376f37>] ? sg_miter_next+0x17/0xbd
     [<ffffffff8138ba3a>] ? mpi_read_raw_from_sgl+0xf2/0x146
     [<ffffffff8132a95c>] rsa_verify+0x9d/0xee
     [<ffffffff8132acca>] ? pkcs1pad_sg_set_buf+0x2e/0xbb
     [<ffffffff8132af40>] pkcs1pad_verify+0xc0/0xe1
     [<ffffffff8133cb5e>] public_key_verify_signature+0x1b0/0x228
     [<ffffffff8133d974>] x509_check_for_self_signed+0xa1/0xc4
     [<ffffffff8133cdde>] x509_cert_parse+0x167/0x1a1
     [<ffffffff8133d609>] x509_key_preparse+0x21/0x1a1
     [<ffffffff8133c3d7>] asymmetric_key_preparse+0x34/0x61
     [<ffffffff812fc9f3>] key_create_or_update+0x145/0x399
     [<ffffffff812fe227>] SyS_add_key+0x154/0x19e
     [<ffffffff81001c2b>] do_syscall_64+0x80/0x191
     [<ffffffff816825e4>] entry_SYSCALL64_slow_path+0x25/0x25
    Code: 56 41 55 41 54 53 48 81 ec a8 00 00 00 44 8b 71 04 8b 42 04 4c 8b 67 18 45 85 f6 89 45 80 0f 84 b4 06 00 00 85 c0 75 2f 41 ff ce <49> c7 04 24 01 00 00 00 b0 01 75 0b 48 8b 41 18 48 83 38 01 0f
    RIP  [<ffffffff8138ce5d>] mpi_powm+0x32/0x7e6
     RSP <ffff880401297ad8>
    CR2: 0000000000000000
    ---[ end trace d82015255d4a5d8d ]---
    
    Basically, this is a backport of a libgcrypt patch:
    
            http://git.gnupg.org/cgi-bin/gitweb.cgi?p=libgcrypt.git;a=patch;h=6e1adb05d290aeeb1c230c763970695f4a538526
    
    Fixes: cdec9cb5167a ("crypto: GnuPG based MPI lib - source files (part 1)")
    Signed-off-by: Andrey Ryabinin <aryabinin@virtuozzo.com>
    Signed-off-by: David Howells <dhowells@redhat.com>
    cc: Dmitry Kasatkin <dmitry.kasatkin@gmail.com>
    cc: linux-ima-devel@lists.sourceforge.net
    Signed-off-by: James Morris <james.l.morris@oracle.com>
    Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>

commit e83f374247c310bc558c8626fbfcc03f22f9bf02
Author: Arnd Bergmann <arnd@arndb.de>
Date:   Thu Oct 5 22:39:37 2017 +0200

    spi: spreadtrum adi: add hwspinlock dependency
    
    With CONFIG_HWSPINLOCK=m, the new driver fails to link as a built-in driver:
    
    drivers/spi/spi-sprd-adi.o: In function `sprd_adi_remove':
    spi-sprd-adi.c:(.text+0x18): undefined reference to `hwspin_lock_free'
    drivers/spi/spi-sprd-adi.o: In function `sprd_adi_probe':
    spi-sprd-adi.c:(.text+0xfc): undefined reference to `of_hwspin_lock_get_id'
    spi-sprd-adi.c:(.text+0x108): undefined reference to `hwspin_lock_request_specific'
    spi-sprd-adi.c:(.text+0x268): undefined reference to `hwspin_lock_free'
    
    This adds a hard Kconfig dependency on HWSPINLOCK for the !COMPILE_TEST
    case, and allows compile-testing with HWSPINLOCK completely disabled,
    which will then rely on the existing stub API.
    
    Fixes: 7e2903cb91df ("spi: Add ADI driver for Spreadtrum platform")
    Signed-off-by: Arnd Bergmann <arnd@arndb.de>
    Signed-off-by: Mark Brown <broonie@kernel.org>

commit 42b76d0e6b1fe0fcb90e0ff6b4d053d50597b031
Merge: e0a86312874e 08f8c8808c92
Author: Linus Torvalds <torvalds@linux-foundation.org>
Date:   Wed Oct 4 17:16:05 2017 -0700

    Merge tag 'armsoc-fixes' of git://git.kernel.org/pub/scm/linux/kernel/git/arm/arm-soc
    
    Pull ARM SoC fixes from Olof Johansson:
     "Our first batch of fixes this release cycle, unfortunately a bit
      noisier than usual. Two major groups stand out:
    
       - Some pinctril dts/dtsi changes for stm32 due to a new driver being
         merged during the merge window, and this aligns the DT contents
         between the old format and the new. This could arguably be moved to
         the next merge window but it also seemed relatively harmless to
         include now.
    
       - Amlogic/meson had driver changes merged that required devicetree
         changes to avoid functional/performance regressions. I've already
         asked them to be more careful about this going forward, and making
         sure drivers are compatible with older DTs when they make these
         kind of changes. The platform is actively being upstreamed so
         there's a few things in flight, we've seen this happen before and
         sometimes it's hard to catch in time.
    
      Besides that there is the usual mix of minor fixes"
    
    * tag 'armsoc-fixes' of git://git.kernel.org/pub/scm/linux/kernel/git/arm/arm-soc: (33 commits)
      ARM: dts: stm32: use right pinctrl compatible for stm32f469
      ARM: dts: stm32: Fix STMPE1600 binding on stm32429i-eval board
      ARM: defconfig: update Gemini defconfig
      ARM: defconfig: FRAMEBUFFER_CONSOLE can no longer be =m
      arm64: dts: rockchip: add the grf clk for dw-mipi-dsi on rk3399
      reset: Restrict RESET_HSDK to ARC_SOC_HSDK or COMPILE_TEST
      ARM: dts: da850-evm: add serial and ethernet aliases
      ARM: dts: am43xx-epos-evm: Remove extra CPSW EMAC entry
      ARM: dts: am33xx: Add spi alias to match SOC schematics
      ARM: OMAP2+: hsmmc: fix logic to call either omap_hsmmc_init or omap_hsmmc_late_init but not both
      ARM: dts: dra7: Set a default parent to mcasp3_ahclkx_mux
      ARM: OMAP2+: dra7xx: Set OPT_CLKS_IN_RESET flag for gpio1
      ARM: dts: nokia n900: drop unneeded/undocumented parts of the dts
      arm64: dts: rockchip: Correct MIPI DPHY PLL clock on rk3399
      arm64: dt marvell: Fix AP806 system controller size
      MAINTAINERS: add Macchiatobin maintainers entry
      ARC: reset: remove the misleading v1 suffix all over
      ARC: reset: add missing DT binding documentation for HSDKv1 reset driver
      ARC: reset: Only build on archs that have IOMEM
      ARM: at91: Replace uses of virt_to_phys with __pa_symbol
      ...

commit ccaac16287f9b46c58777f5538c4ba3a9d4c3aeb
Author: Mark Rutland <mark.rutland@arm.com>
Date:   Wed Sep 27 14:50:38 2017 +0100

    arm64: consistently log boot/secondary CPU IDs
    
    Currently we inconsistently log identifying information for the boot CPU
    and secondary CPUs. For the boot CPU, we log the MIDR and MPIDR across
    separate messages, whereas for the secondary CPUs we only log the MIDR.
    
    In some cases, it would be useful to know the MPIDR of secondary CPUs,
    and it would be nice for these messages to be consistent.
    
    This patch ensures that in the primary and secondary boot paths, we log
    both the MPIDR and MIDR in a single message, with a consistent format.
    the MPIDR is consistently padded to 10 hex characters to cover Aff3 in
    bits 39:32, so that IDs can be compared easily.
    
    The newly redundant message in setup_arch() is removed.
    
    Signed-off-by: Mark Rutland <mark.rutland@arm.com>
    Cc: Al Stone <ahs3@redhat.com>
    Cc: Catalin Marinas <catalin.marinas@arm.com>
    Cc: Will Deacon <will.deacon@arm.com>
    [will: added '0x' prefixes consistently]
    Signed-off-by: Will Deacon <will.deacon@arm.com>

commit 180eb4f17eab106982ef100787a485974bef4749
Merge: 5f3daa239388 544e3bf4f0e8
Author: Olof Johansson <olof@lixom.net>
Date:   Tue Oct 3 18:10:12 2017 -0700

    Merge tag 'reset-fixes-for-4.14' of git://git.pengutronix.de/git/pza/linux into fixes
    
    Reset controller fixes for v4.14
    
    - Remove misleading HSDK v1 suffix, as there is no v2 planned
    - Add missing DT binding documentation for HSDK reset driver
    - Fix HSDK reset driver dependencies
    
    * tag 'reset-fixes-for-4.14' of git://git.pengutronix.de/git/pza/linux:
      reset: Restrict RESET_HSDK to ARC_SOC_HSDK or COMPILE_TEST
      ARC: reset: remove the misleading v1 suffix all over
      ARC: reset: add missing DT binding documentation for HSDKv1 reset driver
      ARC: reset: Only build on archs that have IOMEM
    
    Signed-off-by: Olof Johansson <olof@lixom.net>

commit f16dc0aa5ea20a2cf173e82ade5f05bfecaa850a
Author: Shiraz Saleem <shiraz.saleem@intel.com>
Date:   Tue Sep 19 09:19:13 2017 -0500

    i40iw: Add support for port reuse on active side connections
    
    During OpenMPI scale up testing, we observe rdma_connect
    failures if ports are reused on multiple connections.
    This is because the Control Queue-Pair (CQP) command to add
    the reused port to Accelerated Port Bit VectorTable (APBVT)
    fails as there already exists an entry.
    
    Check for duplicate port before invoking the CQP command
    to add APBVT entry and delete the entry only if the port
    is not in use.
    
    Signed-off-by: Shiraz Saleem <shiraz.saleem@intel.com>
    Signed-off-by: Doug Ledford <dledford@redhat.com>

commit 8050ef2b83a18f628f9501af958fbff39443d58d
Author: Shuah Khan <shuahkh@osg.samsung.com>
Date:   Wed Sep 6 18:36:22 2017 -0600

    selftests: lib.mk: kselftest and kselftest-clean fail for make O=dir case
    
    kselftest and kselftest-clean targets fail when object directory is
    specified to relocate objects. Main Makefile make O= path clears the
    built-in defines LINK.c, COMPILE.S, LINK.S, and RM that are used in
    lib.mk to build and clean targets. Define them.
    
    Signed-off-by: Shuah Khan <shuahkh@osg.samsung.com>

commit 544e3bf4f0e8278400f19ca7918a3cdf2548b4eb
Author: Geert Uytterhoeven <geert@linux-m68k.org>
Date:   Mon Sep 11 14:22:08 2017 +0200

    reset: Restrict RESET_HSDK to ARC_SOC_HSDK or COMPILE_TEST
    
    The HSDK reset driver is only useful when building for an ARC HSDK
    platform.
    
    While at it, drop the "default n", as that is the default.
    
    Fixes: e0be864f14240cb1 ("ARC: reset: introduce HSDKv1 reset driver")
    Signed-off-by: Geert Uytterhoeven <geert@linux-m68k.org>
    [p.zabel@pengutronix.de: rebased, renamed RESET_HSDK_V1 to RESET_HSDK]
    Signed-off-by: Philipp Zabel <p.zabel@pengutronix.de>

commit 986a5f70173626eea9863fee6d6e029f0f2bc361
Author: Geert Uytterhoeven <geert@linux-m68k.org>
Date:   Mon Sep 11 14:34:34 2017 +0200

    iommu/qcom: Depend on HAS_DMA to fix compile error
    
    If NO_DMA=y:
    
        warning: (IPMMU_VMSA && ARM_SMMU && ARM_SMMU_V3 && QCOM_IOMMU) selects IOMMU_IO_PGTABLE_LPAE which has unmet direct dependencies (IOMMU_SUPPORT && HAS_DMA && (ARM || ARM64 || COMPILE_TEST && !GENERIC_ATOMIC64))
    
    and
    
        drivers/iommu/io-pgtable-arm.o: In function `__arm_lpae_sync_pte':
        io-pgtable-arm.c:(.text+0x206): undefined reference to `bad_dma_ops'
        drivers/iommu/io-pgtable-arm.o: In function `__arm_lpae_free_pages':
        io-pgtable-arm.c:(.text+0x6a6): undefined reference to `bad_dma_ops'
        drivers/iommu/io-pgtable-arm.o: In function `__arm_lpae_alloc_pages':
        io-pgtable-arm.c:(.text+0x812): undefined reference to `bad_dma_ops'
        io-pgtable-arm.c:(.text+0x81c): undefined reference to `bad_dma_ops'
        io-pgtable-arm.c:(.text+0x862): undefined reference to `bad_dma_ops'
        drivers/iommu/io-pgtable-arm.o: In function `arm_lpae_run_tests':
        io-pgtable-arm.c:(.init.text+0x86): undefined reference to `alloc_io_pgtable_ops'
        io-pgtable-arm.c:(.init.text+0x47c): undefined reference to `free_io_pgtable_ops'
        drivers/iommu/qcom_iommu.o: In function `qcom_iommu_init_domain':
        qcom_iommu.c:(.text+0x1ce): undefined reference to `alloc_io_pgtable_ops'
        drivers/iommu/qcom_iommu.o: In function `qcom_iommu_domain_free':
        qcom_iommu.c:(.text+0x754): undefined reference to `free_io_pgtable_ops'
    
    QCOM_IOMMU selects IOMMU_IO_PGTABLE_LPAE, which bypasses its dependency
    on HAS_DMA.  Make QCOM_IOMMU depend on HAS_DMA to fix this.
    
    Fixes: 0ae349a0f33fb040 ("iommu/qcom: Add qcom_iommu")
    Signed-off-by: Geert Uytterhoeven <geert@linux-m68k.org>
    Signed-off-by: Joerg Roedel <jroedel@suse.de>

commit a4aaeccc7a91e24cc17f72a7eb2f586f5c3d811d
Author: Guenter Roeck <linux@roeck-us.net>
Date:   Sun Sep 10 13:43:37 2017 -0700

    iommu: Add missing dependencies
    
    parisc:allmodconfig, xtensa:allmodconfig, and possibly others generate
    the following Kconfig warning.
    
    warning: (IPMMU_VMSA && ARM_SMMU && ARM_SMMU_V3 && QCOM_IOMMU) selects
    IOMMU_IO_PGTABLE_LPAE which has unmet direct dependencies (IOMMU_SUPPORT &&
    HAS_DMA && (ARM || ARM64 || COMPILE_TEST && !GENERIC_ATOMIC64))
    
    IOMMU_IO_PGTABLE_LPAE depends on (COMPILE_TEST && !GENERIC_ATOMIC64),
    so any configuration option selecting it needs to have the same dependencies.
    
    Signed-off-by: Guenter Roeck <linux@roeck-us.net>
    Signed-off-by: Joerg Roedel <jroedel@suse.de>

commit dc122c5c136fe10591313e7ef9f8d2c8e7309333
Author: Robert Jarzmik <robert.jarzmik@free.fr>
Date:   Mon Jun 5 13:59:15 2017 +0200

    tags: honor COMPILED_SOURCE with apart output directory
    
    commit cbf52a3e6a8a92beec6e0c70abf4111cd8f8faf7 upstream.
    
    When the kernel is compiled with an "O=" argument, the object files are
    not in the source tree, but in the build tree.
    
    This patch fixes O= build by looking for object files in the build tree.
    
    Fixes: 923e02ecf3f8 ("scripts/tags.sh: Support compiled source")
    Signed-off-by: Robert Jarzmik <robert.jarzmik@free.fr>
    Signed-off-by: Masahiro Yamada <yamada.masahiro@socionext.com>
    Signed-off-by: Ben Hutchings <ben@decadent.org.uk>

commit ba768535b467bb2d342a1581450394f1148dc8ae
Merge: 7a95bdb092c6 79d2c8bede2c
Author: Linus Torvalds <torvalds@linux-foundation.org>
Date:   Thu Sep 14 13:01:09 2017 -0700

    Merge tag 'pinctrl-v4.14-2' of git://git.kernel.org/pub/scm/linux/kernel/git/linusw/linux-pinctrl
    
    Pull pin control fixes from Linus Walleij:
     "This slew of fixes for pin control was noticed and patched up early,
      so to get the annoyance out of the way for -rc1 it would make sense to
      send them already.
    
       - Fix a build include in the Uniphier driver to keep pace with
         ongoing refactorings.
    
       - Fix a slew of minor semantic and syntactic issues as well as
         stricting up Kconfig for the new Spreadtrum driver.
    
       - Fix the GPIO interrupt set-up on the Marvell 37xx Armada as fallout
         for dynamically allocating irq descriptors from the core. (Also
         tagged for stable.)
    
       - Fix AMD register suspend/resume state spool/unspooling so that
         wakeup works as it should. (Also tagged for stable.)"
    
    * tag 'pinctrl-v4.14-2' of git://git.kernel.org/pub/scm/linux/kernel/git/linusw/linux-pinctrl:
      pinctrl/amd: save pin registers over suspend/resume
      pinctrl: armada-37xx: Fix gpio interrupt setup
      pinctrl: sprd: fix off by one bugs
      pinctrl: sprd: check for allocation failure
      pinctrl: sprd: Restrict PINCTRL_SPRD to ARCH_SPRD or COMPILE_TEST
      pinctrl: sprd: fix build errors and dependencies
      pinctrl: sprd: make three local functions static
      pinctrl: uniphier: include <linux/build_bug.h> instead of <linux/bug.h>

commit 9386aae907d9ee79d54640f09d70909393e0ddeb
Author: Han Xu <b45815@freescale.com>
Date:   Fri Oct 23 13:18:28 2015 -0500

    mtd: fsl-quadspi: fix macro collision problems with READ/WRITE
    
    [ Upstream commit 04850c4d8613127a9b488321c0ad83bff7519311 ]
    
    Change the READ/WRITE to FSL_READ/FSL_WRITE to resolve any possible
    namespace collisions with READ/WRITE macros (e.g., from <linux/fs.h>).
    
    Problems have been seen, for example, on mips:
    
    >> drivers/mtd/spi-nor/fsl-quadspi.c:186:5: error: 'LUT_0' undeclared (first use in this function)
          ((LUT_##ins) << INSTR0_SHIFT))
            ^
    >> drivers/mtd/spi-nor/fsl-quadspi.c:188:30: note: in expansion of macro 'LUT0'
    
    On SPARC:
    
    drivers/mtd/spi-nor/fsl-quadspi.c: In function 'fsl_qspi_init_lut':
    drivers/mtd/spi-nor/fsl-quadspi.c:369:1: error: 'LUT_0' undeclared (first use in this function)
    drivers/mtd/spi-nor/fsl-quadspi.c:418:1: error: pasting "LUT_" and "(" does not give a valid preprocessing token
    drivers/mtd/spi-nor/fsl-quadspi.c:418:2: error: implicit declaration of function 'LUT_'
    
    And surely on others.
    
    Fixes: d26a22d06708 ("mtd: fsl-quadspi: allow building for other ARCHes with COMPILE_TEST")
    Reported-by: Guenter Roeck <linux@roeck-us.net>
    Reported-by: kbuild test robot <fengguang.wu@intel.com>
    Signed-off-by: Han Xu <b45815@freescale.com>
    [Brian: rewrote commit description]
    Signed-off-by: Brian Norris <computersforpeace@gmail.com>
    
    Signed-off-by: Sasha Levin <alexander.levin@verizon.com>

commit baec7e687aa066f6fa257222a0def5ea9b5b1c40
Author: Geert Uytterhoeven <geert+renesas@glider.be>
Date:   Wed Sep 6 18:08:05 2017 +0200

    pinctrl: sprd: Restrict PINCTRL_SPRD to ARCH_SPRD or COMPILE_TEST
    
    The Spreadtrum pinctrl drivers are only useful when building for a
    Spreadtrum platform.
    
    Signed-off-by: Geert Uytterhoeven <geert+renesas@glider.be>
    Signed-off-by: Linus Walleij <linus.walleij@linaro.org>

commit 35aed4acb9cec6e4e250674dd3060044dbda6e68
Merge: d36b82bcdd19 89273bc060d8
Author: David S. Miller <davem@davemloft.net>
Date:   Wed Aug 30 15:17:46 2017 -0700

    Merge branch 'mvpp2-comphy'
    
    Antoine Tenart says:
    
    ====================
    net: mvpp2: comphy configuration
    
    This series, following up the one one the GoP/MAC configuration, aims at
    stopping to depend on the firmware/bootloader configuration when using
    the PPv2 engine. With this series the PPv2 driver does not need to rely
    on a previous configuration, and dynamic reconfiguration while the
    kernel is running can be done (i.e. switch one port from SGMII to 10G,
    or the opposite). A port can now be configured in a different mode than
    what's done in the firmware/bootloader as well.
    
    The series first contain patches in the generic PHY framework to support
    what is called the comphy (common PHYs), which is an h/w block providing
    PHYs that can be configured in various modes ranging from SGMII, 10G
    to SATA and others. As of now only the SGMII and 10G modes are
    supported by the comphy driver.
    
    Then patches are modifying the PPv2 driver to first add the comphy
    initialization sequence (i.e. calls to the generic PHY framework) and to
    then take advantage of this to allow dynamic reconfiguration (i.e.
    configuring the mode of a port given what's connected, between sgmii and
    10G). Note the use of the comphy in the PPv2 driver is kept optional
    (i.e. if not described in dt the driver still as before an relies on the
    firmware/bootloader configuration).
    
    Finally there are dt/defconfig patches to describe and take advantage of
    this.
    
    This was tested on a range of devices: 8040-db, 8040-mcbin and 7040-db.
    
    @Dave: the dt patches should go through the mvebu tree (patches 9-13).
    
    Thanks!
    Antoine
    
    Since v3:
      - Now use of_phy_simple_xlate() to retrieve the phy.
      - Added an owner in the phy_ops structure.
      - Now allow the module to be selected with COMPILE_TEST.
      - Removed unused parameter in the comphy set_mode functions.
      - Added Kishon Acked-by in patch 1.
    
    Since v2:
      - Kept the link mode enforcement.
      - Removed the netif_running() check.
      - Reworded the "dynamic reconfiguration of the PHY mode" commit log.
      - Added one patch not to force the GMAC autoneg parameters when using
        the XLG MAC.
    
    Since v1:
      - Updated the mode settings variable name in the comphy driver to
        have 'cp110' in it.
      - Documented the PHY cell argument in the dt documentation.
      - New patch adding comphy phandles for the 7040-db board.
      - Checked if the carrier_on/off functions were needed. They are.
      - s/PHY/generic PHY/ in commit log of patch 1.
      - Rebased on the latest net-next/master.
    ====================
    
    Signed-off-by: David S. Miller <davem@davemloft.net>

commit 9c2c849625cf779e0fac41c8be3c163df4b80c14
Author: Artemy Kovalyov <artemyko@mellanox.com>
Date:   Thu Aug 17 15:52:05 2017 +0300

    IB/core: Add new SRQ type IB_SRQT_TM
    
    This patch adds new SRQ type - IB_SRQT_TM. The new SRQ type supports tag
    matching and rendezvous offloads for MPI applications.
    
    When SRQ receives a message it will search through the matching list
    for the corresponding posted receive buffer. The process of searching
    the matching list is called tag matching.
    In case the tag matching results in a match, the received message will
    be placed in the address specified by the receive buffer. In case no
    match was found the message will be placed in a generic buffer until the
    corresponding receive buffer will be posted. These messages are called
    unexpected and their set is called an unexpected list.
    
    Signed-off-by: Artemy Kovalyov <artemyko@mellanox.com>
    Reviewed-by: Yossi Itigin <yosefe@mellanox.com>
    Signed-off-by: Leon Romanovsky <leon@kernel.org>
    Signed-off-by: Doug Ledford <dledford@redhat.com>

commit 7c2173a8169111df531cd75cb967ea3a01ded682
Author: Andrew Jones <drjones@redhat.com>
Date:   Tue Apr 18 17:59:58 2017 +0200

    KVM: arm/arm64: fix races in kvm_psci_vcpu_on
    
    commit 6c7a5dce22b3f3cc44be098e2837fa6797edb8b8 upstream.
    
    Fix potential races in kvm_psci_vcpu_on() by taking the kvm->lock
    mutex.  In general, it's a bad idea to allow more than one PSCI_CPU_ON
    to process the same target VCPU at the same time.  One such problem
    that may arise is that one PSCI_CPU_ON could be resetting the target
    vcpu, which fills the entire sys_regs array with a temporary value
    including the MPIDR register, while another looks up the VCPU based
    on the MPIDR value, resulting in no target VCPU found.  Resolves both
    races found with the kvm-unit-tests/arm/psci unit test.
    
    Reviewed-by: Marc Zyngier <marc.zyngier@arm.com>
    Reviewed-by: Christoffer Dall <cdall@linaro.org>
    Reported-by: Levente Kurusa <lkurusa@redhat.com>
    Suggested-by: Christoffer Dall <cdall@linaro.org>
    Signed-off-by: Andrew Jones <drjones@redhat.com>
    Signed-off-by: Christoffer Dall <cdall@linaro.org>
    Signed-off-by: Ben Hutchings <ben@decadent.org.uk>

commit 98aaa913b4ed250324429f0a9e6d5f77a3b5276c
Author: Mike Maloney <maloney@google.com>
Date:   Tue Aug 22 17:08:48 2017 -0400

    tcp: Extend SOF_TIMESTAMPING_RX_SOFTWARE to TCP recvmsg
    
    When SOF_TIMESTAMPING_RX_SOFTWARE is enabled for tcp sockets, return the
    timestamp corresponding to the highest sequence number data returned.
    
    Previously the skb->tstamp is overwritten when a TCP packet is placed
    in the out of order queue.  While the packet is in the ooo queue, save the
    timestamp in the TCB_SKB_CB.  This space is shared with the gso_*
    options which are only used on the tx path, and a previously unused 4
    byte hole.
    
    When skbs are coalesced either in the sk_receive_queue or the
    out_of_order_queue always choose the timestamp of the appended skb to
    maintain the invariant of returning the timestamp of the last byte in
    the recvmsg buffer.
    
    Signed-off-by: Mike Maloney <maloney@google.com>
    Acked-by: Willem de Bruijn <willemb@google.com>
    Signed-off-by: David S. Miller <davem@davemloft.net>

commit 3e5f0881f17525e3b49835947a5e0cf2d681b1e2
Author: Matan Barak <matanb@mellanox.com>
Date:   Tue Jul 25 17:29:06 2017 +0300

    IB/hns: Avoid compile test under non 64bit environments
    
    The hns driver uses __raw_writeq which is only defined in 64BIT
    environments. Trying to compile the driver in a 32BIT environment
    results in errors. Only COMPILE_TEST when 64BIT is defined.
    
    Fixes: 7d1b6a678e0b ("IB/hns: Support compile test for hns RoCE driver")
    Signed-off-by: Matan Barak <matanb@mellanox.com>
    Signed-off-by: Doug Ledford <dledford@redhat.com>

commit aa6c16c43b73b0e4042d84fece85111da1a8087f
Author: Arnd Bergmann <arnd@arndb.de>
Date:   Tue Aug 1 13:50:56 2017 +0200

    net: bcmgenet: drop COMPILE_TEST dependency
    
    The last patch added the dependency on 'OF && HAS_IOMEM' but left
    COMPILE_TEST as an alternative, which kind of defeats the purpose
    of adding the dependency, we still get randconfig build warnings:
    
    warning: (NET_DSA_BCM_SF2 && BCMGENET) selects MDIO_BCM_UNIMAC which has unmet direct dependencies (NETDEVICES && MDIO_BUS && HAS_IOMEM && OF_MDIO)
    
    For compile-testing purposes, we don't really need this anyway,
    as CONFIG_OF can be enabled on all architectures, and HAS_IOMEM
    is present on all architectures we do meaningful compile-testing on
    (the exception being arch/um).
    
    This makes both OF and HAS_IOMEM hard dependencies.
    
    Fixes: 5af74bb4fcf8 ("net: bcmgenet: Add dependency on HAS_IOMEM && OF")
    Signed-off-by: Arnd Bergmann <arnd@arndb.de>
    Reviewed-by: Florian Fainelli <f.fainelli@gmail.com>
    Signed-off-by: David S. Miller <davem@davemloft.net>

commit 5af74bb4fcf8935cff38757400c25ae10eed4fd6
Author: Florian Fainelli <f.fainelli@gmail.com>
Date:   Mon Jul 31 17:53:07 2017 -0700

    net: bcmgenet: Add dependency on HAS_IOMEM && OF
    
    The driver needs CONFIG_HAS_IOMEM and OF to be functional, but we still
    let it build with COMPILE_TEST. This fixes the unmet dependency after
    selecting MDIO_BCM_UNIMAC in commit mentioned below:
    
    warning: (NET_DSA_BCM_SF2 && BCMGENET) selects MDIO_BCM_UNIMAC which has
    unmet direct dependencies (NETDEVICES && MDIO_DEVICE && HAS_IOMEM &&
    OF_MDIO)
    
    Fixes: 9a4e79697009 ("net: bcmgenet: utilize generic Broadcom UniMAC MDIO controller driver")
    Signed-off-by: Florian Fainelli <f.fainelli@gmail.com>
    Signed-off-by: David S. Miller <davem@davemloft.net>

commit bb7c19f96012720b895111300b9d9f3f858c3a69
Author: Wei Wang <weiwan@google.com>
Date:   Fri Jul 28 10:28:21 2017 -0700

    tcp: add related fields into SCM_TIMESTAMPING_OPT_STATS
    
    Add the following stats into SCM_TIMESTAMPING_OPT_STATS control msg:
        TCP_NLA_PACING_RATE
        TCP_NLA_DELIVERY_RATE
        TCP_NLA_SND_CWND
        TCP_NLA_REORDERING
        TCP_NLA_MIN_RTT
        TCP_NLA_RECUR_RETRANS
        TCP_NLA_DELIVERY_RATE_APP_LMT
    
    Signed-off-by: Wei Wang <weiwan@google.com>
    Acked-by: Yuchung Cheng <ycheng@google.com>
    Acked-by: Soheil Hassas Yeganeh <soheil@google.com>
    Signed-off-by: David S. Miller <davem@davemloft.net>

commit 03274850279c8da86358adfdad1422a850b066ac
Author: Laurentiu Tudor <laurentiu.tudor@nxp.com>
Date:   Wed Jul 19 14:42:32 2017 +0300

    staging: fsl-mc: allow the driver compile multi-arch
    
    Add an alternate dependency on COMPILE_TEST, thus leaving
    this driver compile on other architectures.
    Also, other drivers depending on the bus are updated to depend
    on ARCH_LAYERSCAPE until they'll also be made multi-arch.
    This was compiled tested on:
     - booke powerpc (corenet{32,64}_smp_defconfig)
     - x86 (i386_defconfig, x86_64_defconfig, needs CONFIG_OF)
     - arm64 (defconfig)
    
    Signed-off-by: Laurentiu Tudor <laurentiu.tudor@nxp.com>
    Acked-by: Arnd Bergmann <arnd@arndb.de>
    Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>

commit efe967cdec32af93e15839cc639695ec5f637771
Author: Arnd Bergmann <arnd@arndb.de>
Date:   Fri Jul 28 16:41:37 2017 +0200

    tcp: avoid bogus gcc-7 array-bounds warning
    
    When using CONFIG_UBSAN_SANITIZE_ALL, the TCP code produces a
    false-positive warning:
    
    net/ipv4/tcp_output.c: In function 'tcp_connect':
    net/ipv4/tcp_output.c:2207:40: error: array subscript is below array bounds [-Werror=array-bounds]
       tp->chrono_stat[tp->chrono_type - 1] += now - tp->chrono_start;
                                            ^~
    net/ipv4/tcp_output.c:2207:40: error: array subscript is below array bounds [-Werror=array-bounds]
       tp->chrono_stat[tp->chrono_type - 1] += now - tp->chrono_start;
       ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^~~~~~~~~~~~~~~~~~~~~~~~~
    
    I have opened a gcc bug for this, but distros have already shipped
    compilers with this problem, and it's not clear yet whether there is
    a way for gcc to avoid the warning. As the problem is related to the
    bitfield access, this introduces a temporary variable to store the old
    enum value.
    
    I did not notice this warning earlier, since UBSAN is disabled when
    building with COMPILE_TEST, and that was always turned on in both
    allmodconfig and randconfig tests.
    
    Link: https://gcc.gnu.org/bugzilla/show_bug.cgi?id=81601
    Signed-off-by: Arnd Bergmann <arnd@arndb.de>
    Signed-off-by: David S. Miller <davem@davemloft.net>

commit 65c5ec11c25eff6ba6e9b1cbfff014875fddd1e0
Author: Michael Ellerman <mpe@ellerman.id.au>
Date:   Wed Jul 26 23:19:04 2017 +1000

    powerpc/boot: Fix 64-bit boot wrapper build with non-biarch compiler
    
    Historically the boot wrapper was always built 32-bit big endian, even
    for 64-bit kernels. That was because old firmwares didn't necessarily
    support booting a 64-bit image. Because of that arch/powerpc/boot/Makefile
    uses CROSS32CC for compilation.
    
    However when we added 64-bit little endian support, we also added
    support for building the boot wrapper 64-bit. However we kept using
    CROSS32CC, because in most cases it is just CC and everything works.
    
    However if the user doesn't specify CROSS32_COMPILE (which no one ever
    does AFAIK), and CC is *not* biarch (32/64-bit capable), then CROSS32CC
    becomes just "gcc". On native systems that is probably OK, but if we're
    cross building it definitely isn't, leading to eg:
    
      gcc ... -m64 -mlittle-endian -mabi=elfv2 ... arch/powerpc/boot/cpm-serial.c
      gcc: error: unrecognized argument in option -mabi=elfv2
      gcc: error: unrecognized command line option -mlittle-endian
      make: *** [zImage] Error 2
    
    To fix it, stop using CROSS32CC, because we may or may not be building
    32-bit. Instead setup a BOOTCC, which defaults to CC, and only use
    CROSS32_COMPILE if it's set and we're building for 32-bit.
    
    Fixes: 147c05168fc8 ("powerpc/boot: Add support for 64bit little endian wrapper")
    Signed-off-by: Michael Ellerman <mpe@ellerman.id.au>
    Reviewed-by: Cyril Bur <cyrilbur@gmail.com>

commit fe89168c4065885700fa4f755a5157392aaae03c
Author: Geert Uytterhoeven <geert@linux-m68k.org>
Date:   Tue Jul 25 09:12:18 2017 +0200

    soc: zte: Restrict SOC_ZTE to ARCH_ZX or COMPILE_TEST
    
    The ZTE SoC drivers are only useful when building for a ZTE ZX platform.
    
    Fixes: 4c2c2e39713b8cfb ("soc: zte: pm_domains: Prepare for supporting ARMv8 zx2967 family")
    Signed-off-by: Geert Uytterhoeven <geert@linux-m68k.org>
    Reviewed-by: Baoyou Xie <baoyou.xie@linaro.org>
    Signed-off-by: Arnd Bergmann <arnd@arndb.de>

commit b8f9bdc151e4a61eaa385900e580aad1e68f094b
Author: Arnd Bergmann <arnd@arndb.de>
Date:   Mon Jul 17 04:56:49 2017 -0400

    media: venus: fix compile-test build on non-qcom ARM platform
    
    If QCOM_MDT_LOADER is enabled, but ARCH_QCOM is not, we run into
    a build error:
    
    ERROR: "qcom_mdt_load" [drivers/media/platform/qcom/venus/venus-core.ko] undefined!
    ERROR: "qcom_mdt_get_size" [drivers/media/platform/qcom/venus/venus-core.ko] undefined!
    
    This changes the 'select' statement again, so we only try to enable
    those symbols when the drivers will actually get built, and explicitly
    test for QCOM_MDT_LOADER to be enabled before calling into it.
    
    Fixes: 76724b30f222 ("[media] media: venus: enable building with COMPILE_TEST")
    
    Signed-off-by: Arnd Bergmann <arnd@arndb.de>
    Reviewed-by: Stanimir Varbanov <stanimir.varbanov@linaro.org>
    Signed-off-by: Hans Verkuil <hans.verkuil@cisco.com>
    Signed-off-by: Mauro Carvalho Chehab <mchehab@s-opensource.com>

commit b40b2386bce982ad97f3683b2b34e589c3be5c5a
Author: Michael Ellerman <mpe@ellerman.id.au>
Date:   Wed Jul 26 15:00:42 2017 +1000

    powerpc/Makefile: Fix ld version check with 64-bit LE-only toolchain
    
    In commit efe0160cfd40 ("powerpc/64: Linker on-demand sfpr functions
    for modules"), we added an ld version check early in the powerpc
    top-level Makefile.
    
    Because the Makefile runs before the kernel config is setup, the
    checks for CONFIG_CPU_LITTLE_ENDIAN etc. all take the default case. So
    we end up configuring ld for 32-bit big endian.
    
    That would be OK, except that for historical (or perhaps no) reason,
    we use 'override LD' to add the endian flags to the LD variable
    itself, rather than the normal approach of adding them to LDFLAGS.
    
    The end result is that when we check the ld version we run it as:
    
      $(CROSS_COMPILE)ld -EB -m elf32ppc --version
    
    This often works, unless you are using a 64-bit only and/or little
    endian only, toolchain. In which case you see something like:
    
      $ make defconfig
      powerpc64le-linux-ld: unrecognised emulation mode: elf32ppc
      Supported emulations: elf64lppc elf32lppc elf32lppclinux elf32lppcsim
      /bin/sh: 1: [: -ge: unexpected operator
    
    The proper fix is to stop using 'override LD', but that will require a
    fair bit of testing. Instead we can fix it for now just by reordering
    the Makefile to do the version check earlier.
    
    Fixes: efe0160cfd40 ("powerpc/64: Linker on-demand sfpr functions for modules")
    Signed-off-by: Michael Ellerman <mpe@ellerman.id.au>

commit 0399b696f7f4ad4c48d59850d0e6adbed43c1d88
Author: Arnd Bergmann <arnd@arndb.de>
Date:   Mon Jul 17 04:56:49 2017 -0400

    media: venus: fix compile-test build on non-qcom ARM platform
    
    If QCOM_MDT_LOADER is enabled, but ARCH_QCOM is not, we run into
    a build error:
    
    ERROR: "qcom_mdt_load" [drivers/media/platform/qcom/venus/venus-core.ko] undefined!
    ERROR: "qcom_mdt_get_size" [drivers/media/platform/qcom/venus/venus-core.ko] undefined!
    
    This changes the 'select' statement again, so we only try to enable
    those symbols when the drivers will actually get built, and explicitly
    test for QCOM_MDT_LOADER to be enabled before calling into it.
    
    Fixes: 76724b30f222 ("[media] media: venus: enable building with COMPILE_TEST")
    
    Signed-off-by: Arnd Bergmann <arnd@arndb.de>
    Reviewed-by: Stanimir Varbanov <stanimir.varbanov@linaro.org>
    Signed-off-by: Hans Verkuil <hans.verkuil@cisco.com>
    Signed-off-by: Mauro Carvalho Chehab <mchehab@s-opensource.com>

commit a8f5cb9e79913a6918f87495d4969706f8817b8e
Author: Petr Kulhavy <brain@jikos.cz>
Date:   Thu Jul 13 19:40:57 2017 +0200

    smsc95xx: use ethtool_op_get_ts_info()
    
    This change enables the use of SW timestamping on Raspberry PI.
    
    smsc95xx uses the usbnet transmit function usbnet_start_xmit(), which
    implements software timestamping. However the SOF_TIMESTAMPING_TX_SOFTWARE
    capability was missing and only SOF_TIMESTAMPING_RX_SOFTWARE was announced.
    By using ethtool_op_get_ts_info() as get_ts_info() also the
    SOF_TIMESTAMPING_TX_SOFTWARE is announced.
    
    Signed-off-by: Petr Kulhavy <brain@jikos.cz>
    Reviewed-by: Woojung Huh <Woojung.Huh@microchip.com>
    Signed-off-by: David S. Miller <davem@davemloft.net>

commit 235b84fc862ae2637dc0dabada18d97f1bfc18e1
Merge: fb4e3beeffa4 8f1a357d41a2
Author: Linus Torvalds <torvalds@linux-foundation.org>
Date:   Wed Jul 12 10:04:56 2017 -0700

    Merge branch 'i2c/for-4.13' of git://git.kernel.org/pub/scm/linux/kernel/git/wsa/linux
    
    Pull i2c updates from Wolfram Sang:
     "This pull request contains:
    
       - i2c core reorganization. One source file became too monolithic. It
         is now split up, yet we still have the same named object as the
         final output. This should ease maintenance.
    
       - new drivers: ZTE ZX2967 family, ASPEED 24XX/25XX
    
       - designware driver gained slave mode support
    
       - xgene-slimpro driver gained ACPI support
    
       - bigger overhaul for pca-platform driver
    
       - the algo-bit module now supports messages with enforced STOP
    
       - slightly bigger than usual set of driver updates and improvements
    
      and with much appreciated quality assurance from Andy Shevchenko"
    
    * 'i2c/for-4.13' of git://git.kernel.org/pub/scm/linux/kernel/git/wsa/linux: (51 commits)
      i2c: Provide a stub for i2c_detect_slave_mode()
      i2c: designware: Let slave adapter support be optional
      i2c: designware: Make HW init functions static
      i2c: designware: fix spelling mistakes
      i2c: pca-platform: propagate error from i2c_pca_add_numbered_bus
      i2c: pca-platform: correctly set algo_data.reset_chip
      i2c: acpi: Do not create i2c-clients for LNXVIDEO ACPI devices
      i2c: designware: enable SLAVE in platform module
      i2c: designware: add SLAVE mode functions
      i2c: zx2967: drop COMPILE_TEST dependency
      i2c: zx2967: always use the same device when printing errors
      i2c: pca-platform: use dev_warn/dev_info instead of printk
      i2c: pca-platform: use device managed allocations
      i2c: pca-platform: add devicetree awareness
      i2c: pca-platform: switch to struct gpio_desc
      dt-bindings: add bindings for i2c-pca-platform
      i2c: cadance: fix ctrl/addr reg write order
      i2c: zx2967: add i2c controller driver for ZTE's zx2967 family
      dt: bindings: add documentation for zx2967 family i2c controller
      i2c: algo-bit: add support for I2C_M_STOP
      ...

commit fb4e3beeffa47619985f190663c6ef424f063a22
Merge: 6b1c776d3efb 6a7086431fa1
Author: Linus Torvalds <torvalds@linux-foundation.org>
Date:   Wed Jul 12 10:00:04 2017 -0700

    Merge tag 'iommu-updates-v4.13' of git://git.kernel.org/pub/scm/linux/kernel/git/joro/iommu
    
    Pull IOMMU updates from Joerg Roedel:
     "This update comes with:
    
       - Support for lockless operation in the ARM io-pgtable code.
    
         This is an important step to solve the scalability problems in the
         common dma-iommu code for ARM
    
       - Some Errata workarounds for ARM SMMU implemenations
    
       - Rewrite of the deferred IO/TLB flush code in the AMD IOMMU driver.
    
         The code suffered from very high flush rates, with the new
         implementation the flush rate is down to ~1% of what it was before
    
       - Support for amd_iommu=off when booting with kexec.
    
         The problem here was that the IOMMU driver bailed out early without
         disabling the iommu hardware, if it was enabled in the old kernel
    
       - The Rockchip IOMMU driver is now available on ARM64
    
       - Align the return value of the iommu_ops->device_group call-backs to
         not miss error values
    
       - Preempt-disable optimizations in the Intel VT-d and common IOVA
         code to help Linux-RT
    
       - Various other small cleanups and fixes"
    
    * tag 'iommu-updates-v4.13' of git://git.kernel.org/pub/scm/linux/kernel/git/joro/iommu: (60 commits)
      iommu/vt-d: Constify intel_dma_ops
      iommu: Warn once when device_group callback returns NULL
      iommu/omap: Return ERR_PTR in device_group call-back
      iommu: Return ERR_PTR() values from device_group call-backs
      iommu/s390: Use iommu_group_get_for_dev() in s390_iommu_add_device()
      iommu/vt-d: Don't disable preemption while accessing deferred_flush()
      iommu/iova: Don't disable preempt around this_cpu_ptr()
      iommu/arm-smmu-v3: Add workaround for Cavium ThunderX2 erratum #126
      iommu/arm-smmu-v3: Enable ACPI based HiSilicon CMD_PREFETCH quirk(erratum 161010701)
      iommu/arm-smmu-v3: Add workaround for Cavium ThunderX2 erratum #74
      ACPI/IORT: Fixup SMMUv3 resource size for Cavium ThunderX2 SMMUv3 model
      iommu/arm-smmu-v3, acpi: Add temporary Cavium SMMU-V3 IORT model number definitions
      iommu/io-pgtable-arm: Use dma_wmb() instead of wmb() when publishing table
      iommu/io-pgtable: depend on !GENERIC_ATOMIC64 when using COMPILE_TEST with LPAE
      iommu/arm-smmu-v3: Remove io-pgtable spinlock
      iommu/arm-smmu: Remove io-pgtable spinlock
      iommu/io-pgtable-arm-v7s: Support lockless operation
      iommu/io-pgtable-arm: Support lockless operation
      iommu/io-pgtable: Introduce explicit coherency
      iommu/io-pgtable-arm-v7s: Refactor split_blk_unmap
      ...

commit b6d0f14abb7c1d9d522c064633c820aaeb9bbfbf
Author: Will Deacon <will.deacon@arm.com>
Date:   Mon Jul 10 15:50:49 2017 -0700

    frv: cmpxchg: implement cmpxchg64()
    
    FRV supports 64-bit cmpxchg, which is provided by the arch code as
    __cmpxchg_64 and subsequently used to implement atomic64_cmpxchg.
    
    This patch hooks up the generic cmpxchg64 API using the same function,
    which also provides default definitions of the relaxed, acquire and
    release variants.  This fixes the build when COMPILE_TEST=y and
    IOMMU_IO_PGTABLE_LPAE=y.
    
    Link: http://lkml.kernel.org/r/1499084670-6996-1-git-send-email-will.deacon@arm.com
    Signed-off-by: Will Deacon <will.deacon@arm.com>
    Reported-by: kbuild test robot <fengguang.wu@intel.com>
    Cc: Joerg Roedel <joro@8bytes.org>
    Cc: Robin Murphy <robin.murphy@arm.com>
    Cc: Peter Zijlstra <peterz@infradead.org>
    Cc: Ingo Molnar <mingo@kernel.org>
    Cc: David Howells <dhowells@redhat.com>
    Signed-off-by: Andrew Morton <akpm@linux-foundation.org>
    Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>

commit ac1ca3ba9faae7e32f189edda14f6f147053d719
Author: Geert Uytterhoeven <geert@linux-m68k.org>
Date:   Sun Jul 9 21:30:32 2017 +0200

    ASoC: pxa: SND_PXA2XX_SOC should depend on HAS_DMA
    
    If NO_DMA=y:
    
        ERROR: "bad_dma_ops" [sound/soc/pxa/snd-soc-pxa2xx.ko] undefined!
        ERROR: "bad_dma_ops" [sound/arm/snd-pxa2xx-lib.ko] undefined!
        ERROR: "dma_common_mmap" [sound/arm/snd-pxa2xx-lib.ko] undefined!
    
    Add a dependency on HAS_DMA to fix this.
    
    Fixes: 73d7ee2e831f106c ("ASoC: pxa: add COMPILE_TEST on SND_PXA2XX_SOC")
    Signed-off-by: Geert Uytterhoeven <geert@linux-m68k.org>
    Acked-by: Robert Jarzmik <robert.jarzmik@free.fr>
    Signed-off-by: Mark Brown <broonie@kernel.org>

commit 0b49ce5a40702bf78a5f80076312b244785e9a2f
Merge: 920f2ecdf6c3 2a2599c66368
Author: Linus Torvalds <torvalds@linux-foundation.org>
Date:   Thu Jul 6 11:15:19 2017 -0700

    Merge tag 'media/v4.13-1' of git://git.kernel.org/pub/scm/linux/kernel/git/mchehab/linux-media
    
    Pull media updates from Mauro Carvalho Chehab:
    
     - addition of fwnode support at V4L2 core
    
     - addition of a few more SDR formats
    
     - new imx driver to support i.MX6 cameras
    
     - new driver for Qualcon venus codecs
    
     - new I2C sensor drivers: dw9714, max2175, ov13858, ov5640
    
     - new CEC driver: stm32-cec
    
     - some improvements to DVB frontend documentation and a few fixups
    
     - several driver improvements and fixups
    
    * tag 'media/v4.13-1' of git://git.kernel.org/pub/scm/linux/kernel/git/mchehab/linux-media: (361 commits)
      [media] media: entity: Catch unbalanced media_pipeline_stop calls
      [media] media/uapi/v4l: clarify cropcap/crop/selection behavior
      [media] v4l2-ioctl/exynos: fix G/S_SELECTION's type handling
      [media] vimc: sen: Declare vimc_sen_video_ops as static
      [media] vimc: sca: Add scaler
      [media] vimc: deb: Add debayer filter
      [media] vimc: Subdevices as modules
      [media] vimc: cap: Support several image formats
      [media] vimc: sen: Support several image formats
      [media] vimc: common: Add vimc_colorimetry_clamp
      [media] vimc: common: Add vimc_link_validate
      [media] vimc: common: Add vimc_pipeline_s_stream helper
      [media] vimc: common: Add vimc_ent_sd_* helper
      [media] vimc: Move common code from the core
      [media] vimc: sen: Integrate the tpg on the sensor
      [media] media: i2c: ov772x: Force use of SCCB protocol
      [media] dvb uapi docs: enums are passed by value, not reference
      [media] dvb: don't use 'time_t' in event ioctl
      [media] media: venus: enable building with COMPILE_TEST
      [media] af9013: refactor power control
      ...

commit a456950445a075f5c28a331474dc71e4133ccd3b
Author: Atul Gupta <atul.gupta@chelsio.com>
Date:   Tue Jul 4 16:46:20 2017 +0530

    cxgb4: time stamping interface for PTP
    
    Supports hardware and software time stamping via the
    Linux SO_TIMESTAMPING socket option.
    
    Cc: Richard Cochran <richardcochran@gmail.com>
    Signed-off-by: Atul Gupta <atul.gupta@chelsio.com>
    Signed-off-by: Ganesh Goudar <ganeshgr@chelsio.com>
    Signed-off-by: David S. Miller <davem@davemloft.net>

commit 413058df4331ce29f9934a5870d582c7e71fe15f
Author: Jan Kiszka <jan.kiszka@siemens.com>
Date:   Wed Jul 27 16:32:20 2016 +0200

    serial: exar: Add support for IOT2040 device
    
    This implements the setup of RS232 and the switch-over to RS485 or RS422
    for the Siemens IOT2040. That uses an EXAR XR17V352 with external logic
    to switch between the different modes. The external logic is controlled
    via MPIO pins of the EXAR controller.
    
    Only pin 10 can be exported as GPIO on the IOT2040. It is connected to
    an LED.
    
    As the XR17V352 used on the IOT2040 is not equipped with an external
    EEPROM, it cannot present itself as IOT2040-variant via subvendor/
    subdevice IDs. Thus, we have to check via DMI for the target platform.
    
    Co-developed with Sascha Weisenberger.
    
    Signed-off-by: Sascha Weisenberger <sascha.weisenberger@siemens.com>
    Signed-off-by: Jan Kiszka <jan.kiszka@siemens.com>
    Reviewed-by: Andy Shevchenko <andy.shevchenko@gmail.com>
    Acked-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>

commit a39f2fe7165647c2cd7bdbebb3d04061035e520f
Author: Jan Kiszka <jan.kiszka@siemens.com>
Date:   Thu May 25 08:25:19 2017 +0200

    gpio-exar/8250-exar: Do not even instantiate a GPIO device for Commtech cards
    
    Commtech adapters need the MPIOs for internal purposes, and the
    gpio-exar driver already refused to pick them up. But there is actually
    no point in even creating the underlying platform device.
    
    Signed-off-by: Jan Kiszka <jan.kiszka@siemens.com>
    Reviewed-by: Andy Shevchenko <andy.shevchenko@gmail.com>
    Acked-by: Linus Walleij <linus.walleij@linaro.org>
    Acked-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>

commit ab91f0a9b5f4b9b5b341fdc0ed457121e69c20e1
Author: Rafal Ozieblo <rafalo@cadence.com>
Date:   Thu Jun 29 07:14:16 2017 +0100

    net: macb: Add hardware PTP support
    
    This patch is based on original Harini's patch and Andrei's patch,
    implemented in a separate file to ease the review/maintanance
    and integration with other platforms.
    
    This driver supports GEM-GXL:
    - Register ptp clock framework
    - Initialize PTP related registers
    - HW time stamp on the PTP Ethernet packets are received using the
      SO_TIMESTAMPING API. Time stamps are obtained from the dma buffer
      descriptors
    - add macb_ptp to compilation chain
    
    Signed-off-by: Rafal Ozieblo <rafalo@cadence.com>
    Signed-off-by: David S. Miller <davem@davemloft.net>

commit 86766a3e15ac73dcf9542eebc60d3c34578d463a
Author: Shawn Guo <shawn.guo@linaro.org>
Date:   Sat Jun 24 22:25:26 2017 +0800

    i2c: zx2967: drop COMPILE_TEST dependency
    
    0-DAY kernel test reports the following build issue on IA64 architecture
    with allmodconfig.
    
       drivers/i2c/busses/i2c-zx2967.c: In function 'zx2967_i2c_writesb':
    >> drivers/i2c/busses/i2c-zx2967.c:87:2: error: implicit declaration of function 'writesb' [-Werror=implicit-function-declaration]
         writesb(i2c->reg_base + reg, data, len);
         ^~~~~~~
       drivers/i2c/busses/i2c-zx2967.c: In function 'zx2967_i2c_readsb':
    >> drivers/i2c/busses/i2c-zx2967.c:93:2: error: implicit declaration of function 'readsb' [-Werror=implicit-function-declaration]
         readsb(i2c->reg_base + reg, data, len);
         ^~~~~~
       cc1: some warnings being treated as errors
    
    It's caused by that writesb/readsb are unavailable on IA64 architecture.
    Let's drop COMPILE_TEST dependency to avoid the build issue.
    
    Reported-by: kbuild test robot <fengguang.wu@intel.com>
    Signed-off-by: Shawn Guo <shawn.guo@linaro.org>
    Signed-off-by: Wolfram Sang <wsa@the-dreams.de>

commit bb9b8fd26b50c9ec822805b9d877bec9d88acff4
Merge: f65013d655ac ad8181060788
Author: Linus Torvalds <torvalds@linux-foundation.org>
Date:   Sat Jun 24 16:18:00 2017 -0700

    Merge tag 'kbuild-fixes-v4.12-2' of git://git.kernel.org/pub/scm/linux/kernel/git/masahiroy/linux-kbuild
    
    Pull Kbuild fixes from Masahiro Yamada:
     "Nothing scary, just some random fixes:
    
       - fix warnings of host programs
    
       - fix "make tags" when COMPILED_SOURCE=1 is specified along with O=
    
       - clarify help message of C=1 option
    
       - fix dependency for ncurses compatibility check
    
       - fix "make headers_install" for fakechroot environment"
    
    * tag 'kbuild-fixes-v4.12-2' of git://git.kernel.org/pub/scm/linux/kernel/git/masahiroy/linux-kbuild:
      kconfig: fix sparse warnings in nconfig
      kbuild: fix header installation under fakechroot environment
      kconfig: Check for libncurses before menuconfig
      Kbuild: tiny correction on `make help`
      tags: honor COMPILED_SOURCE with apart output directory
      genksyms: add printf format attribute to error_with_pos()

commit c1004803b40596c1aabbbc78a6b1b33e4dfd96c6
Author: Will Deacon <will.deacon@arm.com>
Date:   Fri Jun 23 11:45:57 2017 +0100

    iommu/io-pgtable: depend on !GENERIC_ATOMIC64 when using COMPILE_TEST with LPAE
    
    The LPAE/ARMv8 page table format relies on the ability to read and write
    64-bit page table entries in an atomic fashion. With the move to a lockless
    implementation, we also need support for cmpxchg64 to resolve races when
    installing table entries concurrently.
    
    Unfortunately, not all architectures support cmpxchg64, so the code can
    fail to compiler when building for these architectures using COMPILE_TEST.
    Rather than disable COMPILE_TEST altogether, instead check that
    GENERIC_ATOMIC64 is not selected, which is a reasonable indication that
    the architecture has support for 64-bit cmpxchg.
    
    Reported-by: kbuild test robot <fengguang.wu@intel.com>
    Signed-off-by: Will Deacon <will.deacon@arm.com>

commit 682430e87734799ff2d71311d29f04e86f10f2cc
Author: Arnd Bergmann <arnd@arndb.de>
Date:   Tue Jun 20 22:12:37 2017 +0200

    clk: keystone: TI_SCI_PROTOCOL is needed for clk driver
    
    CONFIG_COMPILE_TEST allows building a configuration without
    TI_SCI_PROTOCOL, which then fails to link:
    
    drivers/clk/keystone/sci-clk.o: In function `ti_sci_clk_probe':
    sci-clk.c:(.text.ti_sci_clk_probe+0x4c): undefined reference to `devm_ti_sci_get_handle'
    
    This makes it a hard dependency. Right now, that means we can't
    actually compile-test the driver unless ARCH_KEYSTONE is set as
    well, but we can fix that by allowing TI_MESSAGE_MANAGER to
    be selected for COMPILE_TEST as well.
    
    Fixes: b745c0794e2f ("clk: keystone: Add sci-clk driver support")
    Signed-off-by: Arnd Bergmann <arnd@arndb.de>
    Acked-by: Tero Kristo <t-kristo@ti.com>
    Signed-off-by: Stephen Boyd <sboyd@codeaurora.org>

commit 73d7ee2e831f106ca5c745b2cf4fdbac5a4e9e4e
Author: Kuninori Morimoto <kuninori.morimoto.gx@renesas.com>
Date:   Wed Jun 21 04:38:13 2017 +0000

    ASoC: pxa: add COMPILE_TEST on SND_PXA2XX_SOC
    
    It doesn't use asm header. We can add COMPILE_TEST
    
    Signed-off-by: Kuninori Morimoto <kuninori.morimoto.gx@renesas.com>
    Signed-off-by: Mark Brown <broonie@kernel.org>

commit 76724b30f222067faf00874dc277f6c99d03d800
Author: Stanimir Varbanov <stanimir.varbanov@linaro.org>
Date:   Tue Jun 20 10:13:50 2017 -0300

    [media] media: venus: enable building with COMPILE_TEST
    
    We want all media drivers to build with COMPILE_TEST, as the
    Coverity instance we use on Kernel works only for x86. Also,
    our test workflow relies on it, in order to identify git
    bisect breakages.
    
    Signed-off-by: Mauro Carvalho Chehab <mchehab@s-opensource.com>
    Signed-off-by: Stanimir Varbanov <stanimir.varbanov@linaro.org>

commit 703528005e5861ed81f694368cfe80e6829d570f
Author: Stanimir Varbanov <stanimir.varbanov@linaro.org>
Date:   Thu Jun 15 13:31:50 2017 -0300

    [media] media: venus: enable building of Venus video driver
    
    This adds Venus driver Makefile and changes v4l2 platform
    Makefile/Kconfig in order to enable building of the driver.
    
    Note that in this initial version the COMPILE_TEST-ing is not
    supported because the drivers specific to ARM builds are still
    in process of enabling the aforementioned compile testing.
    Once that disadvantage is fixed the Venus driver compile testing
    will be possible with follow-up changes.
    
    Signed-off-by: Stanimir Varbanov <stanimir.varbanov@linaro.org>
    Signed-off-by: Hans Verkuil <hans.verkuil@cisco.com>
    Signed-off-by: Mauro Carvalho Chehab <mchehab@s-opensource.com>

commit 42bed042556261b56aa92e05f4f388f0f7ac1210
Author: Murilo Opsfelder Araujo <mopsfelder@gmail.com>
Date:   Mon May 29 10:26:28 2017 -0300

    drivers/watchdog/Kconfig: Update CONFIG_WATCHDOG_RTAS dependencies
    
    drivers/watchdog/wdrtas.c uses symbols defined in arch/powerpc/kernel/rtas.c,
    which are exported iff CONFIG_PPC_RTAS is selected. Building wdrtas.c without
    setting CONFIG_PPC_RTAS throws the following errors:
    
        ERROR: ".rtas_token" [drivers/watchdog/wdrtas.ko] undefined!
        ERROR: "rtas_data_buf" [drivers/watchdog/wdrtas.ko] undefined!
        ERROR: "rtas_data_buf_lock" [drivers/watchdog/wdrtas.ko] undefined!
        ERROR: ".rtas_get_sensor" [drivers/watchdog/wdrtas.ko] undefined!
        ERROR: ".rtas_call" [drivers/watchdog/wdrtas.ko] undefined!
    
    This was identified during a randconfig build where CONFIG_WATCHDOG_RTAS=m and
    CONFIG_PPC_RTAS was not set. Logs are here:
    
        http://kisskb.ellerman.id.au/kisskb/buildresult/12982152/
    
    This patch fixes the issue by updating CONFIG_WATCHDOG_RTAS to depend on just
    CONFIG_PPC_RTAS, removing COMPILE_TEST entirely.
    
    Signed-off-by: Murilo Opsfelder Araujo <mopsfelder@gmail.com>
    Reviewed-by: Guenter Roeck <linux@roeck-us.net>
    Signed-off-by: Michael Ellerman <mpe@ellerman.id.au>

commit d762e4f35601239cbebfbfd43d99876d8f220927
Author: Fabio Estevam <fabio.estevam@nxp.com>
Date:   Thu Jun 8 19:46:23 2017 -0300

    dmaengine: Kconfig: Extend the dependency for MXS_DMA
    
    Currently it is not possible to select the mxs dma driver when only
    mx6sx or mx7 are selected.
    
    Extend the dependency to allow the mxs dma driver to be built whenever
    ARCH_MXS or ARCH_MXC is selected.
    
    This has the benefit to avoid having to add new entries in the
    MXS_DMA Kconfig everytime a new i.MX SoC shows up and it also makes
    it consistent with the other i.MX DMA engines, such as IMX_DMA and
    IMX_SDMA.
    
    While at it, also pass COMPILE_TEST for increasing the build coverage.
    
    Acked-by: Stefan Agner <stefan@agner.ch>
    Signed-off-by: Fabio Estevam <fabio.estevam@nxp.com>
    Signed-off-by: Vinod Koul <vinod.koul@intel.com>

commit 8be381a131c29c4737aed44e7e5f90cb77bb4a7e
Author: Geert Uytterhoeven <geert+renesas@glider.be>
Date:   Fri May 19 10:35:10 2017 +0200

    soc: renesas: Rework Kconfig and Makefile logic
    
    The goals are to:
      - Allow precise control over and automatic selection of which
        (sub)drivers are used for which SoC,
      - Allow adding support for new SoCs easily,
      - Allow compile-testing of all (sub)drivers,
      - Keep driver selection logic in the subsystem-specific Kconfig,
        independent from the architecture-specific Kconfig (i.e. no "select"
        from arch/arm64/Kconfig.platforms), to avoid dependencies.
    
    This is implemented by:
      - Introducing Kconfig symbols for all drivers and sub-drivers,
      - Introducing the Kconfig symbol SOC_RENESAS, which is enabled
        automatically when building for a Renesas ARM platform, and which
        enables all required drivers without interaction of the user, based
        on SoC-specific ARCH_* symbols,
      - Allowing the user to enable any Kconfig symbol manually if
        COMPILE_TEST is enabled,
      - Using the new Kconfig symbols instead of the ARCH_* symbols to
        control compilation in the Makefile,
      - Always entering drivers/soc/renesas/ during the build.
    
    Signed-off-by: Geert Uytterhoeven <geert+renesas@glider.be>
    Signed-off-by: Simon Horman <horms+renesas@verge.net.au>

commit e9523a5a32a1ce3acfe875cddd8ac8ad8a9ed270
Author: Grygorii Strashko <grygorii.strashko@ti.com>
Date:   Thu Jun 8 13:51:31 2017 -0500

    net: ethernet: ti: cpsw: enable HWTSTAMP_FILTER_PTP_V1_L4_EVENT filter
    
    CPSW driver supports PTP v1 messages, but for unknown reasons this filter
    is not advertised. As result,
    ./tools/testing/selftests/networking/timestamping/timestamping utility
    can't be used for testing of CPSW RX timestamping with option
    SOF_TIMESTAMPING_RX_HARDWARE, because it uses
    HWTSTAMP_FILTER_PTP_V1_L4_SYNC filter.
    
    Hence, fix it by advertising HWTSTAMP_FILTER_PTP_V1_L4_XXX filters
    in CPSW driver.
    
    Signed-off-by: Grygorii Strashko <grygorii.strashko@ti.com>
    Signed-off-by: David S. Miller <davem@davemloft.net>

commit ee34e2644a78e2561742bea8c4bdcf83cabf90a7
Author: Tudor-Dan Ambarus <tudor.ambarus@microchip.com>
Date:   Thu May 25 10:18:07 2017 +0300

    crypto: dh - fix memleak in setkey
    
    setkey can be called multiple times during the existence
    of the transformation object. In case of multiple setkey calls,
    the old key was not freed and we leaked memory.
    Free the old MPI key if any.
    
    Signed-off-by: Tudor Ambarus <tudor.ambarus@microchip.com>
    Signed-off-by: Herbert Xu <herbert@gondor.apana.org.au>

commit aca4e68acf3a08561f2a413322cbb232edad8764
Author: Arnd Bergmann <arnd@arndb.de>
Date:   Fri Jun 9 12:22:51 2017 +0200

    mux: adg792a: always require I2C support
    
    COMPILE_TEST makes no sense when I2C is disabled, as the driver cannot compile
    in that configuration:
    
    drivers/mux/mux-adg792a.c: In function 'adg792a_write_cmd':
    drivers/mux/mux-adg792a.c:34:9: error: implicit declaration of function 'i2c_smbus_write_byte_data'; did you mean 'i2c_set_clientdata'? [-Werror=implicit-function-declaration]
    drivers/mux/mux-adg792a.o: In function `adg792a_driver_init':
    mux-adg792a.c:(.init.text+0x14): undefined reference to `i2c_register_driver'
    drivers/mux/mux-adg792a.o: In function `adg792a_probe':
    mux-adg792a.c:(.text.adg792a_probe+0x94): undefined reference to `i2c_smbus_write_byte_data'
    drivers/mux/mux-adg792a.o: In function `adg792a_set':
    mux-adg792a.c:(.text.adg792a_set+0x80): undefined reference to `i2c_smbus_write_byte_data'
    
    Fixes: afda08c4caa9 ("mux: adg792a: add mux controller driver for ADG792A/G")
    Signed-off-by: Arnd Bergmann <arnd@arndb.de>
    Reviewed-by: Peter Rosin <peda@axentia.se>
    Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>

commit bea8be656185a2808a2f255f4a91ff18215a9d0c
Author: Jan Kiszka <jan.kiszka@siemens.com>
Date:   Fri Jun 2 09:28:44 2017 +0200

    serial: exar: Leave MPIOs as output for Commtech adapters
    
    Commtech adapters apparently need the original setting as outputs, see
    https://marc.info/?l=linux-gpio&m=149557425201323&w=2. Account for that.
    
    Fixes: 7dea8165f1d6 ("serial: exar: Preconfigure xr17v35x MPIOs as output")
    Signed-off-by: Jan Kiszka <jan.kiszka@siemens.com>
    Reviewed-by: Andy Shevchenko <andy.shevchenko@gmail.com>
    Reviewed-by: Linus Walleij <linus.walleij@linaro.org>
    Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>

commit 7cbe0932c2f2014d6e24e716e79ea3910b468950
Author: Mat Martineau <mathew.j.martineau@linux.intel.com>
Date:   Thu Jun 8 14:50:11 2017 +0100

    KEYS: Convert KEYCTL_DH_COMPUTE to use the crypto KPP API
    
    The initial Diffie-Hellman computation made direct use of the MPI
    library because the crypto module did not support DH at the time. Now
    that KPP is implemented, KEYCTL_DH_COMPUTE should use it to get rid of
    duplicate code and leverage possible hardware acceleration.
    
    This fixes an issue whereby the input to the KDF computation would
    include additional uninitialized memory when the result of the
    Diffie-Hellman computation was shorter than the input prime number.
    
    Signed-off-by: Mat Martineau <mathew.j.martineau@linux.intel.com>
    Signed-off-by: David Howells <dhowells@redhat.com>
    Signed-off-by: James Morris <james.l.morris@oracle.com>

commit 13c6c6ea1a89fea426935501ddd064d271d836d6
Author: Mauro Carvalho Chehab <mchehab@s-opensource.com>
Date:   Thu Jun 8 12:14:09 2017 -0300

    [media] platform/Makefile: don't depend on arch to include dirs
    
    Depending on arch configs to include dirs is evil, and makes
    harder to change drivers to work with COMPILE_TEST.
    
    Replace them by obj-y.
    
    Signed-off-by: Mauro Carvalho Chehab <mchehab@s-opensource.com>

commit d6eaf7a4d6230c1d88e1b8afe3179947fbc007b1
Author: Rob Landley <rob@landley.net>
Date:   Sat May 20 15:03:29 2017 -0500

    x86/boot: Use CROSS_COMPILE prefix for readelf
    
    commit 3780578761921f094179c6289072a74b2228c602 upstream.
    
    The boot code Makefile contains a straight 'readelf' invocation. This
    causes build warnings in cross compile environments, when there is no
    unprefixed readelf accessible via $PATH.
    
    Add the missing $(CROSS_COMPILE) prefix.
    
    [ tglx: Rewrote changelog ]
    
    Fixes: 98f78525371b ("x86/boot: Refuse to build with data relocations")
    Signed-off-by: Rob Landley <rob@landley.net>
    Acked-by: Kees Cook <keescook@chromium.org>
    Cc: Jiri Kosina <jkosina@suse.cz>
    Cc: Paul Bolle <pebolle@tiscali.nl>
    Cc: "H.J. Lu" <hjl.tools@gmail.com>
    Link: http://lkml.kernel.org/r/ced18878-693a-9576-a024-113ef39a22c0@landley.net
    Signed-off-by: Thomas Gleixner <tglx@linutronix.de>
    Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>

commit d5ecb4ca0da7528c0f1ebc676d831b00efd37efa
Author: Rob Landley <rob@landley.net>
Date:   Sat May 20 15:03:29 2017 -0500

    x86/boot: Use CROSS_COMPILE prefix for readelf
    
    commit 3780578761921f094179c6289072a74b2228c602 upstream.
    
    The boot code Makefile contains a straight 'readelf' invocation. This
    causes build warnings in cross compile environments, when there is no
    unprefixed readelf accessible via $PATH.
    
    Add the missing $(CROSS_COMPILE) prefix.
    
    [ tglx: Rewrote changelog ]
    
    Fixes: 98f78525371b ("x86/boot: Refuse to build with data relocations")
    Signed-off-by: Rob Landley <rob@landley.net>
    Acked-by: Kees Cook <keescook@chromium.org>
    Cc: Jiri Kosina <jkosina@suse.cz>
    Cc: Paul Bolle <pebolle@tiscali.nl>
    Cc: "H.J. Lu" <hjl.tools@gmail.com>
    Link: http://lkml.kernel.org/r/ced18878-693a-9576-a024-113ef39a22c0@landley.net
    Signed-off-by: Thomas Gleixner <tglx@linutronix.de>
    Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>

commit cbf52a3e6a8a92beec6e0c70abf4111cd8f8faf7
Author: Robert Jarzmik <robert.jarzmik@free.fr>
Date:   Mon Jun 5 13:59:15 2017 +0200

    tags: honor COMPILED_SOURCE with apart output directory
    
    When the kernel is compiled with an "O=" argument, the object files are
    not in the source tree, but in the build tree.
    
    This patch fixes O= build by looking for object files in the build tree.
    
    Fixes: 923e02ecf3f8 ("scripts/tags.sh: Support compiled source")
    Signed-off-by: Robert Jarzmik <robert.jarzmik@free.fr>
    Signed-off-by: Masahiro Yamada <yamada.masahiro@socionext.com>

commit 38e6bf238daa2514a543f76ec8d1cc0f488ac422
Merge: 39b8ab31bced 702644ec1cab
Author: Linus Torvalds <torvalds@linux-foundation.org>
Date:   Sat May 27 09:17:58 2017 -0700

    Merge branch 'x86-urgent-for-linus' of git://git.kernel.org/pub/scm/linux/kernel/git/tip/tip
    
    Pull x86 fixes from Thomas Gleixner:
     "A series of fixes for X86:
    
       - The final fix for the end-of-stack issue in the unwinder
       - Handle non PAT systems gracefully
       - Prevent access to uninitiliazed memory
       - Move early delay calaibration after basic init
       - Fix Kconfig help text
       - Fix a cross compile issue
       - Unbreak older make versions"
    
    * 'x86-urgent-for-linus' of git://git.kernel.org/pub/scm/linux/kernel/git/tip/tip:
      x86/timers: Move simple_udelay_calibration past init_hypervisor_platform
      x86/alternatives: Prevent uninitialized stack byte read in apply_alternatives()
      x86/PAT: Fix Xorg regression on CPUs that don't support PAT
      x86/watchdog: Fix Kconfig help text file path reference to lockup watchdog documentation
      x86/build: Permit building with old make versions
      x86/unwind: Add end-of-stack check for ftrace handlers
      Revert "x86/entry: Fix the end of the stack for newly forked tasks"
      x86/boot: Use CROSS_COMPILE prefix for readelf

commit 80978a4be267e1783444841143cdb0f0eb40061c
Author: Geert Uytterhoeven <geert+renesas@glider.be>
Date:   Mon Apr 24 16:54:14 2017 +0200

    clk: renesas: Rework Kconfig and Makefile logic
    
    The goals are to:
      - Allow precise control over and automatic selection of which
        (sub)drivers are used for which SoC (which may change in the
        future),
      - Allow adding support for new SoCs easily,
      - Allow compile-testing of all (sub)drivers,
      - Keep driver selection logic in the subsystem-specific Kconfig,
        independent from the architecture-specific Kconfig (i.e. no "select"
        from arch/arm64/Kconfig.platforms), to avoid dependencies.
    
    This is implemented by:
      - Introducing Kconfig symbols for all drivers and sub-drivers,
      - Introducing the Kconfig symbol CLK_RENESAS, which is enabled
        automatically when building for a Renesas ARM platform, and which
        enables all required drivers without interaction of the user, based
        on SoC-specific ARCH_* symbols,
      - Allowing the user to enable any Kconfig symbol manually if
        COMPILE_TEST is enabled,
      - Using the new Kconfig symbols instead of the ARCH_* symbols to
        control compilation in the Makefile,
      - Always entering drivers/clk/renesas/ during the build.
    
    Note that currently not all (sub)drivers are enabled for
    compile-testing, as they depend on independent fixes in other
    subsystems.
    
    Signed-off-by: Geert Uytterhoeven <geert+renesas@glider.be>
    Acked-by: Simon Horman <horms+renesas@verge.net.au>
    Acked-by: Stephen Boyd <sboyd@codeaurora.org>

commit c4d3fd4614248880d700b6286c01839c416e37cb
Author: Philippe CORNU <philippe.cornu@st.com>
Date:   Mon May 22 11:30:21 2017 +0200

    drm/stm: ltdc: fix duplicated arguments
    
    Fix COMPILE_TEST build issue detected with the
    rule: "duplicated argument to & or |"
    
    Signed-off-by: Philippe CORNU <philippe.cornu@st.com>
    Signed-off-by: Benjamin Gaignard <benjamin.gaignard@linaro.org>
    Link: http://patchwork.freedesktop.org/patch/msgid/1495445421-20846-1-git-send-email-philippe.cornu@st.com

commit f5a64d64b5f5f42999f029f6c04f6dda19339566
Author: David S. Miller <davem@davemloft.net>
Date:   Mon May 22 10:26:24 2017 -0400

    net: Fix parisc SCM_TIMESTAMPING_PKTINFO value.
    
    Needs to follow the existing sequence.
    
    Reported-by: Stephen Rothwell <sfr@canb.auug.org.au>
    Signed-off-by: David S. Miller <davem@davemloft.net>

commit 1c4f676a68a502e7bef7d0e49952b042d00aa496
Author: David S. Miller <davem@davemloft.net>
Date:   Sun May 21 23:13:37 2017 -0400

    net: Define SCM_TIMESTAMPING_PKTINFO on all architectures.
    
    A definition was only provided for asm-generic/socket.h
    using platforms, define it for the others as well
    
    Reported-by: Stephen Rothwell <sfr@canb.auug.org.au>
    Signed-off-by: David S. Miller <davem@davemloft.net>

commit dae37055f475a369f7433360e246afbdccd22ff6
Merge: 2061ec3f1370 74abc9b18f44
Author: David S. Miller <davem@davemloft.net>
Date:   Sun May 21 13:37:35 2017 -0400

    Merge branch 'net-extend-socket-timestamping-API'
    
    Miroslav Lichvar says:
    
    ====================
    Extend socket timestamping API
    
    Changes v5->v6:
    - fixed skb_is_swtx_tstamp() when OPT_TX_SWHW is disabled and improved
      its description
    - improved OPT_PKTINFO documentation
    - improved scm_timestamping documentation
    
    Changes v4->v5:
    - fixed initialization of reserved fields in struct scm_ts_pktinfo
    
    Changes v3->v4:
    - added reserved fields to struct scm_ts_pktinfo
    - replaced patch fixing false SW timestamps with a documentation fix
    - updated OPT_TX_SWHW patch to handle false SW timestamps
    
    Changes v2->v3:
    - modified struct scm_ts_pktinfo to use fixed-width integer types
    - added WARN_ON_ONCE for missing RCU lock in dev_get_by_napi_id()
    - modified dev_get_by_napi_id() to not return dev in unexpected branch
    - modified recv to return SCM_TIMESTAMPING_PKTINFO even if the interface
      index is unknown
    
    Changes v1->v2:
    - added separate patch for new NAPI functions
    - split code from __sock_recv_timestamp() for better readability
    - fixed RCU locking
    - fixed compiler warning (missing case in switch in first patch)
    - inline sw_tx_timestamp() in its only user
    
    Changes RFC->v1:
    - reworked SOF_TIMESTAMPING_OPT_PKTINFO patch to not add new fields to
      skb shared info (net device is now looked up by napi_id), not require
      any changes in drivers, and restrict the cmsg to incoming packets
    - renamed SOF_TIMESTAMPING_OPT_MULTIMSG to SOF_TIMESTAMPING_OPT_TX_SWHW
      and fixed its description
    - moved struct scm_ts_pktinfo from errqueue.h to net_tstamp.h as it
      can't be received from the error queue anymore
    - improved commit descriptions and removed incorrect comment
    
    This patchset adds new options to the timestamping API that will be
    useful for NTP implementations and possibly other applications.
    
    The first patch specifies a timestamp filter for NTP packets. The second
    patch updates drivers that can timestamp all packets, or need to list
    the filter as unsupported. There is no attempt to add the support to the
    phyter driver.
    
    The third patch adds two helper functions working with NAPI ID, which is
    needed by the next patch. The fourth patch adds a new option to get a
    new control message with the L2 length and interface index for incoming
    packets with hardware timestamps.
    
    The fifth patch fixes documentation on number of non-zero fields in
    scm_timestamping and warns about false software timestamps when
    SO_TIMESTAMP(NS) is combined with SCM_TIMESTAMPING.
    
    The sixth patch adds a new option to request both software and hardware
    timestamps for outgoing packets. The seventh patch updates drivers that
    assumed software timestamping cannot be used together with hardware
    timestamping.
    
    The patches have been tested on x86_64 machines with igb and e1000e
    drivers.
    ====================
    
    Signed-off-by: David S. Miller <davem@davemloft.net>

commit 74abc9b18f446d1a9e0602a71a22e5ffe8a2cd23
Author: Miroslav Lichvar <mlichvar@redhat.com>
Date:   Fri May 19 17:52:41 2017 +0200

    net: ethernet: update drivers to make both SW and HW TX timestamps
    
    Some drivers were calling the skb_tx_timestamp() function only when
    a hardware timestamp was not requested. Now that applications can use
    the SOF_TIMESTAMPING_OPT_TX_SWHW option to request both software and
    hardware timestamps, the drivers need to be modified to unconditionally
    call skb_tx_timestamp().
    
    CC: Richard Cochran <richardcochran@gmail.com>
    CC: Willem de Bruijn <willemb@google.com>
    Signed-off-by: Miroslav Lichvar <mlichvar@redhat.com>
    Signed-off-by: David S. Miller <davem@davemloft.net>

commit b50a5c70ffa4fd6b6da324ab54c84adf48fb17d9
Author: Miroslav Lichvar <mlichvar@redhat.com>
Date:   Fri May 19 17:52:40 2017 +0200

    net: allow simultaneous SW and HW transmit timestamping
    
    Add SOF_TIMESTAMPING_OPT_TX_SWHW option to allow an outgoing packet to
    be looped to the socket's error queue with a software timestamp even
    when a hardware transmit timestamp is expected to be provided by the
    driver.
    
    Applications using this option will receive two separate messages from
    the error queue, one with a software timestamp and the other with a
    hardware timestamp. As the hardware timestamp is saved to the shared skb
    info, which may happen before the first message with software timestamp
    is received by the application, the hardware timestamp is copied to the
    SCM_TIMESTAMPING control message only when the skb has no software
    timestamp or it is an incoming packet.
    
    While changing sw_tx_timestamp(), inline it in skb_tx_timestamp() as
    there are no other users.
    
    CC: Richard Cochran <richardcochran@gmail.com>
    CC: Willem de Bruijn <willemb@google.com>
    Signed-off-by: Miroslav Lichvar <mlichvar@redhat.com>
    Acked-by: Willem de Bruijn <willemb@google.com>
    Signed-off-by: David S. Miller <davem@davemloft.net>

commit 67953d47bb24e63d209705f745a0de411a4c6578
Author: Miroslav Lichvar <mlichvar@redhat.com>
Date:   Fri May 19 17:52:39 2017 +0200

    net: fix documentation of struct scm_timestamping
    
    The scm_timestamping struct may return multiple non-zero fields, e.g.
    when both software and hardware RX timestamping is enabled, or when the
    SO_TIMESTAMP(NS) option is combined with SCM_TIMESTAMPING and a false
    software timestamp is generated in the recvmsg() call in order to always
    return a SCM_TIMESTAMP(NS) message.
    
    CC: Richard Cochran <richardcochran@gmail.com>
    CC: Willem de Bruijn <willemb@google.com>
    Signed-off-by: Miroslav Lichvar <mlichvar@redhat.com>
    Acked-by: Willem de Bruijn <willemb@google.com>
    Signed-off-by: David S. Miller <davem@davemloft.net>

commit aad9c8c470f2a8321a99eb053630ce0e199558d6
Author: Miroslav Lichvar <mlichvar@redhat.com>
Date:   Fri May 19 17:52:38 2017 +0200

    net: add new control message for incoming HW-timestamped packets
    
    Add SOF_TIMESTAMPING_OPT_PKTINFO option to request a new control message
    for incoming packets with hardware timestamps. It contains the index of
    the real interface which received the packet and the length of the
    packet at layer 2.
    
    The index is useful with bonding, bridges and other interfaces, where
    IP_PKTINFO doesn't allow applications to determine which PHC made the
    timestamp. With the L2 length (and link speed) it is possible to
    transpose preamble timestamps to trailer timestamps, which are used in
    the NTP protocol.
    
    While this information could be provided by two new socket options
    independently from timestamping, it doesn't look like they would be very
    useful. With this option any performance impact is limited to hardware
    timestamping.
    
    Use dev_get_by_napi_id() to get the device and its index. On kernels
    with disabled CONFIG_NET_RX_BUSY_POLL or drivers not using NAPI, a zero
    index will be returned in the control message.
    
    CC: Richard Cochran <richardcochran@gmail.com>
    Acked-by: Willem de Bruijn <willemb@google.com>
    Signed-off-by: Miroslav Lichvar <mlichvar@redhat.com>
    Signed-off-by: David S. Miller <davem@davemloft.net>

commit 3780578761921f094179c6289072a74b2228c602
Author: Rob Landley <rob@landley.net>
Date:   Sat May 20 15:03:29 2017 -0500

    x86/boot: Use CROSS_COMPILE prefix for readelf
    
    The boot code Makefile contains a straight 'readelf' invocation. This
    causes build warnings in cross compile environments, when there is no
    unprefixed readelf accessible via $PATH.
    
    Add the missing $(CROSS_COMPILE) prefix.
    
    [ tglx: Rewrote changelog ]
    
    Fixes: 98f78525371b ("x86/boot: Refuse to build with data relocations")
    Signed-off-by: Rob Landley <rob@landley.net>
    Acked-by: Kees Cook <keescook@chromium.org>
    Cc: Jiri Kosina <jkosina@suse.cz>
    Cc: Paul Bolle <pebolle@tiscali.nl>
    Cc: "H.J. Lu" <hjl.tools@gmail.com>
    Cc: stable@vger.kernel.org
    Link: http://lkml.kernel.org/r/ced18878-693a-9576-a024-113ef39a22c0@landley.net
    Signed-off-by: Thomas Gleixner <tglx@linutronix.de>

commit 95121cc98ca0f9935c1d358180ecac1e4b161b64
Author: Andrew Jones <drjones@redhat.com>
Date:   Tue Apr 18 17:59:58 2017 +0200

    KVM: arm/arm64: fix races in kvm_psci_vcpu_on
    
    commit 6c7a5dce22b3f3cc44be098e2837fa6797edb8b8 upstream.
    
    Fix potential races in kvm_psci_vcpu_on() by taking the kvm->lock
    mutex.  In general, it's a bad idea to allow more than one PSCI_CPU_ON
    to process the same target VCPU at the same time.  One such problem
    that may arise is that one PSCI_CPU_ON could be resetting the target
    vcpu, which fills the entire sys_regs array with a temporary value
    including the MPIDR register, while another looks up the VCPU based
    on the MPIDR value, resulting in no target VCPU found.  Resolves both
    races found with the kvm-unit-tests/arm/psci unit test.
    
    Reviewed-by: Marc Zyngier <marc.zyngier@arm.com>
    Reviewed-by: Christoffer Dall <cdall@linaro.org>
    Reported-by: Levente Kurusa <lkurusa@redhat.com>
    Suggested-by: Christoffer Dall <cdall@linaro.org>
    Signed-off-by: Andrew Jones <drjones@redhat.com>
    Signed-off-by: Christoffer Dall <cdall@linaro.org>
    Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>

commit 8348ffba88e50c1ca2f222fced1996d0f026f89e
Author: Andrew Jones <drjones@redhat.com>
Date:   Tue Apr 18 17:59:58 2017 +0200

    KVM: arm/arm64: fix races in kvm_psci_vcpu_on
    
    commit 6c7a5dce22b3f3cc44be098e2837fa6797edb8b8 upstream.
    
    Fix potential races in kvm_psci_vcpu_on() by taking the kvm->lock
    mutex.  In general, it's a bad idea to allow more than one PSCI_CPU_ON
    to process the same target VCPU at the same time.  One such problem
    that may arise is that one PSCI_CPU_ON could be resetting the target
    vcpu, which fills the entire sys_regs array with a temporary value
    including the MPIDR register, while another looks up the VCPU based
    on the MPIDR value, resulting in no target VCPU found.  Resolves both
    races found with the kvm-unit-tests/arm/psci unit test.
    
    Reviewed-by: Marc Zyngier <marc.zyngier@arm.com>
    Reviewed-by: Christoffer Dall <cdall@linaro.org>
    Reported-by: Levente Kurusa <lkurusa@redhat.com>
    Suggested-by: Christoffer Dall <cdall@linaro.org>
    Signed-off-by: Andrew Jones <drjones@redhat.com>
    Signed-off-by: Christoffer Dall <cdall@linaro.org>
    Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>

commit 7b0d4391d0f4970601b21f56c540fc368bb8be06
Author: Andrew Jones <drjones@redhat.com>
Date:   Tue Apr 18 17:59:58 2017 +0200

    KVM: arm/arm64: fix races in kvm_psci_vcpu_on
    
    commit 6c7a5dce22b3f3cc44be098e2837fa6797edb8b8 upstream.
    
    Fix potential races in kvm_psci_vcpu_on() by taking the kvm->lock
    mutex.  In general, it's a bad idea to allow more than one PSCI_CPU_ON
    to process the same target VCPU at the same time.  One such problem
    that may arise is that one PSCI_CPU_ON could be resetting the target
    vcpu, which fills the entire sys_regs array with a temporary value
    including the MPIDR register, while another looks up the VCPU based
    on the MPIDR value, resulting in no target VCPU found.  Resolves both
    races found with the kvm-unit-tests/arm/psci unit test.
    
    Reviewed-by: Marc Zyngier <marc.zyngier@arm.com>
    Reviewed-by: Christoffer Dall <cdall@linaro.org>
    Reported-by: Levente Kurusa <lkurusa@redhat.com>
    Suggested-by: Christoffer Dall <cdall@linaro.org>
    Signed-off-by: Andrew Jones <drjones@redhat.com>
    Signed-off-by: Christoffer Dall <cdall@linaro.org>
    Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>

commit cbaeca8251bbe77c646954c7655b661f0fef8170
Author: Andrew Jones <drjones@redhat.com>
Date:   Tue Apr 18 17:59:58 2017 +0200

    KVM: arm/arm64: fix races in kvm_psci_vcpu_on
    
    commit 6c7a5dce22b3f3cc44be098e2837fa6797edb8b8 upstream.
    
    Fix potential races in kvm_psci_vcpu_on() by taking the kvm->lock
    mutex.  In general, it's a bad idea to allow more than one PSCI_CPU_ON
    to process the same target VCPU at the same time.  One such problem
    that may arise is that one PSCI_CPU_ON could be resetting the target
    vcpu, which fills the entire sys_regs array with a temporary value
    including the MPIDR register, while another looks up the VCPU based
    on the MPIDR value, resulting in no target VCPU found.  Resolves both
    races found with the kvm-unit-tests/arm/psci unit test.
    
    Reviewed-by: Marc Zyngier <marc.zyngier@arm.com>
    Reviewed-by: Christoffer Dall <cdall@linaro.org>
    Reported-by: Levente Kurusa <lkurusa@redhat.com>
    Suggested-by: Christoffer Dall <cdall@linaro.org>
    Signed-off-by: Andrew Jones <drjones@redhat.com>
    Signed-off-by: Christoffer Dall <cdall@linaro.org>
    Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>

commit c66d9b77cbda5e0e71ae0dfabaa94b27ca3f6b63
Author: David Howells <dhowells@redhat.com>
Date:   Wed Aug 5 12:54:46 2015 +0100

    ASN.1: Fix non-match detection failure on data overrun
    
    commit 0d62e9dd6da45bbf0f33a8617afc5fe774c8f45f upstream.
    
    If the ASN.1 decoder is asked to parse a sequence of objects, non-optional
    matches get skipped if there's no more data to be had rather than a
    data-overrun error being reported.
    
    This is due to the code segment that decides whether to skip optional
    matches (ie. matches that could get ignored because an element is marked
    OPTIONAL in the grammar) due to a lack of data also skips non-optional
    elements if the data pointer has reached the end of the buffer.
    
    This can be tested with the data decoder for the new RSA akcipher algorithm
    that takes three non-optional integers.  Currently, it skips the last
    integer if there is insufficient data.
    
    Without the fix, #defining DEBUG in asn1_decoder.c will show something
    like:
    
            next_op: pc=0/13 dp=0/270 C=0 J=0
            - match? 30 30 00
            - TAG: 30 266 CONS
            next_op: pc=2/13 dp=4/270 C=1 J=0
            - match? 02 02 00
            - TAG: 02 257
            - LEAF: 257
            next_op: pc=5/13 dp=265/270 C=1 J=0
            - match? 02 02 00
            - TAG: 02 3
            - LEAF: 3
            next_op: pc=8/13 dp=270/270 C=1 J=0
            next_op: pc=11/13 dp=270/270 C=1 J=0
            - end cons t=4 dp=270 l=270/270
    
    The next_op line for pc=8/13 should be followed by a match line.
    
    This is not exploitable for X.509 certificates by means of shortening the
    message and fixing up the ASN.1 CONS tags because:
    
     (1) The relevant records being built up are cleared before use.
    
     (2) If the message is shortened sufficiently to remove the public key, the
         ASN.1 parse of the RSA key will fail quickly due to a lack of data.
    
     (3) Extracted signature data is either turned into MPIs (which cope with a
         0 length) or is simpler integers specifying algoritms and suchlike
         (which can validly be 0); and
    
     (4) The AKID and SKID extensions are optional and their removal is handled
         without risking passing a NULL to asymmetric_key_generate_id().
    
     (5) If the certificate is truncated sufficiently to remove the subject,
         issuer or serialNumber then the ASN.1 decoder will fail with a 'Cons
         stack underflow' return.
    
    This is not exploitable for PKCS#7 messages by means of removal of elements
    from such a message from the tail end of a sequence:
    
     (1) Any shortened X.509 certs embedded in the PKCS#7 message are survivable
         as detailed above.
    
     (2) The message digest content isn't used if it shows a NULL pointer,
         similarly, the authattrs aren't used if that shows a NULL pointer.
    
     (3) A missing signature results in a NULL MPI - which the MPI routines deal
         with.
    
     (4) If data is NULL, it is expected that the message has detached content and
         that is handled appropriately.
    
     (5) If the serialNumber is excised, the unconditional action associated
         with it will pick up the containing SEQUENCE instead, so no NULL
         pointer will be seen here.
    
         If both the issuer and the serialNumber are excised, the ASN.1 decode
         will fail with an 'Unexpected tag' return.
    
         In either case, there's no way to get to asymmetric_key_generate_id()
         with a NULL pointer.
    
     (6) Other fields are decoded to simple integers.  Shortening the message
         to omit an algorithm ID field will cause checks on this to fail early
         in the verification process.
    
    
    This can also be tested by snipping objects off of the end of the ASN.1 stream
    such that mandatory tags are removed - or even from the end of internal
    SEQUENCEs.  If any mandatory tag is missing, the error EBADMSG *should* be
    produced.  Without this patch ERANGE or ENOPKG might be produced or the parse
    may apparently succeed, perhaps with ENOKEY or EKEYREJECTED being produced
    later, depending on what gets snipped.
    
    Just snipping off the final BIT_STRING or OCTET_STRING from either sample
    should be a start since both are mandatory and neither will cause an EBADMSG
    without the patches
    
    Reported-by: Marcel Holtmann <marcel@holtmann.org>
    Signed-off-by: David Howells <dhowells@redhat.com>
    Tested-by: Marcel Holtmann <marcel@holtmann.org>
    Reviewed-by: David Woodhouse <David.Woodhouse@intel.com>
    Signed-off-by: Amit Pundir <amit.pundir@linaro.org>
    Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>

commit d8f1deaa5256aba3296025e103e8abb96f3e6479
Author: Arnd Bergmann <arnd@arndb.de>
Date:   Thu Mar 2 13:09:52 2017 +0100

    watchdog: orion: fix compile-test dependencies
    
    I ran into one corner case with the orion watchdog using the
    atomic_io_modify interface:
    
    drivers/watchdog/orion_wdt.o: In function `orion_stop':
    orion_wdt.c:(.text.orion_stop+0x28): undefined reference to `atomic_io_modify'
    drivers/watchdog/orion_wdt.o: In function `armada375_stop':
    orion_wdt.c:(.text.armada375_stop+0x28): undefined reference to `atomic_io_modify'
    
    This function is available on all 32-bit ARM builds except for ebsa110, so
    we have to specifically exclude that from compile-testing.
    
    Fixes: da2a68b3eb47 ("watchdog: Enable COMPILE_TEST where possible")
    Signed-off-by: Arnd Bergmann <arnd@arndb.de>
    Signed-off-by: Guenter Roeck <linux@roeck-us.net>
    Signed-off-by: Wim Van Sebroeck <wim@iguana.be>

commit 7dea8165f1d6434dc7572004363f86339f0f4322
Author: Jan Kiszka <jan.kiszka@siemens.com>
Date:   Sat May 13 09:28:59 2017 +0200

    serial: exar: Preconfigure xr17v35x MPIOs as output
    
    This is the safe default for GPIOs with unknown external wiring.
    
    Signed-off-by: Jan Kiszka <jan.kiszka@siemens.com>
    Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>

commit ddd0503e4d780607865950e14f215bf8660ed683
Author: Brian Norris <computersforpeace@gmail.com>
Date:   Mon May 1 18:13:00 2017 -0700

    mtd: spi-nor: stm32-quadspi: allow building with COMPILE_TEST
    
    Cc: Ludovic Barre <ludovic.barre@st.com>
    Signed-off-by: Brian Norris <computersforpeace@gmail.com>
    Signed-off-by: Cyrille Pitchen <cyrille.pitchen@wedev4u.fr>

commit ecca81f8cb54ce74f3d5d4ba77732a216173f7b1
Author: Cyrille Pitchen <cyrille.pitchen@wedev4u.fr>
Date:   Thu May 4 21:22:07 2017 +0200

    mtd: spi-nor: stm32-quadspi: fix compiler errors with COMPILE_TEST
    
    This patch fixes some compiler errors:
    - change format strings to use %zx for size_t
    - add missing #include <linux/sizes.h>
    
    Cc: Ludovic Barre <ludovic.barre@st.com>
    Signed-off-by: Cyrille Pitchen <cyrille.pitchen@wedev4u.fr>

commit bed41005e6174d079948aa6c7796982c2dae6d8e
Author: Tom Cooksey <tom.cooksey@arm.com>
Date:   Wed Apr 12 20:17:46 2017 -0700

    drm/pl111: Initial drm/kms driver for pl111
    
    This is a modesetting driver for the pl111 CLCD display controller
    found on various ARM platforms such as the Versatile Express. The
    driver has only been tested on the bcm911360_entphn platform so far,
    with PRIME-based buffer sharing between vc4 and clcd.
    
    It reuses the existing devicetree binding, while not using quite as
    many of its properties as the fbdev driver does (those are left for
    future work).
    
    v2: Nearly complete rewrite by anholt, cutting 2/3 of the code thanks
        to DRM core's excellent new helpers.
    v3: Don't match pl110 any more, don't attach if we don't have a DRM
        panel, use DRM_GEM_CMA_FOPS, update MAINTAINERS, use the simple
        display helper, use drm_gem_cma_dumb_create (same as our wrapper).
    v4: Change the driver's .name to not clash with fbdev in sysfs, drop
        platform alias, drop redundant "drm" in DRM driver name, hook up
        .prepare_fb to the CMA helper so that DMA fences should work.
    v5: Move register definitions inside the driver directory, fix build
        in COMPILE_TEST and !AMBA mode.
    v6: Drop TIM2_CLKSEL for now to be consistent with existing DT
        bindings, switch back to external register definitions.
    
    Signed-off-by: Tom Cooksey <tom.cooksey@arm.com>
    Signed-off-by: Eric Anholt <eric@anholt.net>
    Reviewed-by: Linus Walleij <linus.walleij@linaro.org> (v5)
    Acked-by: Daniel Vetter <daniel.vetter@ffwll.ch>
    Link: http://patchwork.freedesktop.org/patch/msgid/20170413031746.12921-2-eric@anholt.net

commit 7246f60068840847bdcf595be5f0b5ca632736e0
Merge: e579dde654fc 700b7eadd562
Author: Linus Torvalds <torvalds@linux-foundation.org>
Date:   Fri May 5 11:36:44 2017 -0700

    Merge tag 'powerpc-4.12-1' of git://git.kernel.org/pub/scm/linux/kernel/git/powerpc/linux
    
    Pull powerpc updates from Michael Ellerman:
     "Highlights include:
    
       - Larger virtual address space on 64-bit server CPUs. By default we
         use a 128TB virtual address space, but a process can request access
         to the full 512TB by passing a hint to mmap().
    
       - Support for the new Power9 "XIVE" interrupt controller.
    
       - TLB flushing optimisations for the radix MMU on Power9.
    
       - Support for CAPI cards on Power9, using the "Coherent Accelerator
         Interface Architecture 2.0".
    
       - The ability to configure the mmap randomisation limits at build and
         runtime.
    
       - Several small fixes and cleanups to the kprobes code, as well as
         support for KPROBES_ON_FTRACE.
    
       - Major improvements to handling of system reset interrupts,
         correctly treating them as NMIs, giving them a dedicated stack and
         using a new hypervisor call to trigger them, all of which should
         aid debugging and robustness.
    
       - Many fixes and other minor enhancements.
    
      Thanks to: Alastair D'Silva, Alexey Kardashevskiy, Alistair Popple,
      Andrew Donnellan, Aneesh Kumar K.V, Anshuman Khandual, Anton
      Blanchard, Balbir Singh, Ben Hutchings, Benjamin Herrenschmidt,
      Bhupesh Sharma, Chris Packham, Christian Zigotzky, Christophe Leroy,
      Christophe Lombard, Daniel Axtens, David Gibson, Gautham R. Shenoy,
      Gavin Shan, Geert Uytterhoeven, Guilherme G. Piccoli, Hamish Martin,
      Hari Bathini, Kees Cook, Laurent Dufour, Madhavan Srinivasan, Mahesh J
      Salgaonkar, Mahesh Salgaonkar, Masami Hiramatsu, Matt Brown, Matthew
      R. Ochs, Michael Neuling, Naveen N. Rao, Nicholas Piggin, Oliver
      O'Halloran, Pan Xinhui, Paul Mackerras, Rashmica Gupta, Russell
      Currey, Sukadev Bhattiprolu, Thadeu Lima de Souza Cascardo, Tobin C.
      Harding, Tyrel Datwyler, Uma Krishnan, Vaibhav Jain, Vipin K Parashar,
      Yang Shi"
    
    * tag 'powerpc-4.12-1' of git://git.kernel.org/pub/scm/linux/kernel/git/powerpc/linux: (214 commits)
      powerpc/64s: Power9 has no LPCR[VRMASD] field so don't set it
      powerpc/powernv: Fix TCE kill on NVLink2
      powerpc/mm/radix: Drop support for CPUs without lockless tlbie
      powerpc/book3s/mce: Move add_taint() later in virtual mode
      powerpc/sysfs: Move #ifdef CONFIG_HOTPLUG_CPU out of the function body
      powerpc/smp: Document irq enable/disable after migrating IRQs
      powerpc/mpc52xx: Don't select user-visible RTAS_PROC
      powerpc/powernv: Document cxl dependency on special case in pnv_eeh_reset()
      powerpc/eeh: Clean up and document event handling functions
      powerpc/eeh: Avoid use after free in eeh_handle_special_event()
      cxl: Mask slice error interrupts after first occurrence
      cxl: Route eeh events to all drivers in cxl_pci_error_detected()
      cxl: Force context lock during EEH flow
      powerpc/64: Allow CONFIG_RELOCATABLE if COMPILE_TEST
      powerpc/xmon: Teach xmon oops about radix vectors
      powerpc/mm/hash: Fix off-by-one in comment about kernel contexts ids
      powerpc/pseries: Enable VFIO
      powerpc/powernv: Fix iommu table size calculation hook for small tables
      powerpc/powernv: Check kzalloc() return value in pnv_pci_table_alloc
      powerpc: Add arch/powerpc/tools directory
      ...

commit b073c2c3d40cf6cae56fd08a4bfeeb0e804dc16f
Author: Soheil Hassas Yeganeh <soheil@google.com>
Date:   Sat Mar 18 17:03:00 2017 -0400

    tcp: mark skbs with SCM_TIMESTAMPING_OPT_STATS
    
    [ Upstream commit 4ef1b2869447411ad3ef91ad7d4891a83c1a509a ]
    
    SOF_TIMESTAMPING_OPT_STATS can be enabled and disabled
    while packets are collected on the error queue.
    So, checking SOF_TIMESTAMPING_OPT_STATS in sk->sk_tsflags
    is not enough to safely assume that the skb contains
    OPT_STATS data.
    
    Add a bit in sock_exterr_skb to indicate whether the
    skb contains opt_stats data.
    
    Fixes: 1c885808e456 ("tcp: SOF_TIMESTAMPING_OPT_STATS option for SO_TIMESTAMPING")
    Reported-by: JongHwan Kim <zzoru007@gmail.com>
    Signed-off-by: Soheil Hassas Yeganeh <soheil@google.com>
    Signed-off-by: Eric Dumazet <edumazet@google.com>
    Signed-off-by: Willem de Bruijn <willemb@google.com>
    Signed-off-by: David S. Miller <davem@davemloft.net>
    Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>

commit cdaf15b43bd31003220cb080bcbbd57787a2fca9
Author: Soheil Hassas Yeganeh <soheil@google.com>
Date:   Sat Mar 18 17:02:59 2017 -0400

    tcp: fix SCM_TIMESTAMPING_OPT_STATS for normal skbs
    
    [ Upstream commit 8605330aac5a5785630aec8f64378a54891937cc ]
    
    __sock_recv_timestamp can be called for both normal skbs (for
    receive timestamps) and for skbs on the error queue (for transmit
    timestamps).
    
    Commit 1c885808e456
    (tcp: SOF_TIMESTAMPING_OPT_STATS option for SO_TIMESTAMPING)
    assumes any skb passed to __sock_recv_timestamp are from
    the error queue, containing OPT_STATS in the content of the skb.
    This results in accessing invalid memory or generating junk
    data.
    
    To fix this, set skb->pkt_type to PACKET_OUTGOING for packets
    on the error queue. This is safe because on the receive path
    on local sockets skb->pkt_type is never set to PACKET_OUTGOING.
    With that, copy OPT_STATS from a packet, only if its pkt_type
    is PACKET_OUTGOING.
    
    Fixes: 1c885808e456 ("tcp: SOF_TIMESTAMPING_OPT_STATS option for SO_TIMESTAMPING")
    Reported-by: JongHwan Kim <zzoru007@gmail.com>
    Signed-off-by: Soheil Hassas Yeganeh <soheil@google.com>
    Signed-off-by: Eric Dumazet <edumazet@google.com>
    Signed-off-by: Willem de Bruijn <willemb@google.com>
    Signed-off-by: David S. Miller <davem@davemloft.net>
    Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>

commit 477d7caeede0e3a933368440fc877b12c25dbb6d
Merge: 6fb41cbd7d82 cb710ab1d8a2
Author: Linus Torvalds <torvalds@linux-foundation.org>
Date:   Mon May 1 13:10:03 2017 -0700

    Merge branch 'mailbox-for-next' of git://git.linaro.org/landing-teams/working/fujitsu/integration
    
    Pull mailbox updates from Jassi Brar:
    
     - new driver for Broadcom FlexRM controller
    
     - constify data structures of callback functions in some drivers
    
     - a few bug fixes uncovered by multi-threaded use of mailbox channels
       in blocking mode
    
    * 'mailbox-for-next' of git://git.linaro.org/landing-teams/working/fujitsu/integration:
      mailbox: handle empty message in tx_tick
      mailbox: skip complete wait event if timer expired
      mailbox: always wait in mbox_send_message for blocking Tx mode
      mailbox: Remove depends on COMPILE_TEST for BCM_FLEXRM_MBOX
      mailbox: check ->last_tx_done for NULL in case of timer-based polling
      dt-bindings: Add DT bindings info for FlexRM ring manager
      mailbox: Add driver for Broadcom FlexRM ring manager
      dt-bindings: mailbox: Update doc with NSP PDC/mailbox support
      mailbox: bcm-pdc: Add Northstar Plus support to PDC driver
      mailbox: constify mbox_chan_ops structures

commit 084a275e4c9477c432b05e872c3a297eab41638a
Author: Nicholas Piggin <npiggin@gmail.com>
Date:   Wed Oct 19 14:16:00 2016 +1100

    powerpc/64: Allow CONFIG_RELOCATABLE if COMPILE_TEST
    
    This was a hack we added to work around the allmodconfig build breaking, see
    commit fb43e8477ed9 ("powerpc: Disable RELOCATABLE for COMPILE_TEST with
    PPC64").
    
    Since we merged the thin archives support in commit 43c9127d94d6 ("powerpc: Add
    option to use thin archives") this hasn't been necessary, so remove it.
    
    Signed-off-by: Nicholas Piggin <npiggin@gmail.com>
    Signed-off-by: Michael Ellerman <mpe@ellerman.id.au>

commit 9842119a238bfb92cbab63258dabb54f0e7b111b
Author: Marc Zyngier <marc.zyngier@arm.com>
Date:   Mon Apr 24 09:04:03 2017 +0100

    arm64: Add CNTFRQ_EL0 trap handler
    
    We now trap accesses to CNTVCT_EL0 when the counter is broken
    enough to require the kernel to mediate the access. But it
    turns out that some existing userspace (such as OpenMPI) do
    probe for the counter frequency, leading to an UNDEF exception
    as CNTVCT_EL0 and CNTFRQ_EL0 share the same control bit.
    
    The fix is to handle the exception the same way we do for CNTVCT_EL0.
    
    Fixes: a86bd139f2ae ("arm64: arch_timer: Enable CNTVCT_EL0 trap if workaround is enabled")
    Reported-by: Hanjun Guo <guohanjun@huawei.com>
    Tested-by: Hanjun Guo <guohanjun@huawei.com>
    Reviewed-by: Hanjun Guo <guohanjun@huawei.com>
    Signed-off-by: Marc Zyngier <marc.zyngier@arm.com>
    Signed-off-by: Catalin Marinas <catalin.marinas@arm.com>

commit 3e441845caf1c9591b5b961f34ff1a37d023c9e2
Author: Ralf Baechle <ralf@linux-mips.org>
Date:   Fri Apr 21 03:28:18 2017 +0200

    MIPS: Sibyte: Fix Kconfig warning.
    
    warning: (SB1XXX_CORELIS) selects DEBUG_INFO which has unmet direct dependencies (DEBUG_KERNEL &amp;&amp; !COMPILE_TEST)
    
    Signed-off-by: Ralf Baechle <ralf@linux-mips.org>

commit 6c7a5dce22b3f3cc44be098e2837fa6797edb8b8
Author: Andrew Jones <drjones@redhat.com>
Date:   Tue Apr 18 17:59:58 2017 +0200

    KVM: arm/arm64: fix races in kvm_psci_vcpu_on
    
    Fix potential races in kvm_psci_vcpu_on() by taking the kvm->lock
    mutex.  In general, it's a bad idea to allow more than one PSCI_CPU_ON
    to process the same target VCPU at the same time.  One such problem
    that may arise is that one PSCI_CPU_ON could be resetting the target
    vcpu, which fills the entire sys_regs array with a temporary value
    including the MPIDR register, while another looks up the VCPU based
    on the MPIDR value, resulting in no target VCPU found.  Resolves both
    races found with the kvm-unit-tests/arm/psci unit test.
    
    Reviewed-by: Marc Zyngier <marc.zyngier@arm.com>
    Reviewed-by: Christoffer Dall <cdall@linaro.org>
    Reported-by: Levente Kurusa <lkurusa@redhat.com>
    Suggested-by: Christoffer Dall <cdall@linaro.org>
    Signed-off-by: Andrew Jones <drjones@redhat.com>
    Cc: stable@vger.kernel.org
    Signed-off-by: Christoffer Dall <cdall@linaro.org>

commit d91750f12c79101028cb93dc35eed6989fae4405
Author: Marc Zyngier <marc.zyngier@arm.com>
Date:   Tue Apr 11 17:32:30 2017 +0100

    arm64: Silence spurious kbuild warning on menuconfig
    
    Since bbb56c27228d ("arm64: Add detection code for broken .inst support
    in binutils"), running any make target that doesn't involve the cross
    compiler results in a spurious warning:
    
    $ make ARCH=arm64 menuconfig
    arch/arm64/Makefile:43: Detected assembler with broken .inst; disassembly will be unreliable
    
    while
    
    $ make ARCH=arm64 CROSS_COMPILE=aarch64-arm-linux- menuconfig
    
    is silent (assuming your compiler is not affected). That's because
    the code that tests for the workaround is always run, irrespective
    of the current configuration being available or not.
    
    An easy fix is to make the detection conditional on CONFIG_ARM64
    being defined, which is only the case when actually building
    something.
    
    Fixes: bbb56c27228d ("arm64: Add detection code for broken .inst support in binutils")
    Reviewed-by: Robin Murphy <robin.murphy@arm.com>
    Signed-off-by: Marc Zyngier <marc.zyngier@arm.com>
    Signed-off-by: Catalin Marinas <catalin.marinas@arm.com>

commit 73874913d5044fb5d81d34b2c760a8df8521bd0f
Author: Anup Patel <anup.patel@broadcom.com>
Date:   Wed Mar 29 11:00:55 2017 +0530

    mailbox: Remove depends on COMPILE_TEST for BCM_FLEXRM_MBOX
    
    The Broadcom FlexRM mailbox driver uses platform MSI support but
    not all ARCHs provide asm/msi.h. Due to this, we get compilation
    error in Broadcom FlexRM mailbox driver via linux/msi.h on ARCHs
    which lack asm/msi.h.
    
    This patch removes "depends on COMPILE_TEST" for Kconfig option
    BCM_FLEXRM_MBOX so that Broadcom FlexRM mailbox driver is only
    compiled for ARM64.
    
    Signed-off-by: Anup Patel <anup.patel@broadcom.com>
    Signed-off-by: Jassi Brar <jaswinder.singh@linaro.org>

commit f341d9f08ae01d90d8d0c135ae2edf4423e724c9
Merge: 093b995e3b55 68c386590375
Author: Linus Torvalds <torvalds@linux-foundation.org>
Date:   Thu Mar 23 11:29:49 2017 -0700

    Merge git://git.kernel.org/pub/scm/linux/kernel/git/davem/net
    
    Pull networking fixes from David Miller:
    
     1) Several netfilter fixes from Pablo and the crew:
          - Handle fragmented packets properly in netfilter conntrack, from
            Florian Westphal.
          - Fix SCTP ICMP packet handling, from Ying Xue.
          - Fix big-endian bug in nftables, from Liping Zhang.
          - Fix alignment of fake conntrack entry, from Steven Rostedt.
    
     2) Fix feature flags setting in fjes driver, from Taku Izumi.
    
     3) Openvswitch ipv6 tunnel source address not set properly, from Or
        Gerlitz.
    
     4) Fix jumbo MTU handling in amd-xgbe driver, from Thomas Lendacky.
    
     5) sk->sk_frag.page not released properly in some cases, from Eric
        Dumazet.
    
     6) Fix RTNL deadlocks in nl80211, from Johannes Berg.
    
     7) Fix erroneous RTNL lockdep splat in crypto, from Herbert Xu.
    
     8) Cure improper inflight handling during AF_UNIX GC, from Andrey
        Ulanov.
    
     9) sch_dsmark doesn't write to packet headers properly, from Eric
        Dumazet.
    
    10) Fix SCM_TIMESTAMPING_OPT_STATS handling in TCP, from Soheil Hassas
        Yeganeh.
    
    11) Add some IDs for Motorola qmi_wwan chips, from Tony Lindgren.
    
    12) Fix nametbl deadlock in tipc, from Ying Xue.
    
    13) GRO and LRO packets not counted correctly in mlx5 driver, from Gal
        Pressman.
    
    14) Fix reset of internal PHYs in bcmgenet, from Doug Berger.
    
    15) Fix hashmap allocation handling, from Alexei Starovoitov.
    
    16) nl_fib_input() needs stronger netlink message length checking, from
        Eric Dumazet.
    
    17) Fix double-free of sk->sk_filter during sock clone, from Daniel
        Borkmann.
    
    18) Fix RX checksum offloading in aquantia driver, from Pavel Belous.
    
    * git://git.kernel.org/pub/scm/linux/kernel/git/davem/net: (85 commits)
      net:ethernet:aquantia: Fix for RX checksum offload.
      amd-xgbe: Fix the ECC-related bit position definitions
      sfc: cleanup a condition in efx_udp_tunnel_del()
      Bluetooth: btqcomsmd: fix compile-test dependency
      inet: frag: release spinlock before calling icmp_send()
      tcp: initialize icsk_ack.lrcvtime at session start time
      genetlink: fix counting regression on ctrl_dumpfamily()
      socket, bpf: fix sk_filter use after free in sk_clone_lock
      ipv4: provide stronger user input validation in nl_fib_input()
      bpf: fix hashmap extra_elems logic
      enic: update enic maintainers
      net: bcmgenet: remove bcmgenet_internal_phy_setup()
      ipv6: make sure to initialize sockc.tsflags before first use
      fjes: Do not load fjes driver if extended socket device is not power on.
      fjes: Do not load fjes driver if system does not have extended socket device.
      net/mlx5e: Count LRO packets correctly
      net/mlx5e: Count GSO packets correctly
      net/mlx5: Increase number of max QPs in default profile
      net/mlx5e: Avoid supporting udp tunnel port ndo for VF reps
      net/mlx5e: Use the proper UAPI values when offloading TC vlan actions
      ...

commit 6e9e6cc8f4e4f2cd67931510c9f39abf3d9e0d3b
Author: Arnd Bergmann <arnd@arndb.de>
Date:   Mon Mar 20 15:31:10 2017 -0700

    Bluetooth: btqcomsmd: fix compile-test dependency
    
    compile-testing fails when QCOM_SMD is a loadable module:
    
    drivers/bluetooth/built-in.o: In function `btqcomsmd_send':
    btqca.c:(.text+0xa8): undefined reference to `qcom_smd_send'
    drivers/bluetooth/built-in.o: In function `btqcomsmd_probe':
    btqca.c:(.text+0x3ec): undefined reference to `qcom_wcnss_open_channel'
    btqca.c:(.text+0x46c): undefined reference to `qcom_smd_set_drvdata'
    
    This clarifies the dependency to allow compile-testing only when
    SMD is completely disabled, otherwise the dependency on QCOM_SMD
    will make sure we can link against it.
    
    Fixes: e27ee2b16bad ("Bluetooth: btqcomsmd: Allow driver to build if COMPILE_TEST is enabled")
    Signed-off-by: Arnd Bergmann <arnd@arndb.de>
    [bjorn: Restructure and clarify dependency to QCOM_WCNSS_CTRL]
    Signed-off-by: Bjorn Andersson <bjorn.andersson@linaro.org>
    Acked-by: Marcel Holtmann <marcel@holtmann.org>
    Signed-off-by: David S. Miller <davem@davemloft.net>

commit c1b5e3db0b985ee76bdb023fc2dd637cc0d8aed2
Author: Mauro Carvalho Chehab <mchehab@s-opensource.com>
Date:   Thu Mar 9 16:55:48 2017 -0300

    [media] platform: compile VIDEO_CODA with COMPILE_TEST
    
    Currently, IMX_VDOA and VIDEO_CODA only builds on ARCH_MXC.
    
    That prevented me to build-test the driver, causing a bad patch
    to be applied, and to see other warnings on this driver.
    
    Hans wrote a similar patch, but his version was fold with a
    warning fixup hunk.
    So, I opted to keep my version.
    
    Reported-by: Russell King <linux@armlinux.org.uk>
    Signed-off-by: Mauro Carvalho Chehab <mchehab@s-opensource.com>
    Signed-off-by Hans Verkuil <hans.verkuil@cisco.com>
    Acked-by Philipp Zabel <p.zabel@pengutronix.de>

commit 132c93d4215c5ea12f8bb291249ede159d507b6e
Author: Cyril Bur <cyrilbur@gmail.com>
Date:   Wed Mar 22 14:13:28 2017 +1100

    drivers/misc: Aspeed LPC control fix compile error and warning
    
    pgprot_dmachoerent() is not defined on every architecture. Having
    COMPILE_TEST set for the driver causes it to be compiled on
    architectures which do not have pgprot_dmachoerent():
        drivers/misc/aspeed-lpc-ctrl.c: In function 'aspeed_lpc_ctrl_mmap':
        drivers/misc/aspeed-lpc-ctrl.c:51:9: error: implicit declaration of
            function 'pgprot_dmacoherent' [-Werror=implicit-function-declaration]
            prot = pgprot_dmacoherent(prot);
    
    There are two possible solutions:
        1. Remove COMPILE_TEST to ensure the driver is only compiled on ARM
        2. Use pgprot_noncached() instead of pgprot_dmachoerent()
    
    The first option results in less compile testing of the LPC control
    driver which is undesirable.
    The second option uses a function that is declared on all architectures
    and therefore should always build. Currently there is no practical
    difference between pgprot_noncached() and pgprot_dmachoerent() for the
    aspeed chips that this driver is compatible with. The reason for
    pgprot_dmachoerent() was that there may be chips made at some point in
    the future that could include hardware that pgprot_dmachoerent() could
    optimise for. As none of this hardware has even been announced there
    isn't really a need for pgprot_dmachoerent().
    
    Using pgprot_noncached() is completely correct and optimal for all
    existing hardware on which the LPC control driver will run.
    
    This commit also addresses that phys_addr_t should be printed using %pap
    rather than %x:
        In file included from include/linux/miscdevice.h:6:0,
                         from drivers/misc/aspeed-lpc-ctrl.c:11:
        drivers/misc/aspeed-lpc-ctrl.c: In function 'aspeed_lpc_ctrl_probe':
        drivers/misc/aspeed-lpc-ctrl.c:232:17: warning: format '%x' expects
            argument of type 'unsigned int', but argument 3 has type 'phys_addr_t
            {aka long long unsigned int}' [-Wformat=]
            dev_info(dev, "Loaded at 0x%08x (0x%08x)\n",
    
    Signed-off-by: Cyril Bur <cyrilbur@gmail.com>
    Reported-by: kbuild test robot <fengguang.wu@intel.com>
    Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>

commit 4ef1b2869447411ad3ef91ad7d4891a83c1a509a
Author: Soheil Hassas Yeganeh <soheil@google.com>
Date:   Sat Mar 18 17:03:00 2017 -0400

    tcp: mark skbs with SCM_TIMESTAMPING_OPT_STATS
    
    SOF_TIMESTAMPING_OPT_STATS can be enabled and disabled
    while packets are collected on the error queue.
    So, checking SOF_TIMESTAMPING_OPT_STATS in sk->sk_tsflags
    is not enough to safely assume that the skb contains
    OPT_STATS data.
    
    Add a bit in sock_exterr_skb to indicate whether the
    skb contains opt_stats data.
    
    Fixes: 1c885808e456 ("tcp: SOF_TIMESTAMPING_OPT_STATS option for SO_TIMESTAMPING")
    Reported-by: JongHwan Kim <zzoru007@gmail.com>
    Signed-off-by: Soheil Hassas Yeganeh <soheil@google.com>
    Signed-off-by: Eric Dumazet <edumazet@google.com>
    Signed-off-by: Willem de Bruijn <willemb@google.com>
    Signed-off-by: David S. Miller <davem@davemloft.net>

commit 8605330aac5a5785630aec8f64378a54891937cc
Author: Soheil Hassas Yeganeh <soheil@google.com>
Date:   Sat Mar 18 17:02:59 2017 -0400

    tcp: fix SCM_TIMESTAMPING_OPT_STATS for normal skbs
    
    __sock_recv_timestamp can be called for both normal skbs (for
    receive timestamps) and for skbs on the error queue (for transmit
    timestamps).
    
    Commit 1c885808e456
    (tcp: SOF_TIMESTAMPING_OPT_STATS option for SO_TIMESTAMPING)
    assumes any skb passed to __sock_recv_timestamp are from
    the error queue, containing OPT_STATS in the content of the skb.
    This results in accessing invalid memory or generating junk
    data.
    
    To fix this, set skb->pkt_type to PACKET_OUTGOING for packets
    on the error queue. This is safe because on the receive path
    on local sockets skb->pkt_type is never set to PACKET_OUTGOING.
    With that, copy OPT_STATS from a packet, only if its pkt_type
    is PACKET_OUTGOING.
    
    Fixes: 1c885808e456 ("tcp: SOF_TIMESTAMPING_OPT_STATS option for SO_TIMESTAMPING")
    Reported-by: JongHwan Kim <zzoru007@gmail.com>
    Signed-off-by: Soheil Hassas Yeganeh <soheil@google.com>
    Signed-off-by: Eric Dumazet <edumazet@google.com>
    Signed-off-by: Willem de Bruijn <willemb@google.com>
    Signed-off-by: David S. Miller <davem@davemloft.net>

commit 6df014cffbe335ea7f41ee5324d8ba2047d3f0d0
Author: Ezequiel Lara Gomez <ezegomez@amazon.com>
Date:   Sat Mar 11 20:06:54 2017 +0000

    Enable tx timestamping on loopback and dummy
    
    This enables developing code that uses SOF_TIMESTAMPING_TX_SOFTWARE
    by using localhost addresses (without needing to send packets outside),
    as well as enabling unit and functional testing of TX timestamping code
    without needing hardware support or network access.
    
    It also fulfills the expectation of software network devices supporting
    software-based timestamping.
    
    Tested on qemu using txtimestamping.c from the kernel selftests, and
    ethtool -T.
    
    Signed-off-by: Ezequiel Lara Gomez <ezegomez@amazon.com>
    Signed-off-by: David S. Miller <davem@davemloft.net>

commit 393bf9b38ad3f29c6663e8e76fce4f034e6ef673
Author: Thomas Petazzoni <thomas.petazzoni@free-electrons.com>
Date:   Tue Feb 28 15:31:15 2017 +0100

    PCI: mvebu: Remove useless MSI enabling code
    
    Since commit fcc392d501bd2 ("irqchip/armada-370-xp: Use the generic MSI
    infrastructure"), the irqchip driver used on Armada 370, XP, 375, 38x, 39x
    for the MPIC interrupt controller has been converted to use the generic MSI
    infrastructure.
    
    Since this commit, it is no longer registering an msi_controller structure
    with the of_pci_msi_chip_add() function. Therefore, having the PCI driver
    used on the same platform calling of_pci_find_msi_chip_by_node() is pretty
    useless.
    
    The MSI resolution is now done in the generic interrupt resolution code,
    since the MSI controller is an irq domain attached to the interrupt
    controller node, which is pointed to by the msi-parent DT property in the
    PCIe controller node.
    
    Signed-off-by: Thomas Petazzoni <thomas.petazzoni@free-electrons.com>
    Signed-off-by: Bjorn Helgaas <bhelgaas@google.com>
    Acked-by: Marc Zyngier <marc.zyngier@arm.com>

commit 01db1cb154af04e6e6b7025ed4c93074f0981e8c
Author: Paul Gortmaker <paul.gortmaker@windriver.com>
Date:   Tue Feb 7 19:18:45 2017 -0500

    reset: pistachio: make it explicitly non-modular
    
    The Kconfig currently controlling compilation of this code is:
    
    drivers/reset/Kconfig:config RESET_PISTACHIO
    drivers/reset/Kconfig:  bool "Pistachio Reset Driver" if COMPILE_TEST
    
    ...meaning that it currently is not being built as a module by anyone.
    
    Lets remove the couple traces of modular infrastructure use, so that
    when reading the driver there is no doubt it is builtin-only.
    
    Since module_platform_driver() uses the same init level priority as
    builtin_platform_driver() the init ordering remains unchanged with
    this commit.
    
    Also note that MODULE_DEVICE_TABLE is a no-op for non-modular code.
    
    We also delete the MODULE_LICENSE tag etc. since all that information
    is already contained at the top of the file in the comments.
    
    Cc: Damien Horsley <Damien.Horsley@imgtec.com>
    Signed-off-by: Paul Gortmaker <paul.gortmaker@windriver.com>
    Signed-off-by: Philipp Zabel <p.zabel@pengutronix.de>

commit 90ce95ab3d661417ce2a17eebc894285960f7068
Author: Paul Gortmaker <paul.gortmaker@windriver.com>
Date:   Tue Feb 7 19:18:44 2017 -0500

    reset: ath79: make it explicitly non-modular
    
    The Kconfig currently controlling compilation of this code is:
    
    drivers/reset/Kconfig:config RESET_ATH79
    drivers/reset/Kconfig:  bool "AR71xx Reset Driver" if COMPILE_TEST
    
    ...meaning that it currently is not being built as a module by anyone.
    
    Lets remove the modular code that is essentially orphaned, so that
    when reading the driver there is no doubt it is builtin-only.
    
    We explicitly disallow a driver unbind, since that doesn't have a
    sensible use case anyway, and it allows us to drop the ".remove"
    code for non-modular drivers.
    
    Since module_platform_driver() uses the same init level priority as
    builtin_platform_driver() the init ordering remains unchanged with
    this commit.
    
    Also note that MODULE_DEVICE_TABLE is a no-op for non-modular code.
    
    We also delete the MODULE_LICENSE tag etc. since all that information
    was (or is now) contained at the top of the file in the comments.
    
    Cc: Alban Bedel <albeu@free.fr>
    Signed-off-by: Paul Gortmaker <paul.gortmaker@windriver.com>
    Acked-by: Alban Bedel <albeu@free.fr>
    Signed-off-by: Philipp Zabel <p.zabel@pengutronix.de>

commit 4f1f2b8f0818af9b0e21ba4b17ab615e29b4650d
Merge: 474c90156c8d 9ad82f117f05
Author: Linus Torvalds <torvalds@linux-foundation.org>
Date:   Thu Mar 2 12:45:46 2017 -0800

    Merge tag 'watchdog-for-linus-v4.11-2' of git://git.kernel.org/pub/scm/linux/kernel/git/groeck/linux-staging
    
    Pull more watchdog updates from Guenter Roeck:
    
     - fix fallout from enabling COMPILE_TEST
    
     - fix gcc-4.3 build of kempld watchdog driver
    
     - use hrtimer in softdog
    
    * tag 'watchdog-for-linus-v4.11-2' of git://git.kernel.org/pub/scm/linux/kernel/git/groeck/linux-staging:
      watchdog: retu: restore MFD dependency
      watchdog: db8500: add back prmcu dependency
      watchdog: kempld: fix gcc-4.3 build
      watchdog: softdog: fire watchdog even if softirqs do not get to run
      watchdog: kempld: revert to full dependency
      watchdog: bcm2835: add CONFIG_OF dependency
      watchdog: sp805: add back AMBA dependency
      watchdog: menf21bmc: add I2C dependency
      watchdog: geode: restore hard CS5535_MFGPT dependency
      watchdog: wm831x watchdog really needs mfd

commit 9ad82f117f057ed04643cc60ce16fbf59e1b167f
Author: Arnd Bergmann <arnd@arndb.de>
Date:   Wed Mar 1 10:15:31 2017 +0100

    watchdog: retu: restore MFD dependency
    
    The retu watchdog calls into the respective mfd driver, but fails to
    link if that is diabled:
    
    drivers/watchdog/built-in.o: In function `retu_wdt_set_timeout':
    ziirave_wdt.c:(.text+0x8c88): undefined reference to `retu_write'
    ziirave_wdt.c:(.text+0x8c88): relocation truncated to fit: R_AARCH64_CALL26 against undefined symbol `retu_write'
    drivers/watchdog/built-in.o: In function `retu_wdt_start':
    ziirave_wdt.c:(.text+0x8cc8): undefined reference to `retu_write'
    ziirave_wdt.c:(.text+0x8cc8): relocation truncated to fit: R_AARCH64_CALL26 against undefined symbol `retu_write'
    
    This restores the dependency as it was before
    
    Fixes: da2a68b3eb47 ("watchdog: Enable COMPILE_TEST where possible")
    Signed-off-by: Arnd Bergmann <arnd@arndb.de>
    Signed-off-by: Guenter Roeck <linux@roeck-us.net>

commit 9297b652bd0a11e29251ffaac93369b8ad45932d
Author: Arnd Bergmann <arnd@arndb.de>
Date:   Wed Mar 1 10:15:30 2017 +0100

    watchdog: db8500: add back prmcu dependency
    
    When the db8500 watchdog is enabled without the PRCMU, we get a lot of
    warnings about duplicate or missing helper functions:
    
    In file included from drivers/watchdog/ux500_wdt.c:21:0:
    include/linux/mfd/dbx500-prcmu.h:422:19: error: redefinition of 'prcmu_abb_read'
     static inline int prcmu_abb_read(u8 slave, u8 reg, u8 *value, u8 size)
    
    This restores the dependency as it was.
    
    Fixes: da2a68b3eb47 ("watchdog: Enable COMPILE_TEST where possible")
    Signed-off-by: Arnd Bergmann <arnd@arndb.de>
    Signed-off-by: Guenter Roeck <linux@roeck-us.net>

commit ed4a9eca66720366d117d9b39f2335ca9b0a7aae
Author: Arnd Bergmann <arnd@arndb.de>
Date:   Tue Feb 28 22:01:23 2017 +0100

    watchdog: kempld: revert to full dependency
    
    The kempld watchdog driver requires the respective MFD driver:
    
    drivers/watchdog/built-in.o: In function `kempld_wdt_probe':
    kempld_wdt.c:(.text+0x5c78): undefined reference to `kempld_get_mutex'
    kempld_wdt.c:(.text+0x5c84): undefined reference to `kempld_read8'
    kempld_wdt.c:(.text+0x5c8e): undefined reference to `kempld_release_mutex'
    kempld_wdt.c:(.text+0x5d1c): undefined reference to `kempld_read8'
    kempld_wdt.c:(.text+0x5d2c): undefined reference to `kempld_write8'
    
    This adds the Kconfig dependency back.
    
    Fixes: da2a68b3eb47 ("watchdog: Enable COMPILE_TEST where possible")
    Signed-off-by: Arnd Bergmann <arnd@arndb.de>
    Signed-off-by: Guenter Roeck <linux@roeck-us.net>

commit 2672b7e01abbe147a0a391216bc0dbd656608e0a
Author: Arnd Bergmann <arnd@arndb.de>
Date:   Tue Feb 28 22:01:22 2017 +0100

    watchdog: bcm2835: add CONFIG_OF dependency
    
    Without CONFIG_OF, the driver fails to link:
    
    drivers/watchdog/built-in.o: In function `bcm2835_power_off':
    bcm2835_wdt.c:(.text+0x1946): undefined reference to `of_find_device_by_node'
    
    This adds a new dependency, to allow the COMPILE_TEST check to succeed.
    
    Fixes: da2a68b3eb47 ("watchdog: Enable COMPILE_TEST where possible")
    Signed-off-by: Arnd Bergmann <arnd@arndb.de>
    Signed-off-by: Guenter Roeck <linux@roeck-us.net>

commit 3eafee95643360d22c6725ea2188bd700c09c986
Author: Arnd Bergmann <arnd@arndb.de>
Date:   Tue Feb 28 22:01:21 2017 +0100

    watchdog: sp805: add back AMBA dependency
    
    The driver fails to link if ARM_AMBA is disabled:
    
    drivers/watchdog/sp805_wdt.o: In function `sp805_wdt_driver_init':
    sp805_wdt.c:(.init.text+0x4): undefined reference to `amba_driver_register'
    
    It seems that the COMPILE_TEST was added in the wrong place, as there
    is no architecture dependency, but a bus dependency. This moves
    the dependency accordingly.
    
    Fixes: da2a68b3eb47 ("watchdog: Enable COMPILE_TEST where possible")
    Signed-off-by: Arnd Bergmann <arnd@arndb.de>
    Signed-off-by: Guenter Roeck <linux@roeck-us.net>

commit 6fb303a81a0b106e7f5522df929bbf4596780c48
Author: Arnd Bergmann <arnd@arndb.de>
Date:   Tue Feb 28 22:01:20 2017 +0100

    watchdog: menf21bmc: add I2C dependency
    
    This driver fails to link when CONFIG_I2C is disabled or a loadable module while
    the watchdog is built-in:
    
    drivers/watchdog/built-in.o: In function `menf21bmc_wdt_shutdown':
    menf21bmc_wdt.c:(.text+0x9b44): undefined reference to `i2c_smbus_write_word_data'
    menf21bmc_wdt.c:(.text+0x9b44): relocation truncated to fit: R_AARCH64_CALL26 against undefined symbol `i2c_smbus_write_word_data'
    
    This adds a Kconfig dependency for it, to enforce a valid configuration.
    
    Fixes: da2a68b3eb47 ("watchdog: Enable COMPILE_TEST where possible")
    Signed-off-by: Arnd Bergmann <arnd@arndb.de>
    Signed-off-by: Guenter Roeck <linux@roeck-us.net>

commit 0369fdf2e1169896529bd53c3b5fb15511768276
Author: Arnd Bergmann <arnd@arndb.de>
Date:   Tue Feb 28 22:01:19 2017 +0100

    watchdog: geode: restore hard CS5535_MFGPT dependency
    
    Wtihout CONFIG_CS5535_MFGPT, the driver does not link right:
    
    drivers/watchdog/built-in.o: In function `geodewdt_probe':
    geodewdt.c:(.init.text+0xca3): undefined reference to `cs5535_mfgpt_alloc_timer'
    geodewdt.c:(.init.text+0xcd4): undefined reference to `cs5535_mfgpt_write'
    geodewdt.c:(.init.text+0xcef): undefined reference to `cs5535_mfgpt_toggle_event'
    
    This adds back the dependency on this base driver.
    
    Fixes: da2a68b3eb47 ("watchdog: Enable COMPILE_TEST where possible")
    Signed-off-by: Arnd Bergmann <arnd@arndb.de>
    Signed-off-by: Guenter Roeck <linux@roeck-us.net>

commit d0e32fba85d5b7902db2715a9d5540fb0efdba83
Author: Arnd Bergmann <arnd@arndb.de>
Date:   Tue Feb 28 22:01:18 2017 +0100

    watchdog: wm831x watchdog really needs mfd
    
    The wm831x watchdog driver can now be built without the wm831x mfd
    driver, which results in a link error:
    
    (.text+0x1a95c): undefined reference to `wm831x_set_bits'
    (.text+0x1a95c): relocation truncated to fit: R_AARCH64_CALL26 against undefined symbol `wm831x_set_bits'
    (.text+0x1a968): undefined reference to `wm831x_reg_lock'
    (.text+0x1a968): relocation truncated to fit: R_AARCH64_CALL26 against undefined symbol `wm831x_reg_lock'
    (.text+0x1a9dc): undefined reference to `wm831x_reg_unlock'
    (.text+0x1a9dc): relocation truncated to fit: R_AARCH64_CALL26 against undefined symbol `wm831x_reg_unlock'
    
    This adds back the dependency that was removed. We can still build test
    this driver on all architectures by enabling the MFD driver for it first.
    
    Fixes: da2a68b3eb47 ("watchdog: Enable COMPILE_TEST where possible")
    Signed-off-by: Arnd Bergmann <arnd@arndb.de>
    Signed-off-by: Guenter Roeck <linux@roeck-us.net>

commit e5d56efc97f8240d0b5d66c03949382b6d7e5570
Merge: c4f3f22eddc9 e3a60ead2c9b
Author: Linus Torvalds <torvalds@linux-foundation.org>
Date:   Sun Feb 26 13:19:17 2017 -0800

    Merge tag 'watchdog-for-linus-v4.11' of git://git.kernel.org/pub/scm/linux/kernel/git/groeck/linux-staging
    
    Pull watchdog updates from Guenter Roeck:
     "Wim asked me to handle the watchdog pull request this time around.
    
      Key changes:
    
       - New drivers: Cortina Gemini, ZTE's zx2967 family, NIC7018
    
       - Convert to use device managed functions: ebc-c384_wdt, tegra_wdt,
         da9063_wdt, da9062_wdt, da9055_wdt, da9052_wdt, bcm2835_wdt,
         mena21_wdt, wm831x_wdt, digicolor_wdt, intel-mid_wdt, meson_wdt,
         sunxi_wdt, aspeed_wdt, coh901327_wdt, iTCO_wdt
    
       - Use watchdog core to install restart handler: tangox, dw_wdt,
         bcm2835_wdt, asm9260_wdt, bcm47xx_wdt
    
       - Convert ts72xx_wdt driver to watchdog core
    
       - Let core handle heartbeat in ep93xx_wdt driver
    
       - Enable COMPILE_TEST where possible
    
       - Various other improvements"
    
    * tag 'watchdog-for-linus-v4.11' of git://git.kernel.org/pub/scm/linux/kernel/git/groeck/linux-staging: (54 commits)
      watchdog: s3c2410: Add prefix to local function
      watchdog: s3c2410: Select MFD_SYSCON on all Exynos platforms
      watchdog: s3c2410: Use dev_dbg instead of pr_info
      watchdog: s3c2410: Fix infinite interrupt in soft mode
      watchdog: s3c2410: Remove confusing CONFIG prefix from local defines
      watchdog: softdog: make pretimeout support a compile option
      watchdog: zx2967: add watchdog controller driver for ZTE's zx2967 family
      dt: bindings: add documentation for zx2967 family watchdog controller
      watchdog: sama5d4: Implement resume hook
      watchdog: sama5d4: Cache MR instead of a partial config
      watchdog: ts72xx_wdt: convert driver to watchdog core
      watchdog: ep93xx_wdt: cleanup and let the core handle the heartbeat
      watchdog: RDC321X_WDT always depends on PCI
      watchdog: add driver for Cortina Gemini watchdog
      watchdog: add DT bindings for Cortina Gemini
      watchdog: constify watchdog_ops structures
      watchdog: Introduce watchdog_stop_on_unregister helper
      watchdog: ebc-c384_wdt: Utilize devm_ functions in driver probe callback
      watchdog: tegra_wdt: Convert to use device managed functions
      watchdog: da9063_wdt: Convert to use device managed functions
      ...

commit 8751f90c819c156befc630d467adbc003bd59d87
Author: Guenter Roeck <linux@roeck-us.net>
Date:   Sun Jan 29 11:12:08 2017 -0800

    watchdog: RDC321X_WDT always depends on PCI
    
    Without this dependency, platforms not supporting PCI (such as m68k)
    report the following build warning when building allmodconfig
    or allyesconfig.
    
    drivers/watchdog/rdc321x_wdt.c: In function 'rdc321x_wdt_ioctl':
    ./arch/m68k/include/asm/uaccess_mm.h:61:1: warning:
            'value' may be used uninitialized in this function
    
    Fixes: f4c3de659054 ("watchdog: Enable COMPILE_TEST where possible")
    Signed-off-by: Guenter Roeck <linux@roeck-us.net>

commit da2a68b3eb47b9fb071def3f374258b2ce454096
Author: Guenter Roeck <linux@roeck-us.net>
Date:   Thu Dec 29 07:20:23 2016 -0800

    watchdog: Enable COMPILE_TEST where possible
    
    Building all watchdog drivers is all but impossible since many depend
    on platforms which are not enabled by test builds. Add dependency on
    COMPILE_TEST where possible to improve the situation.
    
    Signed-off-by: Guenter Roeck <linux@roeck-us.net>

commit 0a74b364c4c2ce4bfffdbefd62cced99ad76bec9
Author: Andrey Ryabinin <aryabinin@virtuozzo.com>
Date:   Thu Nov 24 13:23:10 2016 +0000

    mpi: Fix NULL ptr dereference in mpi_powm() [ver #3]
    
    commit f5527fffff3f002b0a6b376163613b82f69de073 upstream.
    
    This fixes CVE-2016-8650.
    
    If mpi_powm() is given a zero exponent, it wants to immediately return
    either 1 or 0, depending on the modulus.  However, if the result was
    initalised with zero limb space, no limbs space is allocated and a
    NULL-pointer exception ensues.
    
    Fix this by allocating a minimal amount of limb space for the result when
    the 0-exponent case when the result is 1 and not touching the limb space
    when the result is 0.
    
    This affects the use of RSA keys and X.509 certificates that carry them.
    
    BUG: unable to handle kernel NULL pointer dereference at           (null)
    IP: [<ffffffff8138ce5d>] mpi_powm+0x32/0x7e6
    PGD 0
    Oops: 0002 [#1] SMP
    Modules linked in:
    CPU: 3 PID: 3014 Comm: keyctl Not tainted 4.9.0-rc6-fscache+ #278
    Hardware name: ASUS All Series/H97-PLUS, BIOS 2306 10/09/2014
    task: ffff8804011944c0 task.stack: ffff880401294000
    RIP: 0010:[<ffffffff8138ce5d>]  [<ffffffff8138ce5d>] mpi_powm+0x32/0x7e6
    RSP: 0018:ffff880401297ad8  EFLAGS: 00010212
    RAX: 0000000000000000 RBX: ffff88040868bec0 RCX: ffff88040868bba0
    RDX: ffff88040868b260 RSI: ffff88040868bec0 RDI: ffff88040868bee0
    RBP: ffff880401297ba8 R08: 0000000000000000 R09: 0000000000000000
    R10: 0000000000000047 R11: ffffffff8183b210 R12: 0000000000000000
    R13: ffff8804087c7600 R14: 000000000000001f R15: ffff880401297c50
    FS:  00007f7a7918c700(0000) GS:ffff88041fb80000(0000) knlGS:0000000000000000
    CS:  0010 DS: 0000 ES: 0000 CR0: 0000000080050033
    CR2: 0000000000000000 CR3: 0000000401250000 CR4: 00000000001406e0
    Stack:
     ffff88040868bec0 0000000000000020 ffff880401297b00 ffffffff81376cd4
     0000000000000100 ffff880401297b10 ffffffff81376d12 ffff880401297b30
     ffffffff81376f37 0000000000000100 0000000000000000 ffff880401297ba8
    Call Trace:
     [<ffffffff81376cd4>] ? __sg_page_iter_next+0x43/0x66
     [<ffffffff81376d12>] ? sg_miter_get_next_page+0x1b/0x5d
     [<ffffffff81376f37>] ? sg_miter_next+0x17/0xbd
     [<ffffffff8138ba3a>] ? mpi_read_raw_from_sgl+0xf2/0x146
     [<ffffffff8132a95c>] rsa_verify+0x9d/0xee
     [<ffffffff8132acca>] ? pkcs1pad_sg_set_buf+0x2e/0xbb
     [<ffffffff8132af40>] pkcs1pad_verify+0xc0/0xe1
     [<ffffffff8133cb5e>] public_key_verify_signature+0x1b0/0x228
     [<ffffffff8133d974>] x509_check_for_self_signed+0xa1/0xc4
     [<ffffffff8133cdde>] x509_cert_parse+0x167/0x1a1
     [<ffffffff8133d609>] x509_key_preparse+0x21/0x1a1
     [<ffffffff8133c3d7>] asymmetric_key_preparse+0x34/0x61
     [<ffffffff812fc9f3>] key_create_or_update+0x145/0x399
     [<ffffffff812fe227>] SyS_add_key+0x154/0x19e
     [<ffffffff81001c2b>] do_syscall_64+0x80/0x191
     [<ffffffff816825e4>] entry_SYSCALL64_slow_path+0x25/0x25
    Code: 56 41 55 41 54 53 48 81 ec a8 00 00 00 44 8b 71 04 8b 42 04 4c 8b 67 18 45 85 f6 89 45 80 0f 84 b4 06 00 00 85 c0 75 2f 41 ff ce <49> c7 04 24 01 00 00 00 b0 01 75 0b 48 8b 41 18 48 83 38 01 0f
    RIP  [<ffffffff8138ce5d>] mpi_powm+0x32/0x7e6
     RSP <ffff880401297ad8>
    CR2: 0000000000000000
    ---[ end trace d82015255d4a5d8d ]---
    
    Basically, this is a backport of a libgcrypt patch:
    
            http://git.gnupg.org/cgi-bin/gitweb.cgi?p=libgcrypt.git;a=patch;h=6e1adb05d290aeeb1c230c763970695f4a538526
    
    Fixes: cdec9cb5167a ("crypto: GnuPG based MPI lib - source files (part 1)")
    Signed-off-by: Andrey Ryabinin <aryabinin@virtuozzo.com>
    Signed-off-by: David Howells <dhowells@redhat.com>
    cc: Dmitry Kasatkin <dmitry.kasatkin@gmail.com>
    cc: linux-ima-devel@lists.sourceforge.net
    Signed-off-by: James Morris <james.l.morris@oracle.com>
    Signed-off-by: Ben Hutchings <ben@decadent.org.uk>

commit cf0adb8e281b69801fb8faef18c14443d9d41d3c
Author: Jaehoon Chung <jh80.chung@samsung.com>
Date:   Mon Feb 13 17:26:11 2017 +0900

    phy: phy-exynos-pcie: Add support for Exynos PCIe PHY
    
    Add support for Generic PHY framework about Exynos SoCs.  Current Exynos
    PCIe driver doesn't use the PHY framework, which makes it difficult to
    upstream the other Exynos variants because of different PHY registers.
    
    Move the codes relevant to PHY from Exnyos PCIe driver to PHY Exynos PCIe
    driver.
    
    [bhelgaas: depend on "OF && (ARCH_EXYNOS || COMPILE_TEST)", update
    copyright year, both per Vivek]
    Signed-off-by: Jaehoon Chung <jh80.chung@samsung.com>
    Acked-by: Krzysztof Kozlowski <krzk@kernel.org>
    Reviewed-by: Jingoo Han <jingoohan1@gmail.com>
    Reviewed-by: Pankaj Dubey <pankaj.dubey@samsung.com>
    Reviewed-by: Vivek Gautam <vivek.gautam@codeaurora.org>
    Signed-off-by: Bjorn Helgaas <bhelgaas@google.com>

commit 85adbcd54f0982040c8cc7a086f01554b8f64427
Merge: f790bd9c8e82 57f22cd29cf1
Author: Linus Torvalds <torvalds@linux-foundation.org>
Date:   Mon Feb 20 17:26:11 2017 -0800

    Merge tag 'spi-v4.11' of git://git.kernel.org/pub/scm/linux/kernel/git/broonie/spi
    
    Pull spi updates from Mark Brown:
     "This release is mainly a collection of driver specific updates,
      including a few nice cleanups to make drivers use more core features.
    
       - automatically use the parent device to allocate DMA buffers if
         there wasn't an explicitly configured device.
    
       - fixes for leaks on allocation.
    
       - a small piece of the start of SPI slave support, a feature that's
         been on the cards for over a decade!"
    
    * tag 'spi-v4.11' of git://git.kernel.org/pub/scm/linux/kernel/git/broonie/spi: (55 commits)
      spi: spi-ti-qspi: Fix error handling
      spi: spi-ti-qspi: Fix error handling
      spi: lantiq-ssc: activate under COMPILE_TEST
      spi: armada-3700: Remove spi_master_put in a3700_spi_remove()
      spi: ti-qspi: revise ti_qspi_probe() failure flow
      spi: spi-ep93xx: simplify GPIO chip selects
      spi: rspi: Replaces "n" by "len" in qspi_transfer_*()
      spi: rspi: Fixes bogus received byte in qspi_transfer_in()
      spi: bcm-qspi: Remove unnecessary platform_set_drvdata()
      spi: bcm-qspi: Fix bcm_qspi_bspi_read() performance
      spi: lantiq-ssc: add support for Lantiq SSC SPI controller
      spi: s3c64xx: fix inconsistency between binding and driver
      spi: armada-3700: Remove .owner field for driver
      spi: bcm-qspi: Added mspi read fallback in bcm_qspi_flash_read()
      spi: fix device-node leaks
      spi: mediatek: Only do dma for 4-byte aligned buffers
      spi: When no dma_chan map buffers with spi_master's parent
      spi: pca2xx-pci: Allow MSI
      spi: pxa2xx: Prepare for edge-triggered interrupts
      spi: pxa2xx: Add support for Intel Gemini Lake
      ...

commit 582c97f6868cf70720a17d2421d317333f3ad597
Author: Hauke Mehrtens <hauke@hauke-m.de>
Date:   Sat Feb 18 17:06:48 2017 +0100

    spi: lantiq-ssc: activate under COMPILE_TEST
    
    This driver should compile on all platforms, activate it under compile
    test. The Lantiq specific parts are under ifdef and should be removed
    when Lantiq platform supports common clock framework.
    
    Signed-off-by: Hauke Mehrtens <hauke@hauke-m.de>
    Signed-off-by: Mark Brown <broonie@kernel.org>

commit e27ee2b16bad0c2ae648f5ee67d0555e0cd799d6
Author: Javier Martinez Canillas <javier@osg.samsung.com>
Date:   Mon Jan 2 10:23:23 2017 -0300

    Bluetooth: btqcomsmd: Allow driver to build if COMPILE_TEST is enabled
    
    The driver only has runtime but no build time dependency with QCOM_SMD &&
    QCOM_WCNSS_CTRL. So it can be built for testing purposes if COMPILE_TEST
    option is enabled.
    
    This is useful to have more build coverage and make sure that the driver
    is not affected by changes that could cause build regressions.
    
    Signed-off-by: Javier Martinez Canillas <javier@osg.samsung.com>
    Signed-off-by: Marcel Holtmann <marcel@holtmann.org>

commit b5d5f2877c8d447f56a9b5477e485e6361fcd2d3
Author: ojab <ojab@ojab.ru>
Date:   Wed Dec 28 11:05:24 2016 +0000

    scsi: mpt3sas: disable ASPM for MPI2 controllers
    
    commit ffdadd68af5a397b8a52289ab39d62e1acb39e63 upstream.
    
    MPI2 controllers sometimes got lost (i.e. disappear from
    /sys/bus/pci/devices) if ASMP is enabled.
    
    Signed-off-by: Slava Kardakov <ojab@ojab.ru>
    Fixes: https://bugzilla.kernel.org/show_bug.cgi?id=60644
    Acked-by: Sreekanth Reddy <Sreekanth.Reddy@broadcom.com>
    Signed-off-by: Martin K. Petersen <martin.petersen@oracle.com>
    Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>

commit 1c0da0ac217bb4d8efc7a59326c9d4cc48ddb08a
Author: ojab <ojab@ojab.ru>
Date:   Wed Dec 28 11:05:24 2016 +0000

    scsi: mpt3sas: disable ASPM for MPI2 controllers
    
    commit ffdadd68af5a397b8a52289ab39d62e1acb39e63 upstream.
    
    MPI2 controllers sometimes got lost (i.e. disappear from
    /sys/bus/pci/devices) if ASMP is enabled.
    
    Signed-off-by: Slava Kardakov <ojab@ojab.ru>
    Fixes: https://bugzilla.kernel.org/show_bug.cgi?id=60644
    Acked-by: Sreekanth Reddy <Sreekanth.Reddy@broadcom.com>
    Signed-off-by: Martin K. Petersen <martin.petersen@oracle.com>
    Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>

commit 634ce97cdfa94a0c5444489b656a662fcc344536
Author: Michael Ellerman <mpe@ellerman.id.au>
Date:   Thu Feb 9 19:56:28 2017 +1100

    selftests: Fix the .S and .S -> .o rules
    
    Both these rules incorrectly use $< (first prerequisite) rather than
    $^ (all prerequisites), meaning they don't work if we're using more than
    one .S file as input. Switch them to using $^.
    
    They also don't include $(CPPFLAGS) and other variables used in the
    default rules, which breaks targets that require those. Fix that by
    using the builtin $(COMPILE.S) and $(LINK.S) rules.
    
    Fixes: a8ba798bc8ec ("selftests: enable O and KBUILD_OUTPUT")
    Signed-off-by: Michael Ellerman <mpe@ellerman.id.au>
    Tested by: Bamvor Jian Zhang <bamvor.zhangjian@linaro.org>
    Signed-off-by: Shuah Khan <shuahkh@osg.samsung.com>

commit 13ebfd0601228fbbd92707ce4944ab1a09a4d821
Merge: 1ee18329fae9 ed6de4560ad2
Author: Linus Torvalds <torvalds@linux-foundation.org>
Date:   Sat Feb 11 09:01:03 2017 -0800

    Merge tag 'scsi-fixes' of git://git.kernel.org/pub/scm/linux/kernel/git/jejb/scsi
    
    Pull SCSI fixes from James Bottomley:
     "Six fairly small fixes. None is a real show stopper, two automation
      detected problems: one memory leak, one use after free and four others
      each of which fixes something that has been a significant source of
      annoyance to someone"
    
    * tag 'scsi-fixes' of git://git.kernel.org/pub/scm/linux/kernel/git/jejb/scsi:
      scsi: zfcp: fix use-after-free by not tracing WKA port open/close on failed send
      scsi: aacraid: Fix INTx/MSI-x issue with older controllers
      scsi: mpt3sas: disable ASPM for MPI2 controllers
      scsi: mpt3sas: Force request partial completion alignment
      scsi: qla2xxx: Avoid that issuing a LIP triggers a kernel crash
      scsi: qla2xxx: Fix a recently introduced memory leak

commit 4c147bcff52b582cd278f39261302a4659da3fef
Author: Arnd Bergmann <arnd@arndb.de>
Date:   Mon Feb 6 13:32:16 2017 +0100

    crypto: atmel - fix 64-bit build warnings
    
    When we enable COMPILE_TEST building for the Atmel sha and tdes implementations,
    we run into a couple of warnings about incorrect format strings, e.g.
    
    In file included from include/linux/platform_device.h:14:0,
                     from drivers/crypto/atmel-sha.c:24:
    drivers/crypto/atmel-sha.c: In function 'atmel_sha_xmit_cpu':
    drivers/crypto/atmel-sha.c:571:19: error: format '%d' expects argument of type 'int', but argument 6 has type 'size_t {aka long unsigned int}' [-Werror=format=]
    In file included from include/linux/printk.h:6:0,
                     from include/linux/kernel.h:13,
                     from drivers/crypto/atmel-tdes.c:17:
    drivers/crypto/atmel-tdes.c: In function 'atmel_tdes_crypt_dma_stop':
    include/linux/kern_levels.h:4:18: error: format '%u' expects argument of type 'unsigned int', but argument 2 has type 'size_t {aka long unsigned int}' [-Werror=format=]
    
    These are all fixed by using the "%z" modifier for size_t data.
    
    There are also a few uses of min()/max() with incompatible types:
    
    drivers/crypto/atmel-tdes.c: In function 'atmel_tdes_crypt_start':
    drivers/crypto/atmel-tdes.c:528:181: error: comparison of distinct pointer types lacks a cast [-Werror]
    
    Where possible, we should use consistent types here, otherwise we can use
    min_t()/max_t() to get well-defined behavior without a warning.
    
    Signed-off-by: Arnd Bergmann <arnd@arndb.de>
    Signed-off-by: Herbert Xu <herbert@gondor.apana.org.au>

commit ceb4afb3086ab08f0d1d9cb3da536a18ea2e5918
Author: Arnd Bergmann <arnd@arndb.de>
Date:   Mon Feb 6 13:32:15 2017 +0100

    crypto: atmel - refine Kconfig dependencies
    
    With the new authenc support, we get a harmless Kconfig warning:
    
    warning: (CRYPTO_DEV_ATMEL_AUTHENC) selects CRYPTO_DEV_ATMEL_SHA which has unmet direct dependencies (CRYPTO && CRYPTO_HW && ARCH_AT91)
    
    The problem is that each of the options has slightly different dependencies,
    although they all seem to want the same thing: allow building for real AT91
    targets that actually have the hardware, and possibly for compile testing.
    
    This makes all four options consistent: instead of depending on a particular
    dmaengine implementation, we depend on the ARM platform, CONFIG_COMPILE_TEST
    as an alternative when that is turned off. This makes the 'select' statements
    work correctly.
    
    Fixes: 89a82ef87e01 ("crypto: atmel-authenc - add support to authenc(hmac(shaX), Y(aes)) modes")
    Signed-off-by: Arnd Bergmann <arnd@arndb.de>
    Signed-off-by: Herbert Xu <herbert@gondor.apana.org.au>

commit 940d1175de7c31e8e2ac20489b7d2df4963bb4da
Author: Andrey Ryabinin <aryabinin@virtuozzo.com>
Date:   Thu Nov 24 13:23:10 2016 +0000

    mpi: Fix NULL ptr dereference in mpi_powm() [ver #3]
    
    commit f5527fffff3f002b0a6b376163613b82f69de073 upstream.
    
    This fixes CVE-2016-8650.
    
    If mpi_powm() is given a zero exponent, it wants to immediately return
    either 1 or 0, depending on the modulus.  However, if the result was
    initalised with zero limb space, no limbs space is allocated and a
    NULL-pointer exception ensues.
    
    Fix this by allocating a minimal amount of limb space for the result when
    the 0-exponent case when the result is 1 and not touching the limb space
    when the result is 0.
    
    This affects the use of RSA keys and X.509 certificates that carry them.
    
    BUG: unable to handle kernel NULL pointer dereference at           (null)
    IP: [<ffffffff8138ce5d>] mpi_powm+0x32/0x7e6
    PGD 0
    Oops: 0002 [#1] SMP
    Modules linked in:
    CPU: 3 PID: 3014 Comm: keyctl Not tainted 4.9.0-rc6-fscache+ #278
    Hardware name: ASUS All Series/H97-PLUS, BIOS 2306 10/09/2014
    task: ffff8804011944c0 task.stack: ffff880401294000
    RIP: 0010:[<ffffffff8138ce5d>]  [<ffffffff8138ce5d>] mpi_powm+0x32/0x7e6
    RSP: 0018:ffff880401297ad8  EFLAGS: 00010212
    RAX: 0000000000000000 RBX: ffff88040868bec0 RCX: ffff88040868bba0
    RDX: ffff88040868b260 RSI: ffff88040868bec0 RDI: ffff88040868bee0
    RBP: ffff880401297ba8 R08: 0000000000000000 R09: 0000000000000000
    R10: 0000000000000047 R11: ffffffff8183b210 R12: 0000000000000000
    R13: ffff8804087c7600 R14: 000000000000001f R15: ffff880401297c50
    FS:  00007f7a7918c700(0000) GS:ffff88041fb80000(0000) knlGS:0000000000000000
    CS:  0010 DS: 0000 ES: 0000 CR0: 0000000080050033
    CR2: 0000000000000000 CR3: 0000000401250000 CR4: 00000000001406e0
    Stack:
     ffff88040868bec0 0000000000000020 ffff880401297b00 ffffffff81376cd4
     0000000000000100 ffff880401297b10 ffffffff81376d12 ffff880401297b30
     ffffffff81376f37 0000000000000100 0000000000000000 ffff880401297ba8
    Call Trace:
     [<ffffffff81376cd4>] ? __sg_page_iter_next+0x43/0x66
     [<ffffffff81376d12>] ? sg_miter_get_next_page+0x1b/0x5d
     [<ffffffff81376f37>] ? sg_miter_next+0x17/0xbd
     [<ffffffff8138ba3a>] ? mpi_read_raw_from_sgl+0xf2/0x146
     [<ffffffff8132a95c>] rsa_verify+0x9d/0xee
     [<ffffffff8132acca>] ? pkcs1pad_sg_set_buf+0x2e/0xbb
     [<ffffffff8132af40>] pkcs1pad_verify+0xc0/0xe1
     [<ffffffff8133cb5e>] public_key_verify_signature+0x1b0/0x228
     [<ffffffff8133d974>] x509_check_for_self_signed+0xa1/0xc4
     [<ffffffff8133cdde>] x509_cert_parse+0x167/0x1a1
     [<ffffffff8133d609>] x509_key_preparse+0x21/0x1a1
     [<ffffffff8133c3d7>] asymmetric_key_preparse+0x34/0x61
     [<ffffffff812fc9f3>] key_create_or_update+0x145/0x399
     [<ffffffff812fe227>] SyS_add_key+0x154/0x19e
     [<ffffffff81001c2b>] do_syscall_64+0x80/0x191
     [<ffffffff816825e4>] entry_SYSCALL64_slow_path+0x25/0x25
    Code: 56 41 55 41 54 53 48 81 ec a8 00 00 00 44 8b 71 04 8b 42 04 4c 8b 67 18 45 85 f6 89 45 80 0f 84 b4 06 00 00 85 c0 75 2f 41 ff ce <49> c7 04 24 01 00 00 00 b0 01 75 0b 48 8b 41 18 48 83 38 01 0f
    RIP  [<ffffffff8138ce5d>] mpi_powm+0x32/0x7e6
     RSP <ffff880401297ad8>
    CR2: 0000000000000000
    ---[ end trace d82015255d4a5d8d ]---
    
    Basically, this is a backport of a libgcrypt patch:
    
            http://git.gnupg.org/cgi-bin/gitweb.cgi?p=libgcrypt.git;a=patch;h=6e1adb05d290aeeb1c230c763970695f4a538526
    
    Fixes: cdec9cb5167a ("crypto: GnuPG based MPI lib - source files (part 1)")
    Signed-off-by: Andrey Ryabinin <aryabinin@virtuozzo.com>
    Signed-off-by: David Howells <dhowells@redhat.com>
    cc: Dmitry Kasatkin <dmitry.kasatkin@gmail.com>
    cc: linux-ima-devel@lists.sourceforge.net
    Signed-off-by: James Morris <james.l.morris@oracle.com>
    Signed-off-by: Willy Tarreau <w@1wt.eu>

commit ffdadd68af5a397b8a52289ab39d62e1acb39e63
Author: ojab <ojab@ojab.ru>
Date:   Wed Dec 28 11:05:24 2016 +0000

    scsi: mpt3sas: disable ASPM for MPI2 controllers
    
    MPI2 controllers sometimes got lost (i.e. disappear from
    /sys/bus/pci/devices) if ASMP is enabled.
    
    Signed-off-by: Slava Kardakov <ojab@ojab.ru>
    Fixes: https://bugzilla.kernel.org/show_bug.cgi?id=60644
    Cc: <stable@vger.kernel.org>
    Acked-by: Sreekanth Reddy <Sreekanth.Reddy@broadcom.com>
    Signed-off-by: Martin K. Petersen <martin.petersen@oracle.com>

commit 31bb90f1cd084e0ca1359455eaf74bb64b5c5c82
Author: Arnd Bergmann <arnd@arndb.de>
Date:   Wed Feb 1 16:59:21 2017 +0100

    drm/amdgpu: shut up #warning for compile testing
    
    My randconfig tests on linux-next showed a newly introduced warning:
    
    drivers/gpu/drm/amd/amdgpu/amdgpu_object.c: In function 'amdgpu_bo_create_restricted':
    drivers/gpu/drm/amd/amdgpu/amdgpu_object.c:377:2: error: #warning Please enable CONFIG_MTRR and CONFIG_X86_PAT for better performance thanks to write-combining [-Werror=cpp]
    
    Generally speaking, warnings about bad kernel configuration are not particularly
    helpful. We could enforce the selection of X86_PAT through Kconfig, so the driver
    cannot even be used unless it is enabled, or we could just rely on the runtime
    warning that is also there.
    
    In this version, I'm making the warning conditional on CONFIG_COMPILE_TEST, which
    shuts it up for me, but not people that may actually want to run the kernel
    as a compromize.
    
    Fixes: a2e2f29970aa ("drm/amdgpu: Bring bo creation in line with radeon driver (v2)")
    Reviewed-by: Michel Dnzer <michel.daenzer@amd.com>
    Signed-off-by: Arnd Bergmann <arnd@arndb.de>
    Signed-off-by: Alex Deucher <alexander.deucher@amd.com>

commit 88654a154ab6581cad22d2d73266b61242410fb8
Author: Robin Murphy <robin.murphy@arm.com>
Date:   Mon Sep 26 16:50:55 2016 +0100

    ARM: 8616/1: dt: Respect property size when parsing CPUs
    
    commit ba6dea4f7cedb4b1c17e36f4087675d817c2e24b upstream.
    
    Whilst MPIDR values themselves are less than 32 bits, it is still
    perfectly valid for a DT to have #address-cells > 1 in the CPUs node,
    resulting in the "reg" property having leading zero cell(s). In that
    situation, the big-endian nature of the data conspires with the current
    behaviour of only reading the first cell to cause the kernel to think
    all CPUs have ID 0, and become resoundingly unhappy as a consequence.
    
    Take the full property length into account when parsing CPUs so as to
    be correct under any circumstances.
    
    Cc: Russell King <linux@armlinux.org.uk>
    Signed-off-by: Robin Murphy <robin.murphy@arm.com>
    Signed-off-by: Russell King <rmk+kernel@arm.linux.org.uk>
    Signed-off-by: Willy Tarreau <w@1wt.eu>

commit 93946c49cdafd6a2e4039a8208564fd18e9120c3
Author: Alexandre Belloni <alexandre.belloni@free-electrons.com>
Date:   Wed Feb 1 12:54:13 2017 +0100

    rtc: sun6i: extend test coverage
    
    COMPILE_TEST was wrongly placed, move it to the "depends on" line.
    Also depend on COMMON_CLK as the driver now needs it to be properly
    compiled.
    
    Signed-off-by: Alexandre Belloni <alexandre.belloni@free-electrons.com>

commit 6c44c0fe91af7bac78dcaf4c106421862530f499
Author: Chaitra P B <chaitra.basappa@broadcom.com>
Date:   Mon Jan 23 15:26:07 2017 +0530

    scsi: mpt3sas: Added print to notify cable running at a degraded speed.
    
    Driver processes the event MPI26_EVENT_ACTIVE_CABLE_DEGRADED when a
    cable is present and is running at a degraded speed (below the SAS3 12
    Gb/s rate). Prints added to inform the user that the cable is not
    running at optimal speed.
    
    Signed-off-by: Chaitra P B <chaitra.basappa@broadcom.com>
    Signed-off-by: Suganath Prabu S <suganath-prabu.subramani@broadcom.com>
    Reviewed-by: Johannes Thumshirn <jthumshirn@suse.de>
    Signed-off-by: Martin K. Petersen <martin.petersen@oracle.com>

commit 012bbe28c0e3a479ec7ba6f311710cf8409647d4
Merge: bb7e98334157 55d661658536
Author: Dave Airlie <airlied@redhat.com>
Date:   Wed Feb 1 08:31:09 2017 +1000

    Merge tag 'drm-misc-next-2017-01-30' of git://anongit.freedesktop.org/git/drm-misc into drm-next
    
    Another round of -misc stuff:
    - Noralf debugfs cleanup cleanup (not yet everything, some more driver
      patches awaiting acks).
    - More doc work.
    - edid/infoframe fixes from Ville.
    - misc 1-patch fixes all over, as usual
    
    Noralf needs this for his tinydrm pull request.
    
    * tag 'drm-misc-next-2017-01-30' of git://anongit.freedesktop.org/git/drm-misc: (48 commits)
      drm/vc4: Remove vc4_debugfs_cleanup()
      dma/fence: Export enable-signaling tracepoint for emission by drivers
      drm/tilcdc: Remove tilcdc_debugfs_cleanup()
      drm/tegra: Remove tegra_debugfs_cleanup()
      drm/sti: Remove drm_debugfs_remove_files() calls
      drm/radeon: Remove drm_debugfs_remove_files() call
      drm/omap: Remove omap_debugfs_cleanup()
      drm/hdlcd: Remove hdlcd_debugfs_cleanup()
      drm/etnaviv: Remove etnaviv_debugfs_cleanup()
      drm/etnaviv: allow build with COMPILE_TEST
      drm/amd/amdgpu: Remove drm_debugfs_remove_files() call
      drm/prime: Clarify DMA-BUF/GEM Object lifetime
      drm/ttm: Make sure BOs being swapped out are cacheable
      drm/atomic: Remove drm_atomic_debugfs_cleanup()
      drm: drm_minor_register(): Clean up debugfs on failure
      drm: debugfs: Remove all files automatically on cleanup
      drm/fourcc: add vivante tiled layout format modifiers
      drm/edid: Set YQ bits in the AVI infoframe according to CEA-861-F
      drm/edid: Set AVI infoframe Q even when QS=0
      drm/edid: Introduce drm_hdmi_avi_infoframe_quant_range()
      ...

commit d017d7b0bd7ab32644d35666a6c4412daa0b0a1d
Author: Vijaya Kumar K <Vijaya.Kumar@cavium.com>
Date:   Thu Jan 26 19:50:51 2017 +0530

    KVM: arm/arm64: vgic: Implement VGICv3 CPU interface access
    
    VGICv3 CPU interface registers are accessed using
    KVM_DEV_ARM_VGIC_CPU_SYSREGS ioctl. These registers are accessed
    as 64-bit. The cpu MPIDR value is passed along with register id.
    It is used to identify the cpu for registers access.
    
    The VM that supports SEIs expect it on destination machine to handle
    guest aborts and hence checked for ICC_CTLR_EL1.SEIS compatibility.
    Similarly, VM that supports Affinity Level 3 that is required for AArch64
    mode, is required to be supported on destination machine. Hence checked
    for ICC_CTLR_EL1.A3V compatibility.
    
    The arch/arm64/kvm/vgic-sys-reg-v3.c handles read and write of VGIC
    CPU registers for AArch64.
    
    For AArch32 mode, arch/arm/kvm/vgic-v3-coproc.c file is created but
    APIs are not implemented.
    
    Updated arch/arm/include/uapi/asm/kvm.h with new definitions
    required to compile for AArch32.
    
    The version of VGIC v3 specification is defined here
    Documentation/virtual/kvm/devices/arm-vgic-v3.txt
    
    Acked-by: Christoffer Dall <christoffer.dall@linaro.org>
    Reviewed-by: Eric Auger <eric.auger@redhat.com>
    Signed-off-by: Pavel Fedin <p.fedin@samsung.com>
    Signed-off-by: Vijaya Kumar K <Vijaya.Kumar@cavium.com>
    Signed-off-by: Marc Zyngier <marc.zyngier@arm.com>

commit 678550c651aee051d66112933c87894f129b9355
Author: Yuchung Cheng <ycheng@google.com>
Date:   Fri Jan 27 16:24:39 2017 -0800

    tcp: include locally failed retries in retransmission stats
    
    Currently the retransmission stats are not incremented if the
    retransmit fails locally. But we always increment the other packet
    counters that track total packet/bytes sent.  Awkwardly while we
    don't count these failed retransmits in RETRANSSEGS, we do count
    them in FAILEDRETRANS.
    
    If the qdisc is dropping many packets this could under-estimate
    TCP retransmission rate substantially from both SNMP or per-socket
    TCP_INFO stats. This patch changes this by always incrementing
    retransmission stats on retransmission attempts and failures.
    
    Another motivation is to properly track retransmists in
    SCM_TIMESTAMPING_OPT_STATS. Since SCM_TSTAMP_SCHED collection is
    triggered in tcp_transmit_skb(), If tp->total_retrans is incremented
    after the function, we'll always mis-count by the amount of the
    latest retransmission.
    
    Signed-off-by: Yuchung Cheng <ycheng@google.com>
    Signed-off-by: Soheil Hassas Yeganeh <soheil@google.com>
    Acked-by: Neal Cardwell <ncardwell@google.com>
    Acked-by: Eric Dumazet <edumazet@google.com>
    Signed-off-by: David S. Miller <davem@davemloft.net>

commit 7e98102f489775d8c000884fca8a0d995ea688a9
Author: Yuchung Cheng <ycheng@google.com>
Date:   Fri Jan 27 16:24:38 2017 -0800

    tcp: record pkts sent and retransmistted
    
    Add two stats in SCM_TIMESTAMPING_OPT_STATS:
    
    TCP_NLA_DATA_SEGS_OUT: total data packets sent including retransmission
    TCP_NLA_TOTAL_RETRANS: total data packets retransmitted
    
    The names are picked to be consistent with corresponding fields in
    TCP_INFO. This allows applications that are using the timestamping
    API to measure latency stats to also retrive retransmission rate
    of application write.
    
    Signed-off-by: Yuchung Cheng <ycheng@google.com>
    Signed-off-by: Soheil Hassas Yeganeh <soheil@google.com>
    Acked-by: Neal Cardwell <ncardwell@google.com>
    Acked-by: Eric Dumazet <edumazet@google.com>
    Signed-off-by: David S. Miller <davem@davemloft.net>

commit 2f38a67a725bc3cb2c5143510b2da1b660b5d912
Author: Noralf Trnnes <noralf@tronnes.org>
Date:   Thu Jan 26 23:56:08 2017 +0100

    drm/etnaviv: allow build with COMPILE_TEST
    
    Make it possible to compile test the driver on other platforms.
    
    Cc: l.stach@pengutronix.de
    Cc: linux+etnaviv@armlinux.org.uk
    Cc: christian.gmeiner@gmail.com
    Signed-off-by: Noralf Trnnes <noralf@tronnes.org>
    Acked-by: Lucas Stach <l.stach@pengutronix.de>
    Signed-off-by: Daniel Vetter <daniel.vetter@ffwll.ch>
    Link: http://patchwork.freedesktop.org/patch/msgid/20170126225621.12314-7-noralf@tronnes.org

commit 31489c0b1d8b33e5b696ba18feb880617e937554
Author: Kuninori Morimoto <kuninori.morimoto.gx@renesas.com>
Date:   Wed Jan 25 00:51:04 2017 +0000

    ASoC: cq93vc: remove MFD_DAVINCI_VOICECODEC dependency from CQ0093VC
    
    CQ0093VC is no longer dependent on MFD_DAVINCI_VOICECODEC,
    let's remove it. Otherwise, we can't compile it by COMPILE_TEST
    on non-DAVINCE platform
    
    Signed-off-by: Kuninori Morimoto <kuninori.morimoto.gx@renesas.com>
    Signed-off-by: Mark Brown <broonie@kernel.org>

commit f99b63afb943c920bde71bf69880be5578c4c4f6
Author: Paul Gortmaker <paul.gortmaker@windriver.com>
Date:   Sat Jan 21 22:08:25 2017 -0500

    serial: hp300: mask the warning for people just doing build coverage
    
    Currently this warning is triggered for allmodconfig on m68k.  It is
    well intentioned, in that if you are building the driver but not
    enabling one of the platforms where the hardware exists, you get a
    warning.
    
    The warning dates back to pre-git days, and now we have COMPILE_TEST
    so we can use that to mask the warning for people who are obviously
    just doing build coverage on tree wide changes.
    
    Cc: Greg Kroah-Hartman <gregkh@linuxfoundation.org>
    Cc: Jiri Slaby <jslaby@suse.com>
    Cc: Geert Uytterhoeven <geert@linux-m68k.org>
    Cc: linux-m68k@lists.linux-m68k.org
    Cc: linux-serial@vger.kernel.org
    Signed-off-by: Paul Gortmaker <paul.gortmaker@windriver.com>
    Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>

commit 5bf22ff32e736beb8ba91a99a3e116d12e7eabd0
Author: Scott Branden <scott.branden@broadcom.com>
Date:   Sat Oct 8 13:54:05 2016 -0700

    pwm: bcm-iproc: Update dependencies for compile-test
    
    Add dependency on COMMON_CLK and allow COMPILE_TEST for broader compile
    coverage. Default to Y for IPROC SoCs. This allows the driver to simply
    be enabled by selecting PWM.
    
    Signed-off-by: Scott Branden <scott.branden@broadcom.com>
    Reviewed-by: Ray Jui <ray.jui@broadcom.com>
    [thierry.reding@gmail.com: reword commit message]
    Signed-off-by: Thierry Reding <thierry.reding@gmail.com>

commit e12799125074c67cd30bc3d7a5ff5e2f29ea1411
Author: Stanimir Varbanov <stanimir.varbanov@linaro.org>
Date:   Tue Nov 22 19:03:09 2016 +0200

    firmware: qcom: scm: Add empty functions to help compile testing
    
    This will help to compile testing drivers which depends on scm
    functions with COMPILE_TEST Kconfig option.
    
    Signed-off-by: Stanimir Varbanov <stanimir.varbanov@linaro.org>
    Reviewed-by: Stephen Boyd <sboyd@codeaurora.org>
    Signed-off-by: Andy Gross <andy.gross@linaro.org>

commit 41e05324fde983b1342f86239868f1959f6032a5
Author: Arnd Bergmann <arnd@arndb.de>
Date:   Wed Jan 11 14:55:20 2017 +0100

    crypto: mediatek - fix format string for 64-bit builds
    
    After I enabled COMPILE_TEST for non-ARM targets, I ran into these
    warnings:
    
    crypto/mediatek/mtk-aes.c: In function 'mtk_aes_info_map':
    crypto/mediatek/mtk-aes.c:224:28: error: format '%d' expects argument of type 'int', but argument 3 has type 'long unsigned int' [-Werror=format=]
       dev_err(cryp->dev, "dma %d bytes error\n", sizeof(*info));
    crypto/mediatek/mtk-sha.c:344:28: error: format '%d' expects argument of type 'int', but argument 3 has type 'long unsigned int' [-Werror=format=]
    crypto/mediatek/mtk-sha.c:550:21: error: format '%u' expects argument of type 'unsigned int', but argument 4 has type 'size_t {aka long unsigned int}' [-Werror=format=]
    
    The correct format for size_t is %zu, so use that in all three
    cases.
    
    Fixes: 785e5c616c84 ("crypto: mediatek - Add crypto driver support for some MediaTek chips")
    Signed-off-by: Arnd Bergmann <arnd@arndb.de>
    Signed-off-by: Herbert Xu <herbert@gondor.apana.org.au>

commit 4f44d86df083c3bc91d2fc315fc133c514d26a0d
Author: Javier Martinez Canillas <javier@osg.samsung.com>
Date:   Mon Jan 2 14:06:57 2017 -0300

    crypto: picoxcell - Allow driver to build COMPILE_TEST is enabled
    
    Driver only has runtime but no build time dependency with ARCH_PICOXCELL.
    So it can be built for testing purposes if COMPILE_TEST option is enabled.
    
    This is useful to have more build coverage and make sure that the driver
    is not affected by changes that could cause build regressions.
    
    Suggested-by: Arnd Bergmann <arnd@arndb.de>
    Signed-off-by: Javier Martinez Canillas <javier@osg.samsung.com>
    Acked-by: Jamie Iles <jamie@jamieiles.com>
    Signed-off-by: Herbert Xu <herbert@gondor.apana.org.au>

commit 45d446038c7b93c40b2fe5ba0e95380f19e0493e
Author: Sasikumar Chandrasekaran <sasikumar.pc@broadcom.com>
Date:   Tue Jan 10 18:20:45 2017 -0500

    scsi: megaraid_sas: EEDP Escape Mode Support for SAS3.5 Generic Megaraid Controllers
    
    An UNMAP command on a PI formatted device will leave the Logical Block Application
    Tag and Logical Block Reference Tag as all F's (for those LBAs that are unmapped).
    To avoid IO errors if those LBAs are subsequently read before they are written with
    valid tag fields, the MPI SCSI IO requests need to set the EEDPFlags element EEDP
    Escape Mode field, Bits [7:6] appropriately.  A value of 2 should be set to disable
    all PI checks if the Logical Block Application Tag is 0xFFFF for PI types 1 and 2.
    A value of 3 should be set to disable all PI checks if the Logical Block Application
    Tag is 0xFFFF and the Logical Block Reference Tag is 0xFFFFFFFF for PI type 3.
    
    Signed-off-by: Sasikumar Chandrasekaran <sasikumar.pc@broadcom.com>
    Reviewed-by: Tomas Henzl <thenzl@redhat.com>
    Signed-off-by: Martin K. Petersen <martin.petersen@oracle.com>

commit 113783ec1cdbc208ca10927348cf37b983ea3b34
Author: Kashyap Desai <kashyap.desai@broadcom.com>
Date:   Fri Oct 21 06:33:35 2016 -0700

    scsi: megaraid_sas: Do not set MPI2_TYPE_CUDA for JBOD FP path for FW which does not support JBOD sequence map
    
    commit d5573584429254a14708cf8375c47092b5edaf2c upstream.
    
    Signed-off-by: Sumit Saxena <sumit.saxena@broadcom.com>
    Reviewed-by: Hannes Reinecke <hare@suse.com>
    Reviewed-by: Tomas Henzl <thenzl@redhat.com>
    Signed-off-by: Martin K. Petersen <martin.petersen@oracle.com>
    Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>

commit 9c3928be0dbac79a2f5c340e2ea829b296f8a946
Author: Kashyap Desai <kashyap.desai@broadcom.com>
Date:   Fri Oct 21 06:33:35 2016 -0700

    scsi: megaraid_sas: Do not set MPI2_TYPE_CUDA for JBOD FP path for FW which does not support JBOD sequence map
    
    commit d5573584429254a14708cf8375c47092b5edaf2c upstream.
    
    Signed-off-by: Sumit Saxena <sumit.saxena@broadcom.com>
    Reviewed-by: Hannes Reinecke <hare@suse.com>
    Reviewed-by: Tomas Henzl <thenzl@redhat.com>
    Signed-off-by: Martin K. Petersen <martin.petersen@oracle.com>
    Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>

commit bccd78746f8838db63ddd7fea65e4f76ec0434d5
Author: Kashyap Desai <kashyap.desai@broadcom.com>
Date:   Fri Oct 21 06:33:35 2016 -0700

    scsi: megaraid_sas: Do not set MPI2_TYPE_CUDA for JBOD FP path for FW which does not support JBOD sequence map
    
    commit d5573584429254a14708cf8375c47092b5edaf2c upstream.
    
    Signed-off-by: Sumit Saxena <sumit.saxena@broadcom.com>
    Reviewed-by: Hannes Reinecke <hare@suse.com>
    Reviewed-by: Tomas Henzl <thenzl@redhat.com>
    Signed-off-by: Martin K. Petersen <martin.petersen@oracle.com>
    Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>

commit 5a2d4a5763c96a19170f81f2c4bb3cc9515f854a
Author: bamvor.zhangjian@huawei.com <bamvor.zhangjian@huawei.com>
Date:   Tue Nov 29 19:55:50 2016 +0800

    selftests: remove CROSS_COMPILE in dedicated Makefile
    
    After previous clean up patches, memfd and timers could get
    CROSS_COMPILE from tools/testing/selftest/lib.mk. There is no need to
    preserve these definition. So, this patch remove them.
    
    Acked-by: Michael Ellerman <mpe@ellerman.id.au>
    Signed-off-by: Bamvor Jian Zhang <bamvor.zhangjian@linaro.org>
    Signed-off-by: Shuah Khan <shuahkh@osg.samsung.com>

commit 0223f500aa39a2b6df00af212da736232705be3e
Author: Fabian Frederick <fabf@skynet.be>
Date:   Fri Dec 9 19:13:26 2016 +0100

    ASoC: samsung: add GPIOLIB dependency
    
    Both SND_SOC_SMARTQ and SND_SOC_SAMSUNG_TM2_WM5110
    use gpio/consumer.h
    This patch adds GPIOLIB || COMPILE_TEST to Kconfig entries
    to fix runtime dependency.
    
    See commit 638f958baeaf
    ("extcon: Allow compile test of GPIO consumers if !GPIOLIB")
    
    for similar problem and explanations.
    
    Reviewed-by: Krzysztof Kozlowski <krzk@kernel.org>
    Reported-by: Krzysztof Kozlowski <krzk@kernel.org>
    Signed-off-by: Fabian Frederick <fabf@skynet.be>
    Signed-off-by: Mark Brown <broonie@kernel.org>

commit 29c8d9eba550c6d73d17cc1618a9f5f2a7345aa1
Author: Adit Ranadive <aditr@vmware.com>
Date:   Sun Oct 2 19:10:22 2016 -0700

    IB: Add vmw_pvrdma driver
    
    This patch series adds a driver for a paravirtual RDMA device. The
    device is developed for VMware's Virtual Machines and allows existing RDMA
    applications to continue to use existing Verbs API when deployed in VMs
    on ESXi. We recently did a presentation in the OFA Workshop [1] regarding
    this device.
    
    Description and RDMA Support
    ============================
    The virtual device is exposed as a dual function PCIe device. One part
    is a virtual network device (VMXNet3) which provides networking properties
    like MAC, IP addresses to the RDMA part of the device. The networking
    properties are used to register GIDs required by RDMA applications to
    communicate.
    
    These patches add support and the all required infrastructure for
    letting applications use such a device. We support the mandatory Verbs API as
    well as the base memory management extensions (Local Inv, Send with Inv and
    Fast Register Work Requests). We currently support both Reliable Connected
    and Unreliable Datagram QPs but do not support Shared Receive Queues
    (SRQs).
    
    Also, we support the following types of Work Requests:
     o Send/Receive (with or without Immediate Data)
     o RDMA Write (with or without Immediate Data)
     o RDMA Read
     o Local Invalidate
     o Send with Invalidate
     o Fast Register Work Requests
    
    This version only adds support for version 1 of RoCE. We will add RoCEv2
    support in a future patch. We do support registration of both MAC-based
    and IP-based GIDs. I have also created a git tree for our user-level driver
    [2].
    
    Testing
    =======
    We have tested this internally for various types of Guest OS - Red Hat,
    Centos, Ubuntu 12.04/14.04/16.04, Oracle Enterprise Linux, SLES 12
    using backported versions of this driver. The tests included several
    runs of the performance tests (included with OFED), Intel MPI PingPong
    benchmark on OpenMPI, krping for FRWRs. Mellanox has been kind enough
    to test the backported version of the driver internally on their hardware
    using a VMware provided ESX build. I have also applied and tested this
    with Doug's k.o/for-4.9 branch (commit 5603910b). Note, that this patch
    series should be applied all together. I split out the commits so that
    it may be easier to review.
    
    PVRDMA Resources
    ================
    [1] OFA Workshop Presentation -
    https://openfabrics.org/images/eventpresos/2016presentations/102parardma.pdf
    
    [2] Libpvrdma User-level library -
    http://git.openfabrics.org/?p=~aditr/libpvrdma.git;a=summary
    
    Reviewed-by: Jorgen Hansen <jhansen@vmware.com>
    Reviewed-by: George Zhang <georgezhang@vmware.com>
    Reviewed-by: Aditya Sarwade <asarwade@vmware.com>
    Reviewed-by: Bryan Tan <bryantan@vmware.com>
    Reviewed-by: Leon Romanovsky <leonro@mellanox.com>
    Signed-off-by: Adit Ranadive <aditr@vmware.com>
    Signed-off-by: Doug Ledford <dledford@redhat.com>

commit b78b499a67c3f77aeb6cd0b54724bc38b141255d
Merge: 098c30557a9a 190cc65e912d
Author: Linus Torvalds <torvalds@linux-foundation.org>
Date:   Tue Dec 13 12:11:01 2016 -0800

    Merge tag 'char-misc-4.10-rc1' of git://git.kernel.org/pub/scm/linux/kernel/git/gregkh/char-misc
    
    Pull char/misc driver updates from Greg KH:
     "Here's the big char/misc driver patches for 4.10-rc1. Lots of tiny
      changes over lots of "minor" driver subsystems, the largest being some
      new FPGA drivers. Other than that, a few other new drivers, but no new
      driver subsystems added for this kernel cycle, a nice change.
    
      All of these have been in linux-next with no reported issues"
    
    * tag 'char-misc-4.10-rc1' of git://git.kernel.org/pub/scm/linux/kernel/git/gregkh/char-misc: (107 commits)
      uio-hv-generic: store physical addresses instead of virtual
      Tools: hv: kvp: configurable external scripts path
      uio-hv-generic: new userspace i/o driver for VMBus
      vmbus: add support for dynamic device id's
      hv: change clockevents unbind tactics
      hv: acquire vmbus_connection.channel_mutex in vmbus_free_channels()
      hyperv: Fix spelling of HV_UNKOWN
      mei: bus: enable non-blocking RX
      mei: fix the back to back interrupt handling
      mei: synchronize irq before initiating a reset.
      VME: Remove shutdown entry from vme_driver
      auxdisplay: ht16k33: select framebuffer helper modules
      MAINTAINERS: add git url for fpga
      fpga: Clarify how write_init works streaming modes
      fpga zynq: Fix incorrect ISR state on bootup
      fpga zynq: Remove priv->dev
      fpga zynq: Add missing \n to messages
      fpga: Add COMPILE_TEST to all drivers
      uio: pruss: add clk_disable()
      char/pcmcia: add some error checking in scr24x_read()
      ...

commit 961288108e26e5024801c75d0e7c8e9a2de2b02b
Merge: edc57ea92cb8 5c8a934349ee
Author: Linus Torvalds <torvalds@linux-foundation.org>
Date:   Tue Dec 13 08:52:45 2016 -0800

    Merge tag 'rpmsg-v4.10' of git://github.com/andersson/remoteproc
    
    Pull rpmsg updates from Bjorn Andersson:
     "Argument validation in public functions, function stubs for
      COMPILE_TEST-ing clients, preparation for exposing rpmsg endponts
      to user space and minor Qualcomm SMD fixes"
    
    * tag 'rpmsg-v4.10' of git://github.com/andersson/remoteproc:
      dt-binding: soc: qcom: smd: Add label property
      rpmsg: qcom_smd: Correct return value for O_NONBLOCK
      rpmsg: Provide function stubs for API
      rpmsg: Handle invalid parameters in public API
      rpmsg: Support drivers without primary endpoint
      rpmsg: Introduce a driver override mechanism
      rpmsg: smd: Reduce restrictions when finding channel

commit 44b83b32e7c8d6fcd6a7e877ce3db65f6afdf87c
Merge: a1d9190d9682 0722bdd2962a
Author: Bjorn Helgaas <bhelgaas@google.com>
Date:   Mon Dec 12 11:25:11 2016 -0600

    Merge branch 'pci/host-rockchip' into next
    
    * pci/host-rockchip:
      PCI: rockchip: Move the deassert of pm/aclk/pclk after phy_init()
      PCI: rockchip: Split out rockchip_cfg_atu()
      PCI: rockchip: Clean up bit definitions for PCIE_RC_CONFIG_LCS
      PCI: rockchip: Correct the use of FTS mask
      PCI: rockchip: Remove the pointer to L1 substate cap
      PCI: rockchip: Specify the link capability
      PCI: rockchip: Fix negotiated lanes calculation
      PCI: rockchip: Add Kconfig COMPILE_TEST
      PCI: rockchip: Mark RC as common clock architecture
      PCI: rockchip: Provide captured slot power limit and scale
      PCI: rockchip: Add three new resets as required properties
      PCI: Don't attempt to claim shadow copies of ROM
      PCI: designware: Check for iATU unroll support after initializing host
      PCI: qcom: Fix pp->dev usage before assignment
      PCI: designware-plat: Update author email address
      PCI: layerscape: Fix drvdata usage before assignment
      PCI: designware-plat: Change maintainer to Jose Abreu

commit 18fb7a8fb3d55275fc17f4ff5c7e34dd2b6d74e5
Author: Andrey Ryabinin <aryabinin@virtuozzo.com>
Date:   Thu Nov 24 13:23:10 2016 +0000

    mpi: Fix NULL ptr dereference in mpi_powm() [ver #3]
    
    commit f5527fffff3f002b0a6b376163613b82f69de073 upstream.
    
    This fixes CVE-2016-8650.
    
    If mpi_powm() is given a zero exponent, it wants to immediately return
    either 1 or 0, depending on the modulus.  However, if the result was
    initalised with zero limb space, no limbs space is allocated and a
    NULL-pointer exception ensues.
    
    Fix this by allocating a minimal amount of limb space for the result when
    the 0-exponent case when the result is 1 and not touching the limb space
    when the result is 0.
    
    This affects the use of RSA keys and X.509 certificates that carry them.
    
    BUG: unable to handle kernel NULL pointer dereference at           (null)
    IP: [<ffffffff8138ce5d>] mpi_powm+0x32/0x7e6
    PGD 0
    Oops: 0002 [#1] SMP
    Modules linked in:
    CPU: 3 PID: 3014 Comm: keyctl Not tainted 4.9.0-rc6-fscache+ #278
    Hardware name: ASUS All Series/H97-PLUS, BIOS 2306 10/09/2014
    task: ffff8804011944c0 task.stack: ffff880401294000
    RIP: 0010:[<ffffffff8138ce5d>]  [<ffffffff8138ce5d>] mpi_powm+0x32/0x7e6
    RSP: 0018:ffff880401297ad8  EFLAGS: 00010212
    RAX: 0000000000000000 RBX: ffff88040868bec0 RCX: ffff88040868bba0
    RDX: ffff88040868b260 RSI: ffff88040868bec0 RDI: ffff88040868bee0
    RBP: ffff880401297ba8 R08: 0000000000000000 R09: 0000000000000000
    R10: 0000000000000047 R11: ffffffff8183b210 R12: 0000000000000000
    R13: ffff8804087c7600 R14: 000000000000001f R15: ffff880401297c50
    FS:  00007f7a7918c700(0000) GS:ffff88041fb80000(0000) knlGS:0000000000000000
    CS:  0010 DS: 0000 ES: 0000 CR0: 0000000080050033
    CR2: 0000000000000000 CR3: 0000000401250000 CR4: 00000000001406e0
    Stack:
     ffff88040868bec0 0000000000000020 ffff880401297b00 ffffffff81376cd4
     0000000000000100 ffff880401297b10 ffffffff81376d12 ffff880401297b30
     ffffffff81376f37 0000000000000100 0000000000000000 ffff880401297ba8
    Call Trace:
     [<ffffffff81376cd4>] ? __sg_page_iter_next+0x43/0x66
     [<ffffffff81376d12>] ? sg_miter_get_next_page+0x1b/0x5d
     [<ffffffff81376f37>] ? sg_miter_next+0x17/0xbd
     [<ffffffff8138ba3a>] ? mpi_read_raw_from_sgl+0xf2/0x146
     [<ffffffff8132a95c>] rsa_verify+0x9d/0xee
     [<ffffffff8132acca>] ? pkcs1pad_sg_set_buf+0x2e/0xbb
     [<ffffffff8132af40>] pkcs1pad_verify+0xc0/0xe1
     [<ffffffff8133cb5e>] public_key_verify_signature+0x1b0/0x228
     [<ffffffff8133d974>] x509_check_for_self_signed+0xa1/0xc4
     [<ffffffff8133cdde>] x509_cert_parse+0x167/0x1a1
     [<ffffffff8133d609>] x509_key_preparse+0x21/0x1a1
     [<ffffffff8133c3d7>] asymmetric_key_preparse+0x34/0x61
     [<ffffffff812fc9f3>] key_create_or_update+0x145/0x399
     [<ffffffff812fe227>] SyS_add_key+0x154/0x19e
     [<ffffffff81001c2b>] do_syscall_64+0x80/0x191
     [<ffffffff816825e4>] entry_SYSCALL64_slow_path+0x25/0x25
    Code: 56 41 55 41 54 53 48 81 ec a8 00 00 00 44 8b 71 04 8b 42 04 4c 8b 67 18 45 85 f6 89 45 80 0f 84 b4 06 00 00 85 c0 75 2f 41 ff ce <49> c7 04 24 01 00 00 00 b0 01 75 0b 48 8b 41 18 48 83 38 01 0f
    RIP  [<ffffffff8138ce5d>] mpi_powm+0x32/0x7e6
     RSP <ffff880401297ad8>
    CR2: 0000000000000000
    ---[ end trace d82015255d4a5d8d ]---
    
    Basically, this is a backport of a libgcrypt patch:
    
            http://git.gnupg.org/cgi-bin/gitweb.cgi?p=libgcrypt.git;a=patch;h=6e1adb05d290aeeb1c230c763970695f4a538526
    
    Fixes: cdec9cb5167a ("crypto: GnuPG based MPI lib - source files (part 1)")
    Signed-off-by: Andrey Ryabinin <aryabinin@virtuozzo.com>
    Signed-off-by: David Howells <dhowells@redhat.com>
    cc: Dmitry Kasatkin <dmitry.kasatkin@gmail.com>
    cc: linux-ima-devel@lists.sourceforge.net
    Signed-off-by: James Morris <james.l.morris@oracle.com>
    Signed-off-by: Jiri Slaby <jslaby@suse.cz>

commit 0e85663b887aa7c87d64965952fbf436c209fbe4
Author: Arnd Bergmann <arnd@arndb.de>
Date:   Sat Dec 10 11:38:32 2016 +0100

    net: mvneta: select GENERIC_ALLOCATOR
    
    We previously relied on GENERIC_ALLOCATOR to be selected by CONFIG_ARM,
    but now we can compile-test the driver on other architectures that
    don't select it:
    
    drivers/net/built-in.o: In function `mvneta_bm_remove':
    mvneta_bm.c:(.text+0x4ee35): undefined reference to `gen_pool_free'
    
    This adds an explicit select for the part of the driver that has
    the dependency.
    
    Fixes: a0627f776a45 ("net: marvell: Allow drivers to be built with COMPILE_TEST")
    Signed-off-by: Arnd Bergmann <arnd@arndb.de>
    Signed-off-by: David S. Miller <davem@davemloft.net>

commit 1177f76a7e7e52d4be3c78247b30ab73cabf7164
Author: Shawn Lin <shawn.lin@rock-chips.com>
Date:   Wed Dec 7 15:05:59 2016 -0600

    PCI: rockchip: Add Kconfig COMPILE_TEST
    
    Allow selection of the Rockchip driver for compile testing, even if we
    aren't building for ARCH_ROCKCHIP.
    
    [bhelgaas: changelog]
    Signed-off-by: Shawn Lin <shawn.lin@rock-chips.com>
    Signed-off-by: Bjorn Helgaas <bhelgaas@google.com>

commit 2bb148785ed75435eb39529d74e63b5e602ccd61
Author: Yuchung Cheng <ycheng@google.com>
Date:   Sat Dec 3 14:46:22 2016 -0800

    tcp: fix the missing avr32 SOF_TIMESTAMPING_OPT_STATS
    
    The commit of SOF_TIMESTAMPING_OPT_STATS didn't include the
    new header for avr32, causing build to break. The patch fixes it.
    
    Fixes: 1c885808e456 ("tcp: SOF_TIMESTAMPING_OPT_STATS option for SO_TIMESTAMPING")
    Reported-by: Paul Gortmaker <paul.gortmaker@windriver.com>
    Signed-off-by: Yuchung Cheng <ycheng@google.com>
    Signed-off-by: David S. Miller <davem@davemloft.net>

commit 0257b7e20c07e7d1fac3c7e20ef3c01792cef5a3
Author: Andrey Ryabinin <aryabinin@virtuozzo.com>
Date:   Thu Nov 24 13:23:10 2016 +0000

    mpi: Fix NULL ptr dereference in mpi_powm() [ver #3]
    
    commit f5527fffff3f002b0a6b376163613b82f69de073 upstream.
    
    This fixes CVE-2016-8650.
    
    If mpi_powm() is given a zero exponent, it wants to immediately return
    either 1 or 0, depending on the modulus.  However, if the result was
    initalised with zero limb space, no limbs space is allocated and a
    NULL-pointer exception ensues.
    
    Fix this by allocating a minimal amount of limb space for the result when
    the 0-exponent case when the result is 1 and not touching the limb space
    when the result is 0.
    
    This affects the use of RSA keys and X.509 certificates that carry them.
    
    BUG: unable to handle kernel NULL pointer dereference at           (null)
    IP: [<ffffffff8138ce5d>] mpi_powm+0x32/0x7e6
    PGD 0
    Oops: 0002 [#1] SMP
    Modules linked in:
    CPU: 3 PID: 3014 Comm: keyctl Not tainted 4.9.0-rc6-fscache+ #278
    Hardware name: ASUS All Series/H97-PLUS, BIOS 2306 10/09/2014
    task: ffff8804011944c0 task.stack: ffff880401294000
    RIP: 0010:[<ffffffff8138ce5d>]  [<ffffffff8138ce5d>] mpi_powm+0x32/0x7e6
    RSP: 0018:ffff880401297ad8  EFLAGS: 00010212
    RAX: 0000000000000000 RBX: ffff88040868bec0 RCX: ffff88040868bba0
    RDX: ffff88040868b260 RSI: ffff88040868bec0 RDI: ffff88040868bee0
    RBP: ffff880401297ba8 R08: 0000000000000000 R09: 0000000000000000
    R10: 0000000000000047 R11: ffffffff8183b210 R12: 0000000000000000
    R13: ffff8804087c7600 R14: 000000000000001f R15: ffff880401297c50
    FS:  00007f7a7918c700(0000) GS:ffff88041fb80000(0000) knlGS:0000000000000000
    CS:  0010 DS: 0000 ES: 0000 CR0: 0000000080050033
    CR2: 0000000000000000 CR3: 0000000401250000 CR4: 00000000001406e0
    Stack:
     ffff88040868bec0 0000000000000020 ffff880401297b00 ffffffff81376cd4
     0000000000000100 ffff880401297b10 ffffffff81376d12 ffff880401297b30
     ffffffff81376f37 0000000000000100 0000000000000000 ffff880401297ba8
    Call Trace:
     [<ffffffff81376cd4>] ? __sg_page_iter_next+0x43/0x66
     [<ffffffff81376d12>] ? sg_miter_get_next_page+0x1b/0x5d
     [<ffffffff81376f37>] ? sg_miter_next+0x17/0xbd
     [<ffffffff8138ba3a>] ? mpi_read_raw_from_sgl+0xf2/0x146
     [<ffffffff8132a95c>] rsa_verify+0x9d/0xee
     [<ffffffff8132acca>] ? pkcs1pad_sg_set_buf+0x2e/0xbb
     [<ffffffff8132af40>] pkcs1pad_verify+0xc0/0xe1
     [<ffffffff8133cb5e>] public_key_verify_signature+0x1b0/0x228
     [<ffffffff8133d974>] x509_check_for_self_signed+0xa1/0xc4
     [<ffffffff8133cdde>] x509_cert_parse+0x167/0x1a1
     [<ffffffff8133d609>] x509_key_preparse+0x21/0x1a1
     [<ffffffff8133c3d7>] asymmetric_key_preparse+0x34/0x61
     [<ffffffff812fc9f3>] key_create_or_update+0x145/0x399
     [<ffffffff812fe227>] SyS_add_key+0x154/0x19e
     [<ffffffff81001c2b>] do_syscall_64+0x80/0x191
     [<ffffffff816825e4>] entry_SYSCALL64_slow_path+0x25/0x25
    Code: 56 41 55 41 54 53 48 81 ec a8 00 00 00 44 8b 71 04 8b 42 04 4c 8b 67 18 45 85 f6 89 45 80 0f 84 b4 06 00 00 85 c0 75 2f 41 ff ce <49> c7 04 24 01 00 00 00 b0 01 75 0b 48 8b 41 18 48 83 38 01 0f
    RIP  [<ffffffff8138ce5d>] mpi_powm+0x32/0x7e6
     RSP <ffff880401297ad8>
    CR2: 0000000000000000
    ---[ end trace d82015255d4a5d8d ]---
    
    Basically, this is a backport of a libgcrypt patch:
    
            http://git.gnupg.org/cgi-bin/gitweb.cgi?p=libgcrypt.git;a=patch;h=6e1adb05d290aeeb1c230c763970695f4a538526
    
    Fixes: cdec9cb5167a ("crypto: GnuPG based MPI lib - source files (part 1)")
    Signed-off-by: Andrey Ryabinin <aryabinin@virtuozzo.com>
    Signed-off-by: David Howells <dhowells@redhat.com>
    cc: Dmitry Kasatkin <dmitry.kasatkin@gmail.com>
    cc: linux-ima-devel@lists.sourceforge.net
    Signed-off-by: James Morris <james.l.morris@oracle.com>
    Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>

commit 249090830942565fb0ce7c1e018d927a14282ead
Author: Andrey Ryabinin <aryabinin@virtuozzo.com>
Date:   Thu Nov 24 13:23:10 2016 +0000

    mpi: Fix NULL ptr dereference in mpi_powm() [ver #3]
    
    commit f5527fffff3f002b0a6b376163613b82f69de073 upstream.
    
    This fixes CVE-2016-8650.
    
    If mpi_powm() is given a zero exponent, it wants to immediately return
    either 1 or 0, depending on the modulus.  However, if the result was
    initalised with zero limb space, no limbs space is allocated and a
    NULL-pointer exception ensues.
    
    Fix this by allocating a minimal amount of limb space for the result when
    the 0-exponent case when the result is 1 and not touching the limb space
    when the result is 0.
    
    This affects the use of RSA keys and X.509 certificates that carry them.
    
    BUG: unable to handle kernel NULL pointer dereference at           (null)
    IP: [<ffffffff8138ce5d>] mpi_powm+0x32/0x7e6
    PGD 0
    Oops: 0002 [#1] SMP
    Modules linked in:
    CPU: 3 PID: 3014 Comm: keyctl Not tainted 4.9.0-rc6-fscache+ #278
    Hardware name: ASUS All Series/H97-PLUS, BIOS 2306 10/09/2014
    task: ffff8804011944c0 task.stack: ffff880401294000
    RIP: 0010:[<ffffffff8138ce5d>]  [<ffffffff8138ce5d>] mpi_powm+0x32/0x7e6
    RSP: 0018:ffff880401297ad8  EFLAGS: 00010212
    RAX: 0000000000000000 RBX: ffff88040868bec0 RCX: ffff88040868bba0
    RDX: ffff88040868b260 RSI: ffff88040868bec0 RDI: ffff88040868bee0
    RBP: ffff880401297ba8 R08: 0000000000000000 R09: 0000000000000000
    R10: 0000000000000047 R11: ffffffff8183b210 R12: 0000000000000000
    R13: ffff8804087c7600 R14: 000000000000001f R15: ffff880401297c50
    FS:  00007f7a7918c700(0000) GS:ffff88041fb80000(0000) knlGS:0000000000000000
    CS:  0010 DS: 0000 ES: 0000 CR0: 0000000080050033
    CR2: 0000000000000000 CR3: 0000000401250000 CR4: 00000000001406e0
    Stack:
     ffff88040868bec0 0000000000000020 ffff880401297b00 ffffffff81376cd4
     0000000000000100 ffff880401297b10 ffffffff81376d12 ffff880401297b30
     ffffffff81376f37 0000000000000100 0000000000000000 ffff880401297ba8
    Call Trace:
     [<ffffffff81376cd4>] ? __sg_page_iter_next+0x43/0x66
     [<ffffffff81376d12>] ? sg_miter_get_next_page+0x1b/0x5d
     [<ffffffff81376f37>] ? sg_miter_next+0x17/0xbd
     [<ffffffff8138ba3a>] ? mpi_read_raw_from_sgl+0xf2/0x146
     [<ffffffff8132a95c>] rsa_verify+0x9d/0xee
     [<ffffffff8132acca>] ? pkcs1pad_sg_set_buf+0x2e/0xbb
     [<ffffffff8132af40>] pkcs1pad_verify+0xc0/0xe1
     [<ffffffff8133cb5e>] public_key_verify_signature+0x1b0/0x228
     [<ffffffff8133d974>] x509_check_for_self_signed+0xa1/0xc4
     [<ffffffff8133cdde>] x509_cert_parse+0x167/0x1a1
     [<ffffffff8133d609>] x509_key_preparse+0x21/0x1a1
     [<ffffffff8133c3d7>] asymmetric_key_preparse+0x34/0x61
     [<ffffffff812fc9f3>] key_create_or_update+0x145/0x399
     [<ffffffff812fe227>] SyS_add_key+0x154/0x19e
     [<ffffffff81001c2b>] do_syscall_64+0x80/0x191
     [<ffffffff816825e4>] entry_SYSCALL64_slow_path+0x25/0x25
    Code: 56 41 55 41 54 53 48 81 ec a8 00 00 00 44 8b 71 04 8b 42 04 4c 8b 67 18 45 85 f6 89 45 80 0f 84 b4 06 00 00 85 c0 75 2f 41 ff ce <49> c7 04 24 01 00 00 00 b0 01 75 0b 48 8b 41 18 48 83 38 01 0f
    RIP  [<ffffffff8138ce5d>] mpi_powm+0x32/0x7e6
     RSP <ffff880401297ad8>
    CR2: 0000000000000000
    ---[ end trace d82015255d4a5d8d ]---
    
    Basically, this is a backport of a libgcrypt patch:
    
            http://git.gnupg.org/cgi-bin/gitweb.cgi?p=libgcrypt.git;a=patch;h=6e1adb05d290aeeb1c230c763970695f4a538526
    
    Fixes: cdec9cb5167a ("crypto: GnuPG based MPI lib - source files (part 1)")
    Signed-off-by: Andrey Ryabinin <aryabinin@virtuozzo.com>
    Signed-off-by: David Howells <dhowells@redhat.com>
    cc: Dmitry Kasatkin <dmitry.kasatkin@gmail.com>
    cc: linux-ima-devel@lists.sourceforge.net
    Signed-off-by: James Morris <james.l.morris@oracle.com>
    Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>

commit e073462966b26977b26937c5fc93b4fb24f04fef
Merge: 31114fa95bdb e499807737b7
Author: Greg Kroah-Hartman <gregkh@linuxfoundation.org>
Date:   Thu Dec 1 21:05:53 2016 +0100

    Merge tag 'fpga-for-greg-20161129' of git://git.kernel.org/pub/scm/linux/kernel/git/atull/linux-fpga into char-misc-next
    
    Alan writes:
    
    fpga: Updates for 4.10
    
    These are:
     * Add git url to MAINTAINERS
     * Allow write_init to specify how much buffer it needs
     * Fixes for ISR state in zynq fpga manager driver
     * Other small fixes for zynq
     * Add Altera SoCFPGA drivers for COMPILE_TEST

commit 6d5274eba48539bf4fcea3fa85d8789e4a6b3425
Merge: a090994980a1 1c885808e456
Author: David S. Miller <davem@davemloft.net>
Date:   Wed Nov 30 10:04:32 2016 -0500

    Merge branch 'tcp-sender-chronographs'
    
    Yuchung Cheng says:
    
    ====================
    tcp: sender chronographs instrumentation
    
    This patch set provides instrumentation on TCP sender limitations.
    While developing the BBR congestion control, we noticed that TCP
    sending process is often limited by factors unrelated to congestion
    control: insufficient sender buffer and/or insufficient receive
    window/buffer to saturate the network bandwidth. Unfortunately these
    limits are not visible to the users and often the poor performance
    is attributed to the congestion control of choice.
    
    Thie patch aims to help users get the high level understanding of
    where sending process is limited by, similar to the TCP_INFO design.
    It is not to replace detailed kernel tracing and instrumentation
    facilities.
    
    In addition this patch set provide a new option to the timestamping
    work to instrument these limits on application data unit. For exampe,
    one can use SO_TIMESTAMPING and this patch set to measure the how
    long a particular HTTP response is limited by small receive window.
    
    Patch set was initially written by Francis Yan then polished
    by Yuchung Cheng, with lots of help from Eric Dumazet and Soheil
    Hassas Yeganeh.
    ====================
    
    Acked-by: Eric Dumazet <edumazet@google.com>
    Signed-off-by: David S. Miller <davem@davemloft.net>

commit 1c885808e45601b2b6f68b30ac1d999e10b6f606
Author: Francis Yan <francisyyan@gmail.com>
Date:   Sun Nov 27 23:07:18 2016 -0800

    tcp: SOF_TIMESTAMPING_OPT_STATS option for SO_TIMESTAMPING
    
    This patch exports the sender chronograph stats via the socket
    SO_TIMESTAMPING channel. Currently we can instrument how long a
    particular application unit of data was queued in TCP by tracking
    SOF_TIMESTAMPING_TX_SOFTWARE and SOF_TIMESTAMPING_TX_SCHED. Having
    these sender chronograph stats exported simultaneously along with
    these timestamps allow further breaking down the various sender
    limitation.  For example, a video server can tell if a particular
    chunk of video on a connection takes a long time to deliver because
    TCP was experiencing small receive window. It is not possible to
    tell before this patch without packet traces.
    
    To prepare these stats, the user needs to set
    SOF_TIMESTAMPING_OPT_STATS and SOF_TIMESTAMPING_OPT_TSONLY flags
    while requesting other SOF_TIMESTAMPING TX timestamps. When the
    timestamps are available in the error queue, the stats are returned
    in a separate control message of type SCM_TIMESTAMPING_OPT_STATS,
    in a list of TLVs (struct nlattr) of types: TCP_NLA_BUSY_TIME,
    TCP_NLA_RWND_LIMITED, TCP_NLA_SNDBUF_LIMITED. Unit is microsecond.
    
    Signed-off-by: Francis Yan <francisyyan@gmail.com>
    Signed-off-by: Yuchung Cheng <ycheng@google.com>
    Signed-off-by: Soheil Hassas Yeganeh <soheil@google.com>
    Acked-by: Neal Cardwell <ncardwell@google.com>
    Signed-off-by: David S. Miller <davem@davemloft.net>

commit a0e1b618585979bf2520a6a6e954a3bb56cd610b
Author: Jason Gunthorpe <jgunthorpe@obsidianresearch.com>
Date:   Mon Nov 21 22:26:42 2016 +0000

    fpga: Add COMPILE_TEST to all drivers
    
    Like Zynq the Altera drivers compile fine on x86 and others too,
    so make it easier to compile test this stuff.
    
    A10 requires REGMAP_MMIO to compile, so be explicit rather than
    relying on it via ARCH_SOCFPGA.
    
    Signed-off-by: Jason Gunthorpe <jgunthorpe@obsidianresearch.com>
    Acked-by: Alan Tull <atull@opensource.altera.com>

commit e8ae79d6746649cf1d007831d47c042003a46951
Author: Lee Jones <lee.jones@linaro.org>
Date:   Wed Oct 26 17:07:35 2016 +0100

    mfd: sun4i-gpadc: Fix 'cast from pointer to integer of different size' warning
    
    When building for X86 using COMPILE_TEST we get this warning:
    
    ../drivers/mfd/sun4i-gpadc.c: In function sun4i_gpadc_probe:
    ../drivers/mfd/sun4i-gpadc.c:110:10: warning: cast from pointer to integer of different size [-Wpointer-to-int-cast]
    
    Since an integer and a pointer are difference sizes on 64bit architectures.
    
    Convert to case to a long instead.
    
    Signed-off-by: Lee Jones <lee.jones@linaro.org>

commit 108fbd619869e44f7b70c97e30b5a5d0114791af
Author: Javier Martinez Canillas <javier@osg.samsung.com>
Date:   Fri Oct 14 09:57:32 2016 -0300

    mfd: abx500-core: Allow driver to built if COMPILE_TEST is enabled
    
    The driver only has runtime but no build time dependency with ARCH_U300 ||
    ARCH_U8500 So it can be built for testing purposes if COMPILE_TEST option
    is enabled.
    
    This is useful to have more build coverage and make sure that the driver
    is not affected by changes that could cause build regressions.
    
    Signed-off-by: Javier Martinez Canillas <javier@osg.samsung.com>
    Signed-off-by: Lee Jones <lee.jones@linaro.org>

commit f5527fffff3f002b0a6b376163613b82f69de073
Author: Andrey Ryabinin <aryabinin@virtuozzo.com>
Date:   Thu Nov 24 13:23:10 2016 +0000

    mpi: Fix NULL ptr dereference in mpi_powm() [ver #3]
    
    This fixes CVE-2016-8650.
    
    If mpi_powm() is given a zero exponent, it wants to immediately return
    either 1 or 0, depending on the modulus.  However, if the result was
    initalised with zero limb space, no limbs space is allocated and a
    NULL-pointer exception ensues.
    
    Fix this by allocating a minimal amount of limb space for the result when
    the 0-exponent case when the result is 1 and not touching the limb space
    when the result is 0.
    
    This affects the use of RSA keys and X.509 certificates that carry them.
    
    BUG: unable to handle kernel NULL pointer dereference at           (null)
    IP: [<ffffffff8138ce5d>] mpi_powm+0x32/0x7e6
    PGD 0
    Oops: 0002 [#1] SMP
    Modules linked in:
    CPU: 3 PID: 3014 Comm: keyctl Not tainted 4.9.0-rc6-fscache+ #278
    Hardware name: ASUS All Series/H97-PLUS, BIOS 2306 10/09/2014
    task: ffff8804011944c0 task.stack: ffff880401294000
    RIP: 0010:[<ffffffff8138ce5d>]  [<ffffffff8138ce5d>] mpi_powm+0x32/0x7e6
    RSP: 0018:ffff880401297ad8  EFLAGS: 00010212
    RAX: 0000000000000000 RBX: ffff88040868bec0 RCX: ffff88040868bba0
    RDX: ffff88040868b260 RSI: ffff88040868bec0 RDI: ffff88040868bee0
    RBP: ffff880401297ba8 R08: 0000000000000000 R09: 0000000000000000
    R10: 0000000000000047 R11: ffffffff8183b210 R12: 0000000000000000
    R13: ffff8804087c7600 R14: 000000000000001f R15: ffff880401297c50
    FS:  00007f7a7918c700(0000) GS:ffff88041fb80000(0000) knlGS:0000000000000000
    CS:  0010 DS: 0000 ES: 0000 CR0: 0000000080050033
    CR2: 0000000000000000 CR3: 0000000401250000 CR4: 00000000001406e0
    Stack:
     ffff88040868bec0 0000000000000020 ffff880401297b00 ffffffff81376cd4
     0000000000000100 ffff880401297b10 ffffffff81376d12 ffff880401297b30
     ffffffff81376f37 0000000000000100 0000000000000000 ffff880401297ba8
    Call Trace:
     [<ffffffff81376cd4>] ? __sg_page_iter_next+0x43/0x66
     [<ffffffff81376d12>] ? sg_miter_get_next_page+0x1b/0x5d
     [<ffffffff81376f37>] ? sg_miter_next+0x17/0xbd
     [<ffffffff8138ba3a>] ? mpi_read_raw_from_sgl+0xf2/0x146
     [<ffffffff8132a95c>] rsa_verify+0x9d/0xee
     [<ffffffff8132acca>] ? pkcs1pad_sg_set_buf+0x2e/0xbb
     [<ffffffff8132af40>] pkcs1pad_verify+0xc0/0xe1
     [<ffffffff8133cb5e>] public_key_verify_signature+0x1b0/0x228
     [<ffffffff8133d974>] x509_check_for_self_signed+0xa1/0xc4
     [<ffffffff8133cdde>] x509_cert_parse+0x167/0x1a1
     [<ffffffff8133d609>] x509_key_preparse+0x21/0x1a1
     [<ffffffff8133c3d7>] asymmetric_key_preparse+0x34/0x61
     [<ffffffff812fc9f3>] key_create_or_update+0x145/0x399
     [<ffffffff812fe227>] SyS_add_key+0x154/0x19e
     [<ffffffff81001c2b>] do_syscall_64+0x80/0x191
     [<ffffffff816825e4>] entry_SYSCALL64_slow_path+0x25/0x25
    Code: 56 41 55 41 54 53 48 81 ec a8 00 00 00 44 8b 71 04 8b 42 04 4c 8b 67 18 45 85 f6 89 45 80 0f 84 b4 06 00 00 85 c0 75 2f 41 ff ce <49> c7 04 24 01 00 00 00 b0 01 75 0b 48 8b 41 18 48 83 38 01 0f
    RIP  [<ffffffff8138ce5d>] mpi_powm+0x32/0x7e6
     RSP <ffff880401297ad8>
    CR2: 0000000000000000
    ---[ end trace d82015255d4a5d8d ]---
    
    Basically, this is a backport of a libgcrypt patch:
    
            http://git.gnupg.org/cgi-bin/gitweb.cgi?p=libgcrypt.git;a=patch;h=6e1adb05d290aeeb1c230c763970695f4a538526
    
    Fixes: cdec9cb5167a ("crypto: GnuPG based MPI lib - source files (part 1)")
    Signed-off-by: Andrey Ryabinin <aryabinin@virtuozzo.com>
    Signed-off-by: David Howells <dhowells@redhat.com>
    cc: Dmitry Kasatkin <dmitry.kasatkin@gmail.com>
    cc: linux-ima-devel@lists.sourceforge.net
    cc: stable@vger.kernel.org
    Signed-off-by: James Morris <james.l.morris@oracle.com>

commit b7d79eb4615e3eb5947355f7b4354818cba037f7
Author: Florian Fainelli <f.fainelli@gmail.com>
Date:   Tue Nov 22 09:43:27 2016 -0800

    clk: bcm: Fix unmet Kconfig dependencies for CLK_BCM_63XX
    
    With commit f4e871509959 ("clk: iproc: Make clocks visible options"),
    COMMON_CLK_IPROC gained a dependency on ARCH_BCM_IPROC, yet CLK_BCM_63XX
    also selects that option, this causes the following Kconfig warning:
    
    warning: (CLK_BCM_63XX) selects COMMON_CLK_IPROC which has unmet direct
    dependencies ((ARCH_BCM_IPROC || COMPILE_TEST) && COMMON_CLK)
    
    Fix this by adding proper depends for COMMON_CLK_IPROC
    
    Fixes: f4e871509959 ("clk: iproc: Make clocks visible options")
    Signed-off-by: Florian Fainelli <f.fainelli@gmail.com>
    Reviewed-by: Ray Jui <ray.jui@broadcom.com>
    [sboyd@codeaurora.org: Drop default part as it's redundant]
    Signed-off-by: Stephen Boyd <sboyd@codeaurora.org>

commit 95f5609d223d661419061bd6231da01a317c30d9
Author: Krzysztof Kozlowski <krzk@kernel.org>
Date:   Sun Nov 20 21:24:53 2016 +0200

    ASoC: samsung: Enable COMPILE_TEST for SmartQ and WM8580
    
    The I2S sound drivers for SmartQ board and WM8580 codec can be compile
    tested to increase build coverage.
    
    Signed-off-by: Krzysztof Kozlowski <krzk@kernel.org>
    Signed-off-by: Mark Brown <broonie@kernel.org>

commit a41dcdeee5d87cf3852b857cc3a8507832ec8b42
Author: Krzysztof Kozlowski <krzk@kernel.org>
Date:   Sun Nov 20 21:24:54 2016 +0200

    ASoC: samsung: Enable COMPILE_TEST for entire Samsung ASoc
    
    Instead of build time, Samsung ASoC drivers have rather runtime
    dependency on Exynos or other Samsung platforms.  For building they
    require Common Clock Framework.  If it is provided they could be compile
    tested to increase build coverage.
    
    Signed-off-by: Krzysztof Kozlowski <krzk@kernel.org>
    Signed-off-by: Mark Brown <broonie@kernel.org>

commit 06b37b650cf826349677564cb0ff1560ed8e51fc
Author: Arnd Bergmann <arnd@arndb.de>
Date:   Tue Nov 22 15:21:22 2016 +0100

    marvell: mark mvneta and mvpp2 32-bit only
    
    Both of these drivers won't work on 64-bit architectures unless they
    are redesigned, since they store a virtual address pointer in a 32-bit
    field of the descriptors:
    
    drivers/net/ethernet/marvell/mvneta_bm.c: In function 'mvneta_bm_construct':
    drivers/net/ethernet/marvell/mvneta_bm.c:103:16: error: cast from pointer to integer of different size [-Werror=pointer-to-int-cast]
    drivers/net/ethernet/marvell/mvpp2.c: In function 'mvpp2_prs_vlan_init':
    drivers/net/ethernet/marvell/mvpp2.c:2563:32: error: large integer implicitly truncated to unsigned type [-Werror=overflow]
    
    This limits the COMPILE_TEST option for the two drivers again to
    only build them on 32-bit. This seems nicer than shutting up the
    warnings, in case we ever actually want to use them on 64-bit,
    as the warnings indicate which parts of the driver are currently
    broken there.
    
    Fixes: a0627f776a45 ("net: marvell: Allow drivers to be built with COMPILE_TEST")
    Signed-off-by: Arnd Bergmann <arnd@arndb.de>
    Signed-off-by: David S. Miller <davem@davemloft.net>

commit b15ff9473556d30e47ec4e8516613ba468328d7d
Author: Nicolai Stange <nicstange@gmail.com>
Date:   Thu May 26 13:05:32 2016 +0200

    lib/mpi: mpi_read_raw_data(): fix nbits calculation
    
    commit eef0df6a59537032ab6b708f30b28d9530f8760e upstream.
    
    The number of bits, nbits, is calculated in mpi_read_raw_data() as follows:
    
      nbits = nbytes * 8;
    
    Afterwards, the number of leading zero bits of the first byte get
    subtracted:
    
      nbits -= count_leading_zeros(buffer[0]);
    
    However, count_leading_zeros() takes an unsigned long and thus,
    the u8 gets promoted to an unsigned long.
    
    Thus, the above doesn't subtract the number of leading zeros in the most
    significant nonzero input byte from nbits, but the number of leading
    zeros of the most significant nonzero input byte promoted to unsigned long,
    i.e. BITS_PER_LONG - 8 too many.
    
    Fix this by subtracting
    
      count_leading_zeros(...) - (BITS_PER_LONG - 8)
    
    from nbits only.
    
    Fixes: e1045992949 ("MPILIB: Provide a function to read raw data into an
                         MPI")
    Signed-off-by: Nicolai Stange <nicstange@gmail.com>
    Signed-off-by: Herbert Xu <herbert@gondor.apana.org.au>
    [bwh: Backported to 3.16: adjust context]
    Signed-off-by: Ben Hutchings <ben@decadent.org.uk>

commit 82e527df2843225d45705b8752c606a62afbf29a
Merge: 5a4e4c8f0236 0717b8769bce
Author: David S. Miller <davem@davemloft.net>
Date:   Fri Nov 18 13:54:22 2016 -0500

    Merge branch 'net-marvell-freescale-compile-test'
    
    Florian Fainelli says:
    
    ====================
    net: Enable COMPILE_TEST for Marvell & Freescale drivers
    
    This patch series allows building the Freescale and Marvell Ethernet network
    drivers with COMPILE_TEST.
    
    Changes in v4:
    
    - add proper HAS_DMA to fix build errors on m32r
    - provide an inline stub for mvebu_mbus_get_dram_win_info
    - added an additional patch to fix build errors with mv88e6xxx on m32r
    
    Changes in v3:
    
    - reorder patches to avoid introducing a build warning between commits
    
    Changes in v2:
    
    - rename register define clash when building for i386 (spotted by LKP)
    ====================
    
    Signed-off-by: David S. Miller <davem@davemloft.net>

commit a0627f776a4547039ded2f0a07eaf4f0c704be54
Author: Florian Fainelli <f.fainelli@gmail.com>
Date:   Thu Nov 17 11:19:13 2016 -0800

    net: marvell: Allow drivers to be built with COMPILE_TEST
    
    All Marvell Ethernet drivers actually build fine with COMPILE_TEST with
    a few warnings. We need to add a few HAS_DMA dependencies to fix linking
    failures on problematic architectures like m32r.
    
    Signed-off-by: Florian Fainelli <f.fainelli@gmail.com>
    Signed-off-by: David S. Miller <davem@davemloft.net>

commit 603ab57363a0ba66c77ca4b3027bc0b4505df504
Author: Florian Fainelli <f.fainelli@gmail.com>
Date:   Thu Nov 17 11:19:12 2016 -0800

    bus: mvebu-bus: Provide inline stub for mvebu_mbus_get_dram_win_info
    
    In preparation for allowing CONFIG_MVNETA_BM to build with COMPILE_TEST,
    provide an inline stub for mvebu_mbus_get_dram_win_info().
    
    Signed-off-by: Florian Fainelli <f.fainelli@gmail.com>
    Signed-off-by: David S. Miller <davem@davemloft.net>

commit 0827be21a0c1ffc903cc1f2641ea68b32601e595
Author: Florian Fainelli <f.fainelli@gmail.com>
Date:   Thu Nov 17 11:19:11 2016 -0800

    net: fsl: Allow most drivers to be built with COMPILE_TEST
    
    There are only a handful of Freescale Ethernet drivers that don't
    actually build with COMPILE_TEST:
    
    * FEC, for which we would need to define a default register layout if no
      supported architecture is defined
    
    * UCC_GETH which depends on PowerPC cpm.h header (which could be moved
      to a generic location)
    
    * GIANFAR needs to depend on HAS_DMA to fix linking failures on some
      architectures (like m32r)
    
    We need to fix an unmet dependency to get there though:
    warning: (FSL_XGMAC_MDIO) selects OF_MDIO which has unmet direct
    dependencies (OF && PHYLIB)
    
    which would result in CONFIG_OF_MDIO=[ym] without CONFIG_OF to be set.
    
    Signed-off-by: Florian Fainelli <f.fainelli@gmail.com>
    Signed-off-by: David S. Miller <davem@davemloft.net>

commit 43c9127d94d62a232ed33ed2eab8a08657ce5472
Author: Nicholas Piggin <npiggin@gmail.com>
Date:   Wed Oct 19 14:15:59 2016 +1100

    powerpc: Add option to use thin archives
    
    Add an option to use thin archives to build the kernel.
    Thin archives are explained in commit a5967db9af51 ("kbuild: allow
    architectures to use thin archives instead of ld -r").
    
    This is a gradual way to introduce the option to testers.
    
    Some change to the way we invoke ar is required so it can be used
    by scripts/link-vmlinux.sh.
    
    Signed-off-by: Stephen Rothwell <sfr@canb.auug.org.au>
    Signed-off-by: Nicholas Piggin <npiggin@gmail.com>
    [mpe: Make it an explicit option not dependant on COMPILE_TEST]
    Signed-off-by: Michael Ellerman <mpe@ellerman.id.au>

commit abbdc56b17d662ae710bc0c30cf0d0e9da805fd4
Author: Greg Kroah-Hartman <gregkh@linuxfoundation.org>
Date:   Mon Oct 10 12:05:14 2016 +0200

    staging: vc04_services: add CONFIG_COMPILE_TEST ability
    
    It would be nice to be able to build this code on other platforms other
    than only the RPi, so add some empty macros to allow this to happen, and
    turn off BROKEN as the code can now build properly thanks to Michael's
    work.
    
    Cc: Michael Zoran <mzoran@crowfest.net>
    Cc: Daniel Stone <daniels@collabora.com>
    Cc: "Noralf Trnnes" <noralf@tronnes.org>
    Cc: Pranith Kumar <bobby.prani@gmail.com>
    Cc: popcornmix <popcornmix@gmail.com>
    Cc: Eric Anholt <eric@anholt.net>
    Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>

commit b099b1319d581243402d8dc56b4237d9928d00ca
Author: Javier Martinez Canillas <javier@osg.samsung.com>
Date:   Mon Nov 7 17:46:52 2016 -0300

    spi: s3c64xx: Allow driver to build if COMPILE_TEST is enabled
    
    The driver only has runtime but no build time dependency with PLAT_SAMSUNG
    || ARCH_EXYNOS so it can be built for testing purposes if the COMPILE_TEST
    option is enabled.
    
    This is useful to have more build coverage and make sure that the driver
    is not affected by changes that could cause build regressions.
    
    Signed-off-by: Javier Martinez Canillas <javier@osg.samsung.com>
    Signed-off-by: Mark Brown <broonie@kernel.org>

commit 215e2aa6c024d27cdbe88e2ea88cb59dcab588eb
Author: Kees Cook <keescook@chromium.org>
Date:   Tue Nov 8 16:27:03 2016 -0800

    gcc-plugins: Adjust Kconfig to avoid cyc_complexity
    
    In preparation for removing "depends on !COMPILE_TEST" from GCC_PLUGINS,
    the GCC_PLUGIN_CYC_COMPLEXITY plugin needs to gain the restriction,
    since it is mainly an example, and produces (intended) voluminous stderr
    reporting, which is generally undesirable for allyesconfig-style build
    tests. This additionally puts the plugin behind EXPERT and improves the
    help text.
    
    Signed-off-by: Kees Cook <keescook@chromium.org>

commit d5573584429254a14708cf8375c47092b5edaf2c
Author: Kashyap Desai <kashyap.desai@broadcom.com>
Date:   Fri Oct 21 06:33:35 2016 -0700

    scsi: megaraid_sas: Do not set MPI2_TYPE_CUDA for JBOD FP path for FW which does not support JBOD sequence map
    
    CC: stable@vger.kernel.org
    Signed-off-by: Sumit Saxena <sumit.saxena@broadcom.com>
    Reviewed-by: Hannes Reinecke <hare@suse.com>
    Reviewed-by: Tomas Henzl <thenzl@redhat.com>
    Signed-off-by: Martin K. Petersen <martin.petersen@oracle.com>

commit 81c16f83231a92eca246cb91649c4726899a704d
Author: Suganath Prabu Subramani <suganath-prabu.subramani@broadcom.com>
Date:   Wed Oct 26 13:34:40 2016 +0530

    scsi: mpt3sas: Use the new MPI 2.6 32-bit Atomic Request Descriptors for SAS35 devices.
    
    Support Atomic Request Descriptors for Ventura/SAS35 devices.
    
    Signed-off-by: Chaitra P B <chaitra.basappa@broadcom.com>
    Signed-off-by: Sathya Prakash <sathya.prakash@broadcom.com>
    Signed-off-by: Suganath Prabu S <suganath-prabu.subramani@broadcom.com>
    Reviewed-by: Hannes Reinecke <hare@suse.com>
    Reviewed-by: Tomas Henzl <thenzl@redhat.com>
    Signed-off-by: Martin K. Petersen <martin.petersen@oracle.com>

commit 186a18e51db08d51011fc4bd2aa773e173f632c9
Author: Suganath Prabu Subramani <suganath-prabu.subramani@broadcom.com>
Date:   Wed Oct 26 13:34:39 2016 +0530

    scsi: mpt3sas: set EEDP-escape-flags for SAS35 devices.
    
    An UNMAP command on a PI formatted device will leave the Logical Block
    Application Tag and Logical Block Reference Tag as all F's (for those LBAs
    that are unmapped). To avoid IO errors if those LBAs are subsequently read
    before they are written with valid tag fields, the MPI SCSI IO requests
    need to set the EEDPFlags element EEDP Escape Mode field, Bits [7:6]
    appropriately. A value of 2 should be set to disable all PI checks if the
    Logical Block Application Tag is 0xFFFF for PI types 1 and 2.  A value
    of 3 should be set to disable all PI checks if the Logical Block
    Application Tag is 0xFFFF and the Logical Block Reference Tag is
    0xFFFFFFFF for PI type 3.
    
    Signed-off-by: Chaitra P B <chaitra.basappa@broadcom.com>
    Signed-off-by: Sathya Prakash <sathya.prakash@broadcom.com>
    Signed-off-by: Suganath Prabu S <suganath-prabu.subramani@broadcom.com>
    Reviewed-by: Hannes Reinecke <hare@suse.com>
    Reviewed-by: Tomas Henzl <thenzl@redhat.com>
    Signed-off-by: Martin K. Petersen <martin.petersen@oracle.com>

commit 998f26aedf41bc5cdce3b3c9233ac0e0672fa307
Author: Suganath Prabu Subramani <suganath-prabu.subramani@broadcom.com>
Date:   Wed Oct 26 13:34:37 2016 +0530

    scsi: mpt3sas: Added Device ID's for SAS35 devices and updated MPI header.
    
    Added Device ID's for SAS35 devices (Ventura, Crusader, Harpoon &
    Tomcat) and updated mpi header file for the same. Also added
    "is_gen35_ioc" to MPT3SAS_ADAPTER structure for identifying SAS35 adapters.
    
    Signed-off-by: Chaitra P B <chaitra.basappa@broadcom.com>
    Signed-off-by: Sathya Prakash <sathya.prakash@broadcom.com>
    Signed-off-by: Suganath Prabu S <suganath-prabu.subramani@broadcom.com>
    Reviewed-by: Hannes Reinecke <hare@suse.com>
    Reviewed-by: Tomas Henzl <thenzl@redhat.com>
    Signed-off-by: Martin K. Petersen <martin.petersen@oracle.com>

commit ba1773fb7de92498d3cd51a1cb5a8855b8996912
Author: Felipe Balbi <felipe.balbi@linux.intel.com>
Date:   Fri Sep 30 15:01:45 2016 +0300

    usb: dwc3: Kconfig: allow all glues to build if COMPILE_TEST
    
    We shouldn't have any glue layer which doesn't
    compile everywhere. In order to make sure this is
    always the case, make sure COMPILE_TEST is properly
    added at dependency list of a config entry.
    
    Signed-off-by: Felipe Balbi <felipe.balbi@linux.intel.com>

commit 2674235fd4293e0cc367dde8fcf658d17cadea5c
Merge: 2a290036a1e4 b70e8beb09d3
Author: Linus Torvalds <torvalds@linux-foundation.org>
Date:   Sat Oct 29 12:07:29 2016 -0700

    Merge tag 'armsoc-fixes' of git://git.kernel.org/pub/scm/linux/kernel/git/arm/arm-soc
    
    Pull ARM SoC fixes from Olof Johansson:
     "We haven't seen a whole lot of fixes for the first two weeks since the
      merge window, but here is the batch that we have at the moment.
    
      Nothing sticks out as particularly bad or scary, it's mostly a handful
      of smaller fixes to several platforms. The Uniphier reset controller
      changes could probably have been delayed to 4.10, but they're not
      scary and just plumbing up driver changes that went in during the
      merge window.
    
      We're also adding another maintainer to Marvell Berlin platforms, to
      help out when Sebastian is too busy. Yay teamwork!"
    
    * tag 'armsoc-fixes' of git://git.kernel.org/pub/scm/linux/kernel/git/arm/arm-soc:
      ARM: imx: mach-imx6q: Fix the PHY ID mask for AR8031
      ARM: dts: vf610: fix IRQ flag of global timer
      ARM: imx: gpc: Fix the imx_gpc_genpd_init() error path
      ARM: imx: gpc: Initialize all power domains
      arm64: dts: Updated NAND DT properties for NS2 SVK
      arm64: dts: uniphier: change MIO node to SD control node
      ARM: dts: uniphier: change MIO node to SD control node
      reset: uniphier: rename MIO reset to SD reset for Pro5, PXs2, LD20 SoCs
      arm64: uniphier: select ARCH_HAS_RESET_CONTROLLER
      ARM: uniphier: select ARCH_HAS_RESET_CONTROLLER
      arm64: dts: Add timer erratum property for LS2080A and LS1043A
      arm64: dts: rockchip: remove the abuse of keep-power-in-suspend
      ARM: multi_v7_defconfig: Enable Intel e1000e driver
      MAINTAINERS: add myself as Marvell berlin SoC maintainer
      bus: qcom-ebi2: depend on ARCH_QCOM or COMPILE_TEST
      ARM: dts: fix the SD card on the Snowball
      arm64: dts: rockchip: remove always-on and boot-on from vcc_sd
      arm64: dts: marvell: fix clocksource for CP110 master SPI0
      ARM: mvebu: Select corediv clk for all mvebu v7 SoC

commit e144e5d06d0207c0b1631545fc1821565ee0fe6b
Author: Kuninori Morimoto <kuninori.morimoto.gx@renesas.com>
Date:   Wed Oct 26 04:12:53 2016 +0000

    ASoC: rsnd: enable COMPILE_TEST
    
    Signed-off-by: Kuninori Morimoto <kuninori.morimoto.gx@renesas.com>
    Signed-off-by: Mark Brown <broonie@kernel.org>

commit cdd24f76fe84fd6ee3b46f54b2a475d04d79889d
Author: Paul Gortmaker <paul.gortmaker@windriver.com>
Date:   Mon Jun 13 14:03:38 2016 -0400

    reset: lpc18xx: make it explicitly non-modular
    
    The Kconfig currently controlling compilation of this code is:
    
    drivers/reset/Kconfig:config RESET_LPC18XX
    drivers/reset/Kconfig:  bool "LPC18xx/43xx Reset Driver" if COMPILE_TEST
    drivers/reset/Kconfig:  default ARCH_LPC18XX
    
    or
    
    arch/arm/Kconfig:config ARCH_LPC18XX
    arch/arm/Kconfig:       bool "NXP LPC18xx/LPC43xx"
    
    ...meaning that it currently is not being built as a module by anyone.
    
    Lets remove the modular code that is essentially orphaned, so that
    when reading the driver there is no doubt it is builtin-only.
    
    We explicitly disallow a driver unbind, since that doesn't have a
    sensible use case anyway, and it allows us to drop the ".remove"
    code for non-modular drivers.
    
    Since module_platform_driver() uses the same init level priority as
    builtin_platform_driver() the init ordering remains unchanged with
    this commit.
    
    Also note that MODULE_DEVICE_TABLE is a no-op for non-modular code.
    
    We also delete the MODULE_LICENSE tag etc. since all that information
    is already contained at the top of the file in the comments.
    
    Cc: Joachim Eastwood <manabian@gmail.com>
    Signed-off-by: Paul Gortmaker <paul.gortmaker@windriver.com>
    Signed-off-by: Philipp Zabel <p.zabel@pengutronix.de>

commit fadb03cd46c45e455685c7c9d2517314ca4518cf
Author: Paul Gortmaker <paul.gortmaker@windriver.com>
Date:   Mon Jun 13 14:03:37 2016 -0400

    reset: zynq: make it explicitly non-modular
    
    The Makefile/Kconfig currently controlling compilation of this code is:
    
    drivers/reset/Kconfig:config RESET_ZYNQ
    drivers/reset/Kconfig:  bool "ZYNQ Reset Driver" if COMPILE_TEST
    drivers/reset/Kconfig:  default ARCH_ZYNQ
    
    or
    
    drivers/reset/Makefile:obj-$(CONFIG_ARCH_ZYNQ) += reset-zynq.o
    arch/arm/mach-zynq/Kconfig:config ARCH_ZYNQ
    arch/arm/mach-zynq/Kconfig:     bool "Xilinx Zynq ARM Cortex A9 Platform" if ARCH_MULTI_V7
    
    ...meaning that it currently is not being built as a module by anyone.
    
    Lets remove the few remaining traces of modular macro usage, so that
    when reading the driver there is no doubt it is builtin-only.
    
    Since module_platform_driver() uses the same init level priority as
    builtin_platform_driver() the init ordering remains unchanged with
    this commit.
    
    We also delete the MODULE_LICENSE tag etc. since all that information
    was (or is now) contained at the top of the file in the comments.
    
    Cc: "Sren Brinkmann" <soren.brinkmann@xilinx.com>
    Signed-off-by: Paul Gortmaker <paul.gortmaker@windriver.com>
    Acked-by: Michal Simek <michal.simek@xilinx.com>
    Acked-by: Moritz Fischer <moritz.fischer@ettus.com>
    Signed-off-by: Philipp Zabel <p.zabel@pengutronix.de>

commit c4742ed32b39d1207162d09045ad23cef5139b51
Author: Paul Gortmaker <paul.gortmaker@windriver.com>
Date:   Mon Jun 13 14:03:36 2016 -0400

    reset: sunxi: make it explicitly non-modular
    
    The Kconfig currently controlling compilation of this code is:
    
    drivers/reset/Kconfig:config RESET_SUNXI
    drivers/reset/Kconfig:  bool "Allwinner SoCs Reset Driver" if COMPILE_TEST && !ARCH_SUNXI
    drivers/reset/Kconfig:  default ARCH_SUNXI
    
    or
    
    arch/arm/mach-sunxi/Kconfig:menuconfig ARCH_SUNXI
    arch/arm/mach-sunxi/Kconfig:    bool "Allwinner SoCs" if ARCH_MULTI_V7
    
    ...meaning that it currently is not being built as a module by anyone.
    
    Lets remove the few remaining traces of modular macro usage, so that
    when reading the driver there is no doubt it is builtin-only.
    
    Since module_platform_driver() uses the same init level priority as
    builtin_platform_driver() the init ordering remains unchanged with
    this commit.
    
    Also note that MODULE_DEVICE_TABLE is a no-op for non-modular code.
    
    We also delete the MODULE_LICENSE tag etc. since all that information
    is already contained at the top of the file in the comments.
    
    Cc: Maxime Ripard <maxime.ripard@free-electrons.com>
    Signed-off-by: Paul Gortmaker <paul.gortmaker@windriver.com>
    Signed-off-by: Philipp Zabel <p.zabel@pengutronix.de>

commit 02163199bed1aae49f9ebd2a2172523148c0aaa2
Author: Paul Gortmaker <paul.gortmaker@windriver.com>
Date:   Mon Jun 13 14:03:35 2016 -0400

    reset: socfpga: make it explicitly non-modular
    
    The Kconfig currently controlling compilation of this code is:
    
    drivers/reset/Kconfig:config RESET_SOCFPGA
    drivers/reset/Kconfig:  bool "SoCFPGA Reset Driver" if COMPILE_TEST
    drivers/reset/Kconfig:  default ARCH_SOCFPGA
    
    or
    
    arch/arm/mach-socfpga/Kconfig:menuconfig ARCH_SOCFPGA
    arch/arm/mach-socfpga/Kconfig:  bool "Altera SOCFPGA family" if ARCH_MULTI_V7
    
    ...meaning that it currently is not being built as a module by anyone.
    
    Lets remove the small amount of modular evidence that remains, so that
    when reading the driver there is no doubt it is builtin-only.
    
    Since module_platform_driver() uses the same init level priority as
    builtin_platform_driver() the init ordering remains unchanged with
    this commit.
    
    We also delete the MODULE_LICENSE tag etc. since all that information
    was (or is now) contained at the top of the file in the comments.
    
    Cc: Steffen Trumtrar <s.trumtrar@pengutronix.de>
    Cc: Masahiro Yamada <yamada.masahiro@socionext.com>
    Signed-off-by: Paul Gortmaker <paul.gortmaker@windriver.com>
    Signed-off-by: Philipp Zabel <p.zabel@pengutronix.de>

commit ed4dba99cae80d14afb8ddcc677a2f547dd70162
Author: Paul Gortmaker <paul.gortmaker@windriver.com>
Date:   Mon Jun 13 14:03:34 2016 -0400

    reset: berlin: make it explicitly non-modular
    
    The Kconfig currently controlling compilation of this code is:
    
    drivers/reset/Kconfig:config RESET_BERLIN
    drivers/reset/Kconfig:  bool "Berlin Reset Driver" if COMPILE_TEST
    drivers/reset/Kconfig:  default ARCH_BERLIN
    
    or
    
    arch/arm/mach-berlin/Kconfig:menuconfig ARCH_BERLIN
    arch/arm/mach-berlin/Kconfig:   bool "Marvell Berlin SoCs" if ARCH_MULTI_V7
    
    or
    
    arch/arm64/Kconfig.platforms:config ARCH_BERLIN
    arch/arm64/Kconfig.platforms:   bool "Marvell Berlin SoC Family"
    
    ...meaning that it currently is not being built as a module by anyone.
    
    Lets remove the modular code that is essentially orphaned, so that
    when reading the driver there is no doubt it is builtin-only.
    
    Since module_platform_driver() uses the same init level priority as
    builtin_platform_driver() the init ordering remains unchanged with
    this commit.
    
    Also note that MODULE_DEVICE_TABLE is a no-op for non-modular code.
    
    We also delete the MODULE_LICENSE tag etc. since all that information
    was (or is now) contained at the top of the file in the comments.
    
    Cc: Antoine Tenart <antoine.tenart@free-electrons.com>
    Cc: Sebastian Hesselbarth <sebastian.hesselbarth@gmail.com>
    Signed-off-by: Paul Gortmaker <paul.gortmaker@windriver.com>
    Signed-off-by: Philipp Zabel <p.zabel@pengutronix.de>

commit 5fac7e8405a951f536dfcea09c6f6adb904a08a8
Author: Linus Walleij <linus.walleij@linaro.org>
Date:   Tue Oct 4 13:56:19 2016 +0200

    bus: qcom-ebi2: depend on ARCH_QCOM or COMPILE_TEST
    
    This hides the option for people who do not want their Kconfig
    vision cluttered (i.e. x86) and enables compile testing apart
    from the supported main arch.
    
    Cc: Stephen Boyd <sboyd@codeaurora.org>
    Cc: Arnd Bergmann <arnd@arndb.de>
    Signed-off-by: Linus Walleij <linus.walleij@linaro.org>
    Signed-off-by: Olof Johansson <olof@lixom.net>

commit 8b70f716174d6a46787fcf72f8c569ef3efd9c27
Merge: e5050143d67c 1cd713762e4c
Author: Linus Torvalds <torvalds@linux-foundation.org>
Date:   Fri Oct 14 13:13:44 2016 -0700

    Merge tag 'rtc-4.9' of git://git.kernel.org/pub/scm/linux/kernel/git/abelloni/linux
    
    Pull RTC updates from Alexandre Belloni:
     "RTC for 4.9
    
      Subsystem:
       - delete owner assignment in multiple drivers
       - constify rtc_class_ops structures
    
      Drivers:
       - ac100: support clock-output-names
       - cmos: properly handle ACPI alarms and quirky BIOSes and other fixes
       - ds1307: fix century bit support while staying comaptible with
         previous behaviour by default
       - ds1347: switch to regmap
       - isl12057 is now handled by ds1307
       - omap: support external wakeup
       - rv8803: allow to disable voltage drop detection"
    
    * tag 'rtc-4.9' of git://git.kernel.org/pub/scm/linux/kernel/git/abelloni/linux: (25 commits)
      rtc: rv8803: set VDETOFF and SWOFF via device tree
      dt/bindings: Add bindings for Micro Crystal rv8803
      devicetree: Add Micro Crystal AG vendor id
      rtc: cmos: avoid unused function warning
      rtc: ac100: Add NULL checking for devm_kzalloc call
      rtc: ds1347: changed raw spi calls to register map calls
      rtc: cmos: Restore alarm after resume
      rtc: cmos: Clear ACPI-driven alarms upon resume
      rtc: omap: Support ext_wakeup configuration
      rtc: cmos: Initialize hpet timer before irq is registered
      rtc: asm9260: rework locking
      rtc: asm9260: allow COMPILE_TEST
      rtc: constify rtc_class_ops structures
      rtc: ac100: support clock-output-names in device tree binding
      rtc: rx6110: remove owner assignment
      rtc: pic32: Delete owner assignment
      rtc: bq32k: Fix handling of oscillator failure flag
      rtc: bq32k: Use correct mask name for 'minutes' register.
      rtc: sysfs: fix a cast removing the const attribute
      Documentation: dt: Intersil isl12057 is not a trivial device
      ...

commit 059f01410822b9a37fac0f4da8c2202c2d39e7a5
Author: Javier Martinez Canillas <javier@osg.samsung.com>
Date:   Wed Oct 12 16:05:59 2016 -0300

    net: wan: slic_ds26522: Allow driver to built if COMPILE_TEST is enabled
    
    The driver only has runtime but no build time dependency with FSL_SOC ||
    ARCH_MXC || ARCH_LAYERSCAPE.  So it can be built for testing purposes if
    the COMPILE_TEST option is enabled.
    
    This is useful to have more build coverage and make sure that the driver
    is not affected by changes that could cause build regressions.
    
    Signed-off-by: Javier Martinez Canillas <javier@osg.samsung.com>
    Signed-off-by: David S. Miller <davem@davemloft.net>

commit c84cc7b9064a22aaf73c3a5fc4c073cd4d588c98
Author: Robin Murphy <robin.murphy@arm.com>
Date:   Mon Sep 26 16:50:55 2016 +0100

    ARM: 8616/1: dt: Respect property size when parsing CPUs
    
    commit ba6dea4f7cedb4b1c17e36f4087675d817c2e24b upstream.
    
    Whilst MPIDR values themselves are less than 32 bits, it is still
    perfectly valid for a DT to have #address-cells > 1 in the CPUs node,
    resulting in the "reg" property having leading zero cell(s). In that
    situation, the big-endian nature of the data conspires with the current
    behaviour of only reading the first cell to cause the kernel to think
    all CPUs have ID 0, and become resoundingly unhappy as a consequence.
    
    Take the full property length into account when parsing CPUs so as to
    be correct under any circumstances.
    
    Cc: Russell King <linux@armlinux.org.uk>
    Signed-off-by: Robin Murphy <robin.murphy@arm.com>
    Signed-off-by: Russell King <rmk+kernel@arm.linux.org.uk>
    Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>

commit fd327b36443b37301a5632a341a17ae622b5618e
Author: Robin Murphy <robin.murphy@arm.com>
Date:   Mon Sep 26 16:50:55 2016 +0100

    ARM: 8616/1: dt: Respect property size when parsing CPUs
    
    commit ba6dea4f7cedb4b1c17e36f4087675d817c2e24b upstream.
    
    Whilst MPIDR values themselves are less than 32 bits, it is still
    perfectly valid for a DT to have #address-cells > 1 in the CPUs node,
    resulting in the "reg" property having leading zero cell(s). In that
    situation, the big-endian nature of the data conspires with the current
    behaviour of only reading the first cell to cause the kernel to think
    all CPUs have ID 0, and become resoundingly unhappy as a consequence.
    
    Take the full property length into account when parsing CPUs so as to
    be correct under any circumstances.
    
    Cc: Russell King <linux@armlinux.org.uk>
    Signed-off-by: Robin Murphy <robin.murphy@arm.com>
    Signed-off-by: Russell King <rmk+kernel@arm.linux.org.uk>
    Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>

commit b9e0d1cebcac8aeba3fb8608db6e9ee772ed32a6
Author: Robin Murphy <robin.murphy@arm.com>
Date:   Mon Sep 26 16:50:55 2016 +0100

    ARM: 8616/1: dt: Respect property size when parsing CPUs
    
    commit ba6dea4f7cedb4b1c17e36f4087675d817c2e24b upstream.
    
    Whilst MPIDR values themselves are less than 32 bits, it is still
    perfectly valid for a DT to have #address-cells > 1 in the CPUs node,
    resulting in the "reg" property having leading zero cell(s). In that
    situation, the big-endian nature of the data conspires with the current
    behaviour of only reading the first cell to cause the kernel to think
    all CPUs have ID 0, and become resoundingly unhappy as a consequence.
    
    Take the full property length into account when parsing CPUs so as to
    be correct under any circumstances.
    
    Cc: Russell King <linux@armlinux.org.uk>
    Signed-off-by: Robin Murphy <robin.murphy@arm.com>
    Signed-off-by: Russell King <rmk+kernel@arm.linux.org.uk>
    Signed-off-by: Jiri Slaby <jslaby@suse.cz>

commit 553911c67eb701d46e2dcd073f603c6f6546c38b
Merge: 521f3970853a c84750906b48
Author: Linus Torvalds <torvalds@linux-foundation.org>
Date:   Thu Oct 6 17:13:54 2016 -0700

    Merge tag 'dmaengine-4.9-rc1' of git://git.infradead.org/users/vkoul/slave-dma
    
    Pull dmaengine updates from Vinod Koul:
     "This is bit large pile of code which bring in some nice additions:
    
       - Error reporting: we have added a new mechanism for users of
         dmaenegine to register a callback_result which tells them the
         result of the dma transaction. Right now only one user (ntb) is
         using it.
    
       - As we discussed on KS mailing list and pointed out NO_IRQ has no
         place in kernel, this also remove NO_IRQ from dmaengine subsystem
         (both arm and ppc users)
    
       - Support for IOMMU slave transfers and its implementation for arm.
    
       - To get better build coverage, enable COMPILE_TEST for bunch of
         driver, and fix the warning and sparse complaints on these.
    
       - Apart from above, usual updates spread across drivers"
    
    * tag 'dmaengine-4.9-rc1' of git://git.infradead.org/users/vkoul/slave-dma: (169 commits)
      async_pq_val: fix DMA memory leak
      dmaengine: virt-dma: move function declarations
      dmaengine: omap-dma: Enable burst and data pack for SG
      DT: dmaengine: rcar-dmac: document R8A7743/5 support
      dmaengine: fsldma: Unmap region obtained by of_iomap
      dmaengine: jz4780: fix resource leaks on error exit return
      dma-debug: fix ia64 build, use PHYS_PFN
      dmaengine: coh901318: fix integer overflow when shifting more than 32 places
      dmaengine: edma: avoid uninitialized variable use
      dma-mapping: fix m32r build warning
      dma-mapping: fix ia64 build, use PHYS_PFN
      dmaengine: ti-dma-crossbar: enable COMPILE_TEST
      dmaengine: omap-dma: enable COMPILE_TEST
      dmaengine: edma: enable COMPILE_TEST
      dmaengine: ti-dma-crossbar: Fix of_device_id data parameter usage
      dmaengine: ti-dma-crossbar: Correct type for of_find_property() third parameter
      dmaengine/ARM: omap-dma: Fix the DMAengine compile test on non OMAP configs
      dmaengine: edma: Rename set_bits and remove unused clear_bits helper
      dmaengine: edma: Use correct type for of_find_property() third parameter
      dmaengine: edma: Fix of_device_id data parameter usage (legacy vs TPCC)
      ...

commit 72ec94560d7ee1d3a61d5904fd9a5bf68bf3b11a
Merge: 7af8a0f80888 993eb0aeae0f
Author: Linus Torvalds <torvalds@linux-foundation.org>
Date:   Mon Oct 3 09:33:40 2016 -0700

    Merge tag 'pm-4.9-rc1' of git://git.kernel.org/pub/scm/linux/kernel/git/rafael/linux-pm
    
    Pull power management updates from Rafael Wysocki:
     "Traditionally, cpufreq is the area with the greatest number of
      changes, but there are fewer of them than last time. There also is
      some activity in the generic power domains and the devfreq frameworks,
      a couple of system suspend and hibernation fixes and some assorted
      changes in other places.
    
      One new feature is the cpufreq change to allow the scheduler to pass
      hints to the governors' utilization update callbacks and some code
      rework based on that. Another one is the support for domain removal in
      the generic power domains framework. Also it is now possible to use
      hibernation with PAGE_POISONING_ZERO enabled and devfreq supports the
      RockChip DFI controller and the rk3399 DMC.
    
      The rest of the changes is mostly fixes and cleanups in a number of
      places.
    
      Specifics:
    
       - Add a mechanism for passing hints from the scheduler to cpufreq
         governors via their utilization update callbacks and use it to
         introduce "IOwait boosting" into the schedutil governor and
         intel_pstate that will make them boost performance if the enqueued
         task was previously waiting on I/O (Rafael Wysocki).
    
       - Fix a schedutil governor problem that causes it to overestimate
         utilization if SMT is in use (Steve Muckle).
    
       - Update defconfigs trying to use the schedutil governor as a module
         which is not possible any more (Javier Martinez Canillas).
    
       - Update the intel_pstate's pstate_sample tracepoint to take "IOwait
         boosting" into account (Srinivas Pandruvada).
    
       - Fix a problem in the cpufreq core causing it to mishandle the
         initialization of CPUs registered after the cpufreq driver (Viresh
         Kumar, Rafael Wysocki).
    
       - Make the cpufreq-dt driver support per-policy governor tunables,
         clean it up and update its Kconfig description (Viresh Kumar).
    
       - Add support for more ARM platforms to the cpufreq-dt driver
         (Chanwoo Choi, Dave Gerlach, Geert Uytterhoeven).
    
       - Make the cpufreq CPPC driver report frequencies in KHz to avoid
         user space compatiblility issues (Al Stone, Hoan Tran).
    
       - Clean up a few cpufreq drivers (st, kirkwood, SCPI) a bit (Colin
         Ian King, Markus Elfring).
    
       - Constify some local structures in the intel_pstate driver (Julia
         Lawall).
    
       - Add a Documentation/cpu-freq/ entry to MAINTAINERS (Jean Delvare).
    
       - Add support for PM domain removal to the generic power domains
         (genpd) framework, add new DT helper functions to it and make it
         always enable debugfs support if available (Jon Hunter, Tomeu
         Vizoso).
    
       - Clean up the generic power domains (genpd) framework and make it
         avoid measuring power-on and power-off latencies during system-wide
         PM transitions (Ulf Hansson).
    
       - Add support for the RockChip DFI controller and the rk3399 DMC to
         the devfreq framework (Lin Huang, Axel Lin, Arnd Bergmann).
    
       - Add COMPILE_TEST to the devfreq framework (Krzysztof Kozlowski,
         Stephen Rothwell).
    
       - Fix a minor issue in the exynos-ppmu devfreq driver and fix up
         devfreq Kconfig indentation style (Wei Yongjun, Jisheng Zhang).
    
       - Fix the system suspend interface to make suspend-to-idle work if
         platform suspend operations have not been registered (Sudeep
         Holla).
    
       - Make it possible to use hibernation with PAGE_POISONING_ZERO
         enabled (Anisse Astier).
    
       - Increas the default timeout of the system suspend/resume watchdog
         and make it depend on EXPERT (Chen Yu).
    
       - Make the operating performance points (OPP) framework avoid using
         OPPs that aren't supported by the platform and fix a build warning
         in it (Dave Gerlach, Arnd Bergmann).
    
       - Fix the ARM cpuidle driver's return value (Christophe Jaillet).
    
       - Make the SmartReflex AVS (Adaptive Voltage Scaling) driver use more
         common logging style (Joe Perches)"
    
    * tag 'pm-4.9-rc1' of git://git.kernel.org/pub/scm/linux/kernel/git/rafael/linux-pm: (58 commits)
      PM / OPP: Don't support OPP if it provides supported-hw but platform does not
      cpufreq: st: add missing \n to end of dev_err message
      cpufreq: kirkwood: add missing \n to end of dev_err messages
      PM / Domains: Rename pm_genpd_sync_poweron|poweroff()
      PM / Domains: Don't measure latency of ->power_on|off() during system PM
      PM / Domains: Remove redundant system PM callbacks
      PM / Domains: Simplify detaching a device from its genpd
      PM / devfreq: rk3399_dmc: Remove explictly regulator_put call in .remove
      PM / devfreq: rockchip: add PM_DEVFREQ_EVENT dependency
      PM / OPP: avoid maybe-uninitialized warning
      PM / Domains: Allow holes in genpd_data.domains array
      cpufreq: CPPC: Avoid overflow when calculating desired_perf
      cpufreq: ti: Use generic platdev driver
      cpufreq: intel_pstate: Add io_boost trace
      partial revert of "PM / devfreq: Add COMPILE_TEST for build coverage"
      cpufreq: intel_pstate: Use IOWAIT flag in Atom algorithm
      cpufreq: schedutil: Add iowait boosting
      cpufreq / sched: SCHED_CPUFREQ_IOWAIT flag to indicate iowait condition
      PM / Domains: Add support for removing nested PM domains by provider
      PM / Domains: Add support for removing PM domains
      ...

commit f76d9c61d91343806e59335493806e87daf78947
Merge: be67d60ba944 117e5e9c4cfc
Author: Linus Torvalds <torvalds@linux-foundation.org>
Date:   Sun Oct 2 15:23:00 2016 -0700

    Merge branch 'fixes' of git://git.armlinux.org.uk/~rmk/linux-arm
    
    Pull ARM fixes from Russell King:
     "Three relatively small fixes for ARM:
    
       - Roger noticed that dma_max_pfn() was calculating the upper limit
         wrongly, by adding the PFN offset of memory twice.
    
       - A fix from Robin to correct parsing of MPIDR values when the
         address size is larger than one BE32 unit.
    
       - A fix from Srinivas to ensure that we do not rely on the boot
         loader (or previous Linux kernel) setting the translation table
         base register a certain way in the decompressor, which can lead to
         crashes"
    
    * 'fixes' of git://git.armlinux.org.uk/~rmk/linux-arm:
      ARM: 8618/1: decompressor: reset ttbcr fields to use TTBR0 on ARMv7
      ARM: 8617/1: dma: fix dma_max_pfn()
      ARM: 8616/1: dt: Respect property size when parsing CPUs

commit 993eb0aeae0ff895e234cf94d1a86170584194e9
Merge: e35db92b4f53 da4a64481b35 1ad1410f632d
Author: Rafael J. Wysocki <rafael.j.wysocki@intel.com>
Date:   Sun Oct 2 01:43:45 2016 +0200

    Merge branches 'pm-devfreq' and 'pm-sleep'
    
    * pm-devfreq:
      PM / devfreq: rk3399_dmc: Remove explictly regulator_put call in .remove
      PM / devfreq: rockchip: add PM_DEVFREQ_EVENT dependency
      partial revert of "PM / devfreq: Add COMPILE_TEST for build coverage"
      PM / devfreq: rockchip: add devfreq driver for rk3399 dmc
      Documentation: bindings: add dt documentation for rk3399 dmc
      PM / devfreq: event: support rockchip dfi controller
      Documentation: bindings: add dt documentation for dfi controller
      PM / devfreq: event: remove duplicate devfreq_event_get_drvdata()
      PM / devfreq: fix Kconfig indent style
      PM / devfreq: Add COMPILE_TEST for build coverage
      PM / devfreq: exynos-ppmu: remove unneeded of_node_put()
    
    * pm-sleep:
      PM / Hibernate: allow hibernation with PAGE_POISONING_ZERO
      PM / sleep: enable suspend-to-idle even without registered suspend_ops
      PM / sleep: Increase default DPM watchdog timeout to 120

commit ba6dea4f7cedb4b1c17e36f4087675d817c2e24b
Author: Robin Murphy <robin.murphy@arm.com>
Date:   Mon Sep 26 16:50:55 2016 +0100

    ARM: 8616/1: dt: Respect property size when parsing CPUs
    
    Whilst MPIDR values themselves are less than 32 bits, it is still
    perfectly valid for a DT to have #address-cells > 1 in the CPUs node,
    resulting in the "reg" property having leading zero cell(s). In that
    situation, the big-endian nature of the data conspires with the current
    behaviour of only reading the first cell to cause the kernel to think
    all CPUs have ID 0, and become resoundingly unhappy as a consequence.
    
    Take the full property length into account when parsing CPUs so as to
    be correct under any circumstances.
    
    Cc: Russell King <linux@armlinux.org.uk>
    Signed-off-by: Robin Murphy <robin.murphy@arm.com>
    Signed-off-by: Russell King <rmk+kernel@arm.linux.org.uk>

commit 509cf0b8146c73e6f29bcf732d1af1b1aed5ec01
Author: Peter Ujfalusi <peter.ujfalusi@ti.com>
Date:   Wed Sep 21 15:41:35 2016 +0300

    dmaengine: ti-dma-crossbar: enable COMPILE_TEST
    
    To get more coverage, enable COMPILE_TEST for this driver.
    When compile testing eDMA or omap-dma, select also the ti-dma-crossbar so
    it is also covered by the compile testing.
    
    Signed-off-by: Peter Ujfalusi <peter.ujfalusi@ti.com>
    Signed-off-by: Vinod Koul <vinod.koul@intel.com>

commit 54ff7a2d2420048a904151c0f8c996712d50e08c
Author: Peter Ujfalusi <peter.ujfalusi@ti.com>
Date:   Wed Sep 21 15:41:34 2016 +0300

    dmaengine: omap-dma: enable COMPILE_TEST
    
    To get more coverage, enable COMPILE_TEST for this driver.
    
    Signed-off-by: Peter Ujfalusi <peter.ujfalusi@ti.com>
    Signed-off-by: Vinod Koul <vinod.koul@intel.com>

commit c5df3572fa13fa1445f5b276f046e791c4aac72b
Author: Peter Ujfalusi <peter.ujfalusi@ti.com>
Date:   Wed Sep 21 15:41:33 2016 +0300

    dmaengine: edma: enable COMPILE_TEST
    
    To get more coverage, enable COMPILE_TEST for this driver.
    
    Signed-off-by: Peter Ujfalusi <peter.ujfalusi@ti.com>
    Signed-off-by: Vinod Koul <vinod.koul@intel.com>

commit a8db115e476ee31fc3e892522038da50dd3a66cc
Author: Peter Ujfalusi <peter.ujfalusi@ti.com>
Date:   Wed Sep 21 15:41:30 2016 +0300

    dmaengine/ARM: omap-dma: Fix the DMAengine compile test on non OMAP configs
    
    The DMAengine driver for omap-dma use three function calls from the
    plat-omap legacy driver. When the DMAengine driver is built when ARCH_OMAP
    is not set, the compilation will fail due to missing symbols.
    Add empty inline functions to allow the DMAengine driver to be compiled
    with COMPILE_TEST.
    
    Signed-off-by: Peter Ujfalusi <peter.ujfalusi@ti.com>
    Signed-off-by: Vinod Koul <vinod.koul@intel.com>

commit eea6a364393736693b2d2c7c10b8b7d194a5ca10
Author: Peter Robinson <pbrobinson@gmail.com>
Date:   Wed May 25 14:45:50 2016 +0100

    thermal: imx: depend on imx SoC arch
    
    Not much use unless the SoC is selected so depend on the ARCH_MXC
    and COMPILE_TEST like all the other thermal drivers.
    
    v2: drop extraneous OF
    
    Signed-off-by: Peter Robinson <pbrobinson@gmail.com>
    Acked-by: Shawn Guo <shawn.guo@linaro.org>
    Signed-off-by: Zhang Rui <rui.zhang@intel.com>

commit 4cd169419f5a5a1c57dadeb3588ca7ee4d6de69f
Author: Vinod Koul <vinod.koul@intel.com>
Date:   Fri Sep 2 16:01:52 2016 +0530

    dmaengine: tegra-adma: enable COMPILE_TEST
    
    To get more coverage, enable COMPILE_TEST for this driver.
    
    Suggested-by: Jon Hunter <jonathanh@nvidia.com>
    Signed-off-by: Vinod Koul <vinod.koul@intel.com>

commit 854d4bd25b05ce1d9583b9b072c10070059d7944
Author: Vinod Koul <vinod.koul@intel.com>
Date:   Fri Sep 2 16:10:07 2016 +0530

    dmaengine: zxdma: enable COMPILE_TEST
    
    To get more coverage, enable COMPILE_TEST for this driver.
    
    Signed-off-by: Vinod Koul <vinod.koul@intel.com>

commit 4aa258af6532437910aebb3e8a6d47ffda8c1070
Author: Vinod Koul <vinod.koul@intel.com>
Date:   Fri Sep 2 16:07:05 2016 +0530

    dmaengine: timb-dma: enable COMPILE_TEST
    
    To get more coverage, enable COMPILE_TEST for this driver.
    
    Signed-off-by: Vinod Koul <vinod.koul@intel.com>

commit 1609db6f088eed4a0821641cb6d17ae0e79c779a
Author: Vinod Koul <vinod.koul@intel.com>
Date:   Fri Sep 2 16:00:41 2016 +0530

    dmaengine: s3c24xx: enable COMPILE_TEST
    
    To get more coverage, enable COMPILE_TEST for this driver.
    
    Reviewed-by: Krzysztof Kozlowski <krzk@kernel.org>
    Signed-off-by: Vinod Koul <vinod.koul@intel.com>

commit 4fbf3717a467c6d9bcd8fdce03fdd5074b14a03f
Author: Vinod Koul <vinod.koul@intel.com>
Date:   Fri Sep 2 15:57:51 2016 +0530

    dmaengine: stm32-dma: enable COMPILE_TEST
    
    To get more coverage, enable COMPILE_TEST for this driver.
    
    Signed-off-by: Vinod Koul <vinod.koul@intel.com>

commit 93d05f1ec644c97535159649de7f8e6731841336
Author: Vinod Koul <vinod.koul@intel.com>
Date:   Fri Sep 2 15:57:09 2016 +0530

    dmaengine: mmp_tdma: enable COMPILE_TEST
    
    To get more coverage, enable COMPILE_TEST for this driver.
    
    While at it, to fix build on other archs, select MMP_SRAM only for ARCH_MMP
    and also fix the platform header
    
    Suggested-by: Arnd Bergmann <arnd@arndb.de>
    Acked-by: Zhangfei Gao <zhangfei.gao@linaro.org>
    Signed-off-by: Vinod Koul <vinod.koul@intel.com>

commit cd3a792a77bc4e72e917efcf9dfc7f33cbb2fda8
Author: Vinod Koul <vinod.koul@intel.com>
Date:   Fri Sep 2 15:55:56 2016 +0530

    dmaengine: mmp_pdma: enable COMPILE_TEST
    
    To get more coverage, enable COMPILE_TEST for this driver.
    
    Acked-by: Zhangfei Gao <zhangfei.gao@linaro.org>
    Signed-off-by: Vinod Koul <vinod.koul@intel.com>

commit 49ad6d7dd65b5f2ec3ed847eb64bb916cd29431e
Author: Vinod Koul <vinod.koul@intel.com>
Date:   Fri Sep 2 15:38:43 2016 +0530

    dmaengine: ep93xx: enable COMPILE_TEST
    
    To get more coverage, enable COMPILE_TEST for this driver.
    
    Signed-off-by: Vinod Koul <vinod.koul@intel.com>

commit 6947c3f2870281961225b070c22ae5a382e36b6b
Author: Vinod Koul <vinod.koul@intel.com>
Date:   Fri Sep 2 15:31:42 2016 +0530

    dmaengine: sa11x0: enable COMPILE_TEST
    
    To get more coverage, enable COMPILE_TEST for this driver.
    
    Acked-by: Russell King <rmk+kernel@armlinux.org.uk>
    Signed-off-by: Vinod Koul <vinod.koul@intel.com>

commit 6e450376e5877f2671db552a7693e9325e31a1cb
Author: Vinod Koul <vinod.koul@intel.com>
Date:   Fri Sep 2 15:29:49 2016 +0530

    dmaengine: coh901318: enable COMPILE_TEST
    
    To get more coverage, enable COMPILE_TEST for this driver.
    
    Acked-by: Linus Walleij <linus.walleij@linaro.org>
    Signed-off-by: Vinod Koul <vinod.koul@intel.com>

commit a952b28788b5356780447ba23e89ea7365b19a1f
Author: Vinod Koul <vinod.koul@intel.com>
Date:   Fri Sep 2 15:27:20 2016 +0530

    dmaengine: jz4780: enable COMPILE_TEST
    
    To get more coverage, enable COMPILE_TEST for this driver.
    
    Signed-off-by: Vinod Koul <vinod.koul@intel.com>

commit d78d6c073a43dd9c6050c1df9921f238eb25ee5d
Author: Vinod Koul <vinod.koul@intel.com>
Date:   Fri Sep 2 15:25:11 2016 +0530

    dmaengine: jz4740: enable COMPILE_TEST
    
    To get more coverage, enable COMPILE_TEST for this driver.
    
    Acked-by: Lars-Peter Clausen <lars@metafoo.de>
    Signed-off-by: Vinod Koul <vinod.koul@intel.com>

commit 107896c5889a3f1dc7d985d6a0fdb3a1c0e6e047
Author: Andrey Smirnov <andrew.smirnov@gmail.com>
Date:   Thu Jul 21 14:59:18 2016 -0700

    Kconfig: nand: Make MTD_NAND_FSL_ELBC depend on FSL_SOC
    
    MTD_NAND_FSL_ELBC selects FSL_LBC that in turn depends on FSL_SOC, so
    depending on PPC instead of FSL_SOC leads to this message:
    
              warning: (MPC836x_RDK && MTD_NAND_FSL_ELBC &&
              MTD_NAND_FSL_UPM) selects FSL_LBC which has unmet direct
              dependencies (FSL_SOC)
    
    when doing
    
              make ARCH=powerpc \
                   CROSS_COMPILE=powerpc-e500v2-linux-gnuspe- \
                   allmodconfig"
    
    Changing dependency to FSL_SOC fixes that.
    
    Signed-off-by: Andrey Smirnov <andrew.smirnov@gmail.com>
    Signed-off-by: Boris Brezillon <boris.brezillon@free-electrons.com>

commit 163352eb6827e5b556b0860edc19327798fcc5ff
Author: Vladimir Murzin <vladimir.murzin@arm.com>
Date:   Mon Sep 12 15:49:21 2016 +0100

    ARM: Introduce MPIDR_LEVEL_SHIFT macro
    
    vgic-v3 driver uses architecture specific MPIDR_LEVEL_SHIFT macro to
    encode the affinity in a form compatible with ICC_SGI* registers.
    Unfortunately, that macro is missing on ARM, so let's add it.
    
    Cc: Russell King <rmk+kernel@armlinux.org.uk>
    Acked-by: Marc Zyngier <marc.zyngier@arm.com>
    Signed-off-by: Vladimir Murzin <vladimir.murzin@arm.com>
    Signed-off-by: Christoffer Dall <christoffer.dall@linaro.org>

commit b6fce7382d72274336aeafe6e44da755a371ed32
Author: Jan Kiszka <jan.kiszka@siemens.com>
Date:   Mon Sep 19 06:56:59 2016 +0200

    serial: 8250_pci: Use symbolic constants for EXAR's MPIO registers
    
    Less magic that only requires comments.
    
    Signed-off-by: Jan Kiszka <jan.kiszka@siemens.com>
    Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>

commit 4df27c91893fd13eaa30e9b0bca74f317816f428
Author: Arnd Bergmann <arnd@arndb.de>
Date:   Thu Sep 15 17:38:38 2016 +0200

    PM / OPP: avoid maybe-uninitialized warning
    
    When CONFIG_OPTIMIZE_INLINING is set and we are building with -Wmaybe-uninitialized
    enabled, we can get a warning for the opp core driver:
    
    drivers/base/power/opp/core.c: In function 'dev_pm_opp_set_rate':
    drivers/base/power/opp/core.c:560:8: warning: 'ou_volt_min' may be used uninitialized in this function [-Wmaybe-uninitialized]
    
    This has only now appeared as a result of commit 797da5598f3a ("PM / devfreq:
    Add COMPILE_TEST for build coverage"), which makes the driver visible in
    some configurations that didn't have it before.
    
    The warning is a false positive that I got with gcc-6.1.1, but there is
    a simple workaround in removing the local variables that we get warnings
    for (all three are affected depending on the configuration). This also
    makes the code easier to read.
    
    Signed-off-by: Arnd Bergmann <arnd@arndb.de>
    Reviewed-by: Stephen Boyd <sboyd@codeaurora.org>
    Acked-by: Viresh Kumar <viresh.kumar@linaro.org>
    Signed-off-by: Rafael J. Wysocki <rafael.j.wysocki@intel.com>

commit ed3d6d0ac036bcff6e4649a6f8fb987bb4e34444
Author: Tony Lindgren <tony@atomide.com>
Date:   Fri Sep 16 09:24:44 2016 -0500

    usb: musb: Fix tusb6010 compile error on blackfin
    
    We have CONFIG_BLACKFIN ifdef redefining all musb registers in
    musb_regs.h and tusb6010.h is never included causing a build
    error with blackfin-allmodconfig and COMPILE_TEST.
    
    Let's fix the issue by not building tusb6010 if CONFIG_BLACKFIN
    is selected.
    
    Reported-by: kbuild test robot <fengguang.wu@intel.com>
    Signed-off-by: Tony Lindgren <tony@atomide.com>
    Signed-off-by: Bin Liu <b-liu@ti.com>
    Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>

commit 290128ac139310e6d1fe47c023978907f2324f14
Author: Stephen Rothwell <sfr@canb.auug.org.au>
Date:   Wed Sep 14 14:22:25 2016 +1000

    partial revert of "PM / devfreq: Add COMPILE_TEST for build coverage"
    
    This reverts the Tegra part of commit 797da5598f3a (PM / devfreq: Add
    COMPILE_TEST for build coverage) that introduced a build failute in
    in linux-next.
    
    [ rjw: Changelog ]
    Signed-off-by: Stephen Rothwell <sfr@canb.auug.org.au>
    Signed-off-by: Rafael J. Wysocki <rafael.j.wysocki@intel.com>

commit de75abbe0121a6c3c9c6b04c75300088e57ad1d5
Author: Vitaly Kuznetsov <vkuznets@redhat.com>
Date:   Thu Sep 8 11:48:28 2016 +0200

    arm/xen: fix SMP guests boot
    
    Commit 88e957d6e47f ("xen: introduce xen_vcpu_id mapping") broke SMP
    ARM guests on Xen. When FIFO-based event channels are in use (this is
    the default), evtchn_fifo_alloc_control_block() is called on
    CPU_UP_PREPARE event and this happens before we set up xen_vcpu_id
    mapping in xen_starting_cpu. Temporary fix the issue by setting direct
    Linux CPU id <-> Xen vCPU id mapping for all possible CPUs at boot. We
    don't currently support kexec/kdump on Xen/ARM so these ids always
    match.
    
    In future, we have several ways to solve the issue, e.g.:
    
    - Eliminate all hypercalls from CPU_UP_PREPARE, do them from the
      starting CPU. This can probably be done for both x86 and ARM and, if
      done, will allow us to get Xen's idea of vCPU id from CPUID/MPIDR on
      the starting CPU directly, no messing with ACPI/device tree
      required.
    
    - Save vCPU id information from ACPI/device tree on ARM and use it to
      initialize xen_vcpu_id mapping. This is the same trick we currently
      do on x86.
    
    Reported-by: Julien Grall <julien.grall@arm.com>
    Tested-by: Wei Chen <Wei.Chen@arm.com>
    Signed-off-by: Vitaly Kuznetsov <vkuznets@redhat.com>
    Acked-by: Stefano Stabellini <sstabellini@kernel.org>
    Signed-off-by: David Vrabel <david.vrabel@citrix.com>

commit e41f323ab0e2fec843ab03219f1454dd9147dfcd
Merge: 9395452b4aab 5a893e31a636
Author: Rafael J. Wysocki <rafael.j.wysocki@intel.com>
Date:   Tue Sep 13 02:57:31 2016 +0200

    Merge tag 'pull_whole_for_4.9' of https://git.kernel.org/pub/scm/linux/kernel/git/mzx/devfreq into pm-devfreq
    
    Pull devfreq material for v4.9 from MyungJoo Ham.
    
    * tag 'pull_whole_for_4.9' of https://git.kernel.org/pub/scm/linux/kernel/git/mzx/devfreq:
      PM / devfreq: rockchip: add devfreq driver for rk3399 dmc
      Documentation: bindings: add dt documentation for rk3399 dmc
      PM / devfreq: event: support rockchip dfi controller
      Documentation: bindings: add dt documentation for dfi controller
      PM / devfreq: event: remove duplicate devfreq_event_get_drvdata()
      PM / devfreq: fix Kconfig indent style
      PM / devfreq: Add COMPILE_TEST for build coverage
      PM / devfreq: exynos-ppmu: remove unneeded of_node_put()

commit 2a4635ea1d39affd8bc9d33b062b03f33c910889
Author: Jorge Ramirez-Ortiz <jorge.ramirez-ortiz@linaro.org>
Date:   Wed Sep 7 17:43:00 2016 +0200

    spi: tools: enable CROSS_COMPILE in Makefile
    
    Signed-off-by: Jorge Ramirez-Ortiz <jorge.ramirez-ortiz@linaro.org>
    Signed-off-by: Mark Brown <broonie@kernel.org>

commit 5809ecdd6c3c0d6d568a10280f3736f1f4304930
Author: Hans Verkuil <hans.verkuil@cisco.com>
Date:   Tue Sep 6 07:37:45 2016 -0300

    [media] pxa_camera: allow building it if COMPILE_TEST is set
    
    Allow building this driver if COMPILE_TEST is set.
    
    Signed-off-by: Hans Verkuil <hans.verkuil@cisco.com>
    Signed-off-by: Mauro Carvalho Chehab <mchehab@s-opensource.com>

commit 797da5598f3a6fd92a514352d67078a682a432cb
Author: Krzysztof Kozlowski <k.kozlowski@samsung.com>
Date:   Fri Aug 19 08:36:55 2016 +0200

    PM / devfreq: Add COMPILE_TEST for build coverage
    
    The SoC-specific devfreq and devfreq-event drivers can be build tested
    on all architectures.
    
    Signed-off-by: Krzysztof Kozlowski <k.kozlowski@samsung.com>
    Reviewed-by: Chanwoo Choi <cw00.choi@samsung.com>
    Signed-off-by: MyungJoo Ham <myungjoo.ham@samsung.com>

commit 7f742e8e8ad4c54ae66820c91bbbb6526a461117
Author: Alexandre Belloni <alexandre.belloni@free-electrons.com>
Date:   Wed Aug 31 18:15:27 2016 +0200

    rtc: asm9260: allow COMPILE_TEST
    
    The rtc-asm9260 driver compiles correctly on other architectures, add
    COMPILE_TEST to improve code coverage.
    
    Signed-off-by: Alexandre Belloni <alexandre.belloni@free-electrons.com>

commit 7d3ef43f1f99d4250ff120c8965b3e5cd81b3c71
Merge: 2b97f10b3896 cddb4800162e
Author: Arnd Bergmann <arnd@arndb.de>
Date:   Fri Sep 2 18:29:04 2016 +0200

    Merge tag 'reset-for-4.9' of git://git.pengutronix.de/git/pza/linux into next/drivers
    
    Merge "Reset controller changes for v4.9" from Philipp Zabel:
    
    - add reset controller driver Kconfig options,
      allow building drivers with COMPILE_TEST
    - add reset controller driver for UniPhier SoCs
    - add reset controller driver for STM32 MCUs
    - simplify SoCFPGA reset controller driver a bit
    
    * tag 'reset-for-4.9' of git://git.pengutronix.de/git/pza/linux:
      reset: hi6220: allow to compile test driver on other architectures
      reset: zynq: add driver Kconfig option
      reset: sunxi: add driver Kconfig option
      reset: stm32: add driver Kconfig option
      reset: socfpga: add driver Kconfig option
      reset: pistachio: add driver Kconfig option
      reset: meson: add driver Kconfig option
      reset: lpc18xx: add driver Kconfig option
      reset: berlin: add driver Kconfig option
      reset: ath79: add driver Kconfig option
      reset: ath79: add missing include
      reset: warn on invalid input to reset_control_reset/assert/deassert/status
      reset: uniphier: add reset controller driver for UniPhier SoCs
      ARM: dts: stm32f429: add missing #reset-cells of rcc
      drivers: reset: Add STM32 reset driver
      dt-bindings: Document the STM32 reset bindings
      dt-bindings: mfd: Add STM32F4 RCC numeric constants into DT include file
      reset: socfpga: no need to store modrst_offset

commit 6f51b860076995d290810cd5fdc00afbbe36ca28
Author: Philipp Zabel <p.zabel@pengutronix.de>
Date:   Tue Aug 9 09:28:54 2016 +0200

    reset: zynq: add driver Kconfig option
    
    Visible only if COMPILE_TEST is enabled, this allows to include the
    driver in build tests.
    
    Cc: Moritz Fischer <moritz.fischer@ettus.com>
    Cc: Sren Brinkmann <soren.brinkmann@xilinx.com>
    Acked-by: Michal Simek <michal.simek@xilinx.com>
    Reviewed-by: Masahiro Yamada <yamada.masahiro@socionext.com>
    Signed-off-by: Philipp Zabel <p.zabel@pengutronix.de>

commit 0ae084195b64e9a99fd0ef65b006b74ca2addefe
Author: Philipp Zabel <p.zabel@pengutronix.de>
Date:   Tue Aug 9 09:28:44 2016 +0200

    reset: sunxi: add driver Kconfig option
    
    Visible only if COMPILE_TEST is enabled, this allows to include the
    driver in build tests.
    
    Reviewed-by: Masahiro Yamada <yamada.masahiro@socionext.com>
    Signed-off-by: Philipp Zabel <p.zabel@pengutronix.de>

commit 7e0e901d41406861810aa631d0dca22ac8c6dc41
Author: Philipp Zabel <p.zabel@pengutronix.de>
Date:   Thu Jul 28 15:34:15 2016 +0200

    reset: stm32: add driver Kconfig option
    
    Visible only if COMPILE_TEST is enabled, this allows to include the
    driver in build tests.
    
    Cc: Maxime Coquelin <mcoquelin.stm32@gmail.com>
    Cc: Gabriel Fernandez <gabriel.fernandez@st.com>
    Reviewed-by: Masahiro Yamada <yamada.masahiro@socionext.com>
    Signed-off-by: Philipp Zabel <p.zabel@pengutronix.de>

commit 5c91407ed3d19704016a6a70ccbeb5c1914615bc
Author: Philipp Zabel <p.zabel@pengutronix.de>
Date:   Thu Jul 28 15:33:43 2016 +0200

    reset: socfpga: add driver Kconfig option
    
    Visible only if COMPILE_TEST is enabled, this allows to include the
    driver in build tests.
    
    Acked-by: Dinh Nguyen <dinguyen@opensource.altera.com>
    Reviewed-by: Masahiro Yamada <yamada.masahiro@socionext.com>
    Signed-off-by: Philipp Zabel <p.zabel@pengutronix.de>

commit fab3f73098bbccd0ca433896e860974992bbe877
Author: Philipp Zabel <p.zabel@pengutronix.de>
Date:   Thu Jul 28 15:33:07 2016 +0200

    reset: pistachio: add driver Kconfig option
    
    Visible only if COMPILE_TEST is enabled, this allows to include the
    driver in build tests.
    
    Cc: Damien Horsley <Damien.Horsley@imgtec.com>
    Acked-by: James Hartley <james.hartley@imgtec.com>
    Reviewed-by: Masahiro Yamada <yamada.masahiro@socionext.com>
    Signed-off-by: Philipp Zabel <p.zabel@pengutronix.de>

commit b2d8b0cb6ca9cb81dd71626642f764ac70d10813
Author: James Morse <james.morse@arm.com>
Date:   Wed Aug 17 13:50:27 2016 +0100

    Revert "arm64: hibernate: Refuse to hibernate if the boot cpu is offline"
    
    Now that we use the MPIDR to resume on the same CPU that we hibernated on,
    we no longer need to refuse to hibernate if the boot cpu is offline. (Which
    we can't possibly know if kexec causes logical CPUs to be renumbered).
    
    This reverts commit 1fe492ce6482b77807b25d29690a48c46456beee.
    
    Signed-off-by: James Morse <james.morse@arm.com>
    Acked-by: Catalin Marinas <catalin.marinas@arm.com>
    Signed-off-by: Will Deacon <will.deacon@arm.com>

commit 8ec058fd2710da1df463c19a4e0ee55ac4530f09
Author: James Morse <james.morse@arm.com>
Date:   Wed Aug 17 13:50:26 2016 +0100

    arm64: hibernate: Resume when hibernate image created on non-boot CPU
    
    disable_nonboot_cpus() assumes that the lowest numbered online CPU is
    the boot CPU, and that this is the correct CPU to run any power
    management code on.
    
    On arm64 CPU0 can be taken offline. For hibernate/resume this means we
    may hibernate on a CPU other than CPU0. If the system is rebooted with
    kexec 'CPU0' will be assigned to a different CPU. This complicates
    hibernate/resume as now we can't trust the CPU numbers.
    
    We currently forbid hibernate if CPU0 has been hotplugged out to avoid
    this situation without kexec.
    
    Save the MPIDR of the CPU we hibernated on in the hibernate arch-header,
    use hibernate_resume_nonboot_cpu_disable() to direct which CPU we should
    resume on based on the MPIDR of the CPU we hibernated on. This allows us to
    hibernate/resume on any CPU, even if the logical numbers have been
    shuffled by kexec.
    
    Signed-off-by: James Morse <james.morse@arm.com>
    Cc: Mark Rutland <mark.rutland@arm.com>
    Cc: Lorenzo Pieralisi <lorenzo.pieralisi@arm.com>
    Reviewed-by: Catalin Marinas <catalin.marinas@arm.com>
    Signed-off-by: Will Deacon <will.deacon@arm.com>

commit 44336c24a931eb51feba6574bcf4d63c4bca432f
Author: Philipp Zabel <p.zabel@pengutronix.de>
Date:   Thu Jul 28 15:32:36 2016 +0200

    reset: meson: add driver Kconfig option
    
    Visible only if COMPILE_TEST is enabled, this allows to include the
    driver in build tests.
    
    Acked-by: Neil Armstrong <narmstrong@baylibre.com>
    Reviewed-by: Masahiro Yamada <yamada.masahiro@socionext.com>
    Signed-off-by: Philipp Zabel <p.zabel@pengutronix.de>

commit cd7f4b81cf927a0296b50b95862ef4f1b064ea27
Author: Philipp Zabel <p.zabel@pengutronix.de>
Date:   Thu Jul 28 15:32:01 2016 +0200

    reset: lpc18xx: add driver Kconfig option
    
    Visible only if COMPILE_TEST is enabled, this allows to include the
    driver in build tests.
    
    Acked-by: Joachim Eastwood <manabian@gmail.com>
    Reviewed-by: Masahiro Yamada <yamada.masahiro@socionext.com>
    Signed-off-by: Philipp Zabel <p.zabel@pengutronix.de>

commit 70d467ea16c7bc1c21ccde69e01fa41a1b3b9df7
Author: Philipp Zabel <p.zabel@pengutronix.de>
Date:   Thu Jul 28 15:31:12 2016 +0200

    reset: berlin: add driver Kconfig option
    
    Visible only if COMPILE_TEST is enabled, this allows to include the
    driver in build tests.
    
    Cc: Antoine Tenart <antoine.tenart@free-electrons.com>
    Cc: Sebastian Hesselbarth <sebastian.hesselbarth@gmail.com>
    Reviewed-by: Masahiro Yamada <yamada.masahiro@socionext.com>
    Signed-off-by: Philipp Zabel <p.zabel@pengutronix.de>

commit e27b4a6e634735b730cdae7b9d852a000c06cadd
Author: Philipp Zabel <p.zabel@pengutronix.de>
Date:   Thu Jul 28 15:30:08 2016 +0200

    reset: ath79: add driver Kconfig option
    
    Visible only if COMPILE_TEST is enabled, this allows to include the
    driver in build tests.
    
    Acked-by: Aban Bedel <albeu@free.fr>
    Reviewed-by: Masahiro Yamada <yamada.masahiro@socionext.com>
    Signed-off-by: Philipp Zabel <p.zabel@pengutronix.de>

commit 702650bda073cb9df90e3a091ee515f340133b05
Author: Peter Robinson <pbrobinson@gmail.com>
Date:   Tue Aug 23 18:17:46 2016 +0100

    ASoC: sunxi: depend on ARCH_SUNXI
    
    Depend on ARCH_SUNXI or COMPILE_TEST as it doesn't make sense to enable
    these if the appropriate SoC they're embedded in isn't enabled.
    
    Signed-off-by: Peter Robinson <pbrobinson@gmail.com>
    Signed-off-by: Mark Brown <broonie@kernel.org>

commit ac3339baffd724edfb188ef57d1345d9649ba9af
Author: Alexey Dobriyan <adobriyan@gmail.com>
Date:   Tue Aug 2 14:07:21 2016 -0700

    init/Kconfig: ban CONFIG_LOCALVERSION_AUTO with allmodconfig
    
    Doing patches with allmodconfig kernel compiled and committing stuff
    into local tree have unfortunate consequence: kernel version changes (as
    it should) leading to recompiling and relinking of several files even if
    they weren't touched (or interesting at all).  This and "git-whatever"
    figuring out current version slow down compilation for no good reason.
    
    But lets face it, "allmodconfig" kernels don't care about kernel
    version, they are simply compile check guinea pigs.
    
    Make LOCALVERSION_AUTO depend on !COMPILE_TEST, so it doesn't sneak into
    allmodconfig .config.
    
    Link: http://lkml.kernel.org/r/20160707214954.GC31678@p183.telecom.by
    Signed-off-by: Alexey Dobriyan <adobriyan@gmail.com>
    Cc: Michal Marek <mmarek@suse.cz>
    Signed-off-by: Andrew Morton <akpm@linux-foundation.org>
    Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>

commit bc083a64b6c035135c0f80718f9e9192cc0867c6
Author: Richard Weinberger <richard@nod.at>
Date:   Tue Aug 2 14:03:27 2016 -0700

    init/Kconfig: make COMPILE_TEST depend on !UML
    
    UML is a bit special since it does not have iomem nor dma.  That means a
    lot of drivers will not build if they miss a dependency on HAS_IOMEM.
    s390 used to have the same issues but since it gained PCI support UML is
    the only stranger.
    
    We are tired of patching dozens of new drivers after every merge window
    just to un-break allmod/yesconfig UML builds.  One could argue that a
    decent driver has to know on what it depends and therefore a missing
    HAS_IOMEM dependency is a clear driver bug.  But the dependency not
    obvious and not everyone does UML builds with COMPILE_TEST enabled when
    developing a device driver.
    
    A possible solution to make these builds succeed on UML would be
    providing stub functions for ioremap() and friends which fail upon
    runtime.  Another one is simply disabling COMPILE_TEST for UML.  Since
    it is the least hassle and does not force use to fake iomem support
    let's do the latter.
    
    Link: http://lkml.kernel.org/r/1466152995-28367-1-git-send-email-richard@nod.at
    Signed-off-by: Richard Weinberger <richard@nod.at>
    Acked-by: Arnd Bergmann <arnd@arndb.de>
    Cc: Al Viro <viro@zeniv.linux.org.uk>
    Signed-off-by: Andrew Morton <akpm@linux-foundation.org>
    Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>

commit f716a85cd6045c994011268223706642cff7e485
Merge: 221bb8a46e23 a519167e753e
Author: Linus Torvalds <torvalds@linux-foundation.org>
Date:   Tue Aug 2 16:37:12 2016 -0400

    Merge branch 'kbuild' of git://git.kernel.org/pub/scm/linux/kernel/git/mmarek/kbuild
    
    Pull kbuild updates from Michal Marek:
    
     - GCC plugin support by Emese Revfy from grsecurity, with a fixup from
       Kees Cook.  The plugins are meant to be used for static analysis of
       the kernel code.  Two plugins are provided already.
    
     - reduction of the gcc commandline by Arnd Bergmann.
    
     - IS_ENABLED / IS_REACHABLE macro enhancements by Masahiro Yamada
    
     - bin2c fix by Michael Tautschnig
    
     - setlocalversion fix by Wolfram Sang
    
    * 'kbuild' of git://git.kernel.org/pub/scm/linux/kernel/git/mmarek/kbuild:
      gcc-plugins: disable under COMPILE_TEST
      kbuild: Abort build on bad stack protector flag
      scripts: Fix size mismatch of kexec_purgatory_size
      kbuild: make samples depend on headers_install
      Kbuild: don't add obj tree in additional includes
      Kbuild: arch: look for generated headers in obtree
      Kbuild: always prefix objtree in LINUXINCLUDE
      Kbuild: avoid duplicate include path
      Kbuild: don't add ../../ to include path
      vmlinux.lds.h: replace config_enabled() with IS_ENABLED()
      kconfig.h: allow to use IS_{ENABLE,REACHABLE} in macro expansion
      kconfig.h: use already defined macros for IS_REACHABLE() define
      export.h: use __is_defined() to check if __KSYM_* is defined
      kconfig.h: use __is_defined() to check if MODULE is defined
      kbuild: setlocalversion: print error to STDERR
      Add sancov plugin
      Add Cyclomatic complexity GCC plugin
      GCC plugin infrastructure
      Shared library support

commit 14833b8c52424eafb962f9ce7d8f1c01c14ee41f
Author: Jianxin Xiong <jianxin.xiong@intel.com>
Date:   Fri Jul 1 16:01:56 2016 -0700

    IB/hfi1: Improve SDMA engine assignment for user SDMA
    
    Currently each user context is assigned a single SDMA engine
    based on the VL, context id, and subcontext id. That means for
    MPI applications, each rank can only use one SDMA engine for
    all messages. This may create unwanted backup for independent
    messages going to different destinations upon congestion at one
    destination.
    
    This patch adds the packet "dlid" to the formula of SDMA engine
    selection for user SDMA requests. A simple hash table is used
    to maintain even distribution among the available SDMA engines
    regardless how the "dlid" values are distributed.
    
    Reviewed-by: Dean Luick <dean.luick@intel.com>
    Reviewed-by: Tadeusz Struk <tadeusz.struk@intel.com>
    Signed-off-by: Jianxin Xiong <jianxin.xiong@intel.com>
    Signed-off-by: Dennis Dalessandro <dennis.dalessandro@intel.com>
    Signed-off-by: Doug Ledford <dledford@redhat.com>

commit b094a36f90975373c3a241839869217a65f17d81
Author: Sebastian Sanchez <sebastian.sanchez@intel.com>
Date:   Mon Jul 25 07:54:57 2016 -0700

    IB/hfi1: Refine user process affinity algorithm
    
    When performing process affinity recommendations for MPI ranks, the current
    algorithm doesn't take into account multiple HFI units. Also, real
    cores and HT cores are not distinguished from one another. Therefore,
    all HT cores are recommended to be assigned first within the local NUMA
    node before recommending the assignments of cores in other NUMA nodes.
    It's ideal to assign all real cores across all NUMA nodes first, then all
    HT 1 cores, then all HT 2 cores, and so on to balance CPU workload. CPU
    cores in other NUMA nodes could be running interrupt handlers, and this is
    not taken into account.
    
    To balance the CPU workload for user processes, the following
    recommendation algorithm is used:
    
     For each user process that is opening a context on HFI Y:
      a) If all cores are assigned to user processes, start assignments all
             over from the first core
      b) Assign real cores first, then HT cores (First set of HT cores on
             all physical cores, then second set of HT cores, and, so on) in the
             following order:
    
             1. Same NUMA node as HFI Y and not running an IRQ handler
             2. Same NUMA node as HFI Y and running an IRQ handler
             3. Different NUMA node to HFI Y and not running an IRQ handler
             4. Different NUMA node to HFI Y and running an IRQ handler
      c) Mark core as assigned in the global affinity structure. As user
             processes are done, remove core assignments from global affinity
             structure.
    
    This implementation allows an arbitrary number of HT cores and provides
    support for multiple HFIs.
    
    This is being included in the kernel rather than user space due to the
    fact that user space has no way of knowing the CPU recommendations for
    contexts running as part of other jobs.
    
    Reviewed-by: Ira Weiny <ira.weiny@intel.com>
    Reviewed-by: Mitko Haralanov <mitko.haralanov@intel.com>
    Reviewed-by: Dennis Dalessandro <dennis.dalessandro@intel.com>
    Signed-off-by: Sebastian Sanchez <sebastian.sanchez@intel.com>
    Signed-off-by: Doug Ledford <dledford@redhat.com>

commit 77a87824ed676ca8ff8482e4157d3adb284fd381
Author: Stephen Rothwell <sfr@canb.auug.org.au>
Date:   Thu Jul 7 13:59:06 2016 +1000

    clocksource/drivers/clps_711x: fixup for "ARM: clps711x:
    
     Switch to MULTIPLATFORM"
    
    Missed conflict between commit c86f51737f8d ("ARM: clps711x: Switch to
    MULTIPLATFORM") from the arm-soc tree and commit 250e46aa3bb3
    ("clocksource/drivers/clps_711x: Add the COMPILE_TEST option") from the
    clockevents tree.
    
    Signed-off-by: Stephen Rothwell <sfr@canb.auug.org.au>
    Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>

commit bad60e6f259a01cf9f29a1ef8d435ab6c60b2de9
Merge: dd0f0cf58af7 719dbb2df78f
Author: Linus Torvalds <torvalds@linux-foundation.org>
Date:   Sat Jul 30 21:01:36 2016 -0700

    Merge tag 'powerpc-4.8-1' of git://git.kernel.org/pub/scm/linux/kernel/git/powerpc/linux
    
    Pull powerpc updates from Michael Ellerman:
     "Highlights:
       - PowerNV PCI hotplug support.
       - Lots more Power9 support.
       - eBPF JIT support on ppc64le.
       - Lots of cxl updates.
       - Boot code consolidation.
    
      Bug fixes:
       - Fix spin_unlock_wait() from Boqun Feng
       - Fix stack pointer corruption in __tm_recheckpoint() from Michael
         Neuling
       - Fix multiple bugs in memory_hotplug_max() from Bharata B Rao
       - mm: Ensure "special" zones are empty from Oliver O'Halloran
       - ftrace: Separate the heuristics for checking call sites from
         Michael Ellerman
       - modules: Never restore r2 for a mprofile-kernel style mcount() call
         from Michael Ellerman
       - Fix endianness when reading TCEs from Alexey Kardashevskiy
       - start rtasd before PCI probing from Greg Kurz
       - PCI: rpaphp: Fix slot registration for multiple slots under a PHB
         from Tyrel Datwyler
       - powerpc/mm: Add memory barrier in __hugepte_alloc() from Sukadev
         Bhattiprolu
    
      Cleanups & fixes:
       - Drop support for MPIC in pseries from Rashmica Gupta
       - Define and use PPC64_ELF_ABI_v2/v1 from Michael Ellerman
       - Remove unused symbols in asm-offsets.c from Rashmica Gupta
       - Fix SRIOV not building without EEH enabled from Russell Currey
       - Remove kretprobe_trampoline_holder from Thiago Jung Bauermann
       - Reduce log level of PCI I/O space warning from Benjamin
         Herrenschmidt
       - Add array bounds checking to crash_shutdown_handlers from Suraj
         Jitindar Singh
       - Avoid -maltivec when using clang integrated assembler from Anton
         Blanchard
       - Fix array overrun in ppc_rtas() syscall from Andrew Donnellan
       - Fix error return value in cmm_mem_going_offline() from Rasmus
         Villemoes
       - export cpu_to_core_id() from Mauricio Faria de Oliveira
       - Remove old symbols from defconfigs from Andrew Donnellan
       - Update obsolete comments in setup_32.c about entry conditions from
         Benjamin Herrenschmidt
       - Add comment explaining the purpose of setup_kdump_trampoline() from
         Benjamin Herrenschmidt
       - Merge the RELOCATABLE config entries for ppc32 and ppc64 from Kevin
         Hao
       - Remove RELOCATABLE_PPC32 from Kevin Hao
       - Fix .long's in tlb-radix.c to more meaningful from Balbir Singh
    
      Minor cleanups & fixes:
       - Andrew Donnellan, Anna-Maria Gleixner, Anton Blanchard, Benjamin
         Herrenschmidt, Bharata B Rao, Christophe Leroy, Colin Ian King,
         Geliang Tang, Greg Kurz, Madhavan Srinivasan, Michael Ellerman,
         Michael Ellerman, Stephen Rothwell, Stewart Smith.
    
      Freescale updates from Scott:
       - "Highlights include more 8xx optimizations, device tree updates,
         and MVME7100 support."
    
      PowerNV PCI hotplug from Gavin Shan:
       - PCI: Add pcibios_setup_bridge()
       - Override pcibios_setup_bridge()
       - Remove PCI_RESET_DELAY_US
       - Move pnv_pci_ioda_setup_opal_tce_kill() around
       - Increase PE# capacity
       - Allocate PE# in reverse order
       - Create PEs in pcibios_setup_bridge()
       - Setup PE for root bus
       - Extend PCI bridge resources
       - Make pnv_ioda_deconfigure_pe() visible
       - Dynamically release PE
       - Update bridge windows on PCI plug
       - Delay populating pdn
       - Support PCI slot ID
       - Use PCI slot reset infrastructure
       - Introduce pnv_pci_get_slot_id()
       - Functions to get/set PCI slot state
       - PCI/hotplug: PowerPC PowerNV PCI hotplug driver
       - Print correct PHB type names
    
      Power9 idle support from Shreyas B. Prabhu:
       - set power_save func after the idle states are initialized
       - Use PNV_THREAD_WINKLE macro while requesting for winkle
       - make hypervisor state restore a function
       - Rename idle_power7.S to idle_book3s.S
       - Rename reusable idle functions to hardware agnostic names
       - Make pnv_powersave_common more generic
       - abstraction for saving SPRs before entering deep idle states
       - Add platform support for stop instruction
       - cpuidle/powernv: Use CPUIDLE_STATE_MAX instead of MAX_POWERNV_IDLE_STATES
       - cpuidle/powernv: cleanup cpuidle-powernv.c
       - cpuidle/powernv: Add support for POWER ISA v3 idle states
       - Use deepest stop state when cpu is offlined
    
      Power9 PMU from Madhavan Srinivasan:
       - factor out power8 pmu macros and defines
       - factor out power8 pmu functions
       - factor out power8 __init_pmu code
       - Add power9 event list macros for generic and cache events
       - Power9 PMU support
       - Export Power9 generic and cache events to sysfs
    
      Power9 preliminary interrupt & PCI support from Benjamin Herrenschmidt:
       - Add XICS emulation APIs
       - Move a few exception common handlers to make room
       - Add support for HV virtualization interrupts
       - Add mechanism to force a replay of interrupts
       - Add ICP OPAL backend
       - Discover IODA3 PHBs
       - pci: Remove obsolete SW invalidate
       - opal: Add real mode call wrappers
       - Rename TCE invalidation calls
       - Remove SWINV constants and obsolete TCE code
       - Rework accessing the TCE invalidate register
       - Fallback to OPAL for TCE invalidations
       - Use the device-tree to get available range of M64's
       - Check status of a PHB before using it
       - pci: Don't try to allocate resources that will be reassigned
    
      Other Power9:
       - Send SIGBUS on unaligned copy and paste from Chris Smart
       - Large Decrementer support from Oliver O'Halloran
       - Load Monitor Register Support from Jack Miller
    
      Performance improvements from Anton Blanchard:
       - Avoid load hit store in __giveup_fpu() and __giveup_altivec()
       - Avoid load hit store in setup_sigcontext()
       - Remove assembly versions of strcpy, strcat, strlen and strcmp
       - Align hot loops of some string functions
    
      eBPF JIT from Naveen N. Rao:
       - Fix/enhance 32-bit Load Immediate implementation
       - Optimize 64-bit Immediate loads
       - Introduce rotate immediate instructions
       - A few cleanups
       - Isolate classic BPF JIT specifics into a separate header
       - Implement JIT compiler for extended BPF
    
      Operator Panel driver from Suraj Jitindar Singh:
       - devicetree/bindings: Add binding for operator panel on FSP machines
       - Add inline function to get rc from an ASYNC_COMP opal_msg
       - Add driver for operator panel on FSP machines
    
      Sparse fixes from Daniel Axtens:
       - make some things static
       - Introduce asm-prototypes.h
       - Include headers containing prototypes
       - Use #ifdef __BIG_ENDIAN__ #else for REG_BYTE
       - kvm: Clarify __user annotations
       - Pass endianness to sparse
       - Make ppc_md.{halt, restart} __noreturn
    
      MM fixes & cleanups from Aneesh Kumar K.V:
       - radix: Update LPCR HR bit as per ISA
       - use _raw variant of page table accessors
       - Compile out radix related functions if RADIX_MMU is disabled
       - Clear top 16 bits of va only on older cpus
       - Print formation regarding the the MMU mode
       - hash: Update SDR1 size encoding as documented in ISA 3.0
       - radix: Update PID switch sequence
       - radix: Update machine call back to support new HCALL.
       - radix: Add LPID based tlb flush helpers
       - radix: Add a kernel command line to disable radix
       - Cleanup LPCR defines
    
      Boot code consolidation from Benjamin Herrenschmidt:
       - Move epapr_paravirt_early_init() to early_init_devtree()
       - cell: Don't use flat device-tree after boot
       - ge_imp3a: Don't use the flat device-tree after boot
       - mpc85xx_ds: Don't use the flat device-tree after boot
       - mpc85xx_rdb: Don't use the flat device-tree after boot
       - Don't test for machine type in rtas_initialize()
       - Don't test for machine type in smp_setup_cpu_maps()
       - dt: Add of_device_compatible_match()
       - Factor do_feature_fixup calls
       - Move 64-bit feature fixup earlier
       - Move 64-bit memory reserves to setup_arch()
       - Use a cachable DART
       - Move FW feature probing out of pseries probe()
       - Put exception configuration in a common place
       - Remove early allocation of the SMU command buffer
       - Move MMU backend selection out of platform code
       - pasemi: Remove IOBMAP allocation from platform probe()
       - mm/hash: Don't use machine_is() early during boot
       - Don't test for machine type to detect HEA special case
       - pmac: Remove spurrious machine type test
       - Move hash table ops to a separate structure
       - Ensure that ppc_md is empty before probing for machine type
       - Move 64-bit probe_machine() to later in the boot process
       - Move 32-bit probe() machine to later in the boot process
       - Get rid of ppc_md.init_early()
       - Move the boot time info banner to a separate function
       - Move setting of {i,d}cache_bsize to initialize_cache_info()
       - Move the content of setup_system() to setup_arch()
       - Move cache info inits to a separate function
       - Re-order the call to smp_setup_cpu_maps()
       - Re-order setup_panic()
       - Make a few boot functions __init
       - Merge 32-bit and 64-bit setup_arch()
    
      Other new features:
       - tty/hvc: Use IRQF_SHARED for OPAL hvc consoles from Sam Mendoza-Jonas
       - tty/hvc: Use opal irqchip interface if available from Sam Mendoza-Jonas
       - powerpc: Add module autoloading based on CPU features from Alastair D'Silva
       - crypto: vmx - Convert to CPU feature based module autoloading from Alastair D'Silva
       - Wake up kopald polling thread before waiting for events from Benjamin Herrenschmidt
       - xmon: Dump ISA 2.06 SPRs from Michael Ellerman
       - xmon: Dump ISA 2.07 SPRs from Michael Ellerman
       - Add a parameter to disable 1TB segs from Oliver O'Halloran
       - powerpc/boot: Add OPAL console to epapr wrappers from Oliver O'Halloran
       - Assign fixed PHB number based on device-tree properties from Guilherme G. Piccoli
       - pseries: Add pseries hotplug workqueue from John Allen
       - pseries: Add support for hotplug interrupt source from John Allen
       - pseries: Use kernel hotplug queue for PowerVM hotplug events from John Allen
       - pseries: Move property cloning into its own routine from Nathan Fontenot
       - pseries: Dynamic add entires to associativity lookup array from Nathan Fontenot
       - pseries: Auto-online hotplugged memory from Nathan Fontenot
       - pseries: Remove call to memblock_add() from Nathan Fontenot
    
      cxl:
       - Add set and get private data to context struct from Michael Neuling
       - make base more explicitly non-modular from Paul Gortmaker
       - Use for_each_compatible_node() macro from Wei Yongjun
       - Frederic Barrat
       - Abstract the differences between the PSL and XSL
       - Make vPHB device node match adapter's
       - Philippe Bergheaud
       - Add mechanism for delivering AFU driver specific events
       - Ignore CAPI adapters misplaced in switched slots
       - Refine slice error debug messages
       - Andrew Donnellan
       - static-ify variables to fix sparse warnings
       - PCI/hotplug: pnv_php: export symbols and move struct types needed by cxl
       - PCI/hotplug: pnv_php: handle OPAL_PCI_SLOT_OFFLINE power state
       - Add cxl_check_and_switch_mode() API to switch bi-modal cards
       - remove dead Kconfig options
       - fix potential NULL dereference in free_adapter()
       - Ian Munsie
       - Update process element after allocating interrupts
       - Add support for CAPP DMA mode
       - Fix allowing bogus AFU descriptors with 0 maximum processes
       - Fix allocating a minimum of 2 pages for the SPA
       - Fix bug where AFU disable operation had no effect
       - Workaround XSL bug that does not clear the RA bit after a reset
       - Fix NULL pointer dereference on kernel contexts with no AFU interrupts
       - powerpc/powernv: Split cxl code out into a separate file
       - Add cxl_slot_is_supported API
       - Enable bus mastering for devices using CAPP DMA mode
       - Move cxl_afu_get / cxl_afu_put to base
       - Allow a default context to be associated with an external pci_dev
       - Do not create vPHB if there are no AFU configuration records
       - powerpc/powernv: Add support for the cxl kernel api on the real phb
       - Add support for using the kernel API with a real PHB
       - Add kernel APIs to get & set the max irqs per context
       - Add preliminary workaround for CX4 interrupt limitation
       - Add support for interrupts on the Mellanox CX4
       - Workaround PE=0 hardware limitation in Mellanox CX4
       - powerpc/powernv: Fix pci-cxl.c build when CONFIG_MODULES=n
    
      selftests:
       - Test unaligned copy and paste from Chris Smart
       - Load Monitor Register Tests from Jack Miller
       - Cyril Bur
       - exec() with suspended transaction
       - Use signed long to read perf_event_paranoid
       - Fix usage message in context_switch
       - Fix generation of vector instructions/types in context_switch
       - Michael Ellerman
       - Use "Delta" rather than "Error" in normal output
       - Import Anton's mmap & futex micro benchmarks
       - Add a test for PROT_SAO"
    
    * tag 'powerpc-4.8-1' of git://git.kernel.org/pub/scm/linux/kernel/git/powerpc/linux: (263 commits)
      powerpc/mm: Parenthesise IS_ENABLED() in if condition
      tty/hvc: Use opal irqchip interface if available
      tty/hvc: Use IRQF_SHARED for OPAL hvc consoles
      selftests/powerpc: exec() with suspended transaction
      powerpc: Improve comment explaining why we modify VRSAVE
      powerpc/mm: Drop unused externs for hpte_init_beat[_v3]()
      powerpc/mm: Rename hpte_init_lpar() and move the fallback to a header
      powerpc/mm: Fix build break when PPC_NATIVE=n
      crypto: vmx - Convert to CPU feature based module autoloading
      powerpc: Add module autoloading based on CPU features
      powerpc/powernv/ioda: Fix endianness when reading TCEs
      powerpc/mm: Add memory barrier in __hugepte_alloc()
      powerpc/modules: Never restore r2 for a mprofile-kernel style mcount() call
      powerpc/ftrace: Separate the heuristics for checking call sites
      powerpc: Merge 32-bit and 64-bit setup_arch()
      powerpc/64: Make a few boot functions __init
      powerpc: Re-order setup_panic()
      powerpc: Re-order the call to smp_setup_cpu_maps()
      powerpc/32: Move cache info inits to a separate function
      powerpc/64: Move the content of setup_system() to setup_arch()
      ...

commit f7816ad0f878dacd5f0120476f9b836ccf8699ea
Merge: 6097d55e10a7 4fcd504edbf7
Author: Linus Torvalds <torvalds@linux-foundation.org>
Date:   Tue Jul 26 19:49:09 2016 -0700

    Merge tag 'for-v4.8' of git://git.kernel.org/pub/scm/linux/kernel/git/sre/linux-power-supply
    
    Pull power supply and reset updates from Sebastian Reichel:
     - introduce reboot mode driver
     - add DT support to max8903
     - add power supply support for axp221
     - misc fixes
    
    * tag 'for-v4.8' of git://git.kernel.org/pub/scm/linux/kernel/git/sre/linux-power-supply:
      power: reset: add reboot mode driver
      dt-bindings: power: reset: add document for reboot-mode driver
      power_supply: fix return value of get_property
      power: qcom_smbb: Make an extcon for usb cable detection
      max8903: adds support for initiation via device tree
      max8903: adds documentation for device tree bindings.
      max8903: remove unnecessary 'out of memory' error message.
      max8903: removes non zero validity checks on gpios.
      max8903: adds requesting of gpios.
      max8903: cleans up confusing relationship between dc_valid, dok and dcm.
      max8903: store pointer to pdata instead of copying it.
      power_supply: bq27xxx_battery: Group register mappings into one table
      docs: Move brcm,bcm21664-resetmgr.txt
      power/reset: make syscon_poweroff() static
      power: axp20x_usb: Add support for usb power-supply on axp22x pmics
      power_supply: bq27xxx_battery: Index register numbers by enum
      power_supply: bq27xxx_battery: Fix copy/paste error in header comment
      MAINTAINERS: Add file patterns for power supply device tree bindings
      power: reset: keystone: Enable COMPILE_TEST

commit a519167e753e6a89476115375b65a7eb6ec485b3
Author: Kees Cook <keescook@chromium.org>
Date:   Sat Jun 11 09:09:28 2016 -0700

    gcc-plugins: disable under COMPILE_TEST
    
    Since adding the gcc plugin development headers is required for the
    gcc plugin support, we should ease into this new kernel build dependency
    more slowly. For now, disable the gcc plugins under COMPILE_TEST so that
    all*config builds will skip it.
    
    Signed-off-by: Kees Cook <keescook@chromium.org>
    Signed-off-by: Michal Marek <mmarek@suse.com>

commit 54d0b14ad7cc4ff3c710f092a93638f359c1b14b
Merge: 273b5a483696 c11dd70fd7f5 c49b43ce0394 a3bcf2d45d6a
Author: Rafael J. Wysocki <rafael.j.wysocki@intel.com>
Date:   Mon Jul 25 13:43:03 2016 +0200

    Merge branches 'acpi-drivers', 'acpi-misc' and 'acpi-tools'
    
    * acpi-drivers:
      ACPI / DPTF: move int340x_thermal.c to the DPTF folder
      ACPI / DPTF: Add DPTF power participant driver
    
    * acpi-misc:
      ACPI / lpat: make it explicitly non-modular
      ACPI / dock: make dock explicitly non-modular
    
    * acpi-tools:
      tools/acpi: use CROSS_COMPILE to define prefix

commit ee62f09bda631151a55e2b2543acba5a38eef186
Merge: 62cd69d5b0cd 0bfb85c6ba62
Author: Linus Torvalds <torvalds@linux-foundation.org>
Date:   Sat Jul 23 12:03:21 2016 +0900

    Merge tag 'gpio-v4.7-6' of git://git.kernel.org/pub/scm/linux/kernel/git/linusw/linux-gpio
    
    Pull GPIO fix from Linus Walleij:
     "Compile problem fix for Tegra,
    
      Sorry to send this in the last minute but Ingo says this build failure
      is very prominent so I'm not going to wait for v4.7 before sending it.
    
      It is a case of COMPILE_TEST causing more problems than it solves and
      I'm already swearing about me shooting myself in the foot with that
      gun :("
    
    * tag 'gpio-v4.7-6' of git://git.kernel.org/pub/scm/linux/kernel/git/linusw/linux-gpio:
      gpio: tegra: don't auto-enable for COMPILE_TEST

commit 0bfb85c6ba620c39c0e5124851a1bea0f5a56e05
Author: Arnd Bergmann <arnd@arndb.de>
Date:   Wed Jul 6 14:54:03 2016 +0200

    gpio: tegra: don't auto-enable for COMPILE_TEST
    
    I stumbled over a build error with COMPILE_TEST and CONFIG_OF
    disabled:
    
    drivers/gpio/gpio-tegra.c: In function 'tegra_gpio_probe':
    drivers/gpio/gpio-tegra.c:603:9: error: 'struct gpio_chip' has no member named 'of_node'
    
    The problem is that the newly added GPIO_TEGRA Kconfig symbol
    does not have a dependency on CONFIG_OF. However, there is another
    problem here as the driver gets enabled unconditionally whenever
    COMPILE_TEST is set.
    
    This fixes both problems, by making the symbol user-visible
    when COMPILE_TEST is set and default-enabled for ARCH_TEGRA=y.
    
    As a side-effect, it is now possible to compile-test a Tegra
    kernel with GPIO support disabled, which is harmless.
    
    Signed-off-by: Arnd Bergmann <arnd@arndb.de>
    Fixes: 4dd4dd1d2120 ("gpio: tegra: Allow compile test")
    Signed-off-by: Linus Walleij <linus.walleij@linaro.org>

commit 9f6db9bfb58e0008c0d041d69cef3bcb6247dc52
Author: Axel Lin <axel.lin@ingics.com>
Date:   Sat Jul 9 13:31:23 2016 +0800

    i2c: versatile: Allow compile test build
    
    There is no build dependency for this driver, so enable COMPILE_TEST to get
    better build coverage.
    
    Signed-off-by: Axel Lin <axel.lin@ingics.com>
    Tested-by: Liviu Dudau <Liviu.Dudau@arm.com>
    Acked-by: Liviu Dudau <Liviu.Dudau@arm.com>
    Signed-off-by: Wolfram Sang <wsa@the-dreams.de>

commit c1023ba74fc77dc56dc317bd98f5060aab889ac1
Author: Hans Verkuil <hans.verkuil@cisco.com>
Date:   Fri Jul 8 16:11:19 2016 -0300

    [media] drivers/media/platform/Kconfig: fix VIDEO_MEDIATEK_VCODEC dependency
    
    Allow VIDEO_MEDIATEK_VCODEC to build when COMPILE_TEST is set (even
    without MTK_IOMMU).
    
    Signed-off-by: Hans Verkuil <hans.verkuil@cisco.com>
    Signed-off-by: Mauro Carvalho Chehab <mchehab@s-opensource.com>

commit 914017836afb6aff86afdf819cb270944e89c2ac
Author: Ben Dooks <ben-linux@fluff.org>
Date:   Wed Jul 6 21:17:05 2016 +0100

    i2c: meson: allow build with COMPILE_TEST
    
    This driver should be buildable with COMPILE_TEST so
    add this to the dependency for it.
    
    Signed-off-by: Ben Dooks <ben.dooks@codethink.co.uk>
    Signed-off-by: Wolfram Sang <wsa@the-dreams.de>

commit 1fa04d923c8e1648304b3d2490466c7d9e9746eb
Merge: 87040f7c9661 2983e625bf2a
Author: Olof Johansson <olof@lixom.net>
Date:   Tue Jul 5 21:10:09 2016 -0700

    Merge tag 'imx-dt64-4.8' of git://git.kernel.org/pub/scm/linux/kernel/git/shawnguo/linux into next/dt64
    
    The Freescale arm64 device tree updates for 4.8:
     - Update address-cells and reg properties of cpu nodes, considering
       MPIDR_EL1[63:32] bits are not used for CPUs identification on ls1043a
       and ls2080a
     - Adds the cache nodes and next-level-cache property for ls1043a and
       ls2080a to get cacheinfo work on these platforms
     - Add dma-coherent for ls1043a PCI nodes to utilize the hardware
       capability on data coherency
     - Add dis_rxdet_inp3_quirk property for USB3 device to disable rx
       detection in P3 PHY mode
    
    * tag 'imx-dt64-4.8' of git://git.kernel.org/pub/scm/linux/kernel/git/shawnguo/linux:
      arm64: dts: ls2080a: Add cache nodes for cacheinfo support
      arm64: dts: ls1043a: Add cache nodes for cacheinfo support
      arm64: dts: ls1043a: Add 'dma-coherent' for ls1043a PCI nodes
      bindings: PCI: layerscape: Add 'dma-coherent' property
      arm64: dts: ls1043a: Add dis_rxdet_inp3_quirk property to USB3 node
      arm64: dts: ls2080a: Add dis_rxdet_inp3_quirk property to USB3 node
      arm64: dts: fsl: Update address-cells and reg properties of cpu nodes
    
    Signed-off-by: Olof Johansson <olof@lixom.net>

commit 5cc87a4df5009c1cbe9e087ad16c0bacdae06809
Author: Daniel Lezcano <daniel.lezcano@linaro.org>
Date:   Tue Jun 7 11:05:01 2016 +0200

    clocksource/drivers/versatile: Add the COMPILE_TEST option
    
    Change the Kconfig option logic to fullfil with the current approach,
    allowing the user to compile the driver on different platforms.
    
    The current option let the user to select the clocksource or not.
    
    The Kconfig option policy is to let the platform to select the
    timer automatically.
    
    Add the COMPILE_TEST option, so the prompt to select the driver will
    be showed only when COMPILE_TEST is set and will let this driver
    to compile on different platform, thus increasing the compilation
    test coverage.
    
    Signed-off-by: Daniel Lezcano <daniel.lezcano@linaro.org>

commit b988d3f085f07deca70ba8b90f77a84af8a334a3
Author: Daniel Lezcano <daniel.lezcano@linaro.org>
Date:   Mon Jun 6 19:08:39 2016 +0200

    clocksource/drivers/timer-atmel-st: Add the COMPILE_TEST option
    
    Change the Kconfig option logic to fullfil with the current approach,
    allowing the user to compile the driver on different platforms.
    
    Signed-off-by: Daniel Lezcano <daniel.lezcano@linaro.org>

commit 67a87a43b9117029446bea6397675bc6f7725a5a
Author: Daniel Lezcano <daniel.lezcano@linaro.org>
Date:   Mon Jun 6 14:34:28 2016 +0200

    clocksource/drivers/arm_global_timer: Add the COMPILE_TEST option
    
    Change the Kconfig option logic to fullfil with the current approach,
    allowing the user to compile the driver on different platforms.
    
    Signed-off-by: Daniel Lezcano <daniel.lezcano@linaro.org>

commit 568c0342e494fa4c05377c6c83c653afa350985a
Author: Daniel Lezcano <daniel.lezcano@linaro.org>
Date:   Fri Jun 3 15:11:21 2016 +0200

    clocksource/drivers/integrator-ap: Add the COMPILE_TEST option
    
    Change the Kconfig option logic to fullfil with the current approach.
    
    A new Kconfig option is added, CONFIG_INTEGRATOR_AP_TIMER and is selected
    by the platform. Then the clocksource's Kconfig is changed to make this
    option selectable by the user if the COMPILE_TEST option is set. Otherwise,
    it is up to the platform's Kconfig to select the timer.
    
    Signed-off-by: Daniel Lezcano <daniel.lezcano@linaro.org>

commit c12547a00dfd3aaacfd5ce362ee4b9585c320054
Author: Daniel Lezcano <daniel.lezcano@linaro.org>
Date:   Fri Jun 3 15:05:05 2016 +0200

    clocksource/drivers/keystone: Add the COMPILE_TEST option
    
    Change the Kconfig option logic to fullfil with the current approach.
    
    A new Kconfig option is added, CONFIG_KEYSTONE_TIMER and is selected by the
    platform. Then the clocksource's Kconfig is changed to make this option
    selectable by the user if the COMPILE_TEST option is set. Otherwise, it is
    up to the platform's Kconfig to select the timer.
    
    Signed-off-by: Daniel Lezcano <daniel.lezcano@linaro.org>

commit d683b9dcc8a8d743f7b660ff3b77ccfbe652e4b9
Author: Daniel Lezcano <daniel.lezcano@linaro.org>
Date:   Fri Jun 3 15:03:21 2016 +0200

    clocksource/drivers/nspire: Add the COMPILE_TEST option
    
    Change the Kconfig option logic to fullfil with the current approach.
    
    A new Kconfig option is added, CONFIG_NSPIRE_TIMER and is selected by the
    platform. Then the clocksource's Kconfig is changed to make this option
    selectable by the user if the COMPILE_TEST option is set. Otherwise, it is
    up to the platform's Kconfig to select the timer.
    
    Signed-off-by: Daniel Lezcano <daniel.lezcano@linaro.org>

commit 85f98db4adbbd3ec6b41537d31241b59bf47c66f
Author: Daniel Lezcano <daniel.lezcano@linaro.org>
Date:   Fri Jun 3 14:31:16 2016 +0200

    clocksource/drivers/u300: Add the COMPILE_TEST option
    
    Change the Kconfig option logic to fullfil with the current approach.
    
    A new Kconfig option is added, CONFIG_U300_TIMER and is selected by the
    platform. Then the clocksource's Kconfig is changed to make this option
    selectable by the user if the COMPILE_TEST option is set. Otherwise, it is
    up to the platform's Kconfig to select the timer.
    
    Due on the delay specific code, this driver will compile only on the ARM
    architecture.
    
    Signed-off-by: Daniel Lezcano <daniel.lezcano@linaro.org>

commit f3550d499576c423db0d902930cf8d848fe09744
Author: Daniel Lezcano <daniel.lezcano@linaro.org>
Date:   Fri Jun 3 14:28:38 2016 +0200

    clocksource/drivers/prima2: Add the COMPILE_TEST option
    
    Change the Kconfig option logic to fullfil with the current approach.
    
    A new Kconfig option is added, CONFIG_PRIMA2_TIMER and is selected by the
    platform. Then the clocksource's Kconfig is changed to make this option
    selectable by the user if the COMPILE_TEST option is set. Otherwise, it is
    up to the platform's Kconfig to select the timer.
    
    Signed-off-by: Daniel Lezcano <daniel.lezcano@linaro.org>

commit d81c50a0360f8a186150b9bb572d5e0514c25ce9
Author: Daniel Lezcano <daniel.lezcano@linaro.org>
Date:   Fri Jun 3 13:36:18 2016 +0200

    clocksource/drivers/mxs: Add the COMPILE_TEST option
    
    Change the Kconfig option logic to fullfil with the current approach.
    
    A new Kconfig option is added, CONFIG_MXS_TIMER and is selected by the
    platform. Then the clocksource's Kconfig is changed to make this option
    selectable by the user if the COMPILE_TEST option is set. Otherwise, it is
    up to the platform's Kconfig to select the timer.
    
    Signed-off-by: Daniel Lezcano <daniel.lezcano@linaro.org>

commit 419be9e36cf2349f15d0b7280ba46be6f9da7a61
Author: Daniel Lezcano <daniel.lezcano@linaro.org>
Date:   Fri Jun 3 13:29:03 2016 +0200

    clocksource/drivers/moxart: Add the COMPILE_TEST option
    
    Change the Kconfig option logic to fullfil with the current approach.
    
    A new Kconfig option is added, CONFIG_MOXART_TIMER and is selected by the
    platform. Then the clocksource's Kconfig is changed to make this option
    selectable by the user if the COMPILE_TEST option is set. Otherwise, it is
    up to the platform's Kconfig to select the timer.
    
    Signed-off-by: Daniel Lezcano <daniel.lezcano@linaro.org>

commit b56d5d218499404b2abfd6f33a6d480312bf8a92
Author: Daniel Lezcano <daniel.lezcano@linaro.org>
Date:   Fri Jun 3 13:11:39 2016 +0200

    clocksource/drivers/atlas7: Add the COMPILE_TEST option
    
    Change the Kconfig option logic to fullfil with the current approach.
    
    A new Kconfig option is added, CONFIG_ATLAS7_TIMER and is selected by the
    platform. Then the clocksource's Kconfig is changed to make this option
    selectable by the user if the COMPILE_TEST option is set. Otherwise, it is
    up to the platform's Kconfig to select the timer.
    
    Signed-off-by: Daniel Lezcano <daniel.lezcano@linaro.org>

commit ecf0efdc98cd46886fa119492f052ab3eaba9ddf
Author: Daniel Lezcano <daniel.lezcano@linaro.org>
Date:   Thu Jun 2 20:06:54 2016 +0200

    clocksource/drivers/clps_711x: Add the COMPILE_TEST option
    
    Change the Kconfig option logic to fullfil with the current approach.
    
    A new Kconfig option is added, CONFIG_CLPS711X_TIMER and is selected by the
    platform. Then the clocksource's Kconfig is changed to make this option
    selectable by the user if the COMPILE_TEST option is set. Otherwise, it is
    up to the platform's Kconfig to select the timer.
    
    Signed-off-by: Daniel Lezcano <daniel.lezcano@linaro.org>

commit 1cad71e35f88bd41b954e9984c7d2a8ce3924db0
Author: Daniel Lezcano <daniel.lezcano@linaro.org>
Date:   Thu Jun 2 19:20:36 2016 +0200

    clocksource/drivers/bcm_kona: Add the COMPILE_TEST option
    
    Change the Kconfig option logic to fullfil with the current approach.
    
    A new Kconfig option is added, CONFIG_BCM_KONA_TIMER and is selected by the
    platform. Then the clocksource's Kconfig is changed to make this option
    selectable by the user if the COMPILE_TEST option is set. Otherwise, it is
    up to the platform's Kconfig to select the timer.
    
    Signed-off-by: Daniel Lezcano <daniel.lezcano@linaro.org>

commit e2146d8650764638784205cf51378f01bbd098b6
Author: Daniel Lezcano <daniel.lezcano@linaro.org>
Date:   Thu Jun 2 18:41:52 2016 +0200

    clocksource/drivers/armv7m_systick: Add the COMPILE_TEST option
    
    In order to increase the compilation test coverage, add the COMPILE_TEST
    so the driver can be compiled even if it does not belong to the platform
    or the architecture.
    
    The io.h header inclusion is also added as it the driver does not compile
    on UM platform.
    
    Signed-off-by: Daniel Lezcano <daniel.lezcano@linaro.org>

commit 2ea879a7cf544e05c7cd0bfd569857ec2a8a75a9
Author: Daniel Lezcano <daniel.lezcano@linaro.org>
Date:   Thu Jun 2 18:35:38 2016 +0200

    clocksource/drivers/bcm2835: Add the COMPILE_TEST option
    
    Change the Kconfig option logic to fullfil with the current approach.
    
    A new Kconfig option is added, CONFIG_BCM2835_TIMER and is selected by the
    platform. Then the clocksource's Kconfig is changed to make this option
    selectable by the user if the COMPILE_TEST option is set. Otherwise, it
    is up to the platform's Kconfig to select the timer.
    
    Signed-off-by: Daniel Lezcano <daniel.lezcano@linaro.org>

commit b81ea968706bdb5c2f2af62c5700573a32ab310a
Author: Daniel Lezcano <daniel.lezcano@linaro.org>
Date:   Thu Jun 2 22:44:49 2016 +0200

    clk: Add missing clk_get_sys() stub
    
    When compiling with the COMPILE_TEST option set, the clps711x does not
    compile because of the clk_get_sys() noop stub missing.
    
    Signed-off-by: Daniel Lezcano <daniel.lezcano@linaro.org>
    Reviewed-by: Michael Turquette <mturquette@baylibre.com>

commit ce87122911f8db59d3c2bc355c694c7a38940804
Author: Vladimir Murzin <vladimir.murzin@arm.com>
Date:   Tue Jun 7 16:02:37 2016 +0100

    serial: mps2-uart: make driver explicitly non-modular
    
    The Kconfig currently controlling compilation of mps2-uart is:
    
    config SERIAL_MPS2_UART
            bool "MPS2 UART port"
            depends on ARM || COMPILE_TEST
    
    ...meaning that it currently is not being built as a module by anyone.
    
    Follow commit 89ebc2742769 ("drivers/tty: make serial/mvebu-uart.c
    explicitly non-modular") as an example of moving modular code to
    non-modular:
    
    - remove the modular code that is essentially orphaned, so that
      when reading the driver there is no doubt it is builtin-only.
    
    - explicitly disallow a driver unbind, since that doesn't have a
      sensible use case anyway, and it allows us to drop the ".remove"
      code for non-modular drivers.
    
    - use arch_initcall instead of module_init and remove module_exit.
    
    Also note that MODULE_DEVICE_TABLE is a no-op for non-modular code.
    
    We also delete the MODULE_LICENSE tag etc. since all that information
    was (or is now) contained at the top of the file in the comments.
    
    Reported-by: Paul Gortmaker <paul.gortmaker@windriver.com>
    Signed-off-by: Vladimir Murzin <vladimir.murzin@arm.com>
    Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>

commit 8d6d544cfb52a28d5c75d17552fa3d3f1cfe4a8c
Author: Masahiro Yamada <yamada.masahiro@socionext.com>
Date:   Mon Jun 6 13:30:25 2016 +0900

    serial: 8250_uniphier: add COMPILE_TEST option
    
    Add COMPILE_TEST for the compilation test coverage.
    
    Signed-off-by: Masahiro Yamada <yamada.masahiro@socionext.com>
    Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>

commit 63c0c076e590ed83050c80ada2e82adeac9de126
Author: Srinivas Kandagatla <srinivas.kandagatla@linaro.org>
Date:   Thu Jun 2 12:19:43 2016 +0100

    nvmem: imx-ocotp: add COMPILE_TEST for proper test coverage
    
    This patch add COMPILE_TEST to imx-ocotp driver so that it can be
    compile tested on other platforms with zero day testing.
    Also adds HAS_IOMEM dependancy as the users of devm_ioremap_resource()
    which are compile-testable should depend on HAS_IOMEM.
    
    Signed-off-by: Srinivas Kandagatla <srinivas.kandagatla@linaro.org>
    Acked-by: Philipp Zabel <p.zabel@pengutronix.de>
    Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>

commit a3bcf2d45d6a9c7950f58ec7dad20f22d422abd2
Author: Andy Shevchenko <andriy.shevchenko@linux.intel.com>
Date:   Fri Jun 17 16:01:08 2016 +0300

    tools/acpi: use CROSS_COMPILE to define prefix
    
    CROSS_COMPILE can be considered as standard definition for toolchain prefix
    when cross-compiling. Use it here.
    
    Signed-off-by: Andy Shevchenko <andriy.shevchenko@linux.intel.com>
    Signed-off-by: Rafael J. Wysocki <rafael.j.wysocki@intel.com>

commit 802c7f1c84e4b5a6ac78635878041023fc5831b1
Author: Salvatore Benedetto <salvatore.benedetto@intel.com>
Date:   Wed Jun 22 17:49:14 2016 +0100

    crypto: dh - Add DH software implementation
    
    * Implement MPI based Diffie-Hellman under kpp API
     * Test provided uses data generad by OpenSSL
    
    Signed-off-by: Salvatore Benedetto <salvatore.benedetto@intel.com>
    Signed-off-by: Herbert Xu <herbert@gondor.apana.org.au>

commit 58f388bcf011b47040378754cbe25118f7942151
Author: Paul Gortmaker <paul.gortmaker@windriver.com>
Date:   Thu Jun 16 20:37:47 2016 -0400

    memory: samsung: exynos-srom: make it explicitly non-modular
    
    The Kconfig currently controlling compilation of this code is:
    
    memory/samsung/Kconfig:config EXYNOS_SROM
    memory/samsung/Kconfig: bool "Exynos SROM controller driver" if COMPILE_TEST
    
    ...meaning that it currently is not being built as a module by anyone.
    
    Lets remove the modular code that is essentially orphaned, so that
    when reading the driver there is no doubt it is builtin-only.
    
    We explicitly disallow a driver unbind, since that doesn't have a
    sensible use case anyway, and it allows us to drop the ".remove"
    code for non-modular drivers.
    
    Since module_platform_driver() uses the same init level priority as
    builtin_platform_driver() the init ordering remains unchanged with
    this commit.
    
    Also note that MODULE_DEVICE_TABLE is a no-op for non-modular code.
    
    We also delete the MODULE_LICENSE tag etc. since all that information
    is already contained at the top of the file in the comments.
    
    Cc: Pankaj Dubey <pankaj.dubey@samsung.com>
    Signed-off-by: Paul Gortmaker <paul.gortmaker@windriver.com>
    Signed-off-by: Krzysztof Kozlowski <k.kozlowski@samsung.com>

commit 906a8276429c7eb3b53676dab4e2acb632ffcc5a
Author: He Kuang <hekuang@huawei.com>
Date:   Wed Jun 15 11:03:56 2016 +0000

    perf unwind: Fix compile error for static cross build
    
    Build failure for static cross-compiling on aarch64, with libunwind-x86
    provided:
    
      $ file ./libunwind_for_x86_on_aarch64/lib/libunwind-x86.so.8.0.1
    
      libunwind-x86.so.8.0.1: ELF 64-bit LSB shared object, ARM aarch64,
      version 1 (SYSV), dynamically linked, not stripped
    
      $ make LDFLAGS=-static LIBUNWIND_DIR=./libunwind_for_x86_on_aarch64
      ARCH=aarch64 CROSS_COMPILE=aarch64-buildroot-linux-gnu-
    
      ~/libperf.a(libperf-in.o): In function `find_proc_info':
      :(.text+0xae4ac): undefined reference to `_Ux86_dwarf_search_unwind_table'
      ~/libperf.a(libperf-in.o): In function `_unwind__prepare_access':
      :(.text+0xaedd0): undefined reference to `_Ux86_create_addr_space'
      :(.text+0xaee24): undefined reference to `_Ux86_set_caching_policy'
      ~/libperf.a(libperf-in.o): In function `_unwind__flush_access':
      :(.text+0xaee98): undefined reference to `_Ux86_flush_cache'
      ~/libperf.a(libperf-in.o): In function `_unwind__finish_access':
      :(.text+0xaef08): undefined reference to `_Ux86_destroy_addr_space'
      ~/libperf.a(libperf-in.o): In function `get_entries':
      :(.text+0xaf148): undefined reference to `_Ux86_init_remote'
      :(.text+0xaf184): undefined reference to `_Ux86_get_reg'
      :(.text+0xaf1a4): undefined reference to `_Ux86_step'
      collect2: error: ld returned 1 exit status
      Makefile.perf:350: recipe for target '~/perf' failed
      make[1]: *** [~/perf] Error 1
      Makefile:68: recipe for target 'all' failed
      make: *** [all] Error 2
    
    This is because the remote libunwind library detected is not appended to
    EXTLIBS variable, which will be included between 'start-group' and
    'end-group' when linking.
    
    The existing variable LIBUNWIND_LIBS is assigned to libs for local
    unwind, this patch introduces a new variable EXTLIBS_LIBUNWIND for
    storing remote libunwind libraries instead.
    
    Signed-off-by: He Kuang <hekuang@huawei.com>
    Cc: Alexander Shishkin <alexander.shishkin@linux.intel.com>
    Cc: Jiri Olsa <jolsa@kernel.org>
    Cc: Namhyung Kim <namhyung@kernel.org>
    Cc: Peter Zijlstra <peterz@infradead.org>
    Cc: Wang Nan <wangnan0@huawei.com>
    Link: http://lkml.kernel.org/r/1465988636-81502-1-git-send-email-hekuang@huawei.com
    Signed-off-by: Arnaldo Carvalho de Melo <acme@redhat.com>

commit 5a7de97309f5af4458b1a25a2a529a1a893c5269
Author: Tudor Ambarus <tudor-dan.ambarus@nxp.com>
Date:   Tue Jun 14 16:14:58 2016 +0300

    crypto: rsa - return raw integers for the ASN.1 parser
    
    Return the raw key with no other processing so that the caller
    can copy it or MPI parse it, etc.
    
    The scope is to have only one ANS.1 parser for all RSA
    implementations.
    
    Update the RSA software implementation so that it does
    the MPI conversion on top.
    
    Signed-off-by: Tudor Ambarus <tudor-dan.ambarus@nxp.com>
    Signed-off-by: Herbert Xu <herbert@gondor.apana.org.au>

commit ac9cd1709c0be4334fbad4ab610ecb7acceac884
Author: Rashmica Gupta <rashmicy@gmail.com>
Date:   Mon May 30 16:18:15 2016 +1000

    powerpc/pseries: Remove MPIC from pseries event sources
    
    MPIC was only used by Power3 which is now unsupported, so remove MPIC
    code. XICS is now the only supported interrupt controller for
    pSeries so do some cleanups too.
    
    Signed-off-by: Rashmica Gupta <rashmicy@gmail.com>
    Signed-off-by: Michael Ellerman <mpe@ellerman.id.au>

commit 8324947d6d318fbcf558d50ae348a85aacd68930
Author: Rashmica Gupta <rashmicy@gmail.com>
Date:   Mon May 30 16:18:14 2016 +1000

    powerpc/pseries: Remove MPIC from pseries cpu hotplug
    
    MPIC was only used by Power3 which is now unsupported, so remove MPIC
    code.
    
    Signed-off-by: Rashmica Gupta <rashmicy@gmail.com>
    Signed-off-by: Michael Ellerman <mpe@ellerman.id.au>

commit d739d2caa3d3e283ca4d41716cd317684e066ef9
Author: Rashmica Gupta <rashmicy@gmail.com>
Date:   Mon May 30 16:18:13 2016 +1000

    powerpc/pseries: Remove MPIC from pseries kexec
    
    MPIC was only used by Power3 which is now unsupported, so remove MPIC
    code. XICS is now the only supported interrupt controller for
    pSeries so do some cleanups too.
    
    Signed-off-by: Rashmica Gupta <rashmicy@gmail.com>
    Signed-off-by: Michael Ellerman <mpe@ellerman.id.au>

commit 86425bedd5b69ea5969ff11bb07c8e5ff7117976
Author: Rashmica Gupta <rashmicy@gmail.com>
Date:   Mon May 30 16:18:12 2016 +1000

    powerpc/pseries: Remove MPIC from pseries smp
    
    MPIC was only used by Power3 which is now unsupported, so remove MPIC
    code. XICS is now the only supported interrupt controller for
    pSeries so do some cleanups too.
    
    Signed-off-by: Rashmica Gupta <rashmicy@gmail.com>
    Signed-off-by: Michael Ellerman <mpe@ellerman.id.au>

commit e7da5dac4e9067a526136db2f23cc8696a5d4649
Author: Rashmica Gupta <rashmicy@gmail.com>
Date:   Mon May 30 16:18:11 2016 +1000

    powerpc/pseries: Drop support for MPIC in pseries
    
    MPIC was only used by Power3 which is now unsupported, so drop support
    for MPIC. XICS is now the only supported interrupt controller for
    pSeries so make the XICS functions generic.
    
    Signed-off-by: Rashmica Gupta <rashmicy@gmail.com>
    Signed-off-by: Michael Ellerman <mpe@ellerman.id.au>

commit 4c43d1c1bcfcd660b4d6aa96d235351c201544d0
Merge: e7a6bb9a05ea 9479f7cc9187
Author: Olof Johansson <olof@lixom.net>
Date:   Mon Jun 13 14:28:37 2016 -0700

    Merge tag 'samsung-drivers-4.8' of git://git.kernel.org/pub/scm/linux/kernel/git/krzk/linux into next/drivers
    
    Samsung drivers/soc update for v4.8:
    1. Move the power domain driver from arm/mach-exynos and prepare
       for supporting ARMv8.
    2. Add COMPILE_TEST.
    
    * tag 'samsung-drivers-4.8' of git://git.kernel.org/pub/scm/linux/kernel/git/krzk/linux:
      soc: samsung: pm_domains: Enable COMPILE_TEST for build coverage
      soc: samsung: pm_domains: Prepare for supporting ARMv8 Exynos
      ARM: EXYNOS: Move pm_domains driver to drivers/soc/samsung
    
    Signed-off-by: Olof Johansson <olof@lixom.net>

commit e6d66c50b997a0c4035659d8a24a3d510c593cef
Author: Alison Wang <b18965@freescale.com>
Date:   Mon May 9 17:06:15 2016 +0800

    arm64: dts: fsl: Update address-cells and reg properties of cpu nodes
    
    MPIDR_EL1[63:32] value is equal to 0 for the CPUs of the LS1043A and
    LS2080A SoCs. The ARM CPU binding allows #address-cells to be set to 1,
    since MPIDR_EL1[63:32] bits are not used for CPUs identification. Update
    the #address-cells and reg properties accordingly.
    
    Signed-off-by: Alison Wang <alison.wang@nxp.com>
    Signed-off-by: Shawn Guo <shawnguo@kernel.org>

commit aa3a655b159f11b1afe0dcdac5fb5b172f02b778
Merge: 616d1c1b98ac 7db91f251056
Author: Ingo Molnar <mingo@kernel.org>
Date:   Wed Jun 8 09:29:23 2016 +0200

    Merge tag 'perf-core-for-mingo-20160606' of git://git.kernel.org/pub/scm/linux/kernel/git/acme/linux into perf/core
    
    Pull perf/core improvements and fixes from Arnaldo Carvalho de Melo:
    
    User visible changes:
    
    - Tooling support for TopDown counters, recently added to the kernel (Andi Kleen)
    
    - Show call graphs in 'perf script' when 1st event doesn't have it but some other has (He Kuang)
    
    - Fix terminal cleanup when handling invalid .perfconfig files in 'perf top' (Taeung Song)
    
    Build fixes:
    
    - Respect CROSS_COMPILE for the linker in libapi (Lucas Stach)
    
    Infrastructure changes:
    
    - Fix perf_evlist__alloc_mmap() failure path (Wang Nan)
    
    - Provide way to extract integer value from format_field (Arnaldo Carvalho de Melo)
    
    Signed-off-by: Arnaldo Carvalho de Melo <acme@redhat.com>
    Signed-off-by: Ingo Molnar <mingo@kernel.org>

commit 703e01652d25edbd249e3043c26543157f0ef15c
Author: Lucas Stach <l.stach@pengutronix.de>
Date:   Thu Mar 17 18:27:50 2016 +0100

    tools lib api: Respect CROSS_COMPILE for the linker
    
    This fixes cross compilation of libapi.
    
    Signed-off-by: Lucas Stach <l.stach@pengutronix.de>
    Cc: Jiri Olsa <jolsa@kernel.org>
    Cc: kernel@pengutronix.de
    Cc: patchwork-lst@pengutronix.de
    Link: http://lkml.kernel.org/r/1458235670-27341-1-git-send-email-l.stach@pengutronix.de
    Signed-off-by: Arnaldo Carvalho de Melo <acme@redhat.com>

commit e771e0a1e4d5566c857ad312de3fd95b955df871
Author: Krzysztof Kozlowski <k.kozlowski@samsung.com>
Date:   Wed Mar 30 09:49:48 2016 +0900

    power: reset: keystone: Enable COMPILE_TEST
    
    Enable the COMPILE_TEST to get build coverage, except on platforms
    !HAS_IOMEM (required by selected MFD_SYSCON).
    
    Signed-off-by: Krzysztof Kozlowski <k.kozlowski@samsung.com>
    Signed-off-by: Sebastian Reichel <sre@kernel.org>

commit 20b5b7f3c2df2fb69b3b27dc83314b8891614ba5
Author: Nicolai Stange <nicstange@gmail.com>
Date:   Thu May 26 23:19:55 2016 +0200

    lib/mpi: refactor mpi_read_from_buffer() in terms of mpi_read_raw_data()
    
    mpi_read_from_buffer() and mpi_read_raw_data() do basically the same thing
    except that the former extracts the number of payload bits from the first
    two bytes of the input buffer.
    
    Besides that, the data copying logic is exactly the same.
    
    Replace the open coded buffer to MPI instance conversion by a call to
    mpi_read_raw_data().
    
    Signed-off-by: Nicolai Stange <nicstange@gmail.com>
    Signed-off-by: Herbert Xu <herbert@gondor.apana.org.au>

commit 7af791e0f0d00c14f01ba2ffe3b6e2b50a35fc6f
Author: Nicolai Stange <nicstange@gmail.com>
Date:   Thu May 26 23:19:53 2016 +0200

    lib/mpi: mpi_read_from_buffer(): return -EINVAL upon too short buffer
    
    Currently, if the input buffer is shorter than the expected length as
    indicated by its first two bytes, an MPI instance of this expected length
    will be allocated and filled with as much data as is available. The rest
    will remain uninitialized.
    
    Instead of leaving this condition undetected, an error code should be
    reported to the caller.
    
    Since this situation indicates that the input buffer's first two bytes,
    encoding the number of expected bits, are garbled, -EINVAL is appropriate
    here.
    
    If the input buffer is shorter than indicated by its first two bytes,
    make mpi_read_from_buffer() return -EINVAL.
    Get rid of the 'nread' variable: with the new semantics, the total number
    of bytes read from the input buffer is known in advance.
    
    Signed-off-by: Nicolai Stange <nicstange@gmail.com>
    Signed-off-by: Herbert Xu <herbert@gondor.apana.org.au>

commit 03cdfaad491e82e4a66593c6e149ddae0421df59
Author: Nicolai Stange <nicstange@gmail.com>
Date:   Thu May 26 23:19:51 2016 +0200

    lib/mpi: mpi_read_from_buffer(): return error code
    
    mpi_read_from_buffer() reads a MPI from a buffer into a newly allocated
    MPI instance. It expects the buffer's leading two bytes to contain the
    number of bits, followed by the actual payload.
    
    On failure, it returns NULL and updates the in/out argument ret_nread
    somewhat inconsistently:
    - If the given buffer is too short to contain the leading two bytes
      encoding the number of bits or their value is unsupported, then
      ret_nread will be cleared.
    - If the allocation of the resulting MPI instance fails, ret_nread is left
      as is.
    
    The only user of mpi_read_from_buffer(), digsig_verify_rsa(), simply checks
    for a return value of NULL and returns -ENOMEM if that happens.
    
    While this is all of cosmetic nature only, there is another error condition
    which currently isn't detectable by the caller of mpi_read_from_buffer():
    if the given buffer is too small to hold the number of bits as encoded in
    its first two bytes, the return value will be non-NULL and *ret_nread > 0.
    
    In preparation of communicating this condition to the caller, let
    mpi_read_from_buffer() return error values by means of the ERR_PTR()
    mechanism.
    
    Make the sole caller of mpi_read_from_buffer(), digsig_verify_rsa(),
    check the return value for IS_ERR() rather than == NULL. If IS_ERR() is
    true, return the associated error value rather than the fixed -ENOMEM.
    
    Signed-off-by: Nicolai Stange <nicstange@gmail.com>
    Signed-off-by: Herbert Xu <herbert@gondor.apana.org.au>

commit eef0df6a59537032ab6b708f30b28d9530f8760e
Author: Nicolai Stange <nicstange@gmail.com>
Date:   Thu May 26 13:05:32 2016 +0200

    lib/mpi: mpi_read_raw_data(): fix nbits calculation
    
    The number of bits, nbits, is calculated in mpi_read_raw_data() as follows:
    
      nbits = nbytes * 8;
    
    Afterwards, the number of leading zero bits of the first byte get
    subtracted:
    
      nbits -= count_leading_zeros(buffer[0]);
    
    However, count_leading_zeros() takes an unsigned long and thus,
    the u8 gets promoted to an unsigned long.
    
    Thus, the above doesn't subtract the number of leading zeros in the most
    significant nonzero input byte from nbits, but the number of leading
    zeros of the most significant nonzero input byte promoted to unsigned long,
    i.e. BITS_PER_LONG - 8 too many.
    
    Fix this by subtracting
    
      count_leading_zeros(...) - (BITS_PER_LONG - 8)
    
    from nbits only.
    
    Fixes: e1045992949 ("MPILIB: Provide a function to read raw data into an
                         MPI")
    Signed-off-by: Nicolai Stange <nicstange@gmail.com>
    Signed-off-by: Herbert Xu <herbert@gondor.apana.org.au>

commit 9479f7cc91879c6ba75e70da41c4c9fe7842b342
Author: Krzysztof Kozlowski <k.kozlowski@samsung.com>
Date:   Tue May 10 16:31:26 2016 +0200

    soc: samsung: pm_domains: Enable COMPILE_TEST for build coverage
    
    Introduce a platform selectable symbol EXYNOS_PM_DOMAINS which can be
    also toggled on by COMPILE_TEST for some build coverage.
    
    Signed-off-by: Krzysztof Kozlowski <k.kozlowski@samsung.com>

commit 34ea4b4a827b4ee76295501b7df61fc904ab8ae3
Author: Geert Uytterhoeven <geert+renesas@glider.be>
Date:   Fri May 20 09:09:59 2016 +0200

    ARM: dts: r8a7794: Fix W=1 dtc warnings
    
    Warning (unit_address_vs_reg): Node /cache-controller@1 has a unit name, but no reg property
    
    Move the cache-controller node under the cpus node, and make its unit
    name and reg property match the MPIDR value.
    
    Signed-off-by: Geert Uytterhoeven <geert+renesas@glider.be>
    Signed-off-by: Simon Horman <horms+renesas@verge.net.au>

commit ad53f5f00b095a0d42b65bf578eb1c1b026c5b99
Author: Geert Uytterhoeven <geert+renesas@glider.be>
Date:   Fri May 20 09:09:58 2016 +0200

    ARM: dts: r8a7793: Fix W=1 dtc warnings
    
    Warning (unit_address_vs_reg): Node /cache-controller@0 has a unit name, but no reg property
    Warning (unit_address_vs_reg): Node /sound@ec500000/rcar_sound,dvc/dvc@0 has a unit name, but no reg property
    Warning (unit_address_vs_reg): Node /sound@ec500000/rcar_sound,dvc/dvc@1 has a unit name, but no reg property
    Warning (unit_address_vs_reg): Node /sound@ec500000/rcar_sound,src/src@0 has a unit name, but no reg property
    Warning (unit_address_vs_reg): Node /sound@ec500000/rcar_sound,src/src@1 has a unit name, but no reg property
    Warning (unit_address_vs_reg): Node /sound@ec500000/rcar_sound,src/src@2 has a unit name, but no reg property
    Warning (unit_address_vs_reg): Node /sound@ec500000/rcar_sound,src/src@3 has a unit name, but no reg property
    Warning (unit_address_vs_reg): Node /sound@ec500000/rcar_sound,src/src@4 has a unit name, but no reg property
    Warning (unit_address_vs_reg): Node /sound@ec500000/rcar_sound,src/src@5 has a unit name, but no reg property
    Warning (unit_address_vs_reg): Node /sound@ec500000/rcar_sound,src/src@6 has a unit name, but no reg property
    Warning (unit_address_vs_reg): Node /sound@ec500000/rcar_sound,src/src@7 has a unit name, but no reg property
    Warning (unit_address_vs_reg): Node /sound@ec500000/rcar_sound,src/src@8 has a unit name, but no reg property
    Warning (unit_address_vs_reg): Node /sound@ec500000/rcar_sound,src/src@9 has a unit name, but no reg property
    Warning (unit_address_vs_reg): Node /sound@ec500000/rcar_sound,ssi/ssi@0 has a unit name, but no reg property
    Warning (unit_address_vs_reg): Node /sound@ec500000/rcar_sound,ssi/ssi@1 has a unit name, but no reg property
    Warning (unit_address_vs_reg): Node /sound@ec500000/rcar_sound,ssi/ssi@2 has a unit name, but no reg property
    Warning (unit_address_vs_reg): Node /sound@ec500000/rcar_sound,ssi/ssi@3 has a unit name, but no reg property
    Warning (unit_address_vs_reg): Node /sound@ec500000/rcar_sound,ssi/ssi@4 has a unit name, but no reg property
    Warning (unit_address_vs_reg): Node /sound@ec500000/rcar_sound,ssi/ssi@5 has a unit name, but no reg property
    Warning (unit_address_vs_reg): Node /sound@ec500000/rcar_sound,ssi/ssi@6 has a unit name, but no reg property
    Warning (unit_address_vs_reg): Node /sound@ec500000/rcar_sound,ssi/ssi@7 has a unit name, but no reg property
    Warning (unit_address_vs_reg): Node /sound@ec500000/rcar_sound,ssi/ssi@8 has a unit name, but no reg property
    Warning (unit_address_vs_reg): Node /sound@ec500000/rcar_sound,ssi/ssi@9 has a unit name, but no reg property
    
    Move the cache-controller node under the cpus node, and make its unit
    name and reg property match the MPIDR values.
    
    Signed-off-by: Geert Uytterhoeven <geert+renesas@glider.be>
    Signed-off-by: Simon Horman <horms+renesas@verge.net.au>

commit 6f9314ce258c8504975d96fa509763245fff287b
Author: Geert Uytterhoeven <geert+renesas@glider.be>
Date:   Fri May 20 09:09:57 2016 +0200

    ARM: dts: r8a7791: Fix W=1 dtc warnings
    
    Warning (unit_address_vs_reg): Node /cache-controller@0 has a unit name, but no reg property
    Warning (unit_address_vs_reg): Node /sound@ec500000/rcar_sound,dvc/dvc@0 has a unit name, but no reg property
    Warning (unit_address_vs_reg): Node /sound@ec500000/rcar_sound,dvc/dvc@1 has a unit name, but no reg property
    Warning (unit_address_vs_reg): Node /sound@ec500000/rcar_sound,mix/mix@0 has a unit name, but no reg property
    Warning (unit_address_vs_reg): Node /sound@ec500000/rcar_sound,mix/mix@1 has a unit name, but no reg property
    Warning (unit_address_vs_reg): Node /sound@ec500000/rcar_sound,ctu/ctu@0 has a unit name, but no reg property
    Warning (unit_address_vs_reg): Node /sound@ec500000/rcar_sound,ctu/ctu@1 has a unit name, but no reg property
    Warning (unit_address_vs_reg): Node /sound@ec500000/rcar_sound,ctu/ctu@2 has a unit name, but no reg property
    Warning (unit_address_vs_reg): Node /sound@ec500000/rcar_sound,ctu/ctu@3 has a unit name, but no reg property
    Warning (unit_address_vs_reg): Node /sound@ec500000/rcar_sound,ctu/ctu@4 has a unit name, but no reg property
    Warning (unit_address_vs_reg): Node /sound@ec500000/rcar_sound,ctu/ctu@5 has a unit name, but no reg property
    Warning (unit_address_vs_reg): Node /sound@ec500000/rcar_sound,ctu/ctu@6 has a unit name, but no reg property
    Warning (unit_address_vs_reg): Node /sound@ec500000/rcar_sound,ctu/ctu@7 has a unit name, but no reg property
    Warning (unit_address_vs_reg): Node /sound@ec500000/rcar_sound,src/src@0 has a unit name, but no reg property
    Warning (unit_address_vs_reg): Node /sound@ec500000/rcar_sound,src/src@1 has a unit name, but no reg property
    Warning (unit_address_vs_reg): Node /sound@ec500000/rcar_sound,src/src@2 has a unit name, but no reg property
    Warning (unit_address_vs_reg): Node /sound@ec500000/rcar_sound,src/src@3 has a unit name, but no reg property
    Warning (unit_address_vs_reg): Node /sound@ec500000/rcar_sound,src/src@4 has a unit name, but no reg property
    Warning (unit_address_vs_reg): Node /sound@ec500000/rcar_sound,src/src@5 has a unit name, but no reg property
    Warning (unit_address_vs_reg): Node /sound@ec500000/rcar_sound,src/src@6 has a unit name, but no reg property
    Warning (unit_address_vs_reg): Node /sound@ec500000/rcar_sound,src/src@7 has a unit name, but no reg property
    Warning (unit_address_vs_reg): Node /sound@ec500000/rcar_sound,src/src@8 has a unit name, but no reg property
    Warning (unit_address_vs_reg): Node /sound@ec500000/rcar_sound,src/src@9 has a unit name, but no reg property
    Warning (unit_address_vs_reg): Node /sound@ec500000/rcar_sound,ssi/ssi@0 has a unit name, but no reg property
    Warning (unit_address_vs_reg): Node /sound@ec500000/rcar_sound,ssi/ssi@1 has a unit name, but no reg property
    Warning (unit_address_vs_reg): Node /sound@ec500000/rcar_sound,ssi/ssi@2 has a unit name, but no reg property
    Warning (unit_address_vs_reg): Node /sound@ec500000/rcar_sound,ssi/ssi@3 has a unit name, but no reg property
    Warning (unit_address_vs_reg): Node /sound@ec500000/rcar_sound,ssi/ssi@4 has a unit name, but no reg property
    Warning (unit_address_vs_reg): Node /sound@ec500000/rcar_sound,ssi/ssi@5 has a unit name, but no reg property
    Warning (unit_address_vs_reg): Node /sound@ec500000/rcar_sound,ssi/ssi@6 has a unit name, but no reg property
    Warning (unit_address_vs_reg): Node /sound@ec500000/rcar_sound,ssi/ssi@7 has a unit name, but no reg property
    Warning (unit_address_vs_reg): Node /sound@ec500000/rcar_sound,ssi/ssi@8 has a unit name, but no reg property
    Warning (unit_address_vs_reg): Node /sound@ec500000/rcar_sound,ssi/ssi@9 has a unit name, but no reg property
    Warning (unit_address_vs_reg): Node /cache-controller@0 has a unit name, but no reg property
    Warning (unit_address_vs_reg): Node /sound@ec500000/rcar_sound,dvc/dvc@0 has a unit name, but no reg property
    Warning (unit_address_vs_reg): Node /sound@ec500000/rcar_sound,dvc/dvc@1 has a unit name, but no reg property
    Warning (unit_address_vs_reg): Node /sound@ec500000/rcar_sound,mix/mix@0 has a unit name, but no reg property
    Warning (unit_address_vs_reg): Node /sound@ec500000/rcar_sound,mix/mix@1 has a unit name, but no reg property
    Warning (unit_address_vs_reg): Node /sound@ec500000/rcar_sound,ctu/ctu@0 has a unit name, but no reg property
    Warning (unit_address_vs_reg): Node /sound@ec500000/rcar_sound,ctu/ctu@1 has a unit name, but no reg property
    Warning (unit_address_vs_reg): Node /sound@ec500000/rcar_sound,ctu/ctu@2 has a unit name, but no reg property
    Warning (unit_address_vs_reg): Node /sound@ec500000/rcar_sound,ctu/ctu@3 has a unit name, but no reg property
    Warning (unit_address_vs_reg): Node /sound@ec500000/rcar_sound,ctu/ctu@4 has a unit name, but no reg property
    Warning (unit_address_vs_reg): Node /sound@ec500000/rcar_sound,ctu/ctu@5 has a unit name, but no reg property
    Warning (unit_address_vs_reg): Node /sound@ec500000/rcar_sound,ctu/ctu@6 has a unit name, but no reg property
    Warning (unit_address_vs_reg): Node /sound@ec500000/rcar_sound,ctu/ctu@7 has a unit name, but no reg property
    Warning (unit_address_vs_reg): Node /sound@ec500000/rcar_sound,src/src@0 has a unit name, but no reg property
    Warning (unit_address_vs_reg): Node /sound@ec500000/rcar_sound,src/src@1 has a unit name, but no reg property
    Warning (unit_address_vs_reg): Node /sound@ec500000/rcar_sound,src/src@2 has a unit name, but no reg property
    Warning (unit_address_vs_reg): Node /sound@ec500000/rcar_sound,src/src@3 has a unit name, but no reg property
    Warning (unit_address_vs_reg): Node /sound@ec500000/rcar_sound,src/src@4 has a unit name, but no reg property
    Warning (unit_address_vs_reg): Node /sound@ec500000/rcar_sound,src/src@5 has a unit name, but no reg property
    Warning (unit_address_vs_reg): Node /sound@ec500000/rcar_sound,src/src@6 has a unit name, but no reg property
    Warning (unit_address_vs_reg): Node /sound@ec500000/rcar_sound,src/src@7 has a unit name, but no reg property
    Warning (unit_address_vs_reg): Node /sound@ec500000/rcar_sound,src/src@8 has a unit name, but no reg property
    Warning (unit_address_vs_reg): Node /sound@ec500000/rcar_sound,src/src@9 has a unit name, but no reg property
    Warning (unit_address_vs_reg): Node /sound@ec500000/rcar_sound,ssi/ssi@0 has a unit name, but no reg property
    Warning (unit_address_vs_reg): Node /sound@ec500000/rcar_sound,ssi/ssi@1 has a unit name, but no reg property
    Warning (unit_address_vs_reg): Node /sound@ec500000/rcar_sound,ssi/ssi@2 has a unit name, but no reg property
    Warning (unit_address_vs_reg): Node /sound@ec500000/rcar_sound,ssi/ssi@3 has a unit name, but no reg property
    Warning (unit_address_vs_reg): Node /sound@ec500000/rcar_sound,ssi/ssi@4 has a unit name, but no reg property
    Warning (unit_address_vs_reg): Node /sound@ec500000/rcar_sound,ssi/ssi@5 has a unit name, but no reg property
    Warning (unit_address_vs_reg): Node /sound@ec500000/rcar_sound,ssi/ssi@6 has a unit name, but no reg property
    Warning (unit_address_vs_reg): Node /sound@ec500000/rcar_sound,ssi/ssi@7 has a unit name, but no reg property
    Warning (unit_address_vs_reg): Node /sound@ec500000/rcar_sound,ssi/ssi@8 has a unit name, but no reg property
    Warning (unit_address_vs_reg): Node /sound@ec500000/rcar_sound,ssi/ssi@9 has a unit name, but no reg property
    
    Move the cache-controller node under the cpus node, and make its unit
    name and reg property match the MPIDR values.
    
    Signed-off-by: Geert Uytterhoeven <geert+renesas@glider.be>
    Signed-off-by: Simon Horman <horms+renesas@verge.net.au>

commit 2c3de36700d4f3a5da1eb67e9340bfccfce19fdb
Author: Geert Uytterhoeven <geert+renesas@glider.be>
Date:   Fri May 20 09:09:56 2016 +0200

    ARM: dts: r8a7790: Fix W=1 dtc warnings
    
    Warning (unit_address_vs_reg): Node /cache-controller@0 has a unit name, but no reg property
    Warning (unit_address_vs_reg): Node /cache-controller@1 has a unit name, but no reg property
    Warning (unit_address_vs_reg): Node /sound@ec500000/rcar_sound,dvc/dvc@0 has a unit name, but no reg property
    Warning (unit_address_vs_reg): Node /sound@ec500000/rcar_sound,dvc/dvc@1 has a unit name, but no reg property
    Warning (unit_address_vs_reg): Node /sound@ec500000/rcar_sound,mix/mix@0 has a unit name, but no reg property
    Warning (unit_address_vs_reg): Node /sound@ec500000/rcar_sound,mix/mix@1 has a unit name, but no reg property
    Warning (unit_address_vs_reg): Node /sound@ec500000/rcar_sound,ctu/ctu@0 has a unit name, but no reg property
    Warning (unit_address_vs_reg): Node /sound@ec500000/rcar_sound,ctu/ctu@1 has a unit name, but no reg property
    Warning (unit_address_vs_reg): Node /sound@ec500000/rcar_sound,ctu/ctu@2 has a unit name, but no reg property
    Warning (unit_address_vs_reg): Node /sound@ec500000/rcar_sound,ctu/ctu@3 has a unit name, but no reg property
    Warning (unit_address_vs_reg): Node /sound@ec500000/rcar_sound,ctu/ctu@4 has a unit name, but no reg property
    Warning (unit_address_vs_reg): Node /sound@ec500000/rcar_sound,ctu/ctu@5 has a unit name, but no reg property
    Warning (unit_address_vs_reg): Node /sound@ec500000/rcar_sound,ctu/ctu@6 has a unit name, but no reg property
    Warning (unit_address_vs_reg): Node /sound@ec500000/rcar_sound,ctu/ctu@7 has a unit name, but no reg property
    Warning (unit_address_vs_reg): Node /sound@ec500000/rcar_sound,src/src@0 has a unit name, but no reg property
    Warning (unit_address_vs_reg): Node /sound@ec500000/rcar_sound,src/src@1 has a unit name, but no reg property
    Warning (unit_address_vs_reg): Node /sound@ec500000/rcar_sound,src/src@2 has a unit name, but no reg property
    Warning (unit_address_vs_reg): Node /sound@ec500000/rcar_sound,src/src@3 has a unit name, but no reg property
    Warning (unit_address_vs_reg): Node /sound@ec500000/rcar_sound,src/src@4 has a unit name, but no reg property
    Warning (unit_address_vs_reg): Node /sound@ec500000/rcar_sound,src/src@5 has a unit name, but no reg property
    Warning (unit_address_vs_reg): Node /sound@ec500000/rcar_sound,src/src@6 has a unit name, but no reg property
    Warning (unit_address_vs_reg): Node /sound@ec500000/rcar_sound,src/src@7 has a unit name, but no reg property
    Warning (unit_address_vs_reg): Node /sound@ec500000/rcar_sound,src/src@8 has a unit name, but no reg property
    Warning (unit_address_vs_reg): Node /sound@ec500000/rcar_sound,src/src@9 has a unit name, but no reg property
    Warning (unit_address_vs_reg): Node /sound@ec500000/rcar_sound,ssi/ssi@0 has a unit name, but no reg property
    Warning (unit_address_vs_reg): Node /sound@ec500000/rcar_sound,ssi/ssi@1 has a unit name, but no reg property
    Warning (unit_address_vs_reg): Node /sound@ec500000/rcar_sound,ssi/ssi@2 has a unit name, but no reg property
    Warning (unit_address_vs_reg): Node /sound@ec500000/rcar_sound,ssi/ssi@3 has a unit name, but no reg property
    Warning (unit_address_vs_reg): Node /sound@ec500000/rcar_sound,ssi/ssi@4 has a unit name, but no reg property
    Warning (unit_address_vs_reg): Node /sound@ec500000/rcar_sound,ssi/ssi@5 has a unit name, but no reg property
    Warning (unit_address_vs_reg): Node /sound@ec500000/rcar_sound,ssi/ssi@6 has a unit name, but no reg property
    Warning (unit_address_vs_reg): Node /sound@ec500000/rcar_sound,ssi/ssi@7 has a unit name, but no reg property
    Warning (unit_address_vs_reg): Node /sound@ec500000/rcar_sound,ssi/ssi@8 has a unit name, but no reg property
    Warning (unit_address_vs_reg): Node /sound@ec500000/rcar_sound,ssi/ssi@9 has a unit name, but no reg property
    
    Move the cache-controller nodes under the cpus node, and make their unit
    names and reg properties match the MPIDR values.
    
    Signed-off-by: Geert Uytterhoeven <geert+renesas@glider.be>
    Signed-off-by: Simon Horman <horms+renesas@verge.net.au>

commit b0da45c60d2f7b08128a6cd1216ac0ac7d8954c7
Author: Geert Uytterhoeven <geert+renesas@glider.be>
Date:   Fri May 20 09:09:53 2016 +0200

    ARM: dts: r8a73a4: Fix W=1 dtc warnings
    
    Warning (unit_address_vs_reg): Node /cache-controller@0 has a unit name, but no reg property
    Warning (unit_address_vs_reg): Node /cache-controller@1 has a unit name, but no reg property
    
    Move the cache-controller nodes under the cpus node, and make their
    unit names and reg properties match the MPIDR values.
    
    Signed-off-by: Geert Uytterhoeven <geert+renesas@glider.be>
    Signed-off-by: Simon Horman <horms+renesas@verge.net.au>

commit 6f7bf82cc912441f5824f0b1a6497164e5ebe079
Author: Geert Uytterhoeven <geert+renesas@glider.be>
Date:   Fri May 20 09:10:13 2016 +0200

    arm64: dts: r8a7795: Fix W=1 dtc warnings
    
    Warning (unit_address_vs_reg): Node /cache-controller@0 has a unit name, but no reg property
    Warning (unit_address_vs_reg): Node /cache-controller@1 has a unit name, but no reg property
    Warning (unit_address_vs_reg): Node /soc/sound@ec500000/rcar_sound,dvc/dvc@0 has a unit name, but no reg property
    Warning (unit_address_vs_reg): Node /soc/sound@ec500000/rcar_sound,dvc/dvc@1 has a unit name, but no reg property
    Warning (unit_address_vs_reg): Node /soc/sound@ec500000/rcar_sound,src/src@0 has a unit name, but no reg property
    Warning (unit_address_vs_reg): Node /soc/sound@ec500000/rcar_sound,src/src@1 has a unit name, but no reg property
    Warning (unit_address_vs_reg): Node /soc/sound@ec500000/rcar_sound,src/src@2 has a unit name, but no reg property
    Warning (unit_address_vs_reg): Node /soc/sound@ec500000/rcar_sound,src/src@3 has a unit name, but no reg property
    Warning (unit_address_vs_reg): Node /soc/sound@ec500000/rcar_sound,src/src@4 has a unit name, but no reg property
    Warning (unit_address_vs_reg): Node /soc/sound@ec500000/rcar_sound,src/src@5 has a unit name, but no reg property
    Warning (unit_address_vs_reg): Node /soc/sound@ec500000/rcar_sound,src/src@6 has a unit name, but no reg property
    Warning (unit_address_vs_reg): Node /soc/sound@ec500000/rcar_sound,src/src@7 has a unit name, but no reg property
    Warning (unit_address_vs_reg): Node /soc/sound@ec500000/rcar_sound,src/src@8 has a unit name, but no reg property
    Warning (unit_address_vs_reg): Node /soc/sound@ec500000/rcar_sound,src/src@9 has a unit name, but no reg property
    Warning (unit_address_vs_reg): Node /soc/sound@ec500000/rcar_sound,ssi/ssi@0 has a unit name, but no reg property
    Warning (unit_address_vs_reg): Node /soc/sound@ec500000/rcar_sound,ssi/ssi@1 has a unit name, but no reg property
    Warning (unit_address_vs_reg): Node /soc/sound@ec500000/rcar_sound,ssi/ssi@2 has a unit name, but no reg property
    Warning (unit_address_vs_reg): Node /soc/sound@ec500000/rcar_sound,ssi/ssi@3 has a unit name, but no reg property
    Warning (unit_address_vs_reg): Node /soc/sound@ec500000/rcar_sound,ssi/ssi@4 has a unit name, but no reg property
    Warning (unit_address_vs_reg): Node /soc/sound@ec500000/rcar_sound,ssi/ssi@5 has a unit name, but no reg property
    Warning (unit_address_vs_reg): Node /soc/sound@ec500000/rcar_sound,ssi/ssi@6 has a unit name, but no reg property
    Warning (unit_address_vs_reg): Node /soc/sound@ec500000/rcar_sound,ssi/ssi@7 has a unit name, but no reg property
    Warning (unit_address_vs_reg): Node /soc/sound@ec500000/rcar_sound,ssi/ssi@8 has a unit name, but no reg property
    Warning (unit_address_vs_reg): Node /soc/sound@ec500000/rcar_sound,ssi/ssi@9 has a unit name, but no reg property
    
    Move the cache-controller nodes under the cpus node, and make their unit
    names and reg properties match the MPIDR values.
    
    Signed-off-by: Geert Uytterhoeven <geert+renesas@glider.be>
    Signed-off-by: Simon Horman <horms+renesas@verge.net.au>

commit 5b26fc8824da15a2fe9df89338a5a3cad41ba8ee
Merge: e12fab28df1d c9c6837d3931
Author: Linus Torvalds <torvalds@linux-foundation.org>
Date:   Thu May 26 22:01:22 2016 -0700

    Merge branch 'kbuild' of git://git.kernel.org/pub/scm/linux/kernel/git/mmarek/kbuild
    
    Pull kbuild updates from Michal Marek:
    
     - new option CONFIG_TRIM_UNUSED_KSYMS which does a two-pass build and
       unexports symbols which are not used in the current config [Nicolas
       Pitre]
    
     - several kbuild rule cleanups [Masahiro Yamada]
    
     - warning option adjustments for gcov etc [Arnd Bergmann]
    
     - a few more small fixes
    
    * 'kbuild' of git://git.kernel.org/pub/scm/linux/kernel/git/mmarek/kbuild: (31 commits)
      kbuild: move -Wunused-const-variable to W=1 warning level
      kbuild: fix if_change and friends to consider argument order
      kbuild: fix adjust_autoksyms.sh for modules that need only one symbol
      kbuild: fix ksym_dep_filter when multiple EXPORT_SYMBOL() on the same line
      gcov: disable -Wmaybe-uninitialized warning
      gcov: disable tree-loop-im to reduce stack usage
      gcov: disable for COMPILE_TEST
      Kbuild: disable 'maybe-uninitialized' warning for CONFIG_PROFILE_ALL_BRANCHES
      Kbuild: change CC_OPTIMIZE_FOR_SIZE definition
      kbuild: forbid kernel directory to contain spaces and colons
      kbuild: adjust ksym_dep_filter for some cmd_* renames
      kbuild: Fix dependencies for final vmlinux link
      kbuild: better abstract vmlinux sequential prerequisites
      kbuild: fix call to adjust_autoksyms.sh when output directory specified
      kbuild: Get rid of KBUILD_STR
      kbuild: rename cmd_as_s_S to cmd_cpp_s_S
      kbuild: rename cmd_cc_i_c to cmd_cpp_i_c
      kbuild: drop redundant "PHONY += FORCE"
      kbuild: delete unnecessary "@:"
      kbuild: mark help target as PHONY
      ...

commit ffd565e315aa8211365bb6864000f04e7b277f59
Author: Arnd Bergmann <arnd@arndb.de>
Date:   Thu May 12 23:03:35 2016 +0200

    irqchip: nps: add 64BIT dependency
    
    The newly added nps irqchip driver causes build warnings on ARM64.
    
      include/soc/nps/common.h: In function 'nps_host_reg_non_cl':
      include/soc/nps/common.h:148:9: warning: cast to pointer from integer of different size [-Wint-to-pointer-cast]
    
    As the driver is only used on ARC, we don't need to see it without
    COMPILE_TEST elsewhere, and we can avoid the warnings by only building
    on 32-bit architectures even with CONFIG_COMPILE_TEST.
    
    Acked-by: Marc Zyngier <narc.zyngier@arm.com>
    Signed-off-by: Arnd Bergmann <arnd@arndb.de>
    Signed-off-by: Vineet Gupta <vgupta@synopsys.com>
    Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>

commit 78a714aba030395e72d03f0ff8a4c1481956e808
Author: Andre Przywara <andre.przywara@arm.com>
Date:   Mon Jan 25 16:45:37 2016 +0000

    KVM: arm/arm64: vgic-new: Add GICv3 IROUTER register handlers
    
    Since GICv3 supports much more than the 8 CPUs the GICv2 ITARGETSR
    register can handle, the new IROUTER register covers the whole range
    of possible target (V)CPUs by using the same MPIDR that the cores
    report themselves.
    In addition to translating this MPIDR into a vcpu pointer we store
    the originally written value as well. The architecture allows to
    write any values into the register, which must be read back as written.
    
    Since we don't support affinity level 3, we don't need to take care
    about the upper word of this 64-bit register, which simplifies the
    handling a bit.
    
    Signed-off-by: Andre Przywara <andre.przywara@arm.com>
    Reviewed-by: Christoffer Dall <christoffer.dall@linaro.org>

commit 741972d8a69ce748d84dfe0d68403054dfcae657
Author: Andre Przywara <andre.przywara@arm.com>
Date:   Wed Jan 27 14:54:46 2016 +0000

    KVM: arm/arm64: vgic-new: Add GICv3 redistributor IIDR and TYPER handler
    
    The redistributor TYPER tells the OS about the associated MPIDR,
    also the LAST bit is crucial to determine the number of redistributors.
    
    Signed-off-by: Andre Przywara <andre.przywara@arm.com>
    Reviewed-by: Christoffer Dall <christoffer.dall@linaro.org>

commit c32feb03aefa8c5aada929ad10fd8aa569ef45cd
Author: Arnd Bergmann <arnd@arndb.de>
Date:   Thu May 19 09:14:53 2016 -0700

    Input: migor-ts - mark PM functions as __maybe_unused
    
    The migor touchscreen driver is now available for COMPILE_TEST,
    so we run into a harmless randconfig warning on ARM when CONFIG_PM
    is disabled:
    
    drivers/input/touchscreen/migor_ts.c:216:12: error: 'migor_ts_resume' defined but not used [-Werror=unused-function]
    drivers/input/touchscreen/migor_ts.c:205:12: error: 'migor_ts_suspend' defined but not used [-Werror=unused-function]
    
    This shuts up the warning by marking the two functions as __maybe_unused.
    We could do the same thing by adding an #ifdef, but this version is
    more reliable.
    
    Signed-off-by: Arnd Bergmann <arnd@arndb.de>
    Signed-off-by: Dmitry Torokhov <dmitry.torokhov@gmail.com>

commit abce15380084050ccfb9326ce1bcf10b7b83d2c9
Author: David Howells <dhowells@redhat.com>
Date:   Wed Aug 5 12:54:46 2015 +0100

    ASN.1: Fix non-match detection failure on data overrun
    
    commit 0d62e9dd6da45bbf0f33a8617afc5fe774c8f45f upstream.
    
    If the ASN.1 decoder is asked to parse a sequence of objects, non-optional
    matches get skipped if there's no more data to be had rather than a
    data-overrun error being reported.
    
    This is due to the code segment that decides whether to skip optional
    matches (ie. matches that could get ignored because an element is marked
    OPTIONAL in the grammar) due to a lack of data also skips non-optional
    elements if the data pointer has reached the end of the buffer.
    
    This can be tested with the data decoder for the new RSA akcipher algorithm
    that takes three non-optional integers.  Currently, it skips the last
    integer if there is insufficient data.
    
    Without the fix, #defining DEBUG in asn1_decoder.c will show something
    like:
    
            next_op: pc=0/13 dp=0/270 C=0 J=0
            - match? 30 30 00
            - TAG: 30 266 CONS
            next_op: pc=2/13 dp=4/270 C=1 J=0
            - match? 02 02 00
            - TAG: 02 257
            - LEAF: 257
            next_op: pc=5/13 dp=265/270 C=1 J=0
            - match? 02 02 00
            - TAG: 02 3
            - LEAF: 3
            next_op: pc=8/13 dp=270/270 C=1 J=0
            next_op: pc=11/13 dp=270/270 C=1 J=0
            - end cons t=4 dp=270 l=270/270
    
    The next_op line for pc=8/13 should be followed by a match line.
    
    This is not exploitable for X.509 certificates by means of shortening the
    message and fixing up the ASN.1 CONS tags because:
    
     (1) The relevant records being built up are cleared before use.
    
     (2) If the message is shortened sufficiently to remove the public key, the
         ASN.1 parse of the RSA key will fail quickly due to a lack of data.
    
     (3) Extracted signature data is either turned into MPIs (which cope with a
         0 length) or is simpler integers specifying algoritms and suchlike
         (which can validly be 0); and
    
     (4) The AKID and SKID extensions are optional and their removal is handled
         without risking passing a NULL to asymmetric_key_generate_id().
    
     (5) If the certificate is truncated sufficiently to remove the subject,
         issuer or serialNumber then the ASN.1 decoder will fail with a 'Cons
         stack underflow' return.
    
    This is not exploitable for PKCS#7 messages by means of removal of elements
    from such a message from the tail end of a sequence:
    
     (1) Any shortened X.509 certs embedded in the PKCS#7 message are survivable
         as detailed above.
    
     (2) The message digest content isn't used if it shows a NULL pointer,
         similarly, the authattrs aren't used if that shows a NULL pointer.
    
     (3) A missing signature results in a NULL MPI - which the MPI routines deal
         with.
    
     (4) If data is NULL, it is expected that the message has detached content and
         that is handled appropriately.
    
     (5) If the serialNumber is excised, the unconditional action associated
         with it will pick up the containing SEQUENCE instead, so no NULL
         pointer will be seen here.
    
         If both the issuer and the serialNumber are excised, the ASN.1 decode
         will fail with an 'Unexpected tag' return.
    
         In either case, there's no way to get to asymmetric_key_generate_id()
         with a NULL pointer.
    
     (6) Other fields are decoded to simple integers.  Shortening the message
         to omit an algorithm ID field will cause checks on this to fail early
         in the verification process.
    
    This can also be tested by snipping objects off of the end of the ASN.1 stream
    such that mandatory tags are removed - or even from the end of internal
    SEQUENCEs.  If any mandatory tag is missing, the error EBADMSG *should* be
    produced.  Without this patch ERANGE or ENOPKG might be produced or the parse
    may apparently succeed, perhaps with ENOKEY or EKEYREJECTED being produced
    later, depending on what gets snipped.
    
    Just snipping off the final BIT_STRING or OCTET_STRING from either sample
    should be a start since both are mandatory and neither will cause an EBADMSG
    without the patches
    
    Reported-by: Marcel Holtmann <marcel@holtmann.org>
    Signed-off-by: David Howells <dhowells@redhat.com>
    Tested-by: Marcel Holtmann <marcel@holtmann.org>
    Reviewed-by: David Woodhouse <David.Woodhouse@intel.com>
    Signed-off-by: Jiri Slaby <jslaby@suse.cz>

commit 675e0655c12209ba1f40af0dff7cd76b17a1315c
Merge: d974f09ea497 e7ca7f9fa2cd
Author: Linus Torvalds <torvalds@linux-foundation.org>
Date:   Wed May 18 16:38:59 2016 -0700

    Merge tag 'scsi-misc' of git://git.kernel.org/pub/scm/linux/kernel/git/jejb/scsi
    
    Pull SCSI updates from James Bottomley:
     "First round of SCSI updates for the 4.6+ merge window.
    
      This batch includes the usual quota of driver updates (bnx2fc, mp3sas,
      hpsa, ncr5380, lpfc, hisi_sas, snic, aacraid, megaraid_sas).  There's
      also a multiqueue update for scsi_debug, assorted bug fixes and a few
      other minor updates (refactor of scsi_sg_pools into generic code, alua
      and VPD updates, and struct timeval conversions)"
    
    * tag 'scsi-misc' of git://git.kernel.org/pub/scm/linux/kernel/git/jejb/scsi: (138 commits)
      mpt3sas: Used "synchronize_irq()"API to synchronize timed-out IO & TMs
      mpt3sas: Set maximum transfer length per IO to 4MB for VDs
      mpt3sas: Updating mpt3sas driver version to 13.100.00.00
      mpt3sas: Fix initial Reference tag field for 4K PI drives.
      mpt3sas: Handle active cable exception event
      mpt3sas: Update MPI header to 2.00.42
      Revert "lpfc: Delete unnecessary checks before the function call mempool_destroy"
      eata_pio: missing break statement
      hpsa: Fix type ZBC conditional checks
      scsi_lib: Decode T10 vendor IDs
      scsi_dh_alua: do not fail for unknown VPD identification
      scsi_debug: use locally assigned naa
      scsi_debug: uuid for lu name
      scsi_debug: vpd and mode page work
      scsi_debug: add multiple queue support
      bfa: fix bfa_fcb_itnim_alloc() error handling
      megaraid_sas: Downgrade two success messages to info
      cxlflash: Fix to resolve dead-lock during EEH recovery
      scsi_debug: rework resp_report_luns
      scsi_debug: use pdt constants
      ...

commit db36ae8516ac70dd3f889f2448b6191f06f15f20
Author: Javier Martinez Canillas <javier@osg.samsung.com>
Date:   Tue May 17 11:10:31 2016 -0700

    Input: migor-ts - allow driver to build if COMPILE_TEST is enabled
    
    The driver only has runtime but no build time dependency with SH_MIGOR, so
    it can be built for testing purposes if the COMPILE_TEST option is enabled.
    
    This is useful to have more build coverage and make sure that drivers are
    not affected by changes that could cause build regressions.
    
    Signed-off-by: Javier Martinez Canillas <javier@osg.samsung.com>
    Signed-off-by: Dmitry Torokhov <dmitry.torokhov@gmail.com>

commit 9a07a7968407e20fe87ed6b5eb6a6000e4819492
Merge: 16490980e396 256b1cfb9a34
Author: Linus Torvalds <torvalds@linux-foundation.org>
Date:   Tue May 17 09:33:39 2016 -0700

    Merge branch 'linus' of git://git.kernel.org/pub/scm/linux/kernel/git/herbert/crypto-2.6
    
    Pull crypto update from Herbert Xu:
     "API:
    
       - Crypto self tests can now be disabled at boot/run time.
       - Add async support to algif_aead.
    
      Algorithms:
    
       - A large number of fixes to MPI from Nicolai Stange.
       - Performance improvement for HMAC DRBG.
    
      Drivers:
    
       - Use generic crypto engine in omap-des.
       - Merge ppc4xx-rng and crypto4xx drivers.
       - Fix lockups in sun4i-ss driver by disabling IRQs.
       - Add DMA engine support to ccp.
       - Reenable talitos hash algorithms.
       - Add support for Hisilicon SoC RNG.
       - Add basic crypto driver for the MXC SCC.
    
      Others:
    
       - Do not allocate crypto hash tfm in NORECLAIM context in ecryptfs"
    
    * 'linus' of git://git.kernel.org/pub/scm/linux/kernel/git/herbert/crypto-2.6: (77 commits)
      crypto: qat - change the adf_ctl_stop_devices to void
      crypto: caam - fix caam_jr_alloc() ret code
      crypto: vmx - comply with ABIs that specify vrsave as reserved.
      crypto: testmgr - Add a flag allowing the self-tests to be disabled at runtime.
      crypto: ccp - constify ccp_actions structure
      crypto: marvell/cesa - Use dma_pool_zalloc
      crypto: qat - make adf_vf_isr.c dependant on IOV config
      crypto: qat - Fix typo in comments
      lib: asn1_decoder - add MODULE_LICENSE("GPL")
      crypto: omap-sham - Use dma_request_chan() for requesting DMA channel
      crypto: omap-des - Use dma_request_chan() for requesting DMA channel
      crypto: omap-aes - Use dma_request_chan() for requesting DMA channel
      crypto: omap-des - Integrate with the crypto engine framework
      crypto: s5p-sss - fix incorrect usage of scatterlists api
      crypto: s5p-sss - Fix missed interrupts when working with 8 kB blocks
      crypto: s5p-sss - Use common BIT macro
      crypto: mxc-scc - fix unwinding in mxc_scc_crypto_register()
      crypto: mxc-scc - signedness bugs in mxc_scc_ablkcipher_req_init()
      crypto: talitos - fix ahash algorithms registration
      crypto: ccp - Ensure all dependencies are specified
      ...

commit a986a05de95b730fd6a00b2b2f82a06d917fd6a2
Author: Arnd Bergmann <arnd@arndb.de>
Date:   Fri May 13 15:09:58 2016 +0200

    net: qrtr: fix build problems
    
    Having multiple loadable modules with the same name cannot work
    with modprobe, and having both net/qrtr/smd.ko and drivers/soc/qcom/smd.ko
    results in a (somewhat cryptic) build error:
    
    ERROR: "qcom_smd_driver_unregister" [net/qrtr/smd.ko] undefined!
    ERROR: "qcom_smd_driver_register" [net/qrtr/smd.ko] undefined!
    ERROR: "qcom_smd_set_drvdata" [net/qrtr/smd.ko] undefined!
    ERROR: "qcom_smd_send" [net/qrtr/smd.ko] undefined!
    ERROR: "qcom_smd_get_drvdata" [net/qrtr/smd.ko] undefined!
    ERROR: "qcom_smd_driver_unregister" [drivers/soc/qcom/wcnss_ctrl.ko] undefined!
    ERROR: "qcom_smd_driver_register" [drivers/soc/qcom/wcnss_ctrl.ko] undefined!
    ERROR: "qcom_smd_set_drvdata" [drivers/soc/qcom/wcnss_ctrl.ko] undefined!
    ERROR: "qcom_smd_send" [drivers/soc/qcom/wcnss_ctrl.ko] undefined!
    ERROR: "qcom_smd_get_drvdata" [drivers/soc/qcom/wcnss_ctrl.ko] undefined!
    
    Also, the qrtr driver uses the SMD interface and has a Kconfig dependency,
    but also allows for compile-testing when SMD is disabled. However, if
    with QCOM_SMD=m and COMPILE_TEST=y we can end up with QRTR_SMD=y and
    that fails with a related link error.
    
    The changes the dependency so we can still compile-test the driver but
    not have it built-in if SMD is a module, to avoid running in the broken
    configuration, and changes the Makefile to provide the driver under
    a different module name.
    
    Signed-off-by: Arnd Bergmann <arnd@arndb.de>
    Fixes: bdabad3e363d ("net: Add Qualcomm IPC router")
    Signed-off-by: David S. Miller <davem@davemloft.net>

commit a470a51cd6481373cdf2b5934b1b9f7853688de9
Author: Chaitra P B <chaitra.basappa@broadcom.com>
Date:   Fri May 6 14:29:27 2016 +0530

    mpt3sas: Handle active cable exception event
    
    In-order to handle this 'MPI2_EVENT_ACTIVE_CABLE_EXCEPTION' event,
    driver need to follow below steps,
    1. Unmask the 'MPI2_EVENT_ACTIVE_CABLE_EXCEPTION' event,
    so that FW can notify this event to host driver.
    2. After receiving this event, add this event to AEN event queue,
    for notifying this event to applications.
    3. Then Print below message in kernel logs if the event data's reason
    code is zero,
    "Currently an active cable with ReceptacleID <ID_Value> cannot be powered
    and devices connected to this active cable will not be seen. This active
    cable requires <PowerValue_in_mW> of power"
    
    This event is only for Intruder/Cutlass HBAs.
    
    Signed-off-by: Chaitra P B <chaitra.basappa@broadcom.com>
    Reviewed-by: Tomas Henzl <thenzl@redhat.com>
    Signed-off-by: Martin K. Petersen <martin.petersen@oracle.com>

commit 4fe6bc97efebdc5083aa749850928fad1740a60d
Author: Chaitra P B <chaitra.basappa@broadcom.com>
Date:   Fri May 6 14:29:26 2016 +0530

    mpt3sas: Update MPI header to 2.00.42
    
    Updated MPI version and MPI header files.
    
    ChangeList:
    * Added SATADeviceWaitTime to SAS IO Unit Page 4
    * Added EEDPObservedValue added to SCSI IO Reply message
    * Added MPI2_EVENT_ACTIVE_CABLE_EXCEPTION and
      MPI26_EVENT_DATA_ACTIVE_CABLE_EXCEPT
    
    Signed-off-by: Chaitra P B <chaitra.basappa@broadcom.com>
    Reviewed-by: Tomas Henzl <thenzl@redhat.com>
    Signed-off-by: Martin K. Petersen <martin.petersen@oracle.com>

commit cc622420798c4bcf093785d872525087a7798db9
Author: Arnd Bergmann <arnd@arndb.de>
Date:   Mon Apr 25 17:35:29 2016 +0200

    gcov: disable for COMPILE_TEST
    
    Enabling gcov is counterproductive to compile testing: it significantly
    increases the kernel image size, compile time, and it produces lots
    of false positive "may be used uninitialized" warnings as the result
    of missed optimizations.
    
    This is in line with how UBSAN_SANITIZE_ALL and PROFILE_ALL_BRANCHES
    work, both of which have similar problems.
    
    With an ARM allmodconfig kernel, I see the build time drop from
    283 minutes CPU time to 225 minutes, and the vmlinux size drops
    from 43MB to 26MB.
    
    Signed-off-by: Arnd Bergmann <arnd@arndb.de>
    Acked-by: Peter Oberparleiter <oberpar@linux.vnet.ibm.com>
    Signed-off-by: Michal Marek <mmarek@suse.com>

commit 895c10d8316f0682a76feedefac06ec1275ece01
Author: Arnd Bergmann <arnd@arndb.de>
Date:   Fri Jan 29 15:50:38 2016 +0100

    ARM: EXYNOS: select THERMAL_OF
    
    commit dc7eb9d589e595954792cc192bcbb92932e5c2ff upstream.
    
    We cannot select a symbol that has disabled dependencies, so
    we get a warning if we ever enable EXYNOS_THERMAL without
    also turning on THERMAL_OF:
    
    warning: (ARCH_EXYNOS) selects EXYNOS_THERMAL which has unmet direct dependencies (THERMAL && (ARCH_EXYNOS || COMPILE_TEST) && THERMAL_OF)
    
    This adds another 'select' in the platform code to avoid that
    case. Alternatively, we could decide to not select EXYNOS_THERMAL
    here and instead make it a user option.
    
    Signed-off-by: Arnd Bergmann <arnd@arndb.de>
    Fixes: f87e6bd3f740 ("thermal: exynos: Add the dependency of CONFIG_THERMAL_OF instead of CONFIG_OF")
    Signed-off-by: Krzysztof Kozlowski <k.kozlowski@samsung.com>
    Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>

commit 0cfe76f7852f2f10477da2d2380383d8dcee54fb
Author: Michal Marek <mmarek@suse.com>
Date:   Wed Feb 17 14:46:59 2016 +0100

    lib/mpi: Endianness fix
    
    commit 3ee0cb5fb5eea2110db1b5cb7f67029b7be8a376 upstream.
    
    The limbs are integers in the host endianness, so we can't simply
    iterate over the individual bytes. The current code happens to work on
    little-endian, because the order of the limbs in the MPI array is the
    same as the order of the bytes in each limb, but it breaks on
    big-endian.
    
    Fixes: 0f74fbf77d45 ("MPI: Fix mpi_read_buffer")
    Signed-off-by: Michal Marek <mmarek@suse.com>
    Signed-off-by: Herbert Xu <herbert@gondor.apana.org.au>
    Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>

commit abc48d066b7b5063db56f4a81e367c84b9582882
Author: Arnd Bergmann <arnd@arndb.de>
Date:   Fri Jan 29 15:50:38 2016 +0100

    ARM: EXYNOS: select THERMAL_OF
    
    commit dc7eb9d589e595954792cc192bcbb92932e5c2ff upstream.
    
    We cannot select a symbol that has disabled dependencies, so
    we get a warning if we ever enable EXYNOS_THERMAL without
    also turning on THERMAL_OF:
    
    warning: (ARCH_EXYNOS) selects EXYNOS_THERMAL which has unmet direct dependencies (THERMAL && (ARCH_EXYNOS || COMPILE_TEST) && THERMAL_OF)
    
    This adds another 'select' in the platform code to avoid that
    case. Alternatively, we could decide to not select EXYNOS_THERMAL
    here and instead make it a user option.
    
    Signed-off-by: Arnd Bergmann <arnd@arndb.de>
    Fixes: f87e6bd3f740 ("thermal: exynos: Add the dependency of CONFIG_THERMAL_OF instead of CONFIG_OF")
    Signed-off-by: Krzysztof Kozlowski <k.kozlowski@samsung.com>
    Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>

commit 81b3a56ed84b0f2c1e2ff75ee2e05d5d4cd2462b
Author: Michal Marek <mmarek@suse.com>
Date:   Wed Feb 17 14:46:59 2016 +0100

    lib/mpi: Endianness fix
    
    commit 3ee0cb5fb5eea2110db1b5cb7f67029b7be8a376 upstream.
    
    The limbs are integers in the host endianness, so we can't simply
    iterate over the individual bytes. The current code happens to work on
    little-endian, because the order of the limbs in the MPI array is the
    same as the order of the bytes in each limb, but it breaks on
    big-endian.
    
    Fixes: 0f74fbf77d45 ("MPI: Fix mpi_read_buffer")
    Signed-off-by: Michal Marek <mmarek@suse.com>
    Signed-off-by: Herbert Xu <herbert@gondor.apana.org.au>
    Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>

commit c39290a1f3caad4a82bbf1bed0e3db7bcc06b54c
Author: Gregory CLEMENT <gregory.clement@free-electrons.com>
Date:   Fri Apr 29 09:49:08 2016 +0200

    dmaengine: mv_xor: Allow selecting mv_xor for mvebu only compatible SoC
    
    Armada 3700 SoC uses the mv_xor driver but don't select anymore the
    PLAT_ORION symbol. This commit extends the dependency of the mv_xor
    driver to the more modern SoCs only compatible with ARCH_MVEBU, which
    allows using it with the Armada 3700 SoC.
    
    In the same time it also add the COMPILE_TEST dependency allowing a wider
    test coverage.
    
    Signed-off-by: Gregory CLEMENT <gregory.clement@free-electrons.com>
    Signed-off-by: Vinod Koul <vinod.koul@intel.com>

commit 2ce7aed6a4da8ffa35f0232573a6901c0369720d
Author: Krzysztof Kozlowski <k.kozlowski@samsung.com>
Date:   Thu Mar 31 11:07:03 2016 +0100

    nvmem: Fix build error of missing devm_ioremap_resource on UM
    
    The devres.o gets linked if HAS_IOMEM is present so on ARCH=um
    allyesconfig (COMPILE_TEST) failed on many files with:
    
    drivers/built-in.o: In function `mtk_thermal_probe':
    mtk_thermal.c:(.text+0x394618): undefined reference to `devm_ioremap_resource'
    
    The users of devm_ioremap_resource() which are compile-testable should
    depend on HAS_IOMEM.
    
    Signed-off-by: Krzysztof Kozlowski <k.kozlowski@samsung.com>
    Signed-off-by: Srinivas Kandagatla <srinivas.kandagatla@linaro.org>
    Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>

commit 1fc969c759861ac491b6c93116aa497f774b00dc
Author: Andy Shevchenko <andriy.shevchenko@linux.intel.com>
Date:   Mon Apr 4 17:35:12 2016 +0300

    serial: 8250_mid: make module available only on X86
    
    There is no reason to compile module on non-X86 platforms, though COMPILE_TEST
    is provided for sake of what it does.
    
    While here, set default to SERIAL_8250 that user doesn't need an explicit
    option to be set and hide it from non-expert.
    
    Reviewed-by: Heikki Krogerus <heikki.krogerus@linux.intel.com>
    Signed-off-by: Andy Shevchenko <andriy.shevchenko@linux.intel.com>
    Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>

commit 83fefd2d5bec94de765305d44633c42371360a2a
Author: Axel Lin <axel.lin@ingics.com>
Date:   Fri Apr 29 13:38:41 2016 +0800

    spi: st-ssc4: Allow compile test build
    
    There is no build dependency for this driver, so enable COMPILE_TEST to get
    better build coverage.
    
    Signed-off-by: Axel Lin <axel.lin@ingics.com>
    Signed-off-by: Mark Brown <broonie@kernel.org>

commit f345c9a5726d10cc3613d17ae75dcb1ab0986ba1
Merge: 2a9e8438a29c a166140e810e
Author: David S. Miller <davem@davemloft.net>
Date:   Thu Apr 28 16:14:20 2016 -0400

    Merge branch 'tcp-eor'
    
    Martin KaFai Lau says:
    
    ====================
    tcp: Make use of MSG_EOR in tcp_sendmsg
    
    v4:
    ~ Do not set eor bit in do_tcp_sendpages() since there is
      no way to pass MSG_EOR from the userland now.
    ~ Avoid rmw by testing MSG_EOR first in tcp_sendmsg().
    ~ Move TCP_SKB_CB(skb)->eor test to a new helper
      tcp_skb_can_collapse_to() (suggested by Soheil).
    ~ Add some packetdrill tests.
    
    v3:
    ~ Separate EOR marking from the SKBTX_ANY_TSTAMP logic.
    ~ Move the eor bit test back to the loop in tcp_sendmsg and
      tcp_sendpage because there could be >1 threads doing
      sendmsg.
    ~ Thanks to Eric Dumazet's suggestions on v2.
    ~ The TCP timestamp bug fixes are separated into other threads.
    
    v2:
    ~ Rework based on the recent work
      "add TX timestamping via cmsg" by
      Soheil Hassas Yeganeh <soheil.kdev@gmail.com>
    ~ This version takes the MSG_EOR bit as a signal of
      end-of-response-message and leave the selective
      timestamping job to the cmsg
    ~ Changes based on the v1 feedback (like avoid
      unlikely check in a loop and adding tcp_sendpage
      support)
    ~ The first 3 patches are bug fixes.  The fixes in this
      series depend on the newly introduced txstamp_ack in
      net-next.  I will make relevant patches against net after
      getting some feedback.
    ~ The test results are based on the recently posted net fix:
      "tcp: Fix SOF_TIMESTAMPING_TX_ACK when handling dup acks"
    
    One potential use case is to use MSG_EOR with
    SOF_TIMESTAMPING_TX_ACK to get a more accurate
    TCP ack timestamping on application protocol with
    multiple outgoing response messages (e.g. HTTP2).
    
    One of our use case is at the webserver.  The webserver tracks
    the HTTP2 response latency by measuring when the webserver sends
    the first byte to the socket till the TCP ACK of the last byte
    is received.  In the cases where we don't have client side
    measurement, measuring from the server side is the only option.
    In the cases we have the client side measurement, the server side
    data can also be used to justify/cross-check-with the client
    side data.
    ====================
    
    Signed-off-by: David S. Miller <davem@davemloft.net>

commit c134ecb87817ce70fd62b2dc48bb079c44fc08df
Author: Martin KaFai Lau <kafai@fb.com>
Date:   Mon Apr 25 14:44:48 2016 -0700

    tcp: Make use of MSG_EOR in tcp_sendmsg
    
    This patch adds an eor bit to the TCP_SKB_CB.  When MSG_EOR
    is passed to tcp_sendmsg, the eor bit will be set at the skb
    containing the last byte of the userland's msg.  The eor bit
    will prevent data from appending to that skb in the future.
    
    The change in do_tcp_sendpages is to honor the eor set
    during the previous tcp_sendmsg(MSG_EOR) call.
    
    This patch handles the tcp_sendmsg case.  The followup patches
    will handle other skb coalescing and fragment cases.
    
    One potential use case is to use MSG_EOR with
    SOF_TIMESTAMPING_TX_ACK to get a more accurate
    TCP ack timestamping on application protocol with
    multiple outgoing response messages (e.g. HTTP2).
    
    Packetdrill script for testing:
    ~~~~~~
    +0 `sysctl -q -w net.ipv4.tcp_min_tso_segs=10`
    +0 `sysctl -q -w net.ipv4.tcp_no_metrics_save=1`
    +0 socket(..., SOCK_STREAM, IPPROTO_TCP) = 3
    +0 setsockopt(3, SOL_SOCKET, SO_REUSEADDR, [1], 4) = 0
    +0 bind(3, ..., ...) = 0
    +0 listen(3, 1) = 0
    
    0.100 < S 0:0(0) win 32792 <mss 1460,sackOK,nop,nop,nop,wscale 7>
    0.100 > S. 0:0(0) ack 1 <mss 1460,nop,nop,sackOK,nop,wscale 7>
    0.200 < . 1:1(0) ack 1 win 257
    0.200 accept(3, ..., ...) = 4
    +0 setsockopt(4, SOL_TCP, TCP_NODELAY, [1], 4) = 0
    
    0.200 write(4, ..., 14600) = 14600
    0.200 sendto(4, ..., 730, MSG_EOR, ..., ...) = 730
    0.200 sendto(4, ..., 730, MSG_EOR, ..., ...) = 730
    
    0.200 > .  1:7301(7300) ack 1
    0.200 > P. 7301:14601(7300) ack 1
    
    0.300 < . 1:1(0) ack 14601 win 257
    0.300 > P. 14601:15331(730) ack 1
    0.300 > P. 15331:16061(730) ack 1
    
    0.400 < . 1:1(0) ack 16061 win 257
    0.400 close(4) = 0
    0.400 > F. 16061:16061(0) ack 1
    0.400 < F. 1:1(0) ack 16062 win 257
    0.400 > . 16062:16062(0) ack 2
    
    Signed-off-by: Martin KaFai Lau <kafai@fb.com>
    Cc: Eric Dumazet <edumazet@google.com>
    Cc: Neal Cardwell <ncardwell@google.com>
    Cc: Soheil Hassas Yeganeh <soheil@google.com>
    Cc: Willem de Bruijn <willemb@google.com>
    Cc: Yuchung Cheng <ycheng@google.com>
    Suggested-by: Eric Dumazet <edumazet@google.com>
    Acked-by: Eric Dumazet <edumazet@google.com>
    Acked-by: Soheil Hassas Yeganeh <soheil@google.com>
    Signed-off-by: David S. Miller <davem@davemloft.net>

commit de82bdff62a9078a6e4f1452e2f2604686e51e49
Author: Mitko Haralanov <mitko.haralanov@intel.com>
Date:   Tue Apr 12 10:46:03 2016 -0700

    IB/hfi1: Fix deadlock caused by locking with wrong scope
    
    The locking around the interval RB tree is designed to prevent
    access to the tree while it's being modified. The locking in its
    current form is too overzealous, which is causing a deadlock in
    certain cases with the following backtrace:
    
        Kernel panic - not syncing: Watchdog detected hard LOCKUP on cpu 0
        CPU: 0 PID: 5836 Comm: IMB-MPI1 Tainted: G           O 3.12.18-wfr+ #1
         0000000000000000 ffff88087f206c50 ffffffff814f1caa ffffffff817b53f0
         ffff88087f206cc8 ffffffff814ecd56 0000000000000010 ffff88087f206cd8
         ffff88087f206c78 0000000000000000 0000000000000000 0000000000001662
        Call Trace:
         <NMI>  [<ffffffff814f1caa>] dump_stack+0x45/0x56
         [<ffffffff814ecd56>] panic+0xc2/0x1cb
         [<ffffffff810d4370>] ? restart_watchdog_hrtimer+0x50/0x50
         [<ffffffff810d4432>] watchdog_overflow_callback+0xc2/0xd0
         [<ffffffff81109b4e>] __perf_event_overflow+0x8e/0x2b0
         [<ffffffff8110a714>] perf_event_overflow+0x14/0x20
         [<ffffffff8101c906>] intel_pmu_handle_irq+0x1b6/0x390
         [<ffffffff814f927b>] perf_event_nmi_handler+0x2b/0x50
         [<ffffffff814f8ad8>] nmi_handle.isra.3+0x88/0x180
         [<ffffffff814f8d39>] do_nmi+0x169/0x310
         [<ffffffff814f8177>] end_repeat_nmi+0x1e/0x2e
         [<ffffffff81272600>] ? unmap_single+0x30/0x30
         [<ffffffff814f780d>] ? _raw_spin_lock_irqsave+0x2d/0x40
         [<ffffffff814f780d>] ? _raw_spin_lock_irqsave+0x2d/0x40
         [<ffffffff814f780d>] ? _raw_spin_lock_irqsave+0x2d/0x40
         <<EOE>>  <IRQ>  [<ffffffffa056c4a8>] hfi1_mmu_rb_search+0x38/0x70 [hfi1]
         [<ffffffffa05919cb>] user_sdma_free_request+0xcb/0x120 [hfi1]
         [<ffffffffa0593393>] user_sdma_txreq_cb+0x263/0x350 [hfi1]
         [<ffffffffa057fad7>] ? sdma_txclean+0x27/0x1c0 [hfi1]
         [<ffffffffa0593130>] ? user_sdma_send_pkts+0x1710/0x1710 [hfi1]
         [<ffffffffa057fdd6>] sdma_make_progress+0x166/0x480 [hfi1]
         [<ffffffff810762c9>] ? ttwu_do_wakeup+0x19/0xd0
         [<ffffffffa0581c7e>] sdma_engine_interrupt+0x8e/0x100 [hfi1]
         [<ffffffffa0546bdd>] sdma_interrupt+0x5d/0xa0 [hfi1]
         [<ffffffff81097e57>] handle_irq_event_percpu+0x47/0x1d0
         [<ffffffff81098017>] handle_irq_event+0x37/0x60
         [<ffffffff8109aa5f>] handle_edge_irq+0x6f/0x120
         [<ffffffff810044af>] handle_irq+0xbf/0x150
         [<ffffffff8104c9b7>] ? irq_enter+0x17/0x80
         [<ffffffff8150168d>] do_IRQ+0x4d/0xc0
         [<ffffffff814f7c6a>] common_interrupt+0x6a/0x6a
         <EOI>  [<ffffffff81073524>] ? finish_task_switch+0x54/0xe0
         [<ffffffff814f56c6>] __schedule+0x3b6/0x7e0
         [<ffffffff810763a6>] __cond_resched+0x26/0x30
         [<ffffffff814f5eda>] _cond_resched+0x3a/0x50
         [<ffffffff814f4f82>] down_write+0x12/0x30
         [<ffffffffa0591619>] hfi1_release_user_pages+0x69/0x90 [hfi1]
         [<ffffffffa059173a>] sdma_rb_remove+0x9a/0xc0 [hfi1]
         [<ffffffffa056c00d>] __mmu_rb_remove.isra.5+0x5d/0x70 [hfi1]
         [<ffffffffa056c536>] hfi1_mmu_rb_remove+0x56/0x70 [hfi1]
         [<ffffffffa059427b>] hfi1_user_sdma_process_request+0x74b/0x1160 [hfi1]
         [<ffffffffa055c763>] hfi1_aio_write+0xc3/0x100 [hfi1]
         [<ffffffff8116a14c>] do_sync_readv_writev+0x4c/0x80
         [<ffffffff8116b58b>] do_readv_writev+0xbb/0x230
         [<ffffffff811a9da1>] ? fsnotify+0x241/0x320
         [<ffffffff81073524>] ? finish_task_switch+0x54/0xe0
         [<ffffffff8116b795>] vfs_writev+0x35/0x60
         [<ffffffff8116b8c9>] SyS_writev+0x49/0xc0
         [<ffffffff810cd876>] ? __audit_syscall_exit+0x1f6/0x2a0
         [<ffffffff814ff992>] system_call_fastpath+0x16/0x1b
    
    As evident from the backtrace above, the process was being put to sleep
    while holding the lock.
    
    Limiting the scope of the lock only to the RB tree operation fixes the
    above error allowing for proper locking and the process being put to
    sleep when needed.
    
    Reviewed-by: Dennis Dalessandro <dennis.dalessandro@intel.com>
    Reviewed-by: Dean Luick <dean.luick@intel.com>
    Signed-off-by: Mitko Haralanov <mitko.haralanov@intel.com>
    Signed-off-by: Doug Ledford <dledford@redhat.com>

commit b834fc16378b11a3d753c6299dd2e30a9a52f550
Author: Paul Mackerras <paulus@ozlabs.org>
Date:   Thu Sep 10 14:36:21 2015 +1000

    powerpc/MSI: Fix race condition in tearing down MSI interrupts
    
    commit e297c939b745e420ef0b9dc989cb87bda617b399 upstream.
    
    This fixes a race which can result in the same virtual IRQ number
    being assigned to two different MSI interrupts.  The most visible
    consequence of that is usually a warning and stack trace from the
    sysfs code about an attempt to create a duplicate entry in sysfs.
    
    The race happens when one CPU (say CPU 0) is disposing of an MSI
    while another CPU (say CPU 1) is setting up an MSI.  CPU 0 calls
    (for example) pnv_teardown_msi_irqs(), which calls
    msi_bitmap_free_hwirqs() to indicate that the MSI (i.e. its
    hardware IRQ number) is no longer in use.  Then, before CPU 0 gets
    to calling irq_dispose_mapping() to free up the virtal IRQ number,
    CPU 1 comes in and calls msi_bitmap_alloc_hwirqs() to allocate an
    MSI, and gets the same hardware IRQ number that CPU 0 just freed.
    CPU 1 then calls irq_create_mapping() to get a virtual IRQ number,
    which sees that there is currently a mapping for that hardware IRQ
    number and returns the corresponding virtual IRQ number (which is
    the same virtual IRQ number that CPU 0 was using).  CPU 0 then
    calls irq_dispose_mapping() and frees that virtual IRQ number.
    Now, if another CPU comes along and calls irq_create_mapping(), it
    is likely to get the virtual IRQ number that was just freed,
    resulting in the same virtual IRQ number apparently being used for
    two different hardware interrupts.
    
    To fix this race, we just move the call to msi_bitmap_free_hwirqs()
    to after the call to irq_dispose_mapping().  Since virq_to_hw()
    doesn't work for the virtual IRQ number after irq_dispose_mapping()
    has been called, we need to call it before irq_dispose_mapping() and
    remember the result for the msi_bitmap_free_hwirqs() call.
    
    The pattern of calling msi_bitmap_free_hwirqs() before
    irq_dispose_mapping() appears in 5 places under arch/powerpc, and
    appears to have originated in commit 05af7bd2d75e ("[POWERPC] MPIC
    U3/U4 MSI backend") from 2007.
    
    Fixes: 05af7bd2d75e ("[POWERPC] MPIC U3/U4 MSI backend")
    Reported-by: Alexey Kardashevskiy <aik@ozlabs.ru>
    Signed-off-by: Paul Mackerras <paulus@samba.org>
    Signed-off-by: Michael Ellerman <mpe@ellerman.id.au>
    [bwh: Backported to 3.2:
     - powernv uses a private functions instead of msi_bitmap_free_hwirqs()
     - Adjust filename, context]
    Signed-off-by: Ben Hutchings <ben@decadent.org.uk>
    Signed-off-by: Zefan Li <lizefan@huawei.com>

commit c5edde3a81149d29ceae4221f09f4c7bc2f70846
Merge: f862d66a1a46 b4f70527f052
Author: Linus Torvalds <torvalds@linux-foundation.org>
Date:   Thu Apr 21 12:57:34 2016 -0700

    Merge git://git.kernel.org/pub/scm/linux/kernel/git/davem/net
    
    Pull networking fixes from David Miller:
    
     1) Fix memory leak in iwlwifi, from Matti Gottlieb.
    
     2) Add missing registration of netfilter arp_tables into initial
        namespace, from Florian Westphal.
    
     3) Fix potential NULL deref in DecNET routing code.
    
     4) Restrict NETLINK_URELEASE to truly bound sockets only, from Dmitry
        Ivanov.
    
     5) Fix dst ref counting in VRF, from David Ahern.
    
     6) Fix TSO segmenting limits in i40e driver, from Alexander Duyck.
    
     7) Fix heap leak in PACKET_DIAG_MCLIST, from Mathias Krause.
    
     8) Ravalidate IPV6 datagram socket cached routes properly, particularly
        with UDP, from Martin KaFai Lau.
    
     9) Fix endian bug in RDS dp_ack_seq handling, from Qing Huang.
    
    10) Fix stats typing in bcmgenet driver, from Eric Dumazet.
    
    11) Openvswitch needs to orphan SKBs before ipv6 fragmentation handing,
        from Joe Stringer.
    
    12) SPI device reference leak in spi_ks8895 PHY driver, from Mark Brown.
    
    13) atl2 doesn't actually support scatter-gather, so don't advertise the
        feature.  From Ben Hucthings.
    
    * git://git.kernel.org/pub/scm/linux/kernel/git/davem/net: (72 commits)
      openvswitch: use flow protocol when recalculating ipv6 checksums
      Driver: Vmxnet3: set CHECKSUM_UNNECESSARY for IPv6 packets
      atl2: Disable unimplemented scatter/gather feature
      net/mlx4_en: Split SW RX dropped counter per RX ring
      net/mlx4_core: Don't allow to VF change global pause settings
      net/mlx4_core: Avoid repeated calls to pci enable/disable
      net/mlx4_core: Implement pci_resume callback
      net: phy: spi_ks8895: Don't leak references to SPI devices
      net: ethernet: davinci_emac: Fix platform_data overwrite
      net: ethernet: davinci_emac: Fix Unbalanced pm_runtime_enable
      qede: Fix single MTU sized packet from firmware GRO flow
      qede: Fix setting Skb network header
      qede: Fix various memory allocation error flows for fastpath
      tcp: Merge tx_flags and tskey in tcp_shifted_skb
      tcp: Merge tx_flags and tskey in tcp_collapse_retrans
      drivers: net: cpsw: fix wrong regs access in cpsw_ndo_open
      tcp: Fix SOF_TIMESTAMPING_TX_ACK when handling dup acks
      openvswitch: Orphan skbs before IPv6 defrag
      Revert "Prevent NUll pointer dereference with two PHYs on cpsw"
      VSOCK: Only check error on skb_recv_datagram when skb is NULL
      ...

commit 479f85c36688f5c855ad463b71902ef5992628b7
Author: Martin KaFai Lau <kafai@fb.com>
Date:   Mon Apr 18 15:39:53 2016 -0700

    tcp: Fix SOF_TIMESTAMPING_TX_ACK when handling dup acks
    
    Assuming SOF_TIMESTAMPING_TX_ACK is on. When dup acks are received,
    it could incorrectly think that a skb has already
    been acked and queue a SCM_TSTAMP_ACK cmsg to the
    sk->sk_error_queue.
    
    In tcp_ack_tstamp(), it checks
    'between(shinfo->tskey, prior_snd_una, tcp_sk(sk)->snd_una - 1)'.
    If prior_snd_una == tcp_sk(sk)->snd_una like the following packetdrill
    script, between() returns true but the tskey is actually not acked.
    e.g. try between(3, 2, 1).
    
    The fix is to replace between() with one before() and one !before().
    By doing this, the -1 offset on the tcp_sk(sk)->snd_una can also be
    removed.
    
    A packetdrill script is used to reproduce the dup ack scenario.
    Due to the lacking cmsg support in packetdrill (may be I
    cannot find it),  a BPF prog is used to kprobe to
    sock_queue_err_skb() and print out the value of
    serr->ee.ee_data.
    
    Both the packetdrill and the bcc BPF script is attached at the end of
    this commit message.
    
    BPF Output Before Fix:
    ~~~~~~
          <...>-2056  [001] d.s.   433.927987: : ee_data:1459  #incorrect
    packetdrill-2056  [001] d.s.   433.929563: : ee_data:1459  #incorrect
    packetdrill-2056  [001] d.s.   433.930765: : ee_data:1459  #incorrect
    packetdrill-2056  [001] d.s.   434.028177: : ee_data:1459
    packetdrill-2056  [001] d.s.   434.029686: : ee_data:14599
    
    BPF Output After Fix:
    ~~~~~~
          <...>-2049  [000] d.s.   113.517039: : ee_data:1459
          <...>-2049  [000] d.s.   113.517253: : ee_data:14599
    
    BCC BPF Script:
    ~~~~~~
    #!/usr/bin/env python
    
    from __future__ import print_function
    from bcc import BPF
    
    bpf_text = """
    #include <uapi/linux/ptrace.h>
    #include <net/sock.h>
    #include <bcc/proto.h>
    #include <linux/errqueue.h>
    
    #ifdef memset
    #undef memset
    #endif
    
    int trace_err_skb(struct pt_regs *ctx)
    {
            struct sk_buff *skb = (struct sk_buff *)ctx->si;
            struct sock *sk = (struct sock *)ctx->di;
            struct sock_exterr_skb *serr;
            u32 ee_data = 0;
    
            if (!sk || !skb)
                    return 0;
    
            serr = SKB_EXT_ERR(skb);
            bpf_probe_read(&ee_data, sizeof(ee_data), &serr->ee.ee_data);
            bpf_trace_printk("ee_data:%u\\n", ee_data);
    
            return 0;
    };
    """
    
    b = BPF(text=bpf_text)
    b.attach_kprobe(event="sock_queue_err_skb", fn_name="trace_err_skb")
    print("Attached to kprobe")
    b.trace_print()
    
    Packetdrill Script:
    ~~~~~~
    +0 `sysctl -q -w net.ipv4.tcp_min_tso_segs=10`
    +0 `sysctl -q -w net.ipv4.tcp_no_metrics_save=1`
    +0 socket(..., SOCK_STREAM, IPPROTO_TCP) = 3
    +0 setsockopt(3, SOL_SOCKET, SO_REUSEADDR, [1], 4) = 0
    +0 bind(3, ..., ...) = 0
    +0 listen(3, 1) = 0
    
    0.100 < S 0:0(0) win 32792 <mss 1460,sackOK,nop,nop,nop,wscale 7>
    0.100 > S. 0:0(0) ack 1 <mss 1460,nop,nop,sackOK,nop,wscale 7>
    0.200 < . 1:1(0) ack 1 win 257
    0.200 accept(3, ..., ...) = 4
    +0 setsockopt(4, SOL_TCP, TCP_NODELAY, [1], 4) = 0
    
    +0 setsockopt(4, SOL_SOCKET, 37, [2688], 4) = 0
    0.200 write(4, ..., 1460) = 1460
    0.200 write(4, ..., 13140) = 13140
    
    0.200 > P. 1:1461(1460) ack 1
    0.200 > . 1461:8761(7300) ack 1
    0.200 > P. 8761:14601(5840) ack 1
    
    0.300 < . 1:1(0) ack 1 win 257 <sack 1461:2921,nop,nop>
    0.300 < . 1:1(0) ack 1 win 257 <sack 1461:4381,nop,nop>
    0.300 < . 1:1(0) ack 1 win 257 <sack 1461:5841,nop,nop>
    0.300 > P. 1:1461(1460) ack 1
    0.400 < . 1:1(0) ack 14601 win 257
    
    0.400 close(4) = 0
    0.400 > F. 14601:14601(0) ack 1
    0.500 < F. 1:1(0) ack 14602 win 257
    0.500 > . 14602:14602(0) ack 2
    
    Signed-off-by: Martin KaFai Lau <kafai@fb.com>
    Cc: Eric Dumazet <edumazet@google.com>
    Cc: Neal Cardwell <ncardwell@google.com>
    Cc: Soheil Hassas Yeganeh <soheil.kdev@gmail.com>
    Cc: Willem de Bruijn <willemb@google.com>
    Cc: Yuchung Cheng <ycheng@google.com>
    Acked-by: Soheil Hassas Yeganeh <soheil@google.com>
    Tested-by: Soheil Hassas Yeganeh <soheil@google.com>
    Signed-off-by: David S. Miller <davem@davemloft.net>

commit a6f4850dbca66e46a73b8774e85aaf9fc0caf265
Author: Johannes Berg <johannes.berg@intel.com>
Date:   Thu Apr 14 15:15:20 2016 +0200

    thermal: fix Mediatek thermal controller build
    
    At least with CONFIG_COMPILE_TEST, there's no reason to assume
    that CONFIG_RESET_CONTROLLER is set, but the code for this
    controller requires it since it calls device_reset().
    
    Make CONFIG_MTK_THERMAL properly depend on CONFIG_RESET_CONTROLLER.
    
    Signed-off-by: Johannes Berg <johannes.berg@intel.com>
    Signed-off-by: Eduardo Valentin <edubezval@gmail.com>

commit ba5776ab6f09800dd9ba8442185139661e065529
Author: Brian Norris <briannorris@chromium.org>
Date:   Mon Apr 11 10:27:32 2016 -0700

    mfd: cros_ec: Allow building for ARM64
    
    There are platforms using the ChromeOS embeded controller on ARM64 now,
    so let's allow using this driver (without having to use COMPILE_TEST).
    
    Signed-off-by: Brian Norris <briannorris@chromium.org>
    Reviewed-by: Javier Martinez Canillas <javier@osg.samsung.com>
    Signed-off-by: Lee Jones <lee.jones@linaro.org>

commit a8aabb91dc5bef0875d93d6a86d01779947604e1
Author: Pankaj Dubey <pankaj.dubey@samsung.com>
Date:   Mon Apr 11 13:12:24 2016 +0530

    memory: Add support for Exynos SROM driver
    
    This patch adds Exynos SROM controller driver which will handle
    save restore of SROM registers during S2R.
    
    Signed-off-by: Pankaj Dubey <pankaj.dubey@samsung.com>
    Reviewed-by: Krzysztof Kozlowski <k.kozlowski@samsung.com>
    [p.fedin@samsung.com: tested on SMDK5410]
    Tested-by: Pavel Fedin <p.fedin@samsung.com>
    Signed-off-by: Kukjin Kim <kgene@kernel.org>
    [k.kozlowski: Minor COMPILE_TEST adjustments in Kconfig entries]
    Signed-off-by: Krzysztof Kozlowski <k.kozlowski@samsung.com>

commit ac18dd9e842294377dbaf1e8d169493567a81fa1
Author: Amitoj Kaur Chawla <amitoj1606@gmail.com>
Date:   Sat Apr 9 17:27:45 2016 +0530

    qlge: Replace create_singlethread_workqueue with alloc_ordered_workqueue
    
    Replace deprecated create_singlethread_workqueue with
    alloc_ordered_workqueue.
    
    Work items include getting tx/rx frame sizes, resetting MPI processor,
    setting asic recovery bit so ordering seems necessary as only one work
    item should be in queue/executing at any given time, hence the use of
    alloc_ordered_workqueue.
    
    WQ_MEM_RECLAIM flag has been set since ethernet devices seem to sit in
    memory reclaim path, so to guarantee forward progress regardless of
    memory pressure.
    
    Signed-off-by: Amitoj Kaur Chawla <amitoj1606@gmail.com>
    Acked-by: Tejun Heo <tj@kernel.org>
    Signed-off-by: David S. Miller <davem@davemloft.net>

commit 4dd4dd1d21206cd05f5da031d709e9de8567957f
Author: Alexander Stein <alexanders83@web.de>
Date:   Wed Feb 24 20:54:32 2016 +0100

    gpio: tegra: Allow compile test
    
    Allow compile testing this driver by adding a new config option which
    is enabled by default and depends on the old symbol or COMPILE_TEST.
    
    Signed-off-by: Alexander Stein <alexanders83@web.de>

commit 0a793ad34f137f146119ec4a4a90694ccab77ea3
Author: Chris Wilson <chris@chris-wilson.co.uk>
Date:   Wed Apr 13 17:35:00 2016 +0100

    drm/i915: Force clean compilation with -Werror
    
    Our driver compiles clean (nowadays thanks to 0day) but for me, at least,
    it would be beneficial if the compiler threw an error rather than a
    warning when it found a piece of suspect code. (I use this to
    compile-check patch series and want to break on the first compiler error
    in order to fix the patch.)
    
    v2: Kick off a new "Debugging" submenu for i915.ko
    
    At this point, we applied it to the kernel and promptly kicked it out
    again as it broke buildbots (due to a compiler warning on 32bits):
    
    commit 908d759b210effb33d927a8cb6603a16448474e4
    Author: Daniel Vetter <daniel.vetter@ffwll.ch>
    Date:   Tue May 26 07:46:21 2015 +0200
    
        Revert "drm/i915: Force clean compilation with -Werror"
    
    v3: Avoid enabling -Werror for allyesconfig/allmodconfig builds, using
    COMPILE_TEST as a suitable proxy suggested by Andrew Morton. (Damien)
    Only make the option available for EXPERT to reinforce that the option
    should not be casually enabled.
    
    Signed-off-by: Chris Wilson <chris@chris-wilson.co.uk>
    Cc: Jani Nikula <jani.nikula@intel.com>
    Cc: Damien Lespiau <damien.lespiau@intel.com>
    Reviewed-by: Daniel Vetter <daniel.vetter@ffwll.ch>
    Link: http://patchwork.freedesktop.org/patch/msgid/1460565315-7748-1-git-send-email-chris@chris-wilson.co.uk

commit 0bb5c9ead62f4e1eaf226744076e0b4e8348f68f
Author: Nicolai Stange <nicstange@gmail.com>
Date:   Tue Mar 22 13:18:16 2016 +0100

    lib/mpi: mpi_read_raw_from_sgl(): fix out-of-bounds buffer access
    
    Within the copying loop in mpi_read_raw_from_sgl(), the last input SGE's
    byte count gets artificially extended as follows:
    
      if (sg_is_last(sg) && (len % BYTES_PER_MPI_LIMB))
        len += BYTES_PER_MPI_LIMB - (len % BYTES_PER_MPI_LIMB);
    
    Within the following byte copying loop, this causes reads beyond that
    SGE's allocated buffer:
    
      BUG: KASAN: slab-out-of-bounds in mpi_read_raw_from_sgl+0x331/0x650
                                         at addr ffff8801e168d4d8
      Read of size 1 by task systemd-udevd/721
      [...]
      Call Trace:
       [<ffffffff818c4d35>] dump_stack+0xbc/0x117
       [<ffffffff818c4c79>] ? _atomic_dec_and_lock+0x169/0x169
       [<ffffffff814af5d1>] ? print_section+0x61/0xb0
       [<ffffffff814b1109>] print_trailer+0x179/0x2c0
       [<ffffffff814bc524>] object_err+0x34/0x40
       [<ffffffff814bfdc7>] kasan_report_error+0x307/0x8c0
       [<ffffffff814bf315>] ? kasan_unpoison_shadow+0x35/0x50
       [<ffffffff814bf38e>] ? kasan_kmalloc+0x5e/0x70
       [<ffffffff814c0ad1>] kasan_report+0x71/0xa0
       [<ffffffff81938171>] ? mpi_read_raw_from_sgl+0x331/0x650
       [<ffffffff814bf1a6>] __asan_load1+0x46/0x50
       [<ffffffff81938171>] mpi_read_raw_from_sgl+0x331/0x650
       [<ffffffff817f41b6>] rsa_verify+0x106/0x260
       [<ffffffff817f40b0>] ? rsa_set_pub_key+0xf0/0xf0
       [<ffffffff818edc79>] ? sg_init_table+0x29/0x50
       [<ffffffff817f4d22>] ? pkcs1pad_sg_set_buf+0xb2/0x2e0
       [<ffffffff817f5b74>] pkcs1pad_verify+0x1f4/0x2b0
       [<ffffffff81831057>] public_key_verify_signature+0x3a7/0x5e0
       [<ffffffff81830cb0>] ? public_key_describe+0x80/0x80
       [<ffffffff817830f0>] ? keyring_search_aux+0x150/0x150
       [<ffffffff818334a4>] ? x509_request_asymmetric_key+0x114/0x370
       [<ffffffff814b83f0>] ? kfree+0x220/0x370
       [<ffffffff818312c2>] public_key_verify_signature_2+0x32/0x50
       [<ffffffff81830b5c>] verify_signature+0x7c/0xb0
       [<ffffffff81835d0c>] pkcs7_validate_trust+0x42c/0x5f0
       [<ffffffff813c391a>] system_verify_data+0xca/0x170
       [<ffffffff813c3850>] ? top_trace_array+0x9b/0x9b
       [<ffffffff81510b29>] ? __vfs_read+0x279/0x3d0
       [<ffffffff8129372f>] mod_verify_sig+0x1ff/0x290
      [...]
    
    The exact purpose of the len extension isn't clear to me, but due to
    its form, I suspect that it's a leftover somehow accounting for leading
    zero bytes within the most significant output limb.
    
    Note however that without that len adjustement, the total number of bytes
    ever processed by the inner loop equals nbytes and thus, the last output
    limb gets written at this point. Thus the net effect of the len adjustement
    cited above is just to keep the inner loop running for some more
    iterations, namely < BYTES_PER_MPI_LIMB ones, reading some extra bytes from
    beyond the last SGE's buffer and discarding them afterwards.
    
    Fix this issue by purging the extension of len beyond the last input SGE's
    buffer length.
    
    Fixes: 2d4d1eea540b ("lib/mpi: Add mpi sgl helpers")
    Signed-off-by: Nicolai Stange <nicstange@gmail.com>
    Signed-off-by: Herbert Xu <herbert@gondor.apana.org.au>

commit ab1e912ec1021e7532148398a01eb1283437fe62
Author: Nicolai Stange <nicstange@gmail.com>
Date:   Tue Mar 22 13:12:44 2016 +0100

    lib/mpi: mpi_read_raw_from_sgl(): don't include leading zero SGEs in nbytes
    
    At the very beginning of mpi_read_raw_from_sgl(), the leading zeros of
    the input scatterlist are counted:
    
      lzeros = 0;
      for_each_sg(sgl, sg, ents, i) {
        ...
        if (/* sg contains nonzero bytes */)
          break;
    
        /* sg contains nothing but zeros here */
        ents--;
        lzeros = 0;
      }
    
    Later on, the total number of trailing nonzero bytes is calculated by
    subtracting the number of leading zero bytes from the total number of input
    bytes:
    
      nbytes -= lzeros;
    
    However, since lzeros gets reset to zero for each completely zero leading
    sg in the loop above, it doesn't include those.
    
    Besides wasting resources by allocating a too large output buffer,
    this mistake propagates into the calculation of x, the number of
    leading zeros within the most significant output limb:
    
      x = BYTES_PER_MPI_LIMB - nbytes % BYTES_PER_MPI_LIMB;
    
    What's more, the low order bytes of the output, equal in number to the
    extra bytes in nbytes, are left uninitialized.
    
    Fix this by adjusting nbytes for each completely zero leading scatterlist
    entry.
    
    Fixes: 2d4d1eea540b ("lib/mpi: Add mpi sgl helpers")
    Signed-off-by: Nicolai Stange <nicstange@gmail.com>
    Signed-off-by: Herbert Xu <herbert@gondor.apana.org.au>

commit dc1d9dee3042d4c507bd7eb557a06918a1f09ae0
Author: Krzysztof Kozlowski <k.kozlowski@samsung.com>
Date:   Mon Mar 14 13:20:18 2016 +0900

    crypto: s5p-sss - Enable COMPILE_TEST
    
    Get some build coverage of S5P/Exynos AES H/W acceleration driver.
    Driver uses DMA and devm_ioremap_resource() so add DMA and IOMEM
    dependencies for the compile testing.
    
    Signed-off-by: Krzysztof Kozlowski <k.kozlowski@samsung.com>
    Acked-by: Vladimir Zapolskiy <vz@mleia.com>
    Signed-off-by: Herbert Xu <herbert@gondor.apana.org.au>

commit 4dd6e9ea7ae824ebfd054b92e4f97ad75454b4c2
Author: Krzysztof Kozlowski <k.kozlowski@samsung.com>
Date:   Mon Mar 14 13:19:55 2016 +0900

    hwrng: exynos - Enable COMPILE_TEST
    
    Get some build coverage of Exynos H/W random number generator
    driver. Driver uses devm_ioremap_resource() so add IOMEM dependency for
    the compile testing.
    
    Signed-off-by: Krzysztof Kozlowski <k.kozlowski@samsung.com>
    Signed-off-by: Herbert Xu <herbert@gondor.apana.org.au>

commit 9d2355ba30942ec28fb56510a8228050cbfcc6a6
Merge: 833716e0ed02 fd91e12f594b
Author: David S. Miller <davem@davemloft.net>
Date:   Mon Apr 4 15:50:31 2016 -0400

    Merge branch 'cmsg_timestamp'
    
    Soheil Hassas Yeganeh says:
    
    ====================
    add TX timestamping via cmsg
    
    This patch series aim at enabling TX timestamping via cmsg.
    
    Currently, to occasionally sample TX timestamping on a socket,
    applications need to call setsockopt twice: first for enabling
    timestamps and then for disabling them. This is an unnecessary
    overhead. With cmsg, in contrast, applications can sample TX
    timestamps per sendmsg().
    
    This patch series adds the code for processing SO_TIMESTAMPING
    for cmsg's of the SOL_SOCKET level, and adds the glue code for
    TCP, UDP, and RAW for both IPv4 and IPv6. This implementation
    supports overriding timestamp generation flags (i.e.,
    SOF_TIMESTAMPING_TX_*) but not timestamp reporting flags.
    Applications must still enable timestamp reporting via
    setsockopt to receive timestamps.
    
    This series does not change existing timestamping behavior for
    applications that are using socket options.
    
    I will follow up with another patch to enable timestamping for
    active TFO (client-side TCP Fast Open) and also setting packet
    mark via cmsgs.
    
    Thanks!
    
    Changes in v2:
            - Replace u32 with __u32 in the documentation.
    
    Changes in v3:
            - Fix the broken build for L2TP (due to changes
              in IPv6).
    ====================
    
    Signed-off-by: David S. Miller <davem@davemloft.net>

commit c14ac9451c34832554db33386a4393be8bba3a7b
Author: Soheil Hassas Yeganeh <soheil@google.com>
Date:   Sat Apr 2 23:08:12 2016 -0400

    sock: enable timestamping using control messages
    
    Currently, SOL_TIMESTAMPING can only be enabled using setsockopt.
    This is very costly when users want to sample writes to gather
    tx timestamps.
    
    Add support for enabling SO_TIMESTAMPING via control messages by
    using tsflags added in `struct sockcm_cookie` (added in the previous
    patches in this series) to set the tx_flags of the last skb created in
    a sendmsg. With this patch, the timestamp recording bits in tx_flags
    of the skbuff is overridden if SO_TIMESTAMPING is passed in a cmsg.
    
    Please note that this is only effective for overriding the recording
    timestamps flags. Users should enable timestamp reporting (e.g.,
    SOF_TIMESTAMPING_SOFTWARE | SOF_TIMESTAMPING_OPT_ID) using
    socket options and then should ask for SOF_TIMESTAMPING_TX_*
    using control messages per sendmsg to sample timestamps for each
    write.
    
    Signed-off-by: Soheil Hassas Yeganeh <soheil@google.com>
    Acked-by: Willem de Bruijn <willemb@google.com>
    Signed-off-by: David S. Miller <davem@davemloft.net>

commit 3dd17e63f5131bf2528f34aa5e3e57758175af92
Author: Soheil Hassas Yeganeh <soheil@google.com>
Date:   Sat Apr 2 23:08:09 2016 -0400

    sock: accept SO_TIMESTAMPING flags in socket cmsg
    
    Accept SO_TIMESTAMPING in control messages of the SOL_SOCKET level
    as a basis to accept timestamping requests per write.
    
    This implementation only accepts TX recording flags (i.e.,
    SOF_TIMESTAMPING_TX_HARDWARE, SOF_TIMESTAMPING_TX_SOFTWARE,
    SOF_TIMESTAMPING_TX_SCHED, and SOF_TIMESTAMPING_TX_ACK) in
    control messages. Users need to set reporting flags (e.g.,
    SOF_TIMESTAMPING_OPT_ID) per socket via socket options.
    
    This commit adds a tsflags field in sockcm_cookie which is
    set in __sock_cmsg_send. It only override the SOF_TIMESTAMPING_TX_*
    bits in sockcm_cookie.tsflags allowing the control message
    to override the recording behavior per write, yet maintaining
    the value of other flags.
    
    This patch implements validating the control message and setting
    tsflags in struct sockcm_cookie. Next commits in this series will
    actually implement timestamping per write for different protocols.
    
    Signed-off-by: Soheil Hassas Yeganeh <soheil@google.com>
    Acked-by: Willem de Bruijn <willemb@google.com>
    Signed-off-by: David S. Miller <davem@davemloft.net>

commit 6b084928baac562ed61866f540a96120e9c9ddb7
Author: Soheil Hassas Yeganeh <soheil@google.com>
Date:   Sat Apr 2 23:08:08 2016 -0400

    tcp: use one bit in TCP_SKB_CB to mark ACK timestamps
    
    Currently, to avoid a cache line miss for accessing skb_shinfo,
    tcp_ack_tstamp skips socket that do not have
    SOF_TIMESTAMPING_TX_ACK bit set in sk_tsflags. This is
    implemented based on an implicit assumption that the
    SOF_TIMESTAMPING_TX_ACK is set via socket options for the
    duration that ACK timestamps are needed.
    
    To implement per-write timestamps, this check should be
    removed and replaced with a per-packet alternative that
    quickly skips packets missing ACK timestamps marks without
    a cache-line miss.
    
    To enable per-packet marking without a cache line miss, use
    one bit in TCP_SKB_CB to mark a whether a SKB might need a
    ack tx timestamp or not. Further checks in tcp_ack_tstamp are not
    modified and work as before.
    
    Signed-off-by: Soheil Hassas Yeganeh <soheil@google.com>
    Acked-by: Willem de Bruijn <willemb@google.com>
    Acked-by: Eric Dumazet <edumazet@google.com>
    Signed-off-by: David S. Miller <davem@davemloft.net>

commit 6db8b963a7a31047573f229492ff6fc0f51cc377
Author: Soheil Hassas Yeganeh <soheil@google.com>
Date:   Sat Apr 2 23:08:07 2016 -0400

    tcp: accept SOF_TIMESTAMPING_OPT_ID for passive TFO
    
    SOF_TIMESTAMPING_OPT_ID is set to get data-independent IDs
    to associate timestamps with send calls. For TCP connections,
    tp->snd_una is used as the starting point to calculate
    relative IDs.
    
    This socket option will fail if set before the handshake on a
    passive TCP fast open connection with data in SYN or SYN/ACK,
    since setsockopt requires the connection to be in the
    ESTABLISHED state.
    
    To address these, instead of limiting the option to the
    ESTABLISHED state, accept the SOF_TIMESTAMPING_OPT_ID option as
    long as the connection is not in LISTEN or CLOSE states.
    
    Signed-off-by: Soheil Hassas Yeganeh <soheil@google.com>
    Acked-by: Willem de Bruijn <willemb@google.com>
    Acked-by: Yuchung Cheng <ycheng@google.com>
    Acked-by: Eric Dumazet <edumazet@google.com>
    Signed-off-by: David S. Miller <davem@davemloft.net>

commit 4113652252fad972e0c191b1e536dc74a6faebdc
Author: Daniel Lezcano <daniel.lezcano@linaro.org>
Date:   Fri Apr 1 21:38:16 2016 +0200

    reset: Add missing function stub for device_reset
    
    The Mediatek's thermal driver fails to compile when the RESET_CONTROLLER
    option is not set. Logically, as the driver depends on this option to compile,
    the Kconfig should select it but actually that is not correct because the
    Kconfig provides also the COMPILE_TEST to increase the compile test coverage.
    
    By providing the missing 'device_reset' stub for the driver in reset.h, that
    let the kernel to compile on different platforms with the Mediatek thermal
    driver enabled with the COMPILE_TEST option.
    
    Signed-off-by: Daniel Lezcano <daniel.lezcano@linaro.org>
    Signed-off-by: Philipp Zabel <p.zabel@pengutronix.de>

commit 8a665d2f2f837664e214863f2cbf7ec17f34ae56
Author: Krzysztof Kozlowski <k.kozlowski@samsung.com>
Date:   Fri Mar 4 10:05:26 2016 +0900

    iio: adc: Fix build error of missing devm_ioremap_resource on UM
    
    The devres.o gets linked if HAS_IOMEM is present so on ARCH=um
    allyesconfig (COMPILE_TEST) failed with:
    
    drivers/built-in.o: In function `at91_adc_probe':
    at91-sama5d2_adc.c:(.text+0x48f548): undefined reference to `devm_ioremap_resource'
    
    Signed-off-by: Krzysztof Kozlowski <k.kozlowski@samsung.com>
    Signed-off-by: Jonathan Cameron <jic23@kernel.org>

commit 698f415cf5756e320623bdb015a600945743377c
Merge: b4cec5f66849 45996492e5c8
Author: Linus Torvalds <torvalds@linux-foundation.org>
Date:   Sat Mar 26 12:59:04 2016 -0700

    Merge tag 'ofs-pull-tag-1' of git://git.kernel.org/pub/scm/linux/kernel/git/hubcap/linux
    
    Pull orangefs filesystem from Mike Marshall.
    
    This finally merges the long-pending orangefs filesystem, which has been
    much cleaned up with input from Al Viro over the last six months.  From
    the documentation file:
    
     "OrangeFS is an LGPL userspace scale-out parallel storage system.  It
      is ideal for large storage problems faced by HPC, BigData, Streaming
      Video, Genomics, Bioinformatics.
    
      Orangefs, originally called PVFS, was first developed in 1993 by Walt
      Ligon and Eric Blumer as a parallel file system for Parallel Virtual
      Machine (PVM) as part of a NASA grant to study the I/O patterns of
      parallel programs.
    
      Orangefs features include:
    
        - Distributes file data among multiple file servers
        - Supports simultaneous access by multiple clients
        - Stores file data and metadata on servers using local file system
          and access methods
        - Userspace implementation is easy to install and maintain
        - Direct MPI support
        - Stateless"
    
    see Documentation/filesystems/orangefs.txt for more in-depth details.
    
    * tag 'ofs-pull-tag-1' of git://git.kernel.org/pub/scm/linux/kernel/git/hubcap/linux: (174 commits)
      orangefs: fix orangefs_superblock locking
      orangefs: fix do_readv_writev() handling of error halfway through
      orangefs: have ->kill_sb() evict the VFS side of things first
      orangefs: sanitize ->llseek()
      orangefs-bufmap.h: trim unused junk
      orangefs: saner calling conventions for getting a slot
      orangefs_copy_{to,from}_bufmap(): don't pass bufmap pointer
      orangefs: get rid of readdir_handle_s
      ornagefs: ensure that truncate has an up to date inode size
      orangefs: move code which sets i_link to orangefs_inode_getattr
      orangefs: remove needless wrapper around GFP_KERNEL
      orangefs: remove wrapper around mutex_lock(&inode->i_mutex)
      orangefs: refactor inode type or link_target change detection
      orangefs: use new getattr for revalidate and remove old getattr
      orangefs: use new getattr in inode getattr and permission
      orangefs: use new orangefs_inode_getattr to get size in write and llseek
      orangefs: use new orangefs_inode_getattr to create new inodes
      orangefs: rename orangefs_inode_getattr to orangefs_inode_old_getattr
      orangefs: remove inode->i_lock wrapper
      orangefs: put register_chrdev immediately before register_filesystem
      ...

commit faea72dd0f155a9d349e191d74830716c702651d
Merge: 5b1e167d8de8 81ad4276b505
Author: Linus Torvalds <torvalds@linux-foundation.org>
Date:   Thu Mar 24 10:45:59 2016 -0700

    Merge branch 'next' of git://git.kernel.org/pub/scm/linux/kernel/git/rzhang/linux
    
    Pull thermal updates from Zhang Rui:
    
     - Fix a regression where bogus trip points on some Lenovo laptops start
       to screw up thermal control after commit 81ad4276b505 ("Thermal:
       initialize thermal zone device correctly").
    
       On these Lenovo laptops, a bogus passive trip point is reported,
       which is 0 degree Celsius.  Without commit 81ad4276b505, thermal zone
       fails to set cooling devices to proper cooling state, which is a bug.
       But with commit 81ad4276b505 applied, the processors are always
       throttled on these Lenovo laptops because the current temperature is
       always higher than the passive trip point.
    
       Fix things to ignore such bogus trip points.  (Zhang Rui)
    
     - Introduce Mediatek thermal driver.  (Sascha Hauer)
    
     - Introduce devm_ versions of OF thermal sensor register API.  (Laxman
       Dewangan)
    
     - Changes in Kconfigs to allow compile test on UM arch.  (Krzysztof
       Kozlowski)
    
     - Introduce Skylake support in intel_pch_thermal driver.  (Srinivas
       Pandruvada)
    
     - Several small fixes on Rockchip, TI-SoC, Tegra, RCar, and Exynos
       thermal drivers.
    
    * 'next' of git://git.kernel.org/pub/scm/linux/kernel/git/rzhang/linux: (26 commits)
      Thermal: Ignore invalid trip points
      thermal: trace: migrating thermal traces to use TRACE_DEFINE_ENUM() macros
      thermal: intel_pch_thermal: Enable Skylake PCH thermal
      thermal: doc: Add details of devm_thermal_zone_of_sensor_{register,unregister}
      thermal: of-thermal: Add devm version of thermal_zone_of_sensor_register
      thermal: doc: Add details of thermal_zone_of_sensor_{register,unregister}
      thermal: exynos: Defer probe if vtmu is present but not registered
      thermal: exynos: Use devm_regulator_get_optional() for vtmu
      thermal: exynos: List vtmu-supply as optional property in DT binding
      thermal: exynos: Print a message about exceeded number of supported trip-points
      thermal: exynos: Document number of supported trip-points
      thermal: exynos: Document compatible for Exynos5433 TMU
      thermal: mtk: allow compile testing on UM
      thermal: tegra_soctherm: fix sign bit of temperature
      thermal: Fix build error of missing devm_ioremap_resource on UM
      thermal: ti-soc-thermal: clean up the error handling a bit
      thermal: rcar: Use ARCH_RENESAS
      thermal: rcar_thermal: don't open code of_device_get_match_data()
      thermal: db8500_cpufreq_cooling: Compile with COMPILE_TEST
      thermal: rockchip: fix the tsadc sequence output on rk3228/rk3399
      ...

commit d34687ab97731b3a707106f78756342b61f46dbc
Merge: 77d913178c24 deaf7565eb61
Author: Linus Torvalds <torvalds@linux-foundation.org>
Date:   Mon Mar 21 13:00:46 2016 -0700

    Merge tag 'arc-4.6-rc1' of git://git.kernel.org/pub/scm/linux/kernel/git/vgupta/arc
    
    Pull ARC architecture updates from Vineet Gupta:
     - Big Endian io accessors fix [Lada]
     - Spellos fixes [Adam]
     - Fix for DW GMAC breakage [Alexey]
     - Making DMA API 64-bit ready
     - Shutting up -Wmaybe-uninitialized noise for ARC
     - Other minor fixes here and there, comments update
    
    * tag 'arc-4.6-rc1' of git://git.kernel.org/pub/scm/linux/kernel/git/vgupta/arc: (21 commits)
      ARCv2: ioremap: Support dynamic peripheral address space
      ARC: dma: reintroduce platform specific dma<->phys
      ARC: dma: ioremap: use phys_addr_t consistenctly in code paths
      ARC: dma: pass_phys() not sg_virt() to cache ops
      ARC: dma: non-coherent pages need V-P mapping if in HIGHMEM
      ARC: dma: Use struct page based page allocator helpers
      ARC: build: Turn off -Wmaybe-uninitialized for ARC gcc 4.8
      ARC: [plat-axs10x] add Ethernet PHY description in .dts
      arc: use of_platform_default_populate() to populate default bus
      ARC: thp: unbork !CONFIG_TRANSPARENT_HUGEPAGE build
      arc: [plat-nsimosci*] use ezchip network driver
      ARCv2: LLSC: software backoff is NOT needed starting HS2.1c
      ARC: mm: Use virt_to_pfn() for addr >> PAGE_SHIFT pattern
      ARC: [plat-nsim] document ranges
      ARC: build: Better way to detect ISA compatible toolchain
      ARCv2: Allow enabling PAE40 w/o HIGHMEM
      ARC: [BE] readl()/writel() to work in Big Endian CPU configuration
      ARC: [*defconfig] No need to specify CONFIG_CROSS_COMPILE
      ARC: [BE] Select correct CROSS_COMPILE prefix
      ARC: bitops: Remove non relevant comments
      ...

commit 26660a4046b171a752e72a1dd32153230234fe3a
Merge: 46e595a17dcf 1bcb58a09993
Author: Linus Torvalds <torvalds@linux-foundation.org>
Date:   Sun Mar 20 18:23:21 2016 -0700

    Merge branch 'core-objtool-for-linus' of git://git.kernel.org/pub/scm/linux/kernel/git/tip/tip
    
    Pull 'objtool' stack frame validation from Ingo Molnar:
     "This tree adds a new kernel build-time object file validation feature
      (ONFIG_STACK_VALIDATION=y): kernel stack frame correctness validation.
      It was written by and is maintained by Josh Poimboeuf.
    
      The motivation: there's a category of hard to find kernel bugs, most
      of them in assembly code (but also occasionally in C code), that
      degrades the quality of kernel stack dumps/backtraces.  These bugs are
      hard to detect at the source code level.  Such bugs result in
      incorrect/incomplete backtraces most of time - but can also in some
      rare cases result in crashes or other undefined behavior.
    
      The build time correctness checking is done via the new 'objtool'
      user-space utility that was written for this purpose and which is
      hosted in the kernel repository in tools/objtool/.  The tool's (very
      simple) UI and source code design is shaped after Git and perf and
      shares quite a bit of infrastructure with tools/perf (which tooling
      infrastructure sharing effort got merged via perf and is already
      upstream).  Objtool follows the well-known kernel coding style.
    
      Objtool does not try to check .c or .S files, it instead analyzes the
      resulting .o generated machine code from first principles: it decodes
      the instruction stream and interprets it.  (Right now objtool supports
      the x86-64 architecture.)
    
      From tools/objtool/Documentation/stack-validation.txt:
    
       "The kernel CONFIG_STACK_VALIDATION option enables a host tool named
        objtool which runs at compile time.  It has a "check" subcommand
        which analyzes every .o file and ensures the validity of its stack
        metadata.  It enforces a set of rules on asm code and C inline
        assembly code so that stack traces can be reliable.
    
        Currently it only checks frame pointer usage, but there are plans to
        add CFI validation for C files and CFI generation for asm files.
    
        For each function, it recursively follows all possible code paths
        and validates the correct frame pointer state at each instruction.
    
        It also follows code paths involving special sections, like
        .altinstructions, __jump_table, and __ex_table, which can add
        alternative execution paths to a given instruction (or set of
        instructions).  Similarly, it knows how to follow switch statements,
        for which gcc sometimes uses jump tables."
    
      When this new kernel option is enabled (it's disabled by default), the
      tool, if it finds any suspicious assembly code pattern, outputs
      warnings in compiler warning format:
    
        warning: objtool: rtlwifi_rate_mapping()+0x2e7: frame pointer state mismatch
        warning: objtool: cik_tiling_mode_table_init()+0x6ce: call without frame pointer save/setup
        warning: objtool:__schedule()+0x3c0: duplicate frame pointer save
        warning: objtool:__schedule()+0x3fd: sibling call from callable instruction with changed frame pointer
    
      ... so that scripts that pick up compiler warnings will notice them.
      All known warnings triggered by the tool are fixed by the tree, most
      of the commits in fact prepare the kernel to be warning-free.  Most of
      them are bugfixes or cleanups that stand on their own, but there are
      also some annotations of 'special' stack frames for justified cases
      such entries to JIT-ed code (BPF) or really special boot time code.
    
      There are two other long-term motivations behind this tool as well:
    
       - To improve the quality and reliability of kernel stack frames, so
         that they can be used for optimized live patching.
    
       - To create independent infrastructure to check the correctness of
         CFI stack frames at build time.  CFI debuginfo is notoriously
         unreliable and we cannot use it in the kernel as-is without extra
         checking done both on the kernel side and on the build side.
    
      The quality of kernel stack frames matters to debuggability as well,
      so IMO we can merge this without having to consider the live patching
      or CFI debuginfo angle"
    
    * 'core-objtool-for-linus' of git://git.kernel.org/pub/scm/linux/kernel/git/tip/tip: (52 commits)
      objtool: Only print one warning per function
      objtool: Add several performance improvements
      tools: Copy hashtable.h into tools directory
      objtool: Fix false positive warnings for functions with multiple switch statements
      objtool: Rename some variables and functions
      objtool: Remove superflous INIT_LIST_HEAD
      objtool: Add helper macros for traversing instructions
      objtool: Fix false positive warnings related to sibling calls
      objtool: Compile with debugging symbols
      objtool: Detect infinite recursion
      objtool: Prevent infinite recursion in noreturn detection
      objtool: Detect and warn if libelf is missing and don't break the build
      tools: Support relative directory path for 'O='
      objtool: Support CROSS_COMPILE
      x86/asm/decoder: Use explicitly signed chars
      objtool: Enable stack metadata validation on 64-bit x86
      objtool: Add CONFIG_STACK_VALIDATION option
      objtool: Add tool to perform compile-time stack metadata validation
      x86/kprobes: Mark kretprobe_trampoline() stack frame as non-standard
      sched: Always inline context_switch()
      ...

commit 33b3d2e88c9efd701b6153ca4714d4aa6e9f5af0
Merge: e88fa1b8b00a 307d40c56b0c
Author: Linus Torvalds <torvalds@linux-foundation.org>
Date:   Sun Mar 20 14:57:08 2016 -0700

    Merge tag 'armsoc-soc' of git://git.kernel.org/pub/scm/linux/kernel/git/arm/arm-soc
    
    Pull ARM SoC platform updates from Arnd Bergmann:
     "Newly added support for additional SoCs:
       - Axis Artpec-6 SoC family
       - Allwinner A83T SoC
       - Mediatek MT7623
       - NXP i.MX6QP SoC
       - ST Microelectronics stm32f469 microcontroller
    
      New features:
       - SMP support for Mediatek mt2701
       - Big-endian support for NXP i.MX
       - DaVinci now uses the new DMA engine dma_slave_map
       - OMAP now uses the new DMA engine dma_slave_map
       - earlyprintk support for palmchip uart on mach-tango
       - delay timer support for orion
    
      Other:
       - Exynos PMU driver moved out to drivers/soc/
       - Various smaller updates for Renesas, Xilinx, PXA, AT91, OMAP,
         uniphier"
    
    * tag 'armsoc-soc' of git://git.kernel.org/pub/scm/linux/kernel/git/arm/arm-soc: (83 commits)
      ARM: uniphier: rework SMP code to support new System Bus binding
      ARM: uniphier: add missing of_node_put()
      ARM: at91: avoid defining CONFIG_* symbols in source code
      ARM: DRA7: hwmod: Add data for eDMA tpcc, tptc0, tptc1
      ARM: imx: Make reset_control_ops const
      ARM: imx: Do L2 errata only if the L2 cache isn't enabled
      ARM: imx: select ARM_CPU_SUSPEND only for imx6
      dmaengine: pxa_dma: fix the maximum requestor line
      ARM: alpine: select the Alpine MSI controller driver
      ARM: pxa: add the number of DMA requestor lines
      dmaengine: mmp-pdma: add number of requestors
      dma: mmp_pdma: Add the #dma-requests DT property documentation
      ARM: OMAP2+: Add rtc hwmod configuration for ti81xx
      ARM: s3c24xx: Avoid warning for inb/outb
      ARM: zynq: Move early printk virtual address to vmalloc area
      ARM: DRA7: hwmod: Add custom reset handler for PCIeSS
      ARM: SAMSUNG: Remove unused register offset definition
      ARM: EXYNOS: Cleanup header files inclusion
      drivers: soc: samsung: Enable COMPILE_TEST
      MAINTAINERS: Add maintainers entry for drivers/soc/samsung
      ...

commit e88fa1b8b00a947299e2415e819301fa52037cf4
Merge: dae0b74eb7ab 809683ee060d
Author: Linus Torvalds <torvalds@linux-foundation.org>
Date:   Sun Mar 20 14:37:22 2016 -0700

    Merge tag 'armsoc-cleanup' of git://git.kernel.org/pub/scm/linux/kernel/git/arm/arm-soc
    
    Pull ARM SoC cleanups from Arnd Bergmann:
     "A few simple cleanups across multiple platforms, not much standing
      out:
    
       - lpc32xx removes its private implementation of the clk API, after
         generic code was merged in 4.5
       - all unused Makefile.boot files get removed
       - a number of simplifications for shmobile
       - asm/clkdev.h gets replaced with the asm-generic version after all
         mach/clkdev.h implementations are gone"
    
    * tag 'armsoc-cleanup' of git://git.kernel.org/pub/scm/linux/kernel/git/arm/arm-soc:
      ARM: shmobile: Kconfig: Get rid of old comment
      ARM: shmobile: Consolidate SCU mapping code
      arm: lpc32xx: remove direct control of GPIOs from shared mach file
      arm: lpc32xx: remove selected HAVE_IDE
      arm: lpc32xx: switch to common clock framework
      ARM: Use generic clkdev.h header
      ARM: plat-versatile: Remove unused clock.c file
      ARM: netx: remove redundant "depends on ARCH_NETX"
      ARM: integrator: remove redundant select in Kconfig
      ARM: drop unused Makefile.boot of Multiplatform SoCs
      ARM: mvebu: add missing of_node_put()
      ARM: shmobile: r8a7779: Remove remainings of removed SCU boot setup code
      ARM: shmobile: Typo s/MIPDR/MPIDR/
      ARM: shmobile: Add includes providing forward declarations
      ARM: shmobile: rcar-gen2: Make rcar_gen2_dma_contiguous static
      ARM: mv78xx0: use "depends on" instead of "if" after prompt

commit 31e182363b39d84031eadf0caf6d99fd9eb056f0
Merge: 1200b6809dfd 5027e19db8ce
Author: Linus Torvalds <torvalds@linux-foundation.org>
Date:   Sat Mar 19 15:15:07 2016 -0700

    Merge tag 'devicetree-for-4.6' of git://git.kernel.org/pub/scm/linux/kernel/git/robh/linux
    
    Pull DeviceTree updates from Rob Herring:
    
     - new tool 'dtx_diff' to diff DT files
    
     - sync kernel's dtc/libfdt to current dtc repo master
    
     - fix for reserved memory regions located in highmem
    
     - document standard unit suffixes for DT properties
    
     - various DT binding doc updates
    
    * tag 'devicetree-for-4.6' of git://git.kernel.org/pub/scm/linux/kernel/git/robh/linux:
      of: Add vendor prefix for eGalax_eMPIA Technology Inc
      Input: ads7846: Add description how to use internal reference (ADS7846)
      ARM: realview: add EB syscon variants to bindings
      devicetree: bindings: ARM: Use "uV" for micro-volt
      serial: fsl-imx-uart: Fix typo in fsl,dte-mode description
      of: add 'const' for of_property_*_string*() parameter '*np'
      of/unittest: fix infinite loop in of_unittest_destroy_tracked_overlays()
      of: alloc anywhere from memblock if range not specified
      kbuild: Allow using host dtc instead of kernel's copy
      of: resolver: Add missing of_node_get and of_node_put
      of: Add United Radiant Technology Corporation vendor prefix
      dt/bindings: add documentation on standard property unit suffixes
      scripts/dtc: Update to upstream commit b06e55c88b9b
      ARM: boot: Add an implementation of strnlen for libfdt
      scripts/dtc: dtx_diff - add info to error message
      dtc: create tool to diff device trees

commit 5027e19db8cee24e189f8afa53b548e1ac5d0c1d
Author: Fabio Estevam <fabio.estevam@nxp.com>
Date:   Fri Mar 4 19:12:01 2016 -0300

    of: Add vendor prefix for eGalax_eMPIA Technology Inc
    
    eGalax_eMPIA Technology Inc (EETI) is a company specialized in
    touchscreen controller solutions.
    
    Signed-off-by: Fabio Estevam <fabio.estevam@nxp.com>
    Signed-off-by: Rob Herring <robh@kernel.org>

commit ef086c0d5dd9a151578c72b6f257e5b0e77d65eb
Author: Mike Marciniszyn <mike.marciniszyn@intel.com>
Date:   Mon Mar 7 11:35:08 2016 -0800

    IB/hfi1: Report pid in qp_stats to aid debug
    
    Tracking user/QP ownership is needed to debug issues with
    user ULPs like OpenMPI.
    
    Reviewed-by: Dennis Dalessandro <dennis.dalessandro@intel.com>
    Signed-off-by: Mike Marciniszyn <mike.marciniszyn@intel.com>
    Signed-off-by: Doug Ledford <dledford@redhat.com>

commit 895f5542220eeea43b811a9b4cd73f244c5673d7
Author: Paul E. McKenney <paulmck@linux.vnet.ibm.com>
Date:   Wed Jan 6 14:23:03 2016 -0800

    documentation: Fix memory-barriers.txt section references
    
    This commit fixes a couple of "Compiler Barrier" section references to
    be "COMPILER BARRIER".  This makes it easier to find the section in
    the usual text editors.
    
    Signed-off-by: Paul E. McKenney <paulmck@linux.vnet.ibm.com>

commit 7a587eae2a8b6eeb7919fd25f686fa20b14f4821
Author: Alexandre Belloni <alexandre.belloni@free-electrons.com>
Date:   Sun May 3 11:00:57 2015 +0200

    rtc: enable COMPILE_TEST
    
    There are several arch-specific RTC drivers that can be successfully
    compiled on other platforms. Add a COMPILE_TEST dependency for those.
    
    Signed-off-by: Alexandre Belloni <alexandre.belloni@free-electrons.com>
    Acked-by: Geert Uytterhoeven <geert@linux-m68k.org>

commit 64232fc33a5bcc29aeb001e1bee80e17a889b4fb
Author: Arnd Bergmann <arnd@arndb.de>
Date:   Tue Mar 1 17:59:57 2016 +0100

    rtc: generic: allow building on all architectures
    
    There are four architectures using this driver, but since we can
    build it with COMPILE_TEST, we should try dealing with the absence
    of the asm/rtc.h header file, to avoid getting a build error:
    
    drivers/rtc/rtc-generic.c:12:21: fatal error: asm/rtc.h: No such file or directory
    
    This creates an alternative use of the driver, allowing architectures
    to pass a set of rtc_class_ops in platform data. We can convert the
    four architectures to use this and then remove the original
    code.
    
    Signed-off-by: Arnd Bergmann <arnd@arndb.de>
    Signed-off-by: Alexandre Belloni <alexandre.belloni@free-electrons.com>

commit c7e1d89b3480fc3f5cbce8b8d87d0ab4882e05b8
Merge: 2f85bb09d95e c87b3e970c70
Author: Olof Johansson <olof@lixom.net>
Date:   Sat Mar 12 17:13:34 2016 -0800

    Merge tag 'samsung-soc64-4.6-2' of git://git.kernel.org/pub/scm/linux/kernel/git/krzk/linux into next/arm64
    
    Samsung Exynos ARM64 improvements for v4.6:
    1. Remove separate ARCH_EXYNOS7 symbol and consolidate it into
       one ARCH_EXYNOS.
    
    This depends on clk tree: removal of last presence of ARCH_EXYNOS7.
    
    * tag 'samsung-soc64-4.6-2' of git://git.kernel.org/pub/scm/linux/kernel/git/krzk/linux:
      arm64: EXYNOS: Consolidate ARCH_EXYNOS7 symbol into ARCH_EXYNOS
      clk: samsung: Don't build ARMv8 clock drivers on ARMv7
      clk: samsung: Enable COMPILE_TEST for Samsung clocks
      clk: Move vendor's Kconfig into CCF menu section
      clk: mediatek: Fix memory leak on clock init fail
      clk: move the common clock's to_clk_*(_hw) macros to clk-provider.h
      clk: xgene: Remove return from void function
      clk: xgene: Add SoC and PMD PLL clocks with v2 hardware
      Documentation: Update APM X-Gene clock binding for v2 hardware
      clk: s2mps11: remove redundant code
      clk: s2mps11: remove redundant static variables declaration
      clk: s2mps11: allocate only one structure for clock init
      clk: s2mps11: merge two for loops in one
      clk-divider: make sure read-only dividers do not write to their register
      clk: tango4: rename ARCH_TANGOX to ARCH_TANGO
      clk: scpi: Fix checking return value of platform_device_register_simple()
      clk: mvebu: Mark ioremapped memory as __iomem
    
    Signed-off-by: Olof Johansson <olof@lixom.net>

commit 2a993a587e268459e376303aa894a6b236565b6d
Merge: 0d8ec17ca34b 15925cfcf833
Author: Olof Johansson <olof@lixom.net>
Date:   Sat Mar 12 17:10:20 2016 -0800

    Merge tag 'samsung-soc-4.6-2' of git://git.kernel.org/pub/scm/linux/kernel/git/krzk/linux into next/soc
    
    Samsung Exynos (and older platforms) improvements for v4.6:
    1. Split out Exynos PMU driver implementation from arm/mach-exynos
       to the drivers/soc/samsung which will allow re-use of it on ARM64.
    2. Use generic DT cpufreq driver on Exynos542x/5800.
    3. Minor cleanups.
    
    * tag 'samsung-soc-4.6-2' of git://git.kernel.org/pub/scm/linux/kernel/git/krzk/linux:
      ARM: s3c24xx: Avoid warning for inb/outb
      ARM: SAMSUNG: Remove unused register offset definition
      ARM: EXYNOS: Cleanup header files inclusion
      drivers: soc: samsung: Enable COMPILE_TEST
      MAINTAINERS: Add maintainers entry for drivers/soc/samsung
      drivers: soc: Add support for Exynos PMU driver
      ARM: EXYNOS: Split up exynos5420 SoC specific PMU data
      ARM: EXYNOS: Split up exynos5250 SoC specific PMU data
      ARM: EXYNOS: Split up exynos4 SoC specific PMU data
      ARM: EXYNOS: Split up exynos3250 SoC specific PMU data
      ARM: EXYNOS: Move pmu specific headers under "linux/soc/samsung"
      ARM: EXYNOS: Correct header comment in Kconfig file
      ARM: EXYNOS: Use generic cpufreq driver for Exynos5422/5800
      ARM: EXYNOS: Use generic cpufreq driver for Exynos5420
      ARM: s3c64xx: use "depends on" instead of "if" after prompt
      ARM: plat-samsung: use to_platform_device()
      ARM: EXYNOS: Code cleanup in map.h
      ARM: EXYNOS: Remove unused static mapping of CMU for exynos5
    
    Signed-off-by: Olof Johansson <olof@lixom.net>

commit 2d746eeb4f70e3602dea0aec174072adc0ab8ce5
Author: Vineet Gupta <vgupta@synopsys.com>
Date:   Fri Mar 11 12:40:17 2016 +0530

    ARC: [*defconfig] No need to specify CONFIG_CROSS_COMPILE
    
    The problem is with CONFIG_CPU_BIG_ENDIAN=y we still needed .config
    fixup to override the the defconfig prefix to arceb-linux-
    
    So remove these from defconfig and let user pass this via CROSS_COMPILE
    environment var or use the default for ENDIAN (per previous patch)
    
    No other arch carries them in defconfigs anyways !
    
    Cc: Noam Camus <noamc@ezchip.com>
    Cc: Alexey Brodkin <abrodkin@synopsys.com>
    Cc: Anton Kolesov <akolesov@synosys.com>
    Signed-off-by: Vineet Gupta <vgupta@synopsys.com>

commit 89a269285fe350346b794676c79119b31015292f
Author: Vineet Gupta <vgupta@synopsys.com>
Date:   Fri Mar 11 12:47:58 2016 +0530

    ARC: [BE] Select correct CROSS_COMPILE prefix
    
    This allows CONFIG_CPU_BIG_ENDIAN=y to build correctly out of the box,
    w/o any other tweaks.
    
    Cc: Noam Camus <noamc@ezchip.com>
    Cc: Alexey Brodkin <abrodkin@synopsys.com>
    Cc: Anton Kolesov <akolesov@synosys.com>
    Signed-off-by: Vineet Gupta <vgupta@synopsys.com>

commit 7b0b01aa8f48cd237322cbffa05662a9c6b156f8
Author: Dean Luick <dean.luick@intel.com>
Date:   Wed Feb 3 14:35:49 2016 -0800

    staging/rdma/hfi1: Split last 8 bytes of copy to user buffer
    
    Copy the last 8 bytes of user mode RC WRITE_ONLY and WRITE_LAST
    opcodes separately from the rest of the data.
    
    It is a de-facto standard for some MPI implementations to use a
    poll on the last few bytes of a verbs message to indicate that
    the message has been received rather than follow the required
    function method.  The driver uses the kernel memcpy routine, which
    becomes "rep movsb" on modern machines.  This copy, while very
    fast, does not guarantee in-order copy completion and the result
    is an occasional perceived corrupted packet.  Avoid the issue by
    splitting the last 8 bytes to copy from the verbs opcodes where it
    matters and performing an in-order byte copy.
    
    Reviewed-by: Mike Marciniszyn <mike.marciniszyn@intel.com>
    Signed-off-by: Dean Luick <dean.luick@intel.com>
    Signed-off-by: Jubin John <jubin.john@intel.com>
    Signed-off-by: Doug Ledford <dledford@redhat.com>

commit b5576e08d17fcf81bd0869c26e2c25f4181b11d2
Author: Paul Gortmaker <paul.gortmaker@windriver.com>
Date:   Mon Feb 29 15:48:41 2016 -0500

    pinctrl: stm32: make explicitly non-modular
    
    The Kconfig currently controlling compilation of this code is:
    
    drivers/pinctrl/stm32/Kconfig:config PINCTRL_STM32F429
    drivers/pinctrl/stm32/Kconfig:  bool "STMicroelectronics STM32F429 pin control" if COMPILE_TEST && !MACH_STM32F429
    
    ...meaning that it currently is not being built as a module by anyone.
    
    Lets remove the modular code that is essentially orphaned, so that
    when reading the driver there is no doubt it is builtin-only.
    
    Since module_init translates to device_initcall in the non-modular
    case, the init ordering remains unchanged with this commit.
    
    Also note that MODULE_DEVICE_TABLE is a no-op for non-modular code.
    
    We also delete the MODULE_LICENSE tag etc. since all that information
    is already contained at the top of the file in the comments.
    
    Cc: Patrice Chotard <patrice.chotard@st.com>
    Cc: linux-gpio@vger.kernel.org
    Cc: linux-arm-kernel@lists.infradead.org
    Signed-off-by: Paul Gortmaker <paul.gortmaker@windriver.com>
    Acked-by: Maxime Coquelin <mcoquelin.stm32@gmail.com>
    Signed-off-by: Linus Walleij <linus.walleij@linaro.org>

commit d4bc6b920b8ed73882ac1d2c42d2c1ca4b2c63ae
Author: Paul Gortmaker <paul.gortmaker@windriver.com>
Date:   Mon Feb 29 15:48:38 2016 -0500

    pinctrl: pinctrl-mt6397 driver explicitly non-modular
    
    The Kconfig for this driver is currently:
    
    config PINCTRL_MT6397
            bool "Mediatek MT6397 pin control" if COMPILE_TEST && !MFD_MT6397
    
    ...meaning that it is currently not being built as a module by anyone.
    Lets remove the modular code that is essentially orphaned, so that
    when reading the driver there is no doubt it is builtin-only.
    
    Since module_init translates to device_initcall in the non-modular
    case, the init ordering remains unchanged with this commit.
    
    We also delete the MODULE_LICENSE tag etc. since all that information
    is already contained at the top of the file in the comments.
    
    Also note that MODULE_DEVICE_TABLE is a no-op for non-modular code.
    
    Cc: Matthias Brugger <matthias.bgg@gmail.com>
    Cc: linux-gpio@vger.kernel.org
    Cc: linux-mediatek@lists.infradead.org
    Signed-off-by: Paul Gortmaker <paul.gortmaker@windriver.com>
    Acked-by: Hongzhou Yang <hongzhou.yang@mediatek.com>
    Signed-off-by: Linus Walleij <linus.walleij@linaro.org>

commit bf82c350e940f5ee3508a94165a99eda81298d5f
Author: Krzysztof Kozlowski <k.kozlowski@samsung.com>
Date:   Fri Mar 4 10:03:59 2016 +0900

    thermal: Fix build error of missing devm_ioremap_resource on UM
    
    The devres.o gets linked if HAS_IOMEM is present so on ARCH=um
    allyesconfig (COMPILE_TEST) failed on many files with:
    
    drivers/built-in.o: In function `kirkwood_thermal_probe':
    kirkwood_thermal.c:(.text+0x390a25): undefined reference to `devm_ioremap_resource'
    drivers/built-in.o: In function `exynos_tmu_probe':
    exynos_tmu.c:(.text+0x39246b): undefined reference to `devm_ioremap'
    
    The users of devm_ioremap_resource() which are compile-testable should
    depend on HAS_IOMEM.
    
    Signed-off-by: Krzysztof Kozlowski <k.kozlowski@samsung.com>
    Signed-off-by: Eduardo Valentin <edubezval@gmail.com>

commit 527860fe4684bf69281d7479c5034243dd6c36c4
Author: Luis de Bethencourt <luisbg@osg.samsung.com>
Date:   Wed Oct 14 19:43:29 2015 +0100

    thermal: db8500_cpufreq_cooling: Compile with COMPILE_TEST
    
    This driver only has runtime but no build time dependencies, so it can be
    built for testing purposes if the Kconfig COMPILE_TEST option is enabled.
    
    This is useful to have more build coverage and make sure that drivers are
    not affected by changes that could cause build regressions.
    
    Signed-off-by: Luis de Bethencourt <luisbg@osg.samsung.com>
    Signed-off-by: Eduardo Valentin <edubezval@gmail.com>

commit 7d774fb8ca8c8686413ce847dc74473cc6196e7d
Author: Arnd Bergmann <arnd@arndb.de>
Date:   Wed Feb 17 16:02:34 2016 +0100

    serial: 8250/ingenic: fix building with SERIAL_8250=m
    
    The Ingenic 8250 driver has a 'bool' Kconfig symbol, but that
    breaks when SERIAL_8250 is a loadable module:
    
    drivers/tty/built-in.o: In function `ingenic_uart_probe':
    8250_ingenic.c:(.text+0x1c1a0): undefined reference to `serial8250_register_8250_port'
    
    This changes the symbol to a 'tristate', plus a dependency on
    SERIAL_8250, which makes it work again. Unlike the other
    soc-specific backends, this one has no dependency on an
    architecture or a platform. I'm adding a dependency on
    MIPS || COMPILE_TEST as well here, to avoid showing the driver
    on architectures that are not interested in it.
    
    Signed-off-by: Arnd Bergmann <arnd@arndb.de>
    Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>

commit 24030d9d9550d1a0b9bfcf6b60da29f7a2bb31cf
Author: Axel Lin <axel.lin@ingics.com>
Date:   Fri Feb 26 16:00:50 2016 +0800

    gpio: moxart: Allow compile test build
    
    There is no build dependency for this driver, so enable COMPILE_TEST to get
    better build coverage.
    
    Signed-off-by: Axel Lin <axel.lin@ingics.com>
    Signed-off-by: Linus Walleij <linus.walleij@linaro.org>

commit e84a41d5db891eab6f1f4a2625bb97f3c6415eee
Author: Krzysztof Kozlowski <k.kozlowski@samsung.com>
Date:   Fri Mar 4 10:05:26 2016 +0900

    iio: adc: Fix build error of missing devm_ioremap_resource on UM
    
    The devres.o gets linked if HAS_IOMEM is present so on ARCH=um
    allyesconfig (COMPILE_TEST) failed with:
    
    drivers/built-in.o: In function `at91_adc_probe':
    at91-sama5d2_adc.c:(.text+0x48f548): undefined reference to `devm_ioremap_resource'
    
    Signed-off-by: Krzysztof Kozlowski <k.kozlowski@samsung.com>
    Signed-off-by: Jonathan Cameron <jic23@kernel.org>

commit 2aedcd098a9448b11eab895ee79acf519686555a
Author: Masahiro Yamada <yamada.masahiro@socionext.com>
Date:   Thu Mar 3 17:36:30 2016 +0900

    kbuild: suppress annoying "... is up to date." message
    
    Under certain conditions, Kbuild shows "... is up to date" where
    if_changed or friends are used.
    
    For example, the incremental build of ARM64 Linux shows this message
    when the kernel image has not been updated.
    
      $ make ARCH=arm64 CROSS_COMPILE=aarch64-linux-gnu-
        CHK     include/config/kernel.release
        CHK     include/generated/uapi/linux/version.h
        CHK     include/generated/utsrelease.h
        CHK     include/generated/bounds.h
        CHK     include/generated/timeconst.h
        CHK     include/generated/asm-offsets.h
        CALL    scripts/checksyscalls.sh
        CHK     include/generated/compile.h
        CHK     kernel/config_data.h
      make[1]: `arch/arm64/boot/Image.gz' is up to date.
        Building modules, stage 2.
        MODPOST 0 modules
    
    The following is the build rule in arch/arm64/boot/Makefile:
    
      $(obj)/Image.gz: $(obj)/Image FORCE
              $(call if_changed,gzip)
    
    If the Image.gz is newer than the Image and the command line has not
    changed (i.e., $(any-prereq) and $(arg-check) are both empty), the
    build rule $(call if_changed,gzip) is evaluated to be empty, then
    GNU Make reports the target is up to date.  In order to make GNU Make
    quiet, we need to give it something to do, for example, "@:".  This
    should be fixed in the Kbuild core part rather than in each Makefile.
    
    Signed-off-by: Masahiro Yamada <yamada.masahiro@socionext.com>
    Signed-off-by: Michal Marek <mmarek@suse.com>

commit c1d45c3abd49b5bf9447e435099c1b000dcde752
Author: Josh Poimboeuf <jpoimboe@redhat.com>
Date:   Wed Mar 2 18:39:37 2016 -0600

    objtool: Support CROSS_COMPILE
    
    When building with CONFIG_STACK_VALIDATION on a ppc64le host with an x86
    cross-compiler, Stephen Rothwell saw the following objtool build errors:
    
        DESCEND  objtool
        CC       /home/sfr/next/x86_64_allmodconfig/tools/objtool/builtin-check.o
        CC       /home/sfr/next/x86_64_allmodconfig/tools/objtool/special.o
        CC       /home/sfr/next/x86_64_allmodconfig/tools/objtool/elf.o
        CC       /home/sfr/next/x86_64_allmodconfig/tools/objtool/objtool.o
        MKDIR    /home/sfr/next/x86_64_allmodconfig/tools/objtool/arch/x86/insn/
        CC       /home/sfr/next/x86_64_allmodconfig/tools/objtool/libstring.o
      elf.c:22:23: fatal error: sys/types.h: No such file or directory
      compilation terminated.
        CC       /home/sfr/next/x86_64_allmodconfig/tools/objtool/exec-cmd.o
        CC       /home/sfr/next/x86_64_allmodconfig/tools/objtool/help.o
      builtin-check.c:28:20: fatal error: string.h: No such file or directory
      compilation terminated.
      objtool.c:28:19: fatal error: stdio.h: No such file or directory
      compilation terminated.
    
    It fails to build because it tries to compile objtool with the
    cross-compiler instead of the host compiler.
    
    Ensure that it always uses the host compiler by ignoring CROSS_COMPILE.
    
    In order to do that properly, the libsubcmd.a library needs to be built
    in tools/objtool/ rather than tools/lib/subcmd/.  The latter directory
    contains the cross-compiled version which is needed for perf and
    possibly other tools.
    
    Note that cross-compiling for x86 on a _big_ endian system would result
    in a bunch of false positive objtool warnings during the kernel build
    because it isn't endian-aware.  But that's generally a rare edge case
    and there haven't been any reports of anybody needing that.
    
    Reported-by: Stephen Rothwell <sfr@canb.auug.org.au>
    Signed-off-by: Josh Poimboeuf <jpoimboe@redhat.com>
    Cc: Adrian Hunter <adrian.hunter@intel.com>
    Cc: Linus Torvalds <torvalds@linux-foundation.org>
    Cc: Masami Hiramatsu <masami.hiramatsu.pt@hitachi.com>
    Cc: Michael Ellerman <mpe@ellerman.id.au>
    Cc: Peter Zijlstra <peterz@infradead.org>
    Cc: Thomas Gleixner <tglx@linutronix.de>
    Link: http://lkml.kernel.org/r/55b63eefc347f1bb28573f972d8d1adbf1f1c31d.1456962210.git.jpoimboe@redhat.com
    Signed-off-by: Ingo Molnar <mingo@kernel.org>

commit c2ee9bdc852dcd1f2f3a6adaa986f14441a673f3
Author: Tony Lindgren <tony@atomide.com>
Date:   Fri Feb 26 09:45:03 2016 -0800

    clk: ti: Allow COMPILE_TEST to build selected drivers
    
    The arch independent drivers can be build testeed with
    COMPILE_TEST. Let's allow that for drivers/clk/ti.
    
    Signed-off-by: Tony Lindgren <tony@atomide.com>
    Signed-off-by: Michael Turquette <mturquette@baylibre.com>

commit 89636adde4a05953e3bf18807ba1f6f205572f67
Author: Krzysztof Kozlowski <k.kozlowski@samsung.com>
Date:   Mon Feb 29 14:56:30 2016 +0900

    phy: Fix armada375 compile test build on UM
    
    The phy-armada375-usb2 driver uses IOMEM functions so COMPILE_TEST && OF
    build failed with:
    
    drivers/built-in.o: In function `armada375_usb_phy_probe':
    phy-armada375-usb2.c:(.text+0x121d): undefined reference to
    `devm_ioremap_resource'
    
    Signed-off-by: Krzysztof Kozlowski <k.kozlowski@samsung.com>
    Signed-off-by: Kishon Vijay Abraham I <kishon@ti.com>

commit 3abb33ac652135da9c3c36d9def73ede67e4ba03
Author: Mitko Haralanov <mitko.haralanov@intel.com>
Date:   Fri Feb 5 11:57:54 2016 -0500

    staging/hfi1: Add TID cache receive init and free funcs
    
    The upcoming TID caching feature requires different data
    structures and, by extension, different initialization for each
    of the MPI processes.
    
    The two new functions (currently unused) perform the required
    initialization and freeing of required resources and structures.
    
    Signed-off-by: Mitko Haralanov <mitko.haralanov@intel.com>
    Reviewed-by: Ira Weiny <ira.weiny@intel.com>
    Signed-off-by: Doug Ledford <dledford@redhat.com>

commit 9c6bd0c2f103f4748cb4abcaf141f7d11aabfe9f
Author: Arnd Bergmann <arnd@arndb.de>
Date:   Fri Feb 26 13:46:27 2016 +0100

    lib/mpi: use "static inline" instead of "extern inline"
    
    When we use CONFIG_PROFILE_ALL_BRANCHES, every 'if()' introduces
    a static variable, but that is not allowed in 'extern inline'
    functions:
    
    mpi-inline.h:116:204: warning: '______f' is static but declared in inline function 'mpihelp_sub' which is not static
    mpi-inline.h:113:184: warning: '______f' is static but declared in inline function 'mpihelp_sub' which is not static
    mpi-inline.h:70:184: warning: '______f' is static but declared in inline function 'mpihelp_add' which is not static
    mpi-inline.h:56:204: warning: '______f' is static but declared in inline function 'mpihelp_add_1' which is not static
    
    This changes the MPI code to use 'static inline' instead, to get
    rid of hundreds of warnings.
    
    Signed-off-by: Arnd Bergmann <arnd@arndb.de>
    Signed-off-by: Herbert Xu <herbert@gondor.apana.org.au>

commit 3ee0cb5fb5eea2110db1b5cb7f67029b7be8a376
Author: Michal Marek <mmarek@suse.com>
Date:   Wed Feb 17 14:46:59 2016 +0100

    lib/mpi: Endianness fix
    
    The limbs are integers in the host endianness, so we can't simply
    iterate over the individual bytes. The current code happens to work on
    little-endian, because the order of the limbs in the MPI array is the
    same as the order of the bytes in each limb, but it breaks on
    big-endian.
    
    Fixes: 0f74fbf77d45 ("MPI: Fix mpi_read_buffer")
    Signed-off-by: Michal Marek <mmarek@suse.com>
    Signed-off-by: Herbert Xu <herbert@gondor.apana.org.au>

commit 4fccbbde1164346b96f88c9dbba6adda07d2c86f
Author: Axel Lin <axel.lin@ingics.com>
Date:   Thu Feb 25 13:41:30 2016 +0800

    gpio: mb86s7x: Allow compile test build
    
    There is no build dependency for this driver, so enable COMPILE_TEST to get
    better build coverage.
    
    Signed-off-by: Axel Lin <axel.lin@ingics.com>
    Signed-off-by: Linus Walleij <linus.walleij@linaro.org>

commit b11301d5adef74c8f8d80eb5a134cc4f3057aaa0
Author: Krzysztof Kozlowski <k.kozlowski@samsung.com>
Date:   Tue Feb 2 15:24:13 2016 +0900

    drivers: soc: samsung: Enable COMPILE_TEST
    
    Get some build coverage of Exynos PMU driver. It depends on
    asm/cputype.h so its compilation is limited to ARM architectures.
    
    Signed-off-by: Krzysztof Kozlowski <k.kozlowski@samsung.com>
    Reviewed-by: Javier Martinez Canillas <javier@osg.samsung.com>

commit 5c0e09e03fb5bc25ecb6a90c2bf89e0abc9f920f
Author: Wenyou Yang <wenyou.yang@atmel.com>
Date:   Mon Feb 15 16:22:03 2016 +0800

    power: act8945a: add charger driver for ACT8945A
    
    This patch adds new driver for Active-semi ACT8945A ActivePath
    charger (part of ACT8945A MFD driver) providing power supply class
    information to userspace.
    
    The driver can be configured through DT (such as, total timer,
    precondition timer and input over-voltage threshold).
    
    Signed-off-by: Wenyou Yang <wenyou.yang@atmel.com>
    Reviewed-by: Krzysztof Kozlowski <k.kozlowski@samsung.com>
    [ add "|| COMPILE_TEST" to MFD_ACT8945A dependency ]
    Signed-off-by: Sebastian Reichel <sre@kernel.org>

commit 5c739b6157bd090942e5847ddd12bfb99cd4240d
Author: Suganath prabu Subramani <suganath-prabu.subramani@avagotech.com>
Date:   Thu Jan 28 12:07:05 2016 +0530

    mpt3sas: Updated MPI Header to 2.00.42
    
    Updated MPI version and MPI header files.
    
    Signed-off-by: Suganath prabu Subramani <suganath-prabu.subramani@avagotech.com>
    Signed-off-by: Chaitra P B <chaitra.basappa@avagotech.com>
    Reviewed-by: Tomas Henzl <thenzl@redhat.com>
    Signed-off-by: Martin K. Petersen <martin.petersen@oracle.com>

commit ce61c574275651d964cf466469473726cb0e548f
Author: Suganath prabu Subramani <suganath-prabu.subramani@avagotech.com>
Date:   Thu Jan 28 12:06:59 2016 +0530

    mpt3sas: Used IEEE SGL instead of MPI SGL while framing a SMP Passthrough request message.
    
    As driver was using MPI SGL while framing the SMP Passthrough request
    message due to which firmware unable to post the Reply Data in the host
    memory and timeout is observed for this SMP Passthrough request message
    and so unable to perform phy disable operation.
    
    Signed-off-by: Suganath prabu Subramani <suganath-prabu.subramani@avagotech.com>
    Signed-off-by: Chaitra P B <chaitra.basappa@avagotech.com>
    Reviewed-by: Tomas Henzl <thenzl@redhat.com>
    Signed-off-by: Martin K. Petersen <martin.petersen@oracle.com>

commit b130b0d56fa97ef17796314995a9dc5dda0edaa5
Author: Suganath prabu Subramani <suganath-prabu.subramani@avagotech.com>
Date:   Thu Jan 28 12:06:58 2016 +0530

    mpt3sas: Added support for high port count HBA variants.
    
    Updated hardware description headers with MPI v2.6 and
    mpt3sas_pci_table[] with vendor_ids, device_ids of Cutlass and Intruder
    HBA which have support for 4 ports.
    
    Signed-off-by: Suganath prabu Subramani <suganath-prabu.subramani@avagotech.com>
    Signed-off-by: Chaitra P B <chaitra.basappa@avagotech.com>
    Reviewed-by: Tomas Henzl <thenzl@redhat.com>
    Signed-off-by: Martin K. Petersen <martin.petersen@oracle.com>

commit d846e78e491ff4dd0747026c02414844d504fcb6
Author: Tadeusz Struk <tadeusz.struk@intel.com>
Date:   Tue Feb 2 10:09:03 2016 -0800

    crypto: public_key: remove MPIs from public_key_signature struct
    
    After digsig_asymmetric.c is converted the MPIs can be now
    safely removed from the public_key_signature structure.
    
    Signed-off-by: Tadeusz Struk <tadeusz.struk@intel.com>
    Acked-by: Herbert Xu <herbert@gondor.apana.org.au>
    Signed-off-by: David Howells <dhowells@redhat.com>

commit 901c5ffaaed117a38be9d0c29247c4888d6c8636
Author: Geert Uytterhoeven <geert+renesas@glider.be>
Date:   Mon Feb 15 13:20:08 2016 +0100

    ARM: shmobile: Remove shmobile_boot_arg
    
    CPU boot configuration writes to shmobile_boot_arg, which is located in
    the .text section, and thus should not be written to.
    
    As of commit 1d33a354bbb618ba ("ARM: shmobile: Per-CPU SMP boot / sleep
    code for SCU SoCs"), and ignoring accidental remainings,
    shmobile_boot_arg is always set to MPIDR_HWID_BITMASK by C code.
    Hence we can just hardcode this in the assembler code, and remove the
    variable, and thus also remove the need to write to this variable.
    
    Signed-off-by: Geert Uytterhoeven <geert+renesas@glider.be>
    Acked-by: Nicolas Pitre <nico@linaro.org>
    Signed-off-by: Simon Horman <horms+renesas@verge.net.au>

commit 215cd9674fa02e4b341e4568d20ef5fd6fab1b0b
Author: Krzysztof Kozlowski <k.kozlowski@samsung.com>
Date:   Tue Feb 16 15:20:30 2016 +0900

    clk: samsung: Enable COMPILE_TEST for Samsung clocks
    
    Enable the COMPILE_TEST to get build coverage of some of Samsung clock
    controller drivers. Still some of them will be built only if
    appropriate SoC is chosen (like SOC_EXYNOS4415 or ARCH_S3C64XX).
    
    Signed-off-by: Krzysztof Kozlowski <k.kozlowski@samsung.com>
    Reviewed-by: Javier Martinez Canillas <javier@osg.samsung.com>
    Tested-by: Javier Martinez Canillas <javier@osg.samsung.com>
    Reviewed-by: Andi Shyti <andi.shyti@samsung.com>
    Signed-off-by: Michael Turquette <mturquette@baylibre.com>

commit 15430f775ee686b61569a0c3e74cf0b2ad57c8eb
Author: David Howells <dhowells@redhat.com>
Date:   Wed Aug 5 12:54:46 2015 +0100

    ASN.1: Fix non-match detection failure on data overrun
    
    commit 0d62e9dd6da45bbf0f33a8617afc5fe774c8f45f upstream.
    
    If the ASN.1 decoder is asked to parse a sequence of objects, non-optional
    matches get skipped if there's no more data to be had rather than a
    data-overrun error being reported.
    
    This is due to the code segment that decides whether to skip optional
    matches (ie. matches that could get ignored because an element is marked
    OPTIONAL in the grammar) due to a lack of data also skips non-optional
    elements if the data pointer has reached the end of the buffer.
    
    This can be tested with the data decoder for the new RSA akcipher algorithm
    that takes three non-optional integers.  Currently, it skips the last
    integer if there is insufficient data.
    
    Without the fix, #defining DEBUG in asn1_decoder.c will show something
    like:
    
            next_op: pc=0/13 dp=0/270 C=0 J=0
            - match? 30 30 00
            - TAG: 30 266 CONS
            next_op: pc=2/13 dp=4/270 C=1 J=0
            - match? 02 02 00
            - TAG: 02 257
            - LEAF: 257
            next_op: pc=5/13 dp=265/270 C=1 J=0
            - match? 02 02 00
            - TAG: 02 3
            - LEAF: 3
            next_op: pc=8/13 dp=270/270 C=1 J=0
            next_op: pc=11/13 dp=270/270 C=1 J=0
            - end cons t=4 dp=270 l=270/270
    
    The next_op line for pc=8/13 should be followed by a match line.
    
    This is not exploitable for X.509 certificates by means of shortening the
    message and fixing up the ASN.1 CONS tags because:
    
     (1) The relevant records being built up are cleared before use.
    
     (2) If the message is shortened sufficiently to remove the public key, the
         ASN.1 parse of the RSA key will fail quickly due to a lack of data.
    
     (3) Extracted signature data is either turned into MPIs (which cope with a
         0 length) or is simpler integers specifying algoritms and suchlike
         (which can validly be 0); and
    
     (4) The AKID and SKID extensions are optional and their removal is handled
         without risking passing a NULL to asymmetric_key_generate_id().
    
     (5) If the certificate is truncated sufficiently to remove the subject,
         issuer or serialNumber then the ASN.1 decoder will fail with a 'Cons
         stack underflow' return.
    
    This is not exploitable for PKCS#7 messages by means of removal of elements
    from such a message from the tail end of a sequence:
    
     (1) Any shortened X.509 certs embedded in the PKCS#7 message are survivable
         as detailed above.
    
     (2) The message digest content isn't used if it shows a NULL pointer,
         similarly, the authattrs aren't used if that shows a NULL pointer.
    
     (3) A missing signature results in a NULL MPI - which the MPI routines deal
         with.
    
     (4) If data is NULL, it is expected that the message has detached content and
         that is handled appropriately.
    
     (5) If the serialNumber is excised, the unconditional action associated
         with it will pick up the containing SEQUENCE instead, so no NULL
         pointer will be seen here.
    
         If both the issuer and the serialNumber are excised, the ASN.1 decode
         will fail with an 'Unexpected tag' return.
    
         In either case, there's no way to get to asymmetric_key_generate_id()
         with a NULL pointer.
    
     (6) Other fields are decoded to simple integers.  Shortening the message
         to omit an algorithm ID field will cause checks on this to fail early
         in the verification process.
    
    This can also be tested by snipping objects off of the end of the ASN.1 stream
    such that mandatory tags are removed - or even from the end of internal
    SEQUENCEs.  If any mandatory tag is missing, the error EBADMSG *should* be
    produced.  Without this patch ERANGE or ENOPKG might be produced or the parse
    may apparently succeed, perhaps with ENOKEY or EKEYREJECTED being produced
    later, depending on what gets snipped.
    
    Just snipping off the final BIT_STRING or OCTET_STRING from either sample
    should be a start since both are mandatory and neither will cause an EBADMSG
    without the patches
    
    Reported-by: Marcel Holtmann <marcel@holtmann.org>
    Signed-off-by: David Howells <dhowells@redhat.com>
    Tested-by: Marcel Holtmann <marcel@holtmann.org>
    Reviewed-by: David Woodhouse <David.Woodhouse@intel.com>
    Cc: Moritz Muehlenhoff <jmm@inutil.org>
    [ luis: backported to 3.16: adjusted context ]
    Signed-off-by: Luis Henriques <luis.henriques@canonical.com>

commit 4a9e00600b6feeacae02b8ac3428bf98c813c1b2
Author: Masahiro Yamada <yamada.masahiro@socionext.com>
Date:   Wed Feb 10 18:54:32 2016 +0900

    pinctrl: mediatek: guard sub-directory with CONFIG_PINCTRL_MTK
    
    CONFIG_PINCTRL_MTK is more suitable than CONFIG_ARCH_MEDIATEK
    to guard the drivers/pinctrl/mediatek/ directory.
    (I renamed CONFIG_PINCTRL_MTK_COMMON to CONFIG_PINCTRL_MTK.)
    
    This allows COMPILE_TEST to descend into drivers/pinctrl/mediatek
    without CONFIG_ARCH_MEDIATEK define.
    
    Signed-off-by: Masahiro Yamada <yamada.masahiro@socionext.com>
    Signed-off-by: Linus Walleij <linus.walleij@linaro.org>

commit 61c18aeb05c32ba1291743300ec4a4f6dcad5ed8
Author: Masahiro Yamada <yamada.masahiro@socionext.com>
Date:   Sun Jan 31 22:34:02 2016 +0900

    i2c: uniphier: add COMPILE_TEST option
    
    Add COMPILE_TEST for the compilation test coverage.
    
    Signed-off-by: Masahiro Yamada <yamada.masahiro@socionext.com>
    Signed-off-by: Wolfram Sang <wsa@the-dreams.de>

commit aac7e974ebbd2b8c3ce2d9874ca6a60ce0528281
Author: Masahiro Yamada <yamada.masahiro@socionext.com>
Date:   Sun Jan 31 22:32:51 2016 +0900

    pinctrl: uniphier: add COMPILE_TEST option
    
    Add COMPILE_TEST for the compilation test coverage.
    
    Signed-off-by: Masahiro Yamada <yamada.masahiro@socionext.com>
    Signed-off-by: Linus Walleij <linus.walleij@linaro.org>

commit 1261d013daead425ee03c977a5b8dbe8016e25a6
Author: Geert Uytterhoeven <geert@linux-m68k.org>
Date:   Tue Feb 9 10:33:40 2016 -0800

    Input: Allow compile test of Goodix and Colibri VF50 if !GPIOLIB
    
    The GPIO subsystem provides dummy GPIO consumer functions if GPIOLIB is
    not enabled. Hence drivers that depend on GPIOLIB, but use GPIO consumer
    functionality only, can still be compiled if GPIOLIB is not enabled.
    
    If COMPILE_TEST is enabled, relax the dependency on GPIOLIB for the
    recently introduced or relaxed symbols TOUCHSCREEN_GOODIX and
    TOUCHSCREEN_COLIBRI_VF50.
    
    Signed-off-by: Geert Uytterhoeven <geert@linux-m68k.org>
    Signed-off-by: Dmitry Torokhov <dmitry.torokhov@gmail.com>

commit 8527cfce6e15bc6764d13fd28dd2d836345cb89d
Merge: 95650655f7a1 cdef6b0b6ff4
Author: Olof Johansson <olof@lixom.net>
Date:   Mon Feb 8 13:39:36 2016 -0800

    Merge tag 'renesas-cleanup-for-v4.6' of git://git.kernel.org/pub/scm/linux/kernel/git/horms/renesas into next/cleanup
    
    Renesas ARM Based SoC Cleanup for v4.6
    
    * Remove remnants of removed SCU boot setup code for r8a7779
    * Correct s/MIPDR/MPIDR/ typo
    * Add includes providing forward declarations
    * Make rcar_gen2_dma_contiguous static
    
    * tag 'renesas-cleanup-for-v4.6' of git://git.kernel.org/pub/scm/linux/kernel/git/horms/renesas:
      ARM: shmobile: r8a7779: Remove remainings of removed SCU boot setup code
      ARM: shmobile: Typo s/MIPDR/MPIDR/
      ARM: shmobile: Add includes providing forward declarations
      ARM: shmobile: rcar-gen2: Make rcar_gen2_dma_contiguous static
    
    Signed-off-by: Olof Johansson <olof@lixom.net>

commit 0697ae80fe3ccaf7d443fa5522fa7eeea34c19bb
Author: Geert Uytterhoeven <geert@linux-m68k.org>
Date:   Sun Feb 7 15:12:29 2016 +0100

    spi: Allow compile test of bcm2835aux if !GPIOLIB
    
    The GPIO subsystem provides dummy GPIO consumer functions if GPIOLIB is
    not enabled. Hence drivers that depend on GPIOLIB, but use GPIO consumer
    functionality only, can still be compiled if GPIOLIB is not enabled.
    
    Relax the dependency of SPI_BCM2835AUX on GPIOLIB if COMPILE_TEST is
    enabled.
    
    Signed-off-by: Geert Uytterhoeven <geert@linux-m68k.org>
    Signed-off-by: Mark Brown <broonie@kernel.org>

commit 1e0a6e1747b760b95b05ede659c8a6e5eb9b8acb
Author: Tadeusz Struk <tadeusz.struk@intel.com>
Date:   Tue Feb 2 10:09:03 2016 -0800

    crypto: public_key - remove MPIs from public_key_signature struct
    
    After digsig_asymmetric.c is converted the MPIs can be now
    safely removed from the public_key_signature structure.
    
    Signed-off-by: Tadeusz Struk <tadeusz.struk@intel.com>
    Signed-off-by: Herbert Xu <herbert@gondor.apana.org.au>

commit 04d3ba70a3c9c9ba593d3208531463c65f055526
Author: Arnd Bergmann <arnd@arndb.de>
Date:   Mon Jan 25 17:04:46 2016 +0100

    rtc: mt6397: add IRQ domain dependency
    
    The mt6397 RTC driver can be built either when the MFD_MT6397 driver
    is enabled (which selects IRQ_DOMAIN), or when compile testing.
    The latter however fails without IRQ domains:
    
    drivers/rtc/rtc-mt6397.c: In function 'mtk_rtc_probe':
    drivers/rtc/rtc-mt6397.c:326:13: error: implicit declaration of function 'irq_create_mapping' [-Werror=implicit-function-declaration]
      rtc->irq = irq_create_mapping(mt6397_chip->irq_domain, res->start);
    
    This adds an explicit dependency for the COMPILE_TEST case.
    
    Signed-off-by: Arnd Bergmann <arnd@arndb.de>
    Acked-by: Eddie Huang <eddie.huang@mediatek.com>
    Signed-off-by: Alexandre Belloni <alexandre.belloni@free-electrons.com>

commit e24f317c859f2d904d1eb87cbb503c309e6dead7
Author: Geert Uytterhoeven <geert+renesas@glider.be>
Date:   Thu Jan 28 16:13:30 2016 +0100

    ARM: shmobile: Typo s/MIPDR/MPIDR/
    
    The ARM Multiprocessor Affinity Register is called "MPIDR".
    
    Signed-off-by: Geert Uytterhoeven <geert+renesas@glider.be>
    Signed-off-by: Simon Horman <horms+renesas@verge.net.au>

commit dc7eb9d589e595954792cc192bcbb92932e5c2ff
Author: Arnd Bergmann <arnd@arndb.de>
Date:   Fri Jan 29 15:50:38 2016 +0100

    ARM: EXYNOS: select THERMAL_OF
    
    We cannot select a symbol that has disabled dependencies, so
    we get a warning if we ever enable EXYNOS_THERMAL without
    also turning on THERMAL_OF:
    
    warning: (ARCH_EXYNOS) selects EXYNOS_THERMAL which has unmet direct dependencies (THERMAL && (ARCH_EXYNOS || COMPILE_TEST) && THERMAL_OF)
    
    This adds another 'select' in the platform code to avoid that
    case. Alternatively, we could decide to not select EXYNOS_THERMAL
    here and instead make it a user option.
    
    Signed-off-by: Arnd Bergmann <arnd@arndb.de>
    Fixes: f87e6bd3f740 ("thermal: exynos: Add the dependency of CONFIG_THERMAL_OF instead of CONFIG_OF")
    Signed-off-by: Krzysztof Kozlowski <k.kozlowski@samsung.com>

commit dc799d0179baa7f62d2e73a8217a273ca82adbdf
Merge: 7ab85d4a8516 1ca8ec532fc2
Author: Linus Torvalds <torvalds@linux-foundation.org>
Date:   Sun Jan 31 15:49:06 2016 -0800

    Merge branch 'timers-urgent-for-linus' of git://git.kernel.org/pub/scm/linux/kernel/git/tip/tip
    
    Pull timer fixes from Thomas Gleixner:
     "The timer departement delivers:
    
       - a regression fix for the NTP code along with a proper selftest
       - prevent a spurious timer interrupt in the NOHZ lowres code
       - a fix for user space interfaces returning the remaining time on
         architectures with CONFIG_TIME_LOW_RES=y
       - a few patches to fix COMPILE_TEST fallout"
    
    * 'timers-urgent-for-linus' of git://git.kernel.org/pub/scm/linux/kernel/git/tip/tip:
      tick/nohz: Set the correct expiry when switching to nohz/lowres mode
      clocksource: Fix dependencies for archs w/o HAS_IOMEM
      clocksource: Select CLKSRC_MMIO where needed
      tick/sched: Hide unused oneshot timer code
      kselftests: timers: Add adjtimex SETOFFSET validity tests
      ntp: Fix ADJ_SETOFFSET being used w/ ADJ_NANO
      itimers: Handle relative timers with CONFIG_TIME_LOW_RES proper
      posix-timers: Handle relative timers with CONFIG_TIME_LOW_RES proper
      timerfd: Handle relative timers with CONFIG_TIME_LOW_RES proper
      hrtimer: Handle remaining time proper for TIME_LOW_RES
      clockevents/tcb_clksrc: Prevent disabling an already disabled clock

commit df1a3e64f79b3e277a22b2e789896f86c63eec1f
Author: Arnd Bergmann <arnd@arndb.de>
Date:   Mon Jan 25 17:06:27 2016 +0100

    watchdog: imgdpc: select WATCHDOG_CORE
    
    The imgpdc_wdt driver can be built on all architectures with
    CONFIG_COMPILE_TEST, but fails if no other watchdog driver is
    enabled:
    
    drivers/watchdog/built-in.o: In function `pdc_wdt_remove':
    imgpdc_wdt.c:(.text+0x74): undefined reference to `watchdog_unregister_device'
    
    This adds the normal 'select WATCHDOG_CORE' that is needed to
    ensure the driver always builds cleanly.
    
    Signed-off-by: Arnd Bergmann <arnd@arndb.de>
    Reviewed-by: James Hogan <james.hogan@imgtec.com>
    Signed-off-by: Guenter Roeck <linux@roeck-us.net>
    Signed-off-by: Wim Van Sebroeck <wim@iguana.be>

commit 1f820f538f7396db7fd40684b9c3620816acc5a3
Author: Arnd Bergmann <arnd@arndb.de>
Date:   Fri Jan 29 12:39:12 2016 +0100

    net: bgmac: clarify CONFIG_BCMA dependency
    
    The bgmac driver depends on BCMA_HOST_SOC, which is only used
    when CONFIG_BCMA is enabled. However, it is a bool option and can
    be set when CONFIG_BCMA=m, and then bgmac can be built-in, leading
    to an obvious link error:
    
    drivers/built-in.o: In function `bgmac_init':
    :(.init.text+0x7f2c): undefined reference to `__bcma_driver_register'
    drivers/built-in.o: In function `bgmac_exit':
    :(.exit.text+0x110a): undefined reference to `bcma_driver_unregister'
    
    To avoid this case, we need to depend on both BCMA and BCMA_SOC,
    as this patch does. I'm also trying to make the dependency more
    readable by splitting it into three lines, and adding a COMPILE_TEST
    alternative so we can test-build it in all configurations that
    support BCMA.
    
    The added dependency on FIXED_PHY addresses a related issue where
    we cannot call fixed_phy_register() when CONFIG_FIXED_PHY=m and
    CONFIG_BGMAC=y.
    
    Signed-off-by: Arnd Bergmann <arnd@arndb.de>
    Signed-off-by: David S. Miller <davem@davemloft.net>

commit 8f6aff9858c45525345b92b2a88c2af776c64340
Author: Lada Trimasova <Lada.Trimasova@synopsys.com>
Date:   Wed Jan 27 11:10:32 2016 +0000

    iommu/io-pgtable-arm: Fix io-pgtable-arm build failure
    
    Trying to build a kernel for ARC with both options CONFIG_COMPILE_TEST
    and CONFIG_IOMMU_IO_PGTABLE_LPAE enabled (e.g. as a result of "make
    allyesconfig") results in the following build failure:
    
     | CC drivers/iommu/io-pgtable-arm.o
     | linux/drivers/iommu/io-pgtable-arm.c: In
     | function __arm_lpae_alloc_pages:
     | linux/drivers/iommu/io-pgtable-arm.c:221:3:
     | error: implicit declaration of function dma_map_single
     | [-Werror=implicit-function-declaration]
     | dma = dma_map_single(dev, pages, size, DMA_TO_DEVICE);
     | ^
     | linux/drivers/iommu/io-pgtable-arm.c:221:42:
     | error: DMA_TO_DEVICE undeclared (first use in this function)
     | dma = dma_map_single(dev, pages, size, DMA_TO_DEVICE);
     | ^
    
    Since IOMMU_IO_PGTABLE_LPAE depends on DMA API, io-pgtable-arm.c should
    include linux/dma-mapping.h. This fixes the reported failure.
    
    Cc: Alexey Brodkin <abrodkin@synopsys.com>
    Cc: Vineet Gupta <vgupta@synopsys.com>
    Cc: Joerg Roedel <joro@8bytes.org>
    Signed-off-by: Lada Trimasova <ltrimas@synopsys.com>
    Signed-off-by: Will Deacon <will.deacon@arm.com>
    Signed-off-by: Joerg Roedel <jroedel@suse.de>

commit cc301fd1fcf28f92b122f7f6105db9d7c182cccc
Author: Paul Gortmaker <paul.gortmaker@windriver.com>
Date:   Mon Jan 4 12:44:10 2016 -0500

    pinctrl: mediatek: mt8* make driver explicitly non-modular
    
    The Kconfig for these drivers are currently:
    
    config PINCTRL_MT8127
            bool "Mediatek MT8127 pin control" if COMPILE_TEST && !MACH_MT8127
    
    config PINCTRL_MT8135
            bool "Mediatek MT8135 pin control" if COMPILE_TEST && !MACH_MT8135
    
    config PINCTRL_MT8173
            bool "Mediatek MT8173 pin control"
    
    ...meaning that they are currently not being built as a module by anyone.
    Lets remove the modular code that is essentially orphaned, so that
    when reading the driver there is no doubt it is builtin-only.
    
    A recent commit moved these from module_init to arch_initcall already, so
    the init ordering remains untouched with this commit.
    
    We also delete the MODULE_LICENSE tag etc. since all that information
    is already contained at the top of the file in the comments.
    
    Also note that MODULE_DEVICE_TABLE is a no-op for non-modular code.
    
    Cc: Daniel Kurtz <djkurtz@chromium.org>
    Cc: Matthias Brugger <matthias.bgg@gmail.com>
    Cc: Hongzhou Yang <hongzhou.yang@mediatek.com>
    Cc: Yingjoe Chen <yingjoe.chen@mediatek.com>
    Cc: linux-gpio@vger.kernel.org
    Cc: linux-mediatek@lists.infradead.org
    Signed-off-by: Paul Gortmaker <paul.gortmaker@windriver.com>
    Signed-off-by: Linus Walleij <linus.walleij@linaro.org>

commit 40704b129092eafce9c754199aea5a1f55c47fbc
Author: Arnd Bergmann <arnd@arndb.de>
Date:   Fri Dec 18 16:02:41 2015 +0100

    PCI: host: Add of_pci_get_host_bridge_resources() stub
    
    The pcie-rcar driver can be built for any ARM platform (for COMPILE_TEST)
    including those without CONFIG_OF enabled, and that results in a
    compile-time error:
    
      drivers/pci/host/pcie-rcar.c: In function 'rcar_pcie_parse_request_of_pci_ranges':
      drivers/pci/host/pcie-rcar.c:939:8: error: implicit declaration of function 'of_pci_get_host_bridge_resources' [-Werror=implicit-function-declaration]
        err = of_pci_get_host_bridge_resources(np, 0, 0xff, &pci->resources, &iobase);
    
    Add a of_pci_get_host_bridge_resources() stub function defined when
    CONFIG_OF_ADDRESS is disabled to allow compile-testing on all platforms.
    This mirrors what we do for other OF-specific functions.
    
    Fixes: 5d2917d469fa ("PCI: rcar: Convert to DT resource parsing API")
    Signed-off-by: Arnd Bergmann <arnd@arndb.de>
    Signed-off-by: Bjorn Helgaas <bhelgaas@google.com>
    Acked-by: Wolfram Sang <wsa+renesas@sang-engineering.com>
    Acked-by: Simon Horman <horms+renesas@verge.net.au>

commit 1f16f116b01c110db20ab808562c8b8bc3ee3d6e
Merge: 03724ac3d48f f9eccf246156
Author: Thomas Gleixner <tglx@linutronix.de>
Date:   Tue Jan 12 11:01:12 2016 +0100

    Merge branches 'clockevents/4.4-fixes' and 'clockevents/4.5-fixes' of http://git.linaro.org/people/daniel.lezcano/linux into timers/urgent
    
    Pull in fixes from Daniel Lezcano:
    
     - Fix the vt8500 timer leading to a system lock up when dealing with too
       small delta (Roman Volkov)
    
     - Select the CLKSRC_MMIO when the fsl_ftm_timer is enabled with COMPILE_TEST
       (Daniel Lezcano)
    
     - Prevent to compile timers using the 'iomem' API when the architecture has
       not HAS_IOMEM set (Richard Weinberger)

commit 03724ac3d48f8f0e3caf1d30fa134f8fd96c94e2
Author: Daniel Lezcano <daniel.lezcano@linaro.org>
Date:   Fri Jan 8 14:21:31 2016 +0100

    clocksource/drivers/fsl_ftm_timer: Fix CLKSRC_MMIO dependency
    
    Select CLKSRC_MMIO when FSL_FTM_TIMER is enabled. Otherwise it fails to
    compile on i386 with COMPILE_TEST=y.
    
    "
    on i386:
    when CLKSRC_MMIO is not enabled:
    
    drivers/built-in.o: In function `ftm_timer_init':
    fsl_ftm_timer.c:(.init.text+0x6842): undefined reference to `clocksource_mmio_readl_up'
    fsl_ftm_timer.c:(.init.text+0x6855): undefined reference to `clocksource_mmio_init'
    "
    
    Reported-by: Randy Dunlap <rdunlap@infradead.org>
    Signed-off-by: Daniel Lezcano <daniel.lezcano@linaro.org>

commit 9fb7807ce7f21cbab2b13db0183f7f71a75add5e
Author: Emmanuel Grumbach <emmanuel.grumbach@intel.com>
Date:   Tue Jan 5 09:35:21 2016 +0200

    iwlwifi: mvm: fix memory leaks in error paths upon fw error dump
    
    When iwl_mvm_fw_error_dump fails, it needs to clear the
    state in mvm, which includes:
            * clear IWL_MVM_STATUS_DUMPING_FW_LOG
            * set mvm->fw_dump_trig to NULL
            * free the description
    
    While at it, remove a NULL check in
    iwl_mvm_free_fw_dump_desc since kfree is NULL safe.
    
    Signed-off-by: Emmanuel Grumbach <emmanuel.grumbach@intel.com>

commit 82a823833f4e3769e82cdb4df1bc2234bc65b16c
Author: Stanimir Varbanov <svarbanov@mm-sol.com>
Date:   Fri Dec 18 14:38:57 2015 +0200

    PCI: qcom: Add Qualcomm PCIe controller driver
    
    The PCIe driver reuses the Designware common code for host and MSI
    initialization, and also programs the Qualcomm application specific
    registers.
    
    [bhelgaas: remove COMPILE_TEST Kconfig dependency]
    Signed-off-by: Stanimir Varbanov <svarbanov@mm-sol.com>
    Signed-off-by: Stanimir Varbanov <stanimir.varbanov@linaro.org>
    Signed-off-by: Bjorn Helgaas <bhelgaas@google.com>

commit fcd71d9cc6e301bdbd71829b79e80168473ca609
Author: Sudip Mukherjee <sudipm.mukherjee@gmail.com>
Date:   Tue Dec 8 14:17:55 2015 +0530

    of: fix declaration of of_io_request_and_map
    
    We are having build failure with linux-next for sparc allmodconfig with
    the error messages:
    
    drivers/built-in.o: In function `meson6_timer_init':
    meson6_timer.c:(.init.text+0x5fe8): undefined reference to `of_io_request_and_map'
    drivers/built-in.o: In function `mtk_timer_init':
    mtk_timer.c:(.init.text+0x6af0): undefined reference to `of_io_request_and_map'
    drivers/built-in.o: In function `asm9260_timer_init':
    asm9260_timer.c:(.init.text+0x6c48): undefined reference to `of_io_request_and_map'
    
    CONFIG_OF is defined for sparc so it is expected that we have a
    definition of of_io_request_and_map() but of/address.c is only compiled
    if it is !SPARC. In other words, CONFIG_OF_ADDRESS is not defined for
    sparc so we get the build failure.
    
    Fixes: e572f844ca66 ("clocksource/drivers/meson6: Add the COMPILE_TEST option")
    Fixes: bec8c4617611 ("clocksource/drivers/mediatek: Add the COMPILE_TEST option")
    Fixes: 4a373b45f94a ("clocksource/drivers/asm9260: Add the COMPILE_TEST option")
    Acked-by: Daniel Lezcano <daniel.lezcano@linaro.org>
    Signed-off-by: Sudip Mukherjee <sudip@vectorindia.org>
    [robh: move include of io.h out of ifdef's]
    Signed-off-by: Rob Herring <robh@kernel.org>

commit 46e7c3c6e5c56aadac391f92771e37dc03bec9b8
Author: Daniel Lezcano <daniel.lezcano@linaro.org>
Date:   Mon Nov 9 15:18:08 2015 +0100

    clocksource/drivers/h8300: Increase the compilation test coverage
    
    Add the COMPILE_TEST option so the drivers can be compiled on different
    architecture with the 'allyesconfig' kernel configuration.
    
    Signed-off-by: Daniel Lezcano <daniel.lezcano@linaro.org>

commit ef49336bbd15bd4ffbdcf81501d25abcd87f16ab
Author: Daniel Lezcano <daniel.lezcano@linaro.org>
Date:   Mon Nov 2 09:51:02 2015 +0100

    clocksource/drivers/fsl-ftm: Add the COMPILE_TEST option
    
    Increase the compilation test coverage by adding the COMPILE_TEST option.
    
    Signed-off-by: Daniel Lezcano <daniel.lezcano@linaro.org>

commit 778c5696b93f45c3d11442150e2634f454bb5213
Author: Daniel Lezcano <daniel.lezcano@linaro.org>
Date:   Sun Nov 1 21:57:05 2015 +0100

    clocksource/drivers/samsung-pwm: Add the COMPILE_TEST option
    
    Increase the compilation test coverage by adding the COMPILE_TEST option.
    
    Signed-off-by: Daniel Lezcano <daniel.lezcano@linaro.org>

commit 39366ef42194b58519274afc35f4a9282fb05931
Author: Daniel Lezcano <daniel.lezcano@linaro.org>
Date:   Sun Nov 1 21:51:30 2015 +0100

    clocksource/drivers/exynos_mct: Fix Kconfig and add COMPILE_TEST option
    
    Let the platform's Kconfig to select the clock instead of having a reverse
    dependency from the driver to the platform options.
    
    Add the COMPILE_TEST option for the compilation test coverage. Due to the
    non portable 'delay' code, this driver is only compilable on ARM.
    
    Signed-off-by: Daniel Lezcano <daniel.lezcano@linaro.org>
    Tested-by: Krzysztof Kozlowski <k.kozlowski@samsung.com>
    Reviewed-by: Krzysztof Kozlowski <k.kozlowski@samsung.com>
    Reviewed-by: Chanwoo Choi <cw00.choi@samsung.com>

commit 1becd6edea0c2849bc1a585d8c549d611517dd76
Author: Daniel Lezcano <daniel.lezcano@linaro.org>
Date:   Sun Nov 1 21:16:01 2015 +0100

    clocksource/drivers/prcmu: Fix Kconfig and add COMPILE_TEST option
    
    Let the platform's Kconfig to select the clock instead of having a reverse
    dependency from the driver to the platform options.
    
    Add the COMPILE_TEST option for the compilation test coverage.
    
    This change is debatable as the option itself in the Kconfig allows to
    select the driver for the platform or not. This change will make the prcmu
    timer always selected.
    
    Signed-off-by: Daniel Lezcano <daniel.lezcano@linaro.org>
    Acked-by: Linus Walleij <linus.walleij@linaro.org>

commit 703296530609ef37e22e715c9f5438d60a7ec11f
Author: Daniel Lezcano <daniel.lezcano@linaro.org>
Date:   Sun Nov 1 21:11:28 2015 +0100

    clocksource/drivers/nomadik_mtu: Add the COMPILE_TEST option
    
    Increase the compilation test coverage by adding the COMPILE_TEST option.
    
    Due to the non portable code for the delay timer, this option is only
    available for the ARM architecture.
    
    Signed-off-by: Daniel Lezcano <daniel.lezcano@linaro.org>

commit ddcf48c776845b9b83e7ab514b54220358993a6f
Author: Daniel Lezcano <daniel.lezcano@linaro.org>
Date:   Sat Oct 31 21:44:52 2015 +0100

    clocksource/drivers/lpc32xx: Add the COMPILE_TEST option
    
    Increase the compilation test coverage by adding the COMPILE_TEST option.
    
    Signed-off-by: Daniel Lezcano <daniel.lezcano@linaro.org>

commit b9755841e7b2280b94d72a7f42a0d2062a43b201
Author: Daniel Lezcano <daniel.lezcano@linaro.org>
Date:   Sat Oct 31 21:41:23 2015 +0100

    clocksource/drivers/asm9260: Add the COMPILE_TEST option
    
    Increase the compilation test coverage by adding the COMPILE_TEST option.
    
    Signed-off-by: Daniel Lezcano <daniel.lezcano@linaro.org>

commit 57f49318f9b1a083bcada14505c4c5397b9dd8f2
Author: Daniel Lezcano <daniel.lezcano@linaro.org>
Date:   Sat Oct 31 21:39:03 2015 +0100

    clocksource/drivers/cadence_ttc: Add the COMPILE_TEST option
    
    Increase the compilation test coverage by adding the COMPILE_TEST option.
    
    The driver depends on the common clock framework, thus the dependency added
    on COMMON_CLK.
    
    Signed-off-by: Daniel Lezcano <daniel.lezcano@linaro.org>

commit b4bdf7ef301655b85875c9cf04f93a54bd763f97
Author: Daniel Lezcano <daniel.lezcano@linaro.org>
Date:   Sat Oct 31 20:23:54 2015 +0100

    clocksource/drivers/vt8500: Add the COMPILE_TEST option
    
    Increase the compilation test coverage by adding the COMPILE_TEST option.
    
    Signed-off-by: Daniel Lezcano <daniel.lezcano@linaro.org>

commit adce4bc8311f43dd0c2207eae841f925f3a6fcf2
Author: Daniel Lezcano <daniel.lezcano@linaro.org>
Date:   Sat Oct 31 20:13:09 2015 +0100

    clocksource/drivers/tegra2: Add the COMPILE_TEST option
    
    Increase the compilation test coverage by adding the COMPILE_TEST option.
    
    Due to the non portable code for the delay timer, this option is only
    available for the ARM architecture.
    
    Signed-off-by: Daniel Lezcano <daniel.lezcano@linaro.org>

commit f0c5afb787cfc800f7678f614d746b9bd2f18d01
Author: Daniel Lezcano <daniel.lezcano@linaro.org>
Date:   Sat Oct 31 17:01:46 2015 +0100

    clocksource/drivers/sun5i: Add the COMPILE_TEST option
    
    Increase the compilation test coverage by adding the COMPILE_TEST option.
    
    The driver depends on the common clock framework, thus the dependency added
    on COMMON_CLK.
    
    Signed-off-by: Daniel Lezcano <daniel.lezcano@linaro.org>

commit b4fcd48b887eb4bb4511b17ed65d2588602a938a
Author: Daniel Lezcano <daniel.lezcano@linaro.org>
Date:   Fri Oct 30 22:39:00 2015 +0100

    clocksource/drivers/sun4i: Add the COMPILE_TEST option
    
    Increase the compilation test coverage by adding the COMPILE_TEST option.
    
    Signed-off-by: Daniel Lezcano <daniel.lezcano@linaro.org>

commit 5b097f6ba57fb4a8e7da11147048f7e1c898bc29
Author: Daniel Lezcano <daniel.lezcano@linaro.org>
Date:   Fri Oct 30 22:35:00 2015 +0100

    clocksource/drivers/dw_apb: Add the COMPILE_TEST option
    
    Increase the compilation test coverage by adding the COMPILE_TEST option.
    
    Signed-off-by: Daniel Lezcano <daniel.lezcano@linaro.org>

commit e6c1db13f955a7b2091d047dc8c294717e0d1a8f
Author: Daniel Lezcano <daniel.lezcano@linaro.org>
Date:   Fri Oct 30 22:32:10 2015 +0100

    clocksource/drivers/digicolor: Add the COMPILE_TEST option
    
    Increase the compilation test coverage by adding the COMPILE_TEST option.
    
    Signed-off-by: Daniel Lezcano <daniel.lezcano@linaro.org>

commit c916554971fdfda3d34259851684a76ece5f85d1
Author: Daniel Lezcano <daniel.lezcano@linaro.org>
Date:   Fri Oct 30 22:28:31 2015 +0100

    clocksource/drivers/orion: Add the COMPILE_TEST option
    
    Increase the compilation test coverage by adding the COMPILE_TEST option.
    
    The driver is using the atomic_io API which is not portable, so the
    compilation is restricted to ARM only.
    
    Signed-off-by: Daniel Lezcano <daniel.lezcano@linaro.org>

commit 0b7a7bb70562960834f4c2b7ed703f06dbb0c7e8
Author: Daniel Lezcano <daniel.lezcano@linaro.org>
Date:   Fri Oct 30 22:07:39 2015 +0100

    clocksource/drivers/meson6: Add the COMPILE_TEST option
    
    Increase the compilation test coverage by adding the COMPILE_TEST option.
    
    Signed-off-by: Daniel Lezcano <daniel.lezcano@linaro.org>

commit 9519e80c755592b3527f435497521563d158649d
Author: Daniel Lezcano <daniel.lezcano@linaro.org>
Date:   Fri Oct 30 20:30:34 2015 +0100

    clocksource/drivers/armada-370-xp: Add the COMPILE_TEST option
    
    Increase the compilation test coverage by adding the COMPILE_TEST option.
    
    Due to the non portable 'delay' code, the compilation is restricted to the
    ARM architecture only.
    
    Signed-off-by: Daniel Lezcano <daniel.lezcano@linaro.org>

commit 40ada2aac5e3a3c38f295d4e37b182fc4feff723
Author: Daniel Lezcano <daniel.lezcano@linaro.org>
Date:   Fri Oct 30 17:58:47 2015 +0100

    clocksource/drivers/rockchip: Add COMPILE_TEST option
    
    Increase the compilation test coverage by adding the COMPILE_TEST option.
    
    Due to the dsb() usage in the driver, this driver is only compilable on
    ARM and ARM64.
    
    Signed-off-by: Daniel Lezcano <daniel.lezcano@linaro.org>

commit fbca9eabe9b6c7602c13b0d671f58f62c1a15d4d
Author: Daniel Lezcano <daniel.lezcano@linaro.org>
Date:   Fri Oct 30 17:53:27 2015 +0100

    clocksource/drivers/mediatek: Add the COMPILE_TEST option
    
    Increase the compilation test coverage by adding the COMPILE_TEST option.
    
    Signed-off-by: Daniel Lezcano <daniel.lezcano@linaro.org>

commit dfdb16525b1093328617c15d57593ef4c4759d7a
Author: Daniel Lezcano <daniel.lezcano@linaro.org>
Date:   Fri Oct 30 17:28:13 2015 +0100

    clocksource/drivers/pistachio: Add the COMPILE_TEST option
    
    Increase the compilation test coverage by adding the COMPILE_TEST option.
    
    Signed-off-by: Daniel Lezcano <daniel.lezcano@linaro.org>

commit 5a7351f0e156d1b359b5662d4475bd295f0617d9
Author: Daniel Lezcano <daniel.lezcano@linaro.org>
Date:   Thu Oct 29 20:54:19 2015 +0100

    clocksource/drivers/tango: Add COMPILE_TEST option
    
    Increase the compilation test coverage by adding the COMPILE_TEST option.
    
    Signed-off-by: Daniel Lezcano <daniel.lezcano@linaro.org>

commit 5ae996cbee445e899915d16903f140d064b53cc7
Author: Daniel Lezcano <daniel.lezcano@linaro.org>
Date:   Fri Oct 9 17:47:32 2015 +0200

    clocksource/drivers/pxa_timer: Add the COMPILE_TEST option
    
    Increase the compilation test coverage by adding the COMPILE_TEST option.
    
    Signed-off-by: Daniel Lezcano <daniel.lezcano@linaro.org>

commit baacaf8338516d107b568ae727a47855c7fe6b51
Author: Daniel Lezcano <daniel.lezcano@linaro.org>
Date:   Fri Oct 9 15:36:28 2015 +0200

    clocksource/drivers/st_lpc: Add the COMPILE_TEST option
    
    Increase the compilation test coverage by adding the COMPILE_TEST option.
    
    Signed-off-by: Daniel Lezcano <daniel.lezcano@linaro.org>

commit 3dc0e9f6fda39d1f9c893806bc971ec4ee4939fa
Author: Daniel Lezcano <daniel.lezcano@linaro.org>
Date:   Fri Oct 9 11:10:43 2015 +0200

    clocksource/drivers/qcom: Make COMPILE_TEST enabled for ARM architecture
    
    In order to be consistent with the rest of the drivers compilation, let's
    introduce the COMPILE_TEST option. Unfortunately, the delay.h code is not
    portable, so the compilation test coverage will be restricted to the ARM
    architecture.
    
    Signed-off-by: Daniel Lezcano <daniel.lezcano@linaro.org>

commit 364eba4b3a58a3e9af5a1355f4131a58cd1f3b8d
Author: Daniel Lezcano <daniel.lezcano@linaro.org>
Date:   Thu Oct 29 18:33:47 2015 +0100

    time: Define dummy functions for the generic sched clock
    
    When we try to compile a clocksource driver with the COMPILE_TEST option,
    we can't select the GENERIC_SCHED_CLOCK because the sched_clock() symbol
    will be duplicated with the one defined for the x86.
    
    In order to fix that, we don't select the GENERIC_SCHED_CLOCK in the
    driver Kconfig's file but we define some empty functions for the different
    symbols in order to prevent the unresolved ones.
    
    This patch fixes the COMPILE_TEST option for the compile test coverage for
    the clocksource drivers. Without this patch, we can't add the COMPILE_TEST
    option for the clocksource drivers using the GENERIC_SCHED_CLOCK.
    
    Signed-off-by: Daniel Lezcano <daniel.lezcano@linaro.org>

commit 08dc7c7e407fed00a89bd6f4fc13c7ea20320de1
Author: Javier Martinez Canillas <javier@osg.samsung.com>
Date:   Fri Nov 20 14:35:02 2015 -0300

    ACPI: Fix build errors due objects compiled unconditionally
    
    If the CONFIG_ACPI Kconfig symbol is not enabled and a partial build is
    attempted, compile errors will happen due missing types and identifiers.
    
    This can be easily reproduced with the following commands:
    
    $ export CROSS_COMPILE="arm-linux-gnueabihf-" ARCH=arm
    $ make allmodconfig
    $ make M=drivers/acpi/
      CC      drivers/acpi//tables.o
    drivers/acpi//tables.c:235:3: warning: 'struct acpi_subtable_proc' declared inside parameter list
       unsigned int max_entries)
       ^
    drivers/acpi//tables.c:235:3: warning: its scope is only this definition or declaration, which is probably not what you want
    drivers/acpi//tables.c: In function 'acpi_parse_entries_array':
    drivers/acpi//tables.c:269:4: error: invalid use of undefined type 'struct acpi_subtable_proc'
    ...
    scripts/Makefile.build:258: recipe for target 'drivers/acpi//tables.o' failed
    make[1]: *** [drivers/acpi//tables.o] Error 1
    Makefile:1401: recipe for target '_module_drivers/acpi/' failed
    make: *** [_module_drivers/acpi/] Error 2
    
    This is because objects are tried to be built unconditionally even when
    CONFIG_ACPI is not enabled. This is usually not a problem since arches'
    Kconfig sources drivers/acpi/Kconfig directly and also selects ACPI but
    the Makefile should conditionally build the objects as well to prevent
    these build errors.
    
    Signed-off-by: Javier Martinez Canillas <javier@osg.samsung.com>
    Signed-off-by: Rafael J. Wysocki <rafael.j.wysocki@intel.com>

commit 19190f5ea9917645c770c85f5119bacdcaf4261a
Merge: a2dbb7b56f2c be9e2f775f5a
Author: Linus Torvalds <torvalds@linux-foundation.org>
Date:   Sun Dec 6 08:02:25 2015 -0800

    Merge tag 'scsi-fixes' of git://git.kernel.org/pub/scm/linux/kernel/git/jejb/scsi
    
    Pull SCSI fixes from James Bottomley:
     "This is quite a bumper crop of fixes: three from Arnd correcting
      various build issues in some configurations, a lock recursion in
      qla2xxx.  Two potentially exploitable issues in hpsa and mvsas, a
      potential null deref in st, a revert of a bdi registration fix that
      turned out to cause even more problems, a set of fixes to allow people
      who only defined MPT2SAS to still work after the mpt2/mpt3sas merger
      and a couple of fixes for issues turned up by the hyper-v storvsc
      driver"
    
    * tag 'scsi-fixes' of git://git.kernel.org/pub/scm/linux/kernel/git/jejb/scsi:
      mpt3sas: fix Kconfig dependency problem for mpt2sas back compatibility
      Revert "scsi: Fix a bdi reregistration race"
      mpt3sas: Add dummy Kconfig option for backwards compatibility
      Fix a memory leak in scsi_host_dev_release()
      block/sd: Fix device-imposed transfer length limits
      scsi_debug: fix prevent_allow+verify regressions
      MAINTAINERS: Add myself as co-maintainer of the SCSI subsystem.
      sd: Make discard granularity match logical block size when LBPRZ=1
      scsi: hpsa: select CONFIG_SCSI_SAS_ATTR
      scsi: advansys needs ISA dma api for ISA support
      scsi_sysfs: protect against double execution of __scsi_remove_device()
      st: fix potential null pointer dereference.
      scsi: report 'INQUIRY result too short' once per host
      advansys: fix big-endian builds
      qla2xxx: Fix rwlock recursion
      hpsa: logical vs bitwise AND typo
      mvsas: don't allow negative timeouts
      mpt3sas: Fix use sas_is_tlr_enabled API before enabling MPI2_SCSIIO_CONTROL_TLR_ON flag

commit 03018ac2bb6a2fb1b1272e180141676a97a6a877
Merge: 4fe5e199ebcd 2e22502c080f
Author: Linus Torvalds <torvalds@linux-foundation.org>
Date:   Fri Nov 27 10:08:31 2015 -0800

    Merge tag 'arc-4.4-rc3-fixes' of git://git.kernel.org/pub/scm/linux/kernel/git/vgupta/arc
    
    Pull ARC fixes from Vineet Gupta:
     - Fix for perf callgraph unwinding causing RCU stalls
     - Fix to enable Linux to run on non-default Interrupt priority 0
     - Removal of pointless SYNC from __switch_to()
    
    * tag 'arc-4.4-rc3-fixes' of git://git.kernel.org/pub/scm/linux/kernel/git/vgupta/arc:
      ARC: dw2 unwind: Remove falllback linear search thru FDE entries
      ARC: remove SYNC from __switch_to()
      ARCv2: Use the default irq priority for idle sleep
      ARC: Abstract out ISA specific SLEEP args
      ARC: comments update
      ARC: switch to arc-linux- CROSS_COMPILE prefix across all configs

commit e4217468ae72a02e5d4f33d517a32a8c48b91c44
Author: Arnd Bergmann <arnd@arndb.de>
Date:   Mon Nov 16 22:43:50 2015 +0100

    Revert "thermal: qcom_spmi: allow compile test"
    
    This just caused build errors:
    
    warning: (QCOM_SPMI_TEMP_ALARM) selects REGMAP_SPMI which has unmet direct dependencies (SPMI)
    drivers/built-in.o: In function `regmap_spmi_ext_gather_write':
    :(.text+0x609b0): undefined reference to `spmi_ext_register_write'
    :(.text+0x609f0): undefined reference to `spmi_ext_register_writel'
    
    While it's generally a good idea to allow compile testing, in this
    case, it just doesn't work, so reverting the patch that
    introduced the compile-test variant seems the most appropriate
    solution.
    
    Note that SPMI also has a 'depends on ARCH_QCOM || COMPILE_TEST'
    statement, so we should be able to enable SPMI on all architectures
    for compile testing already.
    
    Signed-off-by: Arnd Bergmann <arnd@arndb.de>
    Fixes: cb7fb4d34202 ("thermal: qcom_spmi: allow compile test")
    Signed-off-by: Eduardo Valentin <edubezval@gmail.com>

commit 56b85c9d7a45a90bf7cb8b5e8c2693f8064b2c09
Author: Arnd Bergmann <arnd@arndb.de>
Date:   Tue Jan 27 22:34:04 2015 +0100

    crypto: atmel: fix bogus select
    
    The Atmel at91 crypto driver unconditionally selects AT_HDMAC,
    which results in a Kconfig warning if that driver is not enabled:
    
    warning: (CRYPTO_DEV_ATMEL_AES) selects AT_HDMAC which has unmet direct dependencies (DMADEVICES && ARCH_AT91)
    
    The crypto driver itself does not actually have a dependency
    on a particular dma engine, other than this being the one that
    is used in at91.
    
    Removing the 'select' gets rid of the warning, but can cause
    the driver to be unusable if the HDMAC is not enabled at the
    same time. To work around that, this patch clarifies the runtime
    dependency to be 'AT_HDMAC || AT_XDMAC', but adds an alternative
    for COMPILE_TEST, which lets the driver get build on all systems.
    
    The ARCH_AT91 dependency is implied by AT_XDMAC || AT_HDMAC now
    and no longer needs to be listed separately.
    
    Signed-off-by: Arnd Bergmann <arnd@arndb.de>
    Signed-off-by: Herbert Xu <herbert@gondor.apana.org.au>

commit 851df3dc11136fde86ebd78ee7527cb43c7cd349
Author: Arnd Bergmann <arnd@arndb.de>
Date:   Mon Nov 16 22:34:58 2015 +0100

    scpi: hide get_scpi_ops in module from built-in code
    
    The scpi_clock driver can be built-in when CONFIG_COMPILE_TEST
    is set even when ARM_SCPI_PROTOCOL is a loadable module, and
    that results in a link error:
    
    drivers/built-in.o: In function `scpi_clocks_probe':
    (.text+0x14453c): undefined reference to `get_scpi_ops'
    
    Using #if IS_REACHABLE() around the get_scpi_ops() declaration
    makes it build successfully in this case for compile-testing,
    but the effect is the same as when ARM_SCPI_PROTOCOL is
    disabled, as the code will not be used.
    
    Signed-off-by: Arnd Bergmann <arnd@arndb.de>
    Acked-by: Punit Agrawal <punit.agrawal@arm.com>

commit a203a2a9ec34936277fa22d6e07ca1f859165205
Author: Arnd Bergmann <arnd@arndb.de>
Date:   Mon Nov 16 18:01:19 2015 +0100

    ARM: zx: only build power domain code when CONFIG_PM=y
    
    The newly added zx power domain code causes build errors in
    some configurations:
    
    warning: (PM_RMOBILE && SOC_ZX296702) selects PM_GENERIC_DOMAINS which has unmet direct dependencies (PM)
    warning: (ARCH_EXYNOS) selects EXYNOS_THERMAL which has unmet direct dependencies (THERMAL && (ARCH_EXYNOS || COMPILE_TEST) && THERMAL_OF)
    power/domain.c: In function 'genpd_queue_power_off_work':
    power/domain.c:192:13: error: 'pm_wq' undeclared (first use in this function)
      queue_work(pm_wq, &genpd->power_off_work);
                 ^
    power/domain.c:192:13: note: each undeclared identifier is reported only once for each function it appears in
    
    This ensures we don't try to enable it when CONFIG_PM is
    disabled, mirroring what we do on most other platforms.
    
    Signed-off-by: Arnd Bergmann <arnd@arndb.de>
    Fixes: f15107f41282 ("ARM: zx: Add power domains for ZX296702")
    Reviewed-by: Jun Nie <jun.nie@linaro.org>

commit 2d4ee3036774e394d416cded9d5cf7661ffb4e4f
Author: Arnd Bergmann <arnd@arndb.de>
Date:   Mon Nov 16 22:27:55 2015 +0100

    cpufreq: mediatek: fix build error
    
    The recently added mt8173 cpufreq driver relies on the cpu topology
    that is always present on ARM64 but optional on ARM32:
    
    drivers/cpufreq/mt8173-cpufreq.c: In function 'mtk_cpufreq_init':
    drivers/cpufreq/mt8173-cpufreq.c:441:30: error: 'cpu_topology' undeclared (first use in this function)
      cpumask_copy(policy->cpus, &cpu_topology[policy->cpu].core_sibling);
    
    This refines the Kconfig dependencies so that we can still build on
    ARM32, but only if COMPILE_TEST is selected and the CPU topology
    code is present.
    
    Signed-off-by: Arnd Bergmann <arnd@arndb.de>
    Signed-off-by: Rafael J. Wysocki <rafael.j.wysocki@intel.com>

commit 3da6d49e847128378c30292848125cc3e207e5f7
Author: Arnd Bergmann <arnd@arndb.de>
Date:   Mon Nov 16 17:51:17 2015 +0100

    clocksource: Disallow drivers for ARCH_USES_GETTIMEOFFSET
    
    We can now select clocksource drivers like ti-32k and CONFIG_OF
    on ancient machines that still use gettimeoffset, and the combination
    results in a link error.
    
    arch/arm/kernel/built-in.o: In function `time_init':
    (.init.text+0xc28): undefined reference to `clocksource_probe'
    
    The reason for this is that the Makefile is hidden behind
    CONFIG_ARCH_USES_GETTIMEOFFSET, but the Kconfig file is not, and
    it has shown up just now because the ti-32k driver was added
    and can be selected using COMPILE_TEST on all platforms.
    
    This patch hides the Kconfig menu in CONFIG_ARCH_USES_GETTIMEOFFSET
    as well.
    
    Fixes: dfedaf105d60 "clocksource: ti-32k: make it depend on GENERIC_CLOCKSOURCE"
    Signed-off-by: Arnd Bergmann <arnd@arndb.de>
    Cc: linux-arm-kernel@lists.infradead.org
    Cc: Felipe Balbi <balbi@ti.com>
    Cc: Tony Lindgren <tony@atomide.com>
    Cc: Daniel Lezcano <daniel.lezcano@linaro.org>
    Link: http://lkml.kernel.org/r/7579471.4N90fYPQOK@wuerfel
    Signed-off-by: Thomas Gleixner <tglx@linutronix.de>

commit 17c4fbaf1a1b3360c4b15bbd78a19aa366eb9ced
Author: sujayraaj <sujayraaj@gmail.com>
Date:   Thu Nov 5 21:52:48 2015 +0530

    ARC: switch to arc-linux- CROSS_COMPILE prefix across all configs
    
    When building kernel with buildroot built toolchain, CROSS_COMPILE
    currently needs adjustment even if minor. This is because the defconfigs
    prefer "arc-linux-uclibc-" prefix from hand built (non buildroot) toolchain
    while buildroot provides "arc-buildroot-linux-uclibc-"
    
    To avoid this use the common "arc-linux-" prefix which is provided by
    buildroot and has also been in hand built tools for quite some time.
    
    Signed-off-by: sujayraaj <sujayraaj@gmail.com>
    Signed-off-by: Vineet Gupta <vgupta@synopsys.com>
    [vgupta: updated changelog]

commit 15de0de29f7ba5cce9699a8cc2344ca137beb25a
Author: Sreekanth Reddy <sreekanth.reddy@avagotech.com>
Date:   Thu Nov 12 23:40:37 2015 +0530

    mpt3sas: Fix use sas_is_tlr_enabled API before enabling MPI2_SCSIIO_CONTROL_TLR_ON flag
    
    Before enabling MPI2_SCSIIO_CONTROL_TLR_ON flag in MPI SCSI IO request
    message, check whether TLR is enabled on the drive using
    'sas_is_tlr_enabled' API.
    
    Actually in the driver code, driver is using below API's
    
    1. sas_enable_tlr() - to enable the TLR
    2. sas_disable_tlr() - to disable the TLR
    3. sas_is_tlr_enabled() - to check whether TLR is enabled or not.
    
    but in scsih_qcmd() we have missed to use sas_is_tlr_enabled() API,
    instead we checking for TLR bit from flag field of driver's 'struct
    MPT3SAS_DEVIC' structure. which is corrected with this patch.
    
    Signed-off-by: Sreekanth Reddy <Sreekanth.Reddy@avagotech.com>
    Reviewed-by: Hannes Reinecke <hare@suse.de>
    Reviewed-by: Tomas Henzl <thenzl@redhat.com>
    Signed-off-by: Martin K. Petersen <martin.petersen@oracle.com>

commit 7dac7102afbeb99daa454f555f1ea1f42fad2f78
Merge: 3370b69eb0c1 f639eeb4a60c
Author: Linus Torvalds <torvalds@linux-foundation.org>
Date:   Thu Nov 12 15:26:39 2015 -0800

    Merge tag 'for-4.4' of git://git.osdn.jp/gitroot/uclinux-h8/linux
    
    Pull h8300 updates from Yoshinori Sato:
     "Some bug fixes"
    
    * tag 'for-4.4' of git://git.osdn.jp/gitroot/uclinux-h8/linux:
      h8300: enable CLKSRC_OF
      h8300: Don't set CROSS_COMPILE unconditionally
      asm-generic: {get,put}_user ptr argument evaluate only 1 time
      h8300: bit io fix
      h8300: zImage fix
      h8300: register address fix
      h8300: Fix alignment for .data
      h8300: unaligned divcr register support.

commit 7786ab6aff9cea97eb0a8d67705c68e97a664bf3
Author: Sreekanth Reddy <sreekanth.reddy@avagotech.com>
Date:   Wed Nov 11 17:30:28 2015 +0530

    mpt3sas: Ported WarpDrive product SSS6200 support
    
    Ported the following list of WarpDrive-specific patches:
    
    1. commit 0bdccdb0a090ad8dc5f851cad5e843244c410ee8 ("mpt2sas: WarpDrive
       New product SSS6200 support added")
    
    2. commit 82a452581230b3ffc9d6475dffdb2568497b5fec ("mpt2sas: WarpDrive
       Infinite command retries due to wrong scsi command entry in MPI
       message")
    
    3. commit ba96bd0b1d4a4e11f23671e1f375a5c8f46b0fe7 ("mpt2sas: Support
       for greater than 2TB capacity WarpDrive")
    
    4. commit 4da7af9494b2f98a1503a2634059300c3e4615e6 ("mpt2sas: Do not
       retry a timed out direct IO for Warpdrive")
    
    5. commit daeaa9df92bd742f4e6d4d6039d689277a8e31bd ("mpt2sas: Avoid type
       casting for direct I/O commands").
    
    Also set the mpt2_ioctl_iocinfo adapter_type to:
    
    1. MPT3_IOCTL_INTERFACE_SAS3 for Gen3 HBAs
    
    2. MPT2_IOCTL_INTERFACE_SAS2_SSS6200 for Warp Drive
    
    3. MPT2_IOCTL_INTERFACE_SAS2  for other Gen2 HBAs
    
    Signed-off-by: Sreekanth Reddy <Sreekanth.Reddy@avagotech.com>
    Acked-by: Christoph Hellwig <hch@lst.de>
    Reviewed-by: Hannes Reinecke <hare@suse.de>
    Signed-off-by: Martin K. Petersen <martin.petersen@oracle.com>

commit 471ef9d4e4982595b2a6081d314a69ca626245ae
Author: Sreekanth Reddy <sreekanth.reddy@avagotech.com>
Date:   Wed Nov 11 17:30:24 2015 +0530

    mpt3sas: Build MPI SGL LIST on GEN2 HBAs and IEEE SGL LIST on GEN3 HBAs
    
    Gen2 HBAs use MPI scatter-gather lists whereas Gen3 HBAs use IEEE
    scatter-gather lists. Modify the common code part in such a way that it
    will build IEEE SGL tables for Gen3 HBAs and MPI SGL tables for Gen2
    HBAs.
    
    Signed-off-by: Sreekanth Reddy <Sreekanth.Reddy@avagotech.com>
    Acked-by: Christoph Hellwig <hch@lst.de>
    Reviewed-by: Hannes Reinecke <hare@suse.de>
    Signed-off-by: Martin K. Petersen <martin.petersen@oracle.com>

commit 3bc27cdfe989906fb025204c68a6f85b07b3a192
Author: Javier Martinez Canillas <javier@osg.samsung.com>
Date:   Fri Oct 16 13:31:27 2015 +0200

    h8300: Don't set CROSS_COMPILE unconditionally
    
    The h8300 architecture Makefile sets the CROSS_COMPILE variable to
    "h8300-unknown-linux-" unconditionally but doing that prevents the
    variable to be used if a toolchain with a different binary name is
    installed in the machine.
    
    So only set CROSS_COMPILE to that default if the variable has not
    been set by the user before.
    
    Signed-off-by: Javier Martinez Canillas <javier@osg.samsung.com>

commit 52787e91bf5375e68e90f381bd157bd92e1f4a77
Merge: f66477a0aeb7 62e544b983a0
Author: Linus Torvalds <torvalds@linux-foundation.org>
Date:   Thu Nov 5 13:06:22 2015 -0800

    Merge tag 'regulator-v4.4' of git://git.kernel.org/pub/scm/linux/kernel/git/broonie/regulator
    
    Pull regulator updates from Mark Brown:
     "This is quite a quiet release in terms of volume of patches but it
      includes a couple of really nice core changes - the work Sascha has
      done in particular is something I've wanted to get done for a long
      time but just never got round to myself.
    
      Highlights include:
    
       - Support from Sascha Hauer for setting the voltage of parent
         supplies based on requests from their children.  This is used both
         to allow set_voltage() to work through a dumb switch and to improve
         the efficiency of systems where DCDCs are used to supply LDOs by
         minimising the voltage drop over the LDOs.
    
       - Removal of regulator_list by Tomeu Vizoso, meaning we're not
         duplicating the device list maintained by the driver core.
    
       - Support for Wolfson/Cirrus WM8998 and WM1818"
    
    * tag 'regulator-v4.4' of git://git.kernel.org/pub/scm/linux/kernel/git/broonie/regulator: (29 commits)
      regulator: Use regulator_lock_supply() for get_voltage() too
      regulator: arizona: Add regulator specific device tree binding document
      regulator: stw481x: compile on COMPILE_TEST
      regulator: qcom-smd: Correct set_load() unit
      regulator: core: Propagate voltage changes to supply regulators
      regulator: core: Factor out regulator_map_voltage
      regulator: i.MX anatop: Allow supply regulator
      regulator: introduce min_dropout_uV
      regulator: core: create unlocked version of regulator_set_voltage
      regulator: arizona-ldo1: Fix handling of GPIO 0
      regulator: da9053: Update regulator for DA9053 BC silicon support
      regulator: max77802: Separate sections for nodes and properties
      regulator: max77802: Add input supply properties to DT binding doc
      regulator: axp20x: set supply names for AXP22X DC1SW/DC5LDO internally
      regulator: axp20x: Drop AXP221 DC1SW and DC5LDO regulator supplies from bindings
      mfd: tps6105x: Use i2c regmap to access registers
      regulator: act8865: add DT binding for property "active-semi,vsel-high"
      regulator: act8865: support output voltage by VSET2[] bits
      regulator: arizona: add support for WM8998 and WM1814
      regulator: core: create unlocked version of regulator_list_voltage
      ...

commit 5349ca11ca33dd393539024b613ef352d24cbb51
Author: Luis de Bethencourt <luisbg@osg.samsung.com>
Date:   Mon Oct 12 17:26:07 2015 +0100

    mfd: Kconfig: Compile MFD_STW481X with COMPILE_TEST
    
    The driver depends on ARCH_NOMADIK but there isn't a build dependency
    so it's a good idea to allow the driver to always be built when the
    COMPILE_TEST option is enabled.
    
    That way, the driver can be built with a config generated by make
    allyesconfig and check if a patch would break the build.
    
    Signed-off-by: Luis de Bethencourt <luisbg@osg.samsung.com>
    Signed-off-by: Lee Jones <lee.jones@linaro.org>

commit 5b12405cd01699eb0ac6784fb3cd9fb53e80dfd7
Author: Paul Mackerras <paulus@ozlabs.org>
Date:   Thu Sep 10 14:36:21 2015 +1000

    powerpc/MSI: Fix race condition in tearing down MSI interrupts
    
    [ Upstream commit e297c939b745e420ef0b9dc989cb87bda617b399 ]
    
    This fixes a race which can result in the same virtual IRQ number
    being assigned to two different MSI interrupts.  The most visible
    consequence of that is usually a warning and stack trace from the
    sysfs code about an attempt to create a duplicate entry in sysfs.
    
    The race happens when one CPU (say CPU 0) is disposing of an MSI
    while another CPU (say CPU 1) is setting up an MSI.  CPU 0 calls
    (for example) pnv_teardown_msi_irqs(), which calls
    msi_bitmap_free_hwirqs() to indicate that the MSI (i.e. its
    hardware IRQ number) is no longer in use.  Then, before CPU 0 gets
    to calling irq_dispose_mapping() to free up the virtal IRQ number,
    CPU 1 comes in and calls msi_bitmap_alloc_hwirqs() to allocate an
    MSI, and gets the same hardware IRQ number that CPU 0 just freed.
    CPU 1 then calls irq_create_mapping() to get a virtual IRQ number,
    which sees that there is currently a mapping for that hardware IRQ
    number and returns the corresponding virtual IRQ number (which is
    the same virtual IRQ number that CPU 0 was using).  CPU 0 then
    calls irq_dispose_mapping() and frees that virtual IRQ number.
    Now, if another CPU comes along and calls irq_create_mapping(), it
    is likely to get the virtual IRQ number that was just freed,
    resulting in the same virtual IRQ number apparently being used for
    two different hardware interrupts.
    
    To fix this race, we just move the call to msi_bitmap_free_hwirqs()
    to after the call to irq_dispose_mapping().  Since virq_to_hw()
    doesn't work for the virtual IRQ number after irq_dispose_mapping()
    has been called, we need to call it before irq_dispose_mapping() and
    remember the result for the msi_bitmap_free_hwirqs() call.
    
    The pattern of calling msi_bitmap_free_hwirqs() before
    irq_dispose_mapping() appears in 5 places under arch/powerpc, and
    appears to have originated in commit 05af7bd2d75e ("[POWERPC] MPIC
    U3/U4 MSI backend") from 2007.
    
    Fixes: 05af7bd2d75e ("[POWERPC] MPIC U3/U4 MSI backend")
    Cc: stable@vger.kernel.org # v2.6.22+
    Reported-by: Alexey Kardashevskiy <aik@ozlabs.ru>
    Signed-off-by: Paul Mackerras <paulus@samba.org>
    Signed-off-by: Michael Ellerman <mpe@ellerman.id.au>
    Signed-off-by: Sasha Levin <sasha.levin@oracle.com>

commit 9100d20c5b6307bacd8756aba2f157cb1a8ffb56
Author: Sudeep Holla <Sudeep.Holla@arm.com>
Date:   Mon Sep 21 16:47:00 2015 +0100

    powerpc: mpic: use IRQCHIP_SKIP_SET_WAKE instead of redundant mpic_irq_set_wake
    
    mpic_irq_set_wake return -ENXIO for non FSL MPIC and sets IRQF_NO_SUSPEND
    flag for FSL ones. enable_irq_wake already returns -ENXIO if irq_set_wak
    is not implemented. Also there's no need to set the IRQF_NO_SUSPEND flag
    as it doesn't guarantee wakeup for that interrupt.
    
    This patch removes the redundant mpic_irq_set_wake and sets the
    IRQCHIP_SKIP_SET_WAKE for only FSL MPIC.
    
    Cc: Benjamin Herrenschmidt <benh@kernel.crashing.org>
    Cc: Paul Mackerras <paulus@samba.org>
    Cc: Michael Ellerman <mpe@ellerman.id.au>
    Cc: Scott Wood <scottwood@freescale.com>
    Cc: Hongtao Jia <hongtao.jia@freescale.com>
    Cc: Marc Zyngier <marc.zyngier@arm.com>
    Cc: linuxppc-dev@lists.ozlabs.org
    Signed-off-by: Sudeep Holla <sudeep.holla@arm.com>
    Acked-by: Scott Wood <scottwood@freescale.com>
    Signed-off-by: Scott Wood <scottwood@freescale.com>

commit 1b7c501b51a8c851ff82769cbe905ef19cb70239
Author: Rob Herring <robh@kernel.org>
Date:   Tue Oct 6 17:57:33 2015 -0500

    of: add config option to enable building of all dtbs
    
    Enable building all dtb files when CONFIG_OF_ALL_DTBS is enabled. The dtbs
    are not really dependent on a platform being enabled or any other kernel
    config, so for testing coverage it is convenient to build all of the dtbs.
    
    In order to only build dtbs, this option can be used by creating an
    allno.config file containing:
    CONFIG_COMPILE_TEST=y
    CONFIG_OF=y
    CONFIG_OF_ALL_DTBS=y
    
    And then running:
    make KCONFIG_ALLCONFIG=1 allnoconfig
    make dtbs
    
    While building the dtbs themselves don't need a cross compiler, the
    scripts dependency does need one. This can be hacked around by
    commenting out "subdir-y += mod" in scripts/Makefile.
    
    Signed-off-by: Rob Herring <robh@kernel.org>
    Cc: Frank Rowand <frowand.list@gmail.com>
    Cc: Grant Likely <grant.likely@linaro.org>

commit 04850c4d8613127a9b488321c0ad83bff7519311
Author: Han Xu <b45815@freescale.com>
Date:   Fri Oct 23 13:18:28 2015 -0500

    mtd: fsl-quadspi: fix macro collision problems with READ/WRITE
    
    Change the READ/WRITE to FSL_READ/FSL_WRITE to resolve any possible
    namespace collisions with READ/WRITE macros (e.g., from <linux/fs.h>).
    
    Problems have been seen, for example, on mips:
    
    >> drivers/mtd/spi-nor/fsl-quadspi.c:186:5: error: 'LUT_0' undeclared (first use in this function)
          ((LUT_##ins) << INSTR0_SHIFT))
            ^
    >> drivers/mtd/spi-nor/fsl-quadspi.c:188:30: note: in expansion of macro 'LUT0'
    
    On SPARC:
    
    drivers/mtd/spi-nor/fsl-quadspi.c: In function 'fsl_qspi_init_lut':
    drivers/mtd/spi-nor/fsl-quadspi.c:369:1: error: 'LUT_0' undeclared (first use in this function)
    drivers/mtd/spi-nor/fsl-quadspi.c:418:1: error: pasting "LUT_" and "(" does not give a valid preprocessing token
    drivers/mtd/spi-nor/fsl-quadspi.c:418:2: error: implicit declaration of function 'LUT_'
    
    And surely on others.
    
    Fixes: d26a22d06708 ("mtd: fsl-quadspi: allow building for other ARCHes with COMPILE_TEST")
    Reported-by: Guenter Roeck <linux@roeck-us.net>
    Reported-by: kbuild test robot <fengguang.wu@intel.com>
    Signed-off-by: Han Xu <b45815@freescale.com>
    [Brian: rewrote commit description]
    Signed-off-by: Brian Norris <computersforpeace@gmail.com>

commit 679c51cffc3b316bd89ecc91ef92603dd6d4fc68
Author: Stephen Boyd <sboyd@codeaurora.org>
Date:   Mon Oct 26 11:55:34 2015 -0700

    clk: Add stubs for of_clk_*() APIs when CONFIG_OF=n
    
    Compiling the versatile clock driver with COMPILE_TEST=y and CONFIG_OF=n
    leads to the following error:
    
       drivers/clk/versatile/clk-sp810.c: In function 'clk_sp810_of_setup':
       drivers/clk/versatile/clk-sp810.c:103:6: error: implicit declaration of
    function 'of_clk_parent_fill' [-Werror=implicit-function-declaration]
    
    Silence it by providing stubs APIs for of_clk_parent_fill().
    Throw in a stub for of_clk_get_parent_count() too because we're
    in the area.
    
    Reported-by: kbuild test robot <fengguang.wu@intel.com>
    Cc: Javier Martinez Canillas <javier@osg.samsung.com>
    Signed-off-by: Stephen Boyd <sboyd@codeaurora.org>

commit 7f8a9a7e98f99e9cd874eaf6ca2f00438c2a7c38
Author: Luis de Bethencourt <luisbg@osg.samsung.com>
Date:   Sat Oct 10 17:08:32 2015 +0100

    mmc: android-goldfish: Allow compiling the driver with COMPILE_TEST
    
    The driver depends on GOLDFISH but there isn't a build dependency
    so it's a good idea to allow the driver to always be built when the
    COMPILE_TEST option is enabled.
    
    That way, the driver can be built with a config generated by make
    allyesconfig and check if a patch would break the build.
    
    Signed-off-by: Luis de Bethencourt <luisbg@osg.samsung.com>
    Reviewed-by: Jean Delvare <jdelvare@suse.de>
    Signed-off-by: Ulf Hansson <ulf.hansson@linaro.org>

commit 34411b68b132e403ddf395419e986475a9993d9b
Author: Thanneeru Srinivasulu <tsrinivasulu@caviumnetworks.com>
Date:   Fri Oct 23 17:14:10 2015 -0700

    net: thunderx: Incorporate pass2 silicon CPI index configuration changes
    
    Add support for ThunderX pass2 CPI and MPI configuration changes.
    MPI_ALG is not enabled i.e MCAM parsing is disabled.
    
    Signed-off-by: Thanneeru Srinivasulu <tsrinivasulu@caviumnetworks.com>
    Signed-off-by: Sunil Goutham <sgoutham@cavium.com>
    Signed-off-by: David Daney <david.daney@cavium.com>
    Signed-off-by: David S. Miller <davem@davemloft.net>

commit f4cbe79f341ca8efe368edab89523b84bb8c0c93
Author: Paul Mackerras <paulus@ozlabs.org>
Date:   Thu Sep 10 14:36:21 2015 +1000

    powerpc/MSI: Fix race condition in tearing down MSI interrupts
    
    commit e297c939b745e420ef0b9dc989cb87bda617b399 upstream.
    
    This fixes a race which can result in the same virtual IRQ number
    being assigned to two different MSI interrupts.  The most visible
    consequence of that is usually a warning and stack trace from the
    sysfs code about an attempt to create a duplicate entry in sysfs.
    
    The race happens when one CPU (say CPU 0) is disposing of an MSI
    while another CPU (say CPU 1) is setting up an MSI.  CPU 0 calls
    (for example) pnv_teardown_msi_irqs(), which calls
    msi_bitmap_free_hwirqs() to indicate that the MSI (i.e. its
    hardware IRQ number) is no longer in use.  Then, before CPU 0 gets
    to calling irq_dispose_mapping() to free up the virtal IRQ number,
    CPU 1 comes in and calls msi_bitmap_alloc_hwirqs() to allocate an
    MSI, and gets the same hardware IRQ number that CPU 0 just freed.
    CPU 1 then calls irq_create_mapping() to get a virtual IRQ number,
    which sees that there is currently a mapping for that hardware IRQ
    number and returns the corresponding virtual IRQ number (which is
    the same virtual IRQ number that CPU 0 was using).  CPU 0 then
    calls irq_dispose_mapping() and frees that virtual IRQ number.
    Now, if another CPU comes along and calls irq_create_mapping(), it
    is likely to get the virtual IRQ number that was just freed,
    resulting in the same virtual IRQ number apparently being used for
    two different hardware interrupts.
    
    To fix this race, we just move the call to msi_bitmap_free_hwirqs()
    to after the call to irq_dispose_mapping().  Since virq_to_hw()
    doesn't work for the virtual IRQ number after irq_dispose_mapping()
    has been called, we need to call it before irq_dispose_mapping() and
    remember the result for the msi_bitmap_free_hwirqs() call.
    
    The pattern of calling msi_bitmap_free_hwirqs() before
    irq_dispose_mapping() appears in 5 places under arch/powerpc, and
    appears to have originated in commit 05af7bd2d75e ("[POWERPC] MPIC
    U3/U4 MSI backend") from 2007.
    
    Fixes: 05af7bd2d75e ("[POWERPC] MPIC U3/U4 MSI backend")
    Reported-by: Alexey Kardashevskiy <aik@ozlabs.ru>
    Signed-off-by: Paul Mackerras <paulus@samba.org>
    Signed-off-by: Michael Ellerman <mpe@ellerman.id.au>
    Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>

commit e6b5ff2bbb2f2b10860efaa052783eeaa3cd257d
Author: Paul Mackerras <paulus@ozlabs.org>
Date:   Thu Sep 10 14:36:21 2015 +1000

    powerpc/MSI: Fix race condition in tearing down MSI interrupts
    
    commit e297c939b745e420ef0b9dc989cb87bda617b399 upstream.
    
    This fixes a race which can result in the same virtual IRQ number
    being assigned to two different MSI interrupts.  The most visible
    consequence of that is usually a warning and stack trace from the
    sysfs code about an attempt to create a duplicate entry in sysfs.
    
    The race happens when one CPU (say CPU 0) is disposing of an MSI
    while another CPU (say CPU 1) is setting up an MSI.  CPU 0 calls
    (for example) pnv_teardown_msi_irqs(), which calls
    msi_bitmap_free_hwirqs() to indicate that the MSI (i.e. its
    hardware IRQ number) is no longer in use.  Then, before CPU 0 gets
    to calling irq_dispose_mapping() to free up the virtal IRQ number,
    CPU 1 comes in and calls msi_bitmap_alloc_hwirqs() to allocate an
    MSI, and gets the same hardware IRQ number that CPU 0 just freed.
    CPU 1 then calls irq_create_mapping() to get a virtual IRQ number,
    which sees that there is currently a mapping for that hardware IRQ
    number and returns the corresponding virtual IRQ number (which is
    the same virtual IRQ number that CPU 0 was using).  CPU 0 then
    calls irq_dispose_mapping() and frees that virtual IRQ number.
    Now, if another CPU comes along and calls irq_create_mapping(), it
    is likely to get the virtual IRQ number that was just freed,
    resulting in the same virtual IRQ number apparently being used for
    two different hardware interrupts.
    
    To fix this race, we just move the call to msi_bitmap_free_hwirqs()
    to after the call to irq_dispose_mapping().  Since virq_to_hw()
    doesn't work for the virtual IRQ number after irq_dispose_mapping()
    has been called, we need to call it before irq_dispose_mapping() and
    remember the result for the msi_bitmap_free_hwirqs() call.
    
    The pattern of calling msi_bitmap_free_hwirqs() before
    irq_dispose_mapping() appears in 5 places under arch/powerpc, and
    appears to have originated in commit 05af7bd2d75e ("[POWERPC] MPIC
    U3/U4 MSI backend") from 2007.
    
    Fixes: 05af7bd2d75e ("[POWERPC] MPIC U3/U4 MSI backend")
    Reported-by: Alexey Kardashevskiy <aik@ozlabs.ru>
    Signed-off-by: Paul Mackerras <paulus@samba.org>
    Signed-off-by: Michael Ellerman <mpe@ellerman.id.au>
    Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>

commit 25b030bbdc8d6a36b9c2fbbbb8b806f846fc4a89
Author: Paul Mackerras <paulus@ozlabs.org>
Date:   Thu Sep 10 14:36:21 2015 +1000

    powerpc/MSI: Fix race condition in tearing down MSI interrupts
    
    commit e297c939b745e420ef0b9dc989cb87bda617b399 upstream.
    
    This fixes a race which can result in the same virtual IRQ number
    being assigned to two different MSI interrupts.  The most visible
    consequence of that is usually a warning and stack trace from the
    sysfs code about an attempt to create a duplicate entry in sysfs.
    
    The race happens when one CPU (say CPU 0) is disposing of an MSI
    while another CPU (say CPU 1) is setting up an MSI.  CPU 0 calls
    (for example) pnv_teardown_msi_irqs(), which calls
    msi_bitmap_free_hwirqs() to indicate that the MSI (i.e. its
    hardware IRQ number) is no longer in use.  Then, before CPU 0 gets
    to calling irq_dispose_mapping() to free up the virtal IRQ number,
    CPU 1 comes in and calls msi_bitmap_alloc_hwirqs() to allocate an
    MSI, and gets the same hardware IRQ number that CPU 0 just freed.
    CPU 1 then calls irq_create_mapping() to get a virtual IRQ number,
    which sees that there is currently a mapping for that hardware IRQ
    number and returns the corresponding virtual IRQ number (which is
    the same virtual IRQ number that CPU 0 was using).  CPU 0 then
    calls irq_dispose_mapping() and frees that virtual IRQ number.
    Now, if another CPU comes along and calls irq_create_mapping(), it
    is likely to get the virtual IRQ number that was just freed,
    resulting in the same virtual IRQ number apparently being used for
    two different hardware interrupts.
    
    To fix this race, we just move the call to msi_bitmap_free_hwirqs()
    to after the call to irq_dispose_mapping().  Since virq_to_hw()
    doesn't work for the virtual IRQ number after irq_dispose_mapping()
    has been called, we need to call it before irq_dispose_mapping() and
    remember the result for the msi_bitmap_free_hwirqs() call.
    
    The pattern of calling msi_bitmap_free_hwirqs() before
    irq_dispose_mapping() appears in 5 places under arch/powerpc, and
    appears to have originated in commit 05af7bd2d75e ("[POWERPC] MPIC
    U3/U4 MSI backend") from 2007.
    
    Fixes: 05af7bd2d75e ("[POWERPC] MPIC U3/U4 MSI backend")
    Reported-by: Alexey Kardashevskiy <aik@ozlabs.ru>
    Signed-off-by: Paul Mackerras <paulus@samba.org>
    Signed-off-by: Michael Ellerman <mpe@ellerman.id.au>
    Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>

commit 892e053cd7afcc54b2958130cab94ee2123be2d7
Author: Paul Mackerras <paulus@ozlabs.org>
Date:   Thu Sep 10 14:36:21 2015 +1000

    powerpc/MSI: Fix race condition in tearing down MSI interrupts
    
    commit e297c939b745e420ef0b9dc989cb87bda617b399 upstream.
    
    This fixes a race which can result in the same virtual IRQ number
    being assigned to two different MSI interrupts.  The most visible
    consequence of that is usually a warning and stack trace from the
    sysfs code about an attempt to create a duplicate entry in sysfs.
    
    The race happens when one CPU (say CPU 0) is disposing of an MSI
    while another CPU (say CPU 1) is setting up an MSI.  CPU 0 calls
    (for example) pnv_teardown_msi_irqs(), which calls
    msi_bitmap_free_hwirqs() to indicate that the MSI (i.e. its
    hardware IRQ number) is no longer in use.  Then, before CPU 0 gets
    to calling irq_dispose_mapping() to free up the virtal IRQ number,
    CPU 1 comes in and calls msi_bitmap_alloc_hwirqs() to allocate an
    MSI, and gets the same hardware IRQ number that CPU 0 just freed.
    CPU 1 then calls irq_create_mapping() to get a virtual IRQ number,
    which sees that there is currently a mapping for that hardware IRQ
    number and returns the corresponding virtual IRQ number (which is
    the same virtual IRQ number that CPU 0 was using).  CPU 0 then
    calls irq_dispose_mapping() and frees that virtual IRQ number.
    Now, if another CPU comes along and calls irq_create_mapping(), it
    is likely to get the virtual IRQ number that was just freed,
    resulting in the same virtual IRQ number apparently being used for
    two different hardware interrupts.
    
    To fix this race, we just move the call to msi_bitmap_free_hwirqs()
    to after the call to irq_dispose_mapping().  Since virq_to_hw()
    doesn't work for the virtual IRQ number after irq_dispose_mapping()
    has been called, we need to call it before irq_dispose_mapping() and
    remember the result for the msi_bitmap_free_hwirqs() call.
    
    The pattern of calling msi_bitmap_free_hwirqs() before
    irq_dispose_mapping() appears in 5 places under arch/powerpc, and
    appears to have originated in commit 05af7bd2d75e ("[POWERPC] MPIC
    U3/U4 MSI backend") from 2007.
    
    Fixes: 05af7bd2d75e ("[POWERPC] MPIC U3/U4 MSI backend")
    Reported-by: Alexey Kardashevskiy <aik@ozlabs.ru>
    Signed-off-by: Paul Mackerras <paulus@samba.org>
    Signed-off-by: Michael Ellerman <mpe@ellerman.id.au>
    Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>

commit 44d8fb30941d85800fbde0a1e3454b1fb23c5ecd
Author: Jonas Gorski <jogo@openwrt.org>
Date:   Mon Oct 12 12:24:23 2015 +0200

    spi/bcm63xx: move register definitions into the driver
    
    Move all register definitions and structs into the driver. This allows
    us dropping the platform_data struct and drop any arch specific
    includes. Make use of different device names to identify the version of
    the block we have.
    
    Since we now have full control over the message width, we can drop the
    size check, which was broken anyway, since it never set ret to any error
    code.
    
    Also since we now have no arch depedendent resources, we can now allow
    compiling it for any arch, hidden behind COMPILE_TEST.
    
    Signed-off-by: Jonas Gorski <jogo@openwrt.org>
    Signed-off-by: Mark Brown <broonie@kernel.org>

commit 4049dc1a43d1530eb462ec42201335e7b0439a80
Author: Luis de Bethencourt <luisbg@osg.samsung.com>
Date:   Mon Oct 12 17:27:08 2015 +0100

    regulator: stw481x: compile on COMPILE_TEST
    
    The driver depends on MFD_STW481X but there isn't a build dependency so
    it's a good idea to allow the driver to always be built when the
    COMPILE_TEST option is enabled.
    
    That way, the driver can be built with a config generated by make
    allyesconfig and check if a patch would break the build.
    
    Signed-off-by: Luis de Bethencourt <luisbg@osg.samsung.com>
    Signed-off-by: Mark Brown <broonie@kernel.org>

commit c8b75bca92cbf064b9fa125fc74a85994452e935
Author: Eric Anholt <eric@anholt.net>
Date:   Mon Mar 2 13:01:12 2015 -0800

    drm/vc4: Add KMS support for Raspberry Pi.
    
    This is enough for fbcon and bringing up X using
    xf86-video-modesetting.  It doesn't support the 3D accelerator or
    power management yet.
    
    v2: Drop FB_HELPER select thanks to Archit's patches.  Do manual init
        ordering instead of using the .load hook.  Structure registration
        more like tegra's, but still using the typical "component" code.
        Drop no-op hooks for atomic_begin and mode_fixup() now that
        they're optional.  Drop sentinel in Makefile.  Fix minor style
        nits I noticed on another reread.
    
    v3: Use the new bcm2835 clk driver to manage pixel/HSM clocks instead
        of having a fixed video mode.  Use exynos-style component driver
        matching instead of devicetree nodes to list the component driver
        instances.  Rename compatibility strings to say bcm2835, and
        distinguish pv0/1/2.  Clean up some h/vsync code, and add in
        interlaced mode setup.  Fix up probe/bind error paths.  Use
        bitops.h macros for vc4_regs.h
    
    v4: Include i2c.h, allow building under COMPILE_TEST, drop msleep now
        that other bugs have been fixed, add timeouts to cpu_relax()
        loops, rename hpd-gpio to hpd-gpios.
    
    Signed-off-by: Eric Anholt <eric@anholt.net>
    Acked-by: Daniel Vetter <daniel.vetter@ffwll.ch>

commit d26a22d06708ba5a181003d44fcd6d0885cec8d4
Author: Brian Norris <computersforpeace@gmail.com>
Date:   Mon Oct 12 13:35:16 2015 -0700

    mtd: fsl-quadspi: allow building for other ARCHes with COMPILE_TEST
    
    This driver doesn't actually need ARCH_MXC to compile. Relax the
    constraints.
    
    Signed-off-by: Brian Norris <computersforpeace@gmail.com>
    Acked-by: Han xu <han.xu@freescale.com>

commit 876133d3161dcb743983d1f9e5bf247aea2fb0f1
Author: Arnd Bergmann <arnd@arndb.de>
Date:   Fri Oct 16 11:33:49 2015 +0200

    net: hisilicon: add OF dependency
    
    The HNS MDIO driver fails to build on older ARM machines that are not
    yet converted to CONFIG_OF:
    
    drivers/net/ethernet/hisilicon/hns_mdio.c: In function 'hns_mdio_bus_name':
    drivers/net/ethernet/hisilicon/hns_mdio.c:405:14: error: 'OF_BAD_ADDR' undeclared (first use in this function)
      u64 taddr = OF_BAD_ADDR;
                  ^
    drivers/net/ethernet/hisilicon/hns_mdio.c:405:14: note: each undeclared identifier is reported only once for each function it appears in
    drivers/net/ethernet/hisilicon/hns_mdio.c:409:11: error: implicit declaration of function 'of_translate_address' [-Werror=implicit-function-declaration]
       taddr = of_translate_address(np, addr);
               ^
    
    This clarifies the dependency to ensure we don't attempt to build these
    drivers without CONFIG_OF, but also adds a COMPILE_TEST alternative to
    give us better build coverage testing.
    
    Build-tested on x86 as well to ensure this actually works.
    
    Signed-off-by: Arnd Bergmann <arnd@arndb.de>
    Signed-off-by: David S. Miller <davem@davemloft.net>

commit eb6301160dde0227ac27c6ec2a0b57054d88e398
Author: Geert Uytterhoeven <geert@linux-m68k.org>
Date:   Sun Aug 2 11:08:47 2015 +0200

    tpm: Allow compile test of GPIO consumers if !GPIOLIB
    
    The GPIO subsystem provides dummy GPIO consumer functions if GPIOLIB is
    not enabled. Hence drivers that depend on GPIOLIB, but use GPIO consumer
    functionality only, can still be compiled if GPIOLIB is not enabled.
    
    Relax the dependency on GPIOLIB if COMPILE_TEST is enabled, where
    appropriate.
    
    Signed-off-by: Geert Uytterhoeven <geert@linux-m68k.org>
    Acked-by: Linus Walleij <linus.walleij@linaro.org>
    Reviewed-by: Peter Huewe <peterhuewe@gmx.de>
    Signed-off-by: Peter Huewe <peterhuewe@gmx.de>

commit 881ea7d3f55bf7b8834c81d86c4dcb3d5f786f15
Author: chenhui zhao <chenhui.zhao@freescale.com>
Date:   Thu Jul 23 11:55:45 2015 +0800

    powerpc/corenet: use the mixed mode of MPIC when enabling CPU hotplug
    
    Core reset may cause issue if using the proxy mode of MPIC.
    Use the mixed mode of MPIC if enabling CPU hotplug.
    
    Signed-off-by: Chenhui Zhao <chenhui.zhao@freescale.com>
    Signed-off-by: Scott Wood <scottwood@freescale.com>

commit 4a7748c3d6419bb81787480526d62bbaf083ef84
Author: Javier Martinez Canillas <javier@osg.samsung.com>
Date:   Tue Oct 13 16:18:18 2015 +0200

    clk: Allow drivers to build if COMPILE_TEST is enabled
    
    These drivers only have runtime but no build time dependencies so can be
    built for testing purposes if the Kconfig COMPILE_TEST option is enabled.
    
    This is useful to have more build coverage and make sure that drivers are
    not affected by changes that could cause build regressions.
    
    Signed-off-by: Javier Martinez Canillas <javier@osg.samsung.com>
    Acked-by: Scott Branden <sbranden@broadcom.com>
    Signed-off-by: Stephen Boyd <sboyd@codeaurora.org>

commit 2df26ef7da6f1960622f37c2a7c57d238603f0d6
Author: Jisheng Zhang <jszhang@marvell.com>
Date:   Fri Oct 16 15:37:07 2015 +0800

    pinctrl: berlin: Make berlin pinctrl driver visible if COMPILE_TEST=y
    
    It is good to allow berlin pinctrl driver to build with COMPILE_TEST, so
    make the it menu visible when compile-testing.
    
    Signed-off-by: Jisheng Zhang <jszhang@marvell.com>
    Acked-by: Sebastian Hesselbarth <sebastian.hesselbarth@gmail.com>
    Acked-by: Antoine Tenart <antoine.tenart@free-electrons.com>
    Signed-off-by: Linus Walleij <linus.walleij@linaro.org>

commit 96ad262ff1969ad4b79774c761715a3d50f776c0
Author: Paul Mackerras <paulus@ozlabs.org>
Date:   Thu Sep 10 14:36:21 2015 +1000

    powerpc/MSI: Fix race condition in tearing down MSI interrupts
    
    commit e297c939b745e420ef0b9dc989cb87bda617b399 upstream.
    
    This fixes a race which can result in the same virtual IRQ number
    being assigned to two different MSI interrupts.  The most visible
    consequence of that is usually a warning and stack trace from the
    sysfs code about an attempt to create a duplicate entry in sysfs.
    
    The race happens when one CPU (say CPU 0) is disposing of an MSI
    while another CPU (say CPU 1) is setting up an MSI.  CPU 0 calls
    (for example) pnv_teardown_msi_irqs(), which calls
    msi_bitmap_free_hwirqs() to indicate that the MSI (i.e. its
    hardware IRQ number) is no longer in use.  Then, before CPU 0 gets
    to calling irq_dispose_mapping() to free up the virtal IRQ number,
    CPU 1 comes in and calls msi_bitmap_alloc_hwirqs() to allocate an
    MSI, and gets the same hardware IRQ number that CPU 0 just freed.
    CPU 1 then calls irq_create_mapping() to get a virtual IRQ number,
    which sees that there is currently a mapping for that hardware IRQ
    number and returns the corresponding virtual IRQ number (which is
    the same virtual IRQ number that CPU 0 was using).  CPU 0 then
    calls irq_dispose_mapping() and frees that virtual IRQ number.
    Now, if another CPU comes along and calls irq_create_mapping(), it
    is likely to get the virtual IRQ number that was just freed,
    resulting in the same virtual IRQ number apparently being used for
    two different hardware interrupts.
    
    To fix this race, we just move the call to msi_bitmap_free_hwirqs()
    to after the call to irq_dispose_mapping().  Since virq_to_hw()
    doesn't work for the virtual IRQ number after irq_dispose_mapping()
    has been called, we need to call it before irq_dispose_mapping() and
    remember the result for the msi_bitmap_free_hwirqs() call.
    
    The pattern of calling msi_bitmap_free_hwirqs() before
    irq_dispose_mapping() appears in 5 places under arch/powerpc, and
    appears to have originated in commit 05af7bd2d75e ("[POWERPC] MPIC
    U3/U4 MSI backend") from 2007.
    
    Fixes: 05af7bd2d75e ("[POWERPC] MPIC U3/U4 MSI backend")
    Reported-by: Alexey Kardashevskiy <aik@ozlabs.ru>
    Signed-off-by: Paul Mackerras <paulus@samba.org>
    Signed-off-by: Michael Ellerman <mpe@ellerman.id.au>
    [bwh: Backported to 3.2:
     - powernv uses a private functions instead of msi_bitmap_free_hwirqs()
     - Adjust filename, context]
    Signed-off-by: Ben Hutchings <ben@decadent.org.uk>

commit 0cc598915fc787193ddb7401a11f80c17ccbabe4
Author: Thierry Reding <treding@nvidia.com>
Date:   Fri Oct 9 15:46:18 2015 +0200

    soc: rockchip: Restrict to ARCH_ROCKCHIP
    
    By definition this directory contains drivers that are specific to the
    Rockchip architecture. All Kconfig options should therefore depend on
    ARCH_ROCKCHIP to avoid exposing these symbols on other architectures.
    For example, this options currently shows up as new when doing an
    incremental build on PowerPC.
    
    Signed-off-by: Thierry Reding <treding@nvidia.com>
    
    [add COMPILE_TEST alternative condition]
    Signed-off-by: Heiko Stuebner <heiko@sntech.de>

commit 23ecee32b91cf732226bd7a3ee9fa7a9127645ab
Author: Thierry Reding <treding@nvidia.com>
Date:   Wed Jul 1 12:46:42 2015 +0200

    platform/chrome: Enable Chrome platforms on 64-bit ARM
    
    With Chrome running on 64-bit ARM devices, add ARM64 to the list of
    supported architectures.
    
    Signed-off-by: Thierry Reding <treding@nvidia.com>
    [olof; Fixed up due to addition of COMPILE_TEST]
    Signed-off-by: Olof Johansson <olof@lixom.net>

commit f70f276a2e910c69d11b038a7df3de9d08f10b8b
Author: Javier Martinez Canillas <javier@osg.samsung.com>
Date:   Wed Aug 19 13:19:54 2015 +0200

    Revert "platform/chrome: Don't make CHROME_PLATFORMS depends on X86 || ARM"
    
    This reverts commit d12bbcd3ea44 ("platform/chrome: Don't make
    CHROME_PLATFORMS depends on X86 || ARM") since it was found to
    not be the correct fix for the MFD_CROS_EC config unmet direct
    dependencies warning.
    
    The correct solution was to add the needed dependencies to the
    MFD_CROS_EC symbol. Besides the revert, this patch extends the
    CHROME_PLATFORMS symbol dependencies and adds || COMPILE_TEST
    to allow drivers to have build coverage on other architectures.
    
    Suggested-by: Geert Uytterhoeven <geert@linux-m68k.org>
    Signed-off-by: Javier Martinez Canillas <javier@osg.samsung.com>
    Signed-off-by: Olof Johansson <olof@lixom.net>

commit d3247a3fc7123f7001829a6ece731cf23e56a829
Author: Michael Scott <michael.scott@linaro.org>
Date:   Mon Oct 5 12:33:04 2015 -0700

    greybus: build: android: fix strip module build step
    
    Currently, the greybus module .ko files are quite large and the
    following error was observed during Android build for each greybus module:
    strip: Unable to recognise the format of the input file `<module>`
    
    Fix the strip build step by replacing the undefined KERNEL_TOOLCHAIN_PATH
    variable with the GREYBUS_CC_PREFIX variable.  Also used as the
    CROSS_COMPILER value for the module make.
    
    Signed-off-by: Michael Scott <michael.scott@linaro.org>
    Signed-off-by: Greg Kroah-Hartman <gregkh@google.com>

commit d5c47ccb0a2cd8761020f7a222bf6b12a4a7b2f0
Author: Paul Mackerras <paulus@ozlabs.org>
Date:   Mon Sep 28 14:38:31 2015 +1000

    powerpc/MSI: Fix race condition in tearing down MSI interrupts
    
    commit e297c939b745e420ef0b9dc989cb87bda617b399 upstream.
    
    This fixes a race which can result in the same virtual IRQ number
    being assigned to two different MSI interrupts.  The most visible
    consequence of that is usually a warning and stack trace from the
    sysfs code about an attempt to create a duplicate entry in sysfs.
    
    The race happens when one CPU (say CPU 0) is disposing of an MSI
    while another CPU (say CPU 1) is setting up an MSI.  CPU 0 calls
    (for example) pnv_teardown_msi_irqs(), which calls
    msi_bitmap_free_hwirqs() to indicate that the MSI (i.e. its
    hardware IRQ number) is no longer in use.  Then, before CPU 0 gets
    to calling irq_dispose_mapping() to free up the virtal IRQ number,
    CPU 1 comes in and calls msi_bitmap_alloc_hwirqs() to allocate an
    MSI, and gets the same hardware IRQ number that CPU 0 just freed.
    CPU 1 then calls irq_create_mapping() to get a virtual IRQ number,
    which sees that there is currently a mapping for that hardware IRQ
    number and returns the corresponding virtual IRQ number (which is
    the same virtual IRQ number that CPU 0 was using).  CPU 0 then
    calls irq_dispose_mapping() and frees that virtual IRQ number.
    Now, if another CPU comes along and calls irq_create_mapping(), it
    is likely to get the virtual IRQ number that was just freed,
    resulting in the same virtual IRQ number apparently being used for
    two different hardware interrupts.
    
    To fix this race, we just move the call to msi_bitmap_free_hwirqs()
    to after the call to irq_dispose_mapping().  Since virq_to_hw()
    doesn't work for the virtual IRQ number after irq_dispose_mapping()
    has been called, we need to call it before irq_dispose_mapping() and
    remember the result for the msi_bitmap_free_hwirqs() call.
    
    The pattern of calling msi_bitmap_free_hwirqs() before
    irq_dispose_mapping() appears in 5 places under arch/powerpc, and
    appears to have originated in commit 05af7bd2d75e ("[POWERPC] MPIC
    U3/U4 MSI backend") from 2007.
    
    Fixes: 05af7bd2d75e ("[POWERPC] MPIC U3/U4 MSI backend")
    Reported-by: Alexey Kardashevskiy <aik@ozlabs.ru>
    Signed-off-by: Paul Mackerras <paulus@samba.org>
    Signed-off-by: Michael Ellerman <mpe@ellerman.id.au>
    Signed-off-by: Paul Mackerras <paulus@samba.org>
    Signed-off-by: Jiri Slaby <jslaby@suse.cz>

commit f7ab093f74bf638ed98fd1115f3efa17e308bb7f
Author: Mike Marshall <hubcap@omnibond.com>
Date:   Fri Jul 17 10:38:11 2015 -0400

    Orangefs: kernel client part 1
    
    OrangeFS (formerly PVFS) is an lgpl licensed userspace networked parallel
    file system. OrangeFS can be accessed through included system utilities,
    user integration libraries, MPI-IO and can be used by the Hadoop
    ecosystem as an alternative to the HDFS filesystem. OrangeFS is used
    widely for parallel science, data analytics and engineering applications.
    
    While applications often don't require Orangefs to be mounted into
    the VFS, users do like to be able to access their files in the normal way.
    The Orangefs kernel client allows Orangefs filesystems to be mounted as
    a VFS. The kernel client communicates with a userspace daemon which in
    turn communicates with the Orangefs server daemons that implement the
    filesystem. The server daemons (there's almost always more than one)
    need not be running on the same host as the kernel client.
    
    Orangefs filesystems can also be mounted with FUSE, and we
    ship code and instructions to facilitate that, but most of our users
    report preferring to use our kernel module instead. Further, as an example
    of a problem we can't solve with fuse, we have in the works a
    not-yet-ready-for-prime-time version of a file_operations lock function
    that accounts for the server daemons being distributed across more
    than one running kernel.
    
    Many people and organizations, including Clemson University,
    Argonne National Laboratories and Acxiom Corporation have
    helped to create what has become Orangefs over more than twenty
    years. Some of the more recent contributors to the kernel client
    include:
    
      Mike Marshall
      Christoph Hellwig
      Randy Martin
      Becky Ligon
      Walt Ligon
      Michael Moore
      Rob Ross
      Phil Carnes
    
    Signed-off-by: Mike Marshall <hubcap@omnibond.com>

commit aaa59e0911f5624663217c248cfa7cc1c2e33e08
Author: Javier Martinez Canillas <javier@osg.samsung.com>
Date:   Fri Oct 2 10:49:48 2015 -0700

    Input: goldfish - allow compile the driver with COMPILE_TEST
    
    The driver depends on GOLDFISH but there isn't a build dependency
    so it's a good idea to allow the driver to be built even if that
    option is disabled, if the COMPILE_TEST option is enabled.
    
    That way, the driver can be built with a config generated by make
    allyesconfig and can be checked if a patch would break the build.
    
    Signed-off-by: Javier Martinez Canillas <javier@osg.samsung.com>
    Signed-off-by: Dmitry Torokhov <dmitry.torokhov@gmail.com>

commit 18a7214f1a92c78c04d83b35bf2c44200410a952
Author: Paul Mackerras <paulus@ozlabs.org>
Date:   Mon Sep 28 14:38:31 2015 +1000

    powerpc/MSI: Fix race condition in tearing down MSI interrupts
    
    commit e297c939b745e420ef0b9dc989cb87bda617b399 upstream.
    
    This fixes a race which can result in the same virtual IRQ number
    being assigned to two different MSI interrupts.  The most visible
    consequence of that is usually a warning and stack trace from the
    sysfs code about an attempt to create a duplicate entry in sysfs.
    
    The race happens when one CPU (say CPU 0) is disposing of an MSI
    while another CPU (say CPU 1) is setting up an MSI.  CPU 0 calls
    (for example) pnv_teardown_msi_irqs(), which calls
    msi_bitmap_free_hwirqs() to indicate that the MSI (i.e. its
    hardware IRQ number) is no longer in use.  Then, before CPU 0 gets
    to calling irq_dispose_mapping() to free up the virtal IRQ number,
    CPU 1 comes in and calls msi_bitmap_alloc_hwirqs() to allocate an
    MSI, and gets the same hardware IRQ number that CPU 0 just freed.
    CPU 1 then calls irq_create_mapping() to get a virtual IRQ number,
    which sees that there is currently a mapping for that hardware IRQ
    number and returns the corresponding virtual IRQ number (which is
    the same virtual IRQ number that CPU 0 was using).  CPU 0 then
    calls irq_dispose_mapping() and frees that virtual IRQ number.
    Now, if another CPU comes along and calls irq_create_mapping(), it
    is likely to get the virtual IRQ number that was just freed,
    resulting in the same virtual IRQ number apparently being used for
    two different hardware interrupts.
    
    To fix this race, we just move the call to msi_bitmap_free_hwirqs()
    to after the call to irq_dispose_mapping().  Since virq_to_hw()
    doesn't work for the virtual IRQ number after irq_dispose_mapping()
    has been called, we need to call it before irq_dispose_mapping() and
    remember the result for the msi_bitmap_free_hwirqs() call.
    
    The pattern of calling msi_bitmap_free_hwirqs() before
    irq_dispose_mapping() appears in 5 places under arch/powerpc, and
    appears to have originated in commit 05af7bd2d75e ("[POWERPC] MPIC
    U3/U4 MSI backend") from 2007.
    
    Fixes: 05af7bd2d75e ("[POWERPC] MPIC U3/U4 MSI backend")
    Reported-by: Alexey Kardashevskiy <aik@ozlabs.ru>
    Signed-off-by: Paul Mackerras <paulus@samba.org>
    Signed-off-by: Michael Ellerman <mpe@ellerman.id.au>
    Signed-off-by: Paul Mackerras <paulus@samba.org>
    Signed-off-by: Luis Henriques <luis.henriques@canonical.com>

commit 080481f97f425f89440386d02201c1d014f9e0dc
Author: Maxime Ripard <maxime.ripard@free-electrons.com>
Date:   Fri Sep 25 18:09:34 2015 +0200

    irqchip: armada-370-xp: Rework per-cpu interrupts handling
    
    The MPIC driver currently has a list of interrupts to handle as per-cpu.
    
    Since the timer, fabric and neta interrupts were the only per-cpu
    interrupts in the system, we can now remove the switch and just check for
    the hardware irq number to determine whether a given interrupt is per-cpu
    or not.
    
    Signed-off-by: Maxime Ripard <maxime.ripard@free-electrons.com>
    Acked-by: Gregory CLEMENT <gregory.clement@free-electrons.com>
    Signed-off-by: Gregory CLEMENT <gregory.clement@free-electrons.com>
    Signed-off-by: David S. Miller <davem@davemloft.net>

commit b626ef0128d254d33ee43c51d68f577bbec370ac
Merge: 17a10c9215b3 9861f72074c7
Author: David S. Miller <davem@davemloft.net>
Date:   Thu Sep 24 23:04:53 2015 -0700

    Merge branch 'phy-mdio-refcnt'
    
    Russell King says:
    
    ====================
    Phy, mdiobus, and netdev struct device fixes
    
    The third version of this series fixes the build error which David
    identified, and drops the broken changes for the Cavium Thunger BGX
    ethernet driver as this driver requires some complex changes to
    resolve the leakage - and this is best done by people who can test
    the driver.
    
    Compared to v2, the only patch which has changed is patch 6
      "net: fix phy refcounting in a bunch of drivers"
    
    I _think_ I've been able to build-test all the drivers touched by
    that patch to some degree now, though several of them needed the
    Kconfig hacked to allow it (not all had || COMPILE_TEST clause on
    their dependencies.)
    
    Previous cover letters below:
    
    This is the second version of the series, with the comments David had
    on the first patch fixed up.  Original series description with updated
    diffstat below.
    
    While looking at the DSA code, I noticed we have a
    of_find_net_device_by_node(), and it looks like users of that are
    similarly buggy - it looks like net/dsa/dsa.c is the only user.  Fix
    that too.
    
    Hi,
    
    While looking at the phy code, I identified a number of weaknesses
    where refcounting on device structures was being leaked, where
    modules could be removed while in-use, and where the fixed-phy could
    end up having unintended consequences caused by incorrect calls to
    fixed_phy_update_state().
    
    This patch series resolves those issues, some of which were discovered
    with testing on an Armada 388 board.  Not all patches are fully tested,
    particularly the one which touches several network drivers.
    
    When resolving the struct device refcounting problems, several different
    solutions were considered before settling on the implementation here -
    one of the considerations was to avoid touching many network drivers.
    The solution here is:
    
            phy_attach*() - takes a refcount
            phy_detach*() - drops the phy_attach refcount
    
    Provided drivers always attach and detach their phys, which they should
    already be doing, this should change nothing, even if they leak a refcount.
    
            of_phy_find_device() and of_* functions which use that take
            a refcount.  Arrange for this refcount to be dropped once
            the phy is attached.
    
    This is the reason why the previous change is important - we can't drop
    this refcount taken by of_phy_find_device() until something else holds
    a reference on the device.  This resolves the leaked refcount caused by
    using of_phy_connect() or of_phy_attach().
    
    Even without the above changes, these drivers are leaking by calling
    of_phy_find_device().  These drivers are addressed by adding the
    appropriate release of that refcount.
    
    The mdiobus code also suffered from the same kind of leak, but thankfully
    this only happened in one place - the mdio-mux code.
    
    I also found that the try_module_get() in the phy layer code was utterly
    useless: phydev->dev.driver was guaranteed to always be NULL, so
    try_module_get() was always being called with a NULL argument.  I proved
    this with my SFP code, which declares its own MDIO bus - the module use
    count was never incremented irrespective of how I set the MDIO bus up.
    This allowed the MDIO bus code to be removed from the kernel while there
    were still PHYs attached to it.
    
    One other bug was discovered: while using in-band-status with mvneta, it
    was found that if a real phy is attached with in-band-status enabled,
    and another ethernet interface is using the fixed-phy infrastructure, the
    interface using the fixed-phy infrastructure is configured according to
    the other interface using the in-band-status - which is caused by the
    fixed-phy code not verifying that the phy_device passed in is actually
    a fixed-phy device, rather than a real MDIO phy.
    
    Lastly, having mdio_bus reversing phy_device_register() internals seems
    like a layering violation - it's trivial to move that code to the phy
    device layer.
    ====================
    
    Tested-by: Florian Fainelli <f.fainelli@gmail.com>
    Reviewed-by: Florian Fainelli <f.fainelli@gmail.com>
    Signed-off-by: David S. Miller <davem@davemloft.net>

commit ffcb6d1686ceb4a6b50776fb2597ab0e4dd79040
Author: Robin Murphy <Robin.Murphy@arm.com>
Date:   Thu Sep 17 17:42:16 2015 +0100

    iommu/io-pgtable-arm: Don't use dma_to_phys()
    
    In checking whether DMA addresses differ from physical addresses, using
    dma_to_phys() is actually the wrong thing to do, since it may hide any
    DMA offset, which is precisely one of the things we are checking for.
    Simply casting between the two address types, whilst ugly, is in fact
    the appropriate course of action. Further care (and ugliness) is also
    necessary in the comparison to avoid truncation if phys_addr_t and
    dma_addr_t differ in size.
    
    We can also reject any device with a fixed DMA offset up-front at page
    table creation, leaving the allocation-time check for the more subtle
    cases like bounce buffering due to an incorrect DMA mask.
    
    Furthermore, we can then fix the hackish KConfig dependency so that
    architectures without a dma_to_phys() implementation may still
    COMPILE_TEST (or even use!) the code. The true dependency is on the
    DMA API, so use the appropriate symbol for that.
    
    Signed-off-by: Robin Murphy <robin.murphy@arm.com>
    [will: folded in selftest fix from Yong Wu]
    Signed-off-by: Will Deacon <will.deacon@arm.com>

commit 41ae3c02743e8f1f21ceebca614342d26b4eb080
Author: Eduardo Valentin <edubezval@gmail.com>
Date:   Wed Sep 9 20:58:36 2015 -0700

    thermal: ti-soc: allow compile test
    
    Adding COMPILE_TEST flag to ti-soc driver to facilitate
    maintenance.
    
    Cc: Zhang Rui <rui.zhang@intel.com>
    Cc: linux-pm@vger.kernel.org
    Cc: linux-omap@vger.kernel.org
    Cc: linux-kernel@vger.kernel.org
    Signed-off-by: Eduardo Valentin <edubezval@gmail.com>

commit cb7fb4d342023d03070fcc1ed73fcd43682973d7
Author: Eduardo Valentin <edubezval@gmail.com>
Date:   Wed Sep 9 20:56:26 2015 -0700

    thermal: qcom_spmi: allow compile test
    
    Adding COMPILE_TEST flag to qcom_spmi driver to facilitate
    maintenance.
    
    Cc: Zhang Rui <rui.zhang@intel.com>
    Cc: linux-pm@vger.kernel.org
    Cc: linux-kernel@vger.kernel.org
    Signed-off-by: Eduardo Valentin <edubezval@gmail.com>

commit 2bf427353eb606481d15d2843c76cdffa29ed418
Author: Eduardo Valentin <edubezval@gmail.com>
Date:   Wed Sep 9 20:53:35 2015 -0700

    thermal: exynos: allow compile test
    
    Adding COMPILE_TEST flag to exynos driver to facilitate
    maintenance.
    
    Cc: Lukasz Majewski <l.majewski@samsung.com>
    Cc: Zhang Rui <rui.zhang@intel.com>
    Cc: linux-pm@vger.kernel.org
    Cc: linux-samsung-soc@vger.kernel.org
    Cc: linux-kernel@vger.kernel.org
    Signed-off-by: Eduardo Valentin <edubezval@gmail.com>

commit 1b1582672121e1c1138e68b64128d94e7f61d10c
Author: Eduardo Valentin <edubezval@gmail.com>
Date:   Wed Sep 9 20:48:00 2015 -0700

    thermal: armada: allow compile test
    
    Adding COMPILE_TEST flag to armada driver to facilitate
    maintenance.
    
    Cc: Zhang Rui <rui.zhang@intel.com>
    Cc: linux-pm@vger.kernel.org
    Cc: linux-kernel@vger.kernel.org
    Signed-off-by: Eduardo Valentin <edubezval@gmail.com>

commit 07fffd5ccab70bc00fd69b9ce2297a5e8d05b838
Author: Eduardo Valentin <edubezval@gmail.com>
Date:   Wed Sep 9 20:45:25 2015 -0700

    thermal: dove: allow compile test
    
    Adding COMPILE_TEST flag to dove driver to facilitate
    maintenance.
    
    Cc: Zhang Rui <rui.zhang@intel.com>
    Cc: linux-pm@vger.kernel.org
    Cc: linux-kernel@vger.kernel.org
    Signed-off-by: Eduardo Valentin <edubezval@gmail.com>

commit 9c8aa959e13f5cb082ad244d2c9b806a67d9a8b6
Author: Eduardo Valentin <edubezval@gmail.com>
Date:   Wed Sep 9 20:44:46 2015 -0700

    thermal: kirkwood: allow compile test
    
    Adding COMPILE_TEST flag to kirkwood driver to facilitate
    maintenance.
    
    Cc: Zhang Rui <rui.zhang@intel.com>
    Cc: linux-pm@vger.kernel.org
    Cc: linux-kernel@vger.kernel.org
    Signed-off-by: Eduardo Valentin <edubezval@gmail.com>

commit 444f9b00073668f028db0c14f609cf08abc9a2b3
Author: Eduardo Valentin <edubezval@gmail.com>
Date:   Wed Sep 9 20:43:57 2015 -0700

    thermal: rockchip: allow compile test
    
    Adding COMPILE_TEST flag to rockchip driver to facilitate
    maintenance.
    
    Cc: Zhang Rui <rui.zhang@intel.com>
    Cc: Heiko Stuebner <heiko@sntech.de>
    Cc: linux-pm@vger.kernel.org
    Cc: linux-arm-kernel@lists.infradead.org
    Cc: linux-rockchip@lists.infradead.org
    Cc: linux-kernel@vger.kernel.org
    Signed-off-by: Eduardo Valentin <edubezval@gmail.com>

commit aa2937b73a45e49704b24db8d9163d83002332d9
Author: Eduardo Valentin <edubezval@gmail.com>
Date:   Wed Sep 9 20:42:01 2015 -0700

    thermal: spear: allow compile test
    
    Adding COMPILE_TEST flag to spear driver to facilitate
    maintenance.
    
    Cc: Zhang Rui <rui.zhang@intel.com>
    Cc: linux-pm@vger.kernel.org
    Cc: linux-kernel@vger.kernel.org
    Acked-by: Viresh Kumar <viresh.kumar@linaro.org>
    Signed-off-by: Eduardo Valentin <edubezval@gmail.com>

commit f9e2b05218e64fc6c614b90a650863981701f974
Author: Eduardo Valentin <edubezval@gmail.com>
Date:   Wed Sep 9 20:39:44 2015 -0700

    thermal: hisi: allow compile test
    
    Adding COMPILE_TEST flag to hisi driver to facilitate maintenance.
    
    Cc: Zhang Rui <rui.zhang@intel.com>
    Cc: linux-pm@vger.kernel.org
    Cc: linux-kernel@vger.kernel.org
    Signed-off-by: Eduardo Valentin <edubezval@gmail.com>

commit 5211aabc75f8173cc0d9b0c990737756eae7f6c6
Author: Nathan Lynch <nathan_lynch@mentor.com>
Date:   Wed Jun 3 00:41:15 2015 +0100

    ARM: 8384/1: VDSO: force use of BFD linker
    
    commit d2b30cd4b7223a96e606dfc8120626f66d81e091 upstream.
    
    When using a toolchain with gold as the default linker, the VDSO build
    fails:
    
      VDSO    arch/arm/vdso/vdso.so.raw
      HOSTCC  arch/arm/vdso/vdsomunge
      MUNGE   arch/arm/vdso/vdso.so.dbg
      OBJCOPY arch/arm/vdso/vdso.so
    BFD: arch/arm/vdso/vdso.so: Not enough room for program headers, try
    linking with -N
    
    For whatever reason, ld.gold is omitting an exidx program header that
    ld.bfd emits, and even when I work around that, I don't get a working
    VDSO.
    
    For now, instead of supporting gold (which will fail to link the
    kernel anyway since it does not implement --pic-veneer), direct the
    compiler to use the traditional bfd linker.  This is accomplished by
    using -fuse-ld, which is implemented in GCC 4.8 and later.
    
    Note: one limitation of this is that if the toolchain is configured
    to use gold by default, and the bfd linker is not in $PATH, the VDSO
    build will fail:
    
      VDSO    arch/arm/vdso/vdso.so.raw
    collect2: fatal error: cannot find 'ld'
    
    This will happen if CROSS_COMPILE begins with a path such as
    /opt/bin/arm-linux-gnu- but /opt/bin is not in $PATH.  This is
    considered an acceptable corner-case limitation and is easily worked
    around.
    
    Additonal note: we use cc-option instead of cc-ldoption so that
    -fuse-ld=bfd is placed in the command line if the compiler recognizes
    the option.  Using cc-ldoption results in an attempt to link, which
    fails in the situation just described, causing -fuse-ld=bfd to be
    omitted and gold to be used for the VDSO link, which is what we're
    trying to prevent.
    
    Reported-by: Stefan Agner <stefan@agner.ch>
    Signed-off-by: Nathan Lynch <nathan_lynch@mentor.com>
    Signed-off-by: Russell King <rmk+kernel@arm.linux.org.uk>
    Cc: Alexander Kochetkov <al.kochet@gmail.com>
    Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>

commit e297c939b745e420ef0b9dc989cb87bda617b399
Author: Paul Mackerras <paulus@ozlabs.org>
Date:   Thu Sep 10 14:36:21 2015 +1000

    powerpc/MSI: Fix race condition in tearing down MSI interrupts
    
    This fixes a race which can result in the same virtual IRQ number
    being assigned to two different MSI interrupts.  The most visible
    consequence of that is usually a warning and stack trace from the
    sysfs code about an attempt to create a duplicate entry in sysfs.
    
    The race happens when one CPU (say CPU 0) is disposing of an MSI
    while another CPU (say CPU 1) is setting up an MSI.  CPU 0 calls
    (for example) pnv_teardown_msi_irqs(), which calls
    msi_bitmap_free_hwirqs() to indicate that the MSI (i.e. its
    hardware IRQ number) is no longer in use.  Then, before CPU 0 gets
    to calling irq_dispose_mapping() to free up the virtal IRQ number,
    CPU 1 comes in and calls msi_bitmap_alloc_hwirqs() to allocate an
    MSI, and gets the same hardware IRQ number that CPU 0 just freed.
    CPU 1 then calls irq_create_mapping() to get a virtual IRQ number,
    which sees that there is currently a mapping for that hardware IRQ
    number and returns the corresponding virtual IRQ number (which is
    the same virtual IRQ number that CPU 0 was using).  CPU 0 then
    calls irq_dispose_mapping() and frees that virtual IRQ number.
    Now, if another CPU comes along and calls irq_create_mapping(), it
    is likely to get the virtual IRQ number that was just freed,
    resulting in the same virtual IRQ number apparently being used for
    two different hardware interrupts.
    
    To fix this race, we just move the call to msi_bitmap_free_hwirqs()
    to after the call to irq_dispose_mapping().  Since virq_to_hw()
    doesn't work for the virtual IRQ number after irq_dispose_mapping()
    has been called, we need to call it before irq_dispose_mapping() and
    remember the result for the msi_bitmap_free_hwirqs() call.
    
    The pattern of calling msi_bitmap_free_hwirqs() before
    irq_dispose_mapping() appears in 5 places under arch/powerpc, and
    appears to have originated in commit 05af7bd2d75e ("[POWERPC] MPIC
    U3/U4 MSI backend") from 2007.
    
    Fixes: 05af7bd2d75e ("[POWERPC] MPIC U3/U4 MSI backend")
    Cc: stable@vger.kernel.org # v2.6.22+
    Reported-by: Alexey Kardashevskiy <aik@ozlabs.ru>
    Signed-off-by: Paul Mackerras <paulus@samba.org>
    Signed-off-by: Michael Ellerman <mpe@ellerman.id.au>

commit 9738031561d246f625325badb03a1f1eca2d1b01
Merge: 5d44595c2627 f319cb8491e1
Author: Kevin Hilman <khilman@linaro.org>
Date:   Wed Sep 9 15:41:42 2015 -0700

    Merge tag 'reset-for-4.3-fixes' of git://git.pengutronix.de/git/pza/linux into drivers/reset
    
    Merge "Reset controller fixes for v4.3" from Philipp Zabel:
    
    Reset controller fixes for v4.3
    
    - added stubs to avoid build breakage in COMPILE_TEST
      configurations with RESET_CONTROLLER disabled
    - fixed missing spinlock initialization in ath79 driver
    
    * tag 'reset-for-4.3-fixes' of git://git.pengutronix.de/git/pza/linux:
      reset: ath79: Fix missing spin_lock_init
      reset: Add (devm_)reset_control_get stub functions

commit 352712274507645b6f82b8763977ad87321919a3
Merge: 88a99886c26f ab98193dace9
Author: Linus Torvalds <torvalds@linux-foundation.org>
Date:   Fri Sep 4 11:10:18 2015 -0700

    Merge tag 'dmaengine-4.3-rc1' of git://git.infradead.org/users/vkoul/slave-dma
    
    Pull dmaengine updates from Vinod Koul:
     "This time we have aded a new capability for scatter-gathered memset
      using dmaengine APIs.  This is supported in xdmac & hdmac drivers
    
      We have added support for reusing descriptors for examples like video
      buffers etc.  Driver will follow
    
      The behaviour of descriptor ack has been clarified and documented
    
      New devices added are:
       - dma controller in sun[457]i SoCs
       - lpc18xx dmamux
       - ZTE ZX296702 dma controller
       - Analog Devices AXI-DMAC DMA controller
       - eDMA support for dma-crossbar
       - imx6sx support in imx-sdma driver
       - imx-sdma device to device support
    
      Other:
       - jz4780 fixes
       - ioatdma large refactor and cleanup for removal of ioat v1 and v2
         which is deprecated and fixes
       - ACPI support in X-Gene DMA engine driver
       - ipu irq fixes
       - mvxor fixes
       - minor fixes spread thru drivers"
    
    [ The Kconfig and Makefile entries got re-sorted alphabetically, and I
      handled the conflict with the new Intel integrated IDMA driver by
      slightly mis-sorting it on purpose: "IDMA64" got sorted after "IMX" in
      order to keep the Intel entries together.  I think it might be a good
      idea to just rename the IDMA64 config entry to INTEL_IDMA64 to make
      the sorting be a true sort, not this mismash.
    
      Also, this merge disables the COMPILE_TEST for the sun4i DMA
      controller, because it does not compile cleanly at all.     - Linus ]
    
    * tag 'dmaengine-4.3-rc1' of git://git.infradead.org/users/vkoul/slave-dma: (89 commits)
      dmaengine: ioatdma: add Broadwell EP ioatdma PCI dev IDs
      dmaengine :ipu: change ipu_irq_handler() to remove compile warning
      dmaengine: ioatdma: Fix variable array length
      dmaengine: ioatdma: fix sparse "error" with prep lock
      dmaengine: hdmac: Add memset capabilities
      dmaengine: sort the sh Makefile
      dmaengine: sort the sh Kconfig
      dmaengine: sort the dw Kconfig
      dmaengine: sort the Kconfig
      dmaengine: sort the makefile
      drivers/dma: make mv_xor.c driver explicitly non-modular
      dmaengine: Add support for the Analog Devices AXI-DMAC DMA controller
      devicetree: Add bindings documentation for Analog Devices AXI-DMAC
      dmaengine: xgene-dma: Fix the lock to allow client for further submission of requests
      dmaengine: ioatdma: fix coccinelle warning
      dmaengine: ioatdma: fix zero day warning on incompatible pointer type
      dmaengine: tegra-apb: Simplify locking for device using global pause
      dmaengine: tegra-apb: Remove unnecessary return statements and variables
      dmaengine: tegra-apb: Avoid unnecessary channel base address calculation
      dmaengine: tegra-apb: Remove unused variables
      ...

commit df910390e2db07a76c87f258475f6c96253cee6c
Merge: 91a247d7d369 9f55bca2b82a
Author: Linus Torvalds <torvalds@linux-foundation.org>
Date:   Wed Sep 2 12:22:54 2015 -0700

    Merge tag 'scsi-misc' of git://git.kernel.org/pub/scm/linux/kernel/git/jejb/scsi
    
    Pull first round of SCSI updates from James Bottomley:
     "This includes one new driver: cxlflash plus the usual grab bag of
      updates for the major drivers: qla2xxx, ipr, storvsc, pm80xx, hptiop,
      plus a few assorted fixes.
    
      There's another tranch coming, but I want to incubate it another few
      days in the checkers, plus it includes a mpt2sas separated lifetime
      fix, which Avago won't get done testing until Friday"
    
    * tag 'scsi-misc' of git://git.kernel.org/pub/scm/linux/kernel/git/jejb/scsi: (85 commits)
      aic94xx: set an error code on failure
      storvsc: Set the error code correctly in failure conditions
      storvsc: Allow write_same when host is windows 10
      storvsc: use storage protocol version to determine storage capabilities
      storvsc: use correct defaults for values determined by protocol negotiation
      storvsc: Untangle the storage protocol negotiation from the vmbus protocol negotiation.
      storvsc: Use a single value to track protocol versions
      storvsc: Rather than look for sets of specific protocol versions, make decisions based on ranges.
      cxlflash: Remove unused variable from queuecommand
      cxlflash: shift wrapping bug in afu_link_reset()
      cxlflash: off by one bug in cxlflash_show_port_status()
      cxlflash: Virtual LUN support
      cxlflash: Superpipe support
      cxlflash: Base error recovery support
      qla2xxx: Update driver version to 8.07.00.26-k
      qla2xxx: Add pci device id 0x2261.
      qla2xxx: Fix missing device login retries.
      qla2xxx: do not clear slot in outstanding cmd array
      qla2xxx: Remove decrement of sp reference count in abort handler.
      qla2xxx: Add support to show MPI and PEP FW version for ISP27xx.
      ...

commit d4c90396ed7ef9b4e4d221e008e54be8bea8307f
Merge: f36fc04e4cdd bf433416e675
Author: Linus Torvalds <torvalds@linux-foundation.org>
Date:   Mon Aug 31 17:38:39 2015 -0700

    Merge git://git.kernel.org/pub/scm/linux/kernel/git/herbert/crypto-2.6
    
    Pull crypto updates from Herbert Xu:
     "Here is the crypto update for 4.3:
    
      API:
    
       - the AEAD interface transition is now complete.
       - add top-level skcipher interface.
    
      Drivers:
    
       - x86-64 acceleration for chacha20/poly1305.
       - add sunxi-ss Allwinner Security System crypto accelerator.
       - add RSA algorithm to qat driver.
       - add SRIOV support to qat driver.
       - add LS1021A support to caam.
       - add i.MX6 support to caam"
    
    * git://git.kernel.org/pub/scm/linux/kernel/git/herbert/crypto-2.6: (163 commits)
      crypto: algif_aead - fix for multiple operations on AF_ALG sockets
      crypto: qat - enable legacy VFs
      MPI: Fix mpi_read_buffer
      crypto: qat - silence a static checker warning
      crypto: vmx - Fixing opcode issue
      crypto: caam - Use the preferred style for memory allocations
      crypto: caam - Propagate the real error code in caam_probe
      crypto: caam - Fix the error handling in caam_probe
      crypto: caam - fix writing to JQCR_MS when using service interface
      crypto: hash - Add AHASH_REQUEST_ON_STACK
      crypto: testmgr - Use new skcipher interface
      crypto: skcipher - Add top-level skcipher interface
      crypto: cmac - allow usage in FIPS mode
      crypto: sahara - Use dmam_alloc_coherent
      crypto: caam - Add support for LS1021A
      crypto: qat - Don't move data inside output buffer
      crypto: vmx - Fixing GHASH Key issue on little endian
      crypto: vmx - Fixing AES-CTR counter bug
      crypto: null - Add missing Kconfig tristate for NULL2
      crypto: nx - Add forward declaration for struct crypto_aead
      ...

commit 6e3956cd532d8c263e68ebae1252828e297aac4d
Author: Geert Uytterhoeven <geert@linux-m68k.org>
Date:   Mon Jul 6 15:42:34 2015 +0200

    leds: Allow compile test of LEDS_AAT1290 and LEDS_KTD2692 if !GPIOLIB
    
    The GPIO subsystem provides dummy GPIO consumer functions if GPIOLIB is
    not enabled. Hence drivers that depend on GPIOLIB, but use GPIO consumer
    functionality only, can still be compiled if GPIOLIB is not enabled.
    
    If COMPILE_TEST is enabled, relax the dependency on GPIOLIB for the
    recently introduced symbols LEDS_AAT1290 and LEDS_KTD2692.
    
    Signed-off-by: Geert Uytterhoeven <geert@linux-m68k.org>
    Signed-off-by: Jacek Anaszewski <j.anaszewski@samsung.com>

commit 823227419588001f2d4accf3c5660cd99442a0f8
Author: Geert Uytterhoeven <geert@linux-m68k.org>
Date:   Tue May 5 18:32:25 2015 +0200

    leds: Allow compile test of GPIO consumers if !GPIOLIB
    
    The GPIO subsystem provides dummy GPIO consumer functions if GPIOLIB is
    not enabled. Hence drivers that depend on GPIOLIB, but use GPIO consumer
    functionality only, can still be compiled if GPIOLIB is not enabled.
    
    Relax the dependency on GPIOLIB if COMPILE_TEST is enabled, where
    appropriate.
    
    Signed-off-by: Geert Uytterhoeven <geert@linux-m68k.org>
    Cc: Richard Purdie <rpurdie@rpsys.net>
    Cc: linux-leds@vger.kernel.org
    Signed-off-by: Jacek Anaszewski <j.anaszewski@samsung.com>

commit a6f84009b9d7ca97c400ca929f9d58f43b0ece9d
Author: Sreekanth Reddy <sreekanth.reddy@avagotech.com>
Date:   Tue Jun 30 12:24:59 2015 +0530

    mpt3sas: MPI 2.5 Rev K (2.5.6) specifications
    
    Below are the new changes to MPI 2.5 Rev K(2.5.6) specification and 2.00.35
    header files
    
    1) Added a minimum size requirement for target mode command buffers.
    
    2) Added MinMSIxIndex and MaxMSIxIndex fields to CommandBufferPostBase
       Request.
    
    3) For BIOS Page 1, added SSUTimeout field, and added Product Name String
       Format bits to the BiosOptions field
    
    Signed-off-by: Sreekanth Reddy <Sreekanth.Reddy@avagotech.com>
    Reviewed-by: Martin K. Petersen <martin.petersen@oracle.com>
    Reviewed-by: Johannes Thumshirn <jthumshirn@suse.de>
    Signed-off-by: James Bottomley <JBottomley@Odin.com>

commit 35c319b47884e49d9d0a84779097916ccb173947
Author: Sreekanth Reddy <sreekanth.reddy@avagotech.com>
Date:   Tue Jun 30 12:24:55 2015 +0530

    mpt3sas: MPI 2.5 Rev J (2.5.5) specification and 2.00.34 header files
    
    Following is the change set,
    
    1. Added more defines for the BiosOptions field of MPI2_CONFIG_PAGE_BIOS_1.
    
    2. Added MPI2_TOOLBOX_CLEAN_BIT26_PRODUCT_SPECIFIC definition.
    
    Signed-off-by: Sreekanth Reddy <Sreekanth.Reddy@avagotech.com>
    Reviewed-by: Martin K. Petersen <martin.petersen@oracle.com>
    Reviewed-by: Johannes Thumshirn <jthumshirn@suse.de>
    Signed-off-by: James Bottomley <JBottomley@Odin.com>

commit 2e26c3853206ba166c3434e5f2ca4c82078ad84e
Author: Sreekanth Reddy <sreekanth.reddy@avagotech.com>
Date:   Tue Jun 30 12:24:54 2015 +0530

    mpt3sas: Update MPI2 strings to MPI2.5
    
    Signed-off-by: Sreekanth Reddy <Sreekanth.Reddy@avagotech.com>
    Reviewed-by: Martin K. Petersen <martin.petersen@oracle.com>
    Reviewed-by: Johannes Thumshirn <jthumshirn@suse.de>
    Signed-off-by: James Bottomley <JBottomley@Odin.com>

commit a94bea343c2f747c62ef66b52d2430e6aeb75434
Author: Sreekanth Reddy <sreekanth.reddy@avagotech.com>
Date:   Tue Jun 30 12:24:51 2015 +0530

    mpt3sas: MPI 2.5 Rev I (2.5.4) specifications.
    
    Update MPI 2.5 Release: MPI 2.5 Rev I (2.5.4) specification and 2.00.33 header
    files
    
    Below is the change set from the MPI specification for I Rev
    
    1) Added Base Enclosure Level bit to the Flags field of Manufacturing Page 7.
    
    2) Updated description of the MaxTargetPortConnectTime field of SAS IO Unit
       Page 1.
    
    3) Added EnclosureLevel and ConnectorName fields to SAS Device Page 0. Also,
       added EnclosureLevel and ConnectorName Valid bit to the Flags field.
    
    4) Added EnclosureLevel field to SAS Enclosure Page 0. Also, added
       EnclosureLevel Valid bit to the Flags field.
    
    5) Added value for BIOS image to HashImageType.
    
    Signed-off-by: Sreekanth Reddy <Sreekanth.Reddy@avagotech.com>
    Reviewed-by: Martin K. Petersen <martin.petersen@oracle.com>
    Reviewed-by: Johannes Thumshirn <jthumshirn@suse.de>
    Signed-off-by: James Bottomley <JBottomley@Odin.com>

commit 03aa868c1b7b2633a4faa97b28c40e64c91a8e7f
Author: Sawan Chandak <sawan.chandak@qlogic.com>
Date:   Tue Aug 4 13:37:59 2015 -0400

    qla2xxx: Add support to show MPI and PEP FW version for ISP27xx.
    
    Signed-off-by: Sawan Chandak <sawan.chandak@qlogic.com>
    Signed-off-by: Himanshu Madhani <himanshu.madhani@qlogic.com>
    Signed-off-by: James Bottomley <JBottomley@Odin.com>

commit 0f74fbf77d457c692e108c91475bb7a46aa6d60c
Author: Tadeusz Struk <tadeusz.struk@intel.com>
Date:   Mon Aug 24 07:52:14 2015 -0700

    MPI: Fix mpi_read_buffer
    
    Change mpi_read_buffer to return a number without leading zeros
    so that mpi_read_buffer and mpi_get_buffer return the same thing.
    
    Signed-off-by: Tadeusz Struk <tadeusz.struk@intel.com>
    Signed-off-by: Herbert Xu <herbert@gondor.apana.org.au>

commit b9124a523017a53cce071451f5c38a0b77761534
Author: Javier Martinez Canillas <javier@osg.samsung.com>
Date:   Wed Aug 19 13:19:53 2015 +0200

    mfd: Add MFD_CROS_EC dependencies
    
    The MFD_CROS_EC symbol select CHROME_PLATFORMS and CROS_EC_PROTO but
    that caused a Kconfig unmet direct dependencies warning since these
    symbols could only be selected for X86 || ARM.
    
    The fix it, the CHROME_PLATFORMS dependencies were relexed on commit
    d12bbcd3ea44 ("platform/chrome: Don't make CHROME_PLATFORMS depends
    on X86 || ARM") but that was found to be wrong and the correct fix
    is to add the needed dependencies to the MFD_CROS_EC config symbol.
    
    There are only x86 and ARM based Chromebooks so to avoid showing up
    the config option on unsupported platforms, make the symbol depend on
    these architectures. Also add a || COMPILE_TEST so it can have build
    coverage on other platforms.
    
    Suggested-by: Geert Uytterhoeven <geert@linux-m68k.org>
    Signed-off-by: Javier Martinez Canillas <javier@osg.samsung.com>
    Signed-off-by: Lee Jones <lee.jones@linaro.org>

commit 71540cfbe9d401f4848abc0e6b56a541307a47dd
Author: Geert Uytterhoeven <geert@linux-m68k.org>
Date:   Sun Aug 2 11:09:53 2015 +0200

    fbdev: Allow compile test of GPIO consumers if !GPIOLIB
    
    The GPIO subsystem provides dummy GPIO consumer functions if GPIOLIB is
    not enabled. Hence drivers that depend on GPIOLIB, but use GPIO consumer
    functionality only, can still be compiled if GPIOLIB is not enabled.
    
    Relax the dependency on GPIOLIB if COMPILE_TEST is enabled, where
    appropriate.
    
    Signed-off-by: Geert Uytterhoeven <geert@linux-m68k.org>
    Acked-by: Linus Walleij <linus.walleij@linaro.org>
    Signed-off-by: Tomi Valkeinen <tomi.valkeinen@ti.com>

commit 3939f3345050b1ace675675c47d99fd7b606d9e3
Author: Masahiro Yamada <yamada.masahiro@socionext.com>
Date:   Mon Aug 17 04:03:33 2015 +0100

    ARM: 8418/1: add boot image dependencies to not generate invalid images
    
    U-Boot is often used to boot the kernel on ARM boards, but uImage
    is not built by "make all", so we are often inclined to do
    "make all uImage" to generate DTBs, modules and uImage in a single
    command, but we should notice a pitfall behind it.  In fact,
    "make all uImage" could generate an invalid uImage if it is run with
    the parallel option (-j).
    
    You can reproduce this problem with the following procedure:
    
    [1] First, build "all" and "uImage" separately.
        You will get a valid uImage
    
      $ git clean -f -x -d
      $ export CROSS_COMPILE=<your-tools-prefix>
      $ make -s -j8 ARCH=arm multi_v7_defconfig
      $ make -s -j8 ARCH=arm all
      $ make -j8 ARCH=arm UIMAGE_LOADADDR=0x80208000 uImage
        CHK     include/config/kernel.release
        CHK     include/generated/uapi/linux/version.h
        CHK     include/generated/utsrelease.h
      make[1]: `include/generated/mach-types.h' is up to date.
        CHK     include/generated/timeconst.h
        CHK     include/generated/bounds.h
        CHK     include/generated/asm-offsets.h
        CALL    scripts/checksyscalls.sh
        CHK     include/generated/compile.h
        Kernel: arch/arm/boot/Image is ready
        Kernel: arch/arm/boot/zImage is ready
        UIMAGE  arch/arm/boot/uImage
      Image Name:   Linux-4.2.0-rc5-00156-gdd2384a-d
      Created:      Sat Aug  8 23:21:35 2015
      Image Type:   ARM Linux Kernel Image (uncompressed)
      Data Size:    6138648 Bytes = 5994.77 kB = 5.85 MB
      Load Address: 80208000
      Entry Point:  80208000
        Image arch/arm/boot/uImage is ready
      $ ls -l arch/arm/boot/*Image
      -rwxrwxr-x 1 masahiro masahiro 13766656 Aug  8 23:20 arch/arm/boot/Image
      -rw-rw-r-- 1 masahiro masahiro  6138712 Aug  8 23:21 arch/arm/boot/uImage
      -rwxrwxr-x 1 masahiro masahiro  6138648 Aug  8 23:20 arch/arm/boot/zImage
    
    [2] Update some source file(s)
    
      $ touch init/main.c
    
    [3] Then, re-build "all" and "uImage" simultaneously.
        You will get an invalid uImage at random.
    
      $ make -j8 ARCH=arm UIMAGE_LOADADDR=0x80208000 all uImage
        CHK     include/config/kernel.release
        CHK     include/generated/uapi/linux/version.h
        CHK     include/generated/utsrelease.h
      make[1]: `include/generated/mach-types.h' is up to date.
        CHK     include/generated/timeconst.h
        CHK     include/generated/bounds.h
        CHK     include/generated/asm-offsets.h
        CALL    scripts/checksyscalls.sh
        CC      init/main.o
        CHK     include/generated/compile.h
        LD      init/built-in.o
        LINK    vmlinux
        LD      vmlinux.o
        MODPOST vmlinux.o
        GEN     .version
        CHK     include/generated/compile.h
        UPD     include/generated/compile.h
        CC      init/version.o
        LD      init/built-in.o
        KSYM    .tmp_kallsyms1.o
        KSYM    .tmp_kallsyms2.o
        LD      vmlinux
        SORTEX  vmlinux
        SYSMAP  System.map
        OBJCOPY arch/arm/boot/Image
        Building modules, stage 2.
        Kernel: arch/arm/boot/Image is ready
        GZIP    arch/arm/boot/compressed/piggy.gzip
        AS      arch/arm/boot/compressed/piggy.gzip.o
        Kernel: arch/arm/boot/Image is ready
        LD      arch/arm/boot/compressed/vmlinux
        GZIP    arch/arm/boot/compressed/piggy.gzip
        OBJCOPY arch/arm/boot/zImage
        Kernel: arch/arm/boot/zImage is ready
        UIMAGE  arch/arm/boot/uImage
      Image Name:   Linux-4.2.0-rc5-00156-gdd2384a-d
      Created:      Sat Aug  8 23:23:14 2015
      Image Type:   ARM Linux Kernel Image (uncompressed)
      Data Size:    26472 Bytes = 25.85 kB = 0.03 MB
      Load Address: 80208000
      Entry Point:  80208000
        Image arch/arm/boot/uImage is ready
        MODPOST 192 modules
        AS      arch/arm/boot/compressed/piggy.gzip.o
        LD      arch/arm/boot/compressed/vmlinux
        OBJCOPY arch/arm/boot/zImage
        Kernel: arch/arm/boot/zImage is ready
      $ ls -l arch/arm/boot/*Image
      -rwxrwxr-x 1 masahiro masahiro 13766656 Aug  8 23:23 arch/arm/boot/Image
      -rw-rw-r-- 1 masahiro masahiro    26536 Aug  8 23:23 arch/arm/boot/uImage
      -rwxrwxr-x 1 masahiro masahiro  6138648 Aug  8 23:23 arch/arm/boot/zImage
    
    Please notice the uImage is extremely small when this issue is
    encountered.  Besides, "Kernel: arch/arm/boot/zImage is ready" is
    displayed twice, before and after the uImage log.
    
    The root cause of this is the race condition between zImage and
    uImage.  Actually, uImage depends on zImage, but the dependency
    between the two is only described in arch/arm/boot/Makefile.
    Because arch/arm/boot/Makefile is not included from the top-level
    Makefile, it cannot know the dependency between zImage and uImage.
    
    Consequently, when we run make with the parallel option, Kbuild
    updates vmlinux first, and then two different threads descends into
    the arch/arm/boot/Makefile almost at the same time, one for updating
    zImage and the other for uImage.  While one thread is re-generating
    zImage, the other also tries to update zImage before creating uImage
    on top of that.  zImage is overwritten by the slower thread and then
    uImage is created based on the half-written zImage.
    
    This is the reason why "Kernel: arch/arm/boot/zImage is ready" is
    displayed twice, and a broken uImage is created.
    
    The same problem could happen on bootpImage.
    
    This commit adds dependencies among Image, zImage, uImage, and
    bootpImage to arch/arm/Makefile, which is included from the
    top-level Makefile.
    
    Signed-off-by: Masahiro Yamada <yamada.masahiro@socionext.com>
    Signed-off-by: Russell King <rmk+kernel@arm.linux.org.uk>

commit 36890997b0d219427e9d9d2aad5d46eb44fe808d
Author: Geert Uytterhoeven <geert@linux-m68k.org>
Date:   Sun Aug 2 11:09:54 2015 +0200

    rfkill: Allow compile test of GPIO consumers if !GPIOLIB
    
    The GPIO subsystem provides dummy GPIO consumer functions if GPIOLIB is
    not enabled. Hence drivers that depend on GPIOLIB, but use GPIO consumer
    functionality only, can still be compiled if GPIOLIB is not enabled.
    
    Relax the dependency on GPIOLIB if COMPILE_TEST is enabled, where
    appropriate.
    
    Signed-off-by: Geert Uytterhoeven <geert@linux-m68k.org>
    Acked-by: Linus Walleij <linus.walleij@linaro.org>
    Signed-off-by: Johannes Berg <johannes.berg@intel.com>

commit 409e9eff727295b93a5dde51988a6f8646e5aa6b
Author: Mauro Carvalho Chehab <mchehab@osg.samsung.com>
Date:   Tue Aug 11 16:09:21 2015 -0300

    [media] c8sectpfe: Allow compiling it with COMPILE_TEST
    
    While it won't work, it is good to allow it to build with
    COMPILE_TEST, as we can check if other patches would break
    compilation for this driver.
    
    Signed-off-by: Mauro Carvalho Chehab <mchehab@osg.samsung.com>

commit 8278780e3d3effe8f1db495f7329dbedaf035c46
Author: Geert Uytterhoeven <geert@linux-m68k.org>
Date:   Mon Jun 29 10:46:49 2015 -0300

    [media] tuners: Make all TV tuners visible if COMPILE_TEST=y
    
    Make the TV tuners menu visible when compile-testing, to allow
    selecting additional drivers on top of the drivers that are already
    automatically selected if MEDIA_SUBDRV_AUTOSELECT is enabled.
    
    Without this, many drivers stay disabled during e.g. allmodconfig.
    
    Signed-off-by: Geert Uytterhoeven <geert@linux-m68k.org>
    Signed-off-by: Mauro Carvalho Chehab <mchehab@osg.samsung.com>

commit 5cc596c66fe7c725ec049ae2093e7242034c97d6
Author: Geert Uytterhoeven <geert@linux-m68k.org>
Date:   Mon Jun 29 10:46:48 2015 -0300

    [media] i2c: Make all i2c devices visible if COMPILE_TEST=y
    
    Make the i2c devices menu visible when compile-testing, to allow
    selecting additional drivers on top of the drivers that are already
    automatically selected if MEDIA_SUBDRV_AUTOSELECT is enabled.
    
    Without this, many drivers stay disabled during e.g. allmodconfig.
    
    Signed-off-by: Geert Uytterhoeven <geert@linux-m68k.org>
    Signed-off-by: Mauro Carvalho Chehab <mchehab@osg.samsung.com>

commit 6df34051d8bd8807c873e1bb92b905e370ff3f5b
Author: Geert Uytterhoeven <geert@linux-m68k.org>
Date:   Mon Jun 29 10:46:47 2015 -0300

    [media] dvb-frontends: Make all DVB Frontends visible if COMPILE_TEST=y
    
    Make the DVB Frontends menu visible when compile-testing, to allow
    selecting additional drivers on top of the drivers that are already
    automatically selected if MEDIA_SUBDRV_AUTOSELECT is enabled.
    
    Without this, many drivers stay disabled during e.g. allmodconfig.
    
    Signed-off-by: Geert Uytterhoeven <geert@linux-m68k.org>
    Signed-off-by: Mauro Carvalho Chehab <mchehab@osg.samsung.com>

commit f151f53aa4f54a647353e1935e4c6cef7f094dd4
Author: Petri Gynther <pgynther@google.com>
Date:   Tue Aug 4 17:38:01 2015 -0700

    perf tools: Fix build errors with mipsel-linux-uclibc compiler
    
    linux/tools$ make ARCH=mips CROSS_COMPILE=mipsel-linux- perf
    ...
    config/Makefile:256: *** No gnu/libc-version.h found, please install
    glibc-dev[el].  Stop.
    make[1]: *** [all] Error 2
    make: *** [perf] Error 2
    
    ...
    In file included from builtin-sched.c:13:0:
    util/cloexec.h:8:12: error: redundant redeclaration of sched_getcpu
     [-Werror=redundant-decls]
     extern int sched_getcpu(void) __THROW;
    
    mipsel-buildroot-linux-uclibc/sysroot/usr/include/bits/sched.h:88:12:
     note: previous declaration of sched_getcpu was here
     extern int sched_getcpu (void) __THROW;
    
    uclibc info:
    sysroot/usr/include/bits/uClibc_config.h
    __UCLIBC_MAJOR__ 0
    __UCLIBC_MINOR__ 9
    __UCLIBC_SUBLEVEL__ 33
    
    sysroot/usr/include/features.h
    __UCLIBC__ 1
    __GLIBC__ 2
    __GLIBC_MINOR__ 2
    
    Signed-off-by: Petri Gynther <pgynther@google.com>
    Cc: Peter Zijlstra <a.p.zijlstra@chello.nl>
    Link: http://lkml.kernel.org/r/1438735081-24131-1-git-send-email-pgynther@google.com
    Signed-off-by: Arnaldo Carvalho de Melo <acme@redhat.com>

commit 0d62e9dd6da45bbf0f33a8617afc5fe774c8f45f
Author: David Howells <dhowells@redhat.com>
Date:   Wed Aug 5 12:54:46 2015 +0100

    ASN.1: Fix non-match detection failure on data overrun
    
    If the ASN.1 decoder is asked to parse a sequence of objects, non-optional
    matches get skipped if there's no more data to be had rather than a
    data-overrun error being reported.
    
    This is due to the code segment that decides whether to skip optional
    matches (ie. matches that could get ignored because an element is marked
    OPTIONAL in the grammar) due to a lack of data also skips non-optional
    elements if the data pointer has reached the end of the buffer.
    
    This can be tested with the data decoder for the new RSA akcipher algorithm
    that takes three non-optional integers.  Currently, it skips the last
    integer if there is insufficient data.
    
    Without the fix, #defining DEBUG in asn1_decoder.c will show something
    like:
    
            next_op: pc=0/13 dp=0/270 C=0 J=0
            - match? 30 30 00
            - TAG: 30 266 CONS
            next_op: pc=2/13 dp=4/270 C=1 J=0
            - match? 02 02 00
            - TAG: 02 257
            - LEAF: 257
            next_op: pc=5/13 dp=265/270 C=1 J=0
            - match? 02 02 00
            - TAG: 02 3
            - LEAF: 3
            next_op: pc=8/13 dp=270/270 C=1 J=0
            next_op: pc=11/13 dp=270/270 C=1 J=0
            - end cons t=4 dp=270 l=270/270
    
    The next_op line for pc=8/13 should be followed by a match line.
    
    This is not exploitable for X.509 certificates by means of shortening the
    message and fixing up the ASN.1 CONS tags because:
    
     (1) The relevant records being built up are cleared before use.
    
     (2) If the message is shortened sufficiently to remove the public key, the
         ASN.1 parse of the RSA key will fail quickly due to a lack of data.
    
     (3) Extracted signature data is either turned into MPIs (which cope with a
         0 length) or is simpler integers specifying algoritms and suchlike
         (which can validly be 0); and
    
     (4) The AKID and SKID extensions are optional and their removal is handled
         without risking passing a NULL to asymmetric_key_generate_id().
    
     (5) If the certificate is truncated sufficiently to remove the subject,
         issuer or serialNumber then the ASN.1 decoder will fail with a 'Cons
         stack underflow' return.
    
    This is not exploitable for PKCS#7 messages by means of removal of elements
    from such a message from the tail end of a sequence:
    
     (1) Any shortened X.509 certs embedded in the PKCS#7 message are survivable
         as detailed above.
    
     (2) The message digest content isn't used if it shows a NULL pointer,
         similarly, the authattrs aren't used if that shows a NULL pointer.
    
     (3) A missing signature results in a NULL MPI - which the MPI routines deal
         with.
    
     (4) If data is NULL, it is expected that the message has detached content and
         that is handled appropriately.
    
     (5) If the serialNumber is excised, the unconditional action associated
         with it will pick up the containing SEQUENCE instead, so no NULL
         pointer will be seen here.
    
         If both the issuer and the serialNumber are excised, the ASN.1 decode
         will fail with an 'Unexpected tag' return.
    
         In either case, there's no way to get to asymmetric_key_generate_id()
         with a NULL pointer.
    
     (6) Other fields are decoded to simple integers.  Shortening the message
         to omit an algorithm ID field will cause checks on this to fail early
         in the verification process.
    
    
    This can also be tested by snipping objects off of the end of the ASN.1 stream
    such that mandatory tags are removed - or even from the end of internal
    SEQUENCEs.  If any mandatory tag is missing, the error EBADMSG *should* be
    produced.  Without this patch ERANGE or ENOPKG might be produced or the parse
    may apparently succeed, perhaps with ENOKEY or EKEYREJECTED being produced
    later, depending on what gets snipped.
    
    Just snipping off the final BIT_STRING or OCTET_STRING from either sample
    should be a start since both are mandatory and neither will cause an EBADMSG
    without the patches
    
    Reported-by: Marcel Holtmann <marcel@holtmann.org>
    Signed-off-by: David Howells <dhowells@redhat.com>
    Tested-by: Marcel Holtmann <marcel@holtmann.org>
    Reviewed-by: David Woodhouse <David.Woodhouse@intel.com>

commit b737eeb09e3068b092e116f855aa1973fa24c88c
Author: Geert Uytterhoeven <geert@linux-m68k.org>
Date:   Sun Aug 2 11:09:52 2015 +0200

    serial: Allow compile test of GPIO consumers if !GPIOLIB
    
    The GPIO subsystem provides dummy GPIO consumer functions if GPIOLIB is
    not enabled. Hence drivers that depend on GPIOLIB, but use GPIO consumer
    functionality only, can still be compiled if GPIOLIB is not enabled.
    
    Relax the dependency on GPIOLIB if COMPILE_TEST is enabled, where
    appropriate.
    
    Signed-off-by: Geert Uytterhoeven <geert@linux-m68k.org>
    Acked-by: Linus Walleij <linus.walleij@linaro.org>
    Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>

commit 1e8b82c1ff3bc52c5e4265d66fe5c6da9a66e2e6
Author: Geert Uytterhoeven <geert@linux-m68k.org>
Date:   Sun Aug 2 11:09:50 2015 +0200

    power: Allow compile test of GPIO consumers if !GPIOLIB
    
    The GPIO subsystem provides dummy GPIO consumer functions if GPIOLIB is
    not enabled. Hence drivers that depend on GPIOLIB, but use GPIO consumer
    functionality only, can still be compiled if GPIOLIB is not enabled.
    
    Relax the dependency on GPIOLIB if COMPILE_TEST is enabled, where
    appropriate.
    
    Signed-off-by: Geert Uytterhoeven <geert@linux-m68k.org>
    Acked-by: Linus Walleij <linus.walleij@linaro.org>
    Signed-off-by: Sebastian Reichel <sre@kernel.org>

commit 7d6548abcf4ea4845db8a62a5875d93e2c1bf882
Author: Geert Uytterhoeven <geert@linux-m68k.org>
Date:   Tue Aug 4 11:43:40 2015 -0700

    Input: Allow compile test of GPIO consumers if !GPIOLIB
    
    The GPIO subsystem provides dummy GPIO consumer functions if GPIOLIB is
    not enabled. Hence drivers that depend on GPIOLIB, but use GPIO consumer
    functionality only, can still be compiled if GPIOLIB is not enabled.
    
    Relax the dependency on GPIOLIB if COMPILE_TEST is enabled, where
    appropriate.
    
    Signed-off-by: Geert Uytterhoeven <geert@linux-m68k.org>
    Acked-by: Linus Walleij <linus.walleij@linaro.org>
    Signed-off-by: Dmitry Torokhov <dmitry.torokhov@gmail.com>

commit fd93b8059294146a1c3dc9cf6b5616c22b7b47f7
Author: Geert Uytterhoeven <geert@linux-m68k.org>
Date:   Sun Aug 2 11:09:51 2015 +0200

    staging: android: Allow compile test of GPIO consumers if !GPIOLIB
    
    The GPIO subsystem provides dummy GPIO consumer functions if GPIOLIB is
    not enabled. Hence drivers that depend on GPIOLIB, but use GPIO consumer
    functionality only, can still be compiled if GPIOLIB is not enabled.
    
    Relax the dependency on GPIOLIB if COMPILE_TEST is enabled, where
    appropriate.
    
    Signed-off-by: Geert Uytterhoeven <geert@linux-m68k.org>
    Acked-by: Linus Walleij <linus.walleij@linaro.org>
    Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>

commit 24b7d011a65042a8bd2f3b93c812c7eae3ead2d8
Author: Geert Uytterhoeven <geert@linux-m68k.org>
Date:   Sun Aug 2 11:09:52 2015 +0200

    staging: fbtft: Allow compile test of GPIO consumers if !GPIOLIB
    
    The GPIO subsystem provides dummy GPIO consumer functions if GPIOLIB is
    not enabled. Hence drivers that depend on GPIOLIB, but use GPIO consumer
    functionality only, can still be compiled if GPIOLIB is not enabled.
    
    Relax the dependency on GPIOLIB if COMPILE_TEST is enabled, where
    appropriate.
    
    Signed-off-by: Geert Uytterhoeven <geert@linux-m68k.org>
    Acked-by: Linus Walleij <linus.walleij@linaro.org>
    Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>

commit 91ff38153a7ba011a9bd56a0ffa52f6bed9d1059
Author: Arnd Bergmann <arnd@arndb.de>
Date:   Tue May 19 14:47:32 2015 +0200

    ASoC: omap: fix up SND_OMAP_SOC_OMAP_ABE_TWL6040 dependency, again
    
    commit 0574eab363ace70ef275d4caad6eadc458d33728 upstream.
    
    I tried to fix this before and submitted a working patch, but after
    some discussion we came up with what seemed to be a nicer solution,
    resulting in commit 3d4cf65e2d ("ASoC: omap: fix up
    SND_OMAP_SOC_OMAP_ABE_TWL6040 dependency"). Unfortunately, that
    version was incomplete, and we still get this build error:
    
    drivers/clk/clk-palmas.c:46:16: error: field 'hw' has incomplete type
    drivers/clk/clk-palmas.c: In function 'to_palmas_clks_info':
    drivers/clk/clk-palmas.c:54:74: warning: initialization from incompatible pointer type [-Winc
    
    This happens only in randconfig builds that turn on MFD_PALMAS
    on a platform other than OMAP2+ when COMPILE_TEST is set
    but COMMON_CLK is not.
    
    The new approach is only 'select COMMON_CLK_PALMAS' if we know
    that we are on an OMAP5 platform and MFD_PALMAS is already set.
    This patch has survived thousands of randconfig builds and I
    don't see a remaining hole in the logic.
    
    Fixes: 3d4cf65e2d ("ASoC: omap: fix up SND_OMAP_SOC_OMAP_ABE_TWL6040 dependency")
    Signed-off-by: Arnd Bergmann <arnd@arndb.de>
    Acked-by: Peter Ujfalusi <peter.ujfalusi@ti.com>
    Signed-off-by: Mark Brown <broonie@kernel.org>
    Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>

commit d23555e426b6531eccb1018714adfc1e6f762c6d
Author: Arnd Bergmann <arnd@arndb.de>
Date:   Thu May 21 11:07:08 2015 +0200

    ASoC: qcom: remove incorrect dependencies
    
    commit a7310c496f376b945e7e61f64d69c9c0a93ee1ee upstream.
    
    Compile-tests show a warning for the newly added SND_SOC_STORM
    symbol:
    
    warning: (SND_SOC_STORM) selects SND_SOC_LPASS_CPU which has unmet direct dependencies (SOUND && !M68K && !UML && SND && SND_SOC && SND_SOC_QCOM)
    
    The problem is that it can be selected for COMPILE_TEST on non-QCOM
    builds, but the symbols it selects have a dependency.
    Dropping the dependencies makes it work without warnings and no
    other side-effects, because these are not user-visible.
    
    Signed-off-by: Arnd Bergmann <arnd@arndb.de>
    Fixes: f380dd3f3cd ("ASoC: qcom: Add ability to build QCOM drivers")
    Signed-off-by: Mark Brown <broonie@kernel.org>
    Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>

commit d12bbcd3ea4402704d13f687601dc5af1361a548
Author: Javier Martinez Canillas <javier.martinez@collabora.co.uk>
Date:   Thu Jun 25 02:20:42 2015 +0200

    platform/chrome: Don't make CHROME_PLATFORMS depends on X86 || ARM
    
    The Chrome platform support depends on X86 || ARM because there are
    only Chromebooks using those architectures. But only some drivers
    depend on a given architecture, and the ones that do already have
    a dependency on their specific Kconfig symbol entries.
    
    An option is to also make CHROME_PLATFORMS depends on || COMPILE_TEST
    but is more future proof to remove the dependency and let the drivers
    be built in all architectures if possible to have more build coverage.
    
    Acked-by: Olof Johansson <olof@lixom.net>
    Signed-off-by: Javier Martinez Canillas <javier.martinez@collabora.co.uk>
    Signed-off-by: Lee Jones <lee.jones@linaro.org>

commit 2f8e75d2762496bb2fcea7fa437a3339d2a6d9d4
Author: Geert Uytterhoeven <geert@linux-m68k.org>
Date:   Mon Jun 29 10:45:56 2015 -0300

    [media] adv7604/cobalt: Allow compile test if !GPIOLIB
    
    The GPIO subsystem provides dummy GPIO consumer functions if GPIOLIB is
    not enabled. Hence drivers that depend on GPIOLIB, but use GPIO consumer
    functionality only, can still be compiled if GPIOLIB is not enabled.
    
    Relax the dependency of VIDEO_ADV7604 and VIDEO_COBALT (the latter
    selects the former) on GPIOLIB if COMPILE_TEST is enabled.
    
    Signed-off-by: Geert Uytterhoeven <geert@linux-m68k.org>
    Signed-off-by: Hans Verkuil <hans.verkuil@cisco.com>
    Signed-off-by: Mauro Carvalho Chehab <mchehab@osg.samsung.com>

commit 3c71ba3f80bbd476bbfb2a008da9b676031cbd32
Author: Alexey Brodkin <Alexey.Brodkin@synopsys.com>
Date:   Tue Jul 14 12:05:20 2015 +0300

    perf tools: Really allow to specify custom CC, AR or LD
    
    Commit 5ef7bbb09f7b ("perf tools: Allow to specify custom linker
    command") was meant to enable usage non $(CROSS_COMPILE)ld linker during
    perf building.
    
    But implementation didn't take into account the fact that LD is a
    pre-defined variable in GNU Make. I.e. it is always defined.
    
    Which means there's no point to check "LD ?= ..." because it will never
    succeed.
    
    And so LD will be either that explicitly passed to make like this:
    
     ------->8-------
     make LD=path_to_my_ld ...
     ------->8-------
     or default value, which is host's "ld".
    
    Latter leads to failure of cross-linkage because instead of cross linker
    "$(CROSS_COMPILE)ld" host's "ld" is used.
    
    Fortunately there's a way to do correct substitution of $(CROSS_COMPILE)ld
    with user defined LD on command-line.
    
    As a reference was used implementation in "tools/lib/traceevent/Makefile".
    
    Build tested for x86_64 and ARC.
    
    Thanks Jiri for this hint.
    
    Signed-off-by: Alexey Brodkin <abrodkin@synopsys.com>
    Fixes: 5ef7bbb09f7b ("perf tools: Allow to specify custom linker command")
    Cc: Aaro Koskinen <aaro.koskinen@nokia.com>
    Cc: Jiri Olsa <jolsa@kernel.org>
    Cc: Paul Mackerras <paulus@samba.org>
    Cc: Peter Zijlstra <a.p.zijlstra@chello.nl>
    Cc: Vineet Gupta <Vineet.Gupta1@synopsys.com>
    Cc: Vineet Gupta <vgupta@synopsys.com>
    Cc: linux-arch@vger.kernel.org
    Link: http://lkml.kernel.org/r/1436864720-26316-1-git-send-email-abrodkin@synopsys.com
    Signed-off-by: Arnaldo Carvalho de Melo <acme@redhat.com>

commit 2cdcc357c221796fac3772f23cd5830f411c0e45
Author: Guenter Roeck <linux@roeck-us.net>
Date:   Wed Jun 24 15:27:01 2015 -0700

    crypto: asymmetric_keys/rsa - Use non-conflicting variable name
    
    arm64:allmodconfig fails to build as follows.
    
    In file included from include/acpi/platform/aclinux.h:74:0,
                     from include/acpi/platform/acenv.h:173,
                     from include/acpi/acpi.h:56,
                     from include/linux/acpi.h:37,
                     from ./arch/arm64/include/asm/dma-mapping.h:21,
                     from include/linux/dma-mapping.h:86,
                     from include/linux/skbuff.h:34,
                     from include/crypto/algapi.h:18,
                     from crypto/asymmetric_keys/rsa.c:16:
    include/linux/ctype.h:15:12: error: expected ;, , or )
                    before numeric constant
     #define _X 0x40 /* hex digit */
                ^
    crypto/asymmetric_keys/rsa.c:123:47: note: in expansion of macro _X
     static int RSA_I2OSP(MPI x, size_t xLen, u8 **_X)
                                                   ^
    crypto/asymmetric_keys/rsa.c: In function RSA_verify_signature:
    crypto/asymmetric_keys/rsa.c:256:2: error:
                    implicit declaration of function RSA_I2OSP
    
    The problem is caused by an unrelated include file change, resulting in
    the inclusion of ctype.h on arm64. This in turn causes the local variable
    _X to conflict with macro _X used in ctype.h.
    
    Fixes: b6197b93fa4b ("arm64 : Introduce support for ACPI _CCA object")
    Cc: Suthikulpanit, Suravee <Suravee.Suthikulpanit@amd.com>
    Signed-off-by: Guenter Roeck <linux@roeck-us.net>
    Signed-off-by: Herbert Xu <herbert@gondor.apana.org.au>

commit 0e441665bc6286a306a23cb0354b56d61e1d9ce6
Author: Geert Uytterhoeven <geert@linux-m68k.org>
Date:   Tue May 5 18:32:39 2015 +0200

    backlight: Allow compile test of GPIO consumers if !GPIOLIB
    
    The GPIO subsystem provides dummy GPIO consumer functions if GPIOLIB is
    not enabled. Hence drivers that depend on GPIOLIB, but use GPIO consumer
    functionality only, can still be compiled if GPIOLIB is not enabled.
    
    Relax the dependency on GPIOLIB if COMPILE_TEST is enabled, where
    appropriate.
    
    Cc: Jingoo Han <jg1.han@samsung.com>
    Signed-off-by: Geert Uytterhoeven <geert@linux-m68k.org>
    Signed-off-by: Lee Jones <lee.jones@linaro.org>

commit 44d21c3f3a2ef2f58b18bda64c52c99e723f3f4a
Merge: efdfce2b7ff3 fe55dfdcdfab
Author: Linus Torvalds <torvalds@linux-foundation.org>
Date:   Mon Jun 22 21:04:48 2015 -0700

    Merge git://git.kernel.org/pub/scm/linux/kernel/git/herbert/crypto-2.6
    
    Pull crypto update from Herbert Xu:
     "Here is the crypto update for 4.2:
    
      API:
    
       - Convert RNG interface to new style.
    
       - New AEAD interface with one SG list for AD and plain/cipher text.
         All external AEAD users have been converted.
    
       - New asymmetric key interface (akcipher).
    
      Algorithms:
    
       - Chacha20, Poly1305 and RFC7539 support.
    
       - New RSA implementation.
    
       - Jitter RNG.
    
       - DRBG is now seeded with both /dev/random and Jitter RNG.  If kernel
         pool isn't ready then DRBG will be reseeded when it is.
    
       - DRBG is now the default crypto API RNG, replacing krng.
    
       - 842 compression (previously part of powerpc nx driver).
    
      Drivers:
    
       - Accelerated SHA-512 for arm64.
    
       - New Marvell CESA driver that supports DMA and more algorithms.
    
       - Updated powerpc nx 842 support.
    
       - Added support for SEC1 hardware to talitos"
    
    * git://git.kernel.org/pub/scm/linux/kernel/git/herbert/crypto-2.6: (292 commits)
      crypto: marvell/cesa - remove COMPILE_TEST dependency
      crypto: algif_aead - Temporarily disable all AEAD algorithms
      crypto: af_alg - Forbid the use internal algorithms
      crypto: echainiv - Only hold RNG during initialisation
      crypto: seqiv - Add compatibility support without RNG
      crypto: eseqiv - Offer normal cipher functionality without RNG
      crypto: chainiv - Offer normal cipher functionality without RNG
      crypto: user - Add CRYPTO_MSG_DELRNG
      crypto: user - Move cryptouser.h to uapi
      crypto: rng - Do not free default RNG when it becomes unused
      crypto: skcipher - Allow givencrypt to be NULL
      crypto: sahara - propagate the error on clk_disable_unprepare() failure
      crypto: rsa - fix invalid select for AKCIPHER
      crypto: picoxcell - Update to the current clk API
      crypto: nx - Check for bogus firmware properties
      crypto: marvell/cesa - add DT bindings documentation
      crypto: marvell/cesa - add support for Kirkwood and Dove SoCs
      crypto: marvell/cesa - add support for Orion SoCs
      crypto: marvell/cesa - add allhwsupport module parameter
      crypto: marvell/cesa - add support for all armada SoCs
      ...

commit 21a926a340723035b5c569046056d65f80013e12
Author: Geert Uytterhoeven <geert@linux-m68k.org>
Date:   Tue May 5 18:32:42 2015 +0200

    watchdog: Allow compile test of GPIO consumers if !GPIOLIB
    
    The GPIO subsystem provides dummy GPIO consumer functions if GPIOLIB is
    not enabled. Hence drivers that depend on GPIOLIB, but use GPIO consumer
    functionality only, can still be compiled if GPIOLIB is not enabled.
    
    Relax the dependency on GPIOLIB if COMPILE_TEST is enabled, where
    appropriate.
    
    Signed-off-by: Geert Uytterhoeven <geert@linux-m68k.org>
    Reviewed-by: Guenter Roeck <linux@roeck-us.net>
    Signed-off-by: Wim Van Sebroeck <wim@iguana.be>
    Cc: linux-watchdog@vger.kernel.org

commit 6fafecc12ddfd5d02be531de081e4ea9cb8db02f
Author: Geert Uytterhoeven <geert@linux-m68k.org>
Date:   Tue May 5 18:32:27 2015 +0200

    mfd: Allow compile test of GPIO consumers if !GPIOLIB
    
    The GPIO subsystem provides dummy GPIO consumer functions if GPIOLIB is
    not enabled. Hence drivers that depend on GPIOLIB, but use GPIO consumer
    functionality only, can still be compiled if GPIOLIB is not enabled.
    
    Relax the dependency on GPIOLIB if COMPILE_TEST is enabled, where
    appropriate.
    
    Signed-off-by: Geert Uytterhoeven <geert@linux-m68k.org>
    Signed-off-by: Lee Jones <lee.jones@linaro.org>

commit fe55dfdcdfabf160ab0c14617725c57c7a1facfc
Author: Boris Brezillon <boris.brezillon@free-electrons.com>
Date:   Mon Jun 22 09:22:14 2015 +0200

    crypto: marvell/cesa - remove COMPILE_TEST dependency
    
    The CESA driver calls phys_to_virt() which is not available on all
    architectures.
    Remove the depency on COMPILE_TEST to prevent building this driver on
    non ARM architectures.
    
    Signed-off-by: Boris Brezillon <boris.brezillon@free-electrons.com>
    Reported-by: Paul Gortmaker <paul.gortmaker@windriver.com>
    Suggested-by: Herbert Xu <herbert@gondor.apana.org.au>
    Signed-off-by: Herbert Xu <herbert@gondor.apana.org.au>

commit d37e296979ed1652aec6850e2d736bd0ebf0cdb1
Author: Tadeusz Struk <tadeusz.struk@intel.com>
Date:   Mon Jun 15 13:18:36 2015 -0700

    MPILIB: add mpi_read_buf() and mpi_get_size() helpers
    
    Added a mpi_read_buf() helper function to export MPI to a buf provided by
    the user, and a mpi_get_size() helper, that tells the user how big the buf is.
    Changed mpi_free to use kzfree instead of kfree because it is used to free
    crypto keys.
    
    Signed-off-by: Tadeusz Struk <tadeusz.struk@intel.com>
    Signed-off-by: Herbert Xu <herbert@gondor.apana.org.au>

commit 1f1e34f7231c7284f3acae37096a603f19bcd8b7
Merge: baaae1921088 36f58113423f
Author: Linus Torvalds <torvalds@linux-foundation.org>
Date:   Sun Jun 14 15:38:57 2015 -1000

    Merge branch 'upstream' of git://git.linux-mips.org/pub/scm/ralf/upstream-linus
    
    Pull more MIPS fixes from Ralf Baechle:
     "Another round of 4.1 MIPS fixes, one fix to a MIPS-specific #if
      condition in lib/mpi, one fix to the MIPS GIC irqchip driver and one
      SSB fix.
    
      Details:
       - fix handling of clock in chipco SSB driver.
       - fix two MIPS-specific #if conditions to correctly work for GCC 5.1.
       - fix damage to R6 pgtable bits done by XPA support.
       - fix possible crash due to unloading modules that contain statically
         defined platform devices.
       - fix disabling of the MSA ASE on context switch to also work
         correctly when a new thread/process has the CPU for the very first
         time.
    
      This is part of linux-next and has been beaten to death on
      Imagination's test farm.
    
      While things are not looking too grim this pull request also means the
      rate of fixes for 4.1 remains nearly constant so I'd not be unhappy if
      you'd delay the release"
    
    * 'upstream' of git://git.linux-mips.org/pub/scm/ralf/upstream-linus:
      MPI: MIPS: Fix compilation error with GCC 5.1
      IRQCHIP: mips-gic: Don't nest calls to do_IRQ()
      MIPS: MSA: bugfix - disable MSA correctly for new threads/processes.
      MIPS: Loongson: Do not register 8250 platform device from module.
      MIPS: Cobalt: Do not build MTD platform device registration code as module.
      SSB: Fix handling of ssb_pmu_get_alp_clock()
      MIPS: pgtable-bits: Fix XPA damage to R6 definitions.

commit 36f58113423f4588d7cf7535644fbb214414193b
Author: Jaedon Shin <jaedon.shin@gmail.com>
Date:   Fri Jun 12 18:04:14 2015 +0900

    MPI: MIPS: Fix compilation error with GCC 5.1
    
    This patch fixes mips compilation error:
    
    lib/mpi/generic_mpih-mul1.c: In function 'mpihelp_mul_1':
    lib/mpi/longlong.h:651:2: error: impossible constraint in 'asm'
    
    Signed-off-by: Jaedon Shin <jaedon.shin@gmail.com>
    Cc: Linux-MIPS <linux-mips@linux-mips.org>
    Patchwork: https://patchwork.linux-mips.org/patch/10546/
    Signed-off-by: Ralf Baechle <ralf@linux-mips.org>

commit d2b30cd4b7223a96e606dfc8120626f66d81e091
Author: Nathan Lynch <nathan_lynch@mentor.com>
Date:   Wed Jun 3 00:41:15 2015 +0100

    ARM: 8384/1: VDSO: force use of BFD linker
    
    When using a toolchain with gold as the default linker, the VDSO build
    fails:
    
      VDSO    arch/arm/vdso/vdso.so.raw
      HOSTCC  arch/arm/vdso/vdsomunge
      MUNGE   arch/arm/vdso/vdso.so.dbg
      OBJCOPY arch/arm/vdso/vdso.so
    BFD: arch/arm/vdso/vdso.so: Not enough room for program headers, try
    linking with -N
    
    For whatever reason, ld.gold is omitting an exidx program header that
    ld.bfd emits, and even when I work around that, I don't get a working
    VDSO.
    
    For now, instead of supporting gold (which will fail to link the
    kernel anyway since it does not implement --pic-veneer), direct the
    compiler to use the traditional bfd linker.  This is accomplished by
    using -fuse-ld, which is implemented in GCC 4.8 and later.
    
    Note: one limitation of this is that if the toolchain is configured
    to use gold by default, and the bfd linker is not in $PATH, the VDSO
    build will fail:
    
      VDSO    arch/arm/vdso/vdso.so.raw
    collect2: fatal error: cannot find 'ld'
    
    This will happen if CROSS_COMPILE begins with a path such as
    /opt/bin/arm-linux-gnu- but /opt/bin is not in $PATH.  This is
    considered an acceptable corner-case limitation and is easily worked
    around.
    
    Additonal note: we use cc-option instead of cc-ldoption so that
    -fuse-ld=bfd is placed in the command line if the compiler recognizes
    the option.  Using cc-ldoption results in an attempt to link, which
    fails in the situation just described, causing -fuse-ld=bfd to be
    omitted and gold to be used for the VDSO link, which is what we're
    trying to prevent.
    
    Reported-by: Stefan Agner <stefan@agner.ch>
    Signed-off-by: Nathan Lynch <nathan_lynch@mentor.com>
    Signed-off-by: Russell King <rmk+kernel@arm.linux.org.uk>

commit 14f95acda2f3238f3470beea0ddbf78081b3268d
Author: Daniel Axtens <dja@axtens.net>
Date:   Tue Apr 14 14:28:02 2015 +1000

    powerpc/mpic_u3msi: Move MSI-related ops to pci_controller_ops
    
    Move the u3 MPIC msi subsystem to use the pci_controller_ops structure
    rather than ppc_md for MSI related PCI controller operations.
    
    As with fsl_msi, operations are plugged in at the subsys level, after
    controller creation. Again, we iterate over all controllers and
    populate them with the MSI ops.
    
    Signed-off-by: Daniel Axtens <dja@axtens.net>
    Signed-off-by: Michael Ellerman <mpe@ellerman.id.au>

commit 83922966973e19a48b6e59f9fa1259aa790a33c1
Author: Daniel Axtens <dja@axtens.net>
Date:   Tue Apr 14 14:28:01 2015 +1000

    powerpc/pasemi: Move MSI-related ops to pci_controller_ops
    
    Move the PaSemi MPIC msi subsystem to use the pci_controller_ops
    structure rather than ppc_md for MSI related PCI controller
    operations.
    
    As with fsl_msi, operations are plugged in at the subsys level, after
    controller creation. Again, we iterate over all controllers and
    populate them with the MSI ops.
    
    Signed-off-by: Daniel Axtens <dja@axtens.net>
    Signed-off-by: Michael Ellerman <mpe@ellerman.id.au>

commit 1376e2c3d7df80c3fa0574a5320f79b84c8fe880
Author: Geert Uytterhoeven <geert@linux-m68k.org>
Date:   Tue May 5 18:32:21 2015 +0200

    hwmon: Allow compile test of GPIO consumers if !GPIOLIB
    
    The GPIO subsystem provides dummy GPIO consumer functions if GPIOLIB is
    not enabled. Hence drivers that depend on GPIOLIB, but use GPIO consumer
    functionality only, can still be compiled if GPIOLIB is not enabled.
    
    Relax the dependency on GPIOLIB if COMPILE_TEST is enabled, where
    appropriate.
    
    Signed-off-by: Geert Uytterhoeven <geert@linux-m68k.org>
    Cc: Jean Delvare <jdelvare@suse.de>
    Cc: Guenter Roeck <linux@roeck-us.net>
    Cc: lm-sensors@lm-sensors.org
    Signed-off-by: Guenter Roeck <linux@roeck-us.net>

commit c579401a246328e1a11bd4cce70e6d0b63c3cfdb
Author: Geert Uytterhoeven <geert@linux-m68k.org>
Date:   Tue May 5 13:32:26 2015 -0300

    [media] wl128x: Allow compile test of GPIO consumers if !GPIOLIB
    
    The GPIO subsystem provides dummy GPIO consumer functions if GPIOLIB is
    not enabled. Hence drivers that depend on GPIOLIB, but use GPIO consumer
    functionality only, can still be compiled if GPIOLIB is not enabled.
    
    Relax the dependency on GPIOLIB if COMPILE_TEST is enabled, where
    appropriate.
    
    Signed-off-by: Geert Uytterhoeven <geert@linux-m68k.org>
    Signed-off-by: Hans Verkuil <hans.verkuil@cisco.com>
    Signed-off-by: Mauro Carvalho Chehab <mchehab@osg.samsung.com>

commit db874c7e10557f8f1af9a6fb1ec6589ae06f349c
Author: Tony Lindgren <tony@atomide.com>
Date:   Fri May 29 09:54:02 2015 -0700

    PM / wakeirq: Fix typo in prototype for dev_pm_set_dedicated_wake_irq
    
    Looks like I only built test the dev_pm_set_wake_irq and not the
    dev_pm_set_dedicated_wake_irq case on x86.
    
    Turns out there's a typo for the dev_pm_set_dedicated_wake_irq
    prototype that causes a build error if CONFIG_COMPILE_TEST
    and CONFIG_MMC_OMAP_HS are selected.
    
    Reported-by: Jim Davis <jim.epost@gmail.com>
    Signed-off-by: Tony Lindgren <tony@atomide.com>
    Reviewed-by: Felipe Balbi <balbi@ti.com>
    Signed-off-by: Rafael J. Wysocki <rafael.j.wysocki@intel.com>

commit 9ab1963d83fd5709037f2ef62cfe0062c538fe83
Author: Geert Uytterhoeven <geert@linux-m68k.org>
Date:   Thu May 7 01:08:10 2015 -0700

    leds: leds-gpio: Allow compile test if !GPIOLIB
    
    The GPIO subsystem provides dummy GPIO consumer functions if GPIOLIB is
    not enabled. Hence drivers that depend on GPIOLIB, but use GPIO consumer
    functionality only, can still be compiled if GPIOLIB is not enabled.
    
    Relax the dependency of LEDS_GPIO on GPIOLIB if COMPILE_TEST is
    enabled.
    
    Signed-off-by: Geert Uytterhoeven <geert@linux-m68k.org>
    Acked-by: Jacek Anaszewski <j.anaszewski@samsung.com>
    Acked-by: Linus Walleij <linus.walleij@linaro.org>
    Signed-off-by: Bryan Wu <cooloney@gmail.com>

commit 61e331202f1ad57ccd2f08e4cea91dccb8591809
Merge: 936a0cd52aa5 884ca45613c4
Author: Greg Kroah-Hartman <gregkh@linuxfoundation.org>
Date:   Sun May 24 11:45:21 2015 -0700

    Merge tag 'iio-for-v4.2b' of git://git.kernel.org/pub/scm/linux/kernel/git/jic23/iio into staging-next
    
    Jonathan writes:
    
    Second set of new driver, functionality and cleanups for IIO in the 4.2 cycle.
    
    Core functionality
    * i and q modifiers from quadrature channels.
    * IIO_CHAN_INFO_OVERSAMPLING_RATIO added.
    * High pass filter attributes added to mirror the existing low pass filter
      ones.
    
    Core cleanups
    * Make IIO tools building more cross compiler friendly.
    * Substantial rework of the function __iio_update_buffers to greatly simplify
      a hideously evolved function.
    
    New drivers and support
    * ACPI0008 ambient light sensor driver. This one has been around a long time to
      will be good to finally get it into mainline.
    * Berlin SOC ADC support.
    * BMC150 magnetometer.  The accelerometer in the same package has been supported
      for quite some time, so good to have this half as well.
    * m62332 DAC driver
    * MEMSIC MMC35420 magnetometer.
    * ROHM BH1710 and similar ambient light sensors.
    * Sensortek STK3310 light sensor.
    * Sensortek STK8312 accelerometer.
    * Sensortek STK8BA50 accelerometer.
    * ti-adc128s052 gains support form the adc122s021 2 channel ADC.
    
    Driver cleanups and functionality.
    * Allow various drivers to compile with !GPIOLIB if COMPILE_TEST enabled.
    * bmc150 - decouple trigger from buffer to allow other triggers to be used.
    * bmg160 - decouple trigger from buffer to allow other triggers to be used.
      Fix a trivial unused field.
    * Constify a load of platform_device_id structures.
    * inv_mpu6050 - device tree bindings.
    * hid-sensors - fix a memory leak during probe if certain errors occur.
    * ltr501 - illuminance channel derived (in an non obvious fashion) from the
      intensity channels.
    * ltr501 - fix a boundary check on the proximity threshold.
    * mlx90614 - drop a pointless return.
    * mma8452 - Debugfs register access and fix a bug that had no effect (by
      coincidence)
    * ti_am335x_adc - add device tree bindings for sample-delay, open-delay and
      averaging.  The ideal settings for these tend to be board design specific.

commit a7310c496f376b945e7e61f64d69c9c0a93ee1ee
Author: Arnd Bergmann <arnd@arndb.de>
Date:   Thu May 21 11:07:08 2015 +0200

    ASoC: qcom: remove incorrect dependencies
    
    Compile-tests show a warning for the newly added SND_SOC_STORM
    symbol:
    
    warning: (SND_SOC_STORM) selects SND_SOC_LPASS_CPU which has unmet direct dependencies (SOUND && !M68K && !UML && SND && SND_SOC && SND_SOC_QCOM)
    
    The problem is that it can be selected for COMPILE_TEST on non-QCOM
    builds, but the symbols it selects have a dependency.
    Dropping the dependencies makes it work without warnings and no
    other side-effects, because these are not user-visible.
    
    Signed-off-by: Arnd Bergmann <arnd@arndb.de>
    Fixes: f380dd3f3cd ("ASoC: qcom: Add ability to build QCOM drivers")
    Signed-off-by: Mark Brown <broonie@kernel.org>

commit f650ce24b320d061ab1ff7023cd9abee773d9672
Author: Geert Uytterhoeven <geert@linux-m68k.org>
Date:   Tue May 5 18:32:29 2015 +0200

    mtd: Allow compile test of GPIO consumers if !GPIOLIB
    
    The GPIO subsystem provides dummy GPIO consumer functions if GPIOLIB is
    not enabled. Hence drivers that depend on GPIOLIB, but use GPIO consumer
    functionality only, can still be compiled if GPIOLIB is not enabled.
    
    Relax the dependency on GPIOLIB if COMPILE_TEST is enabled, where
    appropriate.
    
    Signed-off-by: Geert Uytterhoeven <geert@linux-m68k.org>
    Cc: David Woodhouse <dwmw2@infradead.org>
    Cc: linux-mtd@lists.infradead.org
    Signed-off-by: Brian Norris <computersforpeace@gmail.com>

commit 0574eab363ace70ef275d4caad6eadc458d33728
Author: Arnd Bergmann <arnd@arndb.de>
Date:   Tue May 19 14:47:32 2015 +0200

    ASoC: omap: fix up SND_OMAP_SOC_OMAP_ABE_TWL6040 dependency, again
    
    I tried to fix this before and submitted a working patch, but after
    some discussion we came up with what seemed to be a nicer solution,
    resulting in commit 3d4cf65e2d ("ASoC: omap: fix up
    SND_OMAP_SOC_OMAP_ABE_TWL6040 dependency"). Unfortunately, that
    version was incomplete, and we still get this build error:
    
    drivers/clk/clk-palmas.c:46:16: error: field 'hw' has incomplete type
    drivers/clk/clk-palmas.c: In function 'to_palmas_clks_info':
    drivers/clk/clk-palmas.c:54:74: warning: initialization from incompatible pointer type [-Winc
    
    This happens only in randconfig builds that turn on MFD_PALMAS
    on a platform other than OMAP2+ when COMPILE_TEST is set
    but COMMON_CLK is not.
    
    The new approach is only 'select COMMON_CLK_PALMAS' if we know
    that we are on an OMAP5 platform and MFD_PALMAS is already set.
    This patch has survived thousands of randconfig builds and I
    don't see a remaining hole in the logic.
    
    Fixes: 3d4cf65e2d ("ASoC: omap: fix up SND_OMAP_SOC_OMAP_ABE_TWL6040 dependency")
    Signed-off-by: Arnd Bergmann <arnd@arndb.de>
    Acked-by: Peter Ujfalusi <peter.ujfalusi@ti.com>
    Signed-off-by: Mark Brown <broonie@kernel.org>

commit a2202a4c762bedb56bcaafd3200deceac1c2e7b5
Author: Linus Walleij <linus.walleij@linaro.org>
Date:   Wed May 20 09:11:23 2015 +0200

    pinctrl: mediatek: add OF dependency to MT6397
    
    X86_64 allmodconfig screams like so:
    warning: (PINCTRL_MT6397) selects PINCTRL_MTK_COMMON
    which has unmet direct dependencies
    (PINCTRL && (ARCH_MEDIATEK || COMPILE_TEST) && OF)
    
    So add OF to dependencies to shut up this warning.
    
    Cc: Hongzhou Yang <hongzhou.yang@mediatek.com>
    Signed-off-by: Linus Walleij <linus.walleij@linaro.org>

commit 638f958baeaf9d50f42cd09993f518b3a7a0f52e
Author: Geert Uytterhoeven <geert@linux-m68k.org>
Date:   Tue May 5 18:32:20 2015 +0200

    extcon: Allow compile test of GPIO consumers if !GPIOLIB
    
    The GPIO subsystem provides dummy GPIO consumer functions if GPIOLIB is
    not enabled. Hence drivers that depend on GPIOLIB, but use GPIO consumer
    functionality only, can still be compiled if GPIOLIB is not enabled.
    
    Relax the dependency on GPIOLIB if COMPILE_TEST is enabled, where
    appropriate.
    
    If GPIOLIB=n and asm-generic/gpio.h is not used:
    
        drivers/extcon/extcon-usb-gpio.c: In function usb_extcon_detect_cable:
        drivers/extcon/extcon-usb-gpio.c:63: error: implicit declaration of function gpiod_get_value_cansleep
        drivers/extcon/extcon-usb-gpio.c: In function usb_extcon_probe:
        drivers/extcon/extcon-usb-gpio.c:116: error: implicit declaration of function devm_gpiod_get
        drivers/extcon/extcon-usb-gpio.c:116: warning: assignment makes pointer from integer without a cast
        drivers/extcon/extcon-usb-gpio.c:122: error: implicit declaration of function gpiod_set_debounce
        drivers/extcon/extcon-usb-gpio.c:129: error: implicit declaration of function gpiod_to_irq
    
    Add the missing #include <linux/gpio/consumer.h> to fix this.
    
    Signed-off-by: Geert Uytterhoeven <geert@linux-m68k.org>
    Signed-off-by: Chanwoo Choi <cw00.choi@samsung.com>

commit 7c42eaf6c5eb6fad56a77d90c0e25da8be39948d
Author: Vineet Gupta <vgupta@synopsys.com>
Date:   Mon May 18 12:50:02 2015 +0530

    ARC: switch to simpler CROSS_COMPILE prefix
    
    ARC GNU tools have had support for arc-linux-* driver for some time now.
    This is functionally similar to arc-linux-uclibc-* but uclibc prefix
    seemed weird at best when trying to compile the kernel itself.
    
    Signed-off-by: Vineet Gupta <vgupta@synopsys.com>

commit d1e40e592678b8955a8ed36bdeaf42929822302e
Author: Eunbong Song <eunb.song@samsung.com>
Date:   Fri Apr 24 04:36:27 2015 +0000

    tools/liblockdep: Fix linker error in case of cross compile
    
    If we try to cross compile liblockdep, even if we set the CROSS_COMPILE variable
    the linker error can occur because LD is not set with CROSS_COMPILE.
    This patch adds "LD" can be set automatically with CROSS_COMPILE variable so
    fixes linker error problem.
    
    Signed-off-by: Eunbong Song <eunb.song@samsung.com>
    Signed-off-by: Sasha Levin <sasha.levin@oracle.com>

commit 1872d01ab4be0567ad6145070d9a5bee0f923b2f
Author: Tyler Baker <tyler.baker@linaro.org>
Date:   Tue Apr 21 15:51:45 2015 -0700

    selftest/x86: have no dependency on all when cross building
    
    If the CROSS_COMPILE is set remove all's dependency on all_32 and all_64.
    
    Cc: Andy Lutomirski <luto@amacapital.net>
    Acked-by: Andy Lutomirski <luto@kernel.org>
    Signed-off-by: Tyler Baker <tyler.baker@linaro.org>
    Signed-off-by: Shuah Khan <shuahkh@osg.samsung.com>

commit 7e5cd69a9152c70985ebf820e357da59dfa8f152
Author: Geert Uytterhoeven <geert@linux-m68k.org>
Date:   Tue May 5 18:32:22 2015 +0200

    i2c: Allow compile test of GPIO consumers if !GPIOLIB
    
    The GPIO subsystem provides dummy GPIO consumer functions if GPIOLIB is
    not enabled. Hence drivers that depend on GPIOLIB, but use GPIO consumer
    functionality only, can still be compiled if GPIOLIB is not enabled.
    
    Relax the dependency on GPIOLIB if COMPILE_TEST is enabled, where
    appropriate.
    
    Signed-off-by: Geert Uytterhoeven <geert@linux-m68k.org>
    Signed-off-by: Wolfram Sang <wsa@the-dreams.de>

commit e79c8385c878abdf90290cba6bea08fd60058562
Author: Michael Ellerman <mpe@ellerman.id.au>
Date:   Tue Apr 21 22:26:57 2015 +1000

    powerpc: Don't do gcc version checks if we're building with clang
    
    We have several checks for bad gcc versions in our Makefile. These don't
    apply if we're building with clang, so skip them in that case.
    
    The obvious check would be for ${COMPILER} = "gcc", but because of the
    way the logic in the top level Makefile conditionally sets COMPILER,
    it's possible that we're building with gcc but COMPILER was not set.
    
    So instead check for ${COMPILER} != "clang", which we know is currently
    the only other possibility.
    
    Signed-off-by: Michael Ellerman <mpe@ellerman.id.au>

commit 5af7a6f3e2d015dcaaeffa48c6d47238415cbe66
Author: Michael Ellerman <mpe@ellerman.id.au>
Date:   Fri Apr 10 11:52:06 2015 +1000

    powerpc/pasemi: Only the build the pasemi MSI code for PASEMI=y
    
    The pasemi MSI code is currently always built when MPIC=y && PCI_MSI=y.
    It should not have any effect on other platforms, because it immediately
    checks the MPIC's compatible property for "pasemi,pwrficient-openpic".
    
    However it's odd that it's still built even when PASEMI=n. It also
    needn't be in sysdev, as it's only used by pasemi. So move it into
    platforms/pasemi, whereby it will only be built for PASEMI=y.
    
    Signed-off-by: Michael Ellerman <mpe@ellerman.id.au>

commit 9291766476f3b067c740fe9cc0b4cd78ace27409
Author: Geert Uytterhoeven <geert@linux-m68k.org>
Date:   Tue May 5 18:32:36 2015 +0200

    Staging: iio: Allow compile test of GPIO consumers if !GPIOLIB
    
    The GPIO subsystem provides dummy GPIO consumer functions if GPIOLIB is
    not enabled. Hence drivers that depend on GPIOLIB, but use GPIO consumer
    functionality only, can still be compiled if GPIOLIB is not enabled.
    
    Relax the dependency on GPIOLIB if COMPILE_TEST is enabled, where
    appropriate.
    
    Signed-off-by: Geert Uytterhoeven <geert@linux-m68k.org>
    Cc: Jonathan Cameron <jic23@kernel.org>
    Cc: linux-iio@vger.kernel.org
    Cc: devel@driverdev.osuosl.org
    Signed-off-by: Jonathan Cameron <jic23@kernel.org>

commit 8493585317b1fe1ab7a334faac71fb1e36fde508
Author: Geert Uytterhoeven <geert@linux-m68k.org>
Date:   Tue May 5 18:32:23 2015 +0200

    iio: Allow compile test of GPIO consumers if !GPIOLIB
    
    The GPIO subsystem provides dummy GPIO consumer functions if GPIOLIB is
    not enabled. Hence drivers that depend on GPIOLIB, but use GPIO consumer
    functionality only, can still be compiled if GPIOLIB is not enabled.
    
    Relax the dependency on GPIOLIB if COMPILE_TEST is enabled, where
    appropriate.
    
    Signed-off-by: Geert Uytterhoeven <geert@linux-m68k.org>
    Cc: Jonathan Cameron <jic23@kernel.org>
    Cc: linux-iio@vger.kernel.org
    Signed-off-by: Jonathan Cameron <jic23@kernel.org>

commit db978e284781af641a02f9ca9d99a746e1e1f60f
Author: Geert Uytterhoeven <geert@linux-m68k.org>
Date:   Tue May 5 18:32:38 2015 +0200

    usb: phy: Allow compile test of GPIO consumers if !GPIOLIB
    
    The GPIO subsystem provides dummy GPIO consumer functions if GPIOLIB is
    not enabled. Hence drivers that depend on GPIOLIB, but use GPIO consumer
    functionality only, can still be compiled if GPIOLIB is not enabled.
    
    Relax the dependency on GPIOLIB if COMPILE_TEST is enabled, where
    appropriate.
    
    Signed-off-by: Geert Uytterhoeven <geert@linux-m68k.org>
    Cc: <linux-usb@vger.kernel.org>
    Signed-off-by: Felipe Balbi <balbi@ti.com>

commit 9eac5fdfabc67603fcdc5b59079ff6da90e17a16
Author: Geert Uytterhoeven <geert@linux-m68k.org>
Date:   Tue May 5 18:32:32 2015 +0200

    regulator: Allow compile test of GPIO consumers if !GPIOLIB
    
    The GPIO subsystem provides dummy GPIO consumer functions if GPIOLIB is
    not enabled. Hence drivers that depend on GPIOLIB, but use GPIO consumer
    functionality only, can still be compiled if GPIOLIB is not enabled.
    
    Relax the dependency on GPIOLIB if COMPILE_TEST is enabled, where
    appropriate.
    
    Signed-off-by: Geert Uytterhoeven <geert@linux-m68k.org>
    Signed-off-by: Mark Brown <broonie@kernel.org>

commit 5c2301a990f166e095a134e25644f845abaf6168
Author: Geert Uytterhoeven <geert@linux-m68k.org>
Date:   Tue May 5 18:32:33 2015 +0200

    spi: Allow compile test of GPIO consumers if !GPIOLIB
    
    The GPIO subsystem provides dummy GPIO consumer functions if GPIOLIB is
    not enabled. Hence drivers that depend on GPIOLIB, but use GPIO consumer
    functionality only, can still be compiled if GPIOLIB is not enabled.
    
    Relax the dependency on GPIOLIB if COMPILE_TEST is enabled, where
    appropriate.
    
    Signed-off-by: Geert Uytterhoeven <geert@linux-m68k.org>
    Signed-off-by: Mark Brown <broonie@kernel.org>

commit 29ea3ac109960d5e354f55c81a8e62dbb01779c0
Author: Lars-Peter Clausen <lars@metafoo.de>
Date:   Sun May 3 20:13:35 2015 +0200

    ASoC: samsung: wolfson: Improve compile test coverage
    
    While the the Wolfson machine drivers have a runtime dependency on a
    specific machine there is no compile time dependency. Allow to lets those
    drivers to be selected when COMPILE_TEST is selected to improve the compile
    time test coverage.
    
    Signed-off-by: Lars-Peter Clausen <lars@metafoo.de>
    Acked-by: Charles Keepax <ckeepax@opensource.wolfsonmicro.com>
    Signed-off-by: Mark Brown <broonie@kernel.org>

commit d5e7963fdf52ba609f960466fb864ce81966cd17
Author: Marc Zyngier <marc.zyngier@arm.com>
Date:   Fri Oct 18 18:19:03 2013 +0100

    arm/arm64: KVM: PSCI: use MPIDR to identify a target CPU
    
    commit 79c648806f9034abf54332b78043bb242189d953 upstream.
    
    The KVM PSCI code blindly assumes that vcpu_id and MPIDR are
    the same thing. This is true when vcpus are organized as a flat
    topology, but is wrong when trying to emulate any other topology
    (such as A15 clusters).
    
    Change the KVM PSCI CPU_ON code to look at the MPIDR instead
    of the vcpu_id to pick a target CPU.
    
    Signed-off-by: Marc Zyngier <marc.zyngier@arm.com>
    Signed-off-by: Christoffer Dall <christoffer.dall@linaro.org>
    Signed-off-by: Shannon Zhao <shannon.zhao@linaro.org>
    Signed-off-by: Jiri Slaby <jslaby@suse.cz>

commit 3925ae28c4489b87dc4a515716172c1a3a1d2363
Author: Marc Zyngier <marc.zyngier@arm.com>
Date:   Mon Mar 23 15:03:28 2015 +0800

    ARM: KVM: Fix MPIDR computing to support virtual clusters
    
    commit 2d1d841bd44e24b58a3d3cc4fa793670aaa38fbf upstream.
    
    In order to be able to support more than 4 A7 or A15 CPUs,
    we need to fix the MPIDR computing to reflect the fact that
    both A15 and A7 can only exist in clusters of at most 4 CPUs.
    
    Fix the MPIDR computing to allow virtual clusters to be exposed
    to the guest.
    
    Signed-off-by: Marc Zyngier <marc.zyngier@arm.com>
    Signed-off-by: Christoffer Dall <christoffer.dall@linaro.org>
    Signed-off-by: Shannon Zhao <shannon.zhao@linaro.org>
    Signed-off-by: Jiri Slaby <jslaby@suse.cz>

commit 45aaf85687dd6ac119c55c5ec0dbe0bef0e62235
Author: Jonathan Austin <jonathan.austin@arm.com>
Date:   Thu Sep 26 16:49:27 2013 +0100

    KVM: ARM: Fix calculation of virtual CPU ID
    
    commit 1158fca401e09665c440a9fe4fd4f131ee85c13b upstream.
    
    KVM does not have a notion of multiple clusters for CPUs, just a linear
    array of CPUs. When using a system with cores in more than one cluster, the
    current method for calculating the virtual MPIDR will leak the (physical)
    cluster information into the virtual MPIDR. One effect of this is that
    Linux under KVM fails to boot multiple CPUs that aren't in the 0th cluster.
    
    This patch does away with exposing the real MPIDR fields in favour of simply
    using the virtual CPU number (but preserving the U bit, as before).
    
    Signed-off-by: Jonathan Austin <jonathan.austin@arm.com>
    Acked-by: Marc Zyngier <marc.zyngier@arm.com>
    Signed-off-by: Christoffer Dall <christoffer.dall@linaro.org>
    Signed-off-by: Shannon Zhao <shannon.zhao@linaro.org>
    Signed-off-by: Jiri Slaby <jslaby@suse.cz>

commit ee4eb20dbce91751c248399e8a0cf9b8813adf5a
Author: Paul Cercueil <paul@crapouillou.net>
Date:   Fri Apr 17 23:35:04 2015 +0200

    Makefile: Fix detection of clang when cross-compiling
    
    When the host's C compiler is clang, and when attempting to
    cross-compile Linux e.g. to MIPS with mipsel-linux-gcc, the Makefile
    would incorrectly detect the use of clang, which resulted in
    clang-specific flags being passed to mipsel-linux-gcc.
    
    This can be verified under Debian by installing the "clang" package,
    and then using it as the default compiler with:
    sudo update-alternatives --config cc
    
    This patch moves the detection of clang after the $(CC) variable is
    initialized to the name of the cross-compiler, so that the check applies
    to the cross-compiler and not the host's C compiler.
    
    v2: Move the detection of clang after the inclusion of the
    arch/*/Makefile (as they might set $(CROSS_COMPILE))
    
    Signed-off-by: Paul Cercueil <paul@crapouillou.net>
    Signed-off-by: Michal Marek <mmarek@suse.cz>

commit 36a8032d77649430f5ef11fbf0df2bb026be0b04
Merge: 7f9f44308c89 96cba9b00e29
Author: Linus Torvalds <torvalds@linux-foundation.org>
Date:   Sun Apr 26 13:36:02 2015 -0700

    Merge tag 'chrome-for-linus' of git://git.kernel.org/pub/scm/linux/kernel/git/olof/chrome-platform
    
    Pull chrome platform updates from Olof Johansson:
     "Here's a set of updates to the Chrome OS platform drivers for this
      merge window.
    
      Main new things this cycle is:
    
       - Driver changes to expose the lightbar to users.  With this, you can
         make your own blinkenlights on Chromebook Pixels.
    
       - Changes in the way that the atmel_mxt trackpads are probed.  The
         laptop driver is trying to be smart and not instantiate the devices
         that don't answer to probe.  For the trackpad that can come up in
         two modes (bootloader or regular), this gets complicated since the
         driver already knows how to handle the two modes including the
         actual addresses used.  So now the laptop driver needs to know more
         too, instantiating the regular address even if the bootloader one
         is the probe that passed.
    
       - mfd driver improvements by Javier Martines Canillas, and a few
         bugfixes from him, kbuild and myself"
    
    * tag 'chrome-for-linus' of git://git.kernel.org/pub/scm/linux/kernel/git/olof/chrome-platform:
      platform/chrome: chromeos_laptop - instantiate Atmel at primary address
      platform/chrome: cros_ec_lpc - Depend on X86 || COMPILE_TEST
      platform/chrome: cros_ec_lpc - Include linux/io.h header file
      platform/chrome: fix platform_no_drv_owner.cocci warnings
      platform/chrome: cros_ec_lightbar - fix duplicate const warning
      platform/chrome: cros_ec_dev - fix Unknown escape '%' warning
      platform/chrome: Expose Chrome OS Lightbar to users
      platform/chrome: Create sysfs attributes for the ChromeOS EC
      mfd: cros_ec: Instantiate ChromeOS EC character device
      platform/chrome: Add Chrome OS EC userspace device interface
      platform/chrome: Add cros_ec_lpc driver for x86 devices
      mfd: cros_ec: Add char dev and virtual dev pointers
      mfd: cros_ec: Use fixed size arrays to transfer data with the EC

commit 6e54abac1b8e0b7febffdbad37b605daef1cfcff
Author: Andrey Ryabinin <a.ryabinin@samsung.com>
Date:   Thu Apr 16 12:44:58 2015 -0700

    kasan: Makefile: shut up warnings if CONFIG_COMPILE_TEST=y
    
    It might be annoying to constantly see this:
    
            scripts/Makefile.kasan:16: Cannot use CONFIG_KASAN: -fsanitize=kernel-address is not supported by compiler
    
    while performing allmodconfig/allyesconfig build tests.
    Disable this warning if CONFIG_COMPILE_TEST=y.
    
    Signed-off-by: Andrey Ryabinin <a.ryabinin@samsung.com>
    Cc: Michal Marek <mmarek@suse.cz>
    Signed-off-by: Andrew Morton <akpm@linux-foundation.org>
    Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>

commit 42e3a58b028e0e51746f596a11abfec01cd1c5c4
Merge: 4fd48b45ffc4 00fe52deb45b
Author: Linus Torvalds <torvalds@linux-foundation.org>
Date:   Mon Apr 13 17:07:21 2015 -0700

    Merge tag 'usb-4.1-rc1' of git://git.kernel.org/pub/scm/linux/kernel/git/gregkh/usb
    
    Pull USB driver updates from Greg KH:
     "Here's the big USB (and PHY) driver patchset for 4.1-rc1.
    
      Everything here has been in linux-next, and the full details are below
      in the shortlog.  Nothing major, just the normal round of new
      drivers,api updates, and other changes, mostly in the USB gadget area,
      as usual"
    
    * tag 'usb-4.1-rc1' of git://git.kernel.org/pub/scm/linux/kernel/git/gregkh/usb: (252 commits)
      drivers/usb/core: devio.c: Removed an uneeded space before tab
      usb: dwc2: host: sleep USB_RESUME_TIMEOUT during resume
      usb: chipidea: debug: add low power mode check before print registers
      usb: chipidea: udc: bypass pullup DP when gadget connect in OTG fsm mode
      usb: core: hub: use new USB_RESUME_TIMEOUT
      usb: isp1760: hcd: use new USB_RESUME_TIMEOUT
      usb: dwc2: hcd: use new USB_RESUME_TIMEOUT
      usb: host: sl811: use new USB_RESUME_TIMEOUT
      usb: host: r8a66597: use new USB_RESUME_TIMEOUT
      usb: host: oxu210hp: use new USB_RESUME_TIMEOUT
      usb: host: fusbh200: use new USB_RESUME_TIMEOUT
      usb: host: fotg210: use new USB_RESUME_TIMEOUT
      usb: host: isp116x: use new USB_RESUME_TIMEOUT
      usb: musb: use new USB_RESUME_TIMEOUT
      usb: host: uhci: use new USB_RESUME_TIMEOUT
      usb: host: ehci: use new USB_RESUME_TIMEOUT
      usb: host: xhci: use new USB_RESUME_TIMEOUT
      usb: define a generic USB_RESUME_TIMEOUT macro
      usb: musb: dsps: fix build on i386 when COMPILE_TEST is set
      ehci-hub: use USB_DT_HUB
      ...

commit 4541fec3104bef0c60633f9e180be94ea5ccc2b7
Merge: 39a8804455fb 2bfd4d1f8c2b
Author: Linus Torvalds <torvalds@linux-foundation.org>
Date:   Mon Apr 13 08:59:21 2015 -0700

    Merge tag 'linux-kselftest-4.1-rc1' of git://git.kernel.org/pub/scm/linux/kernel/git/shuah/linux-kselftest
    
    Pull kselftest updates from Shuah Khan:
     "This is a milestone update in a sense.  Several new tests and install
      and packaging support is added in this update.
    
      This update adds install and packaging tools developed on top of
      back-end shared logic enhancemnets to run and install tests.  In
      addition several timer tests are added.
    
       - New timer tests from John Stultz
    
       - rtc test from Prarit Bhargava
    
       - Enhancements to un and install tests from Michael Ellerman
    
       - Install and packaging tools from Shuah Khan
    
       - Cross-compilation enablement from Tyler Baker
    
       - A couple of bug fixes"
    
    * tag 'linux-kselftest-4.1-rc1' of git://git.kernel.org/pub/scm/linux/kernel/git/shuah/linux-kselftest: (42 commits)
      ftracetest: Do not use usleep directly
      selftest/mqueue: enable cross compilation
      selftest/ipc: enable cross compilation
      selftest/memfd: include default header install path
      selftest/mount: enable cross compilation
      selftest/memfd: enable cross compilation
      kselftests: timers: Make set-timer-lat fail more gracefully for !CAP_WAKE_ALARM
      selftests: Change memory on-off-test.sh name to be unique
      selftests: change cpu on-off-test.sh name to be unique
      selftests/mount: Make git ignore all binaries in mount test suite
      kselftests: timers: Reduce default runtime on inconsistency-check and set-timer-lat
      ftracetest: Convert exit -1 to exit $FAIL
      ftracetest: Cope properly with stack tracer not being enabled
      tools, update rtctest.c to verify passage of time
      Documentation, split up rtc.txt into documentation and test file
      selftests: Add tool to generate kselftest tar archive
      selftests: Add kselftest install tool
      selftests: Set CC using CROSS_COMPILE once in lib.mk
      selftests: Add install support for the powerpc tests
      selftests/timers: Use shared logic to run and install tests
      ...

commit ada602b30e070e786caa6e14a2e17100c6bd6998
Author: Lars-Peter Clausen <lars@metafoo.de>
Date:   Sat Apr 11 11:16:19 2015 +0200

    ASoC: atmel: Improve machine driver compile test coverage
    
    The Atmel ASoC machine drivers don't have any compile time arch dependencies
    anymore. Make it possible to select them when COMPILE_TEST is enabled to get
    better compile test coverage.
    
    Signed-off-by: Lars-Peter Clausen <lars@metafoo.de>
    Signed-off-by: Mark Brown <broonie@kernel.org>

commit d30323f810e4da94eb75cf4bfe5165b9518c64df
Author: Tony Lindgren <tony@atomide.com>
Date:   Wed Mar 25 14:18:37 2015 -0700

    usb: musb: dsps: fix build on i386 when COMPILE_TEST is set
    
    Commit 3e457371f436 ("usb: musb: Fix fifo reads for dm816x with musb_dsps")
    fixed a USB error on dm816x, but introduced a new build error on i386
    when COMPILE_TEST is set:
    
    drivers/usb/musb/musb_dsps.c: In function dsps_read_fifo32:
    drivers/usb/musb/musb_dsps.c:624:3: error: implicit declaration of function
    readsl [-Werror=implicit-function-declaration]
    readsl(fifo, dst, len >> 2);
    
    Let's fix this by using ioread32_rep() instead of readsl() as that's
    more portable.
    
    Fixes: 3e457371f436 ("usb: musb: Fix fifo reads for dm816x with musb_dsps")
    Reported-by: Fengguang Wu <fengguang.wu@intel.com>
    Cc: Bin Liu <binmlist@gmail.com>
    Cc: Brian Hutchinson <b.hutchman@gmail.com>
    Cc: George Cherian <george.cherian@ti.com>
    Cc: Sergei Shtylyov <sergei.shtylyov@cogentembedded.com>
    Signed-off-by: Tony Lindgren <tony@atomide.com>
    Signed-off-by: Felipe Balbi <balbi@ti.com>
    Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>

commit 0d8e1d80bbe9852f42784072880df002534c6e0f
Author: Gregory CLEMENT <gregory.clement@free-electrons.com>
Date:   Mon Mar 30 16:04:37 2015 +0200

    irqchip: armada-370-xp: Allow using wakeup source
    
    On the Armada 370/XP SoCs, in standby mode the SoC stay powered and it
    is possible to wake-up from any interrupt sources. This patch adds
    flag to the MPIC irqchip driver to let linux know this.
    
    Signed-off-by: Gregory CLEMENT <gregory.clement@free-electrons.com>
    Link: https://lkml.kernel.org/r/1427724278-12379-5-git-send-email-gregory.clement@free-electrons.com
    Signed-off-by: Jason Cooper <jason@lakedaemon.net>

commit 56302c53d3dc477b8360954fc92c1dfc4fc0ec54
Author: Bogdan Purcareata <bogdan.purcareata@freescale.com>
Date:   Tue Mar 24 10:43:43 2015 +0000

    powerpc/mpic: Remove WHOAMI readback after EOI
    
    After previous discussions regarding the subject [1][2], there's no clear
    explanation or reason why the call was needed in the first place. The sensible
    argument is some sort of synchronization between the CPU and the MPIC, which
    hasn't been pointed out precisely and is no longer required (at least on BookE
    platforms).
    
    The benefit of this change is saving a MMIO trap per interrupt when running in a
    KVM guest.
    
    [1] https://patchwork.ozlabs.org/patch/429098/
    [2] https://patchwork.ozlabs.org/patch/433557/
    
    Signed-off-by: Bogdan Purcareata <bogdan.purcareata@freescale.com>
    Signed-off-by: Scott Wood <scottwood@freescale.com>

commit 016958bf0577daa731bf0fc84aaa8a47d2dd705d
Author: Maxime Ripard <maxime.ripard@free-electrons.com>
Date:   Tue Mar 3 11:27:23 2015 +0100

    irqchip: armada-370-xp: Fix chained per-cpu interrupts
    
    [ Upstream commit 5724be8464dceac047c1eaddaa3651cea0ec16ca ]
    
    On the Cortex-A9-based Armada SoCs, the MPIC is not the primary interrupt
    controller. Yet, it still has to handle some per-cpu interrupt.
    
    To do so, it is chained with the GIC using a per-cpu interrupt. However, the
    current code only call irq_set_chained_handler, which is called and enable that
    interrupt only on the boot CPU, which means that the parent per-CPU interrupt
    is never unmasked on the secondary CPUs, preventing the per-CPU interrupt to
    actually work as expected.
    
    This was not seen until now since the only MPIC PPI users were the Marvell
    timers that were not working, but not used either since the system use the ARM
    TWD by default, and the ethernet controllers, that are faking there interrupts
    as SPI, and don't really expect to have interrupts on the secondary cores
    anyway.
    
    Add a CPU notifier that will enable the PPI on the secondary cores when they
    are brought up.
    
    Cc: <stable@vger.kernel.org> # 3.15+
    Signed-off-by: Maxime Ripard <maxime.ripard@free-electrons.com>
    Acked-by: Gregory CLEMENT <gregory.clement@free-electrons.com>
    Link: https://lkml.kernel.org/r/1425378443-28822-1-git-send-email-maxime.ripard@free-electrons.com
    Signed-off-by: Jason Cooper <jason@lakedaemon.net>
    Signed-off-by: Sasha Levin <sasha.levin@oracle.com>

commit 020295b4cb5b7d510ea1f4531a502c3f8a2380c5
Author: Hanjun Guo <hanjun.guo@linaro.org>
Date:   Tue Mar 24 14:02:47 2015 +0000

    ACPI / processor: Make it possible to get CPU hardware ID via GICC
    
    Introduce a new function map_gicc_mpidr() to allow MPIDRs to be obtained
    from the GICC Structure introduced by ACPI 5.1, since MPIDR for ARM64 is
    64-bit, so typedef u64 for phys_cpuid_t.
    
    The ARM architecture defines the MPIDR register as the CPU hardware
    identifier. This patch adds the code infrastructure to retrieve the MPIDR
    values from the ARM ACPI GICC structure in order to look-up the kernel CPU
    hardware ids required by the ACPI core code to identify CPUs.
    
    CC: Rafael J. Wysocki <rjw@rjwysocki.net>
    CC: Catalin Marinas <catalin.marinas@arm.com>
    CC: Will Deacon <will.deacon@arm.com>
    Tested-by: Suravee Suthikulpanit <Suravee.Suthikulpanit@amd.com>
    Tested-by: Yijing Wang <wangyijing@huawei.com>
    Tested-by: Mark Langsdorf <mlangsdo@redhat.com>
    Tested-by: Jon Masters <jcm@redhat.com>
    Tested-by: Timur Tabi <timur@codeaurora.org>
    Tested-by: Robert Richter <rrichter@cavium.com>
    Acked-by: Robert Richter <rrichter@cavium.com>
    Acked-by: Lorenzo Pieralisi <lorenzo.pieralisi@arm.com>
    Acked-by: Rafael J. Wysocki <rafael.j.wysocki@intel.com>
    Reviewed-by: Grant Likely <grant.likely@linaro.org>
    Signed-off-by: Hanjun Guo <hanjun.guo@linaro.org>
    Signed-off-by: Will Deacon <will.deacon@arm.com>

commit 940f85f84864efa1d2ae1ddd9aeac287f619cf2e
Author: Maxime Ripard <maxime.ripard@free-electrons.com>
Date:   Tue Mar 3 11:27:23 2015 +0100

    irqchip: armada-370-xp: Fix chained per-cpu interrupts
    
    commit 5724be8464dceac047c1eaddaa3651cea0ec16ca upstream.
    
    On the Cortex-A9-based Armada SoCs, the MPIC is not the primary interrupt
    controller. Yet, it still has to handle some per-cpu interrupt.
    
    To do so, it is chained with the GIC using a per-cpu interrupt. However, the
    current code only call irq_set_chained_handler, which is called and enable that
    interrupt only on the boot CPU, which means that the parent per-CPU interrupt
    is never unmasked on the secondary CPUs, preventing the per-CPU interrupt to
    actually work as expected.
    
    This was not seen until now since the only MPIC PPI users were the Marvell
    timers that were not working, but not used either since the system use the ARM
    TWD by default, and the ethernet controllers, that are faking there interrupts
    as SPI, and don't really expect to have interrupts on the secondary cores
    anyway.
    
    Add a CPU notifier that will enable the PPI on the secondary cores when they
    are brought up.
    
    Signed-off-by: Maxime Ripard <maxime.ripard@free-electrons.com>
    Acked-by: Gregory CLEMENT <gregory.clement@free-electrons.com>
    Link: https://lkml.kernel.org/r/1425378443-28822-1-git-send-email-maxime.ripard@free-electrons.com
    Signed-off-by: Jason Cooper <jason@lakedaemon.net>
    Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>

commit fccb9a81fd08b61bed91ddef88341694f8ecbfd1
Author: Hanjun Guo <hanjun.guo@linaro.org>
Date:   Tue Mar 24 22:02:45 2015 +0800

    ARM64 / ACPI: Parse MADT for SMP initialization
    
    MADT contains the information for MPIDR which is essential for
    SMP initialization, parse the GIC cpu interface structures to
    get the MPIDR value and map it to cpu_logical_map(), and add
    enabled cpu with valid MPIDR into cpu_possible_map.
    
    ACPI 5.1 only has two explicit methods to boot up SMP, PSCI and
    Parking protocol, but the Parking protocol is only specified for
    ARMv7 now, so make PSCI as the only way for the SMP boot protocol
    before some updates for the ACPI spec or the Parking protocol spec.
    
    Parking protocol patches for SMP boot will be sent to upstream when
    the new version of Parking protocol is ready.
    
    CC: Lorenzo Pieralisi <lorenzo.pieralisi@arm.com>
    CC: Catalin Marinas <catalin.marinas@arm.com>
    CC: Will Deacon <will.deacon@arm.com>
    CC: Mark Rutland <mark.rutland@arm.com>
    Tested-by: Suravee Suthikulpanit <Suravee.Suthikulpanit@amd.com>
    Tested-by: Yijing Wang <wangyijing@huawei.com>
    Tested-by: Mark Langsdorf <mlangsdo@redhat.com>
    Tested-by: Jon Masters <jcm@redhat.com>
    Tested-by: Timur Tabi <timur@codeaurora.org>
    Tested-by: Robert Richter <rrichter@cavium.com>
    Acked-by: Robert Richter <rrichter@cavium.com>
    Acked-by: Olof Johansson <olof@lixom.net>
    Reviewed-by: Grant Likely <grant.likely@linaro.org>
    Signed-off-by: Hanjun Guo <hanjun.guo@linaro.org>
    Signed-off-by: Tomasz Nowicki <tomasz.nowicki@linaro.org>
    Signed-off-by: Will Deacon <will.deacon@arm.com>

commit 4c1c8d7a7ebc8b909493a14b21b233e5377b69aa
Author: Hanjun Guo <hanjun.guo@linaro.org>
Date:   Tue Mar 24 14:02:44 2015 +0000

    ACPI / table: Print GIC information when MADT is parsed
    
    When MADT is parsed, print GIC information as debug message:
    
    ACPI: GICC (acpi_id[0x0000] address[00000000e112f000] MPIDR[0x0] enabled)
    ACPI: GICC (acpi_id[0x0001] address[00000000e112f000] MPIDR[0x1] enabled)
    ...
    ACPI: GICC (acpi_id[0x0201] address[00000000e112f000] MPIDR[0x201] enabled)
    
    This debug information will be very helpful to bring up early systems to
    see if acpi_id and MPIDR are matched or not as spec defined.
    
    CC: Rafael J. Wysocki <rjw@rjwysocki.net>
    Tested-by: Suravee Suthikulpanit <Suravee.Suthikulpanit@amd.com>
    Tested-by: Yijing Wang <wangyijing@huawei.com>
    Tested-by: Mark Langsdorf <mlangsdo@redhat.com>
    Tested-by: Jon Masters <jcm@redhat.com>
    Tested-by: Timur Tabi <timur@codeaurora.org>
    Tested-by: Robert Richter <rrichter@cavium.com>
    Acked-by: Robert Richter <rrichter@cavium.com>
    Acked-by: Sudeep Holla <sudeep.holla@arm.com>
    Acked-by: Rafael J. Wysocki <rafael.j.wysocki@intel.com>
    Acked-by: Lorenzo Pieralisi <lorenzo.pieralisi@arm.com>
    Acked-by: Grant Likely <grant.likely@linaro.org>
    Signed-off-by: Hanjun Guo <hanjun.guo@linaro.org>
    Signed-off-by: Tomasz Nowicki <tomasz.nowicki@linaro.org>
    Signed-off-by: Will Deacon <will.deacon@arm.com>

commit 37655163ce1a3ef2635a9bba0ad614f25e01484e
Author: Al Stone <al.stone@linaro.org>
Date:   Tue Mar 24 14:02:37 2015 +0000

    ARM64 / ACPI: Get RSDP and ACPI boot-time tables
    
    As we want to get ACPI tables to parse and then use the information
    for system initialization, we should get the RSDP (Root System
    Description Pointer) first, it then locates Extended Root Description
    Table (XSDT) which contains all the 64-bit physical address that
    pointer to other boot-time tables.
    
    Introduce acpi.c and its related head file in this patch to provide
    fundamental needs of extern variables and functions for ACPI core,
    and then get boot-time tables as needed.
      - asm/acenv.h for arch specific ACPICA environments and
        implementation, It is needed unconditionally by ACPI core;
      - asm/acpi.h for arch specific variables and functions needed by
        ACPI driver core;
      - acpi.c for ARM64 related ACPI implementation for ACPI driver
        core;
    
    acpi_boot_table_init() is introduced to get RSDP and boot-time tables,
    it will be called in setup_arch() before paging_init(), so we should
    use eary_memremap() mechanism here to get the RSDP and all the table
    pointers.
    
    FADT Major.Minor version was introduced in ACPI 5.1, it is the same
    as ACPI version.
    
    In ACPI 5.1, some major gaps are fixed for ARM, such as updates in
    MADT table for GIC and SMP init, without those updates, we can not
    get the MPIDR for SMP init, and GICv2/3 related init information, so
    we can't boot arm64 ACPI properly with table versions predating 5.1.
    
    If firmware provides ACPI tables with ACPI version less than 5.1,
    OS has no way to retrieve the configuration data that is necessary
    to init SMP boot protocol and the GIC properly, so disable ACPI if
    we get an FADT table with version less that 5.1 when acpi_boot_table_init()
    called.
    
    CC: Catalin Marinas <catalin.marinas@arm.com>
    CC: Will Deacon <will.deacon@arm.com>
    CC: Lorenzo Pieralisi <lorenzo.pieralisi@arm.com>
    Tested-by: Suravee Suthikulpanit <Suravee.Suthikulpanit@amd.com>
    Tested-by: Yijing Wang <wangyijing@huawei.com>
    Tested-by: Mark Langsdorf <mlangsdo@redhat.com>
    Tested-by: Jon Masters <jcm@redhat.com>
    Tested-by: Timur Tabi <timur@codeaurora.org>
    Tested-by: Robert Richter <rrichter@cavium.com>
    Acked-by: Robert Richter <rrichter@cavium.com>
    Acked-by: Olof Johansson <olof@lixom.net>
    Acked-by: Grant Likely <grant.likely@linaro.org>
    Signed-off-by: Al Stone <al.stone@linaro.org>
    Signed-off-by: Graeme Gregory <graeme.gregory@linaro.org>
    Signed-off-by: Tomasz Nowicki <tomasz.nowicki@linaro.org>
    Signed-off-by: Hanjun Guo <hanjun.guo@linaro.org>
    Signed-off-by: Will Deacon <will.deacon@arm.com>

commit ff015659b631621fc9d60403a5dfbdf72c1cd058
Author: Hongtao Jia <hongtao.jia@freescale.com>
Date:   Thu Feb 26 15:23:08 2015 +0800

    powerpc/85xx: workaround for chips with MSI hardware errata
    
    The MPIC version 2.0 has a MSI errata (errata PIC1 of mpc8544), It causes
    that neither MSI nor MSI-X can work fine. This is a workaround to allow
    MSI-X to function properly.
    
    Signed-off-by: Liu Shuo <soniccat.liu@gmail.com>
    Signed-off-by: Li Yang <leoli@freescale.com>
    Signed-off-by: Jia Hongtao <hongtao.jia@freescale.com>
    Signed-off-by: Scott Wood <scottwood@freescale.com>

commit 807d38b73b63bbbaa8e1baacf76f7874992f91e8
Author: Hongtao Jia <hongtao.jia@freescale.com>
Date:   Wed Apr 10 10:52:55 2013 +0800

    powerpc/mpic: Add get_version API both for internal and external use
    
    MPIC version is useful information for both mpic_alloc() and mpic_init().
    The patch provide an API to get MPIC version for reusing the code.
    Also, some other IP block may need MPIC version for their own use.
    The API for external use is also provided.
    
    This function had been previously added but was removed by commit
    5e86bfde9cd93f2 ("powerpc/mpic: remove unused functions") due to the
    lack of a user.  This function will be used by "powerpc/mpic: Add
    get_version API both for internal and external use".
    
    Signed-off-by: Jia Hongtao <hongtao.jia@freescale.com>
    Signed-off-by: Li Yang <leoli@freescale.com>
    [scottwood@freescale.com: changelog update]
    Signed-off-by: Scott Wood <scottwood@freescale.com>

commit 5a8b9eaa1c4e9b41a013393b45138bbe97f8d7bd
Author: Maxime Ripard <maxime.ripard@free-electrons.com>
Date:   Tue Mar 3 11:27:23 2015 +0100

    irqchip: armada-370-xp: Fix chained per-cpu interrupts
    
    commit 5724be8464dceac047c1eaddaa3651cea0ec16ca upstream.
    
    On the Cortex-A9-based Armada SoCs, the MPIC is not the primary interrupt
    controller. Yet, it still has to handle some per-cpu interrupt.
    
    To do so, it is chained with the GIC using a per-cpu interrupt. However, the
    current code only call irq_set_chained_handler, which is called and enable that
    interrupt only on the boot CPU, which means that the parent per-CPU interrupt
    is never unmasked on the secondary CPUs, preventing the per-CPU interrupt to
    actually work as expected.
    
    This was not seen until now since the only MPIC PPI users were the Marvell
    timers that were not working, but not used either since the system use the ARM
    TWD by default, and the ethernet controllers, that are faking there interrupts
    as SPI, and don't really expect to have interrupts on the secondary cores
    anyway.
    
    Add a CPU notifier that will enable the PPI on the secondary cores when they
    are brought up.
    
    Signed-off-by: Maxime Ripard <maxime.ripard@free-electrons.com>
    Acked-by: Gregory CLEMENT <gregory.clement@free-electrons.com>
    Link: https://lkml.kernel.org/r/1425378443-28822-1-git-send-email-maxime.ripard@free-electrons.com
    Signed-off-by: Jason Cooper <jason@lakedaemon.net>
    Signed-off-by: Luis Henriques <luis.henriques@canonical.com>

commit 84f887bfb930e7fbc01c060edd68c7cc6e2b824b
Author: Michael Ellerman <mpe@ellerman.id.au>
Date:   Wed Mar 4 21:41:31 2015 +1100

    selftests: Set CC using CROSS_COMPILE once in lib.mk
    
    This avoids repeating the logic in every Makefile. We mimic the
    top-level Makefile and use $(CROSS_COMPILE)gcc.
    
    Signed-off-by: Michael Ellerman <mpe@ellerman.id.au>
    Signed-off-by: Shuah Khan <shuahkh@osg.samsung.com>

commit 6faeeea44b84ce24fc6c1f1beb07ee5de9885dc8
Author: Michael Ellerman <mpe@ellerman.id.au>
Date:   Wed Mar 11 15:06:01 2015 +1100

    selftests: Add install support for the powerpc tests
    
    The bulk of the selftests are actually below the powerpc sub directory.
    
    This adds support for installing them, when on a powerpc machine, or if
    ARCH and CROSS_COMPILE are set appropriately.
    
    This is a little more complicated because of the sub directory structure
    under powerpc, but much of the common logic in lib.mk is still used. The
    net effect of the patch is still a reduction in code.
    
    Signed-off-by: Michael Ellerman <mpe@ellerman.id.au>
    Signed-off-by: Shuah Khan <shuahkh@osg.samsung.com>

commit 4a8ade1f6bb19208f0457afcf07dcaf2fb031f57
Author: Yingjoe Chen <yingjoe.chen@mediatek.com>
Date:   Fri Mar 13 22:40:52 2015 +0800

    pinctrl: mediatek: Adjust mt8173 pinctrl kconfig
    
    ARM64 maintainer doesn't want to add MACH_* for each SoC.
    Adjust mt8173 pinctrl kconfig entry so user can manually select it.
    
    Also make PINCTRL_MT8135 selectable when COMPILE_TEST is enabled.
    
    Signed-off-by: Yingjoe Chen <yingjoe.chen@mediatek.com>
    Signed-off-by: Linus Walleij <linus.walleij@linaro.org>

commit 03438212d0b0ea2cf201e921c9056f683c624ffb
Author: John Stultz <john.stultz@linaro.org>
Date:   Wed Mar 11 17:39:57 2015 -0700

    selftests/timers: Cleanup Makefile to make it easier to add future tests
    
    Try to streamline the makefile so its easier to add timer/timekeeping
    tests.
    
    Also adds support for the CROSS_COMPILE variable.
    
    Cc: Shuah Khan <shuahkh@osg.samsung.com>
    Cc: Prarit Bhargava <prarit@redhat.com>
    Cc: Thomas Gleixner <tglx@linutronix.de>
    Cc: Richard Cochran <richardcochran@gmail.com>
    Signed-off-by: John Stultz <john.stultz@linaro.org>
    Tested-by: Prarit Bhargava <prarit@redhat.com>
    Signed-off-by: Shuah Khan <shuahkh@osg.samsung.com>

commit 094a29d023b9ef0947bdc98e8cfeafe6219eb00a
Merge: 4d0b756ec748 538da83ddbea
Author: Arnd Bergmann <arnd@arndb.de>
Date:   Wed Mar 11 22:53:16 2015 +0100

    Merge tag 'mvebu-dt-4.1' of git://git.infradead.org/linux-mvebu into next/dt
    
    Pull "mvebu dt changes for v4.1 (part #1)" from Gregory CLEMENT:
    
    - fix SDHCI nodes on Armada 38x
    - add Linksys WRT1900AC (Mamba) support (including the Ethernet switch)
    - add several fixes and improvement for dove
    - enable GPIO fan alarm support for 2Big Network v2
    - add several fixes about unit address
    - add support for Armada 39x SoC and board
    
    * tag 'mvebu-dt-4.1' of git://git.infradead.org/linux-mvebu:
      ARM: mvebu: add Device Tree files for Armada 39x SoC and board
      ARM: mvebu: fix unit address of MPIC nodes
      ARM: mvebu: use stdout-path in all armada-*.dts
      ARM: mvebu: add serial port aliases on Armada 370/375/38x/XP
      ARM: mvebu: remove aliases for Ethernet devices on Armada 370/375/38x/XP
      ARM: mvebu: add UART labels to Armada 375
      ARM: mvebu: add missing UART labels on Armada 38x
      ARM: mvebu: fix usb@ unit address on Armada 38x to match register address
      ARM: mvebu: a385-db-ap: Enable the NAND
      ARM: ARMADA XP: WRT1900AC: Add support for the Ethernet switch
      ARM: Kirkwood: enable GPIO fan alarm support for 2Big Network v2
      ARM: mvebu: Fix MPIC unit address
      ARM: dts: dove: Add some more common pinctrl settings
      ARM: dts: dove: Add node labels for PCIe ports 0 and 1
      ARM: dts: dove: Always include gpio and interrupt-controller headers
      ARM: dts: dove: Fix uart[23] reg property
      ARM: mvebu: add Linksys WRT1900AC (Mamba) support
      ARM: mvebu: Add Device Tree description of SDHCI for Armada 388 RD
      ARM: mvebu: Update the SDHCI node on Armada 38x
      ARM: mvebu: Use macros for interrupt flags on Armada 38x sdhci node

commit c247f0534cc5a5a547a343903f42295a471844e2
Author: Willem de Bruijn <willemb@google.com>
Date:   Sat Mar 7 20:33:22 2015 -0500

    ip: fix error queue empty skb handling
    
    When reading from the error queue, msg_name and msg_control are only
    populated for some errors. A new exception for empty timestamp skbs
    added a false positive on icmp errors without payload.
    
    `traceroute -M udpconn` only displayed gateways that return payload
    with the icmp error: the embedded network headers are pulled before
    sock_queue_err_skb, leaving an skb with skb->len == 0 otherwise.
    
    Fix this regression by refining when msg_name and msg_control
    branches are taken. The solutions for the two fields are independent.
    
    msg_name only makes sense for errors that configure serr->port and
    serr->addr_offset. Test the first instead of skb->len. This also fixes
    another issue. saddr could hold the wrong data, as serr->addr_offset
    is not initialized  in some code paths, pointing to the start of the
    network header. It is only valid when serr->port is set (non-zero).
    
    msg_control support differs between IPv4 and IPv6. IPv4 only honors
    requests for ICMP and timestamps with SOF_TIMESTAMPING_OPT_CMSG. The
    skb->len test can simply be removed, because skb->dev is also tested
    and never true for empty skbs. IPv6 honors requests for all errors
    aside from local errors and timestamps on empty skbs.
    
    In both cases, make the policy more explicit by moving this logic to
    a new function that decides whether to process msg_control and that
    optionally prepares the necessary fields in skb->cb[]. After this
    change, the IPv4 and IPv6 paths are more similar.
    
    The last case is rxrpc. Here, simply refine to only match timestamps.
    
    Fixes: 49ca0d8bfaf3 ("net-timestamp: no-payload option")
    
    Reported-by: Jan Niehusmann <jan@gondor.com>
    Signed-off-by: Willem de Bruijn <willemb@google.com>
    
    ----
    
    Changes
      v1->v2
      - fix local origin test inversion in ip6_datagram_support_cmsg
      - make v4 and v6 code paths more similar by introducing analogous
        ipv4_datagram_support_cmsg
      - fix compile bug in rxrpc
    Signed-off-by: David S. Miller <davem@davemloft.net>

commit 28da06dfd9e4b04577c517f9c4b52aaa73e3d1c7
Author: Maxime Ripard <maxime.ripard@free-electrons.com>
Date:   Tue Mar 3 11:43:16 2015 +0100

    irqchip: armada-370-xp: Enable the PMU interrupts
    
    In order to let the Performance Monitoring Unit interrupts flowing in the MPIC,
    we need to unmask these interrupts in the Coherency Fabric Local Interrupt Mask
    Register.
    
    Since this register is a CPU-local register, unmasking this interrupt needs to
    be done on the boot CPU when the driver initializes, but also on the secondary
    CPU when they are brought up.
    
    Signed-off-by: Maxime Ripard <maxime.ripard@free-electrons.com>
    Acked-by: Gregory CLEMENT <gregory.clement@free-electrons.com>
    Link: https://lkml.kernel.org/r/1425379400-4346-4-git-send-email-maxime.ripard@free-electrons.com
    Signed-off-by: Jason Cooper <jason@lakedaemon.net>

commit 5724be8464dceac047c1eaddaa3651cea0ec16ca
Author: Maxime Ripard <maxime.ripard@free-electrons.com>
Date:   Tue Mar 3 11:27:23 2015 +0100

    irqchip: armada-370-xp: Fix chained per-cpu interrupts
    
    On the Cortex-A9-based Armada SoCs, the MPIC is not the primary interrupt
    controller. Yet, it still has to handle some per-cpu interrupt.
    
    To do so, it is chained with the GIC using a per-cpu interrupt. However, the
    current code only call irq_set_chained_handler, which is called and enable that
    interrupt only on the boot CPU, which means that the parent per-CPU interrupt
    is never unmasked on the secondary CPUs, preventing the per-CPU interrupt to
    actually work as expected.
    
    This was not seen until now since the only MPIC PPI users were the Marvell
    timers that were not working, but not used either since the system use the ARM
    TWD by default, and the ethernet controllers, that are faking there interrupts
    as SPI, and don't really expect to have interrupts on the secondary cores
    anyway.
    
    Add a CPU notifier that will enable the PPI on the secondary cores when they
    are brought up.
    
    Cc: <stable@vger.kernel.org> # 3.15+
    Signed-off-by: Maxime Ripard <maxime.ripard@free-electrons.com>
    Acked-by: Gregory CLEMENT <gregory.clement@free-electrons.com>
    Link: https://lkml.kernel.org/r/1425378443-28822-1-git-send-email-maxime.ripard@free-electrons.com
    Signed-off-by: Jason Cooper <jason@lakedaemon.net>

commit f3764ff7405e079124ee817f630bfbb4f1f61c2f
Author: Arnd Bergmann <arnd@arndb.de>
Date:   Wed Jan 28 18:17:41 2015 -0300

    timberdale: do not select TIMB_DMA
    
    commit 244829226f47ffb4d6009a2ccd2771cd149d8114 upstream.
    
    The timberdale media driver requires the use of the respective
    dma engine driver, but that may not be enabled, causing a
    Kconfig warning:
    
    warning: (VIDEO_TIMBERDALE) selects TIMB_DMA which has unmet direct dependencies (DMADEVICES && MFD_TIMBERDALE)
    
    This fixes the dependency by removing the inappropriate 'select'
    statement and replacing it with a direct dependency on the
    drivers that provide the services this needs.
    
    Fixes: 7155043c2d027 ("[media] enable COMPILE_TEST for media drivers")
    
    Signed-off-by: Arnd Bergmann <arnd@arndb.de>
    Signed-off-by: Hans Verkuil <hans.verkuil@cisco.com>
    Signed-off-by: Mauro Carvalho Chehab <mchehab@osg.samsung.com>
    Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>

commit 33b2fb5f10a8c4260ebc488dddc8adca176340a1
Author: Arnd Bergmann <arnd@arndb.de>
Date:   Wed Jan 28 18:17:41 2015 -0300

    timberdale: do not select TIMB_DMA
    
    commit 244829226f47ffb4d6009a2ccd2771cd149d8114 upstream.
    
    The timberdale media driver requires the use of the respective
    dma engine driver, but that may not be enabled, causing a
    Kconfig warning:
    
    warning: (VIDEO_TIMBERDALE) selects TIMB_DMA which has unmet direct dependencies (DMADEVICES && MFD_TIMBERDALE)
    
    This fixes the dependency by removing the inappropriate 'select'
    statement and replacing it with a direct dependency on the
    drivers that provide the services this needs.
    
    Fixes: 7155043c2d027 ("[media] enable COMPILE_TEST for media drivers")
    
    Signed-off-by: Arnd Bergmann <arnd@arndb.de>
    Signed-off-by: Hans Verkuil <hans.verkuil@cisco.com>
    Signed-off-by: Mauro Carvalho Chehab <mchehab@osg.samsung.com>
    Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>

commit 8ce580932f8ee40903017a6f1408ccfff319a6a5
Author: Javier Martinez Canillas <javier.martinez@collabora.co.uk>
Date:   Fri Feb 27 06:37:49 2015 +0100

    platform/chrome: cros_ec_lpc - Depend on X86 || COMPILE_TEST
    
    The ChromeOS EC is connected by LPC only on x86 platforms and no others,
    so add a dependency describing that.
    
    But also build the driver if the COMPILE_TEST option is enabled
    to have build coverage in other architectures.
    
    Signed-off-by: Javier Martinez Canillas <javier.martinez@collabora.co.uk>
    [olof: reworded commit message]
    Signed-off-by: Olof Johansson <olof@lixom.net>

commit 538da83ddbeaa422a48e9bd0a12a0bc246c567f4
Author: Thomas Petazzoni <thomas.petazzoni@free-electrons.com>
Date:   Tue Mar 3 15:41:12 2015 +0100

    ARM: mvebu: add Device Tree files for Armada 39x SoC and board
    
    This commit adds the Device Tree files for the Armada 39x family of
    processors, as well as one Armada 398 Development Board.
    
    Like for other Marvell EBU families, a common armada-39x.dtsi contains
    the description of the common features of all Armada 39x SoCs, while
    armada-390.dtsi and armada-398.dtsi respectively describe the
    specificities of those SoCs.
    
    Finally, an armada-398-db.dts file is added to describe the Armada 398
    Development Board itself.
    
    So far, the following features are supported:
    
     * SMP: dual Cortex-A9
     * Basic ARM IPs: SCU, timer, GIC, L2 cache
     * Basic Marvell IPs: pin-muxing, clocks, system controller, MBus
       controller, MPIC interrupt controller, timer, CPU reset for SMP,
       PMSU.
     * I2C
     * SPI
     * SDHCI
     * XOR
     * NAND
     * UART
     * PCIe
    
    Additional features will be supported in the future.
    
    Signed-off-by: Thomas Petazzoni <thomas.petazzoni@free-electrons.com>
    Signed-off-by: Gregory CLEMENT <gregory.clement@free-electrons.com>

commit 24c2573bdb9203259a822a4e3ed90795b273d3ab
Author: Thomas Petazzoni <thomas.petazzoni@free-electrons.com>
Date:   Tue Mar 3 15:41:03 2015 +0100

    ARM: mvebu: fix unit address of MPIC nodes
    
    The Device Tree nodes describing the MPIC nodes on Armada 370, 375,
    38x and XP had a unit address that did not match the first reg
    property, as suggested by the ePAPR. This commit fixes that.
    
    [gregory.clement@free-electrons.com: removed the armada-38x part, as it
    was already applied by a previous patch]
    
    Signed-off-by: Thomas Petazzoni <thomas.petazzoni@free-electrons.com>
    Signed-off-by: Gregory CLEMENT <gregory.clement@free-electrons.com>

commit 1d7b0839941c6ee883c001716611949448f20a79
Author: Maxime Ripard <maxime.ripard@free-electrons.com>
Date:   Thu Feb 26 10:51:17 2015 +0100

    ARM: mvebu: Fix MPIC unit address
    
    The unit-address is supposed to be equal the first reg address, which is not
    the case for the MPIC, that uses the mbus-controller one. Fix this.
    
    Signed-off-by: Maxime Ripard <maxime.ripard@free-electrons.com>
    Acked-by: Gregory CLEMENT <gregory.clement@free-electrons.com>
    Signed-off-by: Gregory CLEMENT <gregory.clement@free-electrons.com>

commit 1b0eaa2cc2dc52dced546c1c8b0551cfc734d32d
Author: Brian Norris <computersforpeace@gmail.com>
Date:   Tue Feb 17 18:18:34 2015 -0800

    tools/thermal: tmon: support cross-compiling
    
    We might want to prepare CFLAGS outside of this Makefile, so don't
    overwrite its initial value.
    
    Then, support $(CROSS_COMPILE), so we can use a cross-compile toolchain.
    
    Signed-off-by: Brian Norris <computersforpeace@gmail.com>
    Acked-by: Jacob Pan <jacob.jun.pan@linux.intel.com>
    Reviewed-by: Florian Fainelli <f.fainelli@gmail.com>
    Signed-off-by: Zhang Rui <rui.zhang@intel.com>

commit 295324556c427d60b41668ab81a43f604533f456
Merge: 18a8d4997366 0d8fb59924cf
Author: Linus Torvalds <torvalds@linux-foundation.org>
Date:   Sat Feb 21 12:41:50 2015 -0800

    Merge branch 'i2c/for-3.20' of git://git.kernel.org/pub/scm/linux/kernel/git/wsa/linux
    
    Pull i2c updates from Wolfram Sang:
     "Summary:
    
       - legacy PM code removed from the core, there were no users anymore
         (thanks to Lars-Peter Clausen)
    
       - new driver for Broadcom iProc
    
       - bigger driver updates for designware, rk3x, cadence, ocores
    
       - a bunch of smaller updates and bugfixes"
    
    * 'i2c/for-3.20' of git://git.kernel.org/pub/scm/linux/kernel/git/wsa/linux: (31 commits)
      i2c: ocores: rework clk code to handle NULL cookie
      i2c: designware-baytrail: another fixup for proper Kconfig dependencies
      i2c: fix reference to functionality constants definition
      i2c: iproc: Add Broadcom iProc I2C Driver
      i2c: designware-pci: update Intel copyright line
      i2c: ocores: add common clock support
      i2c: hix5hd2: add COMPILE_TEST
      i2c: clarify comments about the dev_released completion
      i2c: ocores: fix clock-frequency binding usage
      i2c: tegra: Maintain CPU endianness
      i2c: designware-baytrail: use proper Kconfig dependencies
      i2c: designware: Do not calculate SCL timing parameters needlessly
      i2c: do not try to load modules for of-registered devices
      i2c: designware: Add Intel Baytrail PMIC I2C bus support
      i2c: designware: Add i2c bus locking support
      of: i2c: Add i2c-mux-idle-disconnect DT property to PCA954x mux driver
      i2c: designware: use {readl|writel}_relaxed instead of readl/writel
      i2c: designware-pci: no need to provide clk_khz
      i2c: designware-pci: remove Moorestown support
      i2c: imx: whitespace and checkpatch cleanup
      ...

commit a26be149facb22d30cd92cadb26f651d6fe802c9
Merge: cdd305454ebd a20cc76b9efa
Author: Linus Torvalds <torvalds@linux-foundation.org>
Date:   Thu Feb 12 09:16:56 2015 -0800

    Merge tag 'iommu-updates-v3.20' of git://git.kernel.org/pub/scm/linux/kernel/git/joro/iommu
    
    Pull IOMMU updates from Joerg Roedel:
     "This time with:
    
       - Generic page-table framework for ARM IOMMUs using the LPAE
         page-table format, ARM-SMMU and Renesas IPMMU make use of it
         already.
    
       - Break out the IO virtual address allocator from the Intel IOMMU so
         that it can be used by other DMA-API implementations too.  The
         first user will be the ARM64 common DMA-API implementation for
         IOMMUs
    
       - Device tree support for Renesas IPMMU
    
       - Various fixes and cleanups all over the place"
    
    * tag 'iommu-updates-v3.20' of git://git.kernel.org/pub/scm/linux/kernel/git/joro/iommu: (36 commits)
      iommu/amd: Convert non-returned local variable to boolean when relevant
      iommu: Update my email address
      iommu/amd: Use wait_event in put_pasid_state_wait
      iommu/amd: Fix amd_iommu_free_device()
      iommu/arm-smmu: Avoid build warning
      iommu/fsl: Various cleanups
      iommu/fsl: Use %pa to print phys_addr_t
      iommu/omap: Print phys_addr_t using %pa
      iommu: Make more drivers depend on COMPILE_TEST
      iommu/ipmmu-vmsa: Fix IOMMU lookup when multiple IOMMUs are registered
      iommu: Disable on !MMU builds
      iommu/fsl: Remove unused fsl_of_pamu_ids[]
      iommu/fsl: Fix section mismatch
      iommu/ipmmu-vmsa: Use the ARM LPAE page table allocator
      iommu: Fix trace_map() to report original iova and original size
      iommu/arm-smmu: add support for iova_to_phys through ATS1PR
      iopoll: Introduce memory-mapped IO polling macros
      iommu/arm-smmu: don't touch the secure STLBIALL register
      iommu/arm-smmu: make use of generic LPAE allocator
      iommu: io-pgtable-arm: add non-secure quirk
      ...

commit 06cc01a0dea523b5c9acfd1ed276648c54012912
Author: Linus Torvalds <torvalds@linux-foundation.org>
Date:   Tue Feb 10 18:24:57 2015 -0800

    sata_dwc_460ex: disable COMPILE_TEST again
    
    Commit 84683a7e081f ("sata_dwc_460ex: enable COMPILE_TEST for the
    driver") enabled this driver for non-ppc460-ex platforms, but it was
    then disabled for ARM and ARM64 by commit 2de5a9c004e9 ("sata_dwc_460ex:
    disable compilation on ARM and ARM64") because it's too noisy and
    broken.
    
    This disabled is entirely, because it's too noisy on x86-64 too, and
    there's no point in disabling architectures one by one.  At a minimum,
    the code isn't 64-bit clean, and even on 32-bit it is questionable
    whether it makes sense.
    
    Cc: Andy Shevchenko <andriy.shevchenko@linux.intel.com>
    Cc: Tejun Heo <tj@kernel.org>
    Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>

commit 3e8c04eb117445d67ae2b83e08bec4005129356a
Merge: 44dbf058de9f b12aa1f25e1d
Author: Linus Torvalds <torvalds@linux-foundation.org>
Date:   Mon Feb 9 19:40:42 2015 -0800

    Merge branch 'for-3.20' of git://git.kernel.org/pub/scm/linux/kernel/git/tj/libata
    
    Pull libata changes from Tejun Heo:
     "Mostly driver-specific changes.  Nothing too noteworthy.
    
      This pull request contains three merges from for-3.19-fixes.  The
      first two are to pull ahci_xgene and sata_dwc_460ex fix commits which
      are depended upon by later changes.  The last one is to pull in a fix
      patch which missed the v3.19-rc window"
    
    * 'for-3.20' of git://git.kernel.org/pub/scm/linux/kernel/git/tj/libata: (24 commits)
      ahci_xgene: Fix the dma state machine lockup for the ATA_CMD_SMART PIO mode command.
      ata: libahci: Use of_platform_device_create only if supported
      sata_mv: Delete unnecessary checks before the function call "phy_power_off"
      ata: Delete unnecessary checks before the function call "pci_dev_put"
      ata: pata_platform: fix owner module reference mismatch for scsi host
      ata: ahci_platform: fix owner module reference mismatch for scsi host
      pata_pdc2027x: Use 64-bit timekeeping
      ata: libahci: Fix devres cleanup on failure
      ata: libahci: Allow using multiple regulators
      Documentation: bindings: Add the regulator property to the sub-nodes AHCI bindings
      ata: libahci: Clean-up the ahci_platform_en/disable_phys functions
      sata_rcar: extend PM methods
      sata_dwc_460ex: disable compilation on ARM and ARM64
      ata: libata-core: Remove unused function
      sata_dwc_460ex: convert to devm_kzalloc in ->probe()
      sata_dwc_460ex: remove extra message
      sata_dwc_460ex: use np local variable in ->probe()
      sata_dwc_460ex: fix most of the sparse warnings
      sata_dwc_460ex: enable COMPILE_TEST for the driver
      sata_dwc_460ex: remove redundant dev_set_drvdata
      ...

commit 181d9a07da1050d3da30c6936eb825724fefc18a
Author: Zhangfei Gao <zhangfei.gao@linaro.org>
Date:   Sat Jan 31 17:28:15 2015 +0800

    i2c: hix5hd2: add COMPILE_TEST
    
    Commit 9439eb3ab9d1ec ("asm-generic: io: implement relaxed
    accessor macros as conditional wrappers") has added
    {read,write}{b,w,l,q}_relaxed to include/asm-generic/io.h.
    So COMPILE_TEST can be added.
    
    Signed-off-by: Zhangfei Gao <zhangfei.gao@linaro.org>
    Signed-off-by: Wolfram Sang <wsa@the-dreams.de>

commit 2368592365bc97e941d0c641a3ba24b06d2c469b
Author: Willem de Bruijn <willemb@google.com>
Date:   Fri Jan 30 13:29:33 2015 -0500

    net-timestamp: no-payload option in txtimestamp test
    
    Demonstrate how SOF_TIMESTAMPING_OPT_TSONLY can be used and
    test the implementation.
    
    Signed-off-by: Willem de Bruijn <willemb@google.com>
    Signed-off-by: David S. Miller <davem@davemloft.net>

commit b245be1f4db1a0394e4b6eb66059814b46670ac3
Author: Willem de Bruijn <willemb@google.com>
Date:   Fri Jan 30 13:29:32 2015 -0500

    net-timestamp: no-payload only sysctl
    
    Tx timestamps are looped onto the error queue on top of an skb. This
    mechanism leaks packet headers to processes unless the no-payload
    options SOF_TIMESTAMPING_OPT_TSONLY is set.
    
    Add a sysctl that optionally drops looped timestamp with data. This
    only affects processes without CAP_NET_RAW.
    
    The policy is checked when timestamps are generated in the stack.
    It is possible for timestamps with data to be reported after the
    sysctl is set, if these were queued internally earlier.
    
    No vulnerability is immediately known that exploits knowledge
    gleaned from packet headers, but it may still be preferable to allow
    administrators to lock down this path at the cost of possible
    breakage of legacy applications.
    
    Signed-off-by: Willem de Bruijn <willemb@google.com>
    
    ----
    
    Changes
      (v1 -> v2)
      - test socket CAP_NET_RAW instead of capable(CAP_NET_RAW)
      (rfc -> v1)
      - document the sysctl in Documentation/sysctl/net.txt
      - fix access control race: read .._OPT_TSONLY only once,
            use same value for permission check and skb generation.
    Signed-off-by: David S. Miller <davem@davemloft.net>

commit 49ca0d8bfaf3bc46d5eef60ce67b00eb195bd392
Author: Willem de Bruijn <willemb@google.com>
Date:   Fri Jan 30 13:29:31 2015 -0500

    net-timestamp: no-payload option
    
    Add timestamping option SOF_TIMESTAMPING_OPT_TSONLY. For transmit
    timestamps, this loops timestamps on top of empty packets.
    
    Doing so reduces the pressure on SO_RCVBUF. Payload inspection and
    cmsg reception (aside from timestamps) are no longer possible. This
    works together with a follow on patch that allows administrators to
    only allow tx timestamping if it does not loop payload or metadata.
    
    Signed-off-by: Willem de Bruijn <willemb@google.com>
    
    ----
    
    Changes (rfc -> v1)
      - add documentation
      - remove unnecessary skb->len test (thanks to Richard Cochran)
    Signed-off-by: David S. Miller <davem@davemloft.net>

commit 244829226f47ffb4d6009a2ccd2771cd149d8114
Author: Arnd Bergmann <arnd@arndb.de>
Date:   Wed Jan 28 18:17:41 2015 -0300

    [media] timberdale: do not select TIMB_DMA
    
    The timberdale media driver requires the use of the respective
    dma engine driver, but that may not be enabled, causing a
    Kconfig warning:
    
    warning: (VIDEO_TIMBERDALE) selects TIMB_DMA which has unmet direct dependencies (DMADEVICES && MFD_TIMBERDALE)
    
    This fixes the dependency by removing the inappropriate 'select'
    statement and replacing it with a direct dependency on the
    drivers that provide the services this needs.
    
    Fixes: 7155043c2d027 ("[media] enable COMPILE_TEST for media drivers")
    
    Signed-off-by: Arnd Bergmann <arnd@arndb.de>
    Signed-off-by: Hans Verkuil <hans.verkuil@cisco.com>
    Signed-off-by: Mauro Carvalho Chehab <mchehab@osg.samsung.com>

commit 477ab7a19cec8409e4e2dd10e7348e4cac3c06e5
Author: Joerg Roedel <jroedel@suse.de>
Date:   Tue Jan 20 16:13:33 2015 +0100

    iommu: Make more drivers depend on COMPILE_TEST
    
    For easier compile testing of these iommu drivers.
    
    Acked-by: Laurent Pinchart <laurent.pinchart@ideasonboard.com>
    Signed-off-by: Joerg Roedel <jroedel@suse.de>

commit 2727ed54716e606673121d5863934512bd4a5eb8
Author: Alessio Igor Bogani <alessio.bogani@elettra.eu>
Date:   Thu Dec 11 09:56:45 2014 +0100

    powerpc/85xx: Add support for Emerson/Artesyn MVME2500.
    
    Add support for the Artesyn MVME2500 Single Board Computer.
    
    The MVME2500 is a 6U form factor VME64 computer with:
    
            - A single Freescale QorIQ P2010 CPU
            - 1 GB of DDR3 onboard memory
            - Three Gigabit Ethernets
            - Five 16550 compatible UARTS
            - One USB 2.0 port, one SHDC socket and one SATA connector
            - One PCI/PCI eXpress Mezzanine Card (PMC/XMC) Slot
            - MultiProcessor Interrupt Controller (MPIC)
            - A DS1375T Real Time Clock (RTC) and 512 KB of Non-Volatile Memory
            - Two 64 KB EEPROMs
            - U-Boot in 16 SPI Flash
    
    This patch is based on linux-3.18 and has been boot tested.
    
    Signed-off-by: Alessio Igor Bogani <alessio.bogani@elettra.eu>
    Signed-off-by: Scott Wood <scottwood@freescale.com>

commit 4f5fd640469839532cb2bd558f878539548f2861
Author: Kevin Cernekee <cernekee@gmail.com>
Date:   Tue Nov 25 16:49:46 2014 -0800

    power/reset: brcmstb: Make the driver buildable on MIPS
    
    Now that the driver doesn't use any ARM-specific headers, it is safe
    to build on MIPS or with COMPILE_TEST.
    
    Signed-off-by: Kevin Cernekee <cernekee@gmail.com>
    Signed-off-by: Sebastian Reichel <sre@kernel.org>

commit 4429fc64b90368e9bc93f933ea8b011d8db3a2f2
Author: Andre Przywara <andre.przywara@arm.com>
Date:   Mon Jun 2 15:37:13 2014 +0200

    arm/arm64: KVM: rework MPIDR assignment and add accessors
    
    The virtual MPIDR registers (containing topology information) for the
    guest are currently mapped linearily to the vcpu_id. Improve this
    mapping for arm64 by using three levels to not artificially limit the
    number of vCPUs.
    To help this, change and rename the kvm_vcpu_get_mpidr() function to
    mask off the non-affinity bits in the MPIDR register.
    Also add an accessor to later allow easier access to a vCPU with a
    given MPIDR. Use this new accessor in the PSCI emulation.
    
    Signed-off-by: Andre Przywara <andre.przywara@arm.com>
    Reviewed-by: Christoffer Dall <christoffer.dall@linaro.org>
    Reviewed-by: Marc Zyngier <marc.zyngier@arm.com>
    Signed-off-by: Christoffer Dall <christoffer.dall@linaro.org>

commit b9f918a31d629e99c9ca3d6ac2a2d7a905715c69
Author: Rasmus Villemoes <linux@rasmusvillemoes.dk>
Date:   Wed Jan 14 16:10:12 2015 +0000

    MPILIB: Fix comparison of negative MPIs
    
    If u and v both represent negative integers and their limb counts
    happen to differ, mpi_cmp will always return a positive value - this
    is obviously bogus. u is smaller than v if and only if it is larger in
    absolute value.
    
    Signed-off-by: Rasmus Villemoes <linux@rasmusvillemoes.dk>
    Signed-off-by: David Howells <dhowells@redhat.com>
    Acked-by: Dmitry Kasatkin <dmitry.kasatkin@gmail.com>

commit 98dbbcba1b0c1874b9faf9c77b83f9729360aa2c
Author: Rasmus Villemoes <linux@rasmusvillemoes.dk>
Date:   Wed Jan 14 15:16:00 2015 +0000

    MPILIB: Fix obvious but harmless typo
    
    The macro MPN_COPY_INCR this occurs in isn't used anywhere.
    
    Signed-off-by: Rasmus Villemoes <linux@rasmusvillemoes.dk>
    Signed-off-by: David Howells <dhowells@redhat.com>

commit 7fe21291bad93458100fbbf0078d40cdb529a646
Author: Rasmus Villemoes <linux@rasmusvillemoes.dk>
Date:   Wed Jan 14 15:15:57 2015 +0000

    MPILIB: Deobfuscate mpi_cmp
    
    The condition preceding 'return 1;' makes my head hurt. At this point,
    we know that u and v have the same sign; if they are negative, they
    compare opposite to how their absolute values compare (which
    mpihelp_cmp found for us), otherwise cmp itself is the
    answer. Negating cmp is ok since mpihelp_cmp returns {-1,0,1};
    -INT_MIN==INT_MIN won't bite us.
    
    Signed-off-by: Rasmus Villemoes <linux@rasmusvillemoes.dk>
    Signed-off-by: David Howells <dhowells@redhat.com>
    Acked-by: Dmitry Kasatkin <dmitry.kasatkin@gmail.com>

commit d42432ad6c5cb8e9dea43e3cef711ef740d8a34a
Author: Sreekanth Reddy <sreekanth.reddy@avagotech.com>
Date:   Mon Jan 12 11:38:59 2015 +0530

    mpt2sas: MPI2 Rev BB (2.00.20) specification and 2.00.35 header files
    
    Change List in this MPI2 specification,
    
    1. Added SSUTimeout field to MPI2_CONFIG_PAGE_BIOS_1,
       and more defines for the BiosOptions field.
    
    Signed-off-by: Sreekanth Reddy <Sreekanth.Reddy@avagotech.com>
    Reviewed-by: Martin K. Petersen <martin.petersen@oracle.com>
    Signed-off-by: Christoph Hellwig <hch@lst.de>

commit 2d8ce8c9d4b25b88eb4aa6bc52492eb7e0ae1dab
Author: Sreekanth Reddy <sreekanth.reddy@avagotech.com>
Date:   Mon Jan 12 11:38:56 2015 +0530

    mpt2sas, mpt3sas: log exceeded temperature thresholds
    
    This patch will log a message when driver receives "Temperature Threshold
    exceeded" event from any temperature sensor.
    
    The message will look similar to like:
    mpt3sas0: Temperature Threshold flags a b c d exceeded for Sensor: x !!!
    mpt3sas0: Current Temp In Celsius: y
    
    where a b c d are threshold flags 0 1 2 3
    
    Change_set:
    1. Get the number of sensor count of this IOC by reading IO Unit page 8 at
       driver initialization time.
    2. Also unmask the Temperature Threshold Event at driver initialization
       time
    3. Whenever a MPI2_EVENT_TEMP_THRESHOLD event is received from the
       firmware, then print the sensor number, the maximum threshold number it
       has exceed and the current temperature of this sensor.
    
    Signed-off-by: Sreekanth Reddy <Sreekanth.Reddy@avagotech.com>
    Reviewed-by: Martin K. Petersen <martin.petersen@oracle.com>
    Signed-off-by: Christoph Hellwig <hch@lst.de>

commit cb16ef384f15d33a53b4db47878aa818be059d77
Author: Sreekanth Reddy <sreekanth.reddy@avagotech.com>
Date:   Mon Jan 12 11:38:55 2015 +0530

    mpt2sas: MPI2 Rev AA (2.00.19) specifications
    
    Below is the changeset from the MPI specification and 2.00.34 header
    files:
    
    1) Defined additional bits in the BiosOptions field of BIOS Page 1 to
       allow for finer control of X86 BIOS and UEFI BSD.
    2) For the Clean Tool, reserved bit 26 of the Flags field for product
       specific use.
    
    Signed-off-by: Sreekanth Reddy <Sreekanth.Reddy@avagotech.com>
    Reviewed-by: Martin K. Petersen <martin.petersen@oracle.com>
    Signed-off-by: Christoph Hellwig <hch@lst.de>

commit 84683a7e081ff60e75039cd2475776654ebbf526
Author: Andy Shevchenko <andriy.shevchenko@linux.intel.com>
Date:   Wed Jan 7 15:24:21 2015 +0200

    sata_dwc_460ex: enable COMPILE_TEST for the driver
    
    To test how the driver could be compiled in the non-native environment let's
    enable COMPILE_TEST for it. It would be useful for further work.
    
    This patch enables COMPILE_TEST for the driver and fixes compilation errors on
    at least x86 platforms.
    
    Signed-off-by: Andy Shevchenko <andriy.shevchenko@linux.intel.com>
    Signed-off-by: Tejun Heo <tj@kernel.org>

commit c0442479652b99b62dd1ffccb34231caff25751c
Author: Tony Lindgren <tony@atomide.com>
Date:   Mon Dec 1 11:10:15 2014 -0800

    usb: musb: Fix randconfig build issues for Kconfig options
    
    Commit 82c02f58ba3a ("usb: musb: Allow multiple glue layers to be
    built in") enabled selecting multiple glue layers, which in turn
    exposed things more for randconfig builds. If NOP_USB_XCEIV is
    built-in and TUSB6010 is a loadable module, we will get:
    
    drivers/built-in.o: In function `tusb_remove':
    tusb6010.c:(.text+0x16a817): undefined reference to `usb_phy_generic_unregister'
    drivers/built-in.o: In function `tusb_probe':
    tusb6010.c:(.text+0x16b24e): undefined reference to `usb_phy_generic_register'
    make: *** [vmlinux] Error 1
    
    Let's fix this the same way as commit 70c1ff4b3c86 ("usb: musb:
    tusb-dma can't be built-in if tusb is not").
    
    And while at it, let's not allow selecting the glue layers except
    on platforms really using them unless COMPILE_TEST is specified:
    
    - TUSB6010 is in practise only used on omaps
    
    - DSPS is only used on TI platforms
    
    - UX500 is only used on STE platforms
    
    Cc: Linus Walleij <linus.walleij@linaro.org>
    Reported-by: Jim Davis <jim.epost@gmail.com>
    Signed-off-by: Tony Lindgren <tony@atomide.com>
    Signed-off-by: Felipe Balbi <balbi@ti.com>

commit adac476a1983459b0351903430c2f45e8d542570
Author: Chris Clayton <chris2553@googlemail.com>
Date:   Sat Nov 22 09:51:10 2014 +0000

    x86: Use $(OBJDUMP) instead of plain objdump
    
    commit e2e68ae688b0a3766cd75aedf4ed4e39be402009 upstream.
    
    commit e6023367d779 'x86, kaslr: Prevent .bss from overlaping initrd'
    broke the cross compile of x86. It added a objdump invocation, which
    invokes the host native objdump and ignores an active cross tool
    chain.
    
    Use $(OBJDUMP) instead which takes the CROSS_COMPILE prefix into
    account.
    
    [ tglx: Massage changelog and use $(OBJDUMP) ]
    
    Fixes: e6023367d779 'x86, kaslr: Prevent .bss from overlaping initrd'
    Signed-off-by: Chris Clayton <chris2553@googlemail.com>
    Acked-by: Kees Cook <keescook@chromium.org>
    Acked-by: Borislav Petkov <bp@suse.de>
    Cc: Junjie Mao <eternal.n08@gmail.com>
    Cc: Ingo Molnar <mingo@kernel.org>
    Cc: H. Peter Anvin <hpa@linux.intel.com>
    Link: http://lkml.kernel.org/r/54705C8E.1080400@googlemail.com
    Signed-off-by: Thomas Gleixner <tglx@linutronix.de>
    Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>

commit e1811f07e9f65f7dfe30106361ebb5bd6308af08
Author: Chris Clayton <chris2553@googlemail.com>
Date:   Sat Nov 22 09:51:10 2014 +0000

    x86: Use $(OBJDUMP) instead of plain objdump
    
    commit e2e68ae688b0a3766cd75aedf4ed4e39be402009 upstream.
    
    commit e6023367d779 'x86, kaslr: Prevent .bss from overlaping initrd'
    broke the cross compile of x86. It added a objdump invocation, which
    invokes the host native objdump and ignores an active cross tool
    chain.
    
    Use $(OBJDUMP) instead which takes the CROSS_COMPILE prefix into
    account.
    
    [ tglx: Massage changelog and use $(OBJDUMP) ]
    
    Fixes: e6023367d779 'x86, kaslr: Prevent .bss from overlaping initrd'
    Signed-off-by: Chris Clayton <chris2553@googlemail.com>
    Acked-by: Kees Cook <keescook@chromium.org>
    Acked-by: Borislav Petkov <bp@suse.de>
    Cc: Junjie Mao <eternal.n08@gmail.com>
    Cc: Ingo Molnar <mingo@kernel.org>
    Cc: H. Peter Anvin <hpa@linux.intel.com>
    Link: http://lkml.kernel.org/r/54705C8E.1080400@googlemail.com
    Signed-off-by: Thomas Gleixner <tglx@linutronix.de>
    Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>

commit 8d14066755592a2906b4f2378aeb5471b602d3cb
Merge: 87c779baabff 76771c938e95
Author: Linus Torvalds <torvalds@linux-foundation.org>
Date:   Fri Dec 12 15:10:34 2014 -0800

    Merge tag 'iommu-updates-v3.19' of git://git.kernel.org/pub/scm/linux/kernel/git/joro/iommu
    
    Pull IOMMU updates from Joerg Roedel:
     "This time with:
    
       - A new IOMMU-API call: iommu_map_sg() to map multiple non-contiguous
         pages into an IO address space with only one API call.  This allows
         certain optimizations in the IOMMU driver.
    
       - DMAR device hotplug in the Intel VT-d driver.  It is now possible
         to hotplug the IOMMU itself.
    
       - A new IOMMU driver for the Rockchip ARM platform.
    
       - Couple of cleanups and improvements in the OMAP IOMMU driver.
    
       - Nesting support for the ARM-SMMU driver.
    
       - Various other small cleanups and improvements.
    
      Please note that this time some branches were also pulled into other
      trees, like the DRI and the Tegra tree.  The VT-d branch was also
      pulled into tip/x86/apic.
    
      Some patches for the AMD IOMMUv2 driver are not in the IOMMU tree but
      were merged by Andrew (or finally ended up in the DRI tree)"
    
    * tag 'iommu-updates-v3.19' of git://git.kernel.org/pub/scm/linux/kernel/git/joro/iommu: (42 commits)
      iommu: Decouple iommu_map_sg from CPU page size
      iommu/vt-d: Fix an off-by-one bug in __domain_mapping()
      pci, ACPI, iommu: Enhance pci_root to support DMAR device hotplug
      iommu/vt-d: Enhance intel-iommu driver to support DMAR unit hotplug
      iommu/vt-d: Enhance error recovery in function intel_enable_irq_remapping()
      iommu/vt-d: Enhance intel_irq_remapping driver to support DMAR unit hotplug
      iommu/vt-d: Search for ACPI _DSM method for DMAR hotplug
      iommu/vt-d: Implement DMAR unit hotplug framework
      iommu/vt-d: Dynamically allocate and free seq_id for DMAR units
      iommu/vt-d: Introduce helper function dmar_walk_resources()
      iommu/arm-smmu: add support for DOMAIN_ATTR_NESTING attribute
      iommu/arm-smmu: Play nice on non-ARM/SMMU systems
      iommu/amd: remove compiler warning due to IOMMU_CAP_NOEXEC
      iommu/arm-smmu: add IOMMU_CAP_NOEXEC to the ARM SMMU driver
      iommu: add capability IOMMU_CAP_NOEXEC
      iommu/arm-smmu: change IOMMU_EXEC to IOMMU_NOEXEC
      iommu/amd: Fix accounting of device_state
      x86/vt-d: Fix incorrect bit operations in setting values
      iommu/rockchip: Allow to compile with COMPILE_TEST
      iommu/ipmmu-vmsa: Return proper error if devm_request_irq fails
      ...

commit 2183a58803c2bbd87c2d0057eed6779ec4718d4d
Merge: e28870f9b3e9 71947828caef
Author: Linus Torvalds <torvalds@linux-foundation.org>
Date:   Thu Dec 11 11:49:23 2014 -0800

    Merge tag 'media/v3.19-rc1' of git://git.kernel.org/pub/scm/linux/kernel/git/mchehab/linux-media
    
    Pull media updates from Mauro Carvalho Chehab:
     - Two new dvb frontend drivers: mn88472 and mn88473
     - A new driver for some PCIe DVBSky cards
     - A new remote controller driver: meson-ir
     - One LIRC staging driver got rewritten and promoted to mainstream:
       igorplugusb
     - A new tuner driver (m88rs6000t)
     - The old omap2 media driver got removed from staging.  This driver
       uses an old DMA API and it is likely broken on recent kernels.
       Nobody cared enough to fix it
     - Media bus format moved to a separate header, as DRM will also use the
       definitions there
     - mem2mem_testdev were renamed to vim2m, in order to use the same
       naming convention taken by the other virtual test driver (vivid)
     - Added a new driver for coda SoC (coda-jpeg)
     - The cx88 driver got converted to use videobuf2 core
     - Make DMABUF export buffer to work with DMA Scatter/Gather and Vmalloc
       cores
     - Lots of other fixes, improvements and cleanups on the drivers.
    
    * tag 'media/v3.19-rc1' of git://git.kernel.org/pub/scm/linux/kernel/git/mchehab/linux-media: (384 commits)
      [media] mn88473: One function call less in mn88473_init() after error
      [media] mn88473: Remove uneeded check before release_firmware()
      [media] lirc_zilog: Deletion of unnecessary checks before vfree()
      [media] MAINTAINERS: Add myself as img-ir maintainer
      [media] img-ir: Don't set driver's module owner
      [media] img-ir: Depend on METAG or MIPS or COMPILE_TEST
      [media] img-ir/hw: Drop [un]register_decoder declarations
      [media] img-ir/hw: Fix potential deadlock stopping timer
      [media] img-ir/hw: Always read data to clear buffer
      [media] redrat3: ensure dma is setup properly
      [media] ddbridge: remove unneeded check before dvb_unregister_device()
      [media] si2157: One function call less in si2157_init() after error
      [media] tuners: remove uneeded checks before release_firmware()
      [media] arm: omap2: rx51-peripherals: fix build warning
      [media] stv090x: add an extra protetion against buffer overflow
      [media] stv090x: Remove an unreachable code
      [media] stv090x: Some whitespace cleanups
      [media] em28xx: checkpatch cleanup: whitespaces/new lines cleanups
      [media] si2168: add support for firmware files in new format
      [media] si2168: debug printout for firmware version
      ...

commit 75ed70985a90107b5c2fd9baf98a67968bcae0a4
Author: Chris Clayton <chris2553@googlemail.com>
Date:   Sat Nov 22 09:51:10 2014 +0000

    x86: Use $(OBJDUMP) instead of plain objdump
    
    commit e2e68ae688b0a3766cd75aedf4ed4e39be402009 upstream.
    
    commit e6023367d779 'x86, kaslr: Prevent .bss from overlaping initrd'
    broke the cross compile of x86. It added a objdump invocation, which
    invokes the host native objdump and ignores an active cross tool
    chain.
    
    Use $(OBJDUMP) instead which takes the CROSS_COMPILE prefix into
    account.
    
    [ tglx: Massage changelog and use $(OBJDUMP) ]
    
    Fixes: e6023367d779 'x86, kaslr: Prevent .bss from overlaping initrd'
    Signed-off-by: Chris Clayton <chris2553@googlemail.com>
    Acked-by: Kees Cook <keescook@chromium.org>
    Acked-by: Borislav Petkov <bp@suse.de>
    Cc: Junjie Mao <eternal.n08@gmail.com>
    Cc: Ingo Molnar <mingo@kernel.org>
    Cc: H. Peter Anvin <hpa@linux.intel.com>
    Link: http://lkml.kernel.org/r/54705C8E.1080400@googlemail.com
    Signed-off-by: Thomas Gleixner <tglx@linutronix.de>
    Signed-off-by: Luis Henriques <luis.henriques@canonical.com>

commit a0e4467726cd26bacb16f13d207ffcfa82ffc07d
Merge: ed8efd2de754 cb61f6769b88
Author: Linus Torvalds <torvalds@linux-foundation.org>
Date:   Tue Dec 9 17:25:00 2014 -0800

    Merge tag 'asm-generic-for-linus' of git://git.kernel.org/pub/scm/linux/kernel/git/arnd/asm-generic
    
    Pull asm-generic asm/io.h rewrite from Arnd Bergmann:
     "While there normally is no reason to have a pull request for
      asm-generic but have all changes get merged through whichever tree
      needs them, I do have a series for 3.19.
    
      There are two sets of patches that change significant portions of
      asm/io.h, and this branch contains both in order to resolve the
      conflicts:
    
       - Will Deacon has done a set of patches to ensure that all
         architectures define {read,write}{b,w,l,q}_relaxed() functions or
         get them by including asm-generic/io.h.
    
         These functions are commonly used on ARM specific drivers to avoid
         expensive L2 cache synchronization implied by the normal
         {read,write}{b,w,l,q}, but we need to define them on all
         architectures in order to share the drivers across architectures
         and to enable CONFIG_COMPILE_TEST configurations for them
    
       - Thierry Reding has done an unrelated set of patches that extends
         the asm-generic/io.h file to the degree necessary to make it useful
         on ARM64 and potentially other architectures"
    
    * tag 'asm-generic-for-linus' of git://git.kernel.org/pub/scm/linux/kernel/git/arnd/asm-generic: (29 commits)
      ARM64: use GENERIC_PCI_IOMAP
      sparc: io: remove duplicate relaxed accessors on sparc32
      ARM: sa11x0: Use void __iomem * in MMIO accessors
      arm64: Use include/asm-generic/io.h
      ARM: Use include/asm-generic/io.h
      asm-generic/io.h: Implement generic {read,write}s*()
      asm-generic/io.h: Reconcile I/O accessor overrides
      /dev/mem: Use more consistent data types
      Change xlate_dev_{kmem,mem}_ptr() prototypes
      ARM: ixp4xx: Properly override I/O accessors
      ARM: ixp4xx: Fix build with IXP4XX_INDIRECT_PCI
      ARM: ebsa110: Properly override I/O accessors
      ARC: Remove redundant PCI_IOBASE declaration
      documentation: memory-barriers: clarify relaxed io accessor semantics
      x86: io: implement dummy relaxed accessor macros for writes
      tile: io: implement dummy relaxed accessor macros for writes
      sparc: io: implement dummy relaxed accessor macros for writes
      powerpc: io: implement dummy relaxed accessor macros for writes
      parisc: io: implement dummy relaxed accessor macros for writes
      mn10300: io: implement dummy relaxed accessor macros for writes
      ...

commit 829ae9d611651467fe6cd7be834bd33ca6b28dfe
Author: Willem de Bruijn <willemb@google.com>
Date:   Sun Nov 30 22:22:34 2014 -0500

    net-timestamp: allow reading recv cmsg on errqueue with origin tstamp
    
    Allow reading of timestamps and cmsg at the same time on all relevant
    socket families. One use is to correlate timestamps with egress
    device, by asking for cmsg IP_PKTINFO.
    
    on AF_INET sockets, call the relevant function (ip_cmsg_recv). To
    avoid changing legacy expectations, only do so if the caller sets a
    new timestamping flag SOF_TIMESTAMPING_OPT_CMSG.
    
    on AF_INET6 sockets, IPV6_PKTINFO and all other recv cmsg are already
    returned for all origins. only change is to set ifindex, which is
    not initialized for all error origins.
    
    In both cases, only generate the pktinfo message if an ifindex is
    known. This is not the case for ACK timestamps.
    
    The difference between the protocol families is probably a historical
    accident as a result of the different conditions for generating cmsg
    in the relevant ip(v6)_recv_error function:
    
    ipv4:        if (serr->ee.ee_origin == SO_EE_ORIGIN_ICMP) {
    ipv6:        if (serr->ee.ee_origin != SO_EE_ORIGIN_LOCAL) {
    
    At one time, this was the same test bar for the ICMP/ICMP6
    distinction. This is no longer true.
    
    Signed-off-by: Willem de Bruijn <willemb@google.com>
    
    ----
    
    Changes
      v1 -> v2
        large rewrite
        - integrate with existing pktinfo cmsg generation code
        - on ipv4: only send with new flag, to maintain legacy behavior
        - on ipv6: send at most a single pktinfo cmsg
        - on ipv6: initialize fields if not yet initialized
    
    The recv cmsg interfaces are also relevant to the discussion of
    whether looping packet headers is problematic. For v6, cmsgs that
    identify many headers are already returned. This patch expands
    that to v4. If it sounds reasonable, I will follow with patches
    
    1. request timestamps without payload with SOF_TIMESTAMPING_OPT_TSONLY
       (http://patchwork.ozlabs.org/patch/366967/)
    2. sysctl to conditionally drop all timestamps that have payload or
       cmsg from users without CAP_NET_RAW.
    Signed-off-by: David S. Miller <davem@davemloft.net>

commit 6010d2c104bfa4e427545639bdf60217e96d4baa
Author: James Hogan <james.hogan@imgtec.com>
Date:   Mon Nov 17 09:17:47 2014 -0300

    [media] img-ir: Depend on METAG or MIPS or COMPILE_TEST
    
    The ImgTec Infrared decoder block which img-ir drives is only used in
    IMGWorks SoCs so far, such as the TZ1090 (Meta based) and the upcoming
    Pistachio (MIPS based). Therefore make the driver depend on METAG (for
    TZ1090) or MIPS (for Pistachio) or COMPILE_TEST (so that it is included
    in x86 allmodconfig builds), to avoid cluttering the Kconfig menu with
    drivers for hardware that isn't yet available on other platforms.
    
    Signed-off-by: James Hogan <james.hogan@imgtec.com>
    Signed-off-by: Mauro Carvalho Chehab <mchehab@osg.samsung.com>

commit 4c12df63f7ff27fe2e14f243a6906ad84e641964
Author: Michael Ellerman <mpe@ellerman.id.au>
Date:   Tue Dec 2 16:52:08 2014 +1100

    selftests/kcmp: Always try to build the test
    
    Don't prevent the test building on non-x86. Just try and build it and
    let the chips fall where they may.
    
    Add support for CROSS_COMPILE while we're at it. Also we don't need a
    custom rule for building kcmp_test.
    
    Signed-off-by: Michael Ellerman <mpe@ellerman.id.au>
    Reviewed-by: Christopher Covington <cov@codeaurora.org>
    Signed-off-by: Shuah Khan <shuahkh@osg.samsung.com>

commit e8bd888a148cb55a5ba27070fdfeb62386c89577
Author: Hans Verkuil <hans.verkuil@cisco.com>
Date:   Mon Dec 1 08:32:54 2014 -0300

    [media] omap_vout: fix compile warnings
    
    When compiling under COMPILE_TEST on a x86_64 the following warnings
    appear:
    
    drivers/media/platform/omap/omap_vout.c: In function 'omap_vout_uservirt_to_phys':
    drivers/media/platform/omap/omap_vout.c:209:23: warning: cast to pointer from integer of different size [-Wint-to-pointer-cast]
       return virt_to_phys((void *) virtp);
                           ^
    drivers/media/platform/omap/omap_vout.c: In function 'omapvid_setup_overlay':
    drivers/media/platform/omap/omap_vout.c:420:2: warning: format '%x' expects argument of type 'unsigned int', but argument 5 has type 'dma_addr_t' [-Wformat=]
      v4l2_dbg(1, debug, &vout->vid_dev->v4l2_dev,
      ^
    drivers/media/platform/omap/omap_vout.c: In function 'omap_vout_buffer_prepare':
    drivers/media/platform/omap/omap_vout.c:794:34: warning: cast to pointer from integer of different size [-Wint-to-pointer-cast]
       vout->queued_buf_addr[vb->i] = (u8 *)
                                      ^
    In file included from arch/x86/include/asm/dma-mapping.h:44:0,
                     from include/linux/dma-mapping.h:82,
                     from drivers/media/platform/omap/omap_vout.c:40:
    drivers/media/platform/omap/omap_vout.c:803:58: warning: cast to pointer from integer of different size [-Wint-to-pointer-cast]
       dma_addr = dma_map_single(vout->vid_dev->v4l2_dev.dev, (void *) addr,
                                                              ^
    include/asm-generic/dma-mapping-common.h:174:60: note: in definition of macro 'dma_map_single'
     #define dma_map_single(d, a, s, r) dma_map_single_attrs(d, a, s, r, NULL)
                                                                ^
    
    These are fixed by this patch.
    
    Signed-off-by: Hans Verkuil <hans.verkuil@cisco.com>
    Signed-off-by: Mauro Carvalho Chehab <mchehab@osg.samsung.com>

commit d7c5925487d6352240be7ef1c4f3a02886688b4b
Author: Mauro Carvalho Chehab <mchehab@osg.samsung.com>
Date:   Tue Nov 25 23:41:09 2014 -0200

    [media] omap: disable COMPILE_TEST
    
    This causes lots of errors, because of sub-arch specific dependencies:
    
    All error/warnings:
    
    >> ERROR: "omapdss_compat_init" [drivers/media/platform/omap/omap-vout.ko] undefined!
    >> ERROR: "omap_dss_get_overlay_manager" [drivers/media/platform/omap/omap-vout.ko] undefined!
    >> ERROR: "omap_dss_get_num_overlay_managers" [drivers/media/platform/omap/omap-vout.ko] undefined!
    >> ERROR: "omap_dss_get_overlay" [drivers/media/platform/omap/omap-vout.ko] undefined!
    >> ERROR: "omapdss_is_initialized" [drivers/media/platform/omap/omap-vout.ko] undefined!
    >> ERROR: "omap_dispc_register_isr" [drivers/media/platform/omap/omap-vout.ko] undefined!
    >> ERROR: "omapdss_get_version" [drivers/media/platform/omap/omap-vout.ko] undefined!
    >> ERROR: "omap_dss_put_device" [drivers/media/platform/omap/omap-vout.ko] undefined!
    >> ERROR: "omap_dss_get_next_device" [drivers/media/platform/omap/omap-vout.ko] undefined!
    >> ERROR: "omap_dispc_unregister_isr" [drivers/media/platform/omap/omap-vout.ko] undefined!
    >> ERROR: "omapdss_compat_uninit" [drivers/media/platform/omap/omap-vout.ko] undefined!
    >> ERROR: "omap_dss_get_device" [drivers/media/platform/omap/omap-vout.ko] undefined!
    >> ERROR: "omap_dss_get_num_overlays" [drivers/media/platform/omap/omap-vout.ko] undefined!
    
    Signed-off-by: Mauro Carvalho Chehab <mchehab@osg.samsung.com>

commit 138a7f49270fde7547afe976a01cef2b9fbf3a0e
Author: Andrew Lutomirski <luto@amacapital.net>
Date:   Mon Nov 24 12:02:29 2014 -0800

    net-timestamp: Fix a documentation typo
    
    SOF_TIMESTAMPING_OPT_ID puts the id in ee_data, not ee_info.
    
    Cc: Willem de Bruijn <willemb@google.com>
    Signed-off-by: Andy Lutomirski <luto@amacapital.net>
    Acked-by: Willem de Bruijn <willemb@google.com>
    Signed-off-by: David S. Miller <davem@davemloft.net>

commit 1cefdaea613bcd247b2235079fcbb0ca4687542d
Author: Mark Brown <broonie@linaro.org>
Date:   Fri Nov 21 00:36:49 2014 +0000

    arm64: topology: Fix handling of multi-level cluster MPIDR-based detection
    
    The only requirement the scheduler has on cluster IDs is that they must
    be unique.  When enumerating the topology based on MPIDR information the
    kernel currently generates cluster IDs by using the first level of
    affinity above the core ID (either level one or two depending on if the
    core has multiple threads) however the ARMv8 architecture allows for up
    to three levels of affinity.  This means that an ARMv8 system may
    contain cores which have MPIDRs identical other than affinity level
    three which with current code will cause us to report multiple cores
    with the same identification to the scheduler in violation of its
    uniqueness requirement.
    
    Ensure that we do not violate the scheduler requirements on systems that
    uses all the affinity levels by incorporating both affinity levels two
    and three into the cluser ID when the cores are not threaded.
    
    While no currently known hardware uses multi-level clusters it is better
    to program defensively, this will help ease bringup of systems that have
    them and will ensure that things like distribution install media do not
    need to be respun to replace kernels in order to deploy such systems.
    In the worst case the system will work but perform suboptimally until a
    kernel modified to handle the new topology better is installed, in the
    best case this will be an adequate description of such topologies for
    the scheduler to perform well.
    
    Signed-off-by: Mark Brown <broonie@linaro.org>
    Signed-off-by: Will Deacon <will.deacon@arm.com>

commit 6b213e81ddf8b265383c9a1a1884432df88f701e
Author: Paul Bolle <pebolle@tiscali.nl>
Date:   Mon Nov 24 09:07:45 2014 -0300

    [media] omap: Fix typo "HAS_MMU"
    
    Commit 38a073116525 ("[media] omap: be sure that MMU is there for
    COMPILE_TEST") added a dependency on HAS_MMU. There's no Kconfig symbol
    HAS_MMU. Use MMU instead.
    
    Signed-off-by: Paul Bolle <pebolle@tiscali.nl>
    Signed-off-by: Mauro Carvalho Chehab <mchehab@osg.samsung.com>

commit e2e68ae688b0a3766cd75aedf4ed4e39be402009
Author: Chris Clayton <chris2553@googlemail.com>
Date:   Sat Nov 22 09:51:10 2014 +0000

    x86: Use $(OBJDUMP) instead of plain objdump
    
    commit e6023367d779 'x86, kaslr: Prevent .bss from overlaping initrd'
    broke the cross compile of x86. It added a objdump invocation, which
    invokes the host native objdump and ignores an active cross tool
    chain.
    
    Use $(OBJDUMP) instead which takes the CROSS_COMPILE prefix into
    account.
    
    [ tglx: Massage changelog and use $(OBJDUMP) ]
    
    Fixes: e6023367d779 'x86, kaslr: Prevent .bss from overlaping initrd'
    Signed-off-by: Chris Clayton <chris2553@googlemail.com>
    Acked-by: Kees Cook <keescook@chromium.org>
    Acked-by: Borislav Petkov <bp@suse.de>
    Cc: Junjie Mao <eternal.n08@gmail.com>
    Cc: Ingo Molnar <mingo@kernel.org>
    Cc: H. Peter Anvin <hpa@linux.intel.com>
    Cc: stable@vger.kernel.org
    Link: http://lkml.kernel.org/r/54705C8E.1080400@googlemail.com
    Signed-off-by: Thomas Gleixner <tglx@linutronix.de>

commit 6e5ae29b6dbdb60ef60f769d7b80274d62e6fbcf
Author: Ludovic Desroches <ludovic.desroches@atmel.com>
Date:   Thu Nov 13 11:52:39 2014 +0100

    dmaengine: at_xdmac: prefer usage of readl/writel_relaxed
    
    _relaxed version of readl and writel are not implemented on all
    architecture so COMPILE_TEST has to be removed in order to not cause
    some build failures.
    
    Signed-off-by: Ludovic Desroches <ludovic.desroches@atmel.com>
    Signed-off-by: Vinod Koul <vinod.koul@intel.com>

commit 2abd4198090fbe88af653a4a0be3735d286356b2
Author: Vinod Koul <vinod.koul@intel.com>
Date:   Thu Nov 6 17:34:13 2014 +0530

    dmaengine: at_xdmac: fix usage of read, write wrappers
    
    This driver uses read_relaxed and writel_relaxed to read, write to IO
    memory. the config defines COMPILE_TEST so gets compiled on different archs.
    This causes issue as few archs like x86 etc don't define it.
    So use readl/writel which is defined in all archs
    
    Reported-by: kbuild test robot <fengguang.wu@intel.com>
    Signed-off-by: Vinod Koul <vinod.koul@intel.com>

commit 72621b91f458343c0d92ce112a46dd0944aeb9ce
Author: Grzegorz Jaszczyk <jaz@semihalf.com>
Date:   Thu Sep 25 13:17:19 2014 +0200

    irqchip: armada-370-xp: Fix MPIC interrupt handling
    
    commit 758e8366754d3fa57da978fef9d2c652f7b55c02 upstream.
    
    In both Armada-375 and Armada-38x MPIC interrupts should be identified by
    reading cause register multiplied by the interrupt mask.
    
    A lack of above mentioned multiplication resulted in a bug, caused by the
    fact that in Armada-375 and Armada-38x some of the interrupts
    (e.g. network interrupts) can be handled either as a GIC or MPIC interrupts.
    Therefore during MPIC interrupts handling, cause register shows hits from
    interrupts even if they are masked for MPIC but unmasked for a GIC.
    
    This resulted in 'bad IRQ' error, because masked MPIC interrupt without
    registered interrupt handler, was trying to be handled during interrupt
    handling procedure of some other unmasked MPIC interrupt (e.g. local timer
    irq).
    
    This commit fixes that by ensuring that during MPIC interrupt handling only
    interrupts that are unmasked for MPIC are processed.
    
    Signed-off-by: Grzegorz Jaszczyk <jaz@semihalf.com>
    Reviewed-by: Gregory CLEMENT <gregory.clement@free-electrons.com>
    Fixes: bc69b8adfe22 ("irqchip: armada-370-xp: Setup a chained handler for the MPIC")
    Acked-by: Ezequiel Garcia <ezequiel.garcia@free-electrons.com>
    Link: https://lkml.kernel.org/r/1411643839-64925-3-git-send-email-jaz@semihalf.com
    Signed-off-by: Jason Cooper <jason@lakedaemon.net>
    Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>

commit 03090719a0da6ab35509c8037c06a2491bb64fa4
Author: Grzegorz Jaszczyk <jaz@semihalf.com>
Date:   Thu Sep 25 13:17:18 2014 +0200

    irqchip: armada-370-xp: Fix MSI interrupt handling
    
    commit 298dcb2dd0267d51e4f7c94a628cd0765a50ad75 upstream.
    
    The MSI interrupts use the 16 high doorbells, which are notified by using IRQ1
    of the main interrupt controller.
    
    The MSI interrupts were handled correctly for Armada-XP and Armada-370 but not
    for Armada-375 and Armada-38x, which use chained handler for the MPIC.
    
    This commit fixes that by checking proper interrupt number in chained handler
    for the MPIC.
    
    Signed-off-by: Grzegorz Jaszczyk <jaz@semihalf.com>
    Reviewed-by: Gregory CLEMENT <gregory.clement@free-electrons.com>
    Fixes: bc69b8adfe22 ("irqchip: armada-370-xp: Setup a chained handler for the MPIC")
    Acked-by: Ezequiel Garcia <ezequiel.garcia@free-electrons.com>
    Link: https://lkml.kernel.org/r/1411643839-64925-2-git-send-email-jaz@semihalf.com
    Signed-off-by: Jason Cooper <jason@lakedaemon.net>
    Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>

commit 11b6663d2315a664893f22c59d69a24dc24870a4
Author: Grzegorz Jaszczyk <jaz@semihalf.com>
Date:   Thu Sep 25 13:17:19 2014 +0200

    irqchip: armada-370-xp: Fix MPIC interrupt handling
    
    commit 758e8366754d3fa57da978fef9d2c652f7b55c02 upstream.
    
    In both Armada-375 and Armada-38x MPIC interrupts should be identified by
    reading cause register multiplied by the interrupt mask.
    
    A lack of above mentioned multiplication resulted in a bug, caused by the
    fact that in Armada-375 and Armada-38x some of the interrupts
    (e.g. network interrupts) can be handled either as a GIC or MPIC interrupts.
    Therefore during MPIC interrupts handling, cause register shows hits from
    interrupts even if they are masked for MPIC but unmasked for a GIC.
    
    This resulted in 'bad IRQ' error, because masked MPIC interrupt without
    registered interrupt handler, was trying to be handled during interrupt
    handling procedure of some other unmasked MPIC interrupt (e.g. local timer
    irq).
    
    This commit fixes that by ensuring that during MPIC interrupt handling only
    interrupts that are unmasked for MPIC are processed.
    
    Signed-off-by: Grzegorz Jaszczyk <jaz@semihalf.com>
    Reviewed-by: Gregory CLEMENT <gregory.clement@free-electrons.com>
    Fixes: bc69b8adfe22 ("irqchip: armada-370-xp: Setup a chained handler for the MPIC")
    Acked-by: Ezequiel Garcia <ezequiel.garcia@free-electrons.com>
    Link: https://lkml.kernel.org/r/1411643839-64925-3-git-send-email-jaz@semihalf.com
    Signed-off-by: Jason Cooper <jason@lakedaemon.net>
    Signed-off-by: Luis Henriques <luis.henriques@canonical.com>

commit 53f6e8d9e7c22825b00c8b2cbd43b43f5b33c7ed
Author: Grzegorz Jaszczyk <jaz@semihalf.com>
Date:   Thu Sep 25 13:17:18 2014 +0200

    irqchip: armada-370-xp: Fix MSI interrupt handling
    
    commit 298dcb2dd0267d51e4f7c94a628cd0765a50ad75 upstream.
    
    The MSI interrupts use the 16 high doorbells, which are notified by using IRQ1
    of the main interrupt controller.
    
    The MSI interrupts were handled correctly for Armada-XP and Armada-370 but not
    for Armada-375 and Armada-38x, which use chained handler for the MPIC.
    
    This commit fixes that by checking proper interrupt number in chained handler
    for the MPIC.
    
    Signed-off-by: Grzegorz Jaszczyk <jaz@semihalf.com>
    Reviewed-by: Gregory CLEMENT <gregory.clement@free-electrons.com>
    Fixes: bc69b8adfe22 ("irqchip: armada-370-xp: Setup a chained handler for the MPIC")
    Acked-by: Ezequiel Garcia <ezequiel.garcia@free-electrons.com>
    Link: https://lkml.kernel.org/r/1411643839-64925-2-git-send-email-jaz@semihalf.com
    Signed-off-by: Jason Cooper <jason@lakedaemon.net>
    Signed-off-by: Luis Henriques <luis.henriques@canonical.com>

commit db4fd5197b8c7223af9be8cd3f8d8b7239e5d06c
Author: Thierry Reding <treding@nvidia.com>
Date:   Thu Oct 16 15:40:58 2014 +0200

    drm/tegra: Depend on COMMON_CLK
    
    The introduction of the COMPILE_TEST dependency in commit 158b50aefa14
    (drm/tegra: Increase compile test coverage) removes the dependency on
    COMMON_CLK (implicitly selected via ARCH_TEGRA, ARCH_MULTI_V7 and
    ARCH_MULTIPLATFORM).
    
    Reported-by: Russell King <linux@arm.linux.org.uk>
    Signed-off-by: Thierry Reding <treding@nvidia.com>

commit a50d7156f171c9ee1f1b58d354114fbdcf4faf1e
Merge: ae04e1ca8031 758e8366754d
Author: Linus Torvalds <torvalds@linux-foundation.org>
Date:   Sat Nov 8 08:47:16 2014 -0800

    Merge branch 'irq-urgent-for-linus' of git://git.kernel.org/pub/scm/linux/kernel/git/tip/tip
    
    Pull irq fixes from Thomas Gleixner:
     "Two fixlets for the armada SoC interrupt controller"
    
    * 'irq-urgent-for-linus' of git://git.kernel.org/pub/scm/linux/kernel/git/tip/tip:
      irqchip: armada-370-xp: Fix MPIC interrupt handling
      irqchip: armada-370-xp: Fix MSI interrupt handling

commit 80708677fab44a1489a089e162455dfb4dd722cd
Author: Mark Rutland <mark.rutland@arm.com>
Date:   Tue Nov 4 10:50:16 2014 +0000

    arm64: log physical ID of boot CPU
    
    In certain debugging scenarios it's useful to know the physical ID (i.e.
    the MPIDR_EL1.Aff* fields) of the boot CPU, but we don't currently log
    this as we do for 32-bit ARM kernels.
    
    This patch makes the kernel log the physical ID of the boot CPU early in
    the boot process. The CPU logical map initialisation is folded in to
    smp_setup_processor_id (which contrary to its name is also called by UP
    kernels). This is called before setup_arch, so should not adversely
    affect existing cpu_logical_map users.
    
    Acked-by: Sudeep Holla <sudeep.holla@arm.com>
    Acked-by: Catalin Marinas <catalin.marinas@arm.com>
    Acked-by: Lorenzo Pieralisis <lorenzo.pieralisi@arm.com>
    Signed-off-by: Mark Rutland <mark.rutland@arm.com>
    Signed-off-by: Will Deacon <will.deacon@arm.com>

commit 11175886daa6b31dfc713b6664215405de9ea1c7
Author: Joerg Roedel <jroedel@suse.de>
Date:   Mon Nov 3 18:16:56 2014 +0100

    iommu/rockchip: Allow to compile with COMPILE_TEST
    
    Add optional CONFIG_COMPILE_TEST to dependency list.
    
    Signed-off-by: Joerg Roedel <jroedel@suse.de>

commit 758e8366754d3fa57da978fef9d2c652f7b55c02
Author: Grzegorz Jaszczyk <jaz@semihalf.com>
Date:   Thu Sep 25 13:17:19 2014 +0200

    irqchip: armada-370-xp: Fix MPIC interrupt handling
    
    In both Armada-375 and Armada-38x MPIC interrupts should be identified by
    reading cause register multiplied by the interrupt mask.
    
    A lack of above mentioned multiplication resulted in a bug, caused by the
    fact that in Armada-375 and Armada-38x some of the interrupts
    (e.g. network interrupts) can be handled either as a GIC or MPIC interrupts.
    Therefore during MPIC interrupts handling, cause register shows hits from
    interrupts even if they are masked for MPIC but unmasked for a GIC.
    
    This resulted in 'bad IRQ' error, because masked MPIC interrupt without
    registered interrupt handler, was trying to be handled during interrupt
    handling procedure of some other unmasked MPIC interrupt (e.g. local timer
    irq).
    
    This commit fixes that by ensuring that during MPIC interrupt handling only
    interrupts that are unmasked for MPIC are processed.
    
    Signed-off-by: Grzegorz Jaszczyk <jaz@semihalf.com>
    Reviewed-by: Gregory CLEMENT <gregory.clement@free-electrons.com>
    Fixes: bc69b8adfe22 ("irqchip: armada-370-xp: Setup a chained handler for the MPIC")
    Cc: <stable@vger.kernel.org> # v3.15+
    Acked-by: Ezequiel Garcia <ezequiel.garcia@free-electrons.com>
    Link: https://lkml.kernel.org/r/1411643839-64925-3-git-send-email-jaz@semihalf.com
    Signed-off-by: Jason Cooper <jason@lakedaemon.net>

commit 298dcb2dd0267d51e4f7c94a628cd0765a50ad75
Author: Grzegorz Jaszczyk <jaz@semihalf.com>
Date:   Thu Sep 25 13:17:18 2014 +0200

    irqchip: armada-370-xp: Fix MSI interrupt handling
    
    The MSI interrupts use the 16 high doorbells, which are notified by using IRQ1
    of the main interrupt controller.
    
    The MSI interrupts were handled correctly for Armada-XP and Armada-370 but not
    for Armada-375 and Armada-38x, which use chained handler for the MPIC.
    
    This commit fixes that by checking proper interrupt number in chained handler
    for the MPIC.
    
    Signed-off-by: Grzegorz Jaszczyk <jaz@semihalf.com>
    Reviewed-by: Gregory CLEMENT <gregory.clement@free-electrons.com>
    Fixes: bc69b8adfe22 ("irqchip: armada-370-xp: Setup a chained handler for the MPIC")
    Cc: <stable@vger.kernel.org> # v3.15+
    Acked-by: Ezequiel Garcia <ezequiel.garcia@free-electrons.com>
    Link: https://lkml.kernel.org/r/1411643839-64925-2-git-send-email-jaz@semihalf.com
    Signed-off-by: Jason Cooper <jason@lakedaemon.net>

commit 5914ccf47bb0954210d64a92396632442c4f2a80
Author: Vinod Koul <vinod.koul@intel.com>
Date:   Thu Oct 16 13:54:29 2014 +0530

    ASoC: intel: turn off COMPILE_TEST for medfield
    
    Since medfield machine uses SCU_IPC which is not availble for all archs, so
    compile test fails on these
    
    Reported-by: kbuild test robot <fengguang.wu@intel.com>
    Signed-off-by: Vinod Koul <vinod.koul@intel.com>
    Signed-off-by: Mark Brown <broonie@kernel.org>

commit ad971f616aa98ea2503f1a1064637bfb4ef7b21e
Author: Eric Dumazet <edumazet@google.com>
Date:   Sat Oct 11 15:17:29 2014 -0700

    tcp: fix tcp_ack() performance problem
    
    We worked hard to improve tcp_ack() performance, by not accessing
    skb_shinfo() in fast path (cd7d8498c9a5 tcp: change tcp_skb_pcount()
    location)
    
    We still have one spurious access because of ACK timestamping,
    added in commit e1c8a607b281 ("net-timestamp: ACK timestamp for
    bytestreams")
    
    By checking if sk_tsflags has SOF_TIMESTAMPING_TX_ACK set,
    we can avoid two cache line misses for the common case.
    
    While we are at it, add two prefetchw() :
    
    One in tcp_ack() to bring skb at the head of write queue.
    
    One in tcp_clean_rtx_queue() loop to bring following skb,
    as we will delete skb from the write queue and dirty skb->next->prev.
    
    Add a couple of [un]likely() clauses.
    
    After this patch, tcp_ack() is no longer the most consuming
    function in tcp stack.
    
    Signed-off-by: Eric Dumazet <edumazet@google.com>
    Cc: Willem de Bruijn <willemb@google.com>
    Cc: Neal Cardwell <ncardwell@google.com>
    Cc: Yuchung Cheng <ycheng@google.com>
    Cc: Van Jacobson <vanj@google.com>
    Signed-off-by: David S. Miller <davem@davemloft.net>

commit 4d9708ea5e5a45973df7cf965805fdfb185dd5bf
Merge: 754c78095339 a66d05d504a2
Author: Linus Torvalds <torvalds@linux-foundation.org>
Date:   Fri Oct 10 22:04:49 2014 -0400

    Merge tag 'media/v3.18-rc1' of git://git.kernel.org/pub/scm/linux/kernel/git/mchehab/linux-media
    
    Pull media updates from Mauro Carvalho Chehab:
    
     - new IR driver: hix5hd2-ir
    
     - the virtual test driver (vivi) was replaced by vivid, with has an
       almost complete set of features to emulate most v4l2 devices and
       properly test all sorts of userspace apps
    
     - the as102 driver had several bugs fixed and was properly split into a
       frontend and a core driver.  With that, it got promoted from staging
       into mainstream
    
     - one new CI driver got added for CIMaX SP2/SP2HF (sp2 driver)
    
     - one new frontend driver for Toshiba ISDB-T/ISDB-S demod (tc90522)
    
     - one new PCI driver for ISDB-T/ISDB-S (pt3 driver)
    
     - saa7134 driver got support for go7007-based devices
    
     - added a new PCI driver for Techwell 68xx chipsets (tw68)
    
     - a new platform driver was added (coda)
    
     - new tuner drivers: mxl301rf and qm1d1c0042
    
     - a new DVB USB driver was added for DVBSky S860 & similar devices
    
     - added a new SDR driver (hackrf)
    
     - usbtv got audio support
    
     - several platform drivers are now compiled with COMPILE_TEST
    
     - a series of compiler fixup patches, making sparse/spatch happier with
       the media stuff and removing several warnings, especially on those
       platform drivers that didn't use to compile on x86
    
     - Support for several new modern devices got added
    
     - lots of other fixes, improvements and cleanups
    
    * tag 'media/v3.18-rc1' of git://git.kernel.org/pub/scm/linux/kernel/git/mchehab/linux-media: (544 commits)
      [media] ir-hix5hd2: fix build on c6x arch
      [media] pt3: fix DTV FE I2C driver load error paths
      Revert "[media] media: em28xx - remove reset_resume interface"
      [media] exynos4-is: fix some warnings when compiling on arm64
      [media] usb drivers: use %zu instead of %zd
      [media] pci drivers: use %zu instead of %zd
      [media] dvb-frontends: use %zu instead of %zd
      [media] s5p-mfc: Fix several printk warnings
      [media] s5p_mfc_opr: Fix warnings
      [media] ti-vpe: Fix typecast
      [media] s3c-camif: fix dma_addr_t printks
      [media] s5p_mfc_opr_v6: get rid of warnings when compiled with 64 bits
      [media] s5p_mfc_opr_v5: Fix lots of warnings on x86_64
      [media] em28xx: Fix identation
      [media] drxd: remove a dead code
      [media] saa7146: remove return after BUG()
      [media] cx88: remove return after BUG()
      [media] cx88: fix cards table CodingStyle
      [media] radio-sf16fmr2: declare some structs as static
      [media] radio-sf16fmi: declare pnp_attached as static
      ...

commit 5563caaf8b8cd22e35997d5d74cb3609df86b223
Author: Mauro Carvalho Chehab <mchehab@osg.samsung.com>
Date:   Thu Oct 9 10:41:28 2014 -0300

    [media] ir-hix5hd2: fix build on c6x arch
    
    While not all archs have readl_relaxed, we need to add a hack at the
    driver to allow it to COMPILE_TEST on all archs:
    
            drivers/media/rc/ir-hix5hd2.c: In function hix5hd2_ir_config:
            drivers/media/rc/ir-hix5hd2.c:100:2: error: implicit declaration of function readl_relaxed [-Werror=implicit-function-declaration]
    
    Signed-off-by: Mauro Carvalho Chehab <mchehab@osg.samsung.com>

commit 683a52a10148e929fb4844f9237f059a47c0b01b
Merge: b9af5643fdc5 69784fa539ef
Author: Linus Torvalds <torvalds@linux-foundation.org>
Date:   Wed Oct 8 06:52:11 2014 -0400

    Merge tag 'tty-3.18-rc1' of git://git.kernel.org/pub/scm/linux/kernel/git/gregkh/tty
    
    Pull tty/serial driver updates from Greg KH:
     "Here's the big tty/serial driver patchset for 3.18-rc1.
    
      Lots of little things in here, some good work from Peter Hurley on the
      tty core, and in lots of drivers.  There are also lots of other driver
      updates in here as well, full details in the changelogs.
    
      All have been in the linux-next tree for a while"
    
    * tag 'tty-3.18-rc1' of git://git.kernel.org/pub/scm/linux/kernel/git/gregkh/tty: (99 commits)
      Revert "serial/core: Initialize the console pm state"
      tty: serial: 8250: use 32bit variable for rpm_tx_active
      tty: serial: msm: Add earlycon support
      serial/core: Initialize the console pm state
      serial: asc: Conditionally use readl_relaxed (COMPILE_TEST)
      serial: of-serial: add PM suspend/resume support
      m68k: AMIGA_BUILTIN_SERIAL should depend on TTY
      asm/uapi: Add definition of TIOC[SG]RS485
      tty/metag_da: Add console_poll module parameter
      serial: 8250_pci: remove rts_n override from Baytrail quirk
      serial: cadence: Add generic earlycon support
      serial: imx: change the wait even to interruptiable
      serial: imx: terminate the RX DMA when the UART is suspending
      serial: imx: fix throttle/unthrottle callbacks for hardware assisted flow control
      serial: 8250: Add Quark X1000 to 8250_pci.c
      tty: omap-serial: pull out calculation from baud_is_mode16
      tty: omap-serial: fix division by zero
      xen_hvc: no reason to write the type key on xenstore
      tty: serial: 8250_core: remove UART_IER_RDI in serial8250_stop_rx()
      tty: serial: 8250_core: use the ->line argument as a hint in serial8250_find_match_or_unused()
      ...

commit 9ba10afe3202aaf3ace1e696ff017d0c0bf4e7a9
Merge: 4cb53f3f5195 75215193b975
Author: David S. Miller <davem@davemloft.net>
Date:   Tue Sep 30 16:37:13 2014 -0400

    Merge branch 'pxa168_eth'
    
    Antoine Tenart says:
    
    ====================
    ARM: Berlin: Ethernet support
    
    This series introduce support for the Ethernet controller on Berlin SoCs,
    using the existing pxa168 Ethernet driver. In order to do this, DT
    support is added to the driver alongside some other modifications and
    fixes.
    
    This has been tested on a Berlin BG2Q DMP board.
    
    Changes since v5:
            - fixed the build when building the driver as a module
    
    Changes since v4:
            - removed the phy-addr property and added a phy subnode
            - added COMPILE_TEST for the pxa168_eth driver
    
    Changes since v3:
            - moved the addition of pxa168_eth_get_mac_address() to the patch
              using it first
    
    Changes since v2:
            - reworked how the MAC address is configured
            - made the clock anonymous
    
    Changes since v1:
            - removed custom Berlin Ethernet driver
            - used the pxa168 Ethernet driver instead
            - made modifications to the pxa168 driver (DT support, fixes)
    ====================
    
    Signed-off-by: David S. Miller <davem@davemloft.net>

commit a140fcb2ede90980ef455b57995d6f1bd76084c0
Author: Antoine Tnart <antoine.tenart@free-electrons.com>
Date:   Tue Sep 30 16:28:14 2014 +0200

    net: pxa168_eth: allow to compile the pxa168_eth driver for tests
    
    Add a dependency to COMPILE_TEST so that the driver can be compiled for
    test purposes.
    
    Signed-off-by: Antoine Tenart <antoine.tenart@free-electrons.com>
    Acked-by: Arnd Bergmann <arnd@arndb.de>
    Signed-off-by: David S. Miller <davem@davemloft.net>

commit daea65a7be76953bb80d13d0ac43e7441fd42cdf
Author: Daniel Thompson <daniel.thompson@linaro.org>
Date:   Tue Sep 23 08:31:30 2014 +0100

    serial: asc: Conditionally use readl_relaxed (COMPILE_TEST)
    
    Commit 08177ece596c ("serial: asc: Adopt readl_/writel_relaxed()) is
    regressing the m68k allmodconfig build. This is due to the unconditional
    use of readl_relaxed() which, although documented, does not currently
    exist for m68k.
    
    This is trivially fixable for st-asc because we can just update the
    asc_in() accessor to make this conditional.
    
    Reported-by: Guenter Roeck <linux@roeck-us.net>
    Signed-off-by: Daniel Thompson <daniel.thompson@linaro.org>
    Cc: Srinivas Kandagatla <srinivas.kandagatla@gmail.com>
    Cc: Maxime Coquelin <maxime.coquelin@st.com>
    Cc: Patrice Chotard <patrice.chotard@st.com>
    Cc: Jiri Slaby <jslaby@suse.cz>
    Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>

commit 7b31997a734cd24c305d5c58a366e4c8f7673e02
Author: Uwe Kleine-Knig <u.kleine-koenig@pengutronix.de>
Date:   Fri Feb 21 14:42:26 2014 +0100

    gpio: kona: enable only on BCM_MOBILE or for compile testing
    
    This change makes it easier to configure a kernel for a real machine by
    not showing the option to enable it at all if COMPILE_TEST is off.
    
    Signed-off-by: Uwe Kleine-Knig <u.kleine-koenig@pengutronix.de>
    Acked-by: Markus Mayer <mmayer@broadcom.com>
    Signed-off-by: Linus Walleij <linus.walleij@linaro.org>

commit 93b8877471796c04c16fdef755d4e5c0f521509f
Author: Alexander Shiyan <shc_work@mail.ru>
Date:   Sat Sep 20 09:34:45 2014 +0400

    tty: serial_mctrl_gpio: Fix COMPILE_TEST build for architectures with custom termios.h
    
    This patch fixes COMPILE_TEST build of serial_mctrl_gpio module for
    architectures with custom termios.h header.
    
    sparc64:allmodconfig:
    
    In file included from drivers/tty/serial/serial_mctrl_gpio.c:21:0:
    include/uapi/asm-generic/termios.h:22:8: error: redefinition of 'struct termio'
    ./arch/sparc/include/uapi/asm/termbits.h:16:8: note: originally defined here
    make[3]: *** [drivers/tty/serial/serial_mctrl_gpio.o] Error 1
    
    Reported-by: Guenter Roeck <linux@roeck-us.net>
    Signed-off-by: Alexander Shiyan <shc_work@mail.ru>
    Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>

commit 4c8bab4d891fac7b44a8e26ec043c42bc910b391
Author: Sreekanth Reddy <sreekanth.reddy@avagotech.com>
Date:   Fri Sep 12 15:35:28 2014 +0530

    mpt3sas: MPI2.5 Rev H (2.5.3) specifications
    
    Below is the change set in MPI2.5 Rev H specification and 2.00.32 header files
    1) Added reserved fields to IO Unit Page 7 for future use.
    2) Added optional functionality to IOCInit Request so that
       the host may specify a separate base address for each
       Reply Descriptor Post Queue. IOC support for this is
       indicated using a new IOCCapabilities bit in the IOCFacts Reply.
    3) Added Toolbox Console Text Display Tool
       The host uses the Console Text Display Tool to send a string to
       IOC's Console using different console types (eg: UART serial terminal or Ethernet terminal).
    4) Firmware images can now be signed using an encrypted hash.
    5) Added MPI2_SAS_OP_TRANSMIT_PORT_SELECT_SIGNAL
    6) Added more details about configuration page restrictions when Host Based Discovery is enabled
       Enabling host based discovery affects the availability of some configuration pages and events.
       The SAS Expander, SAS Device, and SAS Enclosure configuration  pages are not available from the IOC.
       The IOC returns an error status to any Configuration Request message attempting to access these pages.
       The IOC does not send the SAS Discovery Event, the SAS Topology Change List Event, or
       the SAS Enclosure Device Status Change Event when host based discovery is enabled.
    7) Bit 13 of the SAS IO Unit Page 1 ControlFlags field is now obsolete.
       It was used to enable limiting direct attached SATA maximum link rate to 1.5 Gbps.
    
    Signed-off-by: Sreekanth Reddy <Sreekanth.Reddy@avagotech.com>
    Reviewed-by: Martin K. Petersen <martin.petersen@oracle.com>
    Signed-off-by: Christoph Hellwig <hch@lst.de>

commit 861ff736c8d8ae574dcc1ef81e5da84ff85e70c9
Author: Sreekanth Reddy <sreekanth.reddy@avagotech.com>
Date:   Fri Sep 12 15:35:25 2014 +0530

    mpt3sas: MPI2.5 Rev G (2.5.2) specifications
    
    Below is the change set in MPI2.5 Rev G specification and 2.00.31 header files
    1) Added SCSIStatusQualifier to SCSI IO Error Reply message.
    2) Added ATA Security Freeze Lock to IO Unit Page 1 Flags field.
    3) Added Allow Protection Information bit for IR Volume Create.
    
    Signed-off-by: Sreekanth Reddy <Sreekanth.Reddy@avagotech.com>
    Reviewed-by: Martin K. Petersen <martin.petersen@oracle.com>
    Signed-off-by: Christoph Hellwig <hch@lst.de>

commit daeaa9df92bd742f4e6d4d6039d689277a8e31bd
Author: Sreekanth Reddy <sreekanth.reddy@avagotech.com>
Date:   Fri Sep 12 15:35:21 2014 +0530

    mpt2sas: Avoid type casting for direct I/O commands
    
    A type casting error caused the max volume LBA to be truncated from 64
    to 32 bits. The virtual LBA would also get truncated to 32 bits in the
    case of a 16-byte READ/WRITE command.
    
    Rewrite entire function to get rid of code duplication and type casts.
    Use get/put_unaligned wrappers to extract and replace the LBA field in
    the MPI request CDB.
    
    Signed-off-by: Martin K. Petersen <martin.petersen@oracle.com>
    Tested-by: Sreekanth Reddy <Sreekanth.Reddy@avagotech.com>
    Signed-off-by: Christoph Hellwig <hch@lst.de>

commit ff4637d6d1f2f4fdf014404b5b4b1d1e4adc6283
Author: Sreekanth Reddy <sreekanth.reddy@avagotech.com>
Date:   Fri Sep 12 15:35:17 2014 +0530

    mpt2sas: MPI2 Rev Y (2.00.17) and Rev Z (2.00.18) specifications
    
    Below is the change set in MPI2 Rev Y specification and in 2.00.17 header files
    1) Added SCSIStatusQualifier to SCSI IO Error Reply message.
    2) Added ATA Security Freeze Lock to IO Unit Page 1 Flags field.
    
    Below is the change set in MPI2 Rev Z specification and in 2.00.19 header files
    1) Added reserved fields to IO Unit Page 7 for future use.
    2) Added optional functionality to IOCInit Request so that
       the host may specify a separate base address for each
       Reply Descriptor Post Queue. IOC support for this is
       indicated using a new IOCCapabilities bit in the IOCFacts Reply.
    3) Added Toolbox Console Text Display Tool
       The host uses the Console Text Display Tool to send a string to
       IOC's Console using different console types (eg: UART serial terminal or Ethernet terminal).
    
    The copyright in the mpi files is updated for year 2014
    
    Signed-off-by: Sreekanth Reddy <Sreekanth.Reddy@avagotech.com>
    Reviewed-by: Martin K. Petersen <martin.petersen@oracle.com>
    Signed-off-by: Christoph Hellwig <hch@lst.de>

commit 08177ece596ccc9b9c194542c095c863c101fd11
Author: Daniel Thompson <daniel.thompson@linaro.org>
Date:   Tue Sep 9 11:03:57 2014 +0100

    serial: asc: Adopt readl_/writel_relaxed()
    
    The architectures supported by this driver, arm and sh, have expensive
    implementations of writel(), reliant on spin locks and explicit L2 cache
    management. These architectures provide a cheaper writel_relaxed() which
    is much better suited to peripherals that do not perform DMA. The
    situation with readl()/readl_relaxed()is similar although less acute.
    
    This driver does not use DMA and will be more power efficient and more
    robust (due to absence of spin locks during console I/O) if it uses the
    relaxed variants.
    
    The driver supports COMPILE_TEST and therefore falls back to writel()
    when writel_relaxed() does not exist.
    
    Signed-off-by: Daniel Thompson <daniel.thompson@linaro.org>
    Acked-by: Srinivas Kandagatla <srinivas.kandagatla@gmail.com>
    Cc: Maxime Coquelin <maxime.coquelin@st.com>
    Cc: Patrice Chotard <patrice.chotard@st.com>
    Cc: Jiri Slaby <jslaby@suse.cz>
    Cc: kernel@stlinux.com
    Cc: linux-serial@vger.kernel.org
    Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>

commit efb089517d2f34a58aceb600ab58b0ca3db1fa07
Author: Alexander Shiyan <shc_work@mail.ru>
Date:   Tue Sep 9 08:14:36 2014 +0400

    serial: clps711x: Fix COMPILE_TEST build for target without GPIOLIB support
    
    The patch fixes the following build error of CLPS711X serial driver for
    targets without GPIOLIB support:
    
    >> drivers/tty/serial/serial_mctrl_gpio.c:44:6: error: redefinition of 'mctrl_gpio_set'
      void mctrl_gpio_set(struct mctrl_gpios *gpios, unsigned int mctrl)
          ^
      In file included from drivers/tty/serial/serial_mctrl_gpio.c:23:0:
      drivers/tty/serial/serial_mctrl_gpio.h:80:6: note: previous definition of 'mctrl_gpio_set' was here
      void mctrl_gpio_set(struct mctrl_gpios *gpios, unsigned int mctrl)
          ^
    
    Reported-by: kbuild test robot <fengguang.wu@intel.com>
    Signed-off-by: Alexander Shiyan <shc_work@mail.ru>
    Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>

commit 8087c35fc48c9545ee1f07bd812217b286cf13bb
Author: Mauro Carvalho Chehab <m.chehab@samsung.com>
Date:   Tue Sep 9 11:21:30 2014 -0300

    [media] s5p-jpeg: Fix compilation with COMPILE_TEST
    
    ERROR: "__bad_ndelay" [drivers/media/platform/s5p-jpeg/s5p-jpeg.ko] undefined!
    
    That happens because asm-generic doesn't like any ndelay time
    bigger than 20us.
    
    Currently, usleep_range() couldn't simply be used, since
    exynos4_jpeg_sw_reset() is called with a spinlock held.
    
    So, let's use udelay() instead.
    
    Reported-by: Stephen Rothwell <sfr@canb.auug.org.au>
    Acked-by: Sylwester Nawrocki <s.nawrocki@samsung.com>
    Signed-off-by: Mauro Carvalho Chehab <m.chehab@samsung.com>

commit 4228cd5682f07b6cf5dfd3eb5e003766f5640ee2
Author: Mauro Carvalho Chehab <m.chehab@samsung.com>
Date:   Tue Sep 9 14:55:15 2014 -0300

    [media] disable COMPILE_TEST for omap1_camera
    
    This driver depends on a legacy OMAP DMA API. So, it won't
    compile-test on other archs.
    
    While we might add stubs to the functions, this is not a
    good idea, as the hole API should be replaced.
    
    So, for now, let's just remove COMPILE_TEST and wait for
    some time for people to fix. If not fixed, then we'll end
    by removing this driver as a hole.
    
    Acked-by: Guennadi Liakhovetski <g.liakhovetski@gmx.de>
    Signed-off-by: Mauro Carvalho Chehab <m.chehab@samsung.com>

commit c199105d154e029cd8c94cccd35bd073e64acc45
Author: Willem de Bruijn <willemb@google.com>
Date:   Wed Sep 3 12:01:18 2014 -0400

    net-timestamp: only report sw timestamp if reporting bit is set
    
    The timestamping API has separate bits for generating and reporting
    timestamps. A software timestamp should only be reported for a packet
    when the packet has the relevant generation flag (SKBTX_..) set
    and the socket has reporting bit SOF_TIMESTAMPING_SOFTWARE set.
    
    The second check was accidentally removed. Reinstitute the original
    behavior.
    
    Tested:
      Without this patch, Documentation/networking/txtimestamp reports
      timestamps regardless of whether SOF_TIMESTAMPING_SOFTWARE is set.
      After the patch, it only reports them when the flag is set.
    
    Fixes: f24b9be5957b ("net-timestamp: extend SCM_TIMESTAMPING ancillary data struct")
    Signed-off-by: Willem de Bruijn <willemb@google.com>
    Signed-off-by: David S. Miller <davem@davemloft.net>

commit 67e35c3a79b7349a9b0dbe1dd0bf82def0296714
Author: Tudor Laurentiu <b10716@freescale.com>
Date:   Wed Aug 13 16:55:13 2014 +0300

    powerpc/fsl_msi: support vmpic msi with mpic 4.3
    
    The new MSI block in MPIC 4.3 added the MSIIR1 register,
    with a different layout, in order to support 16 MSIR
    registers. The msi binding was also updated so that
    the "reg" reflects the newly introduced MSIIR1 register.
    Virtual machines advertise these msi nodes by using the
    compatible "fsl,vmpic-msi-v4.3" so add support for it.
    
    Signed-off-by: Laurentiu Tudor <Laurentiu.Tudor@freescale.com>
    Cc: Scott Wood <scottwood@freescale.com>
    Signed-off-by: Scott Wood <scottwood@freescale.com>

commit f59838a07ae5b26d2e050bc0227599932d22b549
Author: Geert Uytterhoeven <geert@linux-m68k.org>
Date:   Fri Aug 29 18:10:31 2014 +0200

    spi/drivers: Restrict COMPILE_TEST by HAS_DMA where needed
    
    commit dd1053a93fdc11d4 ("spi/drivers: Enable build of drivers with
    COMPILE_TEST") allows compile-testing drivers on platforms they're not
    meant for.
    
    However, adding "|| COMPILE_TEST" bypasses all other implicit dependencies
    assumed by the platform dependencies before, like HAS_DMA.
    
    If NO_DMA=y:
    
    drivers/built-in.o: In function `atmel_spi_dma_unmap_xfer':
    drivers/spi/spi-atmel.c:915: undefined reference to `dma_unmap_single'
    drivers/spi/spi-atmel.c:918: undefined reference to `dma_unmap_single'
    drivers/built-in.o: In function `atmel_spi_next_xfer_data':
    drivers/spi/spi-atmel.c:690: undefined reference to `dma_sync_single_for_cpu'
    drivers/built-in.o: In function `atmel_spi_dma_map_xfer':
    drivers/spi/spi-atmel.c:890: undefined reference to `dma_map_single'
    drivers/spi/spi-atmel.c:893: undefined reference to `dma_mapping_error'
    drivers/spi/spi-atmel.c:897: undefined reference to `dma_map_single'
    drivers/spi/spi-atmel.c:900: undefined reference to `dma_mapping_error'
    drivers/spi/spi-atmel.c:902: undefined reference to `dma_unmap_single'
    drivers/built-in.o: In function `atmel_spi_probe':
    drivers/spi/spi-atmel.c:1540: undefined reference to `dma_alloc_coherent'
    drivers/spi/spi-atmel.c:1623: undefined reference to `dma_free_coherent'
    drivers/built-in.o: In function `atmel_spi_remove':
    drivers/spi/spi-atmel.c:1665: undefined reference to `dma_free_coherent'
    drivers/built-in.o: In function `ep93xx_spi_dma_finish':
    drivers/spi/spi-ep93xx.c:550: undefined reference to `dma_unmap_sg'
    drivers/built-in.o: In function `ep93xx_spi_dma_prepare':
    drivers/spi/spi-ep93xx.c:516: undefined reference to `dma_map_sg'
    drivers/spi/spi-ep93xx.c:522: undefined reference to `dma_unmap_sg'
    drivers/built-in.o: In function `omap2_mcspi_rx_dma':
    drivers/spi/spi-omap2-mcspi.c:475: undefined reference to `dma_unmap_single'
    drivers/built-in.o: In function `omap2_mcspi_txrx_dma':
    drivers/spi/spi-omap2-mcspi.c:589: undefined reference to `dma_unmap_single'
    drivers/built-in.o: In function `omap2_mcspi_transfer_one_message':
    drivers/spi/spi-omap2-mcspi.c:1202: undefined reference to `dma_map_single'
    drivers/spi/spi-omap2-mcspi.c:1204: undefined reference to `dma_mapping_error'
    drivers/spi/spi-omap2-mcspi.c:1211: undefined reference to `dma_map_single'
    drivers/spi/spi-omap2-mcspi.c:1213: undefined reference to `dma_mapping_error'
    drivers/spi/spi-omap2-mcspi.c:1217: undefined reference to `dma_unmap_single'
    drivers/built-in.o: In function `tegra_spi_deinit_dma_param':
    drivers/spi/spi-tegra114.c:675: undefined reference to `dma_free_coherent'
    drivers/built-in.o: In function `tegra_spi_copy_spi_rxbuf_to_client_rxbuf':
    drivers/spi/spi-tegra114.c:415: undefined reference to `dma_sync_single_for_cpu'
    drivers/spi/spi-tegra114.c:440: undefined reference to `dma_sync_single_for_cpu'
    drivers/built-in.o: In function `tegra_spi_copy_client_txbuf_to_spi_txbuf':
    drivers/spi/spi-tegra114.c:381: undefined reference to `dma_sync_single_for_cpu'
    drivers/spi/spi-tegra114.c:405: undefined reference to `dma_sync_single_for_cpu'
    drivers/built-in.o: In function `tegra_spi_start_dma_based_transfer':
    drivers/spi/spi-tegra114.c:543: undefined reference to `dma_sync_single_for_cpu'
    drivers/built-in.o: In function `tegra_slink_deinit_dma_param':
    drivers/spi/spi-tegra20-slink.c:705: undefined reference to `dma_free_coherent'
    drivers/built-in.o: In function `tegra_slink_copy_spi_rxbuf_to_client_rxbuf':
    drivers/spi/spi-tegra20-slink.c:427: undefined reference to `dma_sync_single_for_cpu'
    drivers/spi/spi-tegra20-slink.c:452: undefined reference to `dma_sync_single_for_cpu'
    drivers/built-in.o: In function `tegra_slink_copy_client_txbuf_to_spi_txbuf':
    drivers/spi/spi-tegra20-slink.c:393: undefined reference to `dma_sync_single_for_cpu'
    drivers/spi/spi-tegra20-slink.c:417: undefined reference to `dma_sync_single_for_cpu'
    drivers/built-in.o: In function `tegra_slink_start_dma_based_transfer':
    drivers/spi/spi-tegra20-slink.c:561: undefined reference to `dma_sync_single_for_cpu'
    
    Add dependencies on HAS_DMA to fix this.
    
    Signed-off-by: Geert Uytterhoeven <geert@linux-m68k.org>
    Signed-off-by: Mark Brown <broonie@kernel.org>

commit 38a0731165250a0a77eff7b90ea3156d44cc7d66
Author: Mauro Carvalho Chehab <m.chehab@samsung.com>
Date:   Tue Aug 26 16:51:56 2014 -0300

    [media] omap: be sure that MMU is there for COMPILE_TEST
    
    COMPILE_TEST fail on (some) archs without MMU.
    
    Signed-off-by: Mauro Carvalho Chehab <m.chehab@samsung.com>

commit 7155043c2d027c9c848c3d09badb5af2894ed652
Author: Mauro Carvalho Chehab <m.chehab@samsung.com>
Date:   Wed Aug 20 13:21:35 2014 -0600

    [media] enable COMPILE_TEST for media drivers
    
    There are several arch-specific media drivers that don't
    require asm-specific includes and can be successfully
    compiled on x86. Add COMPILE_TEST dependency for them, in
    order to allow a broader test on those drivers.
    
    That helps static analysis tools like Coverity to discover
    eventual troubles there.
    
    Signed-off-by: Mauro Carvalho Chehab <m.chehab@samsung.com>

commit 1dbfacf2dd30100ea38181f9cc25feaaa9204630
Author: Mauro Carvalho Chehab <m.chehab@samsung.com>
Date:   Wed Aug 20 13:56:21 2014 -0600

    [media] enable COMPILE_TEST for OMAP2 vout
    
    We don't need anything special to enable COMPILE_TEST for
    this driver.
    
    Signed-off-by: Mauro Carvalho Chehab <m.chehab@samsung.com>

commit f2080e38813a3b04d4a6fde5a2697f47cfec4ee5
Author: Mauro Carvalho Chehab <m.chehab@samsung.com>
Date:   Wed Aug 20 13:50:03 2014 -0600

    [media] allow COMPILE_TEST for SAMSUNG_EXYNOS4_IS
    
    That helps some static checks, so enable it. While there, it was
    noticed that linux/sizes.h was missing:
    
    drivers/media/platform/exynos4-is/mipi-csis.c: In function s5pcsis_s_rx_buffer:
    drivers/media/platform/exynos4-is/mipi-csis.c:114:31: error: SZ_4K undeclared (first use in this function)
     #define S5PCSIS_PKTDATA_SIZE  SZ_4K
                                   ^
    
    Signed-off-by: Mauro Carvalho Chehab <m.chehab@samsung.com>

commit f3334180d4790856bae42fb2e7a3137f9a36aa18
Author: Mauro Carvalho Chehab <m.chehab@samsung.com>
Date:   Wed Aug 20 13:41:56 2014 -0600

    [media] enable COMPILE_TEST for ti-vbe
    
    Allowing COMPILE_TEST here is trivial, but there's one missing
    header to be added:
    
    drivers/media/platform/ti-vpe/vpe.c: In function vpe_probe:
    drivers/media/platform/ti-vpe/vpe.c:2266:56: error: SZ_32K undeclared (first use in this function)
      dev->base = devm_ioremap(&pdev->dev, dev->res->start, SZ_32K);
                                                            ^
    
    Signed-off-by: Mauro Carvalho Chehab <m.chehab@samsung.com>

commit 1c17d8c748b251071c61a4383490881a4071b003
Author: Mauro Carvalho Chehab <m.chehab@samsung.com>
Date:   Wed Aug 20 13:35:22 2014 -0600

    [media] enable COMPILE_TEST for MX2 eMMa-PrP driver
    
    By allowing compilation on all archs, we can use static
    analysis tools to test this driver.
    
    In order to do that, replace asm/sizes.h by its generic
    name (linux/sizes.h), with should keep doing the right
    thing.
    
    Signed-off-by: Mauro Carvalho Chehab <m.chehab@samsung.com>

commit a8e4def604a9affa04fdd4efa0692da1385ffa3f
Merge: d429a3639ca9 c83c8737e3ed
Author: Linus Torvalds <torvalds@linux-foundation.org>
Date:   Thu Aug 14 09:15:53 2014 -0600

    Merge tag 'mmc-v3.17-1' of git://git.linaro.org/people/ulf.hansson/mmc
    
    Pull MMC updates from Ulf Hansson:
     "Me and Chris Ball decided to try out using my MMC tree as the primary
      one, to simplify handling of patches.
    
      This pull does thus contains all the MMC patches for 3.17 rc1, no pull
      from Chris this time.
    
      Details:
    
      MMC core:
       - forward compatibility for eMMC
       - fix some blacklisted cards with broken secure discard
    
      MMC host:
       - mmci: Add support for Qualcomm variant
       - mmci: Fix regression for arm_variant
       - sdhci: Various fixes and cleanups
       - sdhci: Improve external VDD regulator support
       - sdhci: Support for DDR50 1.8V mode for BayTrail
       - sdhci-st: Add driver for ST SDHCI controller
       - sh-mmcif: DMA fixes
       - omap_hsmmc: Add support for SDIO interrupts
       - sdhci-pci: Add support for Intel Quark X1000
       - dw_mmc: Update the reset sequence
       - s3cmci: port DMA code to dmaengine API"
    
    * tag 'mmc-v3.17-1' of git://git.linaro.org/people/ulf.hansson/mmc: (67 commits)
      mmc: dw_mmc: modify the dt-binding for removing slot-node and supports-highspeed
      mmc: dw_mmc: Slot quirk "disable-wp" is deprecated.
      mmc: mmci: Reverse IRQ handling for the arm_variant
      mmc: mmci: Move all CMD irq handling to mmci_cmd_irq()
      mmc: mmci: Remove redundant check of status for DATA irq
      mmc: dw_mmc: change to use recommended reset procedure
      mmc: sdhci-pxav3: Use devm_* managed helpers
      mmc: tmio: Configure DMA slave bus width
      mmc: sh_mmcif: Configure DMA slave bus width
      mmc: sh_mmcif: Fix DMA slave address configuration
      mmc: sh_mmcif: Document DT bindings
      mmc: sdhci-pci: remove PCI PM functions in suspend/resume callback
      mmc: Do not advertise secure discard if it is blacklisted
      mmc: sdhci-msm: Get COMPILE_TEST support
      mmc: sdhci-msm: Remove unnecessary header file inclusion
      mmc: sdhci-msm: Fix the binding example
      mmc: sdhci: add DDR50 1.8V mode support for BayTrail eMMC Controller
      mmc: sdhci: Preset value not supported in Baytrail eMMC
      mmc: MMC_USDHI6ROL0 should depend on HAS_DMA
      mmc: MMC_SH_MMCIF should depend on HAS_DMA
      ...

commit 441fb7684782be3553c67dc04defcf304b999bba
Author: Jean Delvare <jdelvare@suse.de>
Date:   Fri Aug 8 14:20:05 2014 -0700

    drivers/rtc/Kconfig: add hardware dependency to rtc-moxart
    
    The rtc-moxart driver is only useful on MOXA ART systems so it should
    depend on ARCH_MOXART as all other MOXA ART drivers already do.  Add
    COMPILE_TEST as an alternative to allow for build testing on other
    systems.
    
    Signed-off-by: Jean Delvare <jdelvare@suse.de>
    Cc: Alessandro Zummo <a.zummo@towertech.it>
    Cc: Jonas Jensen <jonas.jensen@gmail.com>
    Signed-off-by: Andrew Morton <akpm@linux-foundation.org>
    Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>

commit 158c12948f3012fbe15f066f308db23502d3db0a
Merge: 172bfe09dc52 51a7097426f2
Author: Linus Torvalds <torvalds@linux-foundation.org>
Date:   Wed Aug 6 21:03:53 2014 -0700

    Merge branch 'for-linus' of git://git.kernel.org/pub/scm/linux/kernel/git/jikos/trivial
    
    Pull trivial tree changes from Jiri Kosina:
     "Summer edition of trivial tree updates"
    
    * 'for-linus' of git://git.kernel.org/pub/scm/linux/kernel/git/jikos/trivial: (23 commits)
      doc: fix two typos in watchdog-api.txt
      irq-gic: remove file name from heading comment
      MAINTAINERS: Add miscdevice.h to file list for char/misc drivers.
      scsi: mvsas: mv_sas.c: Fix for possible null pointer dereference
      doc: replace "practise" with "practice" in Documentation
      befs: remove check for CONFIG_BEFS_RW
      scsi: doc: fix 'SCSI_NCR_SETUP_MASTER_PARITY'
      drivers/usb/phy/phy.c: remove a leading space
      mfd: fix comment
      cpuidle: fix comment
      doc: hpfall.c: fix missing null-terminate after strncpy call
      usb: doc: hotplug.txt code typos
      kbuild: fix comment in Makefile.modinst
      SH: add proper prompt to SH_MAGIC_PANEL_R2_VERSION
      ARM: msm: Remove MSM_SCM
      crypto: Remove MPILIB_EXTRA
      doc: CN: remove dead link, kerneltrap.org no longer works
      media: update reference, kerneltrap.org no longer works
      hexagon: update reference, kerneltrap.org no longer works
      doc: LSM: update reference, kerneltrap.org no longer works
      ...

commit ae045e2455429c418a418a3376301a9e5753a0a8
Merge: f4f142ed4ef8 d247b6ab3ce6
Author: Linus Torvalds <torvalds@linux-foundation.org>
Date:   Wed Aug 6 09:38:14 2014 -0700

    Merge git://git.kernel.org/pub/scm/linux/kernel/git/davem/net-next
    
    Pull networking updates from David Miller:
     "Highlights:
    
       1) Steady transitioning of the BPF instructure to a generic spot so
          all kernel subsystems can make use of it, from Alexei Starovoitov.
    
       2) SFC driver supports busy polling, from Alexandre Rames.
    
       3) Take advantage of hash table in UDP multicast delivery, from David
          Held.
    
       4) Lighten locking, in particular by getting rid of the LRU lists, in
          inet frag handling.  From Florian Westphal.
    
       5) Add support for various RFC6458 control messages in SCTP, from
          Geir Ola Vaagland.
    
       6) Allow to filter bridge forwarding database dumps by device, from
          Jamal Hadi Salim.
    
       7) virtio-net also now supports busy polling, from Jason Wang.
    
       8) Some low level optimization tweaks in pktgen from Jesper Dangaard
          Brouer.
    
       9) Add support for ipv6 address generation modes, so that userland
          can have some input into the process.  From Jiri Pirko.
    
      10) Consolidate common TCP connection request code in ipv4 and ipv6,
          from Octavian Purdila.
    
      11) New ARP packet logger in netfilter, from Pablo Neira Ayuso.
    
      12) Generic resizable RCU hash table, with intial users in netlink and
          nftables.  From Thomas Graf.
    
      13) Maintain a name assignment type so that userspace can see where a
          network device name came from (enumerated by kernel, assigned
          explicitly by userspace, etc.) From Tom Gundersen.
    
      14) Automatic flow label generation on transmit in ipv6, from Tom
          Herbert.
    
      15) New packet timestamping facilities from Willem de Bruijn, meant to
          assist in measuring latencies going into/out-of the packet
          scheduler, latency from TCP data transmission to ACK, etc"
    
    * git://git.kernel.org/pub/scm/linux/kernel/git/davem/net-next: (1536 commits)
      cxgb4 : Disable recursive mailbox commands when enabling vi
      net: reduce USB network driver config options.
      tg3: Modify tg3_tso_bug() to handle multiple TX rings
      amd-xgbe: Perform phy connect/disconnect at dev open/stop
      amd-xgbe: Use dma_set_mask_and_coherent to set DMA mask
      net: sun4i-emac: fix memory leak on bad packet
      sctp: fix possible seqlock seadlock in sctp_packet_transmit()
      Revert "net: phy: Set the driver when registering an MDIO bus device"
      cxgb4vf: Turn off SGE RX/TX Callback Timers and interrupts in PCI shutdown routine
      team: Simplify return path of team_newlink
      bridge: Update outdated comment on promiscuous mode
      net-timestamp: ACK timestamp for bytestreams
      net-timestamp: TCP timestamping
      net-timestamp: SCHED timestamp on entering packet scheduler
      net-timestamp: add key to disambiguate concurrent datagrams
      net-timestamp: move timestamp flags out of sk_flags
      net-timestamp: extend SCM_TIMESTAMPING ancillary data struct
      cxgb4i : Move stray CPL definitions to cxgb4 driver
      tcp: reduce spurious retransmits due to transient SACK reneging
      qlcnic: Initialize dcbnl_ops before register_netdev
      ...

commit 618896e6d00773d6d50e0b19f660af22fa26cd61
Merge: a2b81b35f9e5 e1c8a607b281
Author: David S. Miller <davem@davemloft.net>
Date:   Tue Aug 5 16:36:01 2014 -0700

    Merge branch 'net-timestamp-next'
    
    Willem de Bruijn says:
    
    ====================
    net-timestamp: new tx tstamps and tcp
    
    Extend socket tx timestamping:
    - allow multiple types of software timestamps aside from send (1)
    - add software timestamp on enter packet scheduling (4)
    - add software timestamp for TCP (5)
    - add software timestamp for TCP on ACK (6)
    
    The sk_flags option space is nearly exhausted. Also move the
    many timestamp options to a new sk->sk_tstamps (2).
    
    To disambiguate data when tstamps may arrive out of order,
    optionally return a sequential ID assigned at send (3).
    
    Extend Linux tx timestamping to monitoring of latency
    incurred within the kernel stack and to protocols embedded in TCP.
    Complex kernel setups may have multiple layers of queueing, including
    multiple instances of packet scheduling, and many classes per layer.
    Many applications embed discrete payloads into TCP bytestreams for
    reliability, flow control, etcetera. Detecting application tail
    latency in such scenarios relies on identifying the exact queue
    responsible if on the host, or the network latency if otherwise.
    
    Changelog:
    v4->v5
      - define SCM_TSTAMP_SND == 0, for legacy behavior
      - add TCP tstamps without changing the generated byte stream
       - modify GSO and ACK to find offset: slightly more complex
          than previous invariant that it is the last byte
      - consistent naming of packet scheduling
       - rename SCM_TSTAMP_ENQ to SCM_TSTAMP_SCHED
      - add unique key in ee_data
      - add id field in ee_info to disambiguate tstamps
       - optional, only on new flag SOF_TIMESTAMPING_OPT_ID
       - for bytestream, in bytes
    
    v3->v4
      - (v3 review comment) removed skb->mark packet identification (*A)
      - (v3 review comment) fixed indentation
      - tcp: fixed poll() to return POLLERR on non-zero queue
      - rebased to work without syststamp
      - comments: removed all traces of MSG_TSTAMP_.. (*B)
    
    v2->v3
      - extend the SO_TIMESTAMPING API, instead of defining a new one.
      - add protocol independent support to correlate tstamps with data,
        based on returning skb->mark.
      - removed no-payload optimization and documentation (for now):
    
        I have a follow-on patch that reintroduces MSG_TSTAMP along with a
        new socket option SOF_TIMESTAMPING_OPT_ONFLAG. This is equivalent
        to sequence setsockopt(<enable>); send(..); setsockopt(<disable>),
        but avoids the need to define a MSG_TSTAMP_<TYPE> for each type.
    
        I will leave these three patches as follow-on, as this patchset is
        large enough as is.
    
    v1->v2
      - expand timestamping (existing and new) to SOCK_RAW and ping sockets
      - rename sock_errqueue_timestamping to scm_timestamping
      - change timestamp data format: do not add fields to scm_timestamping.
          Doing so could break legacy applications. Instead, communicate
          through an existing, but unused, field in the error message.
      - rename SOF_.._OPT_TX_NO_PAYLOAD to shorter SOF_.._OPT_TSONLY
      - move msg_tstamp test app out of patchset and to github
          git://github.com/wdebruij/kerneltools.git
    ====================
    
    Signed-off-by: David S. Miller <davem@davemloft.net>

commit e1c8a607b28190cd09a271508aa3025d3c2f312e
Author: Willem de Bruijn <willemb@google.com>
Date:   Mon Aug 4 22:11:50 2014 -0400

    net-timestamp: ACK timestamp for bytestreams
    
    Add SOF_TIMESTAMPING_TX_ACK, a request for a tstamp when the last byte
    in the send() call is acknowledged. It implements the feature for TCP.
    
    The timestamp is generated when the TCP socket cumulative ACK is moved
    beyond the tracked seqno for the first time. The feature ignores SACK
    and FACK, because those acknowledge the specific byte, but not
    necessarily the entire contents of the buffer up to that byte.
    
    Signed-off-by: Willem de Bruijn <willemb@google.com>
    Signed-off-by: David S. Miller <davem@davemloft.net>

commit 4ed2d765dfaccff5ebdac68e2064b59125033a3b
Author: Willem de Bruijn <willemb@google.com>
Date:   Mon Aug 4 22:11:49 2014 -0400

    net-timestamp: TCP timestamping
    
    TCP timestamping extends SO_TIMESTAMPING to bytestreams.
    
    Bytestreams do not have a 1:1 relationship between send() buffers and
    network packets. The feature interprets a send call on a bytestream as
    a request for a timestamp for the last byte in that send() buffer.
    
    The choice corresponds to a request for a timestamp when all bytes in
    the buffer have been sent. That assumption depends on in-order kernel
    transmission. This is the common case. That said, it is possible to
    construct a traffic shaping tree that would result in reordering.
    The guarantee is strong, then, but not ironclad.
    
    This implementation supports send and sendpages (splice). GSO replaces
    one large packet with multiple smaller packets. This patch also copies
    the option into the correct smaller packet.
    
    This patch does not yet support timestamping on data in an initial TCP
    Fast Open SYN, because that takes a very different data path.
    
    If ID generation in ee_data is enabled, bytestream timestamps return a
    byte offset, instead of the packet counter for datagrams.
    
    The implementation supports a single timestamp per packet. It silenty
    replaces requests for previous timestamps. To avoid missing tstamps,
    flush the tcp queue by disabling Nagle, cork and autocork. Missing
    tstamps can be detected by offset when the ee_data ID is enabled.
    
    Implementation details:
    
    - On GSO, the timestamping code can be included in the main loop. I
    moved it into its own loop to reduce the impact on the common case
    to a single branch.
    
    - To avoid leaking the absolute seqno to userspace, the offset
    returned in ee_data must always be relative. It is an offset between
    an skb and sk field. The first is always set (also for GSO & ACK).
    The second must also never be uninitialized. Only allow the ID
    option on sockets in the ESTABLISHED state, for which the seqno
    is available. Never reset it to zero (instead, move it to the
    current seqno when reenabling the option).
    
    Signed-off-by: Willem de Bruijn <willemb@google.com>
    Signed-off-by: David S. Miller <davem@davemloft.net>

commit 09c2d251b70723650ba47e83571ff49281320f7c
Author: Willem de Bruijn <willemb@google.com>
Date:   Mon Aug 4 22:11:47 2014 -0400

    net-timestamp: add key to disambiguate concurrent datagrams
    
    Datagrams timestamped on transmission can coexist in the kernel stack
    and be reordered in packet scheduling. When reading looped datagrams
    from the socket error queue it is not always possible to unique
    correlate looped data with original send() call (for application
    level retransmits). Even if possible, it may be expensive and complex,
    requiring packet inspection.
    
    Introduce a data-independent ID mechanism to associate timestamps with
    send calls. Pass an ID alongside the timestamp in field ee_data of
    sock_extended_err.
    
    The ID is a simple 32 bit unsigned int that is associated with the
    socket and incremented on each send() call for which software tx
    timestamp generation is enabled.
    
    The feature is enabled only if SOF_TIMESTAMPING_OPT_ID is set, to
    avoid changing ee_data for existing applications that expect it 0.
    The counter is reset each time the flag is reenabled. Reenabling
    does not change the ID of already submitted data. It is possible
    to receive out of order IDs if the timestamp stream is not quiesced
    first.
    
    Signed-off-by: Willem de Bruijn <willemb@google.com>
    Signed-off-by: David S. Miller <davem@davemloft.net>

commit b9f40e21ef4298650ab33e35740fa85bd57706d5
Author: Willem de Bruijn <willemb@google.com>
Date:   Mon Aug 4 22:11:46 2014 -0400

    net-timestamp: move timestamp flags out of sk_flags
    
    sk_flags is reaching its limit. New timestamping options will not fit.
    Move all of them into a new field sk->sk_tsflags.
    
    Added benefit is that this removes boilerplate code to convert between
    SOF_TIMESTAMPING_.. and SOCK_TIMESTAMPING_.. in getsockopt/setsockopt.
    
    SOCK_TIMESTAMPING_RX_SOFTWARE is also used to toggle the receive
    timestamp logic (netstamp_needed). That can be simplified and this
    last key removed, but will leave that for a separate patch.
    
    Signed-off-by: Willem de Bruijn <willemb@google.com>
    
    ----
    
    The u16 in sock can be moved into a 16-bit hole below sk_gso_max_segs,
    though that scatters tstamp fields throughout the struct.
    Signed-off-by: David S. Miller <davem@davemloft.net>

commit f24b9be5957b38bb420b838115040dc2031b7d0c
Author: Willem de Bruijn <willemb@google.com>
Date:   Mon Aug 4 22:11:45 2014 -0400

    net-timestamp: extend SCM_TIMESTAMPING ancillary data struct
    
    Applications that request kernel tx timestamps with SO_TIMESTAMPING
    read timestamps as recvmsg() ancillary data. The response is defined
    implicitly as timespec[3].
    
    1) define struct scm_timestamping explicitly and
    
    2) add support for new tstamp types. On tx, scm_timestamping always
       accompanies a sock_extended_err. Define previously unused field
       ee_info to signal the type of ts[0]. Introduce SCM_TSTAMP_SND to
       define the existing behavior.
    
    The reception path is not modified. On rx, no struct similar to
    sock_extended_err is passed along with SCM_TIMESTAMPING.
    
    Signed-off-by: Willem de Bruijn <willemb@google.com>
    Signed-off-by: David S. Miller <davem@davemloft.net>

commit dbd1db7d42c053f2f937dc52c5644e105043b082
Author: Axel Lin <axel.lin@ingics.com>
Date:   Fri Jul 25 22:19:35 2014 +0800

    hwmon: (pwm-fan) Make SENSORS_PWM_FAN depend on OF
    
    This driver won't instantiate if OF is not configured, thus add OF dependency.
    Also add COMPILE_TEST to increase build testing coverage.
    
    Signed-off-by: Axel Lin <axel.lin@ingics.com>
    Reviewed-by: Jean Delvare <jdelvare@suse.de>
    Signed-off-by: Guenter Roeck <linux@roeck-us.net>

commit 6bf755db4d5e7ccea61fb17727a183b9bd8945b1
Author: Omar Sandoval <osandov@osandov.com>
Date:   Fri Aug 1 18:14:06 2014 +0100

    ARM: 8124/1: don't enter kgdb when userspace executes a kgdb break instruction
    
    The kgdb breakpoint hooks (kgdb_brk_fn and kgdb_compiled_brk_fn)
    should only be entered when a kgdb break instruction is executed
    from the kernel. Otherwise, if kgdb is enabled, a userspace program
    can cause the kernel to drop into the debugger by executing either
    KGDB_BREAKINST or KGDB_COMPILED_BREAK.
    
    Acked-by: Will Deacon <will.deacon@arm.com>
    Signed-off-by: Omar Sandoval <osandov@osandov.com>
    Signed-off-by: Russell King <rmk+kernel@arm.linux.org.uk>

commit 9d7e3ea73c6be20538a69c14ab8bfb3b36f8d1a8
Merge: 13e9b9972fa0 4d276eb6a478
Author: David S. Miller <davem@davemloft.net>
Date:   Tue Jul 29 11:40:07 2014 -0700

    Merge branch 'syststamp-removal'
    
    Willem de Bruijn says:
    
    ====================
    net: remove deprecated syststamp
    
    The network stack can generate two kinds of hardware timestamps:
    - hwtstamp stores a hw timestamp in device-specific raw format
    - syststamp convers the raw format to system time
    
    The second is deprecated and only implemented by a single device
    driver. The suggested alternative is to communicate hwtstamp +
    directly expose the NIC PTP clock device through ptp_clock_info.
    The remaining driver (octeon) does not expose such a standard
    interface as of now. It does have its own PTP library that depends
    on its own shared memory PTP clock interface.
    
    This patchset
    1. reverts the syststamp code in the one driver (octeon)
    2. reverts an unnecessary zero initialization in another (vxge)
    3. modifies PF_PACKET to use syststamp is != 0 (because always == 0)
    4. modifies SCM_TIMESTAMPING in the same way
    
    For backwards compatibility, the interfaces are not removed.
    Applications can still request SOF_TIMESTAMPING_SYS_HARDWARE. The
    response field in scm_timestamping also remains. As was the case
    for hardware/drivers that did not implement the feature, the
    setsockopt succeeds, but the response field is always zero.
    ====================
    
    Acked-by: Richard Cochran <richardcochran@gmail.com>
    Signed-off-by: David S. Miller <davem@davemloft.net>

commit 4d276eb6a478307a28ae843836c455bf04b37a3c
Author: Willem de Bruijn <willemb@google.com>
Date:   Fri Jul 25 18:01:32 2014 -0400

    net: remove deprecated syststamp timestamp
    
    The SO_TIMESTAMPING API defines three types of timestamps: software,
    hardware in raw format (hwtstamp) and hardware converted to system
    format (syststamp). The last has been deprecated in favor of combining
    hwtstamp with a PTP clock driver. There are no active users in the
    kernel.
    
    The option was device driver dependent. If set, but without hardware
    support, the correct behavior is to return zero in the relevant field
    in the SCM_TIMESTAMPING ancillary message. Without device drivers
    implementing the option, this field is effectively always zero.
    
    Remove the internal plumbing to dissuage new drivers from implementing
    the feature. Keep the SOF_TIMESTAMPING_SYS_HARDWARE flag, however, to
    avoid breaking existing applications that request the timestamp.
    
    Signed-off-by: Willem de Bruijn <willemb@google.com>
    Signed-off-by: David S. Miller <davem@davemloft.net>

commit 42c0d54e62369584f2491f072f405602ff504e0e
Author: Vinod Koul <vinod.koul@intel.com>
Date:   Mon Jul 28 11:57:25 2014 +0530

    dmaengine: sun6i: fix build failure on x86, xilinx targets
    
    Since the driver defined COMPILE_TEST, it gets compiled for different arch's
    The driver uses __virt_to_phys() insteadof virt_to_phys, so replace it
    
    drivers/dma/sun6i-dma.c: In function sun6i_dma_dump_chan_regs:
    drivers/dma/sun6i-dma.c:203: error: implicit declaration of function '__virt_to_phys'
    
    Reported-by: kbuild test robot <fengguang.wu@intel.com>
    Reported-by: Stephen Rothwell <sfr@canb.auug.org.au>
    Signed-off-by: Vinod Koul <vinod.koul@intel.com>

commit 6096d7a8c185f9267d6873ba770feb4948899e79
Author: Georgi Djakov <gdjakov@mm-sol.com>
Date:   Fri Jul 11 20:48:13 2014 +0300

    mmc: sdhci-msm: Get COMPILE_TEST support
    
    Increase the build testing coverage.
    
    Signed-off-by: Georgi Djakov <gdjakov@mm-sol.com>
    Signed-off-by: Ulf Hansson <ulf.hansson@linaro.org>

commit 030494e75064cb4fcbeb609d845ae0c9ceade2b9
Author: Marc Carino <marc.ceeeee@gmail.com>
Date:   Tue Jul 22 16:48:03 2014 -0700

    power: reset: Add reboot driver for brcmstb
    
    Add support for reboot functionality on boards with ARM-based
    Broadcom STB chipsets. Make it built-in by default for ARCH_BRCMSTB,
    but allow it to be configurable under COMPILE_TEST.
    
    Signed-off-by: Marc Carino <marc.ceeeee@gmail.com>
    Signed-off-by: Brian Norris <computersforpeace@gmail.com>
    Signed-off-by: Sebastian Reichel <sre@kernel.org>

commit 9637f30e6b7bc394c08fa9d27d63622f141142e9
Author: Tomasz Figa <t.figa@samsung.com>
Date:   Wed Jul 16 02:59:18 2014 +0900

    ARM: EXYNOS: Fix core ID used by platsmp and hotplug code
    
    When CPU topology is specified in device tree, cpu_logical_map() does
    not return core ID anymore, but rather full MPIDR value. This breaks
    existing calculation of PMU register offsets on Exynos SoCs.
    
    This patch fixes the problem by adjusting the code to use only core ID
    bits of the value returned by cpu_logical_map() to allow CPU topology to
    be specified in device tree on Exynos SoCs.
    
    Signed-off-by: Tomasz Figa <t.figa@samsung.com>
    Signed-off-by: Kukjin Kim <kgene.kim@samsung.com>
    Signed-off-by: Olof Johansson <olof@lixom.net>

commit 8310f53f36bdbe400b8c6bfe6296f024ea9de6e0
Author: Guenter Roeck <linux@roeck-us.net>
Date:   Mon Jun 30 11:45:30 2014 -0700

    powerpc: Disable RELOCATABLE for COMPILE_TEST with PPC64
    
    commit fb43e8477ed9006c4f397f904c691a120503038c upstream.
    
    powerpc:allmodconfig has been failing for some time with the following
    error.
    
    arch/powerpc/kernel/exceptions-64s.S: Assembler messages:
    arch/powerpc/kernel/exceptions-64s.S:1312: Error: attempt to move .org backwards
    make[1]: *** [arch/powerpc/kernel/head_64.o] Error 1
    
    A number of attempts to fix the problem by moving around code have been
    unsuccessful and resulted in failed builds for some configurations and
    the discovery of toolchain bugs.
    
    Fix the problem by disabling RELOCATABLE for COMPILE_TEST builds instead.
    While this is less than perfect, it avoids substantial code changes
    which would otherwise be necessary just to make COMPILE_TEST builds
    happy and might have undesired side effects.
    
    Signed-off-by: Guenter Roeck <linux@roeck-us.net>
    Signed-off-by: Benjamin Herrenschmidt <benh@kernel.crashing.org>
    Signed-off-by: Jiri Slaby <jslaby@suse.cz>

commit 9d7e845beffc3a25e139f6c7314555c0bed18448
Author: Guenter Roeck <linux@roeck-us.net>
Date:   Mon Jun 30 11:45:30 2014 -0700

    powerpc: Disable RELOCATABLE for COMPILE_TEST with PPC64
    
    commit fb43e8477ed9006c4f397f904c691a120503038c upstream.
    
    powerpc:allmodconfig has been failing for some time with the following
    error.
    
    arch/powerpc/kernel/exceptions-64s.S: Assembler messages:
    arch/powerpc/kernel/exceptions-64s.S:1312: Error: attempt to move .org backwards
    make[1]: *** [arch/powerpc/kernel/head_64.o] Error 1
    
    A number of attempts to fix the problem by moving around code have been
    unsuccessful and resulted in failed builds for some configurations and
    the discovery of toolchain bugs.
    
    Fix the problem by disabling RELOCATABLE for COMPILE_TEST builds instead.
    While this is less than perfect, it avoids substantial code changes
    which would otherwise be necessary just to make COMPILE_TEST builds
    happy and might have undesired side effects.
    
    Signed-off-by: Guenter Roeck <linux@roeck-us.net>
    Signed-off-by: Benjamin Herrenschmidt <benh@kernel.crashing.org>
    Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>

commit 02d771f9019fb67e95b83518dcd1d1ee098928d3
Author: Guenter Roeck <linux@roeck-us.net>
Date:   Mon Jun 30 11:45:30 2014 -0700

    powerpc: Disable RELOCATABLE for COMPILE_TEST with PPC64
    
    commit fb43e8477ed9006c4f397f904c691a120503038c upstream.
    
    powerpc:allmodconfig has been failing for some time with the following
    error.
    
    arch/powerpc/kernel/exceptions-64s.S: Assembler messages:
    arch/powerpc/kernel/exceptions-64s.S:1312: Error: attempt to move .org backwards
    make[1]: *** [arch/powerpc/kernel/head_64.o] Error 1
    
    A number of attempts to fix the problem by moving around code have been
    unsuccessful and resulted in failed builds for some configurations and
    the discovery of toolchain bugs.
    
    Fix the problem by disabling RELOCATABLE for COMPILE_TEST builds instead.
    While this is less than perfect, it avoids substantial code changes
    which would otherwise be necessary just to make COMPILE_TEST builds
    happy and might have undesired side effects.
    
    Signed-off-by: Guenter Roeck <linux@roeck-us.net>
    Signed-off-by: Benjamin Herrenschmidt <benh@kernel.crashing.org>
    Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>

commit 0d1f64f60b4c50a8c604010ad3eef5cdfe9926bc
Author: Dmitry Kasatkin <d.kasatkin@samsung.com>
Date:   Fri Jul 11 18:59:45 2014 +0300

    digsig: make crypto builtin if digsig selected as builtin
    
    When SIGNATURE=y but depends on CRYPTO=m, it selects MPILIB as module
    producing build break. This patch makes digsig to select crypto for
    correcting dependency.
    
    Signed-off-by: Dmitry Kasatkin <d.kasatkin@samsung.com>
    Signed-off-by: David Howells <dhowells@redhat.com>

commit 26c18217330b66f28e52debf5cb66d3374e0fd2d
Author: Jean Delvare <jdelvare@suse.de>
Date:   Thu Jul 17 20:45:41 2014 +0100

    RSA: Don't select non-existent symbol
    
    You can select MPILIB_EXTRA all you want, it doesn't exist ;-)
    
    Surprised kconfig doesn't complain about that...
    
    Signed-off-by: Jean Delvare <jdelvare@suse.de>
    Acked-by: Marek Vasut <marex@denx.de>
    Signed-off-by: David Howells <dhowells@redhat.com>
    Cc: Herbert Xu <herbert@gondor.apana.org.au>
    Cc: "David S. Miller" <davem@davemloft.net>

commit 26c4fdb0528ae7c4be9fbc8a8210f3b410e6b5aa
Author: Willem de Bruijn <willemb@google.com>
Date:   Mon Jul 14 17:55:30 2014 -0400

    net-timestamp: document deprecated syststamp
    
    The SO_TIMESTAMPING API defines option SOF_TIMESTAMPING_SYS_HW.
    This feature is deprecated. It should not be implemented by new
    device drivers. Existing drivers do not implement it, either --
    with one exception.
    
    Driver developers are encouraged to expose the NIC hw clock as a
    PTP HW clock source, instead, and synchronize system time to the
    HW source.
    
    The control flag cannot be removed due to being part of the ABI, nor
    can the structure scm_timestamping that is returned. Due to the one
    legacy driver, the internal datapath and structure are not removed.
    
    This patch only clearly marks the interface as deprecated. Device
    drivers should always return a syststamp value of zero.
    
    Signed-off-by: Willem de Bruijn <willemb@google.com>
    
    ----
    
    We can consider adding a WARN_ON_ONCE in__sock_recv_timestamp
    if non-zero syststamp is encountered
    Acked-by: Richard Cochran <richardcochran@gmail.com>
    Signed-off-by: David S. Miller <davem@davemloft.net>

commit 11878b40ed5c5bc20d6a115bae156a5b90b0fb3e
Author: Willem de Bruijn <willemb@google.com>
Date:   Mon Jul 14 17:55:06 2014 -0400

    net-timestamp: SOCK_RAW and PING timestamping
    
    Add SO_TIMESTAMPING to sockets of type PF_INET[6]/SOCK_RAW:
    
    Add the necessary sock_tx_timestamp calls to the datapath for RAW
    sockets (ping sockets already had these calls).
    
    Fix the IP output path to pass the timestamp flags on the first
    fragment also for these sockets. The existing code relies on
    transhdrlen != 0 to indicate a first fragment. For these sockets,
    that assumption does not hold.
    
    This fixes http://bugzilla.kernel.org/show_bug.cgi?id=77221
    
    Tested SOCK_RAW on IPv4 and IPv6, not PING.
    
    Signed-off-by: Willem de Bruijn <willemb@google.com>
    Acked-by: Richard Cochran <richardcochran@gmail.com>
    Signed-off-by: David S. Miller <davem@davemloft.net>

commit 203f0801ad2147d026d0ff73c604f1c1f04a88c0
Author: Vince Bridgers <vbridgers2013@gmail.com>
Date:   Mon Jun 23 13:31:09 2014 -0500

    ARM: socfpga: Update socfpga_defconfig
    
    CONFIG_PM=y
    CONFIG_SUSPEND=y
    CONFIG_MMC_UNSAFE_RESUME=y
    CONFIG_DWMAC_SOCFPGA=y
    CONFIG_USB=y
    CONFIG_USB_DWC2=y
    CONFIG_USB_DWC2_HOST=y
    CONFIG_USB_DWC2_PLATFORM=y
    CONFIG_FHANDLE=y
    CONFIG_I2C=y
    CONFIG_I2C_DESIGNWARE_CORE=y
    CONFIG_I2C_DESIGNWARE_PLATFORM=y
    CONFIG_I2C_CHARDEV=y
    CONFIG_CAN=y
    CONFIG_CAN_RAW=y
    CONFIG_CAN_BCM=y
    CONFIG_CAN_GW=y
    CONFIG_CAN_DEV=y
    CONFIG_CAN_CALC_BITTIMING=y
    CONFIG_CAN_C_CAN=y
    CONFIG_CAN_C_CAN_PLATFORM=y
    CONFIG_WATCHDOG=y
    CONFIG_DW_WATCHDOG=y
    CONFIG_GPIOLIB=y
    CONFIG_GPIO_SYSFS=y
    CONFIG_GPIO_DWAPB=y
    CONFIG_PPS=y
    CONFIG_NETWORK_PHY_TIMESTAMPING=y
    CONFIG_PTP_1588_CLOCK=y
    CONFIG_VLAN_8021Q=y
    CONFIG_VLAN_8021Q_GVRP=y
    CONFIG_GARP=y
    CONFIG_IPV6=y
    CONFIG_HOTPLUG=y
    
    Signed-off-by: Vince Bridgers <vbridgers2013@gmail.com>
    Signed-off-by: Alan Tull <atull@altera.com>
    Signed-off-by: Thor Thayer <tthayer@altera.com>
    Signed-off-by: Dinh Nguyen <dinguyen@altear.com>
    Signed-off-by: Olof Johansson <olof@lixom.net>

commit 1b81e88189446fd6ee21e7e76770154931c5ea60
Merge: 8ec8ba8e7d5b 655fc39bf403
Author: Linus Torvalds <torvalds@linux-foundation.org>
Date:   Mon Jul 14 17:17:53 2014 -0700

    Merge tag 'firewire-fix' of git://git.kernel.org/pub/scm/linux/kernel/git/ieee1394/linux1394
    
    Pull firewire fix from Stefan Richter:
     "The 1394 drivers cannot and are not supposed to be built on platforms
      which don't provide the DMA mapping API (regression since v3.16-rc1
      with CONFIG_COMPILE_TEST=y on some architectures)"
    
    * tag 'firewire-fix' of git://git.kernel.org/pub/scm/linux/kernel/git/ieee1394/linux1394:
      firewire: IEEE 1394 (FireWire) support should depend on HAS_DMA

commit 655fc39bf40331e13503bed85c9ed0278bc35575
Author: Geert Uytterhoeven <geert@linux-m68k.org>
Date:   Wed Jul 9 21:04:00 2014 +0200

    firewire: IEEE 1394 (FireWire) support should depend on HAS_DMA
    
    Commit b3d681a4fc108f9653bbb44e4f4e72db2b8a5734 ("firewire: Use
    COMPILE_TEST for build testing") added COMPILE_TEST as an alternative
    dependency for the purpose of build testing the firewire core.
    However, this bypasses all other implicit dependencies assumed by PCI,
    like HAS_DMA.
    
    If NO_DMA=y:
    
        drivers/built-in.o: In function `fw_iso_buffer_destroy':
        (.text+0x36a096): undefined reference to `dma_unmap_page'
        drivers/built-in.o: In function `fw_iso_buffer_map_dma':
        (.text+0x36a164): undefined reference to `dma_map_page'
        drivers/built-in.o: In function `fw_iso_buffer_map_dma':
        (.text+0x36a172): undefined reference to `dma_mapping_error'
        drivers/built-in.o: In function `sbp2_send_management_orb':
        sbp2.c:(.text+0x36c6b4): undefined reference to `dma_map_single'
        sbp2.c:(.text+0x36c6c8): undefined reference to `dma_mapping_error'
        sbp2.c:(.text+0x36c772): undefined reference to `dma_map_single'
        sbp2.c:(.text+0x36c786): undefined reference to `dma_mapping_error'
        sbp2.c:(.text+0x36c854): undefined reference to `dma_unmap_single'
        sbp2.c:(.text+0x36c872): undefined reference to `dma_unmap_single'
        drivers/built-in.o: In function `sbp2_map_scatterlist':
        sbp2.c:(.text+0x36ccbc): undefined reference to `scsi_dma_map'
        sbp2.c:(.text+0x36cd36): undefined reference to `dma_map_single'
        sbp2.c:(.text+0x36cd4e): undefined reference to `dma_mapping_error'
        sbp2.c:(.text+0x36cd84): undefined reference to `scsi_dma_unmap'
        drivers/built-in.o: In function `sbp2_unmap_scatterlist':
        sbp2.c:(.text+0x36cda6): undefined reference to `scsi_dma_unmap'
        sbp2.c:(.text+0x36cdc6): undefined reference to `dma_unmap_single'
        drivers/built-in.o: In function `complete_command_orb':
        sbp2.c:(.text+0x36d6ac): undefined reference to `dma_unmap_single'
        drivers/built-in.o: In function `sbp2_scsi_queuecommand':
        sbp2.c:(.text+0x36d8e0): undefined reference to `dma_map_single'
        sbp2.c:(.text+0x36d8f6): undefined reference to `dma_mapping_error'
    
    Add an explicit dependency on HAS_DMA to fix this.
    
    Signed-off-by: Geert Uytterhoeven <geert@linux-m68k.org>
    Reviewed-by: Jean Delvare <jdelvare@suse.de>
    Signed-off-by: Stefan Richter <stefanr@s5r6.in-berlin.de>

commit c7c3ae2596d19ad0ed82f30d0e76a4b201b6b0a8
Merge: 85d90faed31e f56029410a13
Author: Linus Torvalds <torvalds@linux-foundation.org>
Date:   Fri Jul 11 09:32:39 2014 -0700

    Merge branch 'merge' of git://git.kernel.org/pub/scm/linux/kernel/git/benh/powerpc
    
    Pull powerpc fixes from Ben Herrenschmidt:
     "Here are a few more powerpc fixes for 3.16
    
      There's a small series of 3 patches that fix saving/restoring MMUCR2
      when using KVM without which perf goes completely bonkers in the host
      system.  Another perf fix from Anton that's been rotting away in
      patchwork due to my poor eyesight, a couple of compile fixes, a little
      addition to the WSP removal by Michael (removing a bit more dead
      stuff) and a fix for an embarassing regression with our soft irq
      masking"
    
    * 'merge' of git://git.kernel.org/pub/scm/linux/kernel/git/benh/powerpc:
      powerpc/perf: Never program book3s PMCs with values >= 0x80000000
      powerpc: Disable RELOCATABLE for COMPILE_TEST with PPC64
      powerpc/perf: Clear MMCR2 when enabling PMU
      powerpc/perf: Add PPMU_ARCH_207S define
      powerpc/kvm: Remove redundant save of SIER AND MMCR2
      powerpc/powernv: Check for IRQHAPPENED before sleeping
      powerpc: Clean up MMU_FTRS_A2 and MMU_FTR_TYPE_3E
      powerpc/cell: Fix compilation with CONFIG_COREDUMP=n

commit fb43e8477ed9006c4f397f904c691a120503038c
Author: Guenter Roeck <linux@roeck-us.net>
Date:   Mon Jun 30 11:45:30 2014 -0700

    powerpc: Disable RELOCATABLE for COMPILE_TEST with PPC64
    
    powerpc:allmodconfig has been failing for some time with the following
    error.
    
    arch/powerpc/kernel/exceptions-64s.S: Assembler messages:
    arch/powerpc/kernel/exceptions-64s.S:1312: Error: attempt to move .org backwards
    make[1]: *** [arch/powerpc/kernel/head_64.o] Error 1
    
    A number of attempts to fix the problem by moving around code have been
    unsuccessful and resulted in failed builds for some configurations and
    the discovery of toolchain bugs.
    
    Fix the problem by disabling RELOCATABLE for COMPILE_TEST builds instead.
    While this is less than perfect, it avoids substantial code changes
    which would otherwise be necessary just to make COMPILE_TEST builds
    happy and might have undesired side effects.
    
    Signed-off-by: Guenter Roeck <linux@roeck-us.net>
    Signed-off-by: Benjamin Herrenschmidt <benh@kernel.crashing.org>

commit 533465a8f8a969bac17550fc6f42cea1dfaa095f
Author: Geert Uytterhoeven <geert+renesas@glider.be>
Date:   Wed Jul 9 23:27:07 2014 +0200

    spi: rspi: Relax DMA dependency and increase build coverage
    
    As of commit ab116a4df4942c78c189d9b0744dd940ab9e00b9 ("dmaengine:
    shdma: fix a build failure on platforms with no DMA support"), the DMA
    filter function shdma_chan_filter() is sufficiently abstracted to allow
    building without DMA support. Hence drop the SH_DMAE_BASE dependency on
    SUPERH.
    Also increase build coverage by allowing the driver to be enabled if
    COMPILE_TEST=y.
    
    Signed-off-by: Geert Uytterhoeven <geert+renesas@glider.be>
    Signed-off-by: Mark Brown <broonie@linaro.org>

commit 4e6f7084096c08e37f909d7b075a91b72580405f
Author: Zi Shen Lim <zlim@broadcom.com>
Date:   Sat Jun 7 01:55:27 2014 +0100

    arm64: topology: add MPIDR-based detection
    
    Create cpu topology based on MPIDR. When hardware sets MPIDR to sane
    values, this method will always work. Therefore it should also work well
    as the fallback method. [1]
    
    When we have multiple processing elements in the system, we create
    the cpu topology by mapping each affinity level (from lowest to highest)
    to threads (if they exist), cores, and clusters.
    
    [1] http://www.spinics.net/lists/arm-kernel/msg317445.html
    
    Acked-by: Lorenzo Pieralisi <lorenzo.pieralisi@arm.com>
    Signed-off-by: Zi Shen Lim <zlim@broadcom.com>
    Signed-off-by: Mark Brown <broonie@linaro.org>
    Signed-off-by: Catalin Marinas <catalin.marinas@arm.com>

commit 021f653791ad17e03f98aaa7fb933816ae16f161
Author: Marc Zyngier <marc.zyngier@arm.com>
Date:   Mon Jun 30 16:01:31 2014 +0100

    irqchip: gic-v3: Initial support for GICv3
    
    The Generic Interrupt Controller (version 3) offers services that are
    similar to GICv2, with a number of additional features:
    - Affinity routing based on the CPU MPIDR (ARE)
    - System register for the CPU interfaces (SRE)
    - Support for more that 8 CPUs
    - Locality-specific Peripheral Interrupts (LPIs)
    - Interrupt Translation Services (ITS)
    
    This patch adds preliminary support for GICv3 with ARE and SRE,
    non-secure mode only. It relies on higher exception levels to grant ARE
    and SRE access.
    
    Support for LPI and ITS will be added at a later time.
    
    Cc: Thomas Gleixner <tglx@linutronix.de>
    Cc: Jason Cooper <jason@lakedaemon.net>
    Reviewed-by: Zi Shen Lim <zlim@broadcom.com>
    Reviewed-by: Christoffer Dall <christoffer.dall@linaro.org>
    Reviewed-by: Tirumalesh Chalamarla <tchalamarla@cavium.com>
    Reviewed-by: Yun Wu <wuyun.wu@huawei.com>
    Reviewed-by: Zhen Lei <thunder.leizhen@huawei.com>
    Tested-by: Tirumalesh Chalamarla<tchalamarla@cavium.com>
    Tested-by: Radha Mohan Chintakuntla <rchintakuntla@cavium.com>
    Acked-by: Radha Mohan Chintakuntla <rchintakuntla@cavium.com>
    Acked-by: Catalin Marinas <catalin.marinas@arm.com>
    Signed-off-by: Marc Zyngier <marc.zyngier@arm.com>
    Reviewed-by: Mark Rutland <mark.rutland@arm.com>
    Link: https://lkml.kernel.org/r/1404140510-5382-3-git-send-email-marc.zyngier@arm.com
    Signed-off-by: Jason Cooper <jason@lakedaemon.net>

commit 1bb60b3a5ae526287fc6d0c55391f5664cc1e672
Author: Mark Brown <broonie@linaro.org>
Date:   Sat Jul 5 17:54:24 2014 +0100

    ASoC: s6105-ipcam: Fix build for I2C dependencies
    
    The s6105-ipcam driver calls i2c_register_board_info() which means that
    not only does it need I2C to be enabled to be built but since that
    symbol is not exported it means that the driver also can't be linked as
    a module.  Use a bool instead of a tristate and add a dependency on I2C
    to fix these issues.
    
    Commit b5dd60fd263 (ASoC: s6000: Allow to build when COMPILE_TEST is
    enabled) made this problem more visible since it enabled build of the
    driver on more common architectures but this has always been an issue.
    
    Signed-off-by: Mark Brown <broonie@linaro.org>

commit b5dd60fd263147f723aeebc424dab7cd6613d3be
Author: Lars-Peter Clausen <lars@metafoo.de>
Date:   Mon Jun 30 10:01:38 2014 +0200

    ASoC: s6000: Allow to build when COMPILE_TEST is enabled
    
    Most of the ASoC s6000 code is architecture independent. This patch makes it
    possible to select the platform when COMPILE_TEST is enabled.
    
    The only architecture dependent code is the PCM driver which will still only be
    selected if XTENSA_VARIANT_S6000 is enabled.
    
    Signed-off-by: Lars-Peter Clausen <lars@metafoo.de>
    Signed-off-by: Mark Brown <broonie@linaro.org>

commit 381de9c0e3e60ed2acf8c681a69bbeb94a02cdba
Author: Richard Weinberger <richard@nod.at>
Date:   Wed Jun 18 16:18:36 2014 +0200

    crypto: Remove MPILIB_EXTRA
    
    The symbol is an orphan, get rid of it.
    
    Signed-off-by: Richard Weinberger <richard@nod.at>
    Signed-off-by: Paul Bolle <pebolle@tiscali.nl>
    Signed-off-by: Jiri Kosina <jkosina@suse.cz>

commit ce7035a6fdded27ad961445f6796a57b9bef04bf
Author: Sreekanth Reddy <Sreekanth.Reddy@lsi.com>
Date:   Sat Feb 2 00:56:18 2013 +0530

    mpt2sas: Fix for device scan following host reset could get stuck in a infinite loop
    
    commit 6241f22ca12a26ee149cbe31b27bac97dbdc8bc4 upstream.
    
    Modified device scan routine so each configuration page read breaks from the
    while loop when the ioc_status is not equal to MPI2_IOCSTATUS_SUCCESS.
    
    [jejb: checkpatch fixes]
    Signed-off-by: Sreekanth Reddy <Sreekanth.Reddy@lsi.com>
    Signed-off-by: James Bottomley <JBottomley@Parallels.com>
    [bwh: Backported to 3.2; adjust context]
    Signed-off-by: Ben Hutchings <ben@decadent.org.uk>
    Cc: Rui Xiang <rui.xiang@huawei.com>
    Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>

commit b02fdfcc40d74e64d3ea2a2120c96979e1b33128
Author: Jean Delvare <jdelvare@suse.de>
Date:   Sun Jun 1 22:02:48 2014 +0200

    platform/x86: Fix run-time dependencies of OLPC drivers
    
    Let the xo15-ebook driver depend on OLPC as all other OLPC drivers
    already do. Add COMPILE_TEST as an alternative for both xo1-rfkill
    and xo15-ebook, to increase the build testing coverage.
    
    Signed-off-by: Jean Delvare <jdelvare@suse.de>
    Cc: Matthew Garrett <matthew.garrett@nebula.com>
    Signed-off-by: Matthew Garrett <matthew.garrett@nebula.com>

commit 77c32bbbe0d0e963ba5723b8d1f6c42c5d56858b
Merge: fad0701eaa09 06822788faa2
Author: Linus Torvalds <torvalds@linux-foundation.org>
Date:   Tue Jun 10 10:28:45 2014 -0700

    Merge branch 'for-linus' of git://git.infradead.org/users/vkoul/slave-dma
    
    Pull slave-dmaengine updates from Vinod Koul:
     - new Xilixn VDMA driver from Srikanth
     - bunch of updates for edma driver by Thomas, Joel and Peter
     - fixes and updates on dw, ste_dma, freescale, mpc512x, sudmac etc
    
    * 'for-linus' of git://git.infradead.org/users/vkoul/slave-dma: (45 commits)
      dmaengine: sh: don't use dynamic static allocation
      dmaengine: sh: fix print specifier warnings
      dmaengine: sh: make shdma_prep_dma_cyclic static
      dmaengine: Kconfig: Update MXS_DMA help text to include MX6Q/MX6DL
      of: dma: Grammar s/requests/request/, s/used required/required/
      dmaengine: shdma: Enable driver compilation with COMPILE_TEST
      dmaengine: rcar-hpbdma: Include linux/err.h
      dmaengine: sudmac: Include linux/err.h
      dmaengine: sudmac: Keep #include sorted alphabetically
      dmaengine: shdmac: Include linux/err.h
      dmaengine: shdmac: Keep #include sorted alphabetically
      dmaengine: s3c24xx-dma: Add cyclic transfer support
      dmaengine: s3c24xx-dma: Process whole SG chain
      dmaengine: imx: correct sdmac->status for cyclic dma tx
      dmaengine: pch: fix compilation for alpha target
      dmaengine: dw: check return code of dma_async_device_register()
      dmaengine: dw: fix regression in dw_probe() function
      dmaengine: dw: enable clock before access
      dma: pch_dma: Fix Kconfig dependencies
      dmaengine: mpc512x: add support for peripheral transfers
      ...

commit a1c48bb160f8368ea9668a1ff98513631fa0d87a
Author: Geert Uytterhoeven <geert@linux-m68k.org>
Date:   Tue May 27 09:54:12 2014 +0200

    Makefile: Fix unrecognized cross-compiler command line options
    
    On architectures that setup CROSS_COMPILE in their arch/*/Makefile
    (arc, blackfin, m68k, mips, parisc, score, sh, tile, unicore32, xtensa),
    cc-option and cc-disable-warning may check against the wrong compiler,
    causing errors like
    
        cc1: error: unrecognized command line option "-Wno-maybe-uninitialized"
    
    if the host gcc supports a compiler option, while the cross compiler
    doesn't support that option.
    
    Move all logic using cc-option or cc-disable-warning below the inclusion
    of the arch's Makefile to fix this.
    
    Introduced by
      - commit e74fc973b6e531fef1fce8b101ffff05ecfb774c ("Turn off
        -Wmaybe-uninitialized when building with -Os"),
      - commit 61163efae02040f66a95c8ed17f4407951ba58fa ("kbuild: LLVMLinux:
        Add Kbuild support for building kernel with Clang").
    
    As -Wno-maybe-uninitialized requires a quite recent gcc (gcc 4.6.3 on
    Ubuntu 12.04 LTS doesn't support it), this only showed up recently (gcc
    4.8.2 on Ubuntu 14.04 LTS does support it).
    
    Signed-off-by: Geert Uytterhoeven <geert@linux-m68k.org>
    Signed-off-by: Michal Marek <mmarek@suse.cz>

commit b05d59dfceaea72565b1648af929b037b0f96d7f
Merge: daf342af2f78 820b3fcdeb80
Author: Linus Torvalds <torvalds@linux-foundation.org>
Date:   Wed Jun 4 08:47:12 2014 -0700

    Merge tag 'for-linus' of git://git.kernel.org/pub/scm/virt/kvm/kvm into next
    
    Pull KVM updates from Paolo Bonzini:
     "At over 200 commits, covering almost all supported architectures, this
      was a pretty active cycle for KVM.  Changes include:
    
       - a lot of s390 changes: optimizations, support for migration, GDB
         support and more
    
       - ARM changes are pretty small: support for the PSCI 0.2 hypercall
         interface on both the guest and the host (the latter acked by
         Catalin)
    
       - initial POWER8 and little-endian host support
    
       - support for running u-boot on embedded POWER targets
    
       - pretty large changes to MIPS too, completing the userspace
         interface and improving the handling of virtualized timer hardware
    
       - for x86, a larger set of changes is scheduled for 3.17.  Still, we
         have a few emulator bugfixes and support for running nested
         fully-virtualized Xen guests (para-virtualized Xen guests have
         always worked).  And some optimizations too.
    
      The only missing architecture here is ia64.  It's not a coincidence
      that support for KVM on ia64 is scheduled for removal in 3.17"
    
    * tag 'for-linus' of git://git.kernel.org/pub/scm/virt/kvm/kvm: (203 commits)
      KVM: add missing cleanup_srcu_struct
      KVM: PPC: Book3S PR: Rework SLB switching code
      KVM: PPC: Book3S PR: Use SLB entry 0
      KVM: PPC: Book3S HV: Fix machine check delivery to guest
      KVM: PPC: Book3S HV: Work around POWER8 performance monitor bugs
      KVM: PPC: Book3S HV: Make sure we don't miss dirty pages
      KVM: PPC: Book3S HV: Fix dirty map for hugepages
      KVM: PPC: Book3S HV: Put huge-page HPTEs in rmap chain for base address
      KVM: PPC: Book3S HV: Fix check for running inside guest in global_invalidates()
      KVM: PPC: Book3S: Move KVM_REG_PPC_WORT to an unused register number
      KVM: PPC: Book3S: Add ONE_REG register names that were missed
      KVM: PPC: Add CAP to indicate hcall fixes
      KVM: PPC: MPIC: Reset IRQ source private members
      KVM: PPC: Graciously fail broken LE hypercalls
      PPC: ePAPR: Fix hypercall on LE guest
      KVM: PPC: BOOK3S: Remove open coded make_dsisr in alignment handler
      KVM: PPC: BOOK3S: Always use the saved DAR value
      PPC: KVM: Make NX bit available with magic page
      KVM: PPC: Disable NX for old magic page using guests
      KVM: PPC: BOOK3S: HV: Add mixed page-size support for guest
      ...

commit 1b3636093d4e07f5fc8a8eb2f9a5e14a5a2674bf
Merge: 1605abfffe33 d151f9854f21
Author: Linus Torvalds <torvalds@linux-foundation.org>
Date:   Wed Jun 4 07:47:03 2014 -0700

    Merge tag 'firewire-updates' of git://git.kernel.org/pub/scm/linux/kernel/git/ieee1394/linux1394 into next
    
    Pull firewire updates from Stefan Richter:
     "IEEE 1394 (FireWire) subsystem changes: One optimization for some VIA
      controllers, one fix, one kconfig brushup"
    
    * tag 'firewire-updates' of git://git.kernel.org/pub/scm/linux/kernel/git/ieee1394/linux1394:
      firewire: ohci: enable MSI for VIA VT6315 rev 1, drop cycle timer quirk
      firewire: Use COMPILE_TEST for build testing
      firewire: net: fix NULL derefencing in fwnet_probe()

commit e1d4d3c854f25cff6c6c139588570e124d5e8fa4
Author: Stephen Warren <swarren@nvidia.com>
Date:   Fri May 30 12:42:57 2014 -0600

    ASoC: free jack GPIOs before the sound card is freed
    
    This is the same change as commit fb6b8e71448a "ASoC: tegra: free jack
    GPIOs before the sound card is freed", but applied to all other ASoC
    machine drivers where code inspection indicates the same problem exists.
    
    That commit's description is:
    ==========
    snd_soc_jack_add_gpios() schedules a work queue item to poll the GPIO to
    generate an initial jack status report. If sound card initialization
    fails, that work item needs to be cancelled, so it doesn't run after the
    card has been freed. Specifically, freeing the card calls
    snd_jack_dev_free() which calls snd_jack_dev_disconnect() which sets
    jack->input_dev = NULL, and input_dev is used by snd_jack_report(), which
    is called from the work queue item.
    
    snd_soc_jack_free_gpios() cancels the work item. The Tegra ASoC machine
    drivers do call this function in the platform driver remove() callback.
    However, this happens after the sound card is freed, at least when the
    card is freed due to errors late during snd_soc_instantiate_card(). This
    leaves a window where the work item can execute after the card is freed.
    In next-20140522, sound card initialization does fail for unrelated
    reasons, and hits the problem described above.
    
    To solve this, fix the Tegra ASoC machine drivers to clean up the Jack
    GPIOs during the snd_soc_card's .remove() callback, which is executed
    before the overall card object is freed. also, guard the cleanup call
    based on whether we actually setup up the GPIOs in the first place.
    Ideally, we'd do the cleanup in a struct snd_soc_dai_link .fini/remove
    function to match where the GPIOs get set up. However, there is no such
    callback.
    ==========
    
    Note that I have not even compile-tested this in most cases, since most
    of the drivers rely on specific mach-* support I don't have enabled, and
    don't support COMPILE_TEST. Testing by the relevant board maintainers
    would be useful.
    
    Signed-off-by: Stephen Warren <swarren@nvidia.com>
    Signed-off-by: Mark Brown <broonie@linaro.org>

commit 9d9f71a804314e7d50e2fa9e6e61bc77e2d6ae1c
Author: Vinod Koul <vinod.koul@intel.com>
Date:   Mon Jun 2 09:32:59 2014 +0530

    dmaengine: sh: fix print specifier warnings
    
    As documented in Documentation/printk-formats.txt we should use %zu/%zx
    specifiers for size_t type variables for the code to compile on different
    architectures. This is uncovered as COMPILE_TEST has been enabled recently for
    this driver
    
       drivers/dma/sh/shdma-base.c: In function 'shdma_prep_dma_cyclic':
    >> drivers/dma/sh/shdma-base.c:683:4: warning: format '%d' expects argument of
    >> type 'int', but argument 4 has type 'size_t' [-Wformat=]
           __func__, buf_len, period_len, slave_id);
    >> drivers/dma/sh/shdma-base.c:683:4: warning: format '%d' expects argument of
    >> type 'int', but argument 5 has type 'size_t' [-Wformat=]
    
    Reported-by: kbuild test robot <fengguang.wu@intel.com>
    Acked-by: Laurent Pinchart <laurent.pinchart@ideasonboard.com>
    Signed-off-by: Vinod Koul <vinod.koul@intel.com>

commit 3aab01d800eb195de3f273d9a195fe070a507d56
Author: Jean Delvare <jdelvare@suse.de>
Date:   Sat May 31 17:32:27 2014 +0200

    net: ec_bhf: Add runtime dependencies
    
    The ec_bhf driver is specific to the Beckhoff CX embedded PC series.
    These are based on Intel x86 CPU. So we can add a dependency on
    X86, with COMPILE_TEST as an alternative to still allow for broader
    build-testing.
    
    Signed-off-by: Jean Delvare <jdelvare@suse.de>
    Cc: Darek Marcinkiewicz <reksio@newterm.pl>
    Cc: David S. Miller <davem@davemloft.net>
    Signed-off-by: David S. Miller <davem@davemloft.net>

commit ebc6d2d9c8cd48c351da84dd467c0edddc149ded
Author: Laurent Pinchart <laurent.pinchart+renesas@ideasonboard.com>
Date:   Tue May 13 01:02:16 2014 +0200

    dmaengine: shdma: Enable driver compilation with COMPILE_TEST
    
    This helps increasing build testing coverage.
    
    Signed-off-by: Laurent Pinchart <laurent.pinchart+renesas@ideasonboard.com>
    Acked-by: Simon Horman <horms@verge.net.au>
    Signed-off-by: Vinod Koul <vinod.koul@intel.com>

commit aae6559651dd9d779da79f30de02033557fe263b
Author: Alexander Graf <agraf@suse.de>
Date:   Thu May 22 17:25:14 2014 +0200

    KVM: PPC: MPIC: Reset IRQ source private members
    
    When we reset the in-kernel MPIC controller, we forget to reset some hidden
    state such as destmask and output. This state is usually set when the guest
    writes to the IDR register for a specific IRQ line.
    
    To make sure we stay in sync and don't forget hidden state, treat reset of
    the IDR register as a simple write of the IDR register. That automatically
    updates all the hidden state as well.
    
    Reported-by: Paul Janzen <pcj@pauljanzen.org>
    Signed-off-by: Alexander Graf <agraf@suse.de>

commit 0667934567a9d05fad5bdf2ca0546b04a1e64dfe
Author: Jean Delvare <jdelvare@suse.de>
Date:   Fri May 16 10:48:50 2014 +0200

    serial: pch_uart: Fix Kconfig dependencies
    
    The pch_uart driver is for a companion chip to the Intel Atom E600
    series processors. These are 32-bit x86 processors so the driver is
    only needed on X86_32. Add COMPILE_TEST as an alternative, so that the
    driver can still be build-tested elsewhere.
    
    Signed-off-by: Jean Delvare <jdelvare@suse.de>
    Cc: Jiri Slaby <jslaby@suse.cz>
    Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>

commit fd1a73c60ee0bfd3fefc96ad270effd69b350aba
Author: Jean Delvare <jdelvare@suse.de>
Date:   Fri May 16 11:16:54 2014 +0200

    misc: pch_phub: Fix Kconfig dependencies
    
    The pch_phub driver is for a companion chip to the Intel Atom E600
    series processors. These are 32-bit x86 processors so the driver is
    only needed on X86_32. Add COMPILE_TEST as an alternative, so that the
    driver can still be build-tested elsewhere.
    
    Signed-off-by: Jean Delvare <jdelvare@suse.de>
    Cc: Arnd Bergmann <arnd@arndb.de>
    Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>

commit d13bd5a602982cd7f697e39b13ac736c2c553af1
Author: Lv Zheng <lv.zheng@intel.com>
Date:   Mon May 12 15:46:32 2014 +0800

    ACPICA: Linux headers: Add <acpi/platform/aclinuxex.h>
    
    From ACPICA's perspective, <acpi/actypes.h> should be included after
    inclusion of <acpi/platform/acenv.h>.  But currently in Linux,
    <acpi/platform/aclinux.h> included by <acpi/platform/acenv.h> has
    included <acpi/actypes.h> to find ACPICA types for inline functions.
    
    This causes the following problem:
    1. Redundant code in <asm/acpi.h> and <acpi/platform/aclinux.h>:
       Linux must be careful to keep conditions for <acpi/actypes.h> inclusion
       consistent with the conditions for <acpi/platform/aclinux.h> inclusion.
       Which finally leads to the issue that we have to keep many useless macro
       definitions in <acpi/platform/aclinux.h> or <asm/acpi.h>.
       Such conditions include:
         COMPILER_DEPENDENT_UINT64
         COMPILER_DEPENDENT_INT64
         ACPI_INLINE
         ACPI_SYSTEM_XFACE
         ACPI_EXTERNAL_XFACE
         ACPI_INTERNAL_XFACE
         ACPI_INTERNAL_VAR_XFACE
         ACPI_MUTEX_TYPE
         DEBUGGER_THREADING
         ACPI_ACQUIRE_GLOBAL_LOCK
         ACPI_RELEASE_GLOBAL_LOCK
         ACPI_FLUSH_CPU_CACHE
       They have default implementations in <include/acpi/platform/acenv.h>
       while Linux need to keep a copy in <asm/acpi.h> to avoid build errors.
    
    This patch introduces <acpi/platform/aclinuxex.h> to fix this issue by
    splitting conditions and declarations (most of them are inline functions)
    into 2 header files so that the wrong inclusion of <acpi/actypes.h> can be
    removed from <acpi/platform/aclinux.h>.
    
    This patch also removes old ACPI_NATIVE_INTERFACE_HEADER mechanism which is
    not preferred by Linux and adds the platform/acenvex.h to be the solution
    to solve this issue.
    
    Signed-off-by: Lv Zheng <lv.zheng@intel.com>
    Signed-off-by: Rafael J. Wysocki <rafael.j.wysocki@intel.com>

commit 349b6c5355964d306d7d957c3af6179f3d6391ed
Author: Linus Walleij <linus.walleij@linaro.org>
Date:   Tue May 27 15:15:21 2014 +0200

    gpio: pch: add slab include
    
    After change 3ff35cbcfa4bc7d7dbdd0279e32ea677567ded02
    "gpio-pch: Fix Kconfig dependencies"
    which enabled COMPILE_TEST as an alternative for the PCH
    driver, we get build failures like this:
    
    drivers/gpio/gpio-pch.c: In function 'pch_gpio_probe':
    drivers/gpio/gpio-pch.c:359:2: error: implicit declaration
    of function 'kzalloc' [-Werror=implicit-function-declaration]
    drivers/gpio/gpio-pch.c:359:7: warning: assignment makes
    pointer from integer without a cast [enabled by default]
    drivers/gpio/gpio-pch.c:442:2: error: implicit declaration
    of function 'kfree' [-Werror=implicit-function-declaration]
    
    Fix this by including <linux/slab.h> explicitly.
    
    Cc: Jean Delvare <jdelvare@suse.de>
    Signed-off-by: Linus Walleij <linus.walleij@linaro.org>

commit 3ff35cbcfa4bc7d7dbdd0279e32ea677567ded02
Author: Jean Delvare <jdelvare@suse.de>
Date:   Fri May 16 11:59:14 2014 +0200

    gpio-pch: Fix Kconfig dependencies
    
    The gpio-pch driver is for a companion chip to the Intel Atom E600
    series processors. These are 32-bit x86 processors so the driver is
    only needed on X86_32. Add COMPILE_TEST as an alternative, so that the
    driver can still be build-tested elsewhere.
    
    Signed-off-by: Jean Delvare <jdelvare@suse.de>
    Cc: Linus Walleij <linus.walleij@linaro.org>
    Cc: Alexandre Courbot <gnurou@gmail.com>
    Signed-off-by: Linus Walleij <linus.walleij@linaro.org>

commit aa80581da1448e9fe5ef3d1e56a82bbb21912ee1
Author: Scott Wood <scottwood@freescale.com>
Date:   Tue May 20 20:26:01 2014 -0500

    powerpc/mpic: Don't init the fsl error int until after mpic init
    
    Besides other potential problems, if MPIC_NO_RESET is  not set,
    the error interrupt will be masked after it is requested.
    
    Signed-off-by: Scott Wood <scottwood@freescale.com>

commit a15783c34f6304e85f7d810e71316c1c3ba1fe69
Author: Vinod Koul <vinod.koul@intel.com>
Date:   Thu May 22 18:50:49 2014 +0530

    dmaengine: pch: fix compilation for alpha target
    
    commit 4828b493 introduced COMPILE_TEST for this driver and this cause compile
    failure on alpha as kzalloc wasnt availble for this arch in included header, so
    explictly add slab.h
    
    Reported-by: kbuild test robot <fengguang.wu@intel.com>
    Signed-off-by: Vinod Koul <vinod.koul@intel.com>

commit fa96faaa119b3f5f8c3936e290913258d2712ef3
Author: Jean Delvare <jdelvare@suse.de>
Date:   Tue May 6 10:05:21 2014 +0200

    i2c: eg20t: Fix Kconfig dependencies
    
    The i2c-eg20t driver is for a companion chip to the Intel Atom E600
    series processors. These are 32-bit x86 processors so the driver is
    only needed on X86_32. Add COMPILE_TEST as an alternative, so that the
    driver can still be build-tested elsewhere.
    
    Signed-off-by: Jean Delvare <jdelvare@suse.de>
    Signed-off-by: Wolfram Sang <wsa@the-dreams.de>

commit 4828b493695b1e7edd6bd9017c2b010b0d545381
Author: Jean Delvare <jdelvare@suse.de>
Date:   Fri May 16 16:17:37 2014 +0200

    dma: pch_dma: Fix Kconfig dependencies
    
    The pch_dma driver is for a companion chip to the Intel Atom E600
    series processors. These are 32-bit x86 processors so the driver is
    only needed on X86_32. Add COMPILE_TEST as an alternative, so that the
    driver can still be build-tested elsewhere.
    
    Signed-off-by: Jean Delvare <jdelvare@suse.de>
    Cc: Dan Williams <dan.j.williams@intel.com>
    Signed-off-by: Vinod Koul <vinod.koul@intel.com>

commit fdddfab5c91ac6632595dd852d912624d80951a9
Author: Jean Delvare <jdelvare@suse.de>
Date:   Tue May 6 10:20:59 2014 +0200

    can: pch_can: Fix Kconfig dependencies
    
    The pch_can driver is for a companion chip to the Intel Atom E600
    series processors. These are 32-bit x86 processors so the driver is
    only needed on X86_32. Add COMPILE_TEST as an alternative, so that the
    driver can still be build-tested elsewhere.
    
    Signed-off-by: Jean Delvare <jdelvare@suse.de>
    Cc: Wolfgang Grandegger <wg@grandegger.com>
    Cc: Marc Kleine-Budde <mkl@pengutronix.de>
    Signed-off-by: Marc Kleine-Budde <mkl@pengutronix.de>

commit eeaf4448c8fab616948572e10c7cbf692c30f3bb
Author: Jean Delvare <jdelvare@suse.de>
Date:   Tue May 6 10:19:15 2014 +0200

    can: at91_can: Fix Kconfig dependencies
    
    The at91_can driver is AT91-specific so it should depend on ARCH_AT91
    rather than just ARM. Add COMPILE_TEST as an alternative, so that the
    driver can still be build-tested elsewhere.
    
    Signed-off-by: Jean Delvare <jdelvare@suse.de>
    Cc: Wolfgang Grandegger <wg@grandegger.com>
    Cc: Marc Kleine-Budde <mkl@pengutronix.de>
    Signed-off-by: Marc Kleine-Budde <mkl@pengutronix.de>

commit b3d681a4fc108f9653bbb44e4f4e72db2b8a5734
Author: Jean Delvare <jdelvare@suse.de>
Date:   Thu May 15 15:29:23 2014 +0200

    firewire: Use COMPILE_TEST for build testing
    
    Stop using BROKEN as an alternative dependency for the purpose of
    build testing the firewire core. The newly introduced COMPILE_TEST is
    better suited for that purpose.
    
    Signed-off-by: Jean Delvare <jdelvare@suse.de>
    Signed-off-by: Stefan Richter <stefanr@s5r6.in-berlin.de>

commit 2b16069a7af4a4e6f6c2e599afe1301d0655487e
Author: Jean Delvare <jdelvare@suse.de>
Date:   Fri May 16 16:47:18 2014 +0200

    spi/topcliff-pch: Fix Kconfig dependencies
    
    The spi-topcliff-pch driver is for a companion chip to the Intel Atom
    E600 series processors. These are 32-bit x86 processors so the driver
    is only needed on X86_32. Add COMPILE_TEST as an alternative, so that
    the driver can still be build-tested elsewhere.
    
    Signed-off-by: Jean Delvare <jdelvare@suse.de>
    Signed-off-by: Mark Brown <broonie@linaro.org>

commit 9cc5e36d1c4794939deafd9f43bce2eab9c1142d
Author: Laurent Pinchart <laurent.pinchart+renesas@ideasonboard.com>
Date:   Tue May 13 01:04:36 2014 +0200

    irda: sh_irda: Enable driver compilation with COMPILE_TEST
    
    This helps increasing build testing coverage.
    
    Signed-off-by: Laurent Pinchart <laurent.pinchart+renesas@ideasonboard.com>
    Acked-by: Simon Horman <horms@verge.net.au>
    Signed-off-by: David S. Miller <davem@davemloft.net>

commit 1f7fc40876934d52278bb1ee0544191a4b4657f1
Author: Felipe Balbi <balbi@ti.com>
Date:   Wed Apr 30 11:36:03 2014 -0500

    usb: phy: msm: enable build on other architectures
    
    By adding COMPILE_TEST to the list of dependencies
    we can build test this driver on all other architectures
    which is very valuable for maintainers applying patches
    and to find silly mistakes during development.
    
    Reviewed-by: Ivan T. Ivanov <iivanov@mm-sol.com>
    Signed-off-by: Felipe Balbi <balbi@ti.com>

commit 9d5d96ef2c3cb6da6eec7dd9d107ea63781368a0
Author: Arnd Bergmann <arnd@arndb.de>
Date:   Mon Apr 28 11:07:03 2014 +0200

    gpio: always enable GPIO_OMAP on ARCH_OMAP
    
    Commit 4df42de9d3e "gpio: omap: add a GPIO_OMAP option instead of using
    ARCH_OMAP" made it possible to build OMAP kernels without the GPIO driver,
    which at least on OMAP2 and OMAP3 causes build errors because of functions
    used by the platform power management code:
    
    arch/arm/mach-omap2/built-in.o: In function `omap_sram_idle':
    arch/arm/mach-omap2/pm24xx.c:129: undefined reference to `omap2_gpio_prepare_for_idle'
    arch/arm/mach-omap2/pm24xx.c:129: undefined reference to `omap2_gpio_resume_after_idle'
    
    We presumably always want the GPIO driver on OMAP, so this adds a slightly
    broader dependency and only allows disabling the driver only when no
    OMAP2PLUS platform is selected.
    
    However, it seems entirely reasonable to include the driver in build tests
    on other platforms, so we should also allow building it for COMPILE_TEST
    builds and select the required GENERIC_IRQ_CHIP that may not already be
    enabled on other platforms.
    
    Signed-off-by: Arnd Bergmann <arnd@arndb.de>
    Acked-by: Javier Martinez Canillas <javier.martinez@collabora.co.uk>
    Signed-off-by: Linus Walleij <linus.walleij@linaro.org>

commit d5cef008e95ffdaf457e38254e67d145a927df96
Merge: 58612c608f41 ea7e586bdd33
Author: Greg Kroah-Hartman <gregkh@linuxfoundation.org>
Date:   Sat Apr 26 08:12:25 2014 -0700

    Merge tag 'iio-for-3.16a' of git://git.kernel.org/pub/scm/linux/kernel/git/jic23/iio into staging-next
    
    Jonathan writes:
    
    First round of IIO new driver, functionality and cleanups for the 3.16 cycle.
    
    New device support
    * AS3935 Lightning Sensor
    * MCP3426/7/8 support added to the existing MCP3422 ADC driver
    * AK8963 support in the AK8975 driver
    * MPU6500 support in the MPU6050 driver (the functionality that is different
      is mostly not supported yet in either part).
    
    Staging Graduations
    * AD799x ADC
    
    New functionality
    * ACPI enumeration for the ak8975 driver
    
    Cleanup / tweaks
    * Use snprintf as a matter of good practice in a few additional places.
    * Document *_mean_raw attributes.  These have been there a while, but were
      undocumented.
    * Add an in kernel interface to get the mean values.
    * Bug in the length of the event info mask that by coincidence wasn't yet
      actually causing any problems.
    * itg3000 drop an unreachable return statement.
    * spear_adc cleanups (heading for a staging graduation but a few more
      issues showed up in the review of these patches).
    * Exynos ADC dependencies changed so it is only built when Exynos is present
      or COMPILE_TEST and OF are set.
    * tsl2583 cleanups.
    * Some cut and paste typos in the comments of various drivers still in staging.
    * Couple of minor improvements to the ST sensor drivers.

commit 0aa2a15a7b5ca861b02379a7dcb2d7bf427c62cc
Author: Lars-Peter Clausen <lars@metafoo.de>
Date:   Tue Apr 22 22:46:36 2014 +0200

    ASoC: jz4740: Improve build test coverage
    
    Allow the jz4740 audio drivers to be build when CONFIG_COMPILE_TEST is selected.
    This should improve the build test coverage. There is one small piece of
    platform dependent code in the jz4740-i2s driver. It uses the DMA request type
    constants which are defined in a platform specific header. We can solve this by
    moving them from the platform specific header to the I2S driver.
    
    Signed-off-by: Lars-Peter Clausen <lars@metafoo.de>
    Acked-by: Ralf Baechle <ralf@linux-mips.org>
    Signed-off-by: Mark Brown <broonie@linaro.org>

commit dc002f99f3aa7c05981ecbbbc20efe5e8befe98a
Author: Brian Norris <computersforpeace@gmail.com>
Date:   Wed Apr 16 01:40:17 2014 -0700

    mtd: st_spi_fsm: only build for ARM
    
    COMPILE_TEST allows us to build this driver on other arch'es. But not
    all arch'es have the right I/O accessors -- particularly, x86 is missing
    readsl() and writesl().
    
    So just restrict this driver to ARCH_STI. It's still buildable for a
    multiplatform ARM kernel, so it can get decent compile coverage.
    
    Signed-off-by: Brian Norris <computersforpeace@gmail.com>
    Acked-by: Lee Jones <lee.jones@linaro.org>

commit 09c9b61d5da24174b867a6ffda29b7435e1fda74
Merge: 141eaccd018e c4586256f0c4
Author: Linus Torvalds <torvalds@linux-foundation.org>
Date:   Sat Apr 12 17:00:40 2014 -0700

    Merge tag 'llvmlinux-for-v3.15' of git://git.linuxfoundation.org/llvmlinux/kernel
    
    Pull llvm patches from Behan Webster:
     "These are some initial updates to support compiling the kernel with
      clang.
    
      These patches have been through the proper reviews to the best of my
      ability, and have been soaking in linux-next for a few weeks.  These
      patches by themselves still do not completely allow clang to be used
      with the kernel code, but lay the foundation for other patches which
      are still under review.
    
      Several other of the LLVMLinux patches have been already added via
      maintainer trees"
    
    * tag 'llvmlinux-for-v3.15' of git://git.linuxfoundation.org/llvmlinux/kernel:
      x86: LLVMLinux: Fix "incomplete type const struct x86cpu_device_id"
      x86 kbuild: LLVMLinux: More cc-options added for clang
      x86, acpi: LLVMLinux: Remove nested functions from Thinkpad ACPI
      LLVMLinux: Add support for clang to compiler.h and new compiler-clang.h
      LLVMLinux: Remove warning about returning an uninitialized variable
      kbuild: LLVMLinux: Fix LINUX_COMPILER definition script for compilation with clang
      Documentation: LLVMLinux: Update Documentation/dontdiff
      kbuild: LLVMLinux: Adapt warnings for compilation with clang
      kbuild: LLVMLinux: Add Kbuild support for building kernel with Clang

commit db46293bc6866a9bcffc9cb5b1ae9c46e4f83fa7
Author: Jan-Simon Mller <dl9pf@gmx.de>
Date:   Wed Nov 14 10:55:48 2012 +0100

    kbuild: LLVMLinux: Fix LINUX_COMPILER definition script for compilation with clang
    
    When building the LINUX_COMPILER definition, instead of merely taking the last
    line from "$(CC) -v", grep for ' version ' in the output. This supports both
    gcc and clang.
    
    Signed-off-by: Jan-Simon Mller <dl9pf@gmx.de>
    Signed-off-by: Behan Webster <behanw@converseincode.com>
    Signed-off-by: Mark Charlebois <charlebm@gmail.com>
    Cc: PaX Team <pageexec@freemail.hu>

commit d2b150d0647e055d7a71b1c33140280550b27dd6
Merge: cbda94e039c3 13ce64c8f775
Author: Linus Torvalds <torvalds@linux-foundation.org>
Date:   Sat Apr 5 15:38:41 2014 -0700

    Merge tag 'sh-3.15' of git://git.kernel.org/pub/scm/linux/kernel/git/arm/arm-soc
    
    Pull ARM SoC sh driver change from Arnd Bergmann:
     "The drivers/sh subdirectory used to get merged through the SH
      architecture tree, but things are in flux there and some of the
      drivers are shared with ARM shmobile, we have picked it up for the
      time being.
    
      There is only one trivial patch from Laurent Pinchart this time"
    
    * tag 'sh-3.15' of git://git.kernel.org/pub/scm/linux/kernel/git/arm/arm-soc:
      sh: intc: Enable driver compilation with COMPILE_TEST

commit 74c03eb63061c834893e7ebf8d298573bdccfd08
Author: Tejun Heo <tj@kernel.org>
Date:   Wed Apr 2 12:41:59 2014 -0400

    libata: make AHCI_XGENE depend on PHY_XGENE
    
    AHCI_XGENE is only applicable on ARM64 but it can also be enabled for
    compile testing; however, AHCI_XGENE selects PHY_XGENE which has other
    arch specific dependencies.  This leads to the following warning when
    enabling it on other archs for compile testing.
    
      warning: (AHCI_XGENE) selects PHY_XGENE which has unmet direct
      dependencies (HAS_IOMEM && OF && (ARM64 || COMPILE_TEST))
    
    Selecting a config option which itself has dependencies can easily
    lead to broken configurations.  For now, let's just make AHCI_XGENE
    depend on PHY_XGENE which has all the necessary dependencies already.
    
    Signed-off-by: Tejun Heo <tj@kernel.org>
    Reported-by: Linus Torvalds <torvalds@linux-foundation.org>
    Cc: Loc Ho <lho@apm.com>
    Cc: Bartlomiej Zolnierkiewicz <b.zolnierkie@samsung.com>
    Cc: Kishon Vijay Abraham I <kishon@ti.com>

commit 408eccce32044ee3285a7f6a812723ba3540c3e7
Author: Daniel Borkmann <dborkman@redhat.com>
Date:   Tue Apr 1 16:20:23 2014 +0200

    net: ptp: move PTP classifier in its own file
    
    This commit fixes a build error reported by Fengguang, that is
    triggered when CONFIG_NETWORK_PHY_TIMESTAMPING is not set:
    
      ERROR: "ptp_classify_raw" [drivers/net/ethernet/oki-semi/pch_gbe/pch_gbe.ko] undefined!
    
    The fix is to introduce its own file for the PTP BPF classifier,
    so that PTP_1588_CLOCK and/or NETWORK_PHY_TIMESTAMPING can select
    it independently from each other. IXP4xx driver on ARM needs to
    select it as well since it does not seem to select PTP_1588_CLOCK
    or similar that would pull it in automatically.
    
    This also allows for hiding all of the internals of the BPF PTP
    program inside that file, and only exporting relevant API bits
    to drivers.
    
    This patch also adds a kdoc documentation of ptp_classify_raw()
    API to make it clear that it can return PTP_CLASS_* defines. Also,
    the BPF program has been translated into bpf_asm code, so that it
    can be more easily read and altered (extensively documented in [1]).
    
    In the kernel tree under tools/net/ we have bpf_asm and bpf_dbg
    tools, so the commented program can simply be translated via
    `./bpf_asm -c prog` where prog is a file that contains the
    commented code. This makes it easily readable/verifiable and when
    there's a need to change something, jump offsets etc do not need
    to be replaced manually which can be very error prone. Instead,
    a newly translated version via bpf_asm can simply replace the old
    code. I have checked opcode diffs before/after and it's the very
    same filter.
    
      [1] Documentation/networking/filter.txt
    
    Fixes: 164d8c666521 ("net: ptp: do not reimplement PTP/BPF classifier")
    Reported-by: Fengguang Wu <fengguang.wu@intel.com>
    Signed-off-by: Daniel Borkmann <dborkman@redhat.com>
    Signed-off-by: Alexei Starovoitov <ast@plumgrid.com>
    Cc: Richard Cochran <richardcochran@gmail.com>
    Cc: Jiri Benc <jbenc@redhat.com>
    Acked-by: Richard Cochran <richardcochran@gmail.com>
    Signed-off-by: David S. Miller <davem@davemloft.net>

commit c12ac9f98ec08d6eb69f84e3f72241d56a8b0822
Merge: 3786075b5ebc 45b15d98a96f
Author: Linus Torvalds <torvalds@linux-foundation.org>
Date:   Tue Apr 1 13:23:53 2014 -0700

    Merge tag 'spi-v3.15' of git://git.kernel.org/pub/scm/linux/kernel/git/broonie/spi
    
    Pull spi Updates from Mark Brown:
     "A busy release for both cleanups and new drivers this time along with
      further factoring out of replicated code into the core:
    
       - Provide support in the core for DMA mapping transfers - essentially
         all drivers weren't implementing this properly, now there's no
         excuse.
       - Dual and quad mode support for spidev.
       - Fix handling of cs_change in the generic implementation.
       - Remove the S3C_DMA code from the s3c64xx driver now that all the
         platforms using it have been converted to dmaengine.
       - Lots of improvements to the Renesas SPI controllers.
       - Drivers for Allwinner A10 and A31, Qualcomm QUP and Xylinx xtfpga.
       - Removal of the bitrotted ti-ssp driver"
    
    * tag 'spi-v3.15' of git://git.kernel.org/pub/scm/linux/kernel/git/broonie/spi: (199 commits)
      spi: Fix handling of cs_change in core implementation
      spi: bitbang: Make spi_bitbang_stop() return void
      spi: mpc52xx: Convert to use bits_per_word_mask
      spi: omap-100k: Fix memory leak
      spi: dw: Don't call kfree for memory allocated by devm_kzalloc
      spi: fsl-dspi: Fix memory leak
      spi: omap-uwire: add missing iounmap
      spi: clps711x: Convert to use master->max_speed_hz
      spi: clps711x: Enable driver compilation with COMPILE_TEST
      spi: omap-uwire: Remove full duplex check
      spi: Do not require a completion
      spi: topcliff-pch: Transform noisy message to dev_vdbg
      spi: coldfire-qspi: Simplify the code to set register bits for transfer speed
      spi: bcm63xx: Remove unused define for PFX
      spi: efm32: use $vendor,$device scheme for compatible string
      spi: clps711x: Remove <mach/hardware.h> dependency
      spi: topcliff-pch: Properly unregister platform devices on probe() error paths
      spi: fsl-espi: Remove unused bits_per_word variable in fsl_espi_bufs
      spi: altera: Remove the code to get unused platform_data
      spi: fsl-lib: Fix memory leak of pinfo
      ...

commit 03803ef66d22702af124d21552f90ac32da9fef5
Author: Bartlomiej Zolnierkiewicz <b.zolnierkie@samsung.com>
Date:   Thu Mar 27 14:24:39 2014 +0100

    ata: fix Marvell SATA driver dependencies
    
    Make sata_mv host driver depend on PCI || ARCH_DOVE || ARCH_KIRKWOOD ||
    ARCH_MV78XX0 || ARCH_MVEBU || ARCH_ORION5X config options as Marvell
    SATA support covers both Marvell PCI devices and Marvell Dove, Kirkwood,
    MV78xx0, Armada 370/XP and Orion5x SoCs (for non-PCI devices the driver
    to work requires suitable device tree node or platform device to be
    defined).  Additionally allow the driver build if COMPILE_TEST config
    option is set.
    
    Cc: Jason Cooper <jason@lakedaemon.net>
    Cc: Andrew Lunn <andrew@lunn.ch>
    Cc: Gregory Clement <gregory.clement@free-electrons.com>
    Cc: Sebastian Hesselbarth <sebastian.hesselbarth@gmail.com>
    Signed-off-by: Bartlomiej Zolnierkiewicz <b.zolnierkie@samsung.com>
    Signed-off-by: Tejun Heo <tj@kernel.org>

commit 5634dd8bf422e0e5b71bb9762ff079f01a5f9a83
Author: Axel Lin <axel.lin@ingics.com>
Date:   Wed Mar 26 16:53:18 2014 +0800

    spi: clps711x: Enable driver compilation with COMPILE_TEST
    
    This helps increasing build testing coverage.
    
    Signed-off-by: Axel Lin <axel.lin@ingics.com>
    Signed-off-by: Mark Brown <broonie@linaro.org>

commit e638433b5021f59aacbfe15597beca1e706773fb
Author: Bartlomiej Zolnierkiewicz <b.zolnierkie@samsung.com>
Date:   Wed Mar 26 15:33:37 2014 +0100

    ata: fix ARASAN CompactFlash PATA driver dependencies
    
    Make pata_arasan_cf host driver depend on ARCH_SPEAR13XX config
    option as ARASAN CompactFlash PATA support is specific to ST
    SPEAr13xx SoCs and the driver to work requires suitable device
    tree node (or platform device) to be defined.  Additionally
    allow the driver build if COMPILE_TEST config option is set.
    
    Cc: Viresh Kumar <viresh.linux@gmail.com>
    Cc: Shiraz Hashim <shiraz.hashim@st.com>
    Signed-off-by: Bartlomiej Zolnierkiewicz <b.zolnierkie@samsung.com>
    Signed-off-by: Tejun Heo <tj@kernel.org>

commit 0b99f8648eb1814d787db3981ad93e6bc343b3f6
Author: Bartlomiej Zolnierkiewicz <b.zolnierkie@samsung.com>
Date:   Wed Mar 26 16:39:50 2014 +0100

    ata: fix Calxeda Highbank SATA driver dependencies
    
    Make sata_highbank host driver depend on ARCH_HIGHBANK config option
    as Calxeda Highbank SATA support is specific to Calxeda Highbank
    SoCs and the driver to work requires suitable device tree node to
    be defined.  Additionally allow the driver build if COMPILE_TEST
    config option is set.
    
    Cc: Mark Langsdorf <mark.langsdorf@calxeda.com>
    Cc: Rob Herring <robh@kernel.org>
    Signed-off-by: Bartlomiej Zolnierkiewicz <b.zolnierkie@samsung.com>
    Signed-off-by: Tejun Heo <tj@kernel.org>

commit 3e9eac50cdcac71a74ca4a8cb587799f474ca62d
Author: Hanjun Guo <hanjun.guo@linaro.org>
Date:   Wed Mar 26 08:36:23 2014 +0800

    Revert "ACPI / processor: Make it possible to get APIC ID via GIC"
    
    Revert commit df86f5df79d8 (ACPI / processor: Make it possible to get
    APIC ID via GIC).
    
    APIC ID refers the hardware ID of the CPU, which means MPIDR on
    ARM/ARM64, but in ACPI 5.0, GIC ID feild in GIC structure have
    no explicit definition and may not refer to the MPIDR.
    
    Commit df86f5df79d8 assumed that gic->gic_id as MPIDR which may not be
    the case, so revert it until the explicit definition of GIC structure
    is ready.
    
    Signed-off-by: Hanjun Guo <hanjun.guo@linaro.org>
    [rjw: Changelog]
    Signed-off-by: Rafael J. Wysocki <rafael.j.wysocki@intel.com>

commit 7596d93d8dfa7a508ca52c7d9b7db763eb5b0715
Author: Bartlomiej Zolnierkiewicz <b.zolnierkie@samsung.com>
Date:   Wed Mar 26 15:19:23 2014 +0100

    ata: fix R-Car SATA driver dependencies
    
    Make sata_rcar host driver depend on ARCH_SHMOBILE config option as
    Renesas R-Car SATA support is specific to Renesas SoCs and the driver
    to work requires suitable device tree node (or platform device) to be
    defined.  Additionally allow the driver build if COMPILE_TEST config
    option is set.
    
    Cc: Simon Horman <horms@verge.net.au>
    Cc: Magnus Damm <magnus.damm@gmail.com>
    Signed-off-by: Bartlomiej Zolnierkiewicz <b.zolnierkie@samsung.com>
    Signed-off-by: Tejun Heo <tj@kernel.org>

commit be8dde46750be49fbf161dccd568b5cd14d3f004
Author: Axel Lin <axel.lin@ingics.com>
Date:   Thu Mar 20 18:08:04 2014 +0800

    spi: xtensa-xtfpga: Enable driver compilation with COMPILE_TEST
    
    This helps increasing build testing coverage.
    
    Signed-off-by: Axel Lin <axel.lin@ingics.com>
    Reviewed-by: Max Filippov <jcmvbkbc@gmail.com>
    Signed-off-by: Mark Brown <broonie@linaro.org>

commit 13ce64c8f7750ce59066a987951faff38bb7dd97
Merge: 0414855fdc4a 4f3068f60503
Author: Olof Johansson <olof@lixom.net>
Date:   Sun Mar 16 23:29:46 2014 -0700

    Merge tag 'renesas-intc-for-v3.15' of git://git.kernel.org/pub/scm/linux/kernel/git/horms/renesas into next/sh
    
    Merge "Renesas intc Updates for v3.15" from Simon Horman:
    
    * Enable driver compilation with COMPILE_TEST
    
    * tag 'renesas-intc-for-v3.15' of git://git.kernel.org/pub/scm/linux/kernel/git/horms/renesas:
      sh: intc: Enable driver compilation with COMPILE_TEST
    
    Signed-off-by: Olof Johansson <olof@lixom.net>

commit 81b86d4d275244ad7e134e95cbcfee49198da854
Author: Bradley Grove <bgrove@attotech.com>
Date:   Thu Dec 19 10:50:57 2013 -0500

    [SCSI] pm80xx: Enable BAR shift to avoid BIOS conflict with MPI space for ATTO pm8001 based HBAs.
    
    Signed-off-by: Bradley Grove <bgrove@attotech.com>
    Signed-off-by: James Bottomley <JBottomley@Parallels.com>

commit 1dc3217dad3e771f2bd12703d6daed6cb818fdd8
Merge: 4aa41ba7f7cf f2234bcd03ad
Author: Linus Torvalds <torvalds@linux-foundation.org>
Date:   Sun Mar 9 13:52:53 2014 -0700

    Merge branch 'for-rc6' of git://git.kernel.org/pub/scm/linux/kernel/git/rzhang/linux
    
    Pull thermal fixes from Zhang Rui:
     "Specifics:
    
       - Update the help text of INT3403 Thermal driver, which was not
         friendly to users.  From Zhang Rui.
    
       - The "type" sysfs attribute of x86_pkg_temp_thermal registered
         thermal zones includes an instance number, which makes the
         thermal-to-hwmon bridge fails to group them all in a single hwmon
         device.  Fixed by Jean Delvare.
    
       - The hwmon device registered by x86_pkg_temp_thermal driver is
         redundant because the temperature value reported by
         x86_pkg_temp_thermal is already reported by the coretemp driver.
         Fixed by Jean Delvare.
    
       - Fix a problem that the cooling device can not be updated properly
         if it is initialized at max cooling state.  From Ni Wade.
    
       - Fix a problem that OF registered thermal zones are running without
         thermal governors.  From Zhang Rui.
    
       - Commit beeb5a1e0ef7 ("thermal: rcar-thermal: Enable driver
         compilation with COMPILE_TEST") broke build on archs wihout io
         memory.  Thus make it depend on HAS_IOMEM to bypass build failures.
         Fixed by Richard Weinberger"
    
    * 'for-rc6' of git://git.kernel.org/pub/scm/linux/kernel/git/rzhang/linux:
      Thermal: thermal zone governor fix
      Thermal: Allow first update of cooling device state
      thermal,rcar_thermal: Add dependency on HAS_IOMEM
      x86_pkg_temp_thermal: Fix the thermal zone type
      x86_pkg_temp_thermal: Do not expose as a hwmon device
      Thermal: update INT3404 thermal driver help text

commit adca4767821e54c72d4a2f467af77923f2c87e07
Author: Andrew Lutomirski <luto@amacapital.net>
Date:   Tue Mar 4 17:24:10 2014 -0800

    net: Improve SO_TIMESTAMPING documentation and fix a minor code bug
    
    The original documentation was very unclear.
    
    The code fix is presumably related to the formerly unclear
    documentation: SOCK_TIMESTAMPING_RX_SOFTWARE has no effect on
    __sock_recv_timestamp's behavior, so calling __sock_recv_ts_and_drops
    from sock_recv_ts_and_drops if only SOCK_TIMESTAMPING_RX_SOFTWARE is
    set is pointless.  This should have no user-observable effect.
    
    Signed-off-by: Andy Lutomirski <luto@amacapital.net>
    Acked-by: Richard Cochran <richardcochran@gmail.com>
    Signed-off-by: David S. Miller <davem@davemloft.net>

commit b83544390797ce488ccc0f9e40aa2f96661f842b
Author: Paul Bolle <pebolle@tiscali.nl>
Date:   Sat Feb 8 22:21:54 2014 +0100

    iommu/shmobile: Depend on ARCH_SHMOBILE
    
    Commit 78a2e12f51d9 ("iommu: shmobile: Enable driver compilation with
    COMPILE_TEST") added an optional dependency on SH_MOBILE. But that
    Kconfig symbol doesn't exist. It seems ARCH_SHMOBILE was intended. Use
    that.
    
    Signed-off-by: Paul Bolle <pebolle@tiscali.nl>
    Acked-by: Laurent Pinchart <laurent.pinchart@ideasonboard.com>
    Signed-off-by: Joerg Roedel <joro@8bytes.org>

commit f6e763b93a6cd3411fd8df925344022719bcba62
Author: Mark Brown <broonie@linaro.org>
Date:   Tue Mar 4 07:51:17 2014 +0000

    arm64: topology: Implement basic CPU topology support
    
    Add basic CPU topology support to arm64, based on the existing pre-v8
    code and some work done by Mark Hambleton.  This patch does not
    implement any topology discovery support since that should be based on
    information from firmware, it merely implements the scaffolding for
    integration of topology support in the architecture.
    
    No locking of the topology data is done since it is only modified during
    CPU bringup with external serialisation from the SMP code.
    
    The goal is to separate the architecture hookup for providing topology
    information from the DT parsing in order to ease review and avoid
    blocking the architecture code (which will be built on by other work)
    with the DT code review by providing something simple and basic.
    
    Following patches will implement support for interpreting topology
    information from MPIDR and for parsing the DT topology bindings for ARM,
    similar patches will be needed for ACPI.
    
    Signed-off-by: Mark Brown <broonie@linaro.org>
    Acked-by: Mark Rutland <mark.rutland@arm.com>
    [catalin.marinas@arm.com: removed CONFIG_CPU_TOPOLOGY, always on if SMP]
    Signed-off-by: Catalin Marinas <catalin.marinas@arm.com>

commit d1c8b0410b77f1e43f97cd22bc7e0a71a5305840
Author: Richard Weinberger <richard@nod.at>
Date:   Mon Jan 27 09:40:58 2014 +0100

    thermal,rcar_thermal: Add dependency on HAS_IOMEM
    
    Commit beeb5a1e (thermal: rcar-thermal: Enable driver compilation with COMPILE_TEST)
    broke build on archs wihout io memory.
    
    On archs like S390 or um this driver cannot build nor work.
    Make it depend on HAS_IOMEM to bypass build failures.
    
    drivers/thermal/rcar_thermal.c:404: undefined reference to `devm_ioremap_resource'
    drivers/thermal/rcar_thermal.c:426: undefined reference to `devm_ioremap_resource'
    
    Signed-off-by: Richard Weinberger <richard@nod.at>
    Acked-by: Laurent Pinchart <laurent.pinchart@ideasonboard.com>
    Acked-by: Kuninori Morimoto <kuninori.morimoto.gx@renesas.com>
    Signed-off-by: Zhang Rui <rui.zhang@intel.com>

commit a50ce20ecabdb9310fde90af31a8adb79cf0805e
Author: Sylwester Nawrocki <s.nawrocki@samsung.com>
Date:   Fri Feb 21 17:44:02 2014 +0100

    phy: Select PHY_EXYNOS_DP_VIDEO by default for ARCH_EXYNOS
    
    Instead of requiring user to figure out when PHY_EXYNOS_DP_VIDEO needs
    to be selected select it by default for Exynos SoCs. Also enable it
    when COMPILE_TEST is selected. If required the display port PHY driver
    can be then disabled or compiled in as module.
    
    Signed-off-by: Sylwester Nawrocki <s.nawrocki@samsung.com>
    Acked-by: Kyungmin Park <kyungmin.park@samsung.com>
    Acked-by: Jingoo Han <jg1.han@samsung.com>
    Acked-by: Felipe Balbi <balbi@ti.com>
    Acked-by: Uwe Kleine-Knig <u.kleine-koenig@pengutronix.de>
    Signed-off-by: Kishon Vijay Abraham I <kishon@ti.com>

commit 13454e5e08450fe500bef240aa98976dcb06ff63
Author: Sylwester Nawrocki <s.nawrocki@samsung.com>
Date:   Fri Feb 21 17:44:01 2014 +0100

    phy: Select PHY_EXYNOS_MIPI_VIDEO by default for ARCH_EXYNOS
    
    Instead of requiring user to figure out when PHY_EXYNOS_MIPI_VIDEO needs
    to be selected select it by default for Exynos SoCs. Also enable it when
    COMPILE_TEST is selected. If required the MIPI CSIS/DPHY driver can be
    then disabled or compiled in as module.
    
    Signed-off-by: Sylwester Nawrocki <s.nawrocki@samsung.com>
    Acked-by: Kyungmin Park <kyungmin.park@samsung.com>
    Acked-by: Felipe Balbi <balbi@ti.com>
    Acked-by: Uwe Kleine-Knig <u.kleine-koenig@pengutronix.de>
    Signed-off-by: Kishon Vijay Abraham I <kishon@ti.com>

commit fc945d6eb70ebf29532b94ae309c0d4c6d609c3c
Author: Alexander Shiyan <shc_work@mail.ru>
Date:   Sat Feb 22 11:29:51 2014 +0400

    w1: mxc_w1: Enable driver compilation with COMPILE_TEST
    
    This helps increasing build testing coverage.
    To do this, __raw_{read,write}b() functions was be replaced with
    simple {read,write}b() variants.
    
    Signed-off-by: Alexander Shiyan <shc_work@mail.ru>
    Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>

commit ef4741e90c4e6523795f4375659b5097293d87db
Author: Magnus Damm <damm@opensource.se>
Date:   Tue Feb 18 11:12:01 2014 +0900

    PCI: rcar: Make the Kconfig dependencies more generic
    
    Update the R-Car Generation 2 PCI driver Kconfig dependencies to follow
    same style as other drivers - no SoC dependencies.
    
    Also, update the COMPILE_TEST bits to depend on ARM. This since the DMA
    bounce buffer and dma_ops handling code is ARM specific.
    
    [bhelgaas: adjust context after dropping DMABOUNCE patches]
    Signed-off-by: Magnus Damm <damm@opensource.se>
    Signed-off-by: Bjorn Helgaas <bhelgaas@google.com>
    Acked-by: Simon Horman <horms+renesas@verge.net.au>

commit 80faf90f9734a06eb4da2e3b92e698b96f469c2c
Author: Axel Lin <axel.lin@ingics.com>
Date:   Mon Feb 24 12:07:51 2014 +0800

    spi: qup: Depend on ARM && COMPILE_TEST to avoid build error
    
    This driver uses writel_relaxed() which does not exist in x86, ppc, etc.
    Make it depend on ARM && COMPILE_TEST to avoid below build error:
    
      CC [M]  drivers/spi/spi-qup.o
    drivers/spi/spi-qup.c: In function 'spi_qup_set_state':
    drivers/spi/spi-qup.c:180:3: error: implicit declaration of function 'writel_relaxed' [-Werror=implicit-function-declaration]
    cc1: some warnings being treated as errors
    make[2]: *** [drivers/spi/spi-qup.o] Error 1
    make[1]: *** [drivers/spi] Error 2
    make: *** [drivers] Error 2
    
    Reported-by: Stephen Rothwell <sfr@canb.auug.org.au>
    Signed-off-by: Axel Lin <axel.lin@ingics.com>
    Signed-off-by: Mark Brown <broonie@linaro.org>

commit 702d3cf9d05dbb2dc145bc97aeff6c4d61bec70f
Author: Axel Lin <axel.lin@ingics.com>
Date:   Sun Feb 23 13:28:33 2014 +0800

    spi: qup: Enable driver compilation with COMPILE_TEST
    
    This helps increasing build testing coverage.
    
    Signed-off-by: Axel Lin <axel.lin@ingics.com>
    Signed-off-by: Mark Brown <broonie@linaro.org>

commit d0e3a9719f166a81db3bab1b6ec24f544473316c
Merge: b04c644e670f bc69b8adfe22
Author: Thomas Gleixner <tglx@linutronix.de>
Date:   Sat Feb 22 10:57:06 2014 +0100

    Merge tag 'irqchip-mvebu-3.15' of git://git.infradead.org/linux-mvebu into irq/core
    
    irqchip mvebu changes for v3.15
    
     - armada-370-xp
        - add MSI helper
        - MPIC chained handler
    
    Signed-off-by: Thomas Gleixner <tglx@linutronix.de>

commit bc69b8adfe221def02ea10f7b9ab32e80195334c
Author: Ezequiel Garcia <ezequiel.garcia@free-electrons.com>
Date:   Mon Feb 10 17:00:02 2014 -0300

    irqchip: armada-370-xp: Setup a chained handler for the MPIC
    
    The new Armada 375 and Armada 38x Marvell SoCs are based on Cortex-A9
    CPU cores and use the ARM GIC as their main interrupt controller.
    However, for various purposes (wake-up from suspend, MSI interrupts),
    they have kept a separate MPIC interrupt controller, acting as a slave
    to the GIC. This MPIC was already used as the primary controller on
    previous Marvell SoCs, so this commit extends the existing driver to
    allow the MPIC to be used as a GIC slave.
    
    Reviewed-by: Gregory CLEMENT <gregory.clement@free-electrons.com>
    Signed-off-by: Ezequiel Garcia <ezequiel.garcia@free-electrons.com>
    Signed-off-by: Jason Cooper <jason@lakedaemon.net>

commit 9b8cf779f93bc48c0f12ef71e5bc90fd92322656
Author: Ezequiel Garcia <ezequiel.garcia@free-electrons.com>
Date:   Mon Feb 10 17:00:01 2014 -0300

    irqchip: armada-370-xp: Add helper for the MSI IRQ handling
    
    Introduce a helper function to handle the MSI interrupts. This makes
    the code more readable. In addition, this will allow to introduce a
    chained IRQ handler mechanism, which is needed in situations where the
    MPIC is used as a slave to another interrupt controller.
    
    Reviewed-by: Gregory CLEMENT <gregory.clement@free-electrons.com>
    Signed-off-by: Ezequiel Garcia <ezequiel.garcia@free-electrons.com>
    Signed-off-by: Jason Cooper <jason@lakedaemon.net>

commit 4f3068f60503e08bc9e729528d9e54289980fa96
Author: Laurent Pinchart <laurent.pinchart+renesas@ideasonboard.com>
Date:   Wed Nov 27 02:18:37 2013 +0100

    sh: intc: Enable driver compilation with COMPILE_TEST
    
    This helps increasing build testing coverage.
    
    Signed-off-by: Laurent Pinchart <laurent.pinchart+renesas@ideasonboard.com>
    Signed-off-by: Simon Horman <horms+renesas@verge.net.au>

commit 0d3d96ab0059074a18dbb5fc2f9df859c06019bf
Author: Thomas Petazzoni <thomas.petazzoni@free-electrons.com>
Date:   Mon Feb 17 15:23:28 2014 +0100

    ARM: mvebu: add Device Tree description of the Armada 380/385 SoCs
    
    The Armada 380 and 385 SoCs are new SoCs from Marvell, based on a
    Cortex-A9 cores (single core for 380, dual core for 385) and a number
    of hardware blocks that are common with earlier SoCs from the mvebu
    family.
    
    The provided Device Tree describes the following parts of the SoC:
    
     * CPU
     * Device Bus
     * Clocks
     * Interrupt controllers: GIC and MPIC
     * GPIO controllers
     * I2C buses
     * L2 cache
     * MBus controller
     * Pinctrl
     * Serial
     * SPI buses
     * System controller (for reboot)
     * Timer
     * XOR engines
     * PCIe controllers
     * Network interfaces
    
    Signed-off-by: Thomas Petazzoni <thomas.petazzoni@free-electrons.com>
    Signed-off-by: Jason Cooper <jason@lakedaemon.net>

commit 4de59085091f753d08c8429d756b46756ab94665
Author: Gregory CLEMENT <gregory.clement@free-electrons.com>
Date:   Mon Feb 17 15:23:25 2014 +0100

    ARM: mvebu: add Device Tree description of the Armada 375 SoC
    
    The Armada 375 SoC is a new SoC from Marvell, based on a dual core
    Cortex-A9 and a number of hardware blocks that are common with earlier
    SoCs from the mvebu family.
    
    The provided Device Tree describes the following parts of the SoC:
    
     * CPUs
     * Device Bus
     * Clocks
     * Interrupt controllers: GIC and MPIC
     * GPIO controllers
     * I2C buses
     * L2 cache
     * MBus controller
     * SDIO
     * Pinctrl
     * SATA
     * Serial
     * SPI buses
     * System controller (for reboot)
     * Timer
     * XOR engines
     * PCIe controllers
    
    Signed-off-by: Gregory CLEMENT <gregory.clement@free-electrons.com>
    Signed-off-by: Thomas Petazzoni <thomas.petazzoni@free-electrons.com>
    Signed-off-by: Jason Cooper <jason@lakedaemon.net>

commit 42f36ba47d6973fbf8ef9974073e06e847180be8
Author: Laurent Pinchart <laurent.pinchart+renesas@ideasonboard.com>
Date:   Thu Feb 6 15:47:39 2014 +0900

    serial: sh-sci: Restrict non-COMPILE_TEST compilation
    
    Hardware supported by the driver is only found on SUPERH or
    ARCH_SHMOBILE platforms. Restrict non-COMPILE_TEST compilation to them.
    
    Cc: linux-serial@vger.kernel.org
    Signed-off-by: Laurent Pinchart <laurent.pinchart+renesas@ideasonboard.com>
    Signed-off-by: Simon Horman <horms+renesas@verge.net.au>
    Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>

commit e252652fb2664d42de19f933aa3688bbc470de3f
Author: Lv Zheng <lv.zheng@intel.com>
Date:   Tue Feb 11 10:51:43 2014 +0800

    ACPICA: acpidump: Remove integer types translation protection.
    
    Remove translation protection for applications as Linux tools folder will
    start to use such types.
    
    In Linux kernel source tree, after removing this translation protection,
    the u8/u16/u32/u64/s32/s64 typedefs are exposed for both __KERNEL__ builds
    and !__KERNEL__ builds (tools/power/acpi) and the original definitions of
    ACPI_UINT8/16/32/64_MAX are changed.
    
    For !__KERNEL__ builds, this kind of defintions should already been tested
    by the distribution vendors that are distributing binary ACPICA package and
    we've achieved the successful built/run test result in the kernel source
    tree.
    
    For __KERNEL__ builds, there are 2 things affected:
    1. u8/u16/u32/u64/s32/s64 type definitions:
       Since Linux has already type defined u8/u16/u32/u64/s32/s64 in
       include/uapi/asm-generic/int-ll64.h for __KERNEL__.  In order not to
       introduce build regressions where the 2 typedefs are differed,
       ACPI_USE_SYSTEM_INTTYPES is introduced to mask out ACPICA's typedefs.
       It must be defined for Linux __KERNEL__ builds.
    2. ACPI_UINT8/16/32/64_MAX definitions:
       Before applying this change:
         ACPI_UINT8_MAX: sizeof (UINT8)
          UINT8: unsigned char
         ACPI_UINT16_MAX: sizeof (UINT16)
          UINT16: unsigned short
         ACPI_UINT32_MAX: sizeof (UINT32)
          INT32: int
          UINT32: unsigned int
         ACPI_UINT64_MAX: sizeof (UINT64)
          INT64: COMPILER_DEPENDENT_INT64
           COMPILER_DEPENDENT_INT64: signed long (IA64) or
                                     signed long long (IA32)
          UINT64: COMPILER_DEPENDENT_UINT64
           COMPILER_DEPENDENT_UINT64: unsigned long (IA64) or
                                      unsigned long long (IA32)
       After applying this change:
         ACPI_UINT8_MAX: sizeof (u8)
          u8: unsigned char
          UINT8: (removed from actypes.h)
         ACPI_UINT16_MAX: sizeof (u16)
          u16: unsigned short
          UINT16: (removed from actypes.h)
         ACPI_UINT32_MAX: sizeof (u32)
          INT32/UINT32: (removed from actypes.h)
          s32: signed int
          u32: unsigned int
         ACPI_UINT64_MAX: sizeof (u64)
          INT64/UINT64: (removed from actypes.h)
          u64: unsigned long long
          s64: signed long long
          COMPILER_DEPENDENT_INT64: signed long (IA64) (not used any more)
                                    signed long long (IA32) (not used any more)
          COMPILER_DEPENDENT_UINT64: unsigned long (IA64) (not used any more)
                                     unsigned long long (IA32) (not used any more)
       All definitions are equal except ACPI_UINT64_MAX for CONFIG_IA64.  It
       is changed from sizeof(unsigned long) to sizeof(unsigned long long).
       By investigation, 64bit Linux kernel build is LP64 compliant, i.e.,
       sizeof(long) and (pointer) are 64.  As sizeof(unsigned long) equals to
       sizeof(unsigned long long) on IA64 platform where CONFIG_64BIT cannot be
       disabled, this change actually will not affect the value of
       ACPI_UINT64_MAX on IA64 platforms.
    
    This patch is necessary for the ACPICA's acpidump tool to build
    correctly.  Lv Zheng.
    
    Signed-off-by: Lv Zheng <lv.zheng@intel.com>
    Signed-off-by: Rafael J. Wysocki <rafael.j.wysocki@intel.com>

commit 01ca59f1bb1e71f1f40d0cfbec6b467df144924d
Author: Thomas Petazzoni <thomas.petazzoni@free-electrons.com>
Date:   Fri Feb 7 12:29:19 2014 +0100

    gpio: mvebu: use chained_irq_{enter,exit} for GIC compatibility
    
    On currently supported SoCs, the GPIO block used on Marvell EBU SoCs
    is always connected to the Marvell MPIC. However, we are going to
    introduce the support for newer Marvell EBU SoCs that use the
    Cortex-A9 core, and therefore use the GIC as their main interrupt
    controller, to which the GPIO block controlled by the gpio-mvebu
    driver is connected.
    
    The GIC interrupt controller driver uses the fasteoi flow handler. In
    order to ensure that the eoi hook of the GIC driver gets called, the
    GPIO driver should call chained_irq_enter() and chained_irq_exit() in
    its handler. Without this, the first GPIO interrupt locks up the
    system because it doesn't get acked at the GIC level.
    
    This change is similar to for example commit
    0d978eb7349941139241a99acf05de6dd49b78d1 ("gpio: davinci: use
    chained_irq_enter/chained_irq_exit API").
    
    Signed-off-by: Thomas Petazzoni <thomas.petazzoni@free-electrons.com>
    Acked-by: Jason Cooper <jason@lakedaemon.net>
    Signed-off-by: Linus Walleij <linus.walleij@linaro.org>

commit 45f7fdc2ffb9d5af4dab593843e89da70d1259e3
Merge: bbb195551487 cd15b048445d
Author: Linus Torvalds <torvalds@linux-foundation.org>
Date:   Tue Feb 11 22:28:47 2014 -0800

    Merge branch 'merge' of git://git.kernel.org/pub/scm/linux/kernel/git/benh/powerpc
    
    Pull powerpc updates from Ben Herrenschmidt:
     "Here is some powerpc goodness for -rc2.  Arguably -rc1 material more
      than -rc2 but I was travelling (again !)
    
      It's mostly bug fixes including regressions, but there are a couple of
      new things that I decided to drop-in.
    
      One is a straightforward patch from Michael to add a bunch of P8 cache
      events to perf.
    
      The other one is a patch by myself to add the direct DMA (iommu
      bypass) for PCIe on Power8 for 64-bit capable devices.  This has been
      around for a while, I had lost track of it.  However it's been in our
      internal kernels we use for testing P8 already and it affects only P8
      related code.  Since P8 is still unreleased the risk is pretty much
      nil at this point"
    
    * 'merge' of git://git.kernel.org/pub/scm/linux/kernel/git/benh/powerpc:
      powerpc/powernv: Add iommu DMA bypass support for IODA2
      powerpc: Fix endian issues in kexec and crash dump code
      powerpc/ppc32: Fix the bug in the init of non-base exception stack for UP
      powerpc/xmon: Don't signal we've entered until we're finished printing
      powerpc/xmon: Fix timeout loop in get_output_lock()
      powerpc/xmon: Don't loop forever in get_output_lock()
      powerpc/perf: Configure BHRB filter before enabling PMU interrupts
      crypto/nx/nx-842: Fix handling of vmalloc addresses
      powerpc/pseries: Select ARCH_RANDOM on pseries
      powerpc/perf: Add Power8 cache & TLB events
      powerpc/relocate fix relocate processing in LE mode
      powerpc: Fix kdump hang issue on p8 with relocation on exception enabled.
      powerpc/pseries: Disable relocation on exception while going down during crash.
      powerpc/eeh: Drop taken reference to driver on eeh_rmv_device
      powerpc: Fix build failure in sysdev/mpic.c for MPIC_WEIRD=y

commit 0215b4aa069b989c963d594cf0f1c705e21d8ca5
Author: Paul Gortmaker <paul.gortmaker@windriver.com>
Date:   Fri Feb 7 14:50:58 2014 -0500

    powerpc: Fix build failure in sysdev/mpic.c for MPIC_WEIRD=y
    
    Commit 446f6d06fab0b49c61887ecbe8286d6aaa796637 ("powerpc/mpic: Properly
    set default triggers") breaks the mpc7447_hpc_defconfig as follows:
    
      CC      arch/powerpc/sysdev/mpic.o
    arch/powerpc/sysdev/mpic.c: In function 'mpic_set_irq_type':
    arch/powerpc/sysdev/mpic.c:886:9: error: case label does not reduce to an integer constant
    arch/powerpc/sysdev/mpic.c:890:9: error: case label does not reduce to an integer constant
    arch/powerpc/sysdev/mpic.c:894:9: error: case label does not reduce to an integer constant
    arch/powerpc/sysdev/mpic.c:898:9: error: case label does not reduce to an integer constant
    
    Looking at the cpp output (gcc 4.7.3), I see:
    
       case mpic->hw_set[MPIC_IDX_VECPRI_SENSE_EDGE] |
            mpic->hw_set[MPIC_IDX_VECPRI_POLARITY_POSITIVE]:
    
    The pointer into an array appears because CONFIG_MPIC_WEIRD=y is set
    for this platform, thus enabling the following:
    
      -------------------
      #ifdef CONFIG_MPIC_WEIRD
      static u32 mpic_infos[][MPIC_IDX_END] = {
            [0] = { /* Original OpenPIC compatible MPIC */
    
      [...]
    
      #define MPIC_INFO(name) mpic->hw_set[MPIC_IDX_##name]
    
      #else /* CONFIG_MPIC_WEIRD */
    
      #define MPIC_INFO(name) MPIC_##name
    
      #endif /* CONFIG_MPIC_WEIRD */
      -------------------
    
    Here we convert the case section to if/else if, and also add
    the equivalent of a default case to warn about unknown types.
    Boot tested on sbc8548, build tested on all defconfigs.
    
    Signed-off-by: Paul Gortmaker <paul.gortmaker@windriver.com>
    Signed-off-by: Benjamin Herrenschmidt <benh@kernel.crashing.org>

commit 12b13835a0a8bfabea68741e1ab4d4a4cb77d037
Author: Linus Torvalds <torvalds@linux-foundation.org>
Date:   Tue Feb 4 12:20:01 2014 -0800

    kbuild: don't enable DEBUG_INFO when building for COMPILE_TEST
    
    It really isn't very interesting to have DEBUG_INFO when doing compile
    coverage stuff (you wouldn't want to run the result anyway, that's kind
    of the whole point of COMPILE_TEST), and it currently makes the build
    take longer and use much more disk space for "all{yes,mod}config".
    
    There's somewhat active discussion about this still, and we might end up
    with some new config option for things like this (Andi points out that
    the silly X86_DECODER_SELFTEST option also slows down the normal
    coverage tests hugely), but I'm starting the ball rolling with this
    simple one-liner.
    
    DEBUG_INFO isn't that noticeable if you have tons of memory and a good
    IO subsystem, but it hurts you a lot if you don't - for very little
    upside for the common use.
    
    Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>

commit 398b60a8de46adfbd43aa4c01753acf0161ec764
Merge: 028e219eff45 6691a19966f0
Author: Linus Torvalds <torvalds@linux-foundation.org>
Date:   Mon Jan 27 08:15:51 2014 -0800

    Merge tag 'pwm/for-3.14-rc1' of git://git.kernel.org/pub/scm/linux/kernel/git/thierry.reding/linux-pwm
    
    Pull pwm changes from Thierry Reding:
     "The patches for this release cycle include various enhancements
      (device tree support, better compile coverage, ...) for existing
      drivers.  There is a new driver for Atmel SoCs.
    
      Various drivers as well as the sysfs support received minor fixes and
      cleanups"
    
    * tag 'pwm/for-3.14-rc1' of git://git.kernel.org/pub/scm/linux/kernel/git/thierry.reding/linux-pwm:
      pwm: tiecap: Remove duplicate put_sync call
      pwm: tiehrpwm: use dev_err() instead of pr_err()
      pwm: pxa: remove unnecessary space before tabs
      pwm: ep93xx: split module author names
      pwm: use seq_puts() instead of seq_printf()
      pwm: atmel-pwm: Do not unprepare clock after successful registration
      of: Add Atmel PWM controller device tree binding
      pwm: atmel-pwm: Add Atmel PWM controller driver
      backlight: pwm_bl: Remove error message upon devm_kzalloc() failure
      pwm: pca9685: depends on I2C rather than REGMAP_I2C
      pwm: renesas-tpu: Enable driver compilation with COMPILE_TEST
      pwm: jz4740: Use devm_clk_get()
      pwm: jz4740: Pass device to clk_get()
      pwm: sysfs: Convert to use ATTRIBUTE_GROUPS macro
      pwm: pxa: Add device tree support

commit 02f8b9bcfa032827a7ddd78ea5eb3a8393ec037c
Author: Sudeep Holla <sudeep.holla@arm.com>
Date:   Wed Jan 8 18:24:21 2014 +0100

    ARM: 7934/1: DT/kernel: fix arch_match_cpu_phys_id to avoid erroneous match
    
    commit e44ef891e9e68b6ce7d3fd3bac73b7d5433050ae upstream.
    
    The MPIDR contains specific bitfields(MPIDR.Aff{2..0}) which uniquely
    identify a CPU, in addition to some non-identifying information and
    reserved bits. The ARM cpu binding defines the 'reg' property to only
    contain the affinity bits, and any cpu nodes with other bits set in
    their 'reg' entry are skipped.
    
    As such it is not necessary to mask the phys_id with MPIDR_HWID_BITMASK,
    and doing so could lead to matching erroneous CPU nodes in the device
    tree. This patch removes the masking of the physical identifier.
    
    Acked-by: Mark Rutland <mark.rutland@arm.com>
    Signed-off-by: Sudeep Holla <sudeep.holla@arm.com>
    Signed-off-by: Russell King <rmk+kernel@arm.linux.org.uk>
    Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>

commit 91466574be1a3701fab4abf5ac1539b556575a81
Merge: 09da8dfa9868 c698a4492f01
Author: Linus Torvalds <torvalds@linux-foundation.org>
Date:   Fri Jan 24 17:13:49 2014 -0800

    Merge branch 'next' of git://git.kernel.org/pub/scm/linux/kernel/git/rzhang/linux
    
    Pull thermal management updates from Zhang Rui:
     "This time, the biggest change is the work of representing hardware
      thermal properties in device tree infrastructure.
    
      This work includes the introduction of a device tree bindings for
      describing the hardware thermal behavior and limits, and also a parser
      to read and interpret the data, and build thermal zones and thermal
      binding parameters.  It also contains three examples on how to use the
      new representation on sensor devices, using three different drivers to
      accomplish it.  One driver is in thermal subsystem, the TI SoC
      thermal, and the other two drivers are in hwmon subsystem.
    
      Actually, this would be the first step of the complete work because we
      still need to check other potential drivers to be converted and then
      validate the proposed API.  But the reason why I include it in this
      pull request is that, first, this change does not hurt any others
      without using this approach, second, the principle and concept of this
      change would not break after converting the remaining drivers.  BTW,
      as you can see, there are several points in this change that do not
      belong to thermal subsystem.  Because it has been suggested by Guenter
      R that in such cases, it is recommended to send the complete series
      via one single subsystem.
    
      Specifics:
    
       - representing hardware thermal properties in device tree
         infrastructure
    
       - fix a regression that the imx thermal driver breaks system suspend.
    
       - introduce ACPI INT3403 thermal driver to retrieve temperature data
         from the INT3403 ACPI device object present on some systems.
    
       - introduce debug statement for thermal core and step_wise governor.
    
       - assorted fixes and cleanups for thermal core, cpu cooling, exynos
         thrmal, intel powerclamp and imx thermal driver"
    
    * 'next' of git://git.kernel.org/pub/scm/linux/kernel/git/rzhang/linux: (34 commits)
      thermal: remove const flag from .ops of imx thermal
      Thermal: update thermal zone device after setting emul_temp
      intel_powerclamp: Fix cstate counter detection.
      thermal: imx: add necessary clk operation
      Thermal cpu cooling: return error if no valid cpu frequency entry
      thermal: fix cpu_cooling max_level behavior
      thermal: rcar-thermal: Enable driver compilation with COMPILE_TEST
      thermal: debug: add debug statement for core and step_wise
      thermal: imx_thermal: add module device table
      drivers: thermal: Mark function as static in x86_pkg_temp_thermal.c
      thermal:samsung: fix compilation warning
      thermal: imx: correct suspend/resume flow
      thermal: exynos: fix error return code
      Thermal: ACPI INT3403 thermal driver
      MAINTAINERS: add thermal bindings entry in thermal domain
      arm: dts: make OMAP4460 bandgap node to belong to OCP
      arm: dts: make OMAP443x bandgap node to belong to OCP
      arm: dts: add cooling properties on omap5 cpu node
      arm: dts: add omap5 thermal data
      arm: dts: add omap5 CORE thermal data
      ...

commit 8e5096607280d4e103389bfe8f8b7decbf538ff6
Merge: 02d0a752460e de755c330512
Author: Linus Torvalds <torvalds@linux-foundation.org>
Date:   Tue Jan 21 09:40:46 2014 -0800

    Merge tag 'gpio-v3.14-1' of git://git.kernel.org/pub/scm/linux/kernel/git/linusw/linux-gpio
    
    Pull GPIO tree bulk changes from Linus Walleij:
     "A big set this merge window, as we have much going on in this
      subsystem.  The changes to other subsystems (notably a slew of ARM
      machines as I am doing away with their custom APIs) have all been
      ACKed to the extent possible.
    
      Major changes this time:
    
       - Some core improvements and cleanups to the new GPIO descriptor API.
         This seems to be working now so we can start the exodus to this
         API, moving gradually away from the global GPIO numberspace.
    
       - Incremental improvements to the ACPI GPIO core, and move the few
         GPIO ACPI clients we have to the GPIO descriptor API right *now*
         before we go any further.  We actually managed to contain this
         *before* we started to litter the kernel with yet another hackish
         global numberspace for the ACPI GPIOs, which is a big win.
    
       - The RFkill GPIO driver and all platforms using it have been
         migrated to use the GPIO descriptors rather than fixed number
         assignments.  Tegra machine has been migrated as part of this.
    
       - New drivers for MOXA ART, Xtensa GPIO32 and SMSC SCH311x.  Those
         should be really good examples of how I expect a nice GPIO driver
         to look these days.
    
       - Do away with custom GPIO implementations on a major part of the ARM
         machines: ks8695, lpc32xx, mv78xx0.  Make a first step towards the
         same in the horribly convoluted Samsung S3C include forest.  We
         expect to continue to clean this up as we move forward.
    
       - Flag GPIO lines used for IRQ on adnp, bcm-kona, em, intel-mid and
         lynxpoint.
    
         This makes the GPIOlib core aware that a certain GPIO line is used
         for IRQs and can then enforce some semantics such as disallowing a
         GPIO line marked as in use for IRQ to be switched to output mode.
    
       - Drop all use of irq_set_chip_and_handler_name().  The name provided
         in these cases were just unhelpful tags like "mux" or "demux".
    
       - Extend the MCP23s08 driver to handle interrupts.
    
       - Minor incremental improvements for rcar, lynxpoint, em 74x164 and
         msm drivers.
    
       - Some non-urgent bug fixes here and there, duplicate #includes and
         that usual kind of cleanups"
    
    Fix up broken Kconfig file manually to make this all compile.
    
    * tag 'gpio-v3.14-1' of git://git.kernel.org/pub/scm/linux/kernel/git/linusw/linux-gpio: (71 commits)
      gpio: mcp23s08: fix casting caused build warning
      gpio: mcp23s08: depend on OF_GPIO
      gpio: mcp23s08: Add irq functionality for i2c chips
      ARM: S5P[v210|c100|64x0]: Fix build error
      gpio: pxa: clamp gpio get value to [0,1]
      ARM: s3c24xx: explicit dependency on <plat/gpio-cfg.h>
      ARM: S3C[24|64]xx: move includes back under <mach/> scope
      Documentation / ACPI: update to GPIO descriptor API
      gpio / ACPI: get rid of acpi_gpio.h
      gpio / ACPI: register to ACPI events automatically
      mmc: sdhci-acpi: convert to use GPIO descriptor API
      ARM: s3c24xx: fix build error
      gpio: f7188x: set can_sleep attribute
      gpio: samsung: Update documentation
      gpio: samsung: Remove hardware.h inclusion
      gpio: xtensa: depend on HAVE_XTENSA_GPIO32
      gpio: clps711x: Enable driver compilation with COMPILE_TEST
      gpio: clps711x: Use of_match_ptr()
      net: rfkill: gpio: convert to descriptor-based GPIO interface
      leds: s3c24xx: Fix build failure
      ...

commit bcee63488ece9a0fca8be19951428a7b41001e66
Merge: de4fe30af162 8bc661bfc0c2
Author: Linus Torvalds <torvalds@linux-foundation.org>
Date:   Mon Jan 20 16:05:23 2014 -0800

    Merge tag 'tty-3.14-rc1' of git://git.kernel.org/pub/scm/linux/kernel/git/gregkh/tty
    
    Pull tty/serial driver updates from Greg KH:
     "Here's the big tty/serial driver pull request for 3.14-rc1
    
      There are a number of n_tty fixes and cleanups, and some serial driver
      bugfixes, and we got rid of one obsolete driver, making this series
      remove more lines than added, always a nice surprise.
    
      All of these have been in linux-next with no reports of issues"
    
    * tag 'tty-3.14-rc1' of git://git.kernel.org/pub/scm/linux/kernel/git/gregkh/tty: (60 commits)
      tty/serial: at91: disable uart timer at start of shutdown
      serial: 8250: enable UART_BUG_NOMSR for Tegra
      tty/serial: at91: reset rx_ring when port is shutdown
      tty/serial: at91: fix race condition in atmel_serial_remove
      tty/serial: at91: Handle shutdown more safely
      serial: sirf: correct condition for fetching dma buffer into tty
      serial: sirf: provide pm entries of uart_ops
      serial: sirf: use PM macro initialize PM functions
      serial: clps711x: Enable driver compilation with COMPILE_TEST
      serial: clps711x: Add support for N_IRDA line discipline
      tty: synclink: avoid sleep_on race
      tty/amiserial: avoid interruptible_sleep_on
      tty: delete non-required instances of include <linux/init.h>
      tty: an overflow of multiplication in drivers/tty/cyclades.c
      serial: Remove old SC26XX driver
      serial: add support for 200 v3 series Titan card
      serial: 8250: Fix initialisation of Quatech cards with the AMCC PCI chip
      tty: Removing the deprecated function tty_vhangup_locked()
      TTY/n_gsm: Removing the wrong tty_unlock/lock() in gsm_dlci_release()
      tty/serial: at91: document clock properties
      ...

commit 9326657abe1a83ed4b4f396b923ca1217fd50cba
Merge: 2cc3f16cad15 45e6af06367e
Author: Linus Torvalds <torvalds@linux-foundation.org>
Date:   Mon Jan 20 10:28:30 2014 -0800

    Merge branch 'perf-core-for-linus' of git://git.kernel.org/pub/scm/linux/kernel/git/tip/tip
    
    Pull perf updates from Ingo Molnar:
     "Kernel side changes:
    
       - Add Intel RAPL energy counter support (Stephane Eranian)
       - Clean up uprobes (Oleg Nesterov)
       - Optimize ring-buffer writes (Peter Zijlstra)
    
      Tooling side changes, user visible:
    
       - 'perf diff':
         - Add column colouring improvements (Ramkumar Ramachandra)
    
      - 'perf kvm':
         - Add guest related improvements, including allowing to specify a
           directory with guest specific /proc information (Dongsheng Yang)
         - Add shell completion support (Ramkumar Ramachandra)
         - Add '-v' option (Dongsheng Yang)
         - Support --guestmount (Dongsheng Yang)
    
       - 'perf probe':
         - Support showing source code, asking for variables to be collected
           at probe time and other 'perf probe' operations that use DWARF
           information.
    
           This supports only binaries with debugging information at this
           time, detached debuginfo (aka debuginfo packages) support should
           come in later patches (Masami Hiramatsu)
    
       - 'perf record':
         - Rename --no-delay option to --no-buffering, better reflecting its
           purpose and freeing up '--delay' to take the place of
           '--initial-delay', so that 'record' and 'stat' are consistent
           (Arnaldo Carvalho de Melo)
         - Default the -t/--thread option to no inheritance (Adrian Hunter)
         - Make per-cpu mmaps the default (Adrian Hunter)
    
       - 'perf report':
         - Improve callchain processing performance (Frederic Weisbecker)
         - Retain bfd reference to lookup source line numbers, greatly
           optimizing, among other use cases, 'perf report -s srcline'
           (Adrian Hunter)
         - Improve callchain processing performance even more (Namhyung Kim)
         - Add a perf.data file header window in the 'perf report' TUI,
           associated with the 'i' hotkey, providing a counterpart to the
           --header option in the stdio UI (Namhyung Kim)
    
       - 'perf script':
         - Add an option in 'perf script' to print the source line number
           (Adrian Hunter)
         - Add --header/--header-only options to 'script' and 'report', the
           default is not tho show the header info, but as this has been the
           default for some time, leave a single line explaining how to
           obtain that information (Jiri Olsa)
         - Add options to show comm, fork, exit and mmap PERF_RECORD_ events
           (Namhyung Kim)
         - Print callchains and symbols if they exist (David Ahern)
    
       - 'perf timechart'
         - Add backtrace support to CPU info
         - Print pid along the name
         - Add support for CPU topology
         - Add new option --highlight'ing threads, be it by name or, if a
           numeric value is provided, that run more than given duration
           (Stanislav Fomichev)
    
       - 'perf top':
         - Make 'perf top -g' refer to callchains, for consistency with
           other tools (David Ahern)
    
       - 'perf trace':
         - Handle old kernels where the "raw_syscalls" tracepoints were
           called plain "syscalls" (David Ahern)
         - Remove thread summary coloring, by Pekka Enberg.
         - Honour -m option in 'trace', the tool was offering the option to
           set the mmap size, but wasn't using it when doing the actual mmap
           on the events file descriptors (Jiri Olsa)
    
       - generic:
         - Backport libtraceevent plugin support (trace-cmd repository, with
           plugins for jbd2, hrtimer, kmem, kvm, mac80211, sched_switch,
           function, xen, scsi, cfg80211 (Jiri Olsa)
         - Print session information only if --stdio is given (Namhyung Kim)
    
      Tooling side changes, developer visible (plumbing):
    
       - Improve 'perf probe' exit path, release resources (Masami
         Hiramatsu)
       - Improve libtraceevent plugins exit path, allowing the registering
         of an unregister handler to be called at exit time (Namhyung Kim)
       - Add an alias to the build test makefile (make -C tools/perf
         build-test) (Namhyung Kim)
       - Get rid of die() and friends (good riddance!) in libtraceevent
         (Namhyung Kim)
       - Fix cross build problems related to pkgconfig and CROSS_COMPILE not
         being propagated to the feature tests, leading to features being
         tested in the host and then being enabled on the target (Mark
         Rutland)
       - Improve forked workload error reporting by sending the errno in the
         signal data queueing integer field, using sigqueue and by doing the
         signal setup in the evlist methods, removing open coded equivalents
         in various tools (Arnaldo Carvalho de Melo)
       - Do more auto exit cleanup chores in the 'evlist' destructor, so
         that the tools don't have to all do that sequence (Arnaldo Carvalho
         de Melo)
       - Pack 'struct perf_session_env' and 'struct trace' (Arnaldo Carvalho
         de Melo)
       - Add test for building detached source tarballs (Arnaldo Carvalho de
         Melo)
       - Move some header files (tools/perf/ to tools/include/ to make them
         available to other tools/ dwelling codebases (Namhyung Kim)
       - Move logic to warn about kptr_restrict'ed kernels to separate
         function in 'report' (Arnaldo Carvalho de Melo)
       - Move hist browser selection code to separate function (Arnaldo
         Carvalho de Melo)
       - Move histogram entries collapsing to separate function (Arnaldo
         Carvalho de Melo)
       - Introduce evlist__for_each() & friends (Arnaldo Carvalho de Melo)
       - Automate setup of FEATURE_CHECK_(C|LD)FLAGS-all variables (Jiri
         Olsa)
       - Move arch setup into seprate Makefile (Jiri Olsa)
       - Make libtraceevent install target quieter (Jiri Olsa)
       - Make tests/make output more compact (Jiri Olsa)
       - Ignore generated files in feature-checks (Chunwei Chen)
       - Introduce pevent_filter_strerror() in libtraceevent, similar in
         purpose to libc's strerror() function (Namhyung Kim)
       - Use perf_data_file methods to write output file in 'record' and
         'inject' (Jiri Olsa)
       - Use pr_*() functions where applicable in 'report' (Namhyumg Kim)
       - Add 'machine' 'addr_location' struct to have full picture (machine,
         thread, map, symbol, addr) for a (partially) resolved address,
         reducing function signatures (Arnaldo Carvalho de Melo)
       - Reduce code duplication in the histogram entry creation/insertion
         (Arnaldo Carvalho de Melo)
       - Auto allocate annotation histogram data structures (Arnaldo
         Carvalho de Melo)
       - No need to test against NULL before calling free, also set freed
         memory in struct pointers to NULL, to help fixing use after free
         bugs (Arnaldo Carvalho de Melo)
       - Rename some struct DSO binary_type related members and methods, to
         clarify its purpose and need for differentiation (symtab_type, ie
         one is about the files .text, CFI, etc, i.e.  its binary contents,
         and the other is about where the symbol table came from (Arnaldo
         Carvalho de Melo)
       - Convert to new topic libraries, starting with an API one (sysfs,
         debugfs, etc), renaming liblk in the process (Borislav Petkov)
       - Get rid of some more panic() like error handling in libtraceevent.
         (Namhyung Kim)
       - Get rid of panic() like calls in libtraceevent (Namyung Kim)
       - Start carving out symbol parsing routines (perf, just moving
         routines to topic files in tools/lib/symbol/, tools that want to
         use it need to integrate it directly, ie no
         tools/lib/symbol/Makefile is provided (Arnaldo Carvalho de Melo)
       - Assorted refactoring patches, moving code around and adding utility
         evlist methods that will be used in the IPT patchset (Adrian
         Hunter)
       - Assorted mmap_pages handling fixes (Adrian Hunter)
       - Several man pages typo fixes (Dongsheng Yang)
       - Get rid of several die() calls in libtraceevent (Namhyung Kim)
       - Use basename() in a more robust way, to avoid problems related to
         different system library implementations for that function
         (Stephane Eranian)
       - Remove open coded management of short_name_allocated member (Adrian
         Hunter)
       - Several cleanups in the "dso" methods, constifying some parameters
         and renaming some fields to clarify its purpose (Arnaldo Carvalho
         de Melo)
       - Add per-feature check flags, fixing libunwind related build
         problems on some architectures (Jean Pihet)
       - Do not disable source line lookup just because of one failure.
         (Adrian Hunter)
       - Several 'perf kvm' man page corrections (Dongsheng Yang)
       - Correct the message in feature-libnuma checking, swowing the right
         devel package names for various distros (Dongsheng Yang)
       - Polish 'readn()' function and introduce its counterpart,
         'writen()' (Jiri Olsa)
       - Start moving timechart state from global variables to a 'perf_tool'
         derived 'timechart' struct (Arnaldo Carvalho de Melo)
    
      ... and lots of fixes and improvements I forgot to list"
    
    * 'perf-core-for-linus' of git://git.kernel.org/pub/scm/linux/kernel/git/tip/tip: (282 commits)
      perf tools: Remove unnecessary callchain cursor state restore on unmatch
      perf callchain: Spare double comparison of callchain first entry
      perf tools: Do proper comm override error handling
      perf symbols: Export elf_section_by_name and reuse
      perf probe: Release all dynamically allocated parameters
      perf probe: Release allocated probe_trace_event if failed
      perf tools: Add 'build-test' make target
      tools lib traceevent: Unregister handler when xen plugin is unloaded
      tools lib traceevent: Unregister handler when scsi plugin is unloaded
      tools lib traceevent: Unregister handler when jbd2 plugin is is unloaded
      tools lib traceevent: Unregister handler when cfg80211 plugin is unloaded
      tools lib traceevent: Unregister handler when mac80211 plugin is unloaded
      tools lib traceevent: Unregister handler when sched_switch plugin is unloaded
      tools lib traceevent: Unregister handler when kvm plugin is unloaded
      tools lib traceevent: Unregister handler when kmem plugin is unloaded
      tools lib traceevent: Unregister handler when hrtimer plugin is unloaded
      tools lib traceevent: Unregister handler when function plugin is unloaded
      tools lib traceevent: Add pevent_unregister_print_function()
      tools lib traceevent: Add pevent_unregister_event_handler()
      tools lib traceevent: fix pointer-integer size mismatch
      ...

commit c3235bfc0cba3d05d22c37e696b0c03682a5ddc6
Author: Mark Brown <broonie@linaro.org>
Date:   Thu Dec 12 17:13:10 2013 +0000

    video: amba-clcd: Make CLCD driver available on more platforms
    
    The CLCD driver is used on ARM reference models for ARMv8 so add ARM64
    to the list of dependencies. The driver also has no build time dependencies
    on ARM (stubs are provided for ARM-specific DMA functions in the code) so
    make it available with COMPILE_TEST in order to maximise build coverage.
    
    Signed-off-by: Mark Brown <broonie@linaro.org>
    Signed-off-by: Tomi Valkeinen <tomi.valkeinen@ti.com>

commit 3e7e09dbd1080de5dcf10092830e39bc2e2932ec
Merge: 860fc2f2640e 0e9e79a13ab9
Author: Ingo Molnar <mingo@kernel.org>
Date:   Thu Jan 16 09:34:01 2014 +0100

    Merge tag 'perf-core-for-mingo' of git://git.kernel.org/pub/scm/linux/kernel/git/acme/linux into perf/core
    
    Pull perf/core updates from Arnaldo Carvalho de Melo:
    
    Changes in user visible interfaces:
    
      * Rename 'record's --no-delay option to --no-buffering, better reflecting its
        purpose and freeing up '--delay' to take the place of '--initial-delay', so that
        'record' and 'stat' are consistent.
    
    Refactorings:
    
      * Get rid of die() and friends (good riddance!) in libtraceevent (Namhyung Kim)
    
    Infrastructure enhancements:
    
      * Fix cross build problems related to pkgconfig and CROSS_COMPILE not being
        propagated to the feature tests, leading to features being tested in the
        host and then being enabled on the target. (Mark Rutland)
    
      * Fix pointer-integer size mismatch in some libtraceevent plugins (Mark Rutland)
    
      * Fix build error due to zfree() cast (Namhyung Kim)
    
    Signed-off-by: Arnaldo Carvalho de Melo <acme@redhat.com>
    Signed-off-by: Ingo Molnar <mingo@kernel.org>

commit a8a5cd8b472ca20e5b8fa649c43b3756867322f8
Author: Mark Rutland <mark.rutland@arm.com>
Date:   Wed Jan 15 10:44:08 2014 +0000

    perf: tools: Fix cross building
    
    Currently the feature-checks Makefile does not inherit $(CC), and calls
    cc rather than $(CROSS_COMPILE)gcc. Thus the feature checks invoke the
    native toolchain rather than the cross toolchain, and can identify
    features as available when they are not. This can break the build.
    
    Additionally the native pkg-config is always called as opposed to
    $(CROSS_COMPILE)pkg-config, so the wrong flags and paths may be passed
    to the cross compiler.
    
    This patch passes CROSS_COMPILE down to the feature-checks Makefile, and
    forces its use. Additionally pkg-config is replaced with
    $(CROSS_COMPILE)pkg-config via a new $(PKG_CONFIG) variable. This patch
    has been build tested on x86_64 and arm.
    
    Signed-off-by: Mark Rutland <mark.rutland@arm.com>
    Cc: Ingo Molnar <mingo@redhat.com>
    Cc: Jiri Olsa <jolsa@redhat.com>
    Cc: Will Deacon <will.deacon@arm.com>
    Link: http://lkml.kernel.org/r/1389782648-4417-4-git-send-email-mark.rutland@arm.com
    Signed-off-by: Arnaldo Carvalho de Melo <acme@redhat.com>

commit 9ccb0bd0f17435f5b53294342fdbf9108667d78a
Author: Laurent Pinchart <laurent.pinchart+renesas@ideasonboard.com>
Date:   Wed Nov 27 02:18:30 2013 +0100

    mmc: sh_mmcif: Enable driver compilation with COMPILE_TEST
    
    This helps increasing build testing coverage.
    
    Signed-off-by: Laurent Pinchart <laurent.pinchart+renesas@ideasonboard.com>
    Acked-by: Simon Horman <horms@verge.net.au>
    Signed-off-by: Chris Ball <cjb@laptop.org>

commit ff0fa48f8196775a055751a115fac45996115467
Author: Laurent Pinchart <laurent.pinchart+renesas@ideasonboard.com>
Date:   Wed Nov 27 02:18:29 2013 +0100

    mmc: sdhi: Enable driver compilation with COMPILE_TEST
    
    This helps increasing build testing coverage.
    
    The driver doesn't compile on (at least) x86 due (possibly among others)
    to missing readsw/writesw I/O accessors, restrict compilation to SUPERH
    or ARM.
    
    Whether the CTL_DMA_ENABLE register is part of the standard TMIO
    controller or is Renesas-specific is unknown and impossible to test as
    we have no current or planned TMIO DMA users other than SUPERH and
    ARCH_SHMOBILE. Writing to the register is thus conditionally compiled
    for SUPERH and ARCH_SHMOBILE only. Adding ARCH_SHMOBILE_MULTI to the
    list would extend this to multiarch kernels, but would break the driver
    for non-shmobile platforms if the register is Renesas-specific. We can
    thus get rid of the conditional compilation completely without
    introducing any further issue, and let future non-Renesas users deal
    with the situation if it turns out to be a the problem.
    
    Signed-off-by: Laurent Pinchart <laurent.pinchart+renesas@ideasonboard.com>
    Acked-by: Simon Horman <horms@verge.net.au>
    Signed-off-by: Chris Ball <cjb@laptop.org>

commit feb5cde61df96aa28193bd72813e2c930f3f5706
Merge: 0a6659bdc5e8 55459968176f
Author: Dave Airlie <airlied@redhat.com>
Date:   Mon Jan 13 13:53:56 2014 +1000

    Merge branch 'msm-next' of git://people.freedesktop.org/~robclark/linux into drm-next
    
    MSM tree from Rob.
    
    * 'msm-next' of git://people.freedesktop.org/~robclark/linux:
      drm/msm: add a330/apq8x74
      drm/msm: add mdp5/apq8x74
      drm/msm: add hdmi support for apq8x74/mdp5
      drm/msm: move irq utils to mdp_kms
      drm/msm: split out msm_kms.h
      drm/msm: mdp4_format -> mdp_format
      drm/msm: resync generated headers
      drm/msm: move mdp4 -> mdp/mdp4
      drm/msm: add support for msm8060ab/bstem
      drm/msm: add support for non-IOMMU systems
      drm/msm: fix bus scaling
      drm/msm: add missing MODULE_FIRMWARE()s
      drm/msm: COMPILE_TEST support

commit e44ef891e9e68b6ce7d3fd3bac73b7d5433050ae
Author: Sudeep Holla <sudeep.holla@arm.com>
Date:   Wed Jan 8 18:24:21 2014 +0100

    ARM: 7934/1: DT/kernel: fix arch_match_cpu_phys_id to avoid erroneous match
    
    The MPIDR contains specific bitfields(MPIDR.Aff{2..0}) which uniquely
    identify a CPU, in addition to some non-identifying information and
    reserved bits. The ARM cpu binding defines the 'reg' property to only
    contain the affinity bits, and any cpu nodes with other bits set in
    their 'reg' entry are skipped.
    
    As such it is not necessary to mask the phys_id with MPIDR_HWID_BITMASK,
    and doing so could lead to matching erroneous CPU nodes in the device
    tree. This patch removes the masking of the physical identifier.
    
    Acked-by: Mark Rutland <mark.rutland@arm.com>
    Signed-off-by: Sudeep Holla <sudeep.holla@arm.com>
    Signed-off-by: Russell King <rmk+kernel@arm.linux.org.uk>

commit f4093e2ea7f571ef22c35cde36a606c43c978e82
Author: Shengzhou Liu <Shengzhou.Liu@freescale.com>
Date:   Wed Dec 25 18:06:55 2013 +0800

    powerpc/85xx/dts: add third elo3 dma component
    
    Add elo3-dma-2.dtsi to support the third DMA controller.
    This is used on T2080, T4240, B4860, etc.
    
    FSL MPIC v4.3 adds a new discontiguous address range for internal interrupts,
    e.g. internal interrupt 0 is at offset 0x200 and thus interrupt number is:
    0x200 >> 5 = 16 in the device tree.  DMA controller 3 channel 0 internal
    interrupt 240 is at offset 0x3a00, and thus the corresponding interrupt
    number is: 0x3a00 >> 5 = 464, it's similar for other 7 interrupt numbers
    of DMA 3 channels.
    
    Signed-off-by: Shengzhou Liu <Shengzhou.Liu@freescale.com>
    Signed-off-by: Hongbo Zhang <hongbo.zhang@freescale.com>
    Signed-off-by: Scott Wood <scottwood@freescale.com>

commit be2019816e4dcdb02493da332b65a8b68b70106c
Author: Stephen Chivers <schivers@mandarin.aust.csc.com>
Date:   Thu Jan 9 13:01:22 2014 +1100

    powerpc/embedded6xx: Add support for Motorola/Emerson MVME5100
    
    Add support for the Motorola/Emerson MVME5100 Single Board Computer.
    
    The MVME5100 is a 6U form factor VME64 computer with:
    
            - A single MPC7410 or MPC750 CPU
            - A HAWK Processor Host Bridge (CPU to PCI) and
              MultiProcessor Interrupt Controller (MPIC)
            - Up to 500Mb of onboard memory
            - A M48T37 Real Time Clock (RTC) and Non-Volatile Memory chip
            - Two 16550 compatible UARTS
            - Two Intel E100 Fast Ethernets
            - Two PCI Mezzanine Card (PMC) Slots
            - PPCBug Firmware
    
    The HAWK PHB/MPIC is compatible with the MPC10x devices.
    
    There is no onboard disk support. This is usually provided by installing a PMC
    in first PMC slot.
    
    This patch revives the board support, it was present in early 2.6
    series kernels. The board support in those days was by Matt Porter of
    MontaVista Software.
    
    CSC Australia has around 31 of these boards in service. The kernel in use
    for the boards is based on 2.6.31. The boards are operated without disks
    from a file server.
    
    This patch is based on linux-3.13-rc2 and has been boot tested.
    
    Only boards with 512 Mb of memory are known to work.
    
    Signed-off-by: Stephen Chivers <schivers@csc.com>
    Tested-by: Alessio Igor Bogani <alessio.bogani@elettra.eu>
    Signed-off-by: Scott Wood <scottwood@freescale.com>

commit 3083894f7f2963bb017c79636cd064eb0d7f05da
Author: Rob Clark <robdclark@gmail.com>
Date:   Wed Nov 27 16:29:59 2013 -0500

    drm/msm: COMPILE_TEST support
    
    With a simple stub, we can get COMPILE_TEST support.
    
    Signed-off-by: Rob Clark <robdclark@gmail.com>

commit 458ff3c099a1266991208f2c009afc2405e5b6bc
Author: Gleb Natapov <gleb@redhat.com>
Date:   Sun Sep 1 15:53:46 2013 +0300

    KVM: PPC: fix couple of memory leaks in MPIC/XICS devices
    
    XICS failed to free xics structure on error path. MPIC destroy handler
    forgot to delete kvm_device structure.
    
    Signed-off-by: Gleb Natapov <gleb@redhat.com>
    Acked-by: Paul Mackerras <paulus@samba.org>
    Signed-off-by: Alexander Graf <agraf@suse.de>

commit 093a9e2a20ebc414f8ca0d31709dab1040fa2886
Author: Alexander Shiyan <shc_work@mail.ru>
Date:   Tue Dec 31 20:49:42 2013 +0400

    serial: clps711x: Enable driver compilation with COMPILE_TEST
    
    This helps increasing build testing coverage.
    To do this, read{write}_relaxed() functions was be replaced with
    simple read{write}() variants. Potential "uninitialized variable"
    warnings was be fixed if driver compiled without MFD_SYSCON.
    
    Signed-off-by: Alexander Shiyan <shc_work@mail.ru>
    Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>

commit ffd4bf1a9e8a88c4b2a47007b1a9e69be28599fe
Author: Alexander Shiyan <shc_work@mail.ru>
Date:   Tue Dec 24 18:08:54 2013 +0400

    gpio: clps711x: Enable driver compilation with COMPILE_TEST
    
    This helps increasing build testing coverage.
    
    Signed-off-by: Alexander Shiyan <shc_work@mail.ru>
    Signed-off-by: Linus Walleij <linus.walleij@linaro.org>

commit 78a2e12f51d9ec37c328fa5a429c676eeeba8cd1
Author: Laurent Pinchart <laurent.pinchart+renesas@ideasonboard.com>
Date:   Wed Nov 27 02:18:26 2013 +0100

    iommu: shmobile: Enable driver compilation with COMPILE_TEST
    
    This helps increasing build testing coverage.
    
    The driver doesn't compile on non-ARM platforms due to usage of the ARM
    DMA IOMMU API, restrict compilation to ARM.
    
    Cc: Joerg Roedel <joro@8bytes.org>
    Cc: iommu@lists.linux-foundation.org
    Signed-off-by: Laurent Pinchart <laurent.pinchart+renesas@ideasonboard.com>
    Acked-by: Simon Horman <horms+renesas@verge.net.au>
    Signed-off-by: Joerg Roedel <joro@8bytes.org>

commit 6bcda8a71080b8fa35e07a3339b2d79ebcfa4c33
Author: Laurent Pinchart <laurent.pinchart+renesas@ideasonboard.com>
Date:   Wed Nov 27 02:18:31 2013 +0100

    mtd: sh_flctl: enable driver compilation with COMPILE_TEST
    
    This helps increasing build testing coverage.
    
    Cc: David Woodhouse <dwmw2@infradead.org>
    Cc: linux-mtd@lists.infradead.org
    Signed-off-by: Laurent Pinchart <laurent.pinchart+renesas@ideasonboard.com>
    Acked-by: Simon Horman <horms@verge.net.au>
    Signed-off-by: Brian Norris <computersforpeace@gmail.com>

commit 46a4e737bc7ea3b07b0bc6f8315ab610a16c7eab
Author: Laurent Pinchart <laurent.pinchart+renesas@ideasonboard.com>
Date:   Wed Nov 27 02:18:23 2013 +0100

    i2c: shmobile/rcar: Restrict non-COMPILE_TEST compilation
    
    Hardware supported by the i2c sh_mobile and rcar drivers is only found
    on SUPERH or ARCH_SHMOBILE platforms. Restrict non-COMPILE_TEST
    compilation to them.
    
    Signed-off-by: Laurent Pinchart <laurent.pinchart+renesas@ideasonboard.com>
    Acked-by: Simon Horman <horms+renesas@verge.net.au>
    Signed-off-by: Wolfram Sang <wsa@the-dreams.de>

commit beeb5a1e0ef774d0a3e18c5a0e78c39e3e1a5389
Author: Laurent Pinchart <laurent.pinchart+renesas@ideasonboard.com>
Date:   Wed Nov 27 02:18:34 2013 +0100

    thermal: rcar-thermal: Enable driver compilation with COMPILE_TEST
    
    This helps increasing build testing coverage.
    
    Cc: Zhang Rui <rui.zhang@intel.com>
    Cc: Eduardo Valentin <eduardo.valentin@ti.com>
    Cc: linux-pm@vger.kernel.org
    Signed-off-by: Laurent Pinchart <laurent.pinchart+renesas@ideasonboard.com>
    Acked-by: Simon Horman <horms@verge.net.au>
    Acked-by: Eduardo Valentin <eduardo.valentin@ti.com>
    Signed-off-by: Zhang Rui <rui.zhang@intel.com>

commit 0a5be743e8c3c3230600fbc0cf923fb5dbefd579
Merge: 6ac2104debc2 1307220d7bb7
Author: Catalin Marinas <catalin.marinas@arm.com>
Date:   Thu Dec 19 17:57:51 2013 +0000

    Merge tag 'arm64-suspend' of git://linux-arm.org/linux-2.6-lp into upstream
    
    * tag 'arm64-suspend' of git://linux-arm.org/linux-2.6-lp:
      arm64: add CPU power management menu/entries
      arm64: kernel: add PM build infrastructure
      arm64: kernel: add CPU idle call
      arm64: enable generic clockevent broadcast
      arm64: kernel: implement HW breakpoints CPU PM notifier
      arm64: kernel: refactor code to install/uninstall breakpoints
      arm: kvm: implement CPU PM notifier
      arm64: kernel: implement fpsimd CPU PM notifier
      arm64: kernel: cpu_{suspend/resume} implementation
      arm64: kernel: suspend/resume registers save/restore
      arm64: kernel: build MPIDR_EL1 hash function data structure
      arm64: kernel: add MPIDR_EL1 accessors macros
    
    Conflicts:
            arch/arm64/Kconfig

commit 158b50aefa14ba18ee94b691f83a7e5d30539433
Author: Thierry Reding <treding@nvidia.com>
Date:   Wed Nov 20 20:39:35 2013 +0100

    drm/tegra: Increase compile test coverage
    
    The ARCH_MULTIPLATFORM dependency was introduced back when Tegra didn't
    support multiplatform yet as a means to allow the driver to be easily
    compile-tested along with other DRM drivers. In the meantime, the new
    COMPILE_TEST Kconfig option has been introduced for exactly that
    purpose, so use that instead to clarify the intention.
    
    Signed-off-by: Thierry Reding <treding@nvidia.com>

commit 6f44c2b5280f469f39997c3092a6dd51f9efad6f
Author: Thierry Reding <treding@nvidia.com>
Date:   Wed Nov 20 20:58:36 2013 +0100

    gpu: host1x: Increase compile test coverage
    
    The ARCH_MULTIPLATFORM dependency was introduced back when Tegra didn't
    support multiplatform yet as a means to allow the driver to be easily
    compile-tested along with other DRM drivers. In the meantime, the new
    COMPILE_TEST Kconfig option has been introduced for exactly that
    purpose, so use that instead to clarify the intention.
    
    Signed-off-by: Thierry Reding <treding@nvidia.com>

commit 976d7d3f79a997b223f2ed8eabef7e12e469b5cf
Author: Lorenzo Pieralisi <lorenzo.pieralisi@arm.com>
Date:   Thu May 16 10:32:09 2013 +0100

    arm64: kernel: build MPIDR_EL1 hash function data structure
    
    On ARM64 SMP systems, cores are identified by their MPIDR_EL1 register.
    The MPIDR_EL1 guidelines in the ARM ARM do not provide strict enforcement of
    MPIDR_EL1 layout, only recommendations that, if followed, split the MPIDR_EL1
    on ARM 64 bit platforms in four affinity levels. In multi-cluster
    systems like big.LITTLE, if the affinity guidelines are followed, the
    MPIDR_EL1 can not be considered a linear index. This means that the
    association between logical CPU in the kernel and the HW CPU identifier
    becomes somewhat more complicated requiring methods like hashing to
    associate a given MPIDR_EL1 to a CPU logical index, in order for the look-up
    to be carried out in an efficient and scalable way.
    
    This patch provides a function in the kernel that starting from the
    cpu_logical_map, implement collision-free hashing of MPIDR_EL1 values by
    checking all significative bits of MPIDR_EL1 affinity level bitfields.
    The hashing can then be carried out through bits shifting and ORing; the
    resulting hash algorithm is a collision-free though not minimal hash that can
    be executed with few assembly instructions. The mpidr_el1 is filtered through a
    mpidr mask that is built by checking all bits that toggle in the set of
    MPIDR_EL1s corresponding to possible CPUs. Bits that do not toggle do not
    carry information so they do not contribute to the resulting hash.
    
    Pseudo code:
    
    /* check all bits that toggle, so they are required */
    for (i = 1, mpidr_el1_mask = 0; i < num_possible_cpus(); i++)
            mpidr_el1_mask |= (cpu_logical_map(i) ^ cpu_logical_map(0));
    
    /*
     * Build shifts to be applied to aff0, aff1, aff2, aff3 values to hash the
     * mpidr_el1
     * fls() returns the last bit set in a word, 0 if none
     * ffs() returns the first bit set in a word, 0 if none
     */
    fs0 = mpidr_el1_mask[7:0] ? ffs(mpidr_el1_mask[7:0]) - 1 : 0;
    fs1 = mpidr_el1_mask[15:8] ? ffs(mpidr_el1_mask[15:8]) - 1 : 0;
    fs2 = mpidr_el1_mask[23:16] ? ffs(mpidr_el1_mask[23:16]) - 1 : 0;
    fs3 = mpidr_el1_mask[39:32] ? ffs(mpidr_el1_mask[39:32]) - 1 : 0;
    ls0 = fls(mpidr_el1_mask[7:0]);
    ls1 = fls(mpidr_el1_mask[15:8]);
    ls2 = fls(mpidr_el1_mask[23:16]);
    ls3 = fls(mpidr_el1_mask[39:32]);
    bits0 = ls0 - fs0;
    bits1 = ls1 - fs1;
    bits2 = ls2 - fs2;
    bits3 = ls3 - fs3;
    aff0_shift = fs0;
    aff1_shift = 8 + fs1 - bits0;
    aff2_shift = 16 + fs2 - (bits0 + bits1);
    aff3_shift = 32 + fs3 - (bits0 + bits1 + bits2);
    u32 hash(u64 mpidr_el1) {
            u32 l[4];
            u64 mpidr_el1_masked = mpidr_el1 & mpidr_el1_mask;
            l[0] = mpidr_el1_masked & 0xff;
            l[1] = mpidr_el1_masked & 0xff00;
            l[2] = mpidr_el1_masked & 0xff0000;
            l[3] = mpidr_el1_masked & 0xff00000000;
            return (l[0] >> aff0_shift | l[1] >> aff1_shift | l[2] >> aff2_shift |
                    l[3] >> aff3_shift);
    }
    
    The hashing algorithm relies on the inherent properties set in the ARM ARM
    recommendations for the MPIDR_EL1. Exotic configurations, where for instance
    the MPIDR_EL1 values at a given affinity level have large holes, can end up
    requiring big hash tables since the compression of values that can be achieved
    through shifting is somewhat crippled when holes are present. Kernel warns if
    the number of buckets of the resulting hash table exceeds the number of
    possible CPUs by a factor of 4, which is a symptom of a very sparse HW
    MPIDR_EL1 configuration.
    
    The hash algorithm is quite simple and can easily be implemented in assembly
    code, to be used in code paths where the kernel virtual address space is
    not set-up (ie cpu_resume) and instruction and data fetches are strongly
    ordered so code must be compact and must carry out few data accesses.
    
    Signed-off-by: Lorenzo Pieralisi <lorenzo.pieralisi@arm.com>

commit b058450f38c337d12a6d1a1bcaa8610859055e2e
Author: Lorenzo Pieralisi <lorenzo.pieralisi@arm.com>
Date:   Mon Aug 5 15:24:27 2013 +0100

    arm64: kernel: add MPIDR_EL1 accessors macros
    
    In order to simplify access to different affinity levels within the
    MPIDR_EL1 register values, this patch implements some preprocessor
    macros that allow to retrieve the MPIDR_EL1 affinity level value according
    to the level passed as input parameter.
    
    Reviewed-by: Will Deacon <will.deacon@arm.com>
    Signed-off-by: Lorenzo Pieralisi <lorenzo.pieralisi@arm.com>

commit 25acdd08fd715cf612428c2b3c39ce2a41926238
Author: WingMan Kwok <w-kwok2@ti.com>
Date:   Thu Dec 12 12:25:30 2013 -0500

    usb: phy: add Keystone usb phy driver
    
    Add Keystone platform USB PHY driver support. Current main purpose
    of this driver is to enable the PHY reference clock gate on the
    Keystone SoC. Otherwise it is a nop PHY.
    
    [ balbi@ti.com : add COMPILE_TEST as a possible dependency
            make sure drvdata is initialized before adding PHY ]
    
    Cc: Greg Kroah-Hartman <gregkh@linuxfoundation.org>
    Acked-by: Santosh Shilimkar <santosh.shilimkar@ti.com>
    Signed-off-by: WingMan Kwok <w-kwok2@ti.com>
    Signed-off-by: Felipe Balbi <balbi@ti.com>

commit 94d88d63c64a2d9420b77f5efa3f9bf2103fb9a8
Author: Laurent Pinchart <laurent.pinchart+renesas@ideasonboard.com>
Date:   Wed Nov 27 02:18:33 2013 +0100

    pwm: renesas-tpu: Enable driver compilation with COMPILE_TEST
    
    This helps increasing build testing coverage.
    
    Cc: Thierry Reding <thierry.reding@gmail.com>
    Cc: linux-pwm@vger.kernel.org
    Signed-off-by: Laurent Pinchart <laurent.pinchart+renesas@ideasonboard.com>
    Acked-by: Simon Horman <horms@verge.net.au>
    Signed-off-by: Thierry Reding <thierry.reding@gmail.com>

commit 215c65a067ccf5dc22e68f1f159ee83678e63ca9
Author: Laurent Pinchart <laurent.pinchart+renesas@ideasonboard.com>
Date:   Tue Nov 26 22:18:28 2013 -0300

    [media] v4l: sh_vou: Enable driver compilation with COMPILE_TEST
    
    This helps increasing build testing coverage.
    
    Cc: Guennadi Liakhovetski <g.liakhovetski@gmx.de>
    Signed-off-by: Laurent Pinchart <laurent.pinchart+renesas@ideasonboard.com>
    Acked-by: Simon Horman <horms@verge.net.au>
    Signed-off-by: Mauro Carvalho Chehab <m.chehab@samsung.com>

commit 54f05e95132bdb47fa408308d64fd293d3ffb908
Author: Laurent Pinchart <laurent.pinchart+renesas@ideasonboard.com>
Date:   Wed Dec 4 08:46:06 2013 -0800

    Input: sh_keysc - restrict non-COMPILE_TEST compilation
    
    Hardware supported by the driver is only found on SUPERH or
    ARCH_SHMOBILE platforms. Restrict non-COMPILE_TEST compilation to them.
    
    Signed-off-by: Laurent Pinchart <laurent.pinchart+renesas@ideasonboard.com>
    Acked-by: Simon Horman <horms+renesas@verge.net.au>
    Signed-off-by: Dmitry Torokhov <dmitry.torokhov@gmail.com>

commit 74878fb6368eb254d5bedd8f21a165562222919f
Author: Paul E. McKenney <paulmck@linux.vnet.ibm.com>
Date:   Tue Oct 15 11:51:23 2013 -0700

    rcutorture: Add --kmake-arg argument to kvm.sh
    
    This commit adds the --kmake-arg to kvm.sh, which allows passing in
    things like "V=1" to see the build commands, as well as enabling the
    CROSS_COMPILE= make macro used for cross-building.
    
    Signed-off-by: Paul E. McKenney <paulmck@linux.vnet.ibm.com>
    Cc: Greg KH <gregkh@linuxfoundation.org>

commit 7ad35442fc07689eea3e6357390ae7c8fd9ef53c
Author: Laurent Pinchart <laurent.pinchart+renesas@ideasonboard.com>
Date:   Wed Nov 27 02:18:36 2013 +0100

    spi: sh-msiof: Enable driver compilation with COMPILE_TEST
    
    This helps increasing build testing coverage.
    
    Signed-off-by: Laurent Pinchart <laurent.pinchart+renesas@ideasonboard.com>
    Acked-by: Simon Horman <horms@verge.net.au>
    Signed-off-by: Mark Brown <broonie@linaro.org>

commit 5a87cde490e1a1a5be5200012bf37a4b25b0f70e
Author: Tony Lindgren <tony@atomide.com>
Date:   Mon Nov 25 15:17:11 2013 -0800

    ARM: OMAP2+: Remove legacy booting support for n8x0
    
    Now we can boot n8x with the appended device tree with:
    
    $ ARCH=arm CROSS_COMPILE=/usr/bin/arm-linux-gnueabi- make omap2420-n800.dtb
    $ cat arch/arm/boot/zImage arch/arm/boot/dts/omap2420-n800.dtb > /tmp/zImage
    
    Note that you need at least the following enabled:
    
    CONFIG_ARM_APPENDED_DTB=y
    CONFIG_ARM_ATAG_DTB_COMPAT=y
    CONFIG_ARM_ATAG_DTB_COMPAT_CMDLINE_FROM_BOOTLOADER=y
    CONFIG_PINCTRL=y
    CONFIG_PINCTRL_SINGLE=y
    
    Tested-by: Aaro Koskinen <aaro.koskinen@iki.fi>
    Signed-off-by: Tony Lindgren <tony@atomide.com>

commit 924dd50bc4ad26612efbc75f7e60492c5faaa868
Author: Michael Neuling <mikey@neuling.org>
Date:   Thu Nov 21 14:59:07 2013 +1100

    powerpc: Fix error when cross building TAGS & cscope
    
    Currently if I cross build TAGS or cscope from x86 I get this:
      % make ARCH=powerpc TAGS
      gcc-4.8.real: error: unrecognized command line option -mbig-endian
      GEN     TAGS
      %
    
    I'm not setting CROSS_COMPILE= as logically I shouldn't need to and I
    haven't needed to in the past when building TAGS or cscope.  Also, the
    above completess correct as the error is not fatal to the build.
    
    This was caused by:
        commit d72b08017161ab385d4ae080ea415c9eb7ceef83
        Author: Ian Munsie <imunsie@au1.ibm.com>
        powerpc: Add ability to build little endian kernels
    
    The below fixes this by testing for the -mbig-endian option before
    adding it.
    
    I've not done the same thing in the little endian case as if
    -mlittle-endian doesn't exist, we probably want to fail quickly as you
    probably have an old big endian compiler.
    
    Signed-off-by: Michael Neuling <mikey@neuling.org>
    Signed-off-by: Benjamin Herrenschmidt <benh@kernel.crashing.org>

commit 78dc53c422172a317adb0776dfb687057ffa28b7
Merge: 3eaded86ac3e 62fe318256be
Author: Linus Torvalds <torvalds@linux-foundation.org>
Date:   Thu Nov 21 19:46:00 2013 -0800

    Merge branch 'for-linus2' of git://git.kernel.org/pub/scm/linux/kernel/git/jmorris/linux-security
    
    Pull security subsystem updates from James Morris:
     "In this patchset, we finally get an SELinux update, with Paul Moore
      taking over as maintainer of that code.
    
      Also a significant update for the Keys subsystem, as well as
      maintenance updates to Smack, IMA, TPM, and Apparmor"
    
    and since I wanted to know more about the updates to key handling,
    here's the explanation from David Howells on that:
    
     "Okay.  There are a number of separate bits.  I'll go over the big bits
      and the odd important other bit, most of the smaller bits are just
      fixes and cleanups.  If you want the small bits accounting for, I can
      do that too.
    
       (1) Keyring capacity expansion.
    
            KEYS: Consolidate the concept of an 'index key' for key access
            KEYS: Introduce a search context structure
            KEYS: Search for auth-key by name rather than target key ID
            Add a generic associative array implementation.
            KEYS: Expand the capacity of a keyring
    
         Several of the patches are providing an expansion of the capacity of a
         keyring.  Currently, the maximum size of a keyring payload is one page.
         Subtract a small header and then divide up into pointers, that only gives
         you ~500 pointers on an x86_64 box.  However, since the NFS idmapper uses
         a keyring to store ID mapping data, that has proven to be insufficient to
         the cause.
    
         Whatever data structure I use to handle the keyring payload, it can only
         store pointers to keys, not the keys themselves because several keyrings
         may point to a single key.  This precludes inserting, say, and rb_node
         struct into the key struct for this purpose.
    
         I could make an rbtree of records such that each record has an rb_node
         and a key pointer, but that would use four words of space per key stored
         in the keyring.  It would, however, be able to use much existing code.
    
         I selected instead a non-rebalancing radix-tree type approach as that
         could have a better space-used/key-pointer ratio.  I could have used the
         radix tree implementation that we already have and insert keys into it by
         their serial numbers, but that means any sort of search must iterate over
         the whole radix tree.  Further, its nodes are a bit on the capacious side
         for what I want - especially given that key serial numbers are randomly
         allocated, thus leaving a lot of empty space in the tree.
    
         So what I have is an associative array that internally is a radix-tree
         with 16 pointers per node where the index key is constructed from the key
         type pointer and the key description.  This means that an exact lookup by
         type+description is very fast as this tells us how to navigate directly to
         the target key.
    
         I made the data structure general in lib/assoc_array.c as far as it is
         concerned, its index key is just a sequence of bits that leads to a
         pointer.  It's possible that someone else will be able to make use of it
         also.  FS-Cache might, for example.
    
       (2) Mark keys as 'trusted' and keyrings as 'trusted only'.
    
            KEYS: verify a certificate is signed by a 'trusted' key
            KEYS: Make the system 'trusted' keyring viewable by userspace
            KEYS: Add a 'trusted' flag and a 'trusted only' flag
            KEYS: Separate the kernel signature checking keyring from module signing
    
         These patches allow keys carrying asymmetric public keys to be marked as
         being 'trusted' and allow keyrings to be marked as only permitting the
         addition or linkage of trusted keys.
    
         Keys loaded from hardware during kernel boot or compiled into the kernel
         during build are marked as being trusted automatically.  New keys can be
         loaded at runtime with add_key().  They are checked against the system
         keyring contents and if their signatures can be validated with keys that
         are already marked trusted, then they are marked trusted also and can
         thus be added into the master keyring.
    
         Patches from Mimi Zohar make this usable with the IMA keyrings also.
    
       (3) Remove the date checks on the key used to validate a module signature.
    
            X.509: Remove certificate date checks
    
         It's not reasonable to reject a signature just because the key that it was
         generated with is no longer valid datewise - especially if the kernel
         hasn't yet managed to set the system clock when the first module is
         loaded - so just remove those checks.
    
       (4) Make it simpler to deal with additional X.509 being loaded into the kernel.
    
            KEYS: Load *.x509 files into kernel keyring
            KEYS: Have make canonicalise the paths of the X.509 certs better to deduplicate
    
         The builder of the kernel now just places files with the extension ".x509"
         into the kernel source or build trees and they're concatenated by the
         kernel build and stuffed into the appropriate section.
    
       (5) Add support for userspace kerberos to use keyrings.
    
            KEYS: Add per-user_namespace registers for persistent per-UID kerberos caches
            KEYS: Implement a big key type that can save to tmpfs
    
         Fedora went to, by default, storing kerberos tickets and tokens in tmpfs.
         We looked at storing it in keyrings instead as that confers certain
         advantages such as tickets being automatically deleted after a certain
         amount of time and the ability for the kernel to get at these tokens more
         easily.
    
         To make this work, two things were needed:
    
         (a) A way for the tickets to persist beyond the lifetime of all a user's
             sessions so that cron-driven processes can still use them.
    
             The problem is that a user's session keyrings are deleted when the
             session that spawned them logs out and the user's user keyring is
             deleted when the UID is deleted (typically when the last log out
             happens), so neither of these places is suitable.
    
             I've added a system keyring into which a 'persistent' keyring is
             created for each UID on request.  Each time a user requests their
             persistent keyring, the expiry time on it is set anew.  If the user
             doesn't ask for it for, say, three days, the keyring is automatically
             expired and garbage collected using the existing gc.  All the kerberos
             tokens it held are then also gc'd.
    
         (b) A key type that can hold really big tickets (up to 1MB in size).
    
             The problem is that Active Directory can return huge tickets with lots
             of auxiliary data attached.  We don't, however, want to eat up huge
             tracts of unswappable kernel space for this, so if the ticket is
             greater than a certain size, we create a swappable shmem file and dump
             the contents in there and just live with the fact we then have an
             inode and a dentry overhead.  If the ticket is smaller than that, we
             slap it in a kmalloc()'d buffer"
    
    * 'for-linus2' of git://git.kernel.org/pub/scm/linux/kernel/git/jmorris/linux-security: (121 commits)
      KEYS: Fix keyring content gc scanner
      KEYS: Fix error handling in big_key instantiation
      KEYS: Fix UID check in keyctl_get_persistent()
      KEYS: The RSA public key algorithm needs to select MPILIB
      ima: define '_ima' as a builtin 'trusted' keyring
      ima: extend the measurement list to include the file signature
      kernel/system_certificate.S: use real contents instead of macro GLOBAL()
      KEYS: fix error return code in big_key_instantiate()
      KEYS: Fix keyring quota misaccounting on key replacement and unlink
      KEYS: Fix a race between negating a key and reading the error set
      KEYS: Make BIG_KEYS boolean
      apparmor: remove the "task" arg from may_change_ptraced_domain()
      apparmor: remove parent task info from audit logging
      apparmor: remove tsk field from the apparmor_audit_struct
      apparmor: fix capability to not use the current task, during reporting
      Smack: Ptrace access check mode
      ima: provide hash algo info in the xattr
      ima: enable support for larger default filedata hash algorithms
      ima: define kernel parameter 'ima_template=' to change configured default
      ima: add Kconfig default measurement list template
      ...

commit f63c4824aa1b745cf283453fd53385230307d8d1
Author: Linus Torvalds <torvalds@linux-foundation.org>
Date:   Fri Nov 15 18:57:42 2013 -0800

    Don't try to compile shmobile-iommu outside of ARM
    
    Commit 7d02c4d64dbb ("iommu/shmobile: Enable the driver on all ARM
    platforms") completely brokenly enabled the shmobile-iommu driver under
    COMPILE_TEST.
    
    It's bogus, because it won't compile anywhere else than ARM, since it
    tries to include <asm/dma-iommu.h>, which is very much ARM-only.
    
    So remove the bogus COMPILE_TEST dependency, which just causes
    allmodconfig to fail on non-ARM platforms.
    
    Cc: Joerg Roedel <joro@8bytes.org>
    Cc: iommu@lists.linux-foundation.org
    Cc: Laurent Pinchart <laurent.pinchart+renesas@ideasonboard.com>
    Cc: Simon Horman <horms@verge.net.au>
    Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>

commit dbed71416332d24e4e9ba26dcf90cd86a93c06f1
Author: David Howells <dhowells@redhat.com>
Date:   Fri Nov 1 15:11:14 2013 +0000

    KEYS: The RSA public key algorithm needs to select MPILIB
    
    The RSA public key algorithm needs to select MPILIB directly in Kconfig as the
    'select' directive is not recursive and is thus MPILIB is not enabled by
    selecting MPILIB_EXTRA.
    
    Without this, the following errors can occur:
    
            crypto/built-in.o: In function `RSA_verify_signature':
            rsa.c:(.text+0x1d347): undefined reference to `mpi_get_nbits'
            rsa.c:(.text+0x1d354): undefined reference to `mpi_get_nbits'
            rsa.c:(.text+0x1d36e): undefined reference to `mpi_cmp_ui'
            rsa.c:(.text+0x1d382): undefined reference to `mpi_cmp'
            rsa.c:(.text+0x1d391): undefined reference to `mpi_alloc'
            rsa.c:(.text+0x1d3b0): undefined reference to `mpi_powm'
            rsa.c:(.text+0x1d3c3): undefined reference to `mpi_free'
            rsa.c:(.text+0x1d3d8): undefined reference to `mpi_get_buffer'
            rsa.c:(.text+0x1d4d4): undefined reference to `mpi_free'
            rsa.c:(.text+0x1d503): undefined reference to `mpi_get_nbits'
    
    Reported-by: Randy Dunlap <rdunlap@infradead.org>
    Signed-off-by: David Howells <dhowells@redhat.com>
    Acked-by: Randy Dunlap <rdunlap@infradead.org>

commit 7d02c4d64dbbc7dc1996d32171067d3ad8f06ae9
Author: Laurent Pinchart <laurent.pinchart+renesas@ideasonboard.com>
Date:   Tue Oct 29 23:37:40 2013 +0100

    iommu/shmobile: Enable the driver on all ARM platforms
    
    Renesas ARM platforms are transitioning from single-platform to
    multi-platform kernels using the new ARCH_SHMOBILE_MULTI. Make the
    driver available on all ARM platforms to enable it on both ARCH_SHMOBILE
    and ARCH_SHMOBILE_MULTI, and increase build testing coverage with
    COMPILE_TEST.
    
    Cc: Joerg Roedel <joro@8bytes.org>
    Cc: iommu@lists.linux-foundation.org
    Signed-off-by: Laurent Pinchart <laurent.pinchart+renesas@ideasonboard.com>
    Acked-by: Simon Horman <horms@verge.net.au>
    Signed-off-by: Joerg Roedel <joro@8bytes.org>

commit e4a42f655fdbfadc41f8b2f95dca5e5d395015f5
Author: Laurent Pinchart <laurent.pinchart+renesas@ideasonboard.com>
Date:   Thu Oct 31 00:48:28 2013 -0700

    Input: sh_keysc - enable the driver on all ARM platforms
    
    Renesas ARM platforms are transitioning from single-platform to
    multi-platform kernels using the new ARCH_SHMOBILE_MULTI. Make the
    driver available on all ARM platforms to enable it on both ARCH_SHMOBILE
    and ARCH_SHMOBILE_MULTI, and increase build testing coverage with
    COMPILE_TEST.
    
    Signed-off-by: Laurent Pinchart <laurent.pinchart+renesas@ideasonboard.com>
    Acked-by: Simon Horman <horms@verge.net.au>
    Signed-off-by: Dmitry Torokhov <dmitry.torokhov@gmail.com>

commit 5edb1062e54cffe84b0bfa9ffdfdad337e635d7d
Author: Laurent Pinchart <laurent.pinchart+renesas@ideasonboard.com>
Date:   Tue Oct 29 23:37:38 2013 +0100

    i2c: sh_mobile & rcar: Enable the driver on all ARM platforms
    
    Renesas ARM platforms are transitioning from single-platform to
    multi-platform kernels using the new ARCH_SHMOBILE_MULTI. Make the
    driver available on all ARM platforms to enable it on both ARCH_SHMOBILE
    and ARCH_SHMOBILE_MULTI, and increase build testing coverage with
    COMPILE_TEST.
    
    Signed-off-by: Laurent Pinchart <laurent.pinchart+renesas@ideasonboard.com>
    Signed-off-by: Wolfram Sang <wsa@the-dreams.de>

commit 6e15d0e04bfeaa5662a289ee915273307326e45a
Author: Sudeep KarkadaNagesha <sudeep.karkadanagesha@arm.com>
Date:   Mon Oct 21 13:29:42 2013 +0100

    ARM64: DT: define ARM64 specific arch_match_cpu_phys_id
    
    OF/DT core library provides architecture specific hook to match the
    logical cpu index with the corresponding physical identifier.
    
    On ARM64, the MPIDR_EL1 contains specific bitfields(MPIDR_EL1.Aff{3..0})
    which uniquely identify a CPU, in addition to some non-identifying
    information and reserved bits. The ARM cpu binding defines the 'reg'
    property to only contain the affinity bits, and any cpu nodes with other
    bits set in their 'reg' entry are skipped.
    
    This patch overrides the weak definition of arch_match_cpu_phys_id
    with ARM64 specific version using MPIDR_EL1.Aff{3..0} as cpu physical
    identifiers.
    
    Signed-off-by: Sudeep KarkadaNagesha <sudeep.karkadanagesha@arm.com>
    Acked-by: Mark Rutland <mark.rutland@arm.com>
    Cc: Will Deacon <will.deacon@arm.com>
    Signed-off-by: Catalin Marinas <catalin.marinas@arm.com>

commit d4f9e7b3d12e92ede642f6f4fc7d959f06da8ccc
Author: Laurent Pinchart <laurent.pinchart+renesas@ideasonboard.com>
Date:   Tue Oct 29 23:37:36 2013 +0100

    serial: sh-sci: Enable the driver on all ARM platforms
    
    Renesas ARM platforms are transitioning from single-platform to
    multi-platform kernels using the new ARCH_SHMOBILE_MULTI. Make the
    driver available on all ARM platforms to enable it on both ARCH_SHMOBILE
    and ARCH_SHMOBILE_MULTI, and increase build testing coverage with
    COMPILE_TEST.
    
    Signed-off-by: Laurent Pinchart <laurent.pinchart+renesas@ideasonboard.com>
    Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>

commit 0e3d4373b8a7757a8f5187f5cabafb6aceff469b
Author: Minghuan Lian <Minghuan.Lian@freescale.com>
Date:   Wed Jul 31 10:59:07 2013 +0800

    powerpc/dts: fix sRIO error interrupt for b4860
    
    For B4 platform, MPIC EISR register is in reversed bitmap order,
    instead of "Error interrupt source 0-31. Bit 0 represents SRC0."
    the correct ordering is "Error interrupt source 0-31. Bit 0
    represents SRC31." This patch is to fix sRIO EISR bit value
    of error interrupt in dts node.
    
    Signed-off-by: Minghuan Lian <Minghuan.Lian@freescale.com>
    Signed-off-by: Scott Wood <scottwood@freescale.com>

commit 79c648806f9034abf54332b78043bb242189d953
Author: Marc Zyngier <marc.zyngier@arm.com>
Date:   Fri Oct 18 18:19:03 2013 +0100

    arm/arm64: KVM: PSCI: use MPIDR to identify a target CPU
    
    The KVM PSCI code blindly assumes that vcpu_id and MPIDR are
    the same thing. This is true when vcpus are organized as a flat
    topology, but is wrong when trying to emulate any other topology
    (such as A15 clusters).
    
    Change the KVM PSCI CPU_ON code to look at the MPIDR instead
    of the vcpu_id to pick a target CPU.
    
    Signed-off-by: Marc Zyngier <marc.zyngier@arm.com>
    Signed-off-by: Christoffer Dall <christoffer.dall@linaro.org>

commit 2d1d841bd44e24b58a3d3cc4fa793670aaa38fbf
Author: Marc Zyngier <marc.zyngier@arm.com>
Date:   Fri Oct 18 18:19:04 2013 +0100

    ARM: KVM: Fix MPIDR computing to support virtual clusters
    
    In order to be able to support more than 4 A7 or A15 CPUs,
    we need to fix the MPIDR computing to reflect the fact that
    both A15 and A7 can only exist in clusters of at most 4 CPUs.
    
    Fix the MPIDR computing to allow virtual clusters to be exposed
    to the guest.
    
    Signed-off-by: Marc Zyngier <marc.zyngier@arm.com>
    Signed-off-by: Christoffer Dall <christoffer.dall@linaro.org>

commit 2ef9d838e49b4d6396f9c17a38eb5b85a10da07d
Merge: 1c3e56f99c91 43e01beda4b5
Author: Greg Kroah-Hartman <gregkh@linuxfoundation.org>
Date:   Sat Oct 19 05:16:34 2013 -0700

    Merge tag 'iio-for-3.12d' of git://git.kernel.org/pub/scm/linux/kernel/git/jic23/iio into staging-next
    
    Jonathan writes:
    
    Fourth round of IIO new drivers, functionality and cleanups for the 3.13 cycle.
    
    New Drivers
    * cm36651 combined RGB light and proximity sensor.
    
    Core improvements
    
    * Some more fixes and cleanups related to buffers.  These include the second
      half of a series which went is as fixes.  The basis for delaying until the
      next merge window is that some are too invasive for this late in a cycle
      and others only effect code paths current unused in the mainline tree.
      In this case we have:
       * protecting against concurrent userspace access
       * fixing a memory leak if a device goes away
       * avoiding always reallocating the buffer whether or not it has changed
         (a bug fix, but one with no functional changes other than a small speed
         improvement.)
       * Add reference counting for buffers to ensure they hang around if open
         from userspace or in kernel when the device is forcefully removed.
       * Return -ENODEV for buffer access operations when the device has gone
         away.
       * Add proper locking for iio_update_buffers (currently we only have one
         buffer per device in mainline, but an input bridge driver is under
         development which would make this bug 'real'.)
       * Wake up anyone waiting on a buffer if the device is unregistered.  A
         subsequent read will fail, notifying userspace that the device is no
         longer there rather than having it wait possibly for ever.
    
    * Move the iio_sw_preenable functionality into the core.  This avoids drivers
      having to 'know' about how the buffers are implemented and is called by
      almost all drivers anyway.  Those that don't call it are not harmed by it
      being called.
    * New registration approach for information (i.e. sysfs attributes) about
      events.  Much more generic and now similar to how the equivalent is
      handled for channel information.  The events infrastructure had been left
      behind by other changes so this brings it back in line.
    * Using the new events registration approach, add a hysterisis event_info
      element and apply this to those drivers with this property.
    * A little unitialized variable bug in the generic_buffer.c example.
    * Factor out the code for freeing lists of IIO Device attributes to avoid
      some repitition.
    
    Driver cleanups
    * At91 driver gains touch screen support and some related fixes.
    * Follow up series of patches removing the now redundant
      iio_sw_buffer_preenable calls.
    * Lots of conversions to the new event registration methods.
    * Another round of hmc5843 cleanups as that driver moves towards graduating
      from staging.
    * Make some SoC drivers buildable if COMPILE_TEST is used.  Follow up fixes
      for a few bits and bobs that revealed.
    * Add explicit includes of linux/of.h to those drivers making us of linux/of.h

commit ef4d4d1b8f2cda46ed483ee2f0d6f5b63bc7c020
Author: Lars-Peter Clausen <lars@metafoo.de>
Date:   Sat Oct 12 14:55:00 2013 +0100

    staging:iio: Allow to build SoC specific drivers when COMPILE_TEST is set
    
    None of the SPEAr, LPC32XX or MXS ADC drivers have a compile time dependency on
    their respective platform. So make it possible to build the drivers when
    CONFIG_COMPILE_TEST is set. This makes it easier to compile test changes.
    
    Signed-off-by: Lars-Peter Clausen <lars@metafoo.de>
    Reviewed-by: Marek Vasut <marex@denx.de>
    Cc: Stefan Roese <sr@denx.de>
    Cc: Roland Stigge <stigge@antcom.de>
    Signed-off-by: Jonathan Cameron <jic23@kernel.org>

commit 2cd1e1d8c19adee184ce4c99b0dd586b71892837
Author: Lars-Peter Clausen <lars@metafoo.de>
Date:   Sat Oct 12 14:55:00 2013 +0100

    staging:iio:mxs-lradc: Select STMP_DEVICE
    
    The MXS ADC driver uses the stmp_reset_block() which is only provided when the
    STMP_DEVICE Kconfig symbol is selected. Hence the driver should select this
    symbol. So far this has not been a problem since the driver depends on ARCH_MXS,
    which already selects STMP_DEVICE, but will become necessary once we allow the
    driver to be built when COMPILE_TEST is selected.
    
    Signed-off-by: Lars-Peter Clausen <lars@metafoo.de>
    Cc: Marek Vasut <marex@denx.de>
    Signed-off-by: Jonathan Cameron <jic23@kernel.org>

commit 1158fca401e09665c440a9fe4fd4f131ee85c13b
Author: Jonathan Austin <jonathan.austin@arm.com>
Date:   Thu Sep 26 16:49:27 2013 +0100

    KVM: ARM: Fix calculation of virtual CPU ID
    
    KVM does not have a notion of multiple clusters for CPUs, just a linear
    array of CPUs. When using a system with cores in more than one cluster, the
    current method for calculating the virtual MPIDR will leak the (physical)
    cluster information into the virtual MPIDR. One effect of this is that
    Linux under KVM fails to boot multiple CPUs that aren't in the 0th cluster.
    
    This patch does away with exposing the real MPIDR fields in favour of simply
    using the virtual CPU number (but preserving the U bit, as before).
    
    Signed-off-by: Jonathan Austin <jonathan.austin@arm.com>
    Acked-by: Marc Zyngier <marc.zyngier@arm.com>
    Signed-off-by: Christoffer Dall <christoffer.dall@linaro.org>

commit d72b08017161ab385d4ae080ea415c9eb7ceef83
Author: Ian Munsie <imunsie@au1.ibm.com>
Date:   Mon Sep 23 12:05:11 2013 +1000

    powerpc: Add ability to build little endian kernels
    
    This patch allows the kbuild system to successfully compile a kernel
    for the little endian PowerPC64 architecture. A subsequent patch
    will add the CONFIG_CPU_LITTLE_ENDIAN kernel config option which
    must be set to build such a kernel.
    
    If cross compiling, CROSS_COMPILE must point to a suitable toolchain
    (compiled for the powerpc64le-linux and powerpcle-linux targets).
    
    Signed-off-by: Ian Munsie <imunsie@au1.ibm.com>
    Signed-off-by: Anton Blanchard <anton@samba.org>
    Signed-off-by: Benjamin Herrenschmidt <benh@kernel.crashing.org>

commit 3197e4a123d90a2ece9488267a05fcb52766e52d
Merge: 32d7962d3713 37078732998e
Author: Kevin Hilman <khilman@linaro.org>
Date:   Wed Oct 9 13:21:51 2013 -0700

    Merge tag 'dt-3.13' of git://git.infradead.org/linux-mvebu into next/dt
    
    From Jason Cooper:
    mvebu dt changes for v3.13
    
     - mvebu
        - add MSI
        - new compatible string for mv64xxx-i2c
    
     - dove
        - use the pre-processor
        - define the MBus nodes
        - add PCIe controllers
        - add Globalscale D3Plug
        - relocate internal registers nodes
    
    * tag 'dt-3.13' of git://git.infradead.org/linux-mvebu:
      ARM: dove: add initial DT file for Globalscale D3Plug
      ARM: dove: add PCIe controllers to SoC DT
      ARM: dove: relocate internal registers device nodes
      ARM: dove: add MBus DT node
      ARM: dove: add MBUS_ID macro to Dove DT
      ARM: dove: use preprocessor on device tree files
      ARM: mvebu: link PCIe controllers to the MSI controller
      ARM: mvebu: the MPIC now provides MSI controller features
      ARM: dts: mvebu: Update with the new compatible string for mv64xxx-i2c
    
    Signed-off-by: Kevin Hilman <khilman@linaro.org>

commit 2a577a7569182cc9a7fb0c91b3a5d031839806c8
Author: Jarkko Nikula <jarkko.nikula@bitmer.com>
Date:   Tue Oct 1 21:20:50 2013 +0300

    ASoC: omap: Fix incorrect ARM dependency
    
    Commit b0e0a4d ("ASoC: omap: Enable COMPILE_TEST build for DT platforms")
    added two incorrect CONFIG_ARCH_ARM dependencies making impossible to select
    audio support for Nokia RX-51. Fix this by using correct CONFIG_ARM.
    
    Signed-off-by: Jarkko Nikula <jarkko.nikula@bitmer.com>
    Signed-off-by: Mark Brown <broonie@linaro.org>

commit d4fa99417a0701c7aebe2d53ff65b3048985b310
Author: Thomas Petazzoni <thomas.petazzoni@free-electrons.com>
Date:   Fri Aug 9 22:27:15 2013 +0200

    ARM: mvebu: link PCIe controllers to the MSI controller
    
    This commit adjusts the Armada 370 and Armada XP PCIe controllers
    Device Tree informations to reference their MSI controller. In the
    case of this platform, the MSI controller is implemented by the MPIC.
    
    Signed-off-by: Thomas Petazzoni <thomas.petazzoni@free-electrons.com>
    Tested-by: Daniel Price <daniel.price@gmail.com>
    Acked-by: Gregory CLEMENT <gregory.clement@free-electrons.com>
    Signed-off-by: Jason Cooper <jason@lakedaemon.net>

commit 86178f862defd293c7ac3eb2073759a52ba2518c
Author: Thomas Petazzoni <thomas.petazzoni@free-electrons.com>
Date:   Fri Aug 9 22:27:13 2013 +0200

    ARM: mvebu: the MPIC now provides MSI controller features
    
    Adds the 'msi-controller' property to the main interrupt controller
    Device Tree node, to indicate that it can now behave as a MSI
    controller.
    
    Signed-off-by: Thomas Petazzoni <thomas.petazzoni@free-electrons.com>
    Reviewed-by: Thierry Reding <thierry.reding@gmail.com>
    Tested-by: Daniel Price <daniel.price@gmail.com>
    Acked-by: Gregory CLEMENT <gregory.clement@free-electrons.com>
    Signed-off-by: Jason Cooper <jason@lakedaemon.net>

commit 7ba0127805abf27f0549f327699283e1dbed12f3
Author: Dave Jones <davej@redhat.com>
Date:   Tue Sep 3 17:35:52 2013 -0400

    USB: phy: Restrict AM335x PHY driver to only be built on !ARM when COMPILE_TEST is set.
    
    Signed-off-by: Dave Jones <davej@fedoraproject.org>
    Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>

commit 965e260a064a35359bc6281aa76c39e3f43ed9ba
Author: Dave Jones <davej@redhat.com>
Date:   Tue Sep 3 17:13:23 2013 -0400

    tty: serial: Restrict ST ASC driver to only build on !ARM when COMPILE_TEST is set.
    
    The Kconfig for this option suggests it's only relevant on STi SoCs,
    so add depends to have it not show up on archs that won't ever run it.
    
    Signed-off-by: Dave Jones <davej@fedoraproject.org>
    Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>

commit 4ff158229770d245ce0a961a594adfc0e86d1cc5
Author: Konstantin Khlebnikov <khlebnikov@openvz.org>
Date:   Tue Sep 17 15:14:52 2013 +0400

    MPILIB: add module description and license
    
    This patch fixes lack of license, otherwise mpi.ko taints kernel.
    
    Signed-off-by: Konstantin Khlebnikov <khlebnikov@openvz.org>
    Signed-off-by: David Howells <dhowells@redhat.com>

commit b426beb6eeb0c81aeaa419f7444064abc9cb04ae
Author: David Howells <dhowells@redhat.com>
Date:   Fri Aug 30 16:18:02 2013 +0100

    X.509: Embed public_key_signature struct and create filler function
    
    Embed a public_key_signature struct in struct x509_certificate, eliminating
    now unnecessary fields, and split x509_check_signature() to create a filler
    function for it that attaches a digest of the signed data and an MPI that
    represents the signature data.  x509_free_certificate() is then modified to
    deal with these.
    
    Whilst we're at it, export both x509_check_signature() and the new
    x509_get_sig_params().
    
    Signed-off-by: David Howells <dhowells@redhat.com>
    Reviewed-by: Kees Cook <keescook@chromium.org>
    Reviewed-by: Josh Boyer <jwboyer@redhat.com>

commit 1bfbddb6f3a0dbb8c3996d1c4d4911d695737c15
Author: Dave Martin <dave.martin@linaro.org>
Date:   Mon May 14 17:40:07 2012 +0100

    ARM: bL_switcher: Basic trace events support
    
    This patch adds simple trace events to the b.L switcher code
    to allow tracing of CPU migration events.
    
    To make use of the trace events, you will need:
    
    CONFIG_FTRACE=y
    CONFIG_ENABLE_DEFAULT_TRACERS=y
    
    The following events are added:
      * power:cpu_migrate_begin
      * power:cpu_migrate_finish
    
    each with the following data:
        u64     timestamp;
        u32     cpu_hwid;
    
    power:cpu_migrate_begin occurs immediately before the
    switcher-specific migration operations start.
    power:cpu_migrate_finish occurs immediately when migration is
    completed.
    
    The cpu_hwid field contains the ID fields of the MPIDR.
    
    * For power:cpu_migrate_begin, cpu_hwid is the ID of the outbound
      physical CPU (equivalent to (from_phys_cpu,from_phys_cluster)).
    
    * For power:cpu_migrate_finish, cpu_hwid is the ID of the inbound
      physical CPU (equivalent to (to_phys_cpu,to_phys_cluster)).
    
    By design, the cpu_hwid field is masked in the same way as the
    device tree cpu node reg property, allowing direct correlation to
    the DT description of the hardware.
    
    The timestamp is added in order to minimise timing noise.  An
    accurate system-wide clock should be used for generating this
    (hopefully getnstimeofday is appropriate, but it could be changed).
    It could be any monotonic shared clock, since the aim is to allow
    accurate deltas to be computed.  We don't necessarily care about
    accurate synchronisation with wall clock time.
    
    In practice, each switch takes place on a single logical CPU,
    and the trace infrastructure should guarantee that events are
    well-ordered with respect to a single logical CPU.
    
    Signed-off-by: Dave Martin <dave.martin@linaro.org>
    Signed-off-by: Nicolas Pitre <nico@linaro.org>

commit ad6343a49ee637de6352af1dc519067b9591b710
Author: Ben Hutchings <ben@decadent.org.uk>
Date:   Sun Sep 1 19:55:58 2013 +0100

    Staging: speakup: Add dependencies for ISA card drivers
    
    Several speakup drivers are for ISA cards and are useless on systems
    without ISA slots.  Make them depend on ISA || COMPILE_TEST.
    
    Signed-off-by: Ben Hutchings <ben@decadent.org.uk>
    Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>

commit 650433b8b1a4a4a46250ad0c8f68b2e47671914d
Author: Ben Hutchings <ben@decadent.org.uk>
Date:   Sun Sep 1 20:18:49 2013 +0100

    Staging: comedi: Fix dependencies for drivers misclassified as PCI
    
    The Fastwel UNIOxx-5 is a PC/104 board, so put COMEDI_UNIOXX5 under
    COMEDI_ISA_DRIVERS.
    
    The DIL/Net-PC 1486 is a 486 system, so put COMEDI_SSV_DNP under
    COMEDI_MISC_DRIVERS and add a dependency on X86_32 || COMPILE_TEST.
    
    Reviewed-by: Ian Abbott <abbotti@mev.co.uk>
    Signed-off-by: Ben Hutchings <ben@decadent.org.uk>
    Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>

commit b444d1dfe296433a93d6b814d924e0ab99ad7e7b
Author: Uwe Kleine-Knig <u.kleine-koenig@pengutronix.de>
Date:   Tue Sep 10 10:46:33 2013 +0200

    spi: fsl-dspi: several minor improvements and fixes
    
     - improve dependencies using COMPILE_TEST
     - fix a typo
     - drop platform_set_drvdata(pdev, NULL) in error path of probe
     - make MODULE_LICENSE match the header
    
    Signed-off-by: Uwe Kleine-Knig <u.kleine-koenig@pengutronix.de>
    Signed-off-by: Mark Brown <broonie@linaro.org>

commit a22a0fdba4191473581f86c9dd5361cf581521d3
Merge: bf83e6146480 db15e6312efd
Author: Linus Torvalds <torvalds@linux-foundation.org>
Date:   Tue Sep 10 22:58:14 2013 -0700

    Merge tag 'for-v3.12' of git://git.infradead.org/battery-2.6
    
    Pull battery/power supply driver updates from Anton Vorontsov:
     "New drivers:
    
       - APM X-Gene system reboot driver by Feng Kan and Loc Ho (APM).
    
       - Qualcomm MSM reboot/poweroff driver by Abhimanyu Kapur (Codeaurora).
    
       - Texas Instruments BQ24190 charger driver by Mark A.  Greer (Animal
         Creek Technologies).
    
       - Texas Instruments TWL4030 MADC battery driver by Lukas Mrdian and
         Marek Belisko (Golden Delicious Computers).  The driver is used on
         Freerunner GTA04 phones.
    
      Highlighted fixes and improvements:
    
       - Suspend/wakeup logic improvements: power supply objects will block
         system suspend until all power supply events are processed.  Thanks
         to Zoran Markovic (Linaro), Arve Hjonnevag and Todd Poynor (Google)"
    
    * tag 'for-v3.12' of git://git.infradead.org/battery-2.6:
      rx51_battery: Fix channel number when reading adc value
      power: Add twl4030_madc battery driver.
      bq24190_charger: Workaround SS definition problem on i386 builds
      power_supply: Prevent suspend until power supply events are processed
      vexpress-poweroff: Should depend on the required infrastructure
      twl4030-charger: Fix compiler warning with regulator_enable()
      rx51_battery: Replace hardcoded channels values.
      bq24190_charger: Add support for TI BQ24190 Battery Charger
      ab8500-charger: We print an unintended error message
      max8925_power: Fix missing of_node_put
      power_supply: Replace strict_strtol() with kstrtol()
      power: Add APM X-Gene system reboot driver
      power_supply: tosa_battery: Get rid of irq_to_gpio usage
      power supply: collie_battery: Convert to use dev_pm_ops
      power_supply: Make goldfish_battery depend on GOLDFISH || COMPILE_TEST
      power: reset: Add msm restart support
      MAINTAINERS: drivers/power: add entry for SmartReflex AVS drivers

commit 1c50e8d26e2c2c810f28730a13d885c64fa2058d
Author: Sreekanth Reddy <Sreekanth.Reddy@lsi.com>
Date:   Thu Jul 25 11:29:45 2013 +0530

    [SCSI] mpt2sas: Infinite loop can occur if MPI2_IOCSTATUS_CONFIG_INVALID_PAGE is not returned
    
    Infinite loop can occur if IOCStatus is not equal to
    MPI2_IOCSTATUS_CONFIG_INVALID_PAGE value in the while loops in functions
    _scsih_search_responding_sas_devices,
    _scsih_search_responding_raid_devices and
    _scsih_search_responding_expanders
    
    So, Instead of checking for MPI2_IOCSTATUS_CONFIG_INVALID_PAGE value,
    in this patch code is modified to check for IOCStatus not equals to
    MPI2_IOCSTATUS_SUCCESS to break the while loop.
    
    Signed-off-by: Sreekanth Reddy <Sreekanth.Reddy@lsi.com>
    Signed-off-by: James Bottomley <JBottomley@Parallels.com>

commit 5d32aa2df536f01d3f4d02d6d52b2a718e248f9e
Author: Sreekanth Reddy <Sreekanth.Reddy@lsi.com>
Date:   Thu Jul 25 11:26:56 2013 +0530

    [SCSI] mpt2sas: MPI2 Rev X (2.00.16) specifications
    
    Change set in MPI2 Rev x specification and 2.00.26 header files
    
    1. Added two new AbortType values for TargetModeAbort Request: one to abort
       all IOs from a single initiator and other to abort only Command IUs.
    
    2. Added Use Slot Information during Port Enable Event Reply flag to the Flags
       field of Manufacturing Page 7.
    
    3. Added OEM Identifier to BiosOptions bits of BIOS Page 1.
    
    Signed-off-by: Sreekanth Reddy <Sreekanth.Reddy@lsi.com>
    Signed-off-by: James Bottomley <JBottomley@Parallels.com>

commit 3627dba57f1030f307096b60e0c8f10d10ced6c8
Author: Sreekanth Reddy <Sreekanth.Reddy@lsi.com>
Date:   Thu Jul 25 11:25:57 2013 +0530

    [SCSI] mpt2sas: Change in MPI2_RAID_ACTION_SYSTEM_SHUTDOWN_INITIATED notification methodology
    
    The intent of this patch is to perform a graceful shutdown of target drives even if
    volume doesn't exits. Changes done in this patch
    
    1. Removed the check for the presence of volumes before sending down
       MPI2_RAID_ACTION_SYSTEM_SHUTDOWN_INITIATED. Therefore, this RAID action
       would be sent if the card is IR Firmware.
    
    2. The MPI2_RAID_ACTION_SYSTEM_SHUTDOWN_INITIATED is sent even when the
       system undergoes suspend (in addition to remove/shutdown which was already
       present)
    
    Signed-off-by: Sreekanth Reddy <Sreekanth.Reddy@lsi.com>
    Signed-off-by: James Bottomley <JBottomley@Parallels.com>

commit 7a330a5416de9240c93a6987e11cb32b581d3263
Merge: c7878810f2d3 09198f8feff1
Author: Rafael J. Wysocki <rafael.j.wysocki@intel.com>
Date:   Tue Aug 27 01:44:40 2013 +0200

    Merge branch 'pm-cpufreq'
    
    * pm-cpufreq: (60 commits)
      cpufreq: pmac32-cpufreq: remove device tree parsing for cpu nodes
      cpufreq: pmac64-cpufreq: remove device tree parsing for cpu nodes
      cpufreq: maple-cpufreq: remove device tree parsing for cpu nodes
      cpufreq: arm_big_little: remove device tree parsing for cpu nodes
      cpufreq: kirkwood-cpufreq: remove device tree parsing for cpu nodes
      cpufreq: spear-cpufreq: remove device tree parsing for cpu nodes
      cpufreq: highbank-cpufreq: remove device tree parsing for cpu nodes
      cpufreq: cpufreq-cpu0: remove device tree parsing for cpu nodes
      cpufreq: imx6q-cpufreq: remove device tree parsing for cpu nodes
      drivers/bus: arm-cci: avoid parsing DT for cpu device nodes
      ARM: mvebu: remove device tree parsing for cpu nodes
      ARM: topology: remove hwid/MPIDR dependency from cpu_capacity
      of/device: add helper to get cpu device node from logical cpu index
      driver/core: cpu: initialize of_node in cpu's device struture
      ARM: DT/kernel: define ARM specific arch_match_cpu_phys_id
      of: move of_get_cpu_node implementation to DT core library
      powerpc: refactor of_get_cpu_node to support other architectures
      openrisc: remove undefined of_get_cpu_node declaration
      microblaze: remove undefined of_get_cpu_node declaration
      cpufreq: fix bad unlock balance on !CONFIG_SMP
      ...

commit bcf24e1daa94f4c52ef7a3f657e43cc6bc50d46b
Author: Amarinder Bindra <a-bindra@ti.com>
Date:   Wed Jul 10 21:36:24 2013 +0530

    mmc: omap_hsmmc: use the generic config for omap2plus devices
    
    OMAP's hs_mmc driver is used for MMC controller operation on many
    omap2plus SoCs (OMAP2430, OMAP3, 4, 5 and AM335x).
    
    Considering that the device tree entries are already present for these,
    allow the driver to be built using the config ARCH_OMAP2PLUS rather
    than individually adding a config for each SoC to enable the
    support.
    
    Use COMPILE_TEST to enable the build for other platforms.
    
    Signed-off-by: Amarinder Bindra <a-bindra@ti.com>
    Cc: Ezequiel Garcia <ezequiel.garcia@free-electrons.com>
    Cc: Nishanth Menon <nm@ti.com>
    Acked-by: Felipe Balbi <balbi@ti.com>
    Acked-by: Balaji T K <balajitk@ti.com>
    Signed-off-by: Chris Ball <cjb@laptop.org>

commit 031cd037af74b07792e37d0d4721063f7b4b44c7
Author: Felipe Balbi <balbi@ti.com>
Date:   Thu Jul 11 16:09:05 2013 +0300

    mmc: omap_hsmmc: fix dependency on indirect header inclusion
    
    omap_hsmmc.c depends on <linux/sizes.h> being included indirectly by
    another header. Once we enable COMPILE_TEST for this driver, we might
    compile under architectures which won't include <linux/sizes.h> for us.
    In fact, one such case is x86.
    
    In order to prevent compile breakages, let's explicitly include
    <linux/sizes.h>.
    
    Signed-off-by: Felipe Balbi <balbi@ti.com>
    Acked-by: Balaji T K <balajitk@ti.com>
    Signed-off-by: Chris Ball <cjb@laptop.org>

commit 09198f8feff1fcdf03994f35955292f85b299bd6
Merge: 4eb5178c9cc0 1037b2752345
Author: Rafael J. Wysocki <rafael.j.wysocki@intel.com>
Date:   Fri Aug 23 00:57:19 2013 +0200

    Merge branch 'cpu_of_node' of git://linux-arm.org/linux-skn into pm-cpufreq-next
    
    Pull DT/core/cpufreq cpu_ofnode updates for v3.12 from Sudeep KarkadaNagesha.
    
    * 'cpu_of_node' of git://linux-arm.org/linux-skn:
      cpufreq: pmac32-cpufreq: remove device tree parsing for cpu nodes
      cpufreq: pmac64-cpufreq: remove device tree parsing for cpu nodes
      cpufreq: maple-cpufreq: remove device tree parsing for cpu nodes
      cpufreq: arm_big_little: remove device tree parsing for cpu nodes
      cpufreq: kirkwood-cpufreq: remove device tree parsing for cpu nodes
      cpufreq: spear-cpufreq: remove device tree parsing for cpu nodes
      cpufreq: highbank-cpufreq: remove device tree parsing for cpu nodes
      cpufreq: cpufreq-cpu0: remove device tree parsing for cpu nodes
      cpufreq: imx6q-cpufreq: remove device tree parsing for cpu nodes
      drivers/bus: arm-cci: avoid parsing DT for cpu device nodes
      ARM: mvebu: remove device tree parsing for cpu nodes
      ARM: topology: remove hwid/MPIDR dependency from cpu_capacity
      of/device: add helper to get cpu device node from logical cpu index
      driver/core: cpu: initialize of_node in cpu's device struture
      ARM: DT/kernel: define ARM specific arch_match_cpu_phys_id
      of: move of_get_cpu_node implementation to DT core library
      powerpc: refactor of_get_cpu_node to support other architectures
      openrisc: remove undefined of_get_cpu_node declaration
      microblaze: remove undefined of_get_cpu_node declaration

commit 816a8de0017f16c32e747abc5367bf379515b20a
Author: Sudeep KarkadaNagesha <sudeep.karkadanagesha@arm.com>
Date:   Mon Jun 17 14:20:00 2013 +0100

    ARM: topology: remove hwid/MPIDR dependency from cpu_capacity
    
    Currently the topology code computes cpu capacity and stores it in
    the list along with hwid(which is MPIDR) as it parses the CPU nodes
    in the device tree. This is required as it needs to be mapped to the
    logical CPU later.
    
    Since the CPU device nodes can be retrieved in the logical ordering
    using DT/OF helpers, its possible to store cpu_capacity also in logical
    ordering and avoid storing hwid for each entry.
    
    This patch removes hwid by making use of of_get_cpu_node.
    
    Cc: Russell King <linux@arm.linux.org.uk>
    Cc: Lorenzo Pieralisi <lorenzo.pieralisi@arm.com>
    Acked-by: Rob Herring <rob.herring@calxeda.com>
    Acked-by: Nicolas Pitre <nico@linaro.org>
    Signed-off-by: Sudeep KarkadaNagesha <sudeep.karkadanagesha@arm.com>

commit 973e02c1e89768d13be259bf77f88b5cfd16bade
Author: Sudeep KarkadaNagesha <sudeep.karkadanagesha@arm.com>
Date:   Mon Jun 17 13:11:29 2013 +0100

    ARM: DT/kernel: define ARM specific arch_match_cpu_phys_id
    
    OF/DT core library now provides architecture specific hook to match the
    logical cpu index with the corresponding physical identifier. Most of the
    cpu DT node parsing and initialisation is contained in devtree.c. So it's
    better to define ARM specific arch_match_cpu_phys_id there.
    
    This mainly helps to avoid replication of the code doing CPU node parsing
    and physical(MPIDR) to logical mapping.
    
    Cc: Russell King <linux@arm.linux.org.uk>
    Cc: Lorenzo Pieralisi <lorenzo.pieralisi@arm.com>
    Acked-by: Rob Herring <rob.herring@calxeda.com>
    Acked-by: Nicolas Pitre <nico@linaro.org>
    Signed-off-by: Sudeep KarkadaNagesha <sudeep.karkadanagesha@arm.com>

commit 41caa760d6acaf47cbd44c3d78307fb9be089111
Author: Gabor Juhos <juhosg@openwrt.org>
Date:   Fri Aug 16 10:23:30 2013 +0200

    rt2x00: rt2800pci: fix AUX_CTRL register setup for RT3090/3390/3593/5592
    
    The 2011_1007_RT5390_RT5392_Linux_STA_V2.5.0.3_DPO
    driver enables PCIe wakeup for these chips as well.
    Do the same in rt2x00.
    
    References:
      rt28xx_init in common/rtmp_init_intf.c
      RTMPInitPCIeLinkCtrlValue in os/linux/rt_rbus_pci_drv.c
    
    Signed-off-by: Gabor Juhos <juhosg@openwrt.org>
    Signed-off-by: John W. Linville <linville@tuxdriver.com>

commit 0e56dacdda49940ff6e24e504f11468a27922416
Author: Michael Ellerman <michael@ellerman.id.au>
Date:   Tue Aug 6 17:42:35 2013 +1000

    selftests: Add infrastructure for powerpc selftests
    
    This commit adds a powerpc subdirectory to tools/testing/selftests,
    for tests that are powerpc specific.
    
    On other architectures nothing is built. The makefile supports cross
    compilation if the user sets ARCH and CROSS_COMPILE.
    
    Signed-off-by: Michael Ellerman <michael@ellerman.id.au>
    Signed-off-by: Benjamin Herrenschmidt <benh@kernel.crashing.org>

commit e2e077cdde5c6b0c7145849afcf0780e08190311
Author: Paul Gortmaker <paul.gortmaker@windriver.com>
Date:   Thu Jul 4 01:39:11 2013 -0400

    power_supply: Make goldfish_battery depend on GOLDFISH || COMPILE_TEST
    
    Nearly all the other goldfish peripherals (mtd, keyboard, etc) have a
    dependency on the main platform's GOLDFISH Kconfig item, but this one got
    skipped.  Even with consistency as a justification, there was initial
    resistance[1] from some people to adding it however, as they wanted the
    extra compile coverage.
    
    Now, with CONFIG_COMPILE_TEST, we have the middle ground that will give
    people the coverage who want it, and let those who don't want it to skip
    ever seeing the option presented.
    
    [1] https://lkml.org/lkml/2013/2/27/333
    
    Cc: David Woodhouse <dwmw2@infradead.org>
    Cc: Jiri Slaby <jslaby@suse.cz>
    Cc: Greg Kroah-Hartman <gregkh@linuxfoundation.org>
    Signed-off-by: Paul Gortmaker <paul.gortmaker@windriver.com>
    Signed-off-by: Anton Vorontsov <anton@enomsg.org>

commit f31dd9443afd35696a833c2a32d584a9257abd40
Author: Minghuan Lian <Minghuan.Lian@freescale.com>
Date:   Fri Jun 21 18:59:14 2013 +0800

    powerpc/fsl_msi: add MSIIR1 support for MPIC v4.3
    
    The original MPIC MSI bank contains 8 registers, MPIC v4.3 MSI bank
    contains 16 registers, and this patch adds NR_MSI_REG_MAX and
    NR_MSI_IRQS_MAX to describe the maximum capability of MSI bank.
    MPIC v4.3 provides MSIIR1 to index these 16 MSI registers. MSIIR1
    uses different bits definition than MSIIR. This patch adds
    ibs_shift and srs_shift to indicate the bits definition of the
    MSIIR and MSIIR1, so the same code can handle the MSIIR and MSIIR1
    simultaneously.
    
    Signed-off-by: Minghuan Lian <Minghuan.Lian@freescale.com>
    [scottwood@freescale.com: reinstated static on all_avail]
    Signed-off-by: Scott Wood <scottwood@freescale.com>

commit 6d854acd24e152254bff798d90b1592cc5956521
Author: Minghuan Lian <Minghuan.Lian@freescale.com>
Date:   Fri Jun 21 18:59:13 2013 +0800

    powerpc/dts: add MPIC v4.3 dts node
    
    For the latest platform T4 and B4, MPIC controller has been updated
    to v4.3. This patch adds a new file to describe the latest MPIC.
    The MSI blocks number is increased to four, the registers number
    of each block is increased to sixteen. MSIIR1 has been added to
    access these sixteen MSI registers.
    
    Signed-off-by: Minghuan Lian <Minghuan.Lian@freescale.com>
    Signed-off-by: Scott Wood <scottwood@freescale.com>

commit 03daa99ef50873651e363fc12ae0b5facdb3f831
Author: Minghuan Lian <Minghuan.Lian@freescale.com>
Date:   Fri Jun 21 18:59:12 2013 +0800

    powerpc/dts: update MSI bindings doc for MPIC v4.3
    
    Add compatible "fsl,mpic-msi-v4.3" for MPIC v4.3. MPIC v4.3 contains
    MSIIR and MSIIR1. MSIIR supports 8 MSI registers and MSIIR1 supports
    16 MSI registers, but uses different IBS and SRS shift. When using
    MSIR1, the interrupt number is not consecutive. It is hard to use
    'msi-available-ranges' to describe the ranges of the available
    interrupt, so MPIC v4.3 does not support this property.
    
    Signed-off-by: Minghuan Lian <Minghuan.Lian@freescale.com>
    [scottwood@freescale.com: minor grammar fixes]
    Signed-off-by: Scott Wood <scottwood@freescale.com>

commit df1024ad87286c5935d4ebb5153bf4cebf45eb8a
Author: Hongtao Jia <hongtao.jia@freescale.com>
Date:   Tue Jul 2 09:36:37 2013 +0800

    powerpc/msi: Fix compile error on mpc83xx
    
    mpic_get_primary_version() is not defined when not using MPIC.
    The compile error log like:
    
    arch/powerpc/sysdev/built-in.o: In function `fsl_of_msi_probe':
    fsl_msi.c:(.text+0x150c): undefined reference to `fsl_mpic_primary_get_version'
    
    Signed-off-by: Jia Hongtao <hongtao.jia@freescale.com>
    Signed-off-by: Scott Wood <scottwood@freescale.com>

commit cecb977e24da1465cdb0ff2d10d22e5891dc3e6c
Author: Joonsoo Kim <iamjoonsoo.kim@lge.com>
Date:   Tue Jul 16 10:03:34 2013 +0900

    Revert "tools lib lk: Fix for cross build"
    
    This reverts commit 079787f209416416383c74ea5d5044be2d586f5e.
    
    Below commit already resolve a cross build problem.
    I have been noticed this too lately.
    
        commit 3c4797d46c14fa0c7cf733a77bd4b28875078b53
        Author: Rabin Vincent <rabin@rab.in>
        Date:   Fri May 17 22:27:44 2013 +0200
    
        tools lib lk: Respect CROSS_COMPILE
    
        Make lk use CROSS_COMPILE, in order to be able to cross compile perf
        again.
    
    Signed-off-by: Joonsoo Kim <iamjoonsoo.kim@lge.com>
    Cc: Ingo Molnar <mingo@redhat.com>
    Cc: Namhyung Kim <namhyung@kernel.org>
    Cc: Paul Mackerras <paulus@samba.org>
    Cc: Peter Zijlstra <a.p.zijlstra@chello.nl>
    Link: http://lkml.kernel.org/r/1373936614-22224-1-git-send-email-iamjoonsoo.kim@lge.com
    Signed-off-by: Arnaldo Carvalho de Melo <acme@redhat.com>

commit cc61591e45c0457139ddd4cd7e57f75928acaaf2
Author: Magnus Damm <damm@opensource.se>
Date:   Thu Aug 1 03:38:18 2013 +0900

    ARM: shmobile: Introduce per-CPU SMP boot / sleep code
    
    Add per-CPU SMP boot / sleep code that can be used by all
    SoCs included in mach-shmobile.
    
    The boot code reads out the per-CPU MPIDR id value and
    matches it with the value stored for any CPU number, and
    if there is a match and the boot function is set as well
    then the boot function will be executed.
    
    The sleep code simply uses WFI and then jumps back to the
    boot code to see if anyone has asked to wake up that CPU,
    if not it will sleep again.
    
    Signed-off-by: Magnus Damm <damm@opensource.se>
    [horms+renesas@verge.net.au: Remove trailing whitespace]
    Signed-off-by: Simon Horman <horms+renesas@verge.net.au>

commit 1c33be57496d927ce05b2513ff0c108f69db4345
Author: Nicolas Pitre <nicolas.pitre@linaro.org>
Date:   Thu Apr 12 02:56:10 2012 -0400

    ARM: b.L: core switcher code
    
    This is the core code implementing big.LITTLE switcher functionality.
    Rationale for this code is available here:
    
    http://lwn.net/Articles/481055/
    
    The main entry point for a switch request is:
    
    void bL_switch_request(unsigned int cpu, unsigned int new_cluster_id)
    
    If the calling CPU is not the wanted one, this wrapper takes care of
    sending the request to the appropriate CPU with schedule_work_on().
    
    At the moment the core switch operation is handled by bL_switch_to()
    which must be called on the CPU for which a switch is requested.
    
    What this code does:
    
      * Return early if the current cluster is the wanted one.
    
      * Close the gate in the kernel entry vector for both the inbound
        and outbound CPUs.
    
      * Wake up the inbound CPU so it can perform its reset sequence in
        parallel up to the kernel entry vector gate.
    
      * Migrate all interrupts in the GIC targeting the outbound CPU
        interface to the inbound CPU interface, including SGIs. This is
        performed by gic_migrate_target() in drivers/irqchip/irq-gic.c.
    
      * Call cpu_pm_enter() which takes care of flushing the VFP state to
        RAM and save the CPU interface config from the GIC to RAM.
    
      * Modify the cpu_logical_map to refer to the inbound physical CPU.
    
      * Call cpu_suspend() which saves the CPU state (general purpose
        registers, page table address) onto the stack and store the
        resulting stack pointer in an array indexed by the updated
        cpu_logical_map, then call the provided shutdown function.
        This happens in arch/arm/kernel/sleep.S.
    
    At this point, the provided shutdown function executed by the outbound
    CPU ungates the inbound CPU. Therefore the inbound CPU:
    
      * Picks up the saved stack pointer in the array indexed by its MPIDR
        in arch/arm/kernel/sleep.S.
    
      * The MMU and caches are re-enabled using the saved state on the
        provided stack, just like if this was a resume operation from a
        suspended state.
    
      * Then cpu_suspend() returns, although this is on the inbound CPU
        rather than the outbound CPU which called it initially.
    
      * The function cpu_pm_exit() is called which effect is to restore the
        CPU interface state in the GIC using the state previously saved by
        the outbound CPU.
    
      * Exit of bL_switch_to() to resume normal kernel execution on the
        new CPU.
    
    However, the outbound CPU is potentially still running in parallel while
    the inbound CPU is resuming normal kernel execution, hence we need
    per CPU stack isolation to execute bL_do_switch().  After the outbound
    CPU has ungated the inbound CPU, it calls mcpm_cpu_power_down() to:
    
      * Clean its L1 cache.
    
      * If it is the last CPU still alive in its cluster (last man standing),
        it also cleans its L2 cache and disables cache snooping from the other
        cluster.
    
      * Power down the CPU (or whole cluster).
    
    Code called from bL_do_switch() might end up referencing 'current' for
    some reasons.  However, 'current' is derived from the stack pointer.
    With any arbitrary stack, the returned value for 'current' and any
    dereferenced values through it are just random garbage which may lead to
    segmentation faults.
    
    The active page table during the execution of bL_do_switch() is also a
    problem.  There is no guarantee that the inbound CPU won't destroy the
    corresponding task which would free the attached page table while the
    outbound CPU is still running and relying on it.
    
    To solve both issues, we borrow some of the task space belonging to
    the init/idle task which, by its nature, is lightly used and therefore
    is unlikely to clash with our usage.  The init task is also never going
    away.
    
    Right now the logical CPU number is assumed to be equivalent to the
    physical CPU number within each cluster. The kernel should also be
    booted with only one cluster active.  These limitations will be lifted
    eventually.
    
    Signed-off-by: Nicolas Pitre <nico@linaro.org>

commit 71a8986d7e4845b6fca1298fe6e3233ce6fde0b7
Author: Nicolas Pitre <nicolas.pitre@linaro.org>
Date:   Thu Jul 18 16:50:59 2013 -0400

    ARM: suspend: use hash of cpu_logical_map value to index into save array
    
    Currently we hash the MPIDR of the CPU being suspended to determine which
    entry in the sleep_save_sp array to use. In some situations, such as when
    we want to resume on another physical CPU, the MPIDR of another CPU should
    be used instead.
    
    So let's use the value of cpu_logical_map(smp_processor_id()) in place
    of the MPIDR in the suspend path.  This will result in the same index
    being used as with the previous code unless the caller has modified
    cpu_logical_map() beforehand with the MPIDR of the physical CPU the
    suspending logical CPU will resume on.
    
    Consequently, if doing a physical CPU migration, cpu_logical_map() must
    be updated appropriately somewhere between cpu_pm_enter() and
    cpu_suspend().
    
    The register allocation in __cpu_suspend is reworked in order to better
    accommodate the additional argument.
    
    Signed-off-by: Nicolas Pitre <nico@linaro.org>
    Acked-by: Lorenzo Pieralisi <lorenzo.pieralisi@arm.com>
    Reviewed-by: Dave Martin <Dave.Martin@arm.com>

commit dd1053a93fdc11d491f5460f7da5ce70e6c93c9e
Author: Mark Brown <broonie@linaro.org>
Date:   Fri Jul 5 19:42:58 2013 +0100

    spi/drivers: Enable build of drivers with COMPILE_TEST
    
    Enable the build of drivers which don't have any real build time
    dependency on their architecture or platform with COMPILE_TEST,
    providing better build time coverage.
    
    Signed-off-by: Mark Brown <broonie@linaro.org>

commit 72ffadbae16297ac86e31c759450e0e395209903
Author: Sreekanth Reddy <Sreekanth.Reddy@lsi.com>
Date:   Sat Jun 29 03:53:02 2013 +0530

    SCSI: mpt3sas: Infinite loops can occur if MPI2_IOCSTATUS_CONFIG_INVALID_PAGE is not returned
    
    commit 14be49ac965ebd3f8561d57e01ddb22f93f9b454 upstream.
    
    Infinite loop can occur if IOCStatus is not equal to
    MPI2_IOCSTATUS_CONFIG_INVALID_PAGE value in the while loops in functions
    _scsih_search_responding_sas_devices,
    _scsih_search_responding_raid_devices and
    _scsih_search_responding_expanders
    
    So, Instead of checking for MPI2_IOCSTATUS_CONFIG_INVALID_PAGE value,
    in this patch code is modified to check for IOCStatus not equals to
    MPI2_IOCSTATUS_SUCCESS to break the while loop.
    
    Signed-off-by: Sreekanth Reddy <Sreekanth.Reddy@lsi.com>
    Signed-off-by: James Bottomley <JBottomley@Parallels.com>
    Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>

commit e4498ad1ef9c7b3673efbeef5af0a3ef61a0ce07
Author: Sreekanth Reddy <Sreekanth.Reddy@lsi.com>
Date:   Sat Feb 2 00:56:18 2013 +0530

    mpt2sas: Fix for device scan following host reset could get stuck in a infinite loop
    
    commit 6241f22ca12a26ee149cbe31b27bac97dbdc8bc4 upstream.
    
    Modified device scan routine so each configuration page read breaks from the
    while loop when the ioc_status is not equal to MPI2_IOCSTATUS_SUCCESS.
    
    [jejb: checkpatch fixes]
    Signed-off-by: Sreekanth Reddy <Sreekanth.Reddy@lsi.com>
    Signed-off-by: James Bottomley <JBottomley@Parallels.com>
    [bwh: Backported to 3.2; adjust context]
    Signed-off-by: Ben Hutchings <ben@decadent.org.uk>

commit 2f2a0c70ce70572b517b7d2b5c68b7c9819fe3ff
Author: Uwe Kleine-Knig <u.kleine-koenig@pengutronix.de>
Date:   Wed Jul 17 08:48:41 2013 +0200

    serial/efm32-uart: use COMPILE_TEST symbol to extend compile test coverage
    
    The driver fails to build on x86 because writel_relaxed isn't available
    there. That function exists on arm, arm64, avr32, hexagon, mips and sh,
    but adding all these is overkill so stick to arm only.
    
    Signed-off-by: Uwe Kleine-Knig <u.kleine-koenig@pengutronix.de>
    Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>

commit 4e682bbd32708f3eab55b66960933b36bc00e31a
Author: Paul Gortmaker <paul.gortmaker@windriver.com>
Date:   Thu Jul 4 01:39:10 2013 -0400

    usb: limit OMAP related USB options to OMAP2PLUS platforms
    
    commit 57f6ce072e35770a63be0c5d5e82f90d8da7d665 ("usb: phy:
    add a new driver for usb3 phy") added the new Kconfig option
    OMAP_USB3, but it had no dependencies whatsoever, and hence
    became available across all arch/platforms.
    
    Which presumably caused this to show up in x86 randconfig:
    
        warning: (USB_MUSB_HDRC && OMAP_USB3) selects \
            OMAP_CONTROL_USB which has unmet direct \
            dependencies (USB_SUPPORT && ARCH_OMAP2PLUS)
    
    Then commit 6992819feb39cb9adac72170555d957d07f869f2 ("usb: phy:
    fix Kconfig warning") was added.  However, this just deleted the
    ARCH_OMAP2PLUS dependency from OMAP_CONTROL_USB, further
    compounding the problem by opening up OMAP_CONTROL_USB to
    all arch/platforms as well.
    
    Earlier it was suggested[1] that we revert the change of 6992819feb
    to restore the dependency, and add a same ARCH_OMAP2PLUS dependency
    to the new OMAP_USB3 entry.  However that was discouraged on the
    grounds of people wanting the extra sanity compile testing on x86,
    even though the driver could probably never be used there.
    
    Now we have CONFIG_COMPILE_TEST, so developers who value the ability
    to compile drivers on an architecture that it never can be used for
    can have that, and people who want dependencies to shield them from
    seeing options that aren't relevant to their platform get what they
    want too.
    
    Here we restore the dependency but couple it with COMPILE_TEST, in
    order to achieve both of the above goals.
    
    [1] https://patchwork.kernel.org/patch/2194511/
    
    Acked-by: Felipe Balbi <balbi@ti.com>
    Cc: Kishon Vijay Abraham I <kishon@ti.com>
    Cc: Moiz Sonasath <m-sonasath@ti.com>
    Cc: Jiri Slaby <jslaby@suse.cz>
    Signed-off-by: Paul Gortmaker <paul.gortmaker@windriver.com>
    Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>

commit f0e61604d747bf541808a1ebde6eeaef57e904e4
Author: Jiri Slaby <jslaby@suse.cz>
Date:   Fri Jul 19 08:26:09 2013 +0200

    net: pch_gbe depends on x86
    
    Since 4bb1667255a86360721291fe59991d033bbc2f2a (build some drivers only
    when compile-testing), PTP_1588_CLOCK_PCH depends on (X86 ||
    COMPILE_TEST). But PCH_GBE selects PTP_1588_CLOCK_PCH without
    depending on x86. Fix this by adding the same dependency here.
    
    Signed-off-by: Jiri Slaby <jslaby@suse.cz>
    Reported-by: <fengguang.wu@intel.com> [intel's build test robot]
    Cc: "David S. Miller" <davem@davemloft.net>
    Cc: Ben Hutchings <ben@decadent.org.uk>
    Cc: netdev@vger.kernel.org
    Cc: Greg Kroah-Hartman <gregkh@linuxfoundation.org>
    Cc: kbuild-all@01.org
    Signed-off-by: David S. Miller <davem@davemloft.net>

commit 8ccbc3ebe9a74f22c4f0acb363962f4e7c99d3cf
Author: Mark Brown <broonie@linaro.org>
Date:   Mon Jul 15 17:04:47 2013 +0100

    ASoC: mxs: Enable COMPILE_TEST builds
    
    Since DT based boards don't have any dependency on arch/arm enable them
    if COMPILE_TEST is enabled.
    
    Signed-off-by: Mark Brown <broonie@linaro.org>

commit 22abf843af0686a58b2b6b33d02388d4bbbbcd25
Author: Mark Brown <broonie@linaro.org>
Date:   Mon Jul 15 17:09:40 2013 +0100

    ASoC: tegra: Enable COMPILE_TEST builds
    
    Since there is no architecture dependency in the code allow it to be built
    on any platform when COMPILE_TEST is enabled.
    
    Signed-off-by: Mark Brown <broonie@linaro.org>
    Acked-by: Stephen Warren <swarren@nvidia.com>

commit b0e0a4d6faaa0415ecc1fa6b9a08dd17df05edad
Author: Mark Brown <broonie@linaro.org>
Date:   Mon Jul 15 16:56:32 2013 +0100

    ASoC: omap: Enable COMPILE_TEST build for DT platforms
    
    The DT platforms don't have any source dependency on any OMAP stuff so
    allow them to be built when COMPILE_TEST is enabled.
    
    Signed-off-by: Mark Brown <broonie@linaro.org>
    Acked-by: Peter Ujfalusi <peter.ujfalusi@ti.com>

commit a1df5c2b310ff88cad66de6d55c06d4ad3b9684b
Author: Mark Brown <broonie@linaro.org>
Date:   Mon Jul 15 17:03:18 2013 +0100

    ASoC: imx: Enable COMPILE_TEST builds
    
    Since DT based boards don't have any dependency on arch/arm enable them
    if COMPILE_TEST is enabled.
    
    Signed-off-by: Mark Brown <broonie@linaro.org>
    Acked-by: Shawn Guo <shawn.guo@linaro.org>

commit 30d3924852c7b07df4e015610aca1cafa5c15cab
Author: Mark Brown <broonie@linaro.org>
Date:   Mon Jul 15 16:40:18 2013 +0100

    ASoC: kirkwood: Enable build on non-Kirkwood platforms
    
    Improve build coverage by enabling build on other platforms if COMPILE_TEST
    is enabled.
    
    Signed-off-by: Mark Brown <broonie@linaro.org>

commit 64b0c282e87948bc0c5a1b94ca3d4dd9f6415c6f
Author: Mark Brown <broonie@linaro.org>
Date:   Tue Jun 25 11:00:06 2013 +0100

    ASoC: codecs: Make ALL_CODECS depend on COMPILE_TEST
    
    The main function of the option is to enable compile testing.  There is
    still an option since COMPILE_TEST is intended to enable selection of
    extra drivers rather than forcing them on.
    
    Signed-off-by: Mark Brown <broonie@kernel.org>

commit 17263e754d87fac1be2825b43d984f594a68845e
Author: Sreekanth Reddy <Sreekanth.Reddy@lsi.com>
Date:   Sat Jun 29 03:54:07 2013 +0530

    [SCSI] mpt3sas: MPI2.5 Rev F v2.5.1.1 specification
    
    Change set in MPI v2.5 Rev F(v2.5.1.1) specification and 2.00.29 header files
    
    1. Added a bit to the IOCExceptions field of the IOCFacts Reply to indicate
       that the IOC detected a partial memory failure.
    2. Added ElapsedSeconds field to RAID Volume Indicator Structure. Added
       Elapsed Seconds Valid flag to Flags field of this structure.
    3. Added ElapsedSeconds field to Integrated RAID Operations Status Event Data.
    4. Added two new AbortType values for TargetModeAbort Request, one to abort
       all I/Os from a single initiator, and the other to abort only Command IUs.
    5. Added a new chapter covering DMA Flags and Multicast Modes.
    6. In the IOCSettings field of BIOS Page 1, modified the Adapter Support bits
       description to specify X86 BIOS.
    7. Marked bit 0 of the ControlFlags field of SAS IO Unit Page 1 as
       obsolete. This was the Clear SATA Affiliation flag.
    8. Added additional requirements for certain IOCs that support more than eight
       MSI-x vectors.
    
    Signed-off-by: Sreekanth Reddy <Sreekanth.Reddy@lsi.com>
    Signed-off-by: James Bottomley <JBottomley@Parallels.com>

commit 14be49ac965ebd3f8561d57e01ddb22f93f9b454
Author: Sreekanth Reddy <Sreekanth.Reddy@lsi.com>
Date:   Sat Jun 29 03:53:02 2013 +0530

    [SCSI] mpt3sas: Infinite loops can occur if MPI2_IOCSTATUS_CONFIG_INVALID_PAGE is not returned
    
    Infinite loop can occur if IOCStatus is not equal to
    MPI2_IOCSTATUS_CONFIG_INVALID_PAGE value in the while loops in functions
    _scsih_search_responding_sas_devices,
    _scsih_search_responding_raid_devices and
    _scsih_search_responding_expanders
    
    So, Instead of checking for MPI2_IOCSTATUS_CONFIG_INVALID_PAGE value,
    in this patch code is modified to check for IOCStatus not equals to
    MPI2_IOCSTATUS_SUCCESS to break the while loop.
    
    Signed-off-by: Sreekanth Reddy <Sreekanth.Reddy@lsi.com>
    Cc: stable@vger.kernel.org
    Signed-off-by: James Bottomley <JBottomley@Parallels.com>

commit 079787f209416416383c74ea5d5044be2d586f5e
Author: Joonsoo Kim <iamjoonsoo.kim@lge.com>
Date:   Wed Jun 19 10:02:29 2013 +0900

    tools lib lk: Fix for cross build
    
    Currently, lib lk doesn't use CROSS_COMPILE environment variable, so
    cross build always fails.
    
    This is a quick fix for this problem.
    
    Signed-off-by: Joonsoo Kim <iamjoonsoo.kim@lge.com>
    Cc: Ingo Molnar <mingo@redhat.com>
    Cc: Namhyung Kim <namhyung@kernel.org>
    Cc: Paul Mackerras <paulus@samba.org>
    Cc: Peter Zijlstra <a.p.zijlstra@chello.nl>
    Link: http://lkml.kernel.org/r/1371603750-15053-2-git-send-email-iamjoonsoo.kim@lge.com
    Signed-off-by: Arnaldo Carvalho de Melo <acme@redhat.com>

commit 65b97fb7303050fc826e518cf67fc283da23314f
Merge: ddcf6600b133 1d8b368ab4aa
Author: Linus Torvalds <torvalds@linux-foundation.org>
Date:   Thu Jul 4 10:29:23 2013 -0700

    Merge branch 'next' of git://git.kernel.org/pub/scm/linux/kernel/git/benh/powerpc
    
    Pull powerpc updates from Ben Herrenschmidt:
     "This is the powerpc changes for the 3.11 merge window.  In addition to
      the usual bug fixes and small updates, the main highlights are:
    
       - Support for transparent huge pages by Aneesh Kumar for 64-bit
         server processors.  This allows the use of 16M pages as transparent
         huge pages on kernels compiled with a 64K base page size.
    
       - Base VFIO support for KVM on power by Alexey Kardashevskiy
    
       - Wiring up of our nvram to the pstore infrastructure, including
         putting compressed oopses in there by Aruna Balakrishnaiah
    
       - Move, rework and improve our "EEH" (basically PCI error handling
         and recovery) infrastructure.  It is no longer specific to pseries
         but is now usable by the new "powernv" platform as well (no
         hypervisor) by Gavin Shan.
    
       - I fixed some bugs in our math-emu instruction decoding and made it
         usable to emulate some optional FP instructions on processors with
         hard FP that lack them (such as fsqrt on Freescale embedded
         processors).
    
       - Support for Power8 "Event Based Branch" facility by Michael
         Ellerman.  This facility allows what is basically "userspace
         interrupts" for performance monitor events.
    
       - A bunch of Transactional Memory vs.  Signals bug fixes and HW
         breakpoint/watchpoint fixes by Michael Neuling.
    
      And more ...  I appologize in advance if I've failed to highlight
      something that somebody deemed worth it."
    
    * 'next' of git://git.kernel.org/pub/scm/linux/kernel/git/benh/powerpc: (156 commits)
      pstore: Add hsize argument in write_buf call of pstore_ftrace_call
      powerpc/fsl: add MPIC timer wakeup support
      powerpc/mpic: create mpic subsystem object
      powerpc/mpic: add global timer support
      powerpc/mpic: add irq_set_wake support
      powerpc/85xx: enable coreint for all the 64bit boards
      powerpc/8xx: Erroneous double irq_eoi() on CPM IRQ in MPC8xx
      powerpc/fsl: Enable CONFIG_E1000E in mpc85xx_smp_defconfig
      powerpc/mpic: Add get_version API both for internal and external use
      powerpc: Handle both new style and old style reserve maps
      powerpc/hw_brk: Fix off by one error when validating DAWR region end
      powerpc/pseries: Support compression of oops text via pstore
      powerpc/pseries: Re-organise the oops compression code
      pstore: Pass header size in the pstore write callback
      powerpc/powernv: Fix iommu initialization again
      powerpc/pseries: Inform the hypervisor we are using EBB regs
      powerpc/perf: Add power8 EBB support
      powerpc/perf: Core EBB support for 64-bit book3s
      powerpc/perf: Drop MMCRA from thread_struct
      powerpc/perf: Don't enable if we have zero events
      ...

commit fb2af0020a51709ad87ea8055c325d3fbde04158
Merge: 790eac5640ab 3c0c01ab742d
Author: Linus Torvalds <torvalds@linux-foundation.org>
Date:   Wed Jul 3 09:46:29 2013 -0700

    Merge branch 'for-linus' of git://git.linaro.org/people/rmk/linux-arm
    
    Pull ARM updates from Russell King:
     "This contains the usual updates from other people (listed below) and
      the usual random muddle of miscellaneous ARM updates which cover some
      low priority bug fixes and performance improvements.
    
      I've started to put the pull request wording into the merge commits,
      which are:
    
       - NoMMU stuff:
    
         This includes the following series sent earlier to the list:
          - nommu-fixes
          - R7 Support
          - MPU support
    
         I've left out the ARCH_MULTIPLATFORM/!MMU stuff that Arnd and I
         were discussing today until we've reached a conclusion/that's had
         some more review.
    
         This is rebased (and re-tested) on your devel-stable branch because
         otherwise there were going to be conflicts with Uwe's V7M work now
         that you've merged that.  I've included the fix for limiting MPU to
         CPU_V7.
    
       - Huge page support
    
         These changes bring both HugeTLB support and Transparent HugePage
         (THP) support to ARM.  Only long descriptors (LPAE) are supported
         in this series.
    
         The code has been tested on an Arndale board (Exynos 5250).
    
       - LPAE updates
    
         Please pull these miscellaneous LPAE fixes I've been collecting for
         a while now for 3.11.  They've been tested and reviewed by quite a
         few people, and most of the patches are pretty trivial.  -- Will Deacon.
    
       - arch_timer cleanups
    
         Please pull these arch_timer cleanups I've been holding onto for a
         while.  They're the same as my last posting, but have been rebased
         to v3.10-rc3.
    
       - mpidr linearisation (multiprocessor id register - identifies which
         CPU number we are in the system)
    
         This patch series that implements MPIDR linearization through a
         simple hashing algorithm and updates current cpu_{suspend}/{resume}
         code to use the newly created hash structures to retrieve context
         pointers.  It represents a stepping stone for the implementation of
         power management code on forthcoming multi-cluster ARM systems.
    
         It has been tested on TC2 (dual cluster A15xA7 system), iMX6q,
         OMAP4 and Tegra, with processors hitting low-power states requiring
         warm-boot resume through the cpu_resume code path"
    
    * 'for-linus' of git://git.linaro.org/people/rmk/linux-arm: (77 commits)
      ARM: 7775/1: mm: Remove do_sect_fault from LPAE code
      ARM: 7777/1: Avoid extra calls to the C compiler
      ARM: 7774/1: Fix dtb dependency to use order-only prerequisites
      ARM: 7770/1: remove residual ARMv2 support from decompressor
      ARM: 7769/1: Cortex-A15: fix erratum 798181 implementation
      ARM: 7768/1: prevent risks of out-of-bound access in ASID allocator
      ARM: 7767/1: let the ASID allocator handle suspended animation
      ARM: 7766/1: versatile: don't mark pen as __INIT
      ARM: 7765/1: perf: Record the user-mode PC in the call chain.
      ARM: 7735/2: Preserve the user r/w register TPIDRURW on context switch and fork
      ARM: kernel: implement stack pointer save array through MPIDR hashing
      ARM: kernel: build MPIDR hash function data structure
      ARM: mpu: Ensure that MPU depends on CPU_V7
      ARM: mpu: protect the vectors page with an MPU region
      ARM: mpu: Allow enabling of the MPU via kconfig
      ARM: 7758/1: introduce config HAS_BANDGAP
      ARM: 7757/1: mm: don't flush icache in switch_mm with hardware broadcasting
      ARM: 7751/1: zImage: don't overwrite ourself with a page table
      ARM: 7749/1: spinlock: retry trylock operation if strex fails on free lock
      ARM: 7748/1: oabi: handle faults when loading swi instruction from userspace
      ...

commit f0bb4c0ab064a8aeeffbda1cee380151a594eaab
Merge: a4883ef6af5e 983433b5812c
Author: Linus Torvalds <torvalds@linux-foundation.org>
Date:   Tue Jul 2 16:15:23 2013 -0700

    Merge branch 'perf-core-for-linus' of git://git.kernel.org/pub/scm/linux/kernel/git/tip/tip
    
    Pull perf updates from Ingo Molnar:
     "Kernel improvements:
    
       - watchdog driver improvements by Li Zefan
       - Power7 CPI stack events related improvements by Sukadev Bhattiprolu
       - event multiplexing via hrtimers and other improvements by Stephane
         Eranian
       - kernel stack use optimization by Andrew Hunter
       - AMD IOMMU uncore PMU support by Suravee Suthikulpanit
       - NMI handling rate-limits by Dave Hansen
       - various hw_breakpoint fixes by Oleg Nesterov
       - hw_breakpoint overflow period sampling and related signal handling
         fixes by Jiri Olsa
       - Intel Haswell PMU support by Andi Kleen
    
      Tooling improvements:
    
       - Reset SIGTERM handler in workload child process, fix from David
         Ahern.
       - Makefile reorganization, prep work for Kconfig patches, from Jiri
         Olsa.
       - Add automated make test suite, from Jiri Olsa.
       - Add --percent-limit option to 'top' and 'report', from Namhyung
         Kim.
       - Sorting improvements, from Namhyung Kim.
       - Expand definition of sysfs format attribute, from Michael Ellerman.
    
      Tooling fixes:
    
       - 'perf tests' fixes from Jiri Olsa.
       - Make Power7 CPI stack events available in sysfs, from Sukadev
         Bhattiprolu.
       - Handle death by SIGTERM in 'perf record', fix from David Ahern.
       - Fix printing of perf_event_paranoid message, from David Ahern.
       - Handle realloc failures in 'perf kvm', from David Ahern.
       - Fix divide by 0 in variance, from David Ahern.
       - Save parent pid in thread struct, from David Ahern.
       - Handle JITed code in shared memory, from Andi Kleen.
       - Fixes for 'perf diff', from Jiri Olsa.
       - Remove some unused struct members, from Jiri Olsa.
       - Add missing liblk.a dependency for python/perf.so, fix from Jiri
         Olsa.
       - Respect CROSS_COMPILE in liblk.a, from Rabin Vincent.
       - No need to do locking when adding hists in perf report, only 'top'
         needs that, from Namhyung Kim.
       - Fix alignment of symbol column in in the hists browser (top,
         report) when -v is given, from NAmhyung Kim.
       - Fix 'perf top' -E option behavior, from Namhyung Kim.
       - Fix bug in isupper() and islower(), from Sukadev Bhattiprolu.
       - Fix compile errors in bp_signal 'perf test', from Sukadev
         Bhattiprolu.
    
      ... and more things"
    
    * 'perf-core-for-linus' of git://git.kernel.org/pub/scm/linux/kernel/git/tip/tip: (102 commits)
      perf/x86: Disable PEBS-LL in intel_pmu_pebs_disable()
      perf/x86: Fix shared register mutual exclusion enforcement
      perf/x86/intel: Support full width counting
      x86: Add NMI duration tracepoints
      perf: Drop sample rate when sampling is too slow
      x86: Warn when NMI handlers take large amounts of time
      hw_breakpoint: Introduce "struct bp_cpuinfo"
      hw_breakpoint: Simplify *register_wide_hw_breakpoint()
      hw_breakpoint: Introduce cpumask_of_bp()
      hw_breakpoint: Simplify the "weight" usage in toggle_bp_slot() paths
      hw_breakpoint: Simplify list/idx mess in toggle_bp_slot() paths
      perf/x86/intel: Add mem-loads/stores support for Haswell
      perf/x86/intel: Support Haswell/v4 LBR format
      perf/x86/intel: Move NMI clearing to end of PMI handler
      perf/x86/intel: Add Haswell PEBS support
      perf/x86/intel: Add simple Haswell PMU support
      perf/x86/intel: Add Haswell PEBS record support
      perf/x86/intel: Fix sparse warning
      perf/x86/amd: AMD IOMMU Performance Counter PERF uncore PMU implementation
      perf/x86/amd: Add IOMMU Performance Counter resource management
      ...

commit a63b3bc7db32b63bfe5f48fa8582f931db81c86e
Author: Dongsheng.wang@freescale.com <Dongsheng.wang@freescale.com>
Date:   Tue Apr 9 10:22:32 2013 +0800

    powerpc/fsl: add MPIC timer wakeup support
    
    The driver provides a way to wake up the system by the MPIC timer.
    
    For example,
    echo 5 > /sys/devices/system/mpic/timer_wakeup
    echo standby > /sys/power/state
    
    After 5 seconds the MPIC timer will generate an interrupt to wake up
    the system.
    
    Signed-off-by: Wang Dongsheng <dongsheng.wang@freescale.com>
    Signed-off-by: Zhao Chenhui <chenhui.zhao@freescale.com>
    Signed-off-by: Li Yang <leoli@freescale.com>

commit 36ca09be6ff77a4e5b54b8b68ed7be7aa184250b
Author: Dongsheng.wang@freescale.com <Dongsheng.wang@freescale.com>
Date:   Tue Apr 9 10:22:30 2013 +0800

    powerpc/mpic: add global timer support
    
    The MPIC global timer is a hardware timer inside the Freescale PIC complying
    with OpenPIC standard. When the specified interval times out, the hardware
    timer generates an interrupt. The driver currently is only tested on fsl chip,
    but it can potentially support other global timers complying to OpenPIC
    standard.
    
    The two independent groups of global timer on fsl chip, group A and group B,
    are identical in their functionality, except that they appear at different
    locations within the PIC register map. The hardware timer can be cascaded to
    create timers larger than the default 31-bit global timers. Timer cascade
    fields allow configuration of up to two 63-bit timers. But These two groups
    of timers cannot be cascaded together.
    
    It can be used as a wakeup source for low power modes. It also could be used
    as periodical timer for protocols, drivers and etc.
    
    Signed-off-by: Wang Dongsheng <dongsheng.wang@freescale.com>
    Signed-off-by: Li Yang <leoli@freescale.com>
    Signed-off-by: Scott Wood <scottwood@freescale.com>

commit 86d379690c3b005418fafc9afdcdfc731a043862
Author: Hongtao Jia <hongtao.jia@freescale.com>
Date:   Wed Apr 10 10:52:55 2013 +0800

    powerpc/mpic: Add get_version API both for internal and external use
    
    MPIC version is useful information for both mpic_alloc() and mpic_init().
    The patch provide an API to get MPIC version for reusing the code.
    Also, some other IP block may need MPIC version for their own use.
    The API for external use is also provided.
    
    Signed-off-by: Jia Hongtao <hongtao.jia@freescale.com>
    Signed-off-by: Li Yang <leoli@freescale.com>
    Signed-off-by: Scott Wood <scottwood@freescale.com>

commit 1b21376a737aeaa82320ae014b8e1c2c53cfc479
Author: Douglas Anderson <dianders@chromium.org>
Date:   Thu Jun 27 04:32:06 2013 +0100

    ARM: 7777/1: Avoid extra calls to the C compiler
    
    Starting up the C compiler can be a slow operation on some systems.
    Though these calls don't individually take a lot of time, they add up.
    Rearrange the ARM Makefile a bit to avoid extra calls to the compiler
    when they can be easily avoided.
    
    When running with the Chrome OS ARM cross compiler
    "armv7a-cros-linux-gnueabi-", this shaved .55 seconds (from 5.31
    seconds to 4.76 seconds) off an incremental build of the kernel:
      time make -j32 ARCH=arm CROSS_COMPILE=armv7a-cros-linux-gnueabi-
    
    Thanks to Mike Frysinger for the clean trick to make this work.
    
    Signed-off-by: Doug Anderson <dianders@chromium.org>
    Acked-by: Mike Frysinger <vapier@gentoo.org>
    Signed-off-by: Russell King <rmk+kernel@arm.linux.org.uk>

commit 4bb1667255a86360721291fe59991d033bbc2f2a
Author: Jiri Slaby <jslaby@suse.cz>
Date:   Wed May 22 10:56:24 2013 +0200

    build some drivers only when compile-testing
    
    Some drivers can be built on more platforms than they run on. This is
    a burden for users and distributors who package a kernel. They have to
    manually deselect some (for them useless) drivers when updating their
    configs via oldconfig. And yet, sometimes it is even impossible to
    disable the drivers without patching the kernel.
    
    Introduce a new config option COMPILE_TEST and make all those drivers
    to depend on the platform they run on, or on the COMPILE_TEST option.
    Now, when users/distributors choose COMPILE_TEST=n they will not have
    the drivers in their allmodconfig setups, but developers still can
    compile-test them with COMPILE_TEST=y.
    
    Now the drivers where we use this new option:
    * PTP_1588_CLOCK_PCH: The PCH EG20T is only compatible with Intel Atom
      processors so it should depend on x86.
    * FB_GEODE: Geode is 32-bit only so only enable it for X86_32.
    * USB_CHIPIDEA_IMX: The OF_DEVICE dependency will be met on powerpc
      systems -- which do not actually support the hardware via that
      method.
    * INTEL_MID_PTI: It is specific to the Penwell type of Intel Atom
      device.
    
    [v2]
    * remove EXPERT dependency
    
    [gregkh - remove chipidea portion, as it's incorrect, and also doesn't
     apply to my driver-core tree]
    
    Signed-off-by: Jiri Slaby <jslaby@suse.cz>
    Cc: Andrew Morton <akpm@linux-foundation.org>
    Cc: Linus Torvalds <torvalds@linux-foundation.org>
    Cc: Jeff Mahoney <jeffm@suse.com>
    Cc: Alexander Shishkin <alexander.shishkin@linux.intel.com>
    Cc: linux-usb@vger.kernel.org
    Cc: Florian Tobias Schandinat <FlorianSchandinat@gmx.de>
    Cc: linux-geode@lists.infradead.org
    Cc: linux-fbdev@vger.kernel.org
    Cc: Richard Cochran <richardcochran@gmail.com>
    Cc: netdev@vger.kernel.org
    Cc: Ben Hutchings <ben@decadent.org.uk>
    Cc: "Keller, Jacob E" <jacob.e.keller@intel.com>
    Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>

commit 148124d9310f3870fb016bd2637057841d5b7705
Author: Sreekanth Reddy <Sreekanth.Reddy@lsi.com>
Date:   Fri Feb 1 22:02:04 2013 +0530

    [SCSI] mpt2sas: Calulate the Reply post queue depth calculation as per the MPI spec
    
    [jejb: checkpatch fixes]
    Signed-off-by: Sreekanth Reddy <Sreekanth.Reddy@lsi.com>
    Signed-off-by: James Bottomley <JBottomley@Parallels.com>

commit 6241f22ca12a26ee149cbe31b27bac97dbdc8bc4
Author: Sreekanth Reddy <Sreekanth.Reddy@lsi.com>
Date:   Sat Feb 2 00:56:18 2013 +0530

    [SCSI] mpt2sas: Fix for device scan following host reset could get stuck in a infinite loop
    
    Modified device scan routine so each configuration page read breaks from the
    while loop when the ioc_status is not equal to MPI2_IOCSTATUS_SUCCESS.
    
    [jejb: checkpatch fixes]
    Signed-off-by: Sreekanth Reddy <Sreekanth.Reddy@lsi.com>
    Cc: stable@vger.kernel.org
    Signed-off-by: James Bottomley <JBottomley@Parallels.com>

commit ca6832e91b5d851fca4ea8579915cd2b6c958117
Author: Sreekanth Reddy <Sreekanth.Reddy@lsi.com>
Date:   Fri Feb 1 21:55:43 2013 +0530

    [SCSI] mpt2sas: Update the timing requirements for issuing a Hard Reset
    
    Updated the mpt2sas driver code that issues hard reset to comply with the
    timing requirements mentioned in MPI specifications rev V.
    
    [jejb: checpatch fixes]
    Signed-off-by: Sreekanth Reddy <Sreekanth.Reddy@lsi.com>
    Signed-off-by: James Bottomley <JBottomley@Parallels.com>

commit 10ec24e4ce0356f61a12d79f84996cea3686b926
Author: Sreekanth Reddy <Sreekanth.Reddy@lsi.com>
Date:   Fri Feb 1 21:54:13 2013 +0530

    [SCSI] mpt2sas: MPI2 Rev W (2.00.15) specification
    
    Change set in MPI 2.0 Rev W(2.00.15) specification and 2.00.27 header files
    
    1. Added a bit to the IOCExceptions field of the IOCFacts Reply to indicate
       that the IOC detected a partial memory failure.
    2. Added ElapsedSeconds field to RAID Volume Indicator Structure. Added
       Elapsed Seconds Valid flag to Flags field of this structure.
    3. Added ElapsedSeconds field to Integrated RAID Operations Status Event Data.
    4. In the IOCSettings field of BIOS Page 1, modified the Adapter Support bits
       description to specify X86 BIOS.
    5. Toolbox Diagnostic CLI Tool Request may now use chain elements in the SGL.
    
    Signed-off-by: Sreekanth Reddy <Sreekanth.Reddy@lsi.com>
    Signed-off-by: James Bottomley <JBottomley@Parallels.com>

commit 03ad0025c36f19762595ff9583d2affda9b14852
Merge: fd8957a96d53 7604537bbb57
Author: Russell King <rmk+kernel@arm.linux.org.uk>
Date:   Mon Jun 24 16:20:47 2013 +0100

    Merge branch 'mpidr-updates-for-rmk' of git://linux-arm.org/linux-2.6-lp into devel-stable
    
    This patch series that implements MPIDR linearization through a simple
    hashing algorithm and updates current cpu_{suspend}/{resume} code to use
    the newly created hash structures to retrieve context pointers.  It
    represents a stepping stone for the implementation of power management code
    on forthcoming multi-cluster ARM systems.
    
    It has been tested on TC2 (dual cluster A15xA7 system), iMX6q, OMAP4 and
    Tegra, with processors hitting low-power states requiring warm-boot resume
    through the cpu_resume code path.

commit 18d7f152df31e5a326301fdaad385e40874dff80
Author: Lorenzo Pieralisi <lorenzo.pieralisi@arm.com>
Date:   Wed Jun 19 10:40:48 2013 +0100

    ARM: 7763/1: kernel: fix __cpu_logical_map default initialization
    
    The __cpu_logical_map array is statically initialized to 0, which is a valid
    MPIDR value. To prevent issues with the current implementation, this patch
    defines an MPIDR_INVALID value, and statically initializes the
    __cpu_logical_map[] array to it. Entries in the arm_dt_init_cpu_maps()
    tmp_map array used to stash DT reg properties while parsing DT are initialized
    with the MPIDR_INVALID value as well for consistency.
    
    Signed-off-by: Lorenzo Pieralisi <lorenzo.pieralisi@arm.com>
    Acked-by: Nicolas Pitre <nico@linaro.org>
    Cc: Will Deacon <will.deacon@arm.com>
    Signed-off-by: Russell King <rmk+kernel@arm.linux.org.uk>

commit 7604537bbb5720376e8c9e6bc74a8e6305e3094d
Author: Lorenzo Pieralisi <lorenzo.pieralisi@arm.com>
Date:   Thu May 16 10:34:30 2013 +0100

    ARM: kernel: implement stack pointer save array through MPIDR hashing
    
    Current implementation of cpu_{suspend}/cpu_{resume} relies on the MPIDR
    to index the array of pointers where the context is saved and restored.
    The current approach works as long as the MPIDR can be considered a
    linear index, so that the pointers array can simply be dereferenced by
    using the MPIDR[7:0] value.
    On ARM multi-cluster systems, where the MPIDR may not be a linear index,
    to properly dereference the stack pointer array, a mapping function should
    be applied to it so that it can be used for arrays look-ups.
    
    This patch adds code in the cpu_{suspend}/cpu_{resume} implementation
    that relies on shifting and ORing hashing method to map a MPIDR value to a
    set of buckets precomputed at boot to have a collision free mapping from
    MPIDR to context pointers.
    
    The hashing algorithm must be simple, fast, and implementable with few
    instructions since in the cpu_resume path the mapping is carried out with
    the MMU off and the I-cache off, hence code and data are fetched from DRAM
    with no-caching available. Simplicity is counterbalanced with a little
    increase of memory (allocated dynamically) for stack pointers buckets, that
    should be anyway fairly limited on most systems.
    
    Memory for context pointers is allocated in a early_initcall with
    size precomputed and stashed previously in kernel data structures.
    Memory for context pointers is allocated through kmalloc; this
    guarantees contiguous physical addresses for the allocated memory which
    is fundamental to the correct functioning of the resume mechanism that
    relies on the context pointer array to be a chunk of contiguous physical
    memory. Virtual to physical address conversion for the context pointer
    array base is carried out at boot to avoid fiddling with virt_to_phys
    conversions in the cpu_resume path which is quite fragile and should be
    optimized to execute as few instructions as possible.
    Virtual and physical context pointer base array addresses are stashed in a
    struct that is accessible from assembly using values generated through the
    asm-offsets.c mechanism.
    
    Cc: Will Deacon <will.deacon@arm.com>
    Cc: Catalin Marinas <catalin.marinas@arm.com>
    Cc: Russell King <linux@arm.linux.org.uk>
    Cc: Colin Cross <ccross@android.com>
    Cc: Santosh Shilimkar <santosh.shilimkar@ti.com>
    Cc: Daniel Lezcano <daniel.lezcano@linaro.org>
    Cc: Amit Kucheria <amit.kucheria@linaro.org>
    Signed-off-by: Lorenzo Pieralisi <lorenzo.pieralisi@arm.com>
    Reviewed-by: Dave Martin <Dave.Martin@arm.com>
    Reviewed-by: Nicolas Pitre <nico@linaro.org>
    Tested-by: Shawn Guo <shawn.guo@linaro.org>
    Tested-by: Kevin Hilman <khilman@linaro.org>
    Tested-by: Stephen Warren <swarren@wwwdotorg.org>

commit 8cf72172d739639f2699131821a3ebc291287cf2
Author: Lorenzo Pieralisi <lorenzo.pieralisi@arm.com>
Date:   Thu May 16 10:32:09 2013 +0100

    ARM: kernel: build MPIDR hash function data structure
    
    On ARM SMP systems, cores are identified by their MPIDR register.
    The MPIDR guidelines in the ARM ARM do not provide strict enforcement of
    MPIDR layout, only recommendations that, if followed, split the MPIDR
    on ARM 32 bit platforms in three affinity levels. In multi-cluster
    systems like big.LITTLE, if the affinity guidelines are followed, the
    MPIDR can not be considered an index anymore. This means that the
    association between logical CPU in the kernel and the HW CPU identifier
    becomes somewhat more complicated requiring methods like hashing to
    associate a given MPIDR to a CPU logical index, in order for the look-up
    to be carried out in an efficient and scalable way.
    
    This patch provides a function in the kernel that starting from the
    cpu_logical_map, implement collision-free hashing of MPIDR values by checking
    all significative bits of MPIDR affinity level bitfields. The hashing
    can then be carried out through bits shifting and ORing; the resulting
    hash algorithm is a collision-free though not minimal hash that can be
    executed with few assembly instructions. The mpidr is filtered through a
    mpidr mask that is built by checking all bits that toggle in the set of
    MPIDRs corresponding to possible CPUs. Bits that do not toggle do not carry
    information so they do not contribute to the resulting hash.
    
    Pseudo code:
    
    /* check all bits that toggle, so they are required */
    for (i = 1, mpidr_mask = 0; i < num_possible_cpus(); i++)
            mpidr_mask |= (cpu_logical_map(i) ^ cpu_logical_map(0));
    
    /*
     * Build shifts to be applied to aff0, aff1, aff2 values to hash the mpidr
     * fls() returns the last bit set in a word, 0 if none
     * ffs() returns the first bit set in a word, 0 if none
     */
    fs0 = mpidr_mask[7:0] ? ffs(mpidr_mask[7:0]) - 1 : 0;
    fs1 = mpidr_mask[15:8] ? ffs(mpidr_mask[15:8]) - 1 : 0;
    fs2 = mpidr_mask[23:16] ? ffs(mpidr_mask[23:16]) - 1 : 0;
    ls0 = fls(mpidr_mask[7:0]);
    ls1 = fls(mpidr_mask[15:8]);
    ls2 = fls(mpidr_mask[23:16]);
    bits0 = ls0 - fs0;
    bits1 = ls1 - fs1;
    bits2 = ls2 - fs2;
    aff0_shift = fs0;
    aff1_shift = 8 + fs1 - bits0;
    aff2_shift = 16 + fs2 - (bits0 + bits1);
    u32 hash(u32 mpidr) {
            u32 l0, l1, l2;
            u32 mpidr_masked = mpidr & mpidr_mask;
            l0 = mpidr_masked & 0xff;
            l1 = mpidr_masked & 0xff00;
            l2 = mpidr_masked & 0xff0000;
            return (l0 >> aff0_shift | l1 >> aff1_shift | l2 >> aff2_shift);
    }
    
    The hashing algorithm relies on the inherent properties set in the ARM ARM
    recommendations for the MPIDR. Exotic configurations, where for instance the
    MPIDR values at a given affinity level have large holes, can end up requiring
    big hash tables since the compression of values that can be achieved through
    shifting is somewhat crippled when holes are present. Kernel warns if
    the number of buckets of the resulting hash table exceeds the number of
    possible CPUs by a factor of 4, which is a symptom of a very sparse HW
    MPIDR configuration.
    
    The hash algorithm is quite simple and can easily be implemented in assembly
    code, to be used in code paths where the kernel virtual address space is
    not set-up (ie cpu_resume) and instruction and data fetches are strongly
    ordered so code must be compact and must carry out few data accesses.
    
    Cc: Will Deacon <will.deacon@arm.com>
    Cc: Catalin Marinas <catalin.marinas@arm.com>
    Cc: Russell King <linux@arm.linux.org.uk>
    Cc: Colin Cross <ccross@android.com>
    Cc: Santosh Shilimkar <santosh.shilimkar@ti.com>
    Cc: Daniel Lezcano <daniel.lezcano@linaro.org>
    Cc: Amit Kucheria <amit.kucheria@linaro.org>
    Signed-off-by: Lorenzo Pieralisi <lorenzo.pieralisi@arm.com>
    Reviewed-by: Dave Martin <Dave.Martin@arm.com>
    Reviewed-by: Nicolas Pitre <nico@linaro.org>
    Tested-by: Shawn Guo <shawn.guo@linaro.org>
    Tested-by: Kevin Hilman <khilman@linaro.org>
    Tested-by: Stephen Warren <swarren@wwwdotorg.org>

commit 0305ffd7536270befc3e772bb978a6e3c6d37150
Author: Nicolas Pitre <nicolas.pitre@linaro.org>
Date:   Fri May 31 05:17:29 2013 +0100

    ARM: 7740/1: MCPM: prettify debug output
    
    The CPU and cluster numbers (MPIDR affinity levels 0 and 1) may have
    at most 8 bits each.
    
    Signed-off-by: Nicolas Pitre <nico@linaro.org>
    Signed-off-by: Russell King <rmk+kernel@arm.linux.org.uk>

commit aa3ae6de36c86994c3446bdbc6b69ece9193732a
Merge: 008bd2de9401 badec11b645e
Author: Linus Torvalds <torvalds@linux-foundation.org>
Date:   Sat Jun 1 20:13:16 2013 +0900

    Merge branch 'merge' of git://git.kernel.org/pub/scm/linux/kernel/git/benh/powerpc
    
    Pull powerpc fixes from Ben Herrenschmidt:
     "Here are a few more fixes for powerpc 3.10.  It's a bit more than I
      would have liked this late in the game but I suppose that's what
      happens with a brand new chip generation coming out.
    
      A few regression fixes, some last minute fixes for new P8 features
      such as transactional memory,...
    
      There's also one powerpc KVM patch that I requested that adds two
      missing functions to our in-kernel interrupt controller support which
      is itself a new 3.10 feature.  These are defined by the base
      hypervisor specification.  We didn't implement them originally because
      Linux doesn't use them but they are simple and I'm not comfortable
      having a half-implemented interface in 3.10 and having to deal with
      versionning etc...  later when something starts needing those calls.
      They cannot be emulated in qemu when using in-kernel interrupt
      controller (not enough shared state).
    
      Just added a last minute patch to fix a typo introducing a breakage in
      our cputable for Power7+ processors, sorry about that, but the
      regression it fixes just hurt me :-)"
    
    * 'merge' of git://git.kernel.org/pub/scm/linux/kernel/git/benh/powerpc:
      powerpc/cputable: Fix typo on P7+ cputable entry
      powerpc/perf: Add missing SIER support
      powerpc/perf: Revert to original NO_SIPR logic
      powerpc/pci: Remove the unused variables in pci_process_bridge_OF_ranges
      powerpc/pci: Remove the stale comments of pci_process_bridge_OF_ranges
      powerpc/pseries: Always enable CONFIG_HOTPLUG_CPU on PSERIES SMP
      powerpc/kvm/book3s: Add support for H_IPOLL and H_XIRR_X in XICS emulation
      powerpc/32bit:Store temporary result in r0 instead of r8
      powerpc/mm: Always invalidate tlb on hpte invalidate and update
      powerpc/pseries: Improve stream generation comments in copypage/user
      powerpc/pseries: Kill all prefetch streams on context switch
      powerpc/cputable: Fix oprofile_cpu_type on power8
      powerpc/mpic: Fix irq distribution problem when MPIC_SINGLE_DEST_CPU
      powerpc/tm: Fix userspace stack corruption on signal delivery for active transactions
      powerpc/tm: Move TM abort cause codes to uapi
      powerpc/tm: Abort on emulation and alignment faults
      powerpc/tm: Update cause codes documentation
      powerpc/tm: Make room for hypervisor in abort cause codes

commit e242114afff0a41550e174cd787cdbafd34625de
Author: chenhui zhao <chenhui.zhao@freescale.com>
Date:   Mon May 27 21:59:43 2013 +0000

    powerpc/mpic: Fix irq distribution problem when MPIC_SINGLE_DEST_CPU
    
    For the mpic with a flag MPIC_SINGLE_DEST_CPU, only one bit should be
    set in interrupt destination registers.
    
    The code is applicable to 64-bit platforms as well as 32-bit.
    
    Signed-off-by: Zhao Chenhui <chenhui.zhao@freescale.com>
    Signed-off-by: Benjamin Herrenschmidt <benh@kernel.crashing.org>

commit afb71193a4d8e4a3c4c52a80a8cbee76582f0e90
Merge: c0ffaf3655fa c3c44709b509
Author: Ingo Molnar <mingo@kernel.org>
Date:   Fri May 31 13:03:12 2013 +0200

    Merge tag 'perf-core-for-mingo' of git://git.kernel.org/pub/scm/linux/kernel/git/acme/linux into perf/core
    
    perf/core improvements and fixes:
    
     * Reset SIGTERM handler in workload child process, fix from David Ahern.
    
     * Handle death by SIGTERM in 'perf record', fix from David Ahern.
    
     * Fix printing of perf_event_paranoid message, from David Ahern.
    
     * Handle realloc failures in 'perf kvm', from David Ahern.
    
     * Fix divide by 0 in variance, from David Ahern.
    
     * Save parent pid in thread struct, from David Ahern.
    
     * Handle JITed code in shared memory, from Andi Kleen.
    
     * Makefile reorganization, prep work for Kconfig patches, from Jiri Olsa.
    
     * Fixes for 'perf diff', from Jiri Olsa.
    
     * Add automated make test suite, from Jiri Olsa.
    
     * 'perf tests' fixes from Jiri Olsa.
    
     * Remove some unused struct members, from Jiri Olsa.
    
     * Add missing liblk.a dependency for python/perf.so, fix from Jiri Olsa.
    
     * Respect CROSS_COMPILE in liblk.a, from Rabin Vincent.
    
     * Expand definition of sysfs format attribute, from Michael Ellerman.
    
     * No need to do locking when adding hists in perf report, only 'top'
       needs that, from Namhyung Kim.
    
     * Sorting improvements, from Namhyung Kim.
    
     * Fix alignment of symbol column in in the hists browser (top, report)
       when -v is given, from NAmhyung Kim.
    
     * Add --percent-limit option to 'top' and 'report', from Namhyung Kim.
    
     * Fix 'perf top' -E option behavior, from Namhyung Kim.
    
     * Fix bug in isupper() and islower(), from Sukadev Bhattiprolu.
    
     * Fix compile errors in bp_signal 'perf test', from Sukadev Bhattiprolu.
    
     * Make Power7 CPI stack events available in sysfs, from Sukadev Bhattiprolu.
    
    Signed-off-by: Arnaldo Carvalho de Melo <acme@redhat.com>

commit b42b918194c4791510ac049e3d507169a7de8544
Author: Tony Lindgren <tony@atomide.com>
Date:   Thu May 30 12:53:05 2013 -0700

    ARM: OMAP2+: Remove board-omap4panda.c
    
    We can now boot with device tree. If you don't want to update u-boot,
    you can boot with appended DTB with the following instructions:
    
    1. Make sure you have the appended DTB support in .config
    
       CONFIG_ARM_APPENDED_DTB=y
       CONFIG_ARM_ATAG_DTB_COMPAT=y
       CONFIG_ARM_ATAG_DTB_COMPAT_CMDLINE_EXTEND=y
    
    2. Build the zImage
    
       $ ARCH=arm CROSS_COMPILE=... make zImage
    
    3. Build the device tree blobs
    
       $ ARCH=arm CROSS_COMPILE=... make dtbs
    
    4. Append the correct panda dtb to zImage
    
       Depending on your hardware it's omap4-panda.dtb, omap4-panda-a4.dtb
       or omap4-panda-es.dtb.
    
       $ cat arch/arm/boot/zImage arch/arm/boot/dts/omap4-panda-es.dtb > /tmp/appended
    
    5. Use mkimage to produce the appended device tree uImage
    
       $ mkimage -A arm -O linux -T kernel -C none -a 0x80008000 -e 0x80008000 \
         -n "Linux" -d /tmp/appended /tmp/uImage
    
    Signed-off-by: Tony Lindgren <tony@atomide.com

commit 76787b3bd2550613ab688842b231e8f82c451cee
Author: Tony Lindgren <tony@atomide.com>
Date:   Thu May 30 12:53:05 2013 -0700

    ARM: OMAP2+: Remove board-4430sdp.c
    
    We can now boot with device tree. If you don't want to update u-boot,
    you can boot with appended DTB with the following instructions:
    
    1. Make sure you have the appended DTB support in .config
    
       CONFIG_ARM_APPENDED_DTB=y
       CONFIG_ARM_ATAG_DTB_COMPAT=y
       CONFIG_ARM_ATAG_DTB_COMPAT_CMDLINE_EXTEND=y
    
    2. Build the zImage
    
       $ ARCH=arm CROSS_COMPILE=... make zImage
    
    3. Build the device tree blobs
    
       $ ARCH=arm CROSS_COMPILE=... make dtbs
    
    4. Append the dtb to zImage
    
       $ cat arch/arm/boot/zImage arch/arm/boot/dts/omap4-sdp.dtb > /tmp/appended
    
    5. Use mkimage to produce the appended device tree uImage
    
       $ mkimage -A arm -O linux -T kernel -C none -a 0x80008000 -e 0x80008000 \
         -n "Linux" -d /tmp/appended /tmp/uImage
    
    Signed-off-by: Tony Lindgren <tony@atomide.com>

commit 3c4797d46c14fa0c7cf733a77bd4b28875078b53
Author: Rabin Vincent <rabin@rab.in>
Date:   Fri May 17 22:27:44 2013 +0200

    tools lib lk: Respect CROSS_COMPILE
    
    Make lk use CROSS_COMPILE, in order to be able to cross compile perf
    again.
    
    Signed-off-by: Rabin Vincent <rabin@rab.in>
    Cc: Ingo Molnar <mingo@kernel.org>
    Cc: Borislav Petkov <bp@suse.de>
    Link: http://lkml.kernel.org/r/1368822464-4887-1-git-send-email-rabin@rab.in
    Signed-off-by: Arnaldo Carvalho de Melo <acme@redhat.com>

commit 95f4838e21945b9d9718f55afeb7edc8c39858b9
Merge: 088d812fe97a d96b51ec1465
Author: Linus Torvalds <torvalds@linux-foundation.org>
Date:   Sun May 26 09:36:31 2013 -0700

    Merge branch 'parisc-for-3.10' of git://git.kernel.org/pub/scm/linux/kernel/git/deller/parisc-linux
    
    Pull parisc fixes from Helge Deller:
     "This time we made the kernel- and interruption stack allocation
      reentrant which fixed some strange kernel crashes (specifically
      protection ID traps).
    
      Furthemore this patchset fixes the interrupt stack in UP and SMP
      configurations by using native locking instructions.  And finally
      usage of floating point calculations on parisc were disabled in the
      MPILIB."
    
    * 'parisc-for-3.10' of git://git.kernel.org/pub/scm/linux/kernel/git/deller/parisc-linux:
      parisc: fix irq stack on UP and SMP
      parisc/superio: Use module_pci_driver to register driver
      parisc: make interrupt and interruption stack allocation reentrant
      parisc: show number of FPE and unaligned access handler calls in /proc/interrupts
      parisc: add additional parisc git tree to MAINTAINERS file
      parisc: use PAGE_SHIFT instead of hardcoded value 12 in pacache.S
      parisc: add rp5470 entry to machine database
      MPILIB: disable usage of floating point registers on parisc

commit 70ef5578dd8011eeafa999a18194d9b548a4d889
Author: Helge Deller <deller@gmx.de>
Date:   Sun May 5 22:08:22 2013 +0000

    MPILIB: disable usage of floating point registers on parisc
    
    The umul_ppmm() macro for parisc uses the xmpyu assembler statement
    which does calculation via a floating point register.
    
    But usage of floating point registers inside the Linux kernel are not
    allowed and gcc will stop compilation due to the -mdisable-fpregs
    compiler option.
    
    Fix this by disabling the umul_ppmm() and udiv_qrnnd() macros. The
    mpilib will then use the generic built-in implementations instead.
    
    Signed-off-by: Helge Deller <deller@gmx.de>

commit 6fae9cdafc92ae9958a3a45dd68205f72e3ad900
Author: Uwe Kleine-Knig <u.kleine-koenig@pengutronix.de>
Date:   Mon May 6 11:35:42 2013 +0200

    ARM: ARMv7-M: implement read_cpuid_ext
    
    On v7-M the extended cpuid registers are not available from CP15 but they
    are memory mapped in the System Control Space.
    There isn't an equivalent available for CPUID_{CACHETYPE,TCM,TLBTYPE,MPIDR}.
    
    Signed-off-by: Uwe Kleine-Knig <u.kleine-koenig@pengutronix.de>

commit 5fe0c1f2f0dca3351536284b0180a79f341b7854
Author: Benjamin Herrenschmidt <benh@kernel.crashing.org>
Date:   Mon May 6 11:37:43 2013 +1000

    irqdomain: Allow quiet failure mode
    
    Some interrupt controllers refuse to map interrupts marked as
    "protected" by firwmare. Since we try to map everyting in the
    device-tree on some platforms, we end up with a lot of nasty
    WARN's in the boot log for what is a normal situation on those
    machines.
    
    This defines a specific return code (-EPERM) from the host map()
    callback which cause irqdomain to fail silently.
    
    MPIC is updated to return this when hitting a protected source
    printing only a single line message for diagnostic purposes.
    
    Signed-off-by: Benjamin Herrenschmidt <benh@kernel.crashing.org>

commit 01227a889ed56ae53aeebb9f93be9d54dd8b2de8
Merge: 9e6879460c8e db6ae6158186
Author: Linus Torvalds <torvalds@linux-foundation.org>
Date:   Sun May 5 14:47:31 2013 -0700

    Merge tag 'kvm-3.10-1' of git://git.kernel.org/pub/scm/virt/kvm/kvm
    
    Pull kvm updates from Gleb Natapov:
     "Highlights of the updates are:
    
      general:
       - new emulated device API
       - legacy device assignment is now optional
       - irqfd interface is more generic and can be shared between arches
    
      x86:
       - VMCS shadow support and other nested VMX improvements
       - APIC virtualization and Posted Interrupt hardware support
       - Optimize mmio spte zapping
    
      ppc:
        - BookE: in-kernel MPIC emulation with irqfd support
        - Book3S: in-kernel XICS emulation (incomplete)
        - Book3S: HV: migration fixes
        - BookE: more debug support preparation
        - BookE: e6500 support
    
      ARM:
       - reworking of Hyp idmaps
    
      s390:
       - ioeventfd for virtio-ccw
    
      And many other bug fixes, cleanups and improvements"
    
    * tag 'kvm-3.10-1' of git://git.kernel.org/pub/scm/virt/kvm/kvm: (204 commits)
      kvm: Add compat_ioctl for device control API
      KVM: x86: Account for failing enable_irq_window for NMI window request
      KVM: PPC: Book3S: Add API for in-kernel XICS emulation
      kvm/ppc/mpic: fix missing unlock in set_base_addr()
      kvm/ppc: Hold srcu lock when calling kvm_io_bus_read/write
      kvm/ppc/mpic: remove users
      kvm/ppc/mpic: fix mmio region lists when multiple guests used
      kvm/ppc/mpic: remove default routes from documentation
      kvm: KVM_CAP_IOMMU only available with device assignment
      ARM: KVM: iterate over all CPUs for CPU compatibility check
      KVM: ARM: Fix spelling in error message
      ARM: KVM: define KVM_ARM_MAX_VCPUS unconditionally
      KVM: ARM: Fix API documentation for ONE_REG encoding
      ARM: KVM: promote vfp_host pointer to generic host cpu context
      ARM: KVM: add architecture specific hook for capabilities
      ARM: KVM: perform HYP initilization for hotplugged CPUs
      ARM: KVM: switch to a dual-step HYP init code
      ARM: KVM: rework HYP page table freeing
      ARM: KVM: enforce maximum size for identity mapped code
      ARM: KVM: move to a KVM provided HYP idmap
      ...

commit 5975a2e0950291a6bfe9fd5880e7952ff87764be
Author: Paul Mackerras <paulus@samba.org>
Date:   Sat Apr 27 00:28:37 2013 +0000

    KVM: PPC: Book3S: Add API for in-kernel XICS emulation
    
    This adds the API for userspace to instantiate an XICS device in a VM
    and connect VCPUs to it.  The API consists of a new device type for
    the KVM_CREATE_DEVICE ioctl, a new capability KVM_CAP_IRQ_XICS, which
    functions similarly to KVM_CAP_IRQ_MPIC, and the KVM_IRQ_LINE ioctl,
    which is used to assert and deassert interrupt inputs of the XICS.
    
    The XICS device has one attribute group, KVM_DEV_XICS_GRP_SOURCES.
    Each attribute within this group corresponds to the state of one
    interrupt source.  The attribute number is the same as the interrupt
    source number.
    
    This does not support irq routing or irqfd yet.
    
    Signed-off-by: Paul Mackerras <paulus@samba.org>
    Acked-by: David Gibson <david@gibson.dropbear.id.au>
    Signed-off-by: Alexander Graf <agraf@suse.de>

commit d133b40f2cdd527af01090ffd6a041485d1a29b4
Author: Wei Yongjun <yongjun_wei@trendmicro.com.cn>
Date:   Wed May 1 19:17:31 2013 +0000

    kvm/ppc/mpic: fix missing unlock in set_base_addr()
    
    Add the missing unlock before return from function set_base_addr()
    when disables the mapping.
    
    Introduced by commit 5df554ad5b7522ea62b0ff9d5be35183494efc21
    (kvm/ppc/mpic: in-kernel MPIC emulation)
    
    Signed-off-by: Wei Yongjun <yongjun_wei@trendmicro.com.cn>
    Signed-off-by: Alexander Graf <agraf@suse.de>

commit c9ef713993ba168b38d1a97ea0ab00874f1da022
Merge: 87c1f0f8c944 16c85a1fd73e
Author: Linus Torvalds <torvalds@linux-foundation.org>
Date:   Tue Apr 30 10:10:48 2013 -0700

    Merge tag 'arm64-for-linus' of git://git.kernel.org/pub/scm/linux/kernel/git/cmarinas/linux-aarch64
    
    Pull arm64 update from Catalin Marinas:
     "Main features:
    
       - Versatile Express SoC (model) support - DT files and Kconfig
         entries (there are no arch/arm64/mach-* directories).  The bulk of
         the code has already been moved to drivers/ as part of the ARM SoC
         clean-up.
    
       - Basic multi-cluster support (CPU logical map initialised from the
         DT)
    
       - Simple earlyprintk support for UART 8250/16550 and FastModel
         console output
    
       - Optimised kernel library bitops and string functions.
    
       - Automatic initialisation of the irqchip and clocks via DT"
    
    * tag 'arm64-for-linus' of git://git.kernel.org/pub/scm/linux/kernel/git/cmarinas/linux-aarch64: (26 commits)
      arm64: Use acquire/release semantics instead of explicit DMB
      arm64: klib: bitops: fix unpredictable stxr usage
      arm64: vexpress: Enable ARMv8 RTSM model (SoC) support
      arm64: vexpress: Add dts files for the ARMv8 RTSM models
      arm64: Survive invalid cpu enable-methods
      arm64: mm: Correct show_pte behaviour
      arm64: Fix compat types affecting struct compat_stat
      arm64: Execute DSB during thread switching for TLB/cache maintenance
      arm64: compiling issue, need add include/asm/vga.h file
      arm64: smp: honour #address-size when parsing CPU reg property
      arm64: Define cmpxchg64 and cmpxchg64_local for outside use
      arm64: Define readq and writeq for driver module using
      arm64: Fix task tracing
      arm64: add explicit symbols to ESR_EL1 decoding
      arm64: Use irqchip_init() for interrupt controller initialisation
      arm64: psci: Use the MPIDR values from cpu_logical_map for cpu ids.
      arm64: klib: Optimised atomic bitops
      arm64: klib: Optimised string functions
      arm64: klib: Optimised memory functions
      arm64: head: match all affinity levels in the pen of the secondaries
      ...

commit c9b1d0981fcce3d9976d7b7a56e4e0503bc610dd
Author: Andrew Shewmaker <agshew@gmail.com>
Date:   Mon Apr 29 15:08:10 2013 -0700

    mm: limit growth of 3% hardcoded other user reserve
    
    Add user_reserve_kbytes knob.
    
    Limit the growth of the memory reserved for other user processes to
    min(3% current process size, user_reserve_pages).  Only about 8MB is
    necessary to enable recovery in the default mode, and only a few hundred
    MB are required even when overcommit is disabled.
    
    user_reserve_pages defaults to min(3% free pages, 128MB)
    
    I arrived at 128MB by taking the max VSZ of sshd, login, bash, and top ...
    then adding the RSS of each.
    
    This only affects OVERCOMMIT_NEVER mode.
    
    Background
    
    1. user reserve
    
    __vm_enough_memory reserves a hardcoded 3% of the current process size for
    other applications when overcommit is disabled.  This was done so that a
    user could recover if they launched a memory hogging process.  Without the
    reserve, a user would easily run into a message such as:
    
    bash: fork: Cannot allocate memory
    
    2. admin reserve
    
    Additionally, a hardcoded 3% of free memory is reserved for root in both
    overcommit 'guess' and 'never' modes.  This was intended to prevent a
    scenario where root-cant-log-in and perform recovery operations.
    
    Note that this reserve shrinks, and doesn't guarantee a useful reserve.
    
    Motivation
    
    The two hardcoded memory reserves should be updated to account for current
    memory sizes.
    
    Also, the admin reserve would be more useful if it didn't shrink too much.
    
    When the current code was originally written, 1GB was considered
    "enterprise".  Now the 3% reserve can grow to multiple GB on large memory
    systems, and it only needs to be a few hundred MB at most to enable a user
    or admin to recover a system with an unwanted memory hogging process.
    
    I've found that reducing these reserves is especially beneficial for a
    specific type of application load:
    
     * single application system
     * one or few processes (e.g. one per core)
     * allocating all available memory
     * not initializing every page immediately
     * long running
    
    I've run scientific clusters with this sort of load.  A long running job
    sometimes failed many hours (weeks of CPU time) into a calculation.  They
    weren't initializing all of their memory immediately, and they weren't
    using calloc, so I put systems into overcommit 'never' mode.  These
    clusters run diskless and have no swap.
    
    However, with the current reserves, a user wishing to allocate as much
    memory as possible to one process may be prevented from using, for
    example, almost 2GB out of 32GB.
    
    The effect is less, but still significant when a user starts a job with
    one process per core.  I have repeatedly seen a set of processes
    requesting the same amount of memory fail because one of them could not
    allocate the amount of memory a user would expect to be able to allocate.
    For example, Message Passing Interfce (MPI) processes, one per core.  And
    it is similar for other parallel programming frameworks.
    
    Changing this reserve code will make the overcommit never mode more useful
    by allowing applications to allocate nearly all of the available memory.
    
    Also, the new admin_reserve_kbytes will be safer than the current behavior
    since the hardcoded 3% of available memory reserve can shrink to something
    useless in the case where applications have grabbed all available memory.
    
    Risks
    
    * "bash: fork: Cannot allocate memory"
    
      The downside of the first patch-- which creates a tunable user reserve
      that is only used in overcommit 'never' mode--is that an admin can set
      it so low that a user may not be able to kill their process, even if
      they already have a shell prompt.
    
      Of course, a user can get in the same predicament with the current 3%
      reserve--they just have to launch processes until 3% becomes negligible.
    
    * root-cant-log-in problem
    
      The second patch, adding the tunable rootuser_reserve_pages, allows
      the admin to shoot themselves in the foot by setting it too small.  They
      can easily get the system into a state where root-can't-log-in.
    
      However, the new admin_reserve_kbytes will be safer than the current
      behavior since the hardcoded 3% of available memory reserve can shrink
      to something useless in the case where applications have grabbed all
      available memory.
    
    Alternatives
    
     * Memory cgroups provide a more flexible way to limit application memory.
    
       Not everyone wants to set up cgroups or deal with their overhead.
    
     * We could create a fourth overcommit mode which provides smaller reserves.
    
       The size of useful reserves may be drastically different depending
       on the whether the system is embedded or enterprise.
    
     * Force users to initialize all of their memory or use calloc.
    
       Some users don't want/expect the system to overcommit when they malloc.
       Overcommit 'never' mode is for this scenario, and it should work well.
    
    The new user and admin reserve tunables are simple to use, with low
    overhead compared to cgroups.  The patches preserve current behavior where
    3% of memory is less than 128MB, except that the admin reserve doesn't
    shrink to an unusable size under pressure.  The code allows admins to tune
    for embedded and enterprise usage.
    
    FAQ
    
     * How is the root-cant-login problem addressed?
       What happens if admin_reserve_pages is set to 0?
    
       Root is free to shoot themselves in the foot by setting
       admin_reserve_kbytes too low.
    
       On x86_64, the minimum useful reserve is:
         8MB for overcommit 'guess'
       128MB for overcommit 'never'
    
       admin_reserve_pages defaults to min(3% free memory, 8MB)
    
       So, anyone switching to 'never' mode needs to adjust
       admin_reserve_pages.
    
     * How do you calculate a minimum useful reserve?
    
       A user or the admin needs enough memory to login and perform
       recovery operations, which includes, at a minimum:
    
       sshd or login + bash (or some other shell) + top (or ps, kill, etc.)
    
       For overcommit 'guess', we can sum resident set sizes (RSS)
       because we only need enough memory to handle what the recovery
       programs will typically use. On x86_64 this is about 8MB.
    
       For overcommit 'never', we can take the max of their virtual sizes (VSZ)
       and add the sum of their RSS. We use VSZ instead of RSS because mode
       forces us to ensure we can fulfill all of the requested memory allocations--
       even if the programs only use a fraction of what they ask for.
       On x86_64 this is about 128MB.
    
       When swap is enabled, reserves are useful even when they are as
       small as 10MB, regardless of overcommit mode.
    
       When both swap and overcommit are disabled, then the admin should
       tune the reserves higher to be absolutley safe. Over 230MB each
       was safest in my testing.
    
     * What happens if user_reserve_pages is set to 0?
    
       Note, this only affects overcomitt 'never' mode.
    
       Then a user will be able to allocate all available memory minus
       admin_reserve_kbytes.
    
       However, they will easily see a message such as:
    
       "bash: fork: Cannot allocate memory"
    
       And they won't be able to recover/kill their application.
       The admin should be able to recover the system if
       admin_reserve_kbytes is set appropriately.
    
     * What's the difference between overcommit 'guess' and 'never'?
    
       "Guess" allows an allocation if there are enough free + reclaimable
       pages. It has a hardcoded 3% of free pages reserved for root.
    
       "Never" allows an allocation if there is enough swap + a configurable
       percentage (default is 50) of physical RAM. It has a hardcoded 3% of
       free pages reserved for root, like "Guess" mode. It also has a
       hardcoded 3% of the current process size reserved for additional
       applications.
    
     * Why is overcommit 'guess' not suitable even when an app eventually
       writes to every page? It takes free pages, file pages, available
       swap pages, reclaimable slab pages into consideration. In other words,
       these are all pages available, then why isn't overcommit suitable?
    
       Because it only looks at the present state of the system. It
       does not take into account the memory that other applications have
       malloced, but haven't initialized yet. It overcommits the system.
    
    Test Summary
    
    There was little change in behavior in the default overcommit 'guess'
    mode with swap enabled before and after the patch. This was expected.
    
    Systems run most predictably (i.e. no oom kills) in overcommit 'never'
    mode with swap enabled. This also allowed the most memory to be allocated
    to a user application.
    
    Overcommit 'guess' mode without swap is a bad idea. It is easy to
    crash the system. None of the other tested combinations crashed.
    This matches my experience on the Roadrunner supercomputer.
    
    Without the tunable user reserve, a system in overcommit 'never' mode
    and without swap does not allow the admin to recover, although the
    admin can.
    
    With the new tunable reserves, a system in overcommit 'never' mode
    and without swap can be configured to:
    
    1. maximize user-allocatable memory, running close to the edge of
    recoverability
    
    2. maximize recoverability, sacrificing allocatable memory to
    ensure that a user cannot take down a system
    
    Test Description
    
    Fedora 18 VM - 4 x86_64 cores, 5725MB RAM, 4GB Swap
    
    System is booted into multiuser console mode, with unnecessary services
    turned off. Caches were dropped before each test.
    
    Hogs are user memtester processes that attempt to allocate all free memory
    as reported by /proc/meminfo
    
    In overcommit 'never' mode, memory_ratio=100
    
    Test Results
    
    3.9.0-rc1-mm1
    
    Overcommit | Swap | Hogs | MB Got/Wanted | OOMs | User Recovery | Admin Recovery
    ----------   ----   ----   -------------   ----   -------------   --------------
    guess        yes    1      5432/5432       no     yes             yes
    guess        yes    4      5444/5444       1      yes             yes
    guess        no     1      5302/5449       no     yes             yes
    guess        no     4      -               crash  no              no
    
    never        yes    1      5460/5460       1      yes             yes
    never        yes    4      5460/5460       1      yes             yes
    never        no     1      5218/5432       no     no              yes
    never        no     4      5203/5448       no     no              yes
    
    3.9.0-rc1-mm1-tunablereserves
    
    User and Admin Recovery show their respective reserves, if applicable.
    
    Overcommit | Swap | Hogs | MB Got/Wanted | OOMs | User Recovery | Admin Recovery
    ----------   ----   ----   -------------   ----   -------------   --------------
    guess        yes    1      5419/5419       no     - yes           8MB yes
    guess        yes    4      5436/5436       1      - yes           8MB yes
    guess        no     1      5440/5440       *      - yes           8MB yes
    guess        no     4      -               crash  - no            8MB no
    
    * process would successfully mlock, then the oom killer would pick it
    
    never        yes    1      5446/5446       no     10MB yes        20MB yes
    never        yes    4      5456/5456       no     10MB yes        20MB yes
    never        no     1      5387/5429       no     128MB no        8MB barely
    never        no     1      5323/5428       no     226MB barely    8MB barely
    never        no     1      5323/5428       no     226MB barely    8MB barely
    
    never        no     1      5359/5448       no     10MB no         10MB barely
    
    never        no     1      5323/5428       no     0MB no          10MB barely
    never        no     1      5332/5428       no     0MB no          50MB yes
    never        no     1      5293/5429       no     0MB no          90MB yes
    
    never        no     1      5001/5427       no     230MB yes       338MB yes
    never        no     4*     4998/5424       no     230MB yes       338MB yes
    
    * more memtesters were launched, able to allocate approximately another 100MB
    
    Future Work
    
     - Test larger memory systems.
    
     - Test an embedded image.
    
     - Test other architectures.
    
     - Time malloc microbenchmarks.
    
     - Would it be useful to be able to set overcommit policy for
       each memory cgroup?
    
     - Some lines are slightly above 80 chars.
       Perhaps define a macro to convert between pages and kb?
       Other places in the kernel do this.
    
    [akpm@linux-foundation.org: coding-style fixes]
    [akpm@linux-foundation.org: make init_user_reserve() static]
    Signed-off-by: Andrew Shewmaker <agshew@gmail.com>
    Signed-off-by: Andrew Morton <akpm@linux-foundation.org>
    Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>

commit bc5ad3f3701116e7db57268e6f89010ec714697e
Author: Benjamin Herrenschmidt <benh@kernel.crashing.org>
Date:   Wed Apr 17 20:30:26 2013 +0000

    KVM: PPC: Book3S: Add kernel emulation for the XICS interrupt controller
    
    This adds in-kernel emulation of the XICS (eXternal Interrupt
    Controller Specification) interrupt controller specified by PAPR, for
    both HV and PR KVM guests.
    
    The XICS emulation supports up to 1048560 interrupt sources.
    Interrupt source numbers below 16 are reserved; 0 is used to mean no
    interrupt and 2 is used for IPIs.  Internally these are represented in
    blocks of 1024, called ICS (interrupt controller source) entities, but
    that is not visible to userspace.
    
    Each vcpu gets one ICP (interrupt controller presentation) entity,
    used to store the per-vcpu state such as vcpu priority, pending
    interrupt state, IPI request, etc.
    
    This does not include any API or any way to connect vcpus to their
    ICP state; that will be added in later patches.
    
    This is based on an initial implementation by Michael Ellerman
    <michael@ellerman.id.au> reworked by Benjamin Herrenschmidt and
    Paul Mackerras.
    
    Signed-off-by: Benjamin Herrenschmidt <benh@kernel.crashing.org>
    Signed-off-by: Paul Mackerras <paulus@samba.org>
    [agraf: fix typo, add dependency on !KVM_MPIC]
    Signed-off-by: Alexander Graf <agraf@suse.de>

commit 91194919a6b07d70081fe185a79b129efee84fff
Author: Scott Wood <scottwood@freescale.com>
Date:   Thu Apr 25 14:11:24 2013 +0000

    kvm/ppc/mpic: Eliminate mmio_mapped
    
    We no longer need to keep track of this now that MPIC destruction
    always happens either during VM destruction (after MMIO has been
    destroyed) or during a failed creation (before the fd has been exposed
    to userspace, and thus before the MMIO region could have been
    registered).
    
    Signed-off-by: Scott Wood <scottwood@freescale.com>
    Signed-off-by: Alexander Graf <agraf@suse.de>

commit 447a03c02adc57933d328eb15aeae33160bc92e8
Author: Alexander Graf <agraf@suse.de>
Date:   Wed Apr 17 01:54:26 2013 +0200

    KVM: PPC: MPIC: Restrict to e500 platforms
    
    The code as is doesn't make any sense on non-e500 platforms. Restrict it
    there, so that people don't get wrong ideas on what would actually work.
    
    This patch should get reverted as soon as it's possible to either run e500
    guests on non-e500 hosts or the MPIC emulation gains support for non-e500
    modes.
    
    Signed-off-by: Alexander Graf <agraf@suse.de>

commit 5efdb4be598fc2af6937c3387586635ddf6fd2c8
Author: Alexander Graf <agraf@suse.de>
Date:   Wed Apr 17 00:37:57 2013 +0200

    KVM: PPC: MPIC: Add support for KVM_IRQ_LINE
    
    Now that all pieces are in place for reusing generic irq infrastructure,
    we can copy x86's implementation of KVM_IRQ_LINE irq injection and simply
    reuse it for PPC, as it will work there just as well.
    
    Signed-off-by: Alexander Graf <agraf@suse.de>

commit de9ba2f36368d21314860ee24893a6ffef01e548
Author: Alexander Graf <agraf@suse.de>
Date:   Tue Apr 16 17:42:19 2013 +0200

    KVM: PPC: Support irq routing and irqfd for in-kernel MPIC
    
    Now that all the irq routing and irqfd pieces are generic, we can expose
    real irqchip support to all of KVM's internal helpers.
    
    This allows us to use irqfd with the in-kernel MPIC.
    
    Signed-off-by: Alexander Graf <agraf@suse.de>

commit eb1e4f43e0f47f2655372c7d32c43db9711c278e
Author: Scott Wood <scottwood@freescale.com>
Date:   Fri Apr 12 14:08:47 2013 +0000

    kvm/ppc/mpic: add KVM_CAP_IRQ_MPIC
    
    Enabling this capability connects the vcpu to the designated in-kernel
    MPIC.  Using explicit connections between vcpus and irqchips allows
    for flexibility, but the main benefit at the moment is that it
    simplifies the code -- KVM doesn't need vm-global state to remember
    which MPIC object is associated with this vm, and it doesn't need to
    care about ordering between irqchip creation and vcpu creation.
    
    Signed-off-by: Scott Wood <scottwood@freescale.com>
    [agraf: add stub functions for kvmppc_mpic_{dis,}connect_vcpu]
    Signed-off-by: Alexander Graf <agraf@suse.de>

commit 5df554ad5b7522ea62b0ff9d5be35183494efc21
Author: Scott Wood <scottwood@freescale.com>
Date:   Fri Apr 12 14:08:46 2013 +0000

    kvm/ppc/mpic: in-kernel MPIC emulation
    
    Hook the MPIC code up to the KVM interfaces, add locking, etc.
    
    Signed-off-by: Scott Wood <scottwood@freescale.com>
    [agraf: add stub function for kvmppc_mpic_set_epr, non-booke, 64bit]
    Signed-off-by: Alexander Graf <agraf@suse.de>

commit 72aea393a2e7c53a951bc581f18a79315f47036b
Author: Will Deacon <will.deacon@arm.com>
Date:   Mon Apr 22 18:28:55 2013 +0100

    arm64: smp: honour #address-size when parsing CPU reg property
    
    For systems where the top 32-bits of the MPIDR are all zero, we should
    allow the device-tree to specify an #address-size of 0x1 for the CPU reg
    property and then zero extend the value there.
    
    Without this patch, kvmtool breaks with the recent mpidr parsing code
    introduced in 4c7aa0021356 ("arm64: kernel: initialise cpu_logical_map
    from the DT").
    
    Acked-by: Javi Merino <javi.merino@arm.com>
    Acked-by: Lorenzo Pieralisi <lorenzo.pieralisi@arm.com>
    Signed-off-by: Will Deacon <will.deacon@arm.com>
    Signed-off-by: Catalin Marinas <catalin.marinas@arm.com>

commit b9c32fb2717094231b31a7d7dcf5fd7f3638ac2f
Author: Daniel Borkmann <dborkman@redhat.com>
Date:   Tue Apr 23 00:39:31 2013 +0000

    packet: if hw/sw ts enabled in rx/tx ring, report which ts we got
    
    Currently, there is no way to find out which timestamp is reported in
    tpacket{,2,3}_hdr's tp_sec, tp_{n,u}sec members. It can be one of
    SOF_TIMESTAMPING_SYS_HARDWARE, SOF_TIMESTAMPING_RAW_HARDWARE,
    SOF_TIMESTAMPING_SOFTWARE, or a fallback variant late call from the
    PF_PACKET code in software.
    
    Therefore, report in the tp_status member of the ring buffer which
    timestamp has been reported for RX and TX path. This should not break
    anything for the following reasons: i) in RX ring path, the user needs
    to test for tp_status & TP_STATUS_USER, and later for other flags as
    well such as TP_STATUS_VLAN_VALID et al, so adding other flags will
    do no harm; ii) in TX ring path, time stamps with PACKET_TIMESTAMP
    socketoption are not available resp. had no effect except that the
    application setting this is buggy. Next to TP_STATUS_AVAILABLE, the
    user also should check for other flags such as TP_STATUS_WRONG_FORMAT
    to reclaim frames to the application. Thus, in case TX ts are turned
    off (default case), nothing happens to the application logic, and in
    case we want to use this new feature, we now can also check which of
    the ts source is reported in the status field as provided in the docs.
    
    Reported-by: Richard Cochran <richardcochran@gmail.com>
    Signed-off-by: Daniel Borkmann <dborkman@redhat.com>
    Acked-by: Willem de Bruijn <willemb@google.com>
    Signed-off-by: David S. Miller <davem@davemloft.net>

commit e8db288e05e588ad3f416b3a24354d60d02f35f2
Author: Nicolas Pitre <nicolas.pitre@linaro.org>
Date:   Thu Apr 12 02:45:22 2012 -0400

    ARM: multi-cluster PM: secondary kernel entry code
    
    CPUs in cluster based systems, such as big.LITTLE, have special needs
    when entering the kernel due to a hotplug event, or when resuming from
    a deep sleep mode.
    
    This is vectorized so multiple CPUs can enter the kernel in parallel
    without serialization.
    
    The mcpm prefix stands for "multi cluster power management", however
    this is usable on single cluster systems as well.  Only the basic
    structure is introduced here.  This will be extended with later patches.
    
    In order not to complexify things more than they currently have to,
    the planned work to make runtime adjusted MPIDR based indexing and
    dynamic memory allocation for cluster states is postponed to a later
    cycle. The MAX_NR_CLUSTERS and MAX_CPUS_PER_CLUSTER static definitions
    should be sufficient for those systems expected to be available in the
    near future.
    
    Signed-off-by: Nicolas Pitre <nico@linaro.org>
    Reviewed-by: Santosh Shilimkar <santosh.shilimkar@ti.com>
    Reviewed-by: Will Deacon <will.deacon@arm.com>

commit 3cc33d50f52521760da29ebd9db239741da7f21a
Author: Paul Mackerras <paulus@samba.org>
Date:   Mon Apr 15 20:28:01 2013 +0000

    powerpc: Fix build errors with UP configs in HV-style KVM
    
    This fixes these errors when building UP with CONFIG_KVM_BOOK3S_64_HV=y:
    
    arch/powerpc/kvm/book3s_hv.c:1855:2: error: implicit declaration of function 'inhibit_secondary_onlining' [-Werror=implicit-function-declaration]
    arch/powerpc/kvm/book3s_hv.c:1862:2: error: implicit declaration of function 'uninhibit_secondary_onlining' [-Werror=implicit-function-declaration]
    cc1: all warnings being treated as errors
    
    and this error (with CONFIG_KVM_BOOK3S_64=m, or a vmlinux link error
    with CONFIG_KVM_BOOK3S_64=y):
    
    ERROR: "smp_send_reschedule" [arch/powerpc/kvm/kvm.ko] undefined!
    make[2]: *** [__modpost] Error 1
    
    The fix for the link error is suboptimal; ideally we want a self_ipi()
    function from irq.c, connected at least to the MPIC code, to initiate
    an IPI to this cpu.  The fix here at least lets the code build, and it
    will work, just with interrupts being delayed sometimes.
    
    Signed-off-by: Paul Mackerras <paulus@samba.org>
    Signed-off-by: Michael Ellerman <michael@ellerman.id.au>

commit bf84a01063eaab2f1a37d72d1b903445b3a25a4e
Author: Daniel Borkmann <dborkman@redhat.com>
Date:   Sun Apr 14 08:08:13 2013 +0000

    net: sock: make sock_tx_timestamp void
    
    Currently, sock_tx_timestamp() always returns 0. The comment that
    describes the sock_tx_timestamp() function wrongly says that it
    returns an error when an invalid argument is passed (from commit
    20d4947353be, ``net: socket infrastructure for SO_TIMESTAMPING'').
    Make the function void, so that we can also remove all the unneeded
    if conditions that check for such a _non-existant_ error case in the
    output path.
    
    Signed-off-by: Daniel Borkmann <dborkman@redhat.com>
    Signed-off-by: David S. Miller <davem@davemloft.net>

commit 84a0b9b959257a55aeeda10b48b2d565302bec12
Author: Aaro Koskinen <aaro.koskinen@iki.fi>
Date:   Wed Mar 27 23:53:08 2013 +0200

    staging: xgifb: delete IF_DEF_TRUMPION and IF_DEF_DSTN
    
    Delete some unused flags.
    
    Signed-off-by: Aaro Koskinen <aaro.koskinen@iki.fi>
    Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>

commit a9a193ffe51d036a7c2d30d7fbdb66498c688237
Author: Liviu Dudau <Liviu.Dudau@arm.com>
Date:   Tue Mar 26 11:02:51 2013 +0000

    arm64: psci: Use the MPIDR values from cpu_logical_map for cpu ids.
    
    With the (re)introduction of cpu_logical_map in arm64 we switch to
    the use of MPIDR values to identify CPUs. Update the psci code to
    do that.
    
    Signed-off-by: Liviu Dudau <Liviu.Dudau@arm.com>
    Signed-off-by: Catalin Marinas <catalin.marinas@arm.com>

commit 0359b0e2d0bbd28289c38ebe779b5f1c61f8ccc8
Author: Javi Merino <javi.merino@arm.com>
Date:   Wed Aug 29 18:32:18 2012 +0100

    arm64: head: match all affinity levels in the pen of the secondaries
    
    The reg property of the cpu nodes in the DT now contains all the
    affinity levels in (MPIDR[39:32] and MPIDR[23:0]) and that's what
    boot_secondary() writes in the pen, so increase the mask in
    secondary_holding_pen accordingly.
    
    Signed-off-by: Javi Merino <javi.merino@arm.com>
    Signed-off-by: Catalin Marinas <catalin.marinas@arm.com>

commit 4c7aa0021356ee91b96cea51b8b7fadebaba489e
Author: Javi Merino <javi.merino@arm.com>
Date:   Wed Aug 29 09:47:19 2012 +0100

    arm64: kernel: initialise cpu_logical_map from the DT
    
    When booting the kernel, the cpu logical id map must be initialised
    using device tree data passed by FW or through an embedded blob.
    
    This patch parses the reg property in device tree "cpu" nodes,
    retrieves the corresponding CPUs hardware identifiers (MPIDR) and
    initialises the cpu logical map accordingly.
    
    The device tree HW identifiers are considered valid if all CPU nodes
    contain a "reg" property, there are no duplicate "reg" entries and the
    DT defines a CPU node whose "reg" property defines affinity levels
    that matches those of the boot CPU.
    
    The primary CPU is assigned cpu logical number 0 to keep the current
    convention valid.
    
    Based on a0ae02405076ac32bd17ece976e914b5b6075bb0 (ARM: kernel: add
    device tree init map function).
    
    Signed-off-by: Javi Merino <javi.merino@arm.com>
    Signed-off-by: Catalin Marinas <catalin.marinas@arm.com>

commit 1b72b78fda0433a7e115bc2d78603fde65fae0e7
Author: Thomas Petazzoni <thomas.petazzoni@free-electrons.com>
Date:   Wed Mar 6 11:23:35 2013 +0100

    arm: mvebu: fix address-cells in mpic DT node
    
    There is no need to have a #address-cells property in the MPIC Device
    Tree node, and more than that, having it confuses the of_irq_map_raw()
    logic, which will be used by the Marvell PCIe driver.
    
    Signed-off-by: Thomas Petazzoni <thomas.petazzoni@free-electrons.com>
    Signed-off-by: Jason Cooper <jason@lakedaemon.net>

commit c939a316459783e5cd6c6bd9dc90ea11b18ecd7f
Author: Laurence Evans <levans@solarflare.com>
Date:   Thu Nov 15 10:56:07 2012 +0000

    sfc: PTP changes to support improved UUID filtering mode
    
    There is a long-standing problem with the packet-timestamp matching in
    the driver. When a PTP packet is received by the MC, the FPGA
    timestamps the packet and the MC sends the timestamp and 6 bytes of
    the UUID to the driver. The driver then matches the timestamp against
    received packets using the same 6 bytes of UUID.
    
    The problem comes from the choice of which 6 bytes to use. The PTP
    spec is slightly contradictory and misleading in one of the two places
    where the UUIDs are discussed. From section 7.2.2.2 of the spec, a
    PTPD2 UUID can be either a EUI-64 or a EUI-64 constructed from a
    EUI-48. The typical ethernet based implementation uses a EUI-64
    constructed from a EUI-48. This works by taking the first 3 bytes of
    the MAC address of the NIC being used for PTP (the OUI), then
    inserting 0xFF, 0xFE, then taking the last 3 bytes of the MAC address
    giving
              MAC[0], MAC[1], MAC[2], 0xFF, 0xFE, MAC[3], MAC[4], MAC[5]
    The current MC firmware and driver discard the first two bytes of this
    UUID and packets are matched against timestamps using bytes 2 to 7 so
    there is a small risk that in a deployment of Solarflare PTP NICs used
    with other vendors NICs, that a PTP packet could be matched against
    the wrong timestamp. This applies to all other organisations whose
    third byte of the OUI is 0x53. It's a long list but I notice that it
    includes Cisco.
    
    The necessary modifications to use bytes 0-2 and 5-7 of the UUID to
    match against are quite small but introduce incompatibility between
    older version of the firmware and driver.
    
    When PTP is enabled via SO_TIMESTAMPING specifying PTP V2, the driver
    will try to enable PTP in the firmware using the enhanced mode
    (above). If the firmware returns an error, the driver will enable PTP
    in the firmware using the old mode.
    
    [bwh: Fix some style errors; remove private ioctl bits]
    Signed-off-by: Ben Hutchings <bhutchings@solarflare.com>

commit 3a6f08a3708f6faf6aba4abbdeaa9da29393f696
Author: Gregory CLEMENT <gregory.clement@free-electrons.com>
Date:   Fri Jan 25 18:32:41 2013 +0100

    arm: mvebu: Add support for local interrupt
    
    MPIC allows the use of private interrupt for each CPUs. The 28th first
    interrupts are per-cpu. This patch adds support to use them.
    
    Signed-off-by: Gregory CLEMENT <gregory.clement@free-electrons.com>
    Signed-off-by: Jason Cooper <jason@lakedaemon.net>

commit 9d3cae26acb471d5954cfdc25d1438b32060babe
Merge: df24eef3e794 8520e443aa56
Author: Linus Torvalds <torvalds@linux-foundation.org>
Date:   Sat Feb 23 17:09:55 2013 -0800

    Merge branch 'next' of git://git.kernel.org/pub/scm/linux/kernel/git/benh/powerpc
    
    Pull powerpc updates from Benjamin Herrenschmidt:
     "So from the depth of frozen Minnesota, here's the powerpc pull request
      for 3.9.  It has a few interesting highlights, in addition to the
      usual bunch of bug fixes, minor updates, embedded device tree updates
      and new boards:
    
       - Hand tuned asm implementation of SHA1 (by Paulus & Michael
         Ellerman)
    
       - Support for Doorbell interrupts on Power8 (kind of fast
         thread-thread IPIs) by Ian Munsie
    
       - Long overdue cleanup of the way we handle relocation of our open
         firmware trampoline (prom_init.c) on 64-bit by Anton Blanchard
    
       - Support for saving/restoring & context switching the PPR (Processor
         Priority Register) on server processors that support it.  This
         allows the kernel to preserve thread priorities established by
         userspace.  By Haren Myneni.
    
       - DAWR (new watchpoint facility) support on Power8 by Michael Neuling
    
       - Ability to change the DSCR (Data Stream Control Register) which
         controls cache prefetching on a running process via ptrace by
         Alexey Kardashevskiy
    
       - Support for context switching the TAR register on Power8 (new
         branch target register meant to be used by some new specific
         userspace perf event interrupt facility which is yet to be enabled)
         by Ian Munsie.
    
       - Improve preservation of the CFAR register (which captures the
         origin of a branch) on various exception conditions by Paulus.
    
       - Move the Bestcomm DMA driver from arch powerpc to drivers/dma where
         it belongs by Philippe De Muyter
    
       - Support for Transactional Memory on Power8 by Michael Neuling
         (based on original work by Matt Evans).  For those curious about
         the feature, the patch contains a pretty good description."
    
    (See commit db8ff907027b: "powerpc: Documentation for transactional
    memory on powerpc" for the mentioned description added to the file
    Documentation/powerpc/transactional_memory.txt)
    
    * 'next' of git://git.kernel.org/pub/scm/linux/kernel/git/benh/powerpc: (140 commits)
      powerpc/kexec: Disable hard IRQ before kexec
      powerpc/85xx: l2sram - Add compatible string for BSC9131 platform
      powerpc/85xx: bsc9131 - Correct typo in SDHC device node
      powerpc/e500/qemu-e500: enable coreint
      powerpc/mpic: allow coreint to be determined by MPIC version
      powerpc/fsl_pci: Store the pci ctlr device ptr in the pci ctlr struct
      powerpc/85xx: Board support for ppa8548
      powerpc/fsl: remove extraneous DIU platform functions
      arch/powerpc/platforms/85xx/p1022_ds.c: adjust duplicate test
      powerpc: Documentation for transactional memory on powerpc
      powerpc: Add transactional memory to pseries and ppc64 defconfigs
      powerpc: Add config option for transactional memory
      powerpc: Add transactional memory to POWER8 cpu features
      powerpc: Add new transactional memory state to the signal context
      powerpc: Hook in new transactional memory code
      powerpc: Routines for FP/VSX/VMX unavailable during a transaction
      powerpc: Add transactional memory unavaliable execption handler
      powerpc: Add reclaim and recheckpoint functions for context switching transactional memory processes
      powerpc: Add FP/VSX and VMX register load functions for transactional memory
      powerpc: Add helper functions for transactional memory context switching
      ...

commit 619d5a0ded06f6d46092205a68a92f7c3a01dd44
Author: Saurav Kashyap <saurav.kashyap@qlogic.com>
Date:   Fri Feb 8 01:57:49 2013 -0500

    [SCSI] qla2xxx: Do MPI reset only for ISP81xx.
    
    Signed-off-by: Giridhar Malavali <giridhar.malavali@qlogic.com>
    Signed-off-by: Saurav Kashyap <saurav.kashyap@qlogic.com>
    Signed-off-by: James Bottomley <JBottomley@Parallels.com>

commit 0e39718b988b84860a6c291a2c82c9cb75e3b8a9
Author: Helge Deller <deller@gmx.de>
Date:   Thu Jan 31 22:04:12 2013 +0000

    parisc: enhance automatic CONFIG_CROSS_COMPILE detection
    
    The current Makefile will only choose the hppa64 cross compiler when
    running natively on hppa in a 32bit userspace.
    This patch additionally chooses the correct 32/64 bit hppa compiler even
    when doing real cross compiling to hppa/hppa64 from another architecture.
    
    Signed-off-by: Helge Deller <deller@gmx.de>

commit 64871ff6e8f19c99bc6b9a93e4f8926e1650e61e
Author: Scott Wood <scottwood@freescale.com>
Date:   Mon Jan 21 19:56:43 2013 -0600

    powerpc/e500/qemu-e500: enable coreint
    
    The MPIC code will disable coreint if it detects an insufficient
    MPIC version.
    
    Signed-off-by: Scott Wood <scottwood@freescale.com>
    Signed-off-by: Kumar Gala <galak@kernel.crashing.org>

commit 7c509ee01496a170fe4329f076c334591b6f49d0
Author: Scott Wood <scottwood@freescale.com>
Date:   Mon Jan 21 19:56:41 2013 -0600

    powerpc/mpic: allow coreint to be determined by MPIC version
    
    This will be used by the qemu-e500 platform, as the MPIC version (and
    thus whether we have coreint) depends on how QEMU is configured.
    
    Signed-off-by: Scott Wood <scottwood@freescale.com>
    Signed-off-by: Kumar Gala <galak@kernel.crashing.org>

commit 68c465ada54c730d653fc6fdc9dc0d5270b2de00
Author: Thomas Jarosch <thomas.jarosch@intra2net.com>
Date:   Fri Jan 25 10:57:08 2013 +0100

    perf tools: Fix possible double free on error
    
    Can only be triggered via CROSS_COMPILE env var.
    
    Detected by cppcheck.
    
    Signed-off-by: Thomas Jarosch <thomas.jarosch@intra2net.com>
    Link: http://lkml.kernel.org/r/36736865.AIlztKhDqN@storm
    Signed-off-by: Arnaldo Carvalho de Melo <acme@redhat.com>

commit 66331e8cf5cd8b387891e3ec0ef1d95e224ee976
Author: Dan Carpenter <dan.carpenter@oracle.com>
Date:   Fri Dec 7 13:56:22 2012 +0300

    [SCSI] mpt3sas: cut and paste bug storing trigger mpi
    
    ioc->diag_trigger_mpi is an SL_WH_MPI_TRIGGERS_T struct.
    
    There is a cut and paste error here and SL_WH_EVENT_TRIGGERS_T is used
    instead of SL_WH_MPI_TRIGGERS_T.  Since the SL_WH_EVENT_TRIGGERS_T is
    smaller than SL_WH_MPI_TRIGGERS_T, it means we only clear part of the
    buffer.
    
    I've changed it to use sizeof(ioc->diag_trigger_mpi) which is a bit
    simpler.
    
    Signed-off-by: Dan Carpenter <dan.carpenter@oracle.com>
    Acked-by: "Sreekanth Reddy" <Sreekanth.reddy@lsi.com>
    Signed-off-by: James Bottomley <JBottomley@Parallels.com>

commit 34f364fef475f5d960b74bf074d65392ece50235
Author: Scott Wood <scottwood@freescale.com>
Date:   Fri Jan 11 13:38:41 2013 +0000

    powerpc/fsl: Remove CONFIG_IRQ_ALL_CPUS from mpc85xx/mpc86xx defconfig
    
    While this should be harmless now that distribute_irqs
    obeys MPIC_SINGLE_DEST_CPU, there's no reason to enable this
    on mpc85xx/mpc86xx since MPIC_SINGLE_DEST_CPU will always be set.
    
    Signed-off-by: Scott Wood <scottwood@freescale.com>
    Signed-off-by: Benjamin Herrenschmidt <benh@kernel.crashing.org>

commit 7bd9fc556d8f5752c86fa09cbaa3c1c3ab5da86f
Author: Scott Wood <scottwood@freescale.com>
Date:   Fri Jan 11 13:38:40 2013 +0000

    powerpc/mpic: Make distribute_irqs obey MPIC_SINGLE_DEST_CPU
    
    Previously we were setting an illegal configuration on mpc85xx
    MPICs if CONFIG_IRQ_ALL_CPUS is enabled (which for some reason it is
    in mpc85xx_smp_defconfig).
    
    Signed-off-by: Scott Wood <scottwood@freescale.com>
    Signed-off-by: Benjamin Herrenschmidt <benh@kernel.crashing.org>

commit 1496ec13a1ae92cea305d266ff73f850138f92c7
Merge: ba2ab41f3d68 3836414f45b0
Author: Linus Torvalds <torvalds@linux-foundation.org>
Date:   Thu Jan 24 12:42:50 2013 -0800

    Merge tag 'fixes-for-linus2' of git://git.kernel.org/pub/scm/linux/kernel/git/arm/arm-soc
    
    Pull ARM SoC fixes from Olof Johansson:
     "Here's a long-pending fixes pull request for arm-soc (I didn't send
      one in the -rc4 cycle).
    
      The larger deltas are from:
    
       - A fixup of error paths in the mvsdio driver
    
       - Header file move for a driver that hadn't been properly converted
         to multiplatform on i.MX, which was causing build failures when
         included
    
       - Device tree updates for at91 dealing mostly with their new pinctrl
         setup merged in 3.8 and mistakes in those initial configs
    
      The rest are the normal mix of small fixes all over the place; sunxi,
      omap, imx, mvebu, etc, etc."
    
    * tag 'fixes-for-linus2' of git://git.kernel.org/pub/scm/linux/kernel/git/arm/arm-soc: (40 commits)
      mfd: vexpress-sysreg: Don't skip initialization on probe
      ARM: vexpress: Enable A7 cores in V2P-CA15_A7's Device Tree
      ARM: vexpress: extend the MPIDR range used for pen release check
      ARM: at91/dts: correct comment in at91sam9x5.dtsi for mii
      ARM: at91/at91_dt_defconfig: add at91sam9n12 SoC to DT defconfig
      ARM: at91/at91_dt_defconfig: remove memory specification to cmdline
      ARM: at91/dts: add macb mii pinctrl config for kizbox
      ARM: at91: rm9200: remake the BGA as default version
      ARM: at91: fix gpios on i2c-gpio for RM9200 DT
      ARM: at91/at91sam9x5 DTS: add SCK USART pins
      ARM: at91/at91sam9x5 DTS: correct wrong PIO BANK values on u(s)arts
      ARM: at91/at91-pinctrl documentation: fix typo and add some details
      ARM: kirkwood: fix missing #interrupt-cells property
      mmc: mvsdio: use devm_ API to simplify/correct error paths.
      clk: mvebu/clk-cpu.c: fix memory leakage
      ARM: OMAP2+: omap4-panda: add UART2 muxing for WiLink shared transport
      ARM: OMAP2+: DT node Timer iteration fix
      ARM: OMAP2+: Fix section warning for omap_init_ocp2scp()
      ARM: OMAP2+: fix build break for omapdrm
      ARM: OMAP2: Fix missing omap2xxx_clkt_vps_late_init function calls
      ...

commit 3836414f45b01486b9b50c627a329010573ad0f4
Merge: 60fd8e35e320 52666298aebe
Author: Olof Johansson <olof@lixom.net>
Date:   Thu Jan 24 08:12:24 2013 -0800

    Merge branch 'vexpress/fixes' of git://git.linaro.org/people/pawelmoll/linux into fixes
    
    From Pawel Moll:
    - makes the V2P-CA15_A7 (a.k.a. TC2) work with 3.8 kernels
    - improves vexpress-sysreg.c behaviour on arm64 platforms
    
    * 'vexpress/fixes' of git://git.linaro.org/people/pawelmoll/linux:
      mfd: vexpress-sysreg: Don't skip initialization on probe
      ARM: vexpress: Enable A7 cores in V2P-CA15_A7's Device Tree
      ARM: vexpress: extend the MPIDR range used for pen release check

commit 1585defb4ceca98b12bd6fba6802c22e77e172bb
Author: Lorenzo Pieralisi <Lorenzo.Pieralisi@arm.com>
Date:   Tue Jan 22 10:56:40 2013 +0000

    ARM: vexpress: extend the MPIDR range used for pen release check
    
    In ARM multi-cluster systems the MPIDR affinity level 0 cannot be used as a
    single cpu identifier, affinity levels 1 and 2 must be taken into account as
    well.
    This patch extends the MPIDR usage to affinity levels 1 and 2 in versatile
    secondary cores start up code in order to compare the passed pen_release
    value with the full-blown affinity mask.
    
    Signed-off-by: Lorenzo Pieralisi <lorenzo.pieralisi@arm.com>
    Signed-off-by: Liviu Dudau <liviu.dudau@arm.com>
    Acked-by: Nicolas Pitre <nico@linaro.org>
    Signed-off-by: Pawel Moll <pawel.moll@arm.com>

commit f7ed45be3ba524e06a6d933f0517dc7ad2d06703
Author: Christoffer Dall <c.dall@virtualopensystems.com>
Date:   Sun Jan 20 18:47:42 2013 -0500

    KVM: ARM: World-switch implementation
    
    Provides complete world-switch implementation to switch to other guests
    running in non-secure modes. Includes Hyp exception handlers that
    capture necessary exception information and stores the information on
    the VCPU and KVM structures.
    
    The following Hyp-ABI is also documented in the code:
    
    Hyp-ABI: Calling HYP-mode functions from host (in SVC mode):
       Switching to Hyp mode is done through a simple HVC #0 instruction. The
       exception vector code will check that the HVC comes from VMID==0 and if
       so will push the necessary state (SPSR, lr_usr) on the Hyp stack.
       - r0 contains a pointer to a HYP function
       - r1, r2, and r3 contain arguments to the above function.
       - The HYP function will be called with its arguments in r0, r1 and r2.
       On HYP function return, we return directly to SVC.
    
    A call to a function executing in Hyp mode is performed like the following:
    
            <svc code>
            ldr     r0, =BSYM(my_hyp_fn)
            ldr     r1, =my_param
            hvc #0  ; Call my_hyp_fn(my_param) from HYP mode
            <svc code>
    
    Otherwise, the world-switch is pretty straight-forward. All state that
    can be modified by the guest is first backed up on the Hyp stack and the
    VCPU values is loaded onto the hardware. State, which is not loaded, but
    theoretically modifiable by the guest is protected through the
    virtualiation features to generate a trap and cause software emulation.
    Upon guest returns, all state is restored from hardware onto the VCPU
    struct and the original state is restored from the Hyp-stack onto the
    hardware.
    
    SMP support using the VMPIDR calculated on the basis of the host MPIDR
    and overriding the low bits with KVM vcpu_id contributed by Marc Zyngier.
    
    Reuse of VMIDs has been implemented by Antonios Motakis and adapated from
    a separate patch into the appropriate patches introducing the
    functionality. Note that the VMIDs are stored per VM as required by the ARM
    architecture reference manual.
    
    To support VFP/NEON we trap those instructions using the HPCTR. When
    we trap, we switch the FPU.  After a guest exit, the VFP state is
    returned to the host.  When disabling access to floating point
    instructions, we also mask FPEXC_EN in order to avoid the guest
    receiving Undefined instruction exceptions before we have a chance to
    switch back the floating point state.  We are reusing vfp_hard_struct,
    so we depend on VFPv3 being enabled in the host kernel, if not, we still
    trap cp10 and cp11 in order to inject an undefined instruction exception
    whenever the guest tries to use VFP/NEON. VFP/NEON developed by
    Antionios Motakis and Rusty Russell.
    
    Aborts that are permission faults, and not stage-1 page table walk, do
    not report the faulting address in the HPFAR.  We have to resolve the
    IPA, and store it just like the HPFAR register on the VCPU struct. If
    the IPA cannot be resolved, it means another CPU is playing with the
    page tables, and we simply restart the guest.  This quirk was fixed by
    Marc Zyngier.
    
    Reviewed-by: Will Deacon <will.deacon@arm.com>
    Reviewed-by: Marcelo Tosatti <mtosatti@redhat.com>
    Signed-off-by: Rusty Russell <rusty@rustcorp.com.au>
    Signed-off-by: Antonios Motakis <a.motakis@virtualopensystems.com>
    Signed-off-by: Marc Zyngier <marc.zyngier@arm.com>
    Signed-off-by: Christoffer Dall <c.dall@virtualopensystems.com>

commit af487e4209ef5e82b1932b8b15fd59efbd56a955
Merge: 810a4855513b c6ba8d06ecfc
Author: Linus Torvalds <torvalds@linux-foundation.org>
Date:   Thu Dec 20 17:52:06 2012 -0800

    Merge branch 'misc' of git://git.kernel.org/pub/scm/linux/kernel/git/mmarek/kbuild
    
    Pull kbuild misc changes from Michal Marek:
     "This is the non-critical part of kbuild
    
       - scripts/kernel-doc requires a "Return:" section for non-void
         functions
       - ARCH=arm SUBARCH=... support for make tags
       - COMPILED_SOURCE=1 support for make tags (only indexes .c files for
         which a .o exists)
       - New coccinelle check
       - Option parsing fix for scripts/config"
    
    * 'misc' of git://git.kernel.org/pub/scm/linux/kernel/git/mmarek/kbuild:
      scripts/config: Fix wrong "shift" for --keep-case
      scripts/tags.sh: Support compiled source
      scripts/tags.sh: Support subarch for ARM
      scripts/coccinelle/misc/warn.cocci: use WARN
      scripts/kernel-doc: check that non-void fcts describe their return value
      Kernel-doc: Convention: Use a "Return" section to describe return values

commit 923e02ecf3f8db19d52176723fefa0ffe6e9a3cd
Author: Joonsoo Kim <js1304@gmail.com>
Date:   Tue Dec 11 00:11:46 2012 +0900

    scripts/tags.sh: Support compiled source
    
    We usually have interst in compiled files only,
    because they are strongly related to individual's work.
    Current tags.sh can't select compiled files, so support it.
    
    We can use this functionality like below.
    "make cscope O=. SRCARCH=xxxx COMPILED_SOURCE=compiled"
    
    It must be executed after building the kernel.
    
    Signed-off-by: Joonsoo Kim <js1304@gmail.com>
    Signed-off-by: Michal Marek <mmarek@suse.cz>

commit 1a1494def7eacbd25db05185aa2e81ef90892460
Merge: 8de9e417757f 71bfe916ebe6
Author: Dave Airlie <airlied@redhat.com>
Date:   Sat Dec 8 13:17:07 2012 +1000

    Merge branch 'drm-next-3.8' of git://people.freedesktop.org/~agd5f/linux into drm-next
    
    Alex writes:
    Pretty minor -next pull request.  We some additional new bits waiting
    internally for release.  Hopefully Monday we can get at least some of
    them out.  The others will probably take a few more weeks.
    
    Highlights of the current request:
    - ELD registers for passing audio information to the sound hardware
    - Handle GPUVM page faults more gracefully
    - Misc fixes
    
    Merge radeon test
    * 'drm-next-3.8' of git://people.freedesktop.org/~agd5f/linux: (483 commits)
      drm/radeon: bump driver version for new info ioctl requests
      drm/radeon: fix eDP clk and lane setup for scaled modes
      drm/radeon: add new INFO ioctl requests
      drm/radeon/dce32+: use fractional fb dividers for high clocks
      drm/radeon: use cached memory when evicting for vram on non agp
      drm/radeon: add a CS flag END_OF_FRAME
      drm/radeon: stop page faults from hanging the system (v2)
      drm/radeon/dce4/5: add registers for ELD handling
      drm/radeon/dce3.2: add registers for ELD handling
      radeon: fix pll/ctrc mapping on dce2 and dce3 hardware
      Linux 3.7-rc7
      powerpc/eeh: Do not invalidate PE properly
      Revert "drm/i915: enable rc6 on ilk again"
      ALSA: hda - Fix build without CONFIG_PM
      of/address: sparc: Declare of_iomap as an extern function for sparc again
      PM / QoS: fix wrong error-checking condition
      bnx2x: remove redundant warning log
      vxlan: fix command usage in its doc
      8139cp: revert "set ring address before enabling receiver"
      MPI: Fix compilation on MIPS with GCC 4.4 and newer
      ...
    
    Conflicts:
            drivers/gpu/drm/exynos/exynos_drm_encoder.c
            drivers/gpu/drm/exynos/exynos_drm_fbdev.c
            drivers/gpu/drm/nouveau/core/engine/disp/nv50.c

commit 7da2f8907ba51acd7d13dd62e71f14972e9b5161
Author: Manuel Lauss <manuel.lauss@gmail.com>
Date:   Thu Nov 22 11:58:22 2012 +0100

    MPI: Fix compilation on MIPS with GCC 4.4 and newer
    
    commit a3cea9894157c20a5b1ec08b7e0b5f2019740c10 upstream.
    
    Since 4.4 GCC on MIPS no longer recognizes the "h" constraint,
    leading to this build failure:
    
      CC      lib/mpi/generic_mpih-mul1.o
    lib/mpi/generic_mpih-mul1.c: In function 'mpihelp_mul_1':
    lib/mpi/generic_mpih-mul1.c:50:3: error: impossible constraint in 'asm'
    
    This patch updates MPI with the latest umul_ppm implementations for MIPS.
    
    Signed-off-by: Manuel Lauss <manuel.lauss@gmail.com>
    Cc: Linux-MIPS <linux-mips@linux-mips.org>
    Cc: Dmitry Kasatkin <dmitry.kasatkin@intel.com>
    Cc: James Morris <jmorris@namei.org>
    Patchwork: https://patchwork.linux-mips.org/patch/4612/
    Signed-off-by: Ralf Baechle <ralf@linux-mips.org>
    Cc: Shuah Khan <shuah.khan@hp.com>
    Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>

commit 5433889db1b04159054a9e6357f90c77970cf4ed
Author: Manuel Lauss <manuel.lauss@gmail.com>
Date:   Thu Nov 22 11:58:22 2012 +0100

    MPI: Fix compilation on MIPS with GCC 4.4 and newer
    
    commit a3cea9894157c20a5b1ec08b7e0b5f2019740c10 upstream.
    
    Since 4.4 GCC on MIPS no longer recognizes the "h" constraint,
    leading to this build failure:
    
      CC      lib/mpi/generic_mpih-mul1.o
    lib/mpi/generic_mpih-mul1.c: In function 'mpihelp_mul_1':
    lib/mpi/generic_mpih-mul1.c:50:3: error: impossible constraint in 'asm'
    
    This patch updates MPI with the latest umul_ppm implementations for MIPS.
    
    Signed-off-by: Manuel Lauss <manuel.lauss@gmail.com>
    Cc: Linux-MIPS <linux-mips@linux-mips.org>
    Cc: Dmitry Kasatkin <dmitry.kasatkin@intel.com>
    Cc: James Morris <jmorris@namei.org>
    Patchwork: https://patchwork.linux-mips.org/patch/4612/
    Signed-off-by: Ralf Baechle <ralf@linux-mips.org>
    Cc: Shuah Khan <shuah.khan@hp.com>
    Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>

commit ee0778a3015370779f603d2b6119a6ec2b1c811a
Author: Mark Asselstine <mark.asselstine@windriver.com>
Date:   Tue Oct 9 11:31:44 2012 -0400

    tools/power: turbostat: make Makefile a bit more capable
    
    The turbostat Makefile is pretty simple, its output is placed in the
    same directory as the source, the install rule has no concept of a
    prefix or sysroot, and you can set CC to use a specific compiler but
    not use the more familiar CROSS_COMPILE. By making a few minor changes
    these limitations are removed while leaving the default behavior
    matching what it used to be.
    
    Example build with these changes:
    make CROSS_COMPILE=i686-wrs-linux-gnu- DESTDIR=/tmp install
    
    or from the tools directory
    make CROSS_COMPILE=i686-wrs-linux-gnu- DESTDIR=/tmp turbostat_install
    
    Signed-off-by: Mark Asselstine <mark.asselstine@windriver.com>
    Signed-off-by: Len Brown <len.brown@intel.com>

commit d033a308d81ec83908760a15a841c2bd0d5e0ea3
Merge: c6c22955f80f e23739b4ade8
Author: Mauro Carvalho Chehab <mchehab@redhat.com>
Date:   Wed Nov 28 07:22:38 2012 -0200

    Merge remote-tracking branch 'linus/master' into staging/for_v3.8
    
    * linus/master: (1428 commits)
      futex: avoid wake_futex() for a PI futex_q
      watchdog: using u64 in get_sample_period()
      writeback: put unused inodes to LRU after writeback completion
      mm: vmscan: check for fatal signals iff the process was throttled
      Revert "mm: remove __GFP_NO_KSWAPD"
      proc: check vma->vm_file before dereferencing
      UAPI: strip the _UAPI prefix from header guards during header installation
      include/linux/bug.h: fix sparse warning related to BUILD_BUG_ON_INVALID
      Linux 3.7-rc7
      powerpc/eeh: Do not invalidate PE properly
      ALSA: hda - Fix build without CONFIG_PM
      of/address: sparc: Declare of_iomap as an extern function for sparc again
      PM / QoS: fix wrong error-checking condition
      bnx2x: remove redundant warning log
      vxlan: fix command usage in its doc
      8139cp: revert "set ring address before enabling receiver"
      MPI: Fix compilation on MIPS with GCC 4.4 and newer
      MIPS: Fix crash that occurs when function tracing is enabled
      MIPS: Merge overlapping bootmem ranges
      jbd: Fix lock ordering bug in journal_unmap_buffer()
      ...

commit c2a65d3d85a08b6c93da7b8664c89d1cd0682adf
Merge: 194d9831f041 a3cea9894157
Author: Linus Torvalds <torvalds@linux-foundation.org>
Date:   Sun Nov 25 17:55:04 2012 -0800

    Merge branch 'upstream' of git://git.linux-mips.org/pub/scm/ralf/upstream-linus
    
    Pull MIPS fixes from Ralf Baechle:
     "Three issues fixed accross the field:
    
       - Some functions that were recently outlined as part of a preemption
         fix were causing problems with function tracing.
       - The recently merged in-kernel MPI library uses very outdated
         headers that contain MIPS-specific code which won't build on with
         gcc 4.4 or newer.
       - The MIPS non-NUMA memory initialization was making only a very
         half-baked attempt at merging adjacent memory ranges.  This kept
         the code simple enough but is now causing issues with kexec."
    
    * 'upstream' of git://git.linux-mips.org/pub/scm/ralf/upstream-linus:
      MPI: Fix compilation on MIPS with GCC 4.4 and newer
      MIPS: Fix crash that occurs when function tracing is enabled
      MIPS: Merge overlapping bootmem ranges

commit a3cea9894157c20a5b1ec08b7e0b5f2019740c10
Author: Manuel Lauss <manuel.lauss@gmail.com>
Date:   Thu Nov 22 11:58:22 2012 +0100

    MPI: Fix compilation on MIPS with GCC 4.4 and newer
    
    Since 4.4 GCC on MIPS no longer recognizes the "h" constraint,
    leading to this build failure:
    
      CC      lib/mpi/generic_mpih-mul1.o
    lib/mpi/generic_mpih-mul1.c: In function 'mpihelp_mul_1':
    lib/mpi/generic_mpih-mul1.c:50:3: error: impossible constraint in 'asm'
    
    This patch updates MPI with the latest umul_ppm implementations for MIPS.
    
    Signed-off-by: Manuel Lauss <manuel.lauss@gmail.com>
    Cc: Linux-MIPS <linux-mips@linux-mips.org>
    Cc: Dmitry Kasatkin <dmitry.kasatkin@intel.com>
    Cc: James Morris <jmorris@namei.org>
    Patchwork: https://patchwork.linux-mips.org/patch/4612/
    Signed-off-by: Ralf Baechle <ralf@linux-mips.org>

commit 7f124aaf01439d2fa54283f3c375ce3b9fc776d4
Author: Lorenzo Pieralisi <lorenzo.pieralisi@arm.com>
Date:   Thu Nov 17 17:36:24 2011 +0000

    ARM: kernel: add logical mappings look-up
    
    In ARM SMP systems the MPIDR register ([23:0] bits) is used to uniquely
    identify CPUs.
    
    In order to retrieve the logical CPU index corresponding to a given
    MPIDR value and guarantee a consistent translation throughout the kernel,
    this patch adds a look-up based on the MPIDR[23:0] so that kernel subsystems
    can use it whenever the logical cpu index corresponding to a given MPIDR
    value is needed.
    
    Signed-off-by: Lorenzo Pieralisi <lorenzo.pieralisi@arm.com>
    Acked-by: Will Deacon <will.deacon@arm.com>
    Acked-by: Nicolas Pitre <nico@linaro.org>

commit 5587164eea4aad88fcb79d9b21dc8f14fea598cd
Author: Lorenzo Pieralisi <lorenzo.pieralisi@arm.com>
Date:   Wed Dec 14 16:01:24 2011 +0000

    ARM: kernel: add cpu logical map DT init in setup_arch
    
    As soon as the device tree is unflattened the cpu logical to physical
    mapping is carried out in setup_arch to build a proper array of MPIDR and
    corresponding logical indexes.
    
    The mapping could have been carried out using the flattened DT blob and
    related primitives, but since the mapping is not needed by early boot
    code it can safely be executed when the device tree has been uncompressed to
    its tree data structure.
    
    This patch adds the arm_dt_init_cpu maps() function call in setup_arch().
    
    If the kernel is not compiled with DT support the function is empty and
    no logical mapping takes place through it; the mapping carried out in
    smp_setup_processor_id() is left unchanged.
    If DT is supported the mapping created in smp_setup_processor_id() is overriden.
    The DT mapping also sets the possible cpus mask, hence platform
    code need not set it again in the respective smp_init_cpus() functions.
    
    Signed-off-by: Lorenzo Pieralisi <lorenzo.pieralisi@arm.com>
    Acked-by: Will Deacon <will.deacon@arm.com>
    Acked-by: Nicolas Pitre <nico@linaro.org>

commit a0ae02405076ac32bd17ece976e914b5b6075bb0
Author: Lorenzo Pieralisi <lorenzo.pieralisi@arm.com>
Date:   Thu Nov 17 17:31:51 2011 +0000

    ARM: kernel: add device tree init map function
    
    When booting through a device tree, the kernel cpu logical id map can be
    initialized using device tree data passed by FW or through an embedded blob.
    
    This patch adds a function that parses device tree "cpu" nodes and
    retrieves the corresponding CPUs hardware identifiers (MPIDR).
    It sets the possible cpus and the cpu logical map values according to
    the number of CPUs defined in the device tree and respective properties.
    
    The device tree HW identifiers are considered valid if all CPU nodes contain
    a "reg" property, there are no duplicate "reg" entries and the DT defines a
    CPU node whose "reg" property matches the MPIDR[23:0] of the boot CPU.
    
    The primary CPU is assigned cpu logical number 0 to keep the current convention
    valid.
    
    Current bindings documentation is included in the patch:
    
    Documentation/devicetree/bindings/arm/cpus.txt
    
    Signed-off-by: Lorenzo Pieralisi <lorenzo.pieralisi@arm.com>
    Acked-by: Nicolas Pitre <nico@linaro.org>

commit cb8cf4f821044f140ea5b9c8d4f816f0c05fab44
Author: Lorenzo Pieralisi <lorenzo.pieralisi@arm.com>
Date:   Thu Nov 8 18:05:56 2012 +0000

    ARM: kernel: smp_setup_processor_id() updates
    
    This patch applies some basic changes to the smp_setup_processor_id()
    ARM implementation to make the code that builds cpu_logical_map more
    uniform across the kernel.
    
    The function now prints the full extent of the boot CPU MPIDR[23:0] and
    initializes the cpu_logical_map for CPUs up to nr_cpu_ids.
    
    Signed-off-by: Lorenzo Pieralisi <lorenzo.pieralisi@arm.com>
    Acked-by: Nicolas Pitre <nico@linaro.org>
    Acked-by: Will Deacon <will.deacon@arm.com>

commit 71db5bfec1349afcbfbd71268c01c658c357b4f3
Author: Lorenzo Pieralisi <lorenzo.pieralisi@arm.com>
Date:   Fri Nov 16 15:24:06 2012 +0000

    ARM: kernel: update topology to use new MPIDR macros
    
    This patch updates the topology initialization code to use the newly
    defined accessors to retrieve the MPIDR affinity levels.
    
    Signed-off-by: Lorenzo Pieralisi <lorenzo.pieralisi@arm.com>
    Acked-by: Will Deacon <will.deacon@arm.com>
    Acked-by: Nicolas Pitre <nico@linaro.org>

commit dca463daa0151c5bbbd8ec8fd42882a3966d3c44
Author: Lorenzo Pieralisi <lorenzo.pieralisi@arm.com>
Date:   Thu Nov 15 17:30:32 2012 +0000

    ARM: kernel: enhance MPIDR macro definitions
    
    Kernel subsystems other than the topology layer need the MPIDR
    mask definitions to access the MPIDR without relying on hardcoded
    masks. This patch moves the MPIDR register masks definition to
    a header file and defines a macro to simplify access to MPIDR bit fields
    representing affinity levels.
    
    Signed-off-by: Lorenzo Pieralisi <lorenzo.pieralisi@arm.com>
    Acked-by: Will Deacon <will.deacon@arm.com>
    Acked-by: Nicolas Pitre <nico@linaro.org>

commit d25282d1c9b9bc4cda7f9d3c0205108e99aa7a9d
Merge: b6eea87fc685 dbadc17683e6
Author: Linus Torvalds <torvalds@linux-foundation.org>
Date:   Sun Oct 14 13:39:34 2012 -0700

    Merge branch 'modules-next' of git://git.kernel.org/pub/scm/linux/kernel/git/rusty/linux
    
    Pull module signing support from Rusty Russell:
     "module signing is the highlight, but it's an all-over David Howells frenzy..."
    
    Hmm "Magrathea: Glacier signing key". Somebody has been reading too much HHGTTG.
    
    * 'modules-next' of git://git.kernel.org/pub/scm/linux/kernel/git/rusty/linux: (37 commits)
      X.509: Fix indefinite length element skip error handling
      X.509: Convert some printk calls to pr_devel
      asymmetric keys: fix printk format warning
      MODSIGN: Fix 32-bit overflow in X.509 certificate validity date checking
      MODSIGN: Make mrproper should remove generated files.
      MODSIGN: Use utf8 strings in signer's name in autogenerated X.509 certs
      MODSIGN: Use the same digest for the autogen key sig as for the module sig
      MODSIGN: Sign modules during the build process
      MODSIGN: Provide a script for generating a key ID from an X.509 cert
      MODSIGN: Implement module signature checking
      MODSIGN: Provide module signing public keys to the kernel
      MODSIGN: Automatically generate module signing keys if missing
      MODSIGN: Provide Kconfig options
      MODSIGN: Provide gitignore and make clean rules for extra files
      MODSIGN: Add FIPS policy
      module: signature checking hook
      X.509: Add a crypto key parser for binary (DER) X.509 certificates
      MPILIB: Provide a function to read raw data into an MPI
      X.509: Add an ASN.1 decoder
      X.509: Add simple ASN.1 grammar compiler
      ...

commit 48ba2462ace6072741fd8d0058207d630ce93bf1
Author: David Howells <dhowells@redhat.com>
Date:   Wed Sep 26 10:11:03 2012 +0100

    MODSIGN: Implement module signature checking
    
    Check the signature on the module against the keys compiled into the kernel or
    available in a hardware key store.
    
    Currently, only RSA keys are supported - though that's easy enough to change,
    and the signature is expected to contain raw components (so not a PGP or
    PKCS#7 formatted blob).
    
    The signature blob is expected to consist of the following pieces in order:
    
     (1) The binary identifier for the key.  This is expected to match the
         SubjectKeyIdentifier from an X.509 certificate.  Only X.509 type
         identifiers are currently supported.
    
     (2) The signature data, consisting of a series of MPIs in which each is in
         the format of a 2-byte BE word sizes followed by the content data.
    
     (3) A 12 byte information block of the form:
    
            struct module_signature {
                    enum pkey_algo          algo : 8;
                    enum pkey_hash_algo     hash : 8;
                    enum pkey_id_type       id_type : 8;
                    u8                      __pad;
                    __be32                  id_length;
                    __be32                  sig_length;
            };
    
         The three enums are defined in crypto/public_key.h.
    
         'algo' contains the public-key algorithm identifier (0->DSA, 1->RSA).
    
         'hash' contains the digest algorithm identifier (0->MD4, 1->MD5, 2->SHA1,
          etc.).
    
         'id_type' contains the public-key identifier type (0->PGP, 1->X.509).
    
         '__pad' should be 0.
    
         'id_length' should contain in the binary identifier length in BE form.
    
         'sig_length' should contain in the signature data length in BE form.
    
         The lengths are in BE order rather than CPU order to make dealing with
         cross-compilation easier.
    
    Signed-off-by: David Howells <dhowells@redhat.com>
    Signed-off-by: Rusty Russell <rusty@rustcorp.com.au> (minor Kconfig fix)

commit 1ea4f4f8405cc1ceec23f2d261bc3775785e6712
Merge: dea77ccdc934 70cefe765433
Author: Linus Torvalds <torvalds@linux-foundation.org>
Date:   Tue Oct 9 16:11:46 2012 +0900

    Merge tag 'xtensa-next-20121008' of git://github.com/czankel/xtensa-linux
    
    Pull Xtensa patchset from Chris Zankel:
     "The Xtensa tree has been broken for some time now, and this patchset
      brings it back to life.  It has been part of the linux-next tree for
      some time.
    
      Most changes are inside the xtensa subdirectory; the other changes
      mostly add another rule to already existing #ifdefs to exclude Xtensa,
      where required.  The only 'common' change is to add two more sections
      ('.xt.prop' and '.xt.lit') to the white list in modpost."
    
    * tag 'xtensa-next-20121008' of git://github.com/czankel/xtensa-linux: (27 commits)
      xtensa: Setup CROSS_COMPILE at the top
      xtensa: drop CONFIG_EMBEDDED_RAMDISK
      xtensa: fix TIOCGSERIAL and TIOCSSERIAL definitions
      xtensa: provide dummy gcc intrinsics
      xtensa: add missing symbol exports
      parport: disable for xtensa arch
      xtensa: rename MISC SR definition to avoid name clashes
      hisax: disable build for big-endian xtensa
      xtensa: fix CODA build
      xtensa: fix parallel make
      xtensa: ISS: drop unused io.c
      xtensa: ISS: exit simulator in case of halt or poweroff
      xtensa: ISS: change keyboard polling rate
      xtensa: ISS: add platform_pcibios_init
      xtensa: ISS: add dummy serial.h for ISS platform
      xtensa: change default platform clock frequency to 10MHz
      xtensa: add ARCH_WANT_OPTIONAL_GPIOLIB to xtensa config
      xtensa: set NO_IOPORT to 'n' by default
      xtensa: adopt generic io routines
      xtensa: fix ioremap
      ...

commit e1045992949160b56309b730b8bdc428f2f8b69e
Author: David Howells <dhowells@redhat.com>
Date:   Mon Sep 24 17:11:27 2012 +0100

    MPILIB: Provide a function to read raw data into an MPI
    
    Provide a function to read raw data of a predetermined size into an MPI rather
    than expecting the size to be encoded within the data.  The data is assumed to
    represent an unsigned integer, and the resulting MPI will be positive.
    
    The function looks like this:
    
            MPI mpi_read_raw_data(const void *, size_t);
    
    This is useful for reading ASN.1 integer primitives where the length is encoded
    in the ASN.1 metadata.
    
    Signed-off-by: David Howells <dhowells@redhat.com>
    Signed-off-by: Rusty Russell <rusty@rustcorp.com.au>

commit 0b1568a4536ff287a87908d7fc35c05bd7736a53
Author: David Howells <dhowells@redhat.com>
Date:   Fri Sep 21 23:28:05 2012 +0100

    RSA: Fix signature verification for shorter signatures
    
    gpg can produce a signature file where length of signature is less than the
    modulus size because the amount of space an MPI takes up is kept as low as
    possible by discarding leading zeros.  This regularly happens for several
    modules during the build.
    
    Fix it by relaxing check in RSA verification code.
    
    Thanks to Tomas Mraz and Miloslav Trmac for help.
    
    Signed-off-by: Milan Broz <mbroz@redhat.com>
    Signed-off-by: David Howells <dhowells@redhat.com>
    Signed-off-by: Rusty Russell <rusty@rustcorp.com.au>

commit 12f008b6dc5ff1c822fdb2198d20e3dbdc92f3f5
Author: David Howells <dhowells@redhat.com>
Date:   Fri Sep 21 23:25:22 2012 +0100

    MPILIB: Reinstate mpi_cmp[_ui]() and export for RSA signature verification
    
    Reinstate and export mpi_cmp() and mpi_cmp_ui() from the MPI library for use by
    RSA signature verification as per RFC3447 section 5.2.2 step 1.
    
    Signed-off-by: David Howells <dhowells@redhat.com>
    Signed-off-by: Rusty Russell <rusty@rustcorp.com.au>

commit 4ae71c1dce1e3d2270a0755988033e236b8e45d6
Author: David Howells <dhowells@redhat.com>
Date:   Fri Sep 21 23:25:04 2012 +0100

    KEYS: Provide signature verification with an asymmetric key
    
    Provide signature verification using an asymmetric-type key to indicate the
    public key to be used.
    
    The API is a single function that can be found in crypto/public_key.h:
    
            int verify_signature(const struct key *key,
                                 const struct public_key_signature *sig)
    
    The first argument is the appropriate key to be used and the second argument
    is the parsed signature data:
    
            struct public_key_signature {
                    u8 *digest;
                    u16 digest_size;
                    enum pkey_hash_algo pkey_hash_algo : 8;
                    union {
                            MPI mpi[2];
                            struct {
                                    MPI s;          /* m^d mod n */
                            } rsa;
                            struct {
                                    MPI r;
                                    MPI s;
                            } dsa;
                    };
            };
    
    This should be filled in prior to calling the function.  The hash algorithm
    should already have been called and the hash finalised and the output should
    be in a buffer pointed to by the 'digest' member.
    
    Any extra data to be added to the hash by the hash format (eg. PGP) should
    have been added by the caller prior to finalising the hash.
    
    It is assumed that the signature is made up of a number of MPI values.  If an
    algorithm becomes available for which this is not the case, the above structure
    will have to change.
    
    It is also assumed that it will have been checked that the signature algorithm
    matches the key algorithm.
    
    Signed-off-by: David Howells <dhowells@redhat.com>
    Signed-off-by: Rusty Russell <rusty@rustcorp.com.au>

commit aacf29bf1bf133f6219e6f8969d4ebc2ac76458f
Author: David Howells <dhowells@redhat.com>
Date:   Thu Sep 13 13:09:33 2012 +0100

    MPILIB: Provide count_leading/trailing_zeros() based on arch functions
    
    Provide count_leading/trailing_zeros() macros based on extant arch bit scanning
    functions rather than reimplementing from scratch in MPILIB.
    
    Whilst we're at it, turn count_foo_zeros(n, x) into n = count_foo_zeros(x).
    
    Also move the definition to asm-generic as other people may be interested in
    using it.
    
    Signed-off-by: David Howells <dhowells@redhat.com>
    Cc: David S. Miller <davem@davemloft.net>
    Cc: Dmitry Kasatkin <dmitry.kasatkin@intel.com>
    Cc: Arnd Bergmann <arnd@arndb.com>
    Signed-off-by: Rusty Russell <rusty@rustcorp.com.au>

commit 70cefe765433529fc894fd1995a1d5883cb33e05
Author: Geert Uytterhoeven <geert@linux-m68k.org>
Date:   Sat May 12 22:39:08 2012 +0200

    xtensa: Setup CROSS_COMPILE at the top
    
    CROSS_COMPILE must be setup before using e.g. cc-option (and a few other
    as-*, cc-*, ld-* macros), else they will check against the wrong compiler
    when cross-compiling, and may invoke the cross compiler with wrong or
    suboptimal compiler options.
    
    Signed-off-by: Geert Uytterhoeven <geert@linux-m68k.org>
    Signed-off-by: Chris Zankel <chris@zankel.net>

commit 0a4081641d722d3dee140505a86330ecf44db0fe
Author: Varun Sethi <Varun.Sethi@freescale.com>
Date:   Wed Aug 8 09:36:09 2012 +0530

    powerpc/mpic: FSL MPIC error interrupt support.
    
    All SOC device error interrupts are muxed and delivered to the core
    as a single MPIC error interrupt. Currently all the device drivers
    requiring access to device errors have to register for the MPIC error
    interrupt as a shared interrupt.
    
    With this patch we add interrupt demuxing capability in the mpic driver,
    allowing device drivers to register for their individual error interrupts.
    This is achieved by handling error interrupts in a cascaded fashion.
    
    MPIC error interrupt is handled by the "error_int_handler", which
    subsequently demuxes it using the EISR and delivers it to the respective
    drivers.
    
    The error interrupt capability is dependent on the MPIC EIMR register,
    which was introduced in FSL MPIC version 4.1 (P4080 rev2). So, error
    interrupt demuxing capability is dependent on the MPIC version and can
    be used for versions >= 4.1.
    
    Signed-off-by: Varun Sethi <Varun.Sethi@freescale.com>
    Signed-off-by: Bogdan Hamciuc <bogdan.hamciuc@freescale.com>
    Signed-off-by: Kumar Gala <galak@kernel.crashing.org>

commit 8c79d6267b5dbf98e1b275e3e3b74f3467ba618a
Author: sreekanth.reddy@lsi.com <sreekanth.reddy@lsi.com>
Date:   Tue Jul 17 15:56:10 2012 +0530

    [SCSI] mpt2sas : MPI 2.0 Rev V(2.0.14) specification
    
    Changeset in MPI 2.0 Rev V(2.0.14) specification
    
            1) Bumped MPI2_HEADER_VERSION_UNIT.
            2) Added a product specific range to event values.
            3) Added clarification to Direct-Attached SAS PHY Power condition.
            4) Updated timing requirements for performing Hard Reset.
    
    Signed-off-by: Sreekanth Reddy <sreekanth.reddy@lsi.com>
    Signed-off-by: James Bottomley <JBottomley@Parallels.com>

commit 52b5c0d485385d3c767d979496983ca2b6987f5c
Author: Namhyung Kim <namhyung.kim@lge.com>
Date:   Fri Jul 6 16:21:32 2012 +0900

    tools lib traceevent: Detect build environment changes
    
    Cross compiling perf requires setting ARCH and CROSS_COMPILE variables,
    but libtraceevent couldn't detect the changes so it ends up believing no
    recompiling is required. Thus the linker failed like:
    
         LINK perf
     ../lib/traceevent//libtraceevent.a: member ../lib/traceevent//libtraceevent.a(event-parse.o) in archive is not an object
     collect2: ld returned 1 exit status
     make: *** [perf] Error 1
    
    This patch fixes this by adding TRACEEVENT-CFLAGS file like
    PERF-CFLAGS to track those changes.
    
    Signed-off-by: Namhyung Kim <namhyung@kernel.org>
    Cc: David Ahern <dsahern@gmail.com>
    Cc: Ingo Molnar <mingo@kernel.org>
    Cc: Jiri Olsa <jolsa@redhat.com>
    Cc: Paul Mackerras <paulus@samba.org>
    Cc: Peter Zijlstra <a.p.zijlstra@chello.nl>
    Link: http://lkml.kernel.org/r/1341559297-25725-2-git-send-email-namhyung@kernel.org
    Signed-off-by: Arnaldo Carvalho de Melo <acme@redhat.com>

commit e05644e17e744315bce12b0948cdc36910b9a76e
Merge: 97e7292ab5cc 663728418e34
Author: Linus Torvalds <torvalds@linux-foundation.org>
Date:   Mon Jul 23 18:49:06 2012 -0700

    Merge branch 'next' of git://git.kernel.org/pub/scm/linux/kernel/git/jmorris/linux-security
    
    Pull security subsystem updates from James Morris:
     "Nothing groundbreaking for this kernel, just cleanups and fixes, and a
      couple of Smack enhancements."
    
    * 'next' of git://git.kernel.org/pub/scm/linux/kernel/git/jmorris/linux-security: (21 commits)
      Smack: Maintainer Record
      Smack: don't show empty rules when /smack/load or /smack/load2 is read
      Smack: user access check bounds
      Smack: onlycap limits on CAP_MAC_ADMIN
      Smack: fix smack_new_inode bogosities
      ima: audit is compiled only when enabled
      ima: ima_initialized is set only if successful
      ima: add policy for pseudo fs
      ima: remove unused cleanup functions
      ima: free securityfs violations file
      ima: use full pathnames in measurement list
      security: Fix nommu build.
      samples: seccomp: add .gitignore for untracked executables
      tpm: check the chip reference before using it
      TPM: fix memleak when register hardware fails
      TPM: chip disabled state erronously being reported as error
      MAINTAINERS: TPM maintainers' contacts update
      Merge branches 'next-queue' and 'next' into next
      Remove unused code from MPI library
      Revert "crypto: GnuPG based MPI lib - additional sources (part 4)"
      ...

commit f01b9b73f57f4f92d39bba0d9aa4a38f318212df
Merge: fde754302781 66314223aa5e
Author: Linus Torvalds <torvalds@linux-foundation.org>
Date:   Mon Jul 23 16:31:31 2012 -0700

    Merge tag 'newsoc' of git://git.kernel.org/pub/scm/linux/kernel/git/arm/arm-soc
    
    Pull support for three new arm SoC types from Arnd Bergmann:
    
     - The mvebu platform includes Marvell's Armada XP and Armada 370 chips,
       made by the mvebu business unit inside of Marvell.  Since the same
       group also made the older but similar platforms we call "orion5x",
       "kirkwood", "mv78xx0" and "dove", we plan to move all of them into
       the mach-mvebu directory in the future.
    
     - socfpga is Altera's platform based on Cortex-A9 cores and a lot of
       FPGA space.  This is similar to the Xilinx zynq platform we already
       support.  The code is particularly clean, which is helped by the fact
       that the hardware doesn't do much besides the parts that are expected
       to get added in the FPGA.
    
     - The OMAP subarchitecture gains support for the latest generation, the
       OMAP5 based on the new Cortex-A15 core.  Support is rather
       rudimentary for now, but will be extended in the future.
    
    * tag 'newsoc' of git://git.kernel.org/pub/scm/linux/kernel/git/arm/arm-soc: (25 commits)
      ARM: socfpga: initial support for Altera's SOCFPGA platform
      arm: mvebu: generate DTBs for supported SoCs
      ARM: mvebu: MPIC: read number of interrupts from control register
      arm: mach-mvebu: add entry to MAINTAINERS
      arm: mach-mvebu: add compilation/configuration change
      arm: mach-mvebu: add defconfig
      arm: mach-mvebu: add documentation for new device tree bindings
      arm: mach-mvebu: add support for Armada 370 and Armada XP with DT
      arm: mach-mvebu: add source files
      arm: mach-mvebu: add header
      clocksource: time-armada-370-xp: Marvell Armada 370/XP SoC timer driver
      ARM: Kconfig update to support additional GPIOs in OMAP5
      ARM: OMAP5: Add the build support
      arm/dts: OMAP5: Add omap5 dts files
      ARM: OMAP5: board-generic: Add device tree support
      ARM: omap2+: board-generic: clean up the irq data from board file
      ARM: OMAP5: Add SMP support
      ARM: OMAP5: Add the WakeupGen IP updates
      ARM: OMAP5: l3: Add l3 error handler support for omap5
      ARM: OMAP5: gpmc: Update gpmc_init()
      ...
    
    Conflicts:
            Documentation/devicetree/bindings/arm/omap/omap.txt
            arch/arm/mach-omap2/Makefile
            drivers/clocksource/Kconfig
            drivers/clocksource/Makefile

commit 81ab1f74ef4695b14665dc412cb7ab804801373d
Merge: 6887a4131da3 f3e16ccd03fa
Author: Arnd Bergmann <arnd@arndb.de>
Date:   Tue Jul 10 15:49:09 2012 +0200

    Merge branch 'mvebu/newsoc' into next/newsoc
    
    From: Thomas Petazzoni <thomas.petazzoni@free-electrons.com>
    
    You'll find in this patch set the nineth version of the initial
    support for a new family of ARMv7-compatible Marvell SoCs.
    
    As for the previous releases, both the Armada 370 and the Armada XP
    SoCs are supported in this directory, and we are able to build a
    single kernel image that boots on both SoCs. Both SoCs use the PJ4B
    processor, a Marvell-developed ARM core that implements the ARMv7
    instruction set. We are currently using Marvell evaluation boards for
    both of those SoCs, and the support for those boards is added in this
    patch set.
    
    This patch set, and the support for those SoCs, started as a
    collaborative effort from Marvell engineers (who have done the initial
    development work) and Free Electrons engineers (who are reshaping the
    code for mainline submission, adding device tree support, etc.). This
    effort has also received contributions from Ben Dooks from Codethink.
    
    * mvebu/newsoc:
      ARM: mvebu: MPIC: read number of interrupts from control register
      arm: mach-mvebu: add entry to MAINTAINERS
      arm: mach-mvebu: add compilation/configuration change
      arm: mach-mvebu: add defconfig
      arm: mach-mvebu: add documentation for new device tree bindings
      arm: mach-mvebu: add support for Armada 370 and Armada XP with DT
      arm: mach-mvebu: add source files
      arm: mach-mvebu: add header
      clocksource: time-armada-370-xp: Marvell Armada 370/XP SoC timer driver
    
    Changes from Arnd
    * Pulled from git://github.com/Marvell-Semi/EBU_mainline_public.git mvebu_for-next-V9
    * rebased onto v3.5-rc5 because it was originally based on
      an old arm-soc/for-next branch
    
    Signed-off-by: Arnd Bergmann <arnd@arndb.de>

commit f3e16ccd03fab2f8440609bd44feb882b5fdd31d
Author: Ben Dooks <ben.dooks@codethink.co.uk>
Date:   Mon Jun 4 18:50:12 2012 +0200

    ARM: mvebu: MPIC: read number of interrupts from control register
    
    Read the number of MPIC interrupts from the controller and only register
    that many.
    
    [gregory.clement@free-electrons.com: rename armada symbol name to fit
    with new name: armada_370_xp]
    
    Signed-off-by: Ben Dooks <ben.dooks@codethink.co.uk>
    Signed-off-by: Gregory CLEMENT <gregory.clement@free-electrons.com>
    Signed-off-by: Thomas Petazzoni <thomas.petazzoni@free-electrons.com>
    Signed-off-by: Lior Amsalem <alior@marvell.com>

commit 5a271fe784e799cfeaeac7792b1c87b837e41cbd
Author: Varun Sethi <Varun.Sethi@freescale.com>
Date:   Mon Jul 9 14:16:35 2012 +0530

    powerpc/mpic: Use the MPIC_LARGE_VECTORS flag for FSL MPIC.
    
    We should use the MPIC_LARG_VECTORS flag while intializing the MPIC.
    This prevents us from eating in to hardware vector number space (MSIs)
    while setting up internal sources.
    
    Signed-off-by: Varun Sethi <Varun.Sethi@freescale.com>
    Signed-off-by: Kumar Gala <galak@kernel.crashing.org>

commit a1f42beb8e287482d1a802731d4fb7e2bdc2c703
Author: Paul Mundt <lethal@linux-sh.org>
Date:   Mon Jun 18 13:48:08 2012 +0900

    Makefile: fix up CROSS_COMPILE and READABLE_ASM interaction.
    
    When the READABLE_ASM cc-option tests were added they were done so prior
    to the arch Makefile include, resulting in cc-option being run on the
    host cc instead of the factoring in the cross prefix set up by the
    architecture.
    
    This bumps the include back up so that cc-option actually runs on the
    compiler that we're building with.
    
    Cc: Andi Kleen <andi@firstfloor.org>
    Signed-off-by: Paul Mundt <lethal@linux-sh.org>
    Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>

commit 790b9d4bb7614252e133d4a99ef18c1734d69163
Merge: c02feeea3dad 380622e9ff56
Author: Linus Torvalds <torvalds@linux-foundation.org>
Date:   Wed Jun 13 23:19:34 2012 +0300

    Merge tag 'sh-for-linus' of git://github.com/pmundt/linux-sh
    
    Pull SuperH fixes from Paul Mundt.
    
    * tag 'sh-for-linus' of git://github.com/pmundt/linux-sh:
      sh: Kill off additional asm-generic wrappers.
      sh: Setup CROSS_COMPILE at the top
      sh: Fix up link time defsym warnings.
      sh: use the new generic strnlen_user() function
      sh: switch to generic strncpy_from_user().
      sh: Kill off last dead UBC header
      serial: sh-sci: Make probe fail for ports that exceed the maximum count
      serial: sh-sci: Fix probe error paths
      clocksource: sh_tmu: Use clockevents_config_and_register().
      clocksource: sh_tmu: Convert timer lock to raw spinlock.
      clocksource: sh_mtu2: Convert timer lock to raw spinlock.
      clocksource: sh_cmt: Convert timer lock to raw spinlock.
      bug.h: need linux/kernel.h for TAINT_WARN.
      sh: convert to kbuild asm-generic support.
      sh64: Fix up fallout from generic init_task conversion.
      sh: arch/sh/kernel/process.c needs asm/fpu.h for unlazy_fpu().

commit d14a5fdc26986f7bac8376a339f336be18ba2a90
Author: Geert Uytterhoeven <geert@linux-m68k.org>
Date:   Sat May 12 22:39:07 2012 +0200

    sh: Setup CROSS_COMPILE at the top
    
    CROSS_COMPILE must be setup before using e.g. cc-option (and a few other
    as-*, cc-*, ld-* macros), else they will check against the wrong compiler
    when cross-compiling, and may invoke the cross compiler with wrong or
    suboptimal compiler options.
    
    Signed-off-by: Geert Uytterhoeven <geert@linux-m68k.org>
    Cc: Paul Mundt <lethal@linux-sh.org>
    Cc: linux-sh@vger.kernel.org
    Signed-off-by: Paul Mundt <lethal@linux-sh.org>

commit 7cf4206a99d1b3e61bdbc7cbbf4a7bf6a9dfcc68
Author: Dmitry Kasatkin <dmitry.kasatkin@intel.com>
Date:   Wed May 9 17:37:56 2012 +0300

    Remove unused code from MPI library
    
    MPI library is used by RSA verification implementation.
    Few files contains functions which are never called.
    
    James Morris has asked to remove all of them.
    
    Signed-off-by: Dmitry Kasatkin <dmitry.kasatkin@intel.com>
    Requested-by: James Morris <james.l.morris@oracle.com>
    Signed-off-by: James Morris <james.l.morris@oracle.com>

commit 9e235dcaf4f63d88a7e9ce5735ba5c2eb2719603
Author: Dmitry Kasatkin <dmitry.kasatkin@intel.com>
Date:   Wed May 9 17:37:55 2012 +0300

    Revert "crypto: GnuPG based MPI lib - additional sources (part 4)"
    
    This reverts commit 7e8dec918ef8e0f68b4937c3c50fa57002077a4d.
    
    RSA verification implementation does not use this code.
    James Morris has asked to remove that.
    
    Signed-off-by: Dmitry Kasatkin <dmitry.kasatkin@intel.com>
    Requested-by: James Morris <james.l.morris@oracle.com>
    Signed-off-by: James Morris <james.l.morris@oracle.com>

commit eaec12d7f526694f24d581a4ad23de6ce0315cd2
Author: Namhyung Kim <namhyung.kim@lge.com>
Date:   Wed May 23 11:36:56 2012 +0900

    tools lib traceevent: Fix signature of create_arg_item()
    
    The @type should be a type of enum event_type not enum filter_arg_type.
    
    This fixes following warning:
    
     $ make
      COMPILE FPIC           parse-events.o
      COMPILE FPIC           parse-filter.o
    /home/namhyung/project/trace-cmd/parse-filter.c: In function create_arg_item:
    /home/namhyung/project/trace-cmd/parse-filter.c:343:9: warning: comparison between enum filter_arg_type and enum event_type [-Wenum-compare]
    /home/namhyung/project/trace-cmd/parse-filter.c:339:2: warning: case value 8 not in enumerated type enum filter_arg_type [-Wswitch]
      BUILD STATIC LIB       libparsevent.a
      BUILD STATIC LIB       libtracecmd.a
      BUILD                  trace-cmd
    /usr/bin/make -C /home/namhyung/project/trace-cmd/Documentation all
    make[1]: Nothing to be done for `all'.
    Note: to build the gui, type "make gui"
    
    Cc: Borislav Petkov <bp@alien8.de>
    Cc: David Ahern <dsahern@gmail.com>
    Cc: Frederic Weisbecker <fweisbec@gmail.com>
    Cc: Ingo Molnar <mingo@kernel.org>
    Cc: Namhyung Kim <namhyung@gmail.com>
    Cc: Paul Mackerras <paulus@samba.org>
    Cc: Peter Zijlstra <a.p.zijlstra@chello.nl>
    Link: http://lkml.kernel.org/r/1337740619-27925-20-git-send-email-namhyung.kim@lge.com
    Signed-off-by: Namhyung Kim <namhyung.kim@lge.com>
    Signed-off-by: Steven Rostedt <rostedt@goodmis.org>
    Signed-off-by: Arnaldo Carvalho de Melo <acme@redhat.com>

commit 881bcabbde8bc13854a2cb30847abe181d31c5fd
Merge: e60b9a0346ee f25e918e3546
Author: Linus Torvalds <torvalds@linux-foundation.org>
Date:   Mon May 21 12:43:54 2012 -0700

    Merge branch 'for-linus' of git://git.kernel.org/pub/scm/linux/kernel/git/geert/linux-m68k
    
    Pull m68k updates from Geert Uytterhoeven.
    
    * 'for-linus' of git://git.kernel.org/pub/scm/linux/kernel/git/geert/linux-m68k:
      m68k: Setup CROSS_COMPILE at the top
      m68k: Correct the Atari ALLOWINT definition
      m68k/video: Create <asm/vga.h>
      m68k: Make sure {read,write}s[bwl]() are always defined
      m68k/mm: Port OOM changes to do_page_fault()
      scsi/atari: Make more functions static
      scsi/atari: Revive "atascsi=" setup option
      net/ariadne: Improve debug prints
      m68k/atari: Change VME irq numbers from unsigned long to unsigned int
      m68k/amiga: Use arch_initcall() for registering platform devices
      m68k/amiga: Add error checks when registering platform devices
      m68k/amiga: Mark z_dev_present() __init
      m68k: Remove unused MAX_NOINT_IPL definition

commit ec3eead217181d7360a11317a888ceb30807867c
Author: Vipul Pandya <vipul@chelsio.com>
Date:   Fri May 18 15:29:32 2012 +0530

    RDMA/cxgb4: Remove kfifo usage
    
    Using kfifos for ID management was limiting the number of QPs and
    preventing NP384 MPI jobs.  So replace it with a simple bitmap
    allocator.
    
    Remove IDs from the IDR tables before deallocating them.  This bug was
    causing the BUG_ON() in insert_handle() to fire because the ID was
    getting reused before being removed from the IDR table.
    
    Signed-off-by: Vipul Pandya <vipul@chelsio.com>
    Signed-off-by: Steve Wise <swise@opengridcomputing.com>
    Signed-off-by: Roland Dreier <roland@purestorage.com>

commit f25e918e3546477948be999c3a7d56b316d74e4b
Author: Geert Uytterhoeven <geert@linux-m68k.org>
Date:   Sat May 12 22:14:36 2012 +0200

    m68k: Setup CROSS_COMPILE at the top
    
    CROSS_COMPILE must be setup before using e.g. cc-option (and a few other
    as-*, cc-*, ld-* macros), else they will check against the wrong compiler
    when cross-compiling, and may invoke the cross compiler with wrong or
    suboptimal compiler options.
    
    Signed-off-by: Geert Uytterhoeven <geert@linux-m68k.org>
    Acked-by: Greg Ungerer<gerg@uclinux.org>

commit b115f400946dba529cfa9a769c2327ae6dbe3694
Author: Gianluca Gennari <gennarone@gmail.com>
Date:   Thu Mar 15 13:33:47 2012 -0300

    [media] cxd2820r: tweak search algorithm behavior
    
    MPIS based STBs running 3.x kernels and the Enigma2 OS are not able to tune
    DVB-T channels with the PCTV 290e using the current cxd2820r driver.
    DVB-T2 channels instead work properly.
    
    This patch fixes the problem by changing the condition to break out from the
    wait lock loop in the "search" function of the cxd2820r demodulator from
    FE_HAS_SIGNAL to FE_HAS_LOCK.
    
    As a consequence, the "search" function of the demodulator driver now returns
    DVBFE_ALGO_SEARCH_SUCCESS only if the frequency lock is successfully acquired.
    
    This behavior seems consistent with other demodulator drivers (e.g. stv090x,
    hd29l2, stv0900, stb0899, mb86a16).
    
    This patch has been successfully tested with DVB-T and DVB-T2 signals,
    on both PC and the mipsel STB running Enigma2.
    No apparent side effect has been observed on PC applications like Kaffeine.
    DVB-C is not available in my country so it's not tested.
    
    Signed-off-by: Gianluca Gennari <gennarone@gmail.com>
    Acked-by: Antti Palosaari <crope@iki.fi>
    Signed-off-by: Mauro Carvalho Chehab <mchehab@redhat.com>

commit 99c72ebceb4dda445b4b74c6f46035feec95a2b3
Author: Mark Salyzyn <mark_salyzyn@xyratex.com>
Date:   Wed Apr 25 13:02:04 2012 -0400

    [SCSI] pm8001: raise host can queue
    
    This is a followup to a patch provided by Jack Wang on September 21 2011.
    
    After increasing the CAN_QUEUE to 510 in pm8001 we discovered some performance
    degredation from time to time. We needed to increase the MPI queue to
    compensate and ensure we never hit that limit. We also needed to double
    the margin to support event and administrivial commands that take from
    the pool resulting in an occasional largely unproductive command completion
    with soft error to the caller when the command pool is overloaded temporarily.
    
    Signed-off-by: Mark Salyzyn <mark_salyzyn@xyratex.com>
    Acked-by: Jack Wang <jack_wang@usish.com>
    Signed-off-by: James Bottomley <JBottomley@Parallels.com>

commit 3a6a4edaa59273fabbc96832ca6f50116b3160fb
Author: Jacob Keller <jacob.e.keller@intel.com>
Date:   Tue May 1 05:24:58 2012 +0000

    ixgbe: Hardware Timestamping + PTP Hardware Clock (PHC)
    
    This patch enables hardware timestamping for use with PTP software by
    extracting a ns counter from an arbitrary fixed point cycles counter.
    The hardware generates SYSTIME registers using the DMA tick which
    changes based on the current link speed. These SYSTIME registers are
    converted to ns using the cyclecounter and timecounter structures
    provided by the kernel. Using the SO_TIMESTAMPING api, software can
    enable and access timestamps for PTP packets.
    
    The SO_TIMESTAMPING API has space for 3 different kinds of timestamps,
    SYS, RAW, and SOF. SYS hardware timestamps are hardware ns values that
    are then scaled to the software clock. RAW hardware timestamps are the
    direct raw value of the ns counter. SOF software timestamps are the
    software timestamp calculated as close as possible to the software
    transmit, but are not offloaded to the hardware. This patch only
    supports the RAW hardware timestamps due to inefficiency of the SYS
    design.
    
    This patch also enables the PHC subsystem features for atomically
    adjusting the cycle register, and adjusting the clock frequency in
    parts per billion. This frequency adjustment works by slightly
    adjusting the value added to the cycle registers each DMA tick. This
    causes the hardware registers to overflow rapidly (approximately once
    every 34 seconds, when at 10gig link). To solve this, the timecounter
    structure is used, along with a timer set for every 25 seconds. This
    allows for detecting register overflow and converting the cycle
    counter registers into ns values needed for providing useful
    timestamps to the network stack.
    
    Only the basic required clock functions are supported at this time,
    although the hardware supports some ancillary features and these could
    easily be enabled in the future.
    
    Note that use of this hardware timestamping requires modifying daemon
    software to use the SO_TIMESTAMPING API for timestamps, and the
    ptp_clock PHC framework for accessing the clock. The timestamps have
    no relation to the system time at all, so software must use the posix
    clock generated by the PHC framework instead.
    
    Signed-off-by: Jacob E Keller <jacob.e.keller@intel.com>
    Tested-by: Stephen Ko <stephen.s.ko@intel.com>
    Signed-off-by: Jeff Kirsher <jeffrey.t.kirsher@intel.com>

commit 06fc5d3d248bdae213aed9efe3a262acf10acd94
Merge: f6072452c903 724b6daa13e1
Author: Linus Torvalds <torvalds@linux-foundation.org>
Date:   Fri Apr 27 19:35:50 2012 -0700

    Merge branch 'perf-urgent-for-linus' of git://git.kernel.org/pub/scm/linux/kernel/git/tip/tip
    
    Pull perf fixes from Ingo Molnar.
    
    * 'perf-urgent-for-linus' of git://git.kernel.org/pub/scm/linux/kernel/git/tip/tip:
      perf: Fix perf_event_for_each() to use sibling
      perf symbols: Read plt symbols from proper symtab_type binary
      tracing: Fix stacktrace of latency tracers (irqsoff and friends)
      perf tools: Add 'G' and 'H' modifiers to event parsing
      tracing: Fix regression with tracing_on
      perf tools: Drop CROSS_COMPILE from flex and bison calls
      perf report: Fix crash showing warning related to kernel maps
      tracing: Fix build breakage without CONFIG_PERF_EVENTS (again)

commit 609dc44b9a8616d7d7091ef7fe62a999e54f3cc2
Author: nagalakshmi.nandigama@lsi.com <nagalakshmi.nandigama@lsi.com>
Date:   Tue Mar 20 12:03:16 2012 +0530

    [SCSI] mpt2sas: MPI next revision header update
    
    Changeset in MPI headers:
    1) Bumped MPI2_HEADER_VERSION_UNIT
    2) Added 4K sectors supported bit to CapabilitiesFlags field of IOC Page 6.
    3) Added UEFIVersion field to BIOS Page 1 and defined additional
        BiosOptions bits to control UEFI behavior.
    
    Signed-off-by: Nagalakshmi Nandigama <nagalakshmi.nandigama@lsi.com>
    Signed-off-by: James Bottomley <JBottomley@Parallels.com>

commit 205b9c9c6eb9c309759ff1e52ffa85ae8965b382
Merge: 7e296295437d 446f6d06fab0
Author: Linus Torvalds <torvalds@linux-foundation.org>
Date:   Sun Apr 22 21:07:51 2012 -0700

    Merge branch 'merge' of git://git.kernel.org/pub/scm/linux/kernel/git/benh/powerpc
    
    Pull powerpc fixes from Benjamin Herrenschmidt:
     "Here are a few fixes for powerpc.  Note the addition to the generic
      irq.h.  This is part of a 3-patches regression fix for mpic due to
      changes in how IRQ_TYPE_NONE is being handled.  Thomas agreed to the
      addition of the new IRQ_TYPE_DEFAULT contant, however he hasn't
      replied with an Ack to the actual patch yet.  I don't to wait much
      longer with these patches tho."
    
    * 'merge' of git://git.kernel.org/pub/scm/linux/kernel/git/benh/powerpc:
      powerpc/mpic: Properly set default triggers
      irq: Add IRQ_TYPE_DEFAULT for use by PIC drivers
      powerpc/mpic: Fix confusion between hw_irq and virq
      powerpc/pmac: Don't add_timer() twice
      powerpc/eeh: Fix crash caused by null eeh_dev
      powerpc/mpc85xx: add MPIC message dts node
      powerpc/mpic_msgr: fix offset error when setting mer register
      powerpc/mpic_msgr: add lock for MPIC message global variable
      powerpc/mpic_msgr: fix compile error when SMP disabled
      powerpc: fix build when CONFIG_BOOKE_WDT is enabled
      powerpc/85xx: don't call of_platform_bus_probe() twice

commit 4351f30a35b8c6a6b6d4d36e5c2dc8ec0262b2ca
Author: Mingkai Hu <Mingkai.hu@freescale.com>
Date:   Mon Apr 16 10:05:08 2012 +0800

    powerpc/mpc85xx: add MPIC message dts node
    
    Signed-off-by: Mingkai Hu <Mingkai.hu@freescale.com>
    Signed-off-by: Kumar Gala <galak@kernel.crashing.org>

commit e0a5a6c38190a5016bcb0f1267324a19b846a35a
Author: Mingkai Hu <Mingkai.hu@freescale.com>
Date:   Mon Apr 16 10:05:06 2012 +0800

    powerpc/mpic_msgr: add lock for MPIC message global variable
    
    Also fix issue of accessing invalid msgr pointer issue. The local
    msgr pointer in fucntion mpic_msgr_get will be accessed before
    getting a valid address which will cause kernel crash.
    
    Signed-off-by: Mingkai Hu <Mingkai.hu@freescale.com>
    Signed-off-by: Kumar Gala <galak@kernel.crashing.org>

commit 6ffd7bdbf8516d691974d21098278af65d4817a5
Author: Otavio Salvador <otavio@ossystems.com.br>
Date:   Wed Apr 11 09:44:30 2012 -0300

    perf tools: Drop CROSS_COMPILE from flex and bison calls
    
    The flex and bison tools generate arch-independent C code so its
    binaries are not prefixed with the target-arch prefix. With this patch
    the Linux 3.4-rc2 can be successfuly build on OE-Core.
    
    Signed-off-by: Otavio Salvador <otavio@ossystems.com.br>
    Link: http://lkml.kernel.org/r/1334148270-13139-1-git-send-email-otavio@ossystems.com.br
    Signed-off-by: Arnaldo Carvalho de Melo <acme@redhat.com>

commit 02eacbd0c405d378d2357e8e0fac5de981bd40f8
Author: Richard Cochran <richardcochran@gmail.com>
Date:   Tue Apr 3 22:59:22 2012 +0000

    ethtool: Add a common function for drivers with transmit time stamping.
    
    Currently, most drivers do not support transmit SO_TIMESTAMPING. For those
    that do support it, there is one appropriate response to the get_ts_info
    query. This patch adds a common function providing this response.
    
    Signed-off-by: Richard Cochran <richardcochran@gmail.com>
    Reviewed-by: Ben Hutchings <bhutchings@solarflare.com>
    Signed-off-by: David S. Miller <davem@davemloft.net>

commit c8f3a8c31069137fe0100e6920558f1a7487ef3c
Author: Richard Cochran <richardcochran@gmail.com>
Date:   Tue Apr 3 22:59:17 2012 +0000

    ethtool: Introduce a method for getting time stamping capabilities.
    
    This commit adds a new ethtool ioctl that exposes the SO_TIMESTAMPING
    capabilities of a network interface. In addition, user space programs
    can use this ioctl to discover the PTP Hardware Clock (PHC) device
    associated with the interface.
    
    Since software receive time stamps are handled by the stack, the generic
    ethtool code can answer the query correctly in case the MAC or PHY
    drivers lack special time stamping features.
    
    Signed-off-by: Richard Cochran <richardcochran@gmail.com>
    Reviewed-by: Ben Hutchings <bhutchings@solarflare.com>
    Signed-off-by: David S. Miller <davem@davemloft.net>

commit 344dd2f4c2bf6d80b54f78012532debeb22c66fd
Author: Nobuhiro Iwamatsu <nobuhiro.iwamatsu.yj@renesas.com>
Date:   Tue Mar 6 14:07:09 2012 +0900

    sh/next: Fix build fail by asm/system.h in asm/bitops.h
    
    Other files are not done include definitely by asm/system.h made
    include in asm/bitops.h.
    This patch remove asm/system.h from asm/bitops.h.
    
    -----
    LANG=C make ARCH=sh CROSS_COMPILE=sh4-linux-gnu-
      CHK     include/linux/version.h
      CHK     include/generated/utsrelease.h
    make[1]: `include/generated/machtypes.h' is up to date.
      CC      arch/sh/kernel/asm-offsets.s
    In file included from include/asm-generic/getorder.h:7,
                   from /home/iwamatsu/work/kernel/sh-2.6-devel/arch/sh/include/asm/page.h:187,
                   from /home/iwamatsu/work/kernel/sh-2.6-devel/arch/sh/include/asm/mmu.h:38,
                   from /home/iwamatsu/work/kernel/sh-2.6-devel/arch/sh/include/asm/system_32.h:5,
                   from /home/iwamatsu/work/kernel/sh-2.6-devel/arch/sh/include/asm/system.h:179,
                   from /home/iwamatsu/work/kernel/sh-2.6-devel/arch/sh/include/asm/bitops.h:10,
                   from include/linux/bitops.h:22,
                   from include/linux/thread_info.h:52,
                   from include/linux/preempt.h:9,
                   from include/linux/spinlock.h:50,
                   from include/linux/mmzone.h:7,
                   from include/linux/gfp.h:4,
                   from include/linux/mm.h:8,
                   from arch/sh/kernel/asm-offsets.c:13:
    include/linux/log2.h: In function '__ilog2_u32':
    include/linux/log2.h:34: error: implicit declaration of function 'fls'
    include/linux/log2.h: In function '__ilog2_u64':
    include/linux/log2.h:42: error: implicit declaration of function 'fls64'
    include/linux/log2.h: In function '__roundup_pow_of_two':
    include/linux/log2.h:63: error: implicit declaration of function 'fls_long'
    -----
    
    Signed-off-by: Nobuhiro Iwamatsu <nobuhiro.iwamatsu.yj@renesas.com>
    Signed-off-by: Paul Mundt <lethal@linux-sh.org>

commit 5375871d432ae9fc581014ac117b96aaee3cd0c7
Merge: b57cb7231b2c dfbc2d75c1bd
Author: Linus Torvalds <torvalds@linux-foundation.org>
Date:   Wed Mar 21 18:55:10 2012 -0700

    Merge branch 'next' of git://git.kernel.org/pub/scm/linux/kernel/git/benh/powerpc
    
    Pull powerpc merge from Benjamin Herrenschmidt:
     "Here's the powerpc batch for this merge window.  It is going to be a
      bit more nasty than usual as in touching things outside of
      arch/powerpc mostly due to the big iSeriesectomy :-) We finally got
      rid of the bugger (legacy iSeries support) which was a PITA to
      maintain and that nobody really used anymore.
    
      Here are some of the highlights:
    
       - Legacy iSeries is gone.  Thanks Stephen ! There's still some bits
         and pieces remaining if you do a grep -ir series arch/powerpc but
         they are harmless and will be removed in the next few weeks
         hopefully.
    
       - The 'fadump' functionality (Firmware Assisted Dump) replaces the
         previous (equivalent) "pHyp assisted dump"...  it's a rewrite of a
         mechanism to get the hypervisor to do crash dumps on pSeries, the
         new implementation hopefully being much more reliable.  Thanks
         Mahesh Salgaonkar.
    
       - The "EEH" code (pSeries PCI error handling & recovery) got a big
         spring cleaning, motivated by the need to be able to implement a
         new backend for it on top of some new different type of firwmare.
    
         The work isn't complete yet, but a good chunk of the cleanups is
         there.  Note that this adds a field to struct device_node which is
         not very nice and which Grant objects to.  I will have a patch soon
         that moves that to a powerpc private data structure (hopefully
         before rc1) and we'll improve things further later on (hopefully
         getting rid of the need for that pointer completely).  Thanks Gavin
         Shan.
    
       - I dug into our exception & interrupt handling code to improve the
         way we do lazy interrupt handling (and make it work properly with
         "edge" triggered interrupt sources), and while at it found & fixed
         a wagon of issues in those areas, including adding support for page
         fault retry & fatal signals on page faults.
    
       - Your usual random batch of small fixes & updates, including a bunch
         of new embedded boards, both Freescale and APM based ones, etc..."
    
    I fixed up some conflicts with the generalized irq-domain changes from
    Grant Likely, hopefully correctly.
    
    * 'next' of git://git.kernel.org/pub/scm/linux/kernel/git/benh/powerpc: (141 commits)
      powerpc/ps3: Do not adjust the wrapper load address
      powerpc: Remove the rest of the legacy iSeries include files
      powerpc: Remove the remaining CONFIG_PPC_ISERIES pieces
      init: Remove CONFIG_PPC_ISERIES
      powerpc: Remove FW_FEATURE ISERIES from arch code
      tty/hvc_vio: FW_FEATURE_ISERIES is no longer selectable
      powerpc/spufs: Fix double unlocks
      powerpc/5200: convert mpc5200 to use of_platform_populate()
      powerpc/mpc5200: add options to mpc5200_defconfig
      powerpc/mpc52xx: add a4m072 board support
      powerpc/mpc5200: update mpc5200_defconfig to fit for charon board
      Documentation/powerpc/mpc52xx.txt: Checkpatch cleanup
      powerpc/44x: Add additional device support for APM821xx SoC and Bluestone board
      powerpc/44x: Add support PCI-E for APM821xx SoC and Bluestone board
      MAINTAINERS: Update PowerPC 4xx tree
      powerpc/44x: The bug fixed support for APM821xx SoC and Bluestone board
      powerpc: document the FSL MPIC message register binding
      powerpc: add support for MPIC message register API
      powerpc/fsl: Added aliased MSIIR register address to MSI node in dts
      powerpc/85xx: mpc8548cds - add 36-bit dts
      ...

commit e96dde2b5edbc0d385ccced05fb5db68c070b0d4
Author: Jia Hongtao <B38951@freescale.com>
Date:   Thu Mar 1 17:32:34 2012 +0800

    powerpc: document the FSL MPIC message register binding
    
    This binding documents how the message register blocks found in some FSL
    MPIC implementations shall be represented in a device tree.
    
    Signed-off-by: Meador Inge <meador_inge@mentor.com>
    Signed-off-by: Jia Hongtao <B38951@freescale.com>
    Signed-off-by: Kumar Gala <galak@kernel.crashing.org>

commit 8626816e905e8e131663dfcae27d307df8c220d0
Author: Jia Hongtao <B38951@freescale.com>
Date:   Fri Feb 17 10:49:03 2012 +0800

    powerpc: add support for MPIC message register API
    
    Some MPIC implementations contain one or more blocks of message registers
    that are used to send messages between cores via IPIs.  A simple API has
    been added to access (get/put, read, write, etc ...) these message registers.
    The available message registers are initially discovered via nodes in the
    device tree.  A separate commit contains a binding for the message register
    nodes.
    
    Signed-off-by: Meador Inge <meador_inge@mentor.com>
    Signed-off-by: Jia Hongtao <B38951@freescale.com>
    Signed-off-by: Li Yang <leoli@freescale.com>
    Signed-off-by: Kumar Gala <galak@kernel.crashing.org>

commit 86d38d1e0e0f66ec3973b718d35a590e04fb32fa
Author: Gianluca Gennari <gennarone@gmail.com>
Date:   Mon Feb 13 13:59:22 2012 -0300

    [media] em28xx: pre-allocate DVB isoc transfer buffers
    
    On MIPS/ARM set-top-boxes, as well as old x86 PCs, memory allocation failures
    in the em28xx driver are common, due to memory fragmentation over time, that
    makes impossible to allocate large chunks of coherent memory.
    A typical system with 256/512 MB of RAM fails after just 1 day of uptime (see
    the old thread for detailed reports and crashlogs).
    
    In fact, the em28xx driver allocates memory for USB isoc transfers at runtime,
    as opposite to the dvb-usb drivers that allocates the USB buffers when the
    device is initialized, and frees them when the device is disconnected.
    
    Moreover, in digital mode the USB isoc transfer buffers are freed, allocated
    and cleared every time the user selects a new channel, wasting time and
    resources.
    
    This patch solves both problems by allocating DVB isoc transfer buffers in
    em28xx_usb_probe(), and freeing them in em28xx_usb_disconnect().
    In fact, the buffers size and number depend only on the max USB packet size
    that is parsed from the USB descriptors in em28xx_usb_probe(), so it can
    never change for a given device.
    
    This approach makes no sense in analog mode (as the buffer size depends on
    the alternate mode selected at runtime), the patch creates two separate sets
    of buffers for digital and analog modes.
    
    For digital-only devices, USB buffers are created when the device is probed
    and freed when the device is disconnected.
    For analog-only devices, nothing changes: isoc buffers are created at runtime.
    For hybrid devices, two sets of buffers are maintained: the digital-mode
    buffers are created when the device is probed, and freed when the device is
    disconnected; analog-mode buffers are created/destroyed at runtime as before.
    So, in analog mode, digital and analog buffers coexists at the same time: this
    can be justified by the fact that digital mode is by far more commonly used
    nowadays, so it makes sense to optimize the driver for this use case scenario.
    
    The patch has been tested in the last few days on a x86 PC and a MIPS
    set-top-box, with the PCTV 290e (digital only) and the Terratec Hybrid XS
    (hybrid device). With the latter, I switched several times between analog and
    digital mode (Kaffeine/TvTime) with no issue at all.
    I unplugged/plugged the devices several times with no problem.
    Also, after over 3 days of normal usage in the MPIS set-top-box, the PCTV 290e
    was still up and running.
    
    Signed-off-by: Gianluca Gennari <gennarone@gmail.com>
    Signed-off-by: Mauro Carvalho Chehab <mchehab@redhat.com>

commit 6b6fae2b890826c99f9e62cceec4f859c98ee575
Author: Mattias Nilsson <mattias.i.nilsson@stericsson.com>
Date:   Fri Jan 13 16:20:28 2012 +0100

    mfd: db8500 clock handling update
    
    This updates the clock handling in the DB8500 PRCMU driver with
    the latest findings and API changes related to changes in the
    backing firmware in the PRCMU.
    
    - Add the necessary interfaces to get the frequencies of the
      clocks and set the rate of some of the clocks.
    - Add support for controlling the clocks PLLSOC0, PLLDSI,
      DSI0, DSI1 and DSI escape clocks (DSInESCCLK).
    - Correct the PLLSDI enable/disable sequence by using the
      DSIPLL_CLAMPI bit.
    
    After this we will have the interfaces and code to implement the
    U8500 clock framework properly.
    
    Reviewed-by: Jonas Aberg <jonas.aberg@stericsson.com>
    Signed-off-by: Mattias Nilsson <mattias.i.nilsson@stericsson.com>
    Signed-off-by: Linus Walleij <linus.walleij@linaro.org>
    Signed-off-by: Samuel Ortiz <sameo@linux.intel.com>

commit 233ba2c5ffcf83f3dee3f4451724273f76cb7d8b
Merge: 001f3a48877a aabb70dc2379
Author: Linus Torvalds <torvalds@linux-foundation.org>
Date:   Sat Mar 3 16:33:51 2012 -0800

    Merge tag 'parisc-fixes' of git://git.kernel.org/pub/scm/linux/kernel/git/jejb/parisc-2.6
    
    PARISC fixes from James Bottomley:
     "This is a set of build fixes to get the cross compiled architecture
      testbeds building again"
    
    * tag 'parisc-fixes' of git://git.kernel.org/pub/scm/linux/kernel/git/jejb/parisc-2.6:
      [PARISC] don't unconditionally override CROSS_COMPILE for 64 bit.
      [PARISC] include <linux/prefetch.h> in drivers/parisc/iommu-helpers.h
      [PARISC] fix compile break caused by iomap: make IOPORT/PCI mapping functions conditional

commit aabb70dc23799e09d69d528756471d854f993136
Author: James Bottomley <jbottomley@parallels.com>
Date:   Mon Feb 27 21:41:05 2012 +0000

    [PARISC] don't unconditionally override CROSS_COMPILE for 64 bit.
    
    The user may wish to set their own value (for real cross compiles).  Since the
    top level Makefile initialises CROSS_COMPILE to empty by default, we must
    check it for being empty (rather than for being defined) before we override.
    
    Reported-by: Paul Gortmaker <paul.gortmaker@windriver.com>
    Signed-off-by: James Bottomley <JBottomley@Parallels.com>

commit fe83364f0bf11fcb20cecbe944a95834632ffffb
Author: Benjamin Herrenschmidt <benh@kernel.crashing.org>
Date:   Wed Feb 22 13:50:13 2012 +0000

    powerpc/mpic: Fix allocation of reverse-map for multi-ISU mpics
    
    When using a multi-ISU MPIC, we can interrupts up to
    isu_size * MPIC_MAX_ISU, not just isu_size, so allocate
    the right size reverse map.
    
    Without this, the code will constantly fallback to
    a linear search.
    
    Signed-off-by: Benjamin Herrenschmidt <benh@kernel.crashing.org>

commit e55d7f737d3daf4aaf41945c1829138c608662e9
Author: Kyle Moffett <Kyle.D.Moffett@boeing.com>
Date:   Thu Dec 22 10:19:14 2011 +0000

    powerpc/mpic: Remove duplicate MPIC_WANTS_RESET flag
    
    There are two separate flags controlling whether or not the MPIC is
    reset during initialization, which is completely unnecessary, and only
    one of them can be specified in the device tree.
    
    Also, most platforms in-tree right now do actually want to reset the
    MPIC during initialization anyways, which means lots of duplicate code
    passing the MPIC_WANTS_RESET flag.
    
    Fix all of the callers which currently do not pass the MPIC_WANTS_RESET
    flag to pass the MPIC_NO_RESET flag, then remove the MPIC_WANTS_RESET
    flag and make the code reset the MPIC by default.
    
    Signed-off-by: Kyle Moffett <Kyle.D.Moffett@boeing.com>
    Signed-off-by: Benjamin Herrenschmidt <benh@kernel.crashing.org>

commit c1b8d45db4dbc64cc6015f97922f767fdf782f64
Author: Kyle Moffett <Kyle.D.Moffett@boeing.com>
Date:   Thu Dec 22 10:19:13 2011 +0000

    powerpc/mpic: Add "last-interrupt-source" property to override hardware
    
    The FreeScale PowerQUICC-III-compatible (mpc85xx/mpc86xx) MPICs do not
    correctly report the number of hardware interrupt sources, so software
    needs to override the detected value with "256".
    
    To avoid needing to write custom board-specific code to detect that
    scenario, allow it to be easily overridden in the device-tree.
    
    Signed-off-by: Kyle Moffett <Kyle.D.Moffett@boeing.com>
    Signed-off-by: Benjamin Herrenschmidt <benh@kernel.crashing.org>

commit 5019609fce965dbdc66a7d947385fe92ca522231
Author: Kyle Moffett <Kyle.D.Moffett@boeing.com>
Date:   Thu Dec 22 10:19:12 2011 +0000

    powerpc/mpic: Remove MPIC_BROKEN_FRR_NIRQS and duplicate irq_count
    
    The mpic->irq_count variable is only used as a software error-checking
    limit to determine whether or not an IRQ number is valid.  In board code
    which does not manually specify an IRQ count to mpic_alloc(), i.e. 0, it
    is automatically detected from the number of ISUs and the ISU size.
    
    In practice, all hardware ends up with irq_count == num_sources, so all
    of the runtime checks on mpic->irq_count should just check the value of
    mpic->num_sources instead.
    
    When platform hardware does not correctly report the number of IRQs,
    which only happens on the MPC85xx/MPC86xx, the MPIC_BROKEN_FRR_NIRQS
    flag is used to override the detected value of num_sources with the
    manual irq_count parameter.  Since there's no need to manually specify
    the number of IRQs except in this case, the extra flag can be eliminated
    and the test changed to "irq_count != 0".
    
    Signed-off-by: Kyle Moffett <Kyle.D.Moffett@boeing.com>
    Signed-off-by: Benjamin Herrenschmidt <benh@kernel.crashing.org>

commit 9ca163c8602681ad098910f48f89b97f0cb87c4f
Author: Kyle Moffett <Kyle.D.Moffett@boeing.com>
Date:   Thu Dec 22 10:19:11 2011 +0000

    fsl/mpic: Create and document the "single-cpu-affinity" device-tree flag
    
    The Freescale MPIC (and perhaps others in the future) is incapable of
    routing non-IPI interrupts to more than once CPU at a time.  Currently
    all of the Freescale boards msut pass the MPIC_SINGLE_DEST_CPU flag to
    mpic_alloc(), but that information should really be present in the
    device-tree.
    
    Older board code can't rely on the device-tree having the property set,
    but newer platforms won't need it manually specified in the code.
    
    [BenH: Remove unrelated changes, folded in a different patch]
    
    Signed-off-by: Kyle Moffett <Kyle.D.Moffett@boeing.com>
    Signed-off-by: Benjamin Herrenschmidt <benh@kernel.crashing.org>

commit 98cca250aecaf3f1b2fec003e1c0ce0bfaa4be36
Author: Kyle Moffett <Kyle.D.Moffett@boeing.com>
Date:   Thu Dec 22 10:19:10 2011 +0000

    fsl/mpic: Document and use the "big-endian" device-tree flag
    
    The MPIC code checks for a "big-endian" property and sets the flag
    MPIC_BIG_ENDIAN if one is present, although prior to the "mpic->flags"
    fixup that would never have worked anways.
    
    Unfortunately, even now that it works properly, the Freescale mpic
    device-node (the "PowerQUICC-III"-compatible one) does not specify it,
    so all of the board ports need to manually pass it to mpic_alloc().
    
    Document the flag and add it to the pq3 device tree.  Existing code will
    still need to pass the MPIC_BIG_ENDIAN flag because their dtb may not
    have this property, but new platforms shouldn't need to do so.
    
    Signed-off-by: Kyle Moffett <Kyle.D.Moffett@boeing.com>
    Signed-off-by: Benjamin Herrenschmidt <benh@kernel.crashing.org>

commit 3a7a7176e840f448aae929f7761ea80cf892c665
Author: Kyle Moffett <Kyle.D.Moffett@boeing.com>
Date:   Thu Dec 22 10:19:09 2011 +0000

    powerpc/mpic: Fix use of "flags" variable in mpic_alloc()
    
    The mpic_alloc() function takes a "flags" parameter and assigns it into
    the mpic->flags variable fairly early on, but several later pieces of
    code detect various device-tree properties and save them into the
    "mpic->flags" variable (EG: "big-endian" => MPIC_BIG_ENDIAN).
    
    Unfortunately, a number of codepaths (including several which test the
    flag MPIC_BIG_ENDIAN!) test "flags" instead of "mpic->flags", and get
    wrong answers as a result.
    
    Consolidate the device-tree flag tests early in mpic_alloc() and change
    all of the checks after "mpic->flags" is init'ed to use "mpic->flags".
    
    [BenH: Fixed up use of mpic->node before it's initialized]
    
    Signed-off-by: Kyle Moffett <Kyle.D.Moffett@boeing.com>
    Signed-off-by: Benjamin Herrenschmidt <benh@kernel.crashing.org>

commit ce106ad31016b5da1168496cd0454a6290555f84
Merge: 18d3e0d75079 a99e7e5f36c5
Author: Linus Torvalds <torvalds@linux-foundation.org>
Date:   Wed Feb 1 16:00:38 2012 -0800

    Merge branch 'for-linus2' of git://git.kernel.org/pub/scm/linux/kernel/git/jmorris/linux-security
    
    * 'for-linus2' of git://git.kernel.org/pub/scm/linux/kernel/git/jmorris/linux-security:
      lib: Fix 32-bit sparc udiv_qrnnd() definition in mpilib's longlong.h
      lib: Fix multiple definitions of clz_tab
      lib/digsig: checks for NULL return value
      lib/mpi: added missing NULL check
      lib/mpi: added comment on divide by 0 case
      lib/mpi: check for possible zero length
      lib/digsig: pkcs_1_v1_5_decode_emsa cleanup
      lib/digsig: additional sanity checks against badly formated key payload
      lib/mpi: removed unused functions
      lib/mpi: checks for zero divisor length
      lib/mpi: return error code on dividing by zero
      lib/mpi: replaced MPI_NULL with normal NULL
      lib/mpi: added missing NULL check

commit a99e7e5f36c55e561a64280f5099078c31839076
Author: David Miller <davem@davemloft.net>
Date:   Thu Feb 2 00:17:55 2012 +0200

    lib: Fix 32-bit sparc udiv_qrnnd() definition in mpilib's longlong.h
    
    This copy of longlong.h is extremely dated and results in compile
    errors on sparc32 when MPILIB is enabled, copy over the more uptodate
    implementation from arch/sparc/math/sfp-util_32.h
    
    Reported-by: Al Viro <viro@ZenIV.linux.org.uk>
    Signed-off-by: David S. Miller <davem@davemloft.net>
    Signed-off-by: James Morris <jmorris@namei.org>

commit c6df4b17c8539f737a6a2d7b797eac41e8e34cdc
Author: David Miller <davem@davemloft.net>
Date:   Thu Feb 2 00:17:54 2012 +0200

    lib: Fix multiple definitions of clz_tab
    
    Both sparc 32-bit's software divide assembler and MPILIB provide
    clz_tab[] with identical contents.
    
    Break it out into a seperate object file and select it when
    SPARC32 or MPILIB is set.
    
    Reported-by: Al Viro <viro@ZenIV.linux.org.uk>
    Signed-off-by: David S. Miller <davem@davemloft.net>
    Signed-off-by: James Morris <jmorris@namei.org>

commit 3cccd1543ab623a5065335bf08350e06ffc788ab
Author: Dmitry Kasatkin <dmitry.kasatkin@intel.com>
Date:   Thu Jan 26 19:13:16 2012 +0200

    lib/mpi: replaced MPI_NULL with normal NULL
    
    MPI_NULL is replaced with normal NULL.
    
    Signed-off-by: Dmitry Kasatkin <dmitry.kasatkin@intel.com>
    Reviewed-by: Tetsuo Handa <penguin-kernel@I-love.SAKURA.ne.jp>
    Signed-off-by: James Morris <jmorris@namei.org>

commit 6c02b7b1610f873888af20f291c07730889ff0f9
Merge: 7a7546b377bd dcd6c9226715
Author: Konrad Rzeszutek Wilk <konrad.wilk@oracle.com>
Date:   Fri Jan 27 11:14:02 2012 -0500

    Merge commit 'v3.3-rc1' into stable/for-linus-fixes-3.3
    
    * commit 'v3.3-rc1': (9775 commits)
      Linux 3.3-rc1
      x86, syscall: Need __ARCH_WANT_SYS_IPC for 32 bits
      qnx4: don't leak ->BitMap on late failure exits
      qnx4: reduce the insane nesting in qnx4_checkroot()
      qnx4: di_fname is an array, for crying out loud...
      KEYS: Permit key_serial() to be called with a const key pointer
      keys: fix user_defined key sparse messages
      ima: fix cred sparse warning
      uml: fix compile for x86-64
      MPILIB: Add a missing ENOMEM check
      tpm: fix (ACPI S3) suspend regression
      nvme: fix merge error due to change of 'make_request_fn' fn type
      xen: using EXPORT_SYMBOL requires including export.h
      gpio: tps65910: Use correct offset for gpio initialization
      acpi/apei/einj: Add extensions to EINJ from rev 5.0 of acpi spec
      intel_idle: Split up and provide per CPU initialization func
      ACPI processor: Remove unneeded variable passed by acpi_processor_hotadd_init V2
      tg3: Fix single-vector MSI-X code
      openvswitch: Fix multipart datapath dumps.
      ipv6: fix per device IP snmp counters
      ...

commit 19c22c34dcbecb50c24548aa2ff2b07039c26c14
Merge: 9e5e3097a3fe dcd6c9226715
Author: Mauro Carvalho Chehab <mchehab@redhat.com>
Date:   Sat Jan 21 23:23:15 2012 -0200

    Merge tag 'v3.3-rc1' into staging/for_v3.3
    
    * tag 'v3.3-rc1': (8187 commits)
      Linux 3.3-rc1
      x86, syscall: Need __ARCH_WANT_SYS_IPC for 32 bits
      qnx4: don't leak ->BitMap on late failure exits
      qnx4: reduce the insane nesting in qnx4_checkroot()
      qnx4: di_fname is an array, for crying out loud...
      KEYS: Permit key_serial() to be called with a const key pointer
      keys: fix user_defined key sparse messages
      ima: fix cred sparse warning
      uml: fix compile for x86-64
      MPILIB: Add a missing ENOMEM check
      tpm: fix (ACPI S3) suspend regression
      nvme: fix merge error due to change of 'make_request_fn' fn type
      xen: using EXPORT_SYMBOL requires including export.h
      gpio: tps65910: Use correct offset for gpio initialization
      acpi/apei/einj: Add extensions to EINJ from rev 5.0 of acpi spec
      intel_idle: Split up and provide per CPU initialization func
      ACPI processor: Remove unneeded variable passed by acpi_processor_hotadd_init V2
      tg3: Fix single-vector MSI-X code
      openvswitch: Fix multipart datapath dumps.
      ipv6: fix per device IP snmp counters
      ...

commit afd290945cd283030b51b433a66fe57a8feb28c8
Merge: 90a4c0f51e8e 456a8167e94b
Author: Linus Torvalds <torvalds@linux-foundation.org>
Date:   Thu Jan 19 11:46:08 2012 -0800

    Merge branch 'for-linus' of git://git.kernel.org/pub/scm/linux/kernel/git/jmorris/linux-security
    
    * 'for-linus' of git://git.kernel.org/pub/scm/linux/kernel/git/jmorris/linux-security:
      KEYS: Permit key_serial() to be called with a const key pointer
      keys: fix user_defined key sparse messages
      ima: fix cred sparse warning
      MPILIB: Add a missing ENOMEM check

commit 4bf1924c008dffdc154f82507b4052e49263a6f4
Author: David Howells <dhowells@redhat.com>
Date:   Wed Jan 18 10:03:54 2012 +0000

    MPILIB: Add a missing ENOMEM check
    
    Add a missing ENOMEM check.
    
    Signed-off-by: David Howells <dhowells@redhat.com>
    Acked-by: Mimi Zohar <zohar@us.ibm.com>
    Signed-off-by: James Morris <jmorris@namei.org>

commit a25a2b84098eb5e001cb8086603d692aa95bf2ec
Merge: f429ee3b8081 f1be242c9525
Author: Linus Torvalds <torvalds@linux-foundation.org>
Date:   Tue Jan 17 16:43:39 2012 -0800

    Merge branch 'for-linus' of git://git.kernel.org/pub/scm/linux/kernel/git/jmorris/linux-security
    
    * 'for-linus' of git://git.kernel.org/pub/scm/linux/kernel/git/jmorris/linux-security:
      integrity: digital signature config option name change
      lib: Removed MPILIB, MPILIB_EXTRA, and SIGNATURE prompts
      lib: MPILIB Kconfig description update
      lib: digital signature dependency fix
      lib: digital signature config option name change
      encrypted-keys: fix rcu and sparse messages
      keys: fix trusted/encrypted keys sparse rcu_assign_pointer messages
      KEYS: Add missing smp_rmb() primitives to the keyring search code
      TOMOYO: Accept \000 as a valid character.
      security: update MAINTAINERS file with new git repo

commit 2e5f094b9dbf9463ab93f86351cd1a8dc88942cc
Author: Dmitry Kasatkin <dmitry.kasatkin@intel.com>
Date:   Tue Jan 17 17:12:06 2012 +0200

    lib: Removed MPILIB, MPILIB_EXTRA, and SIGNATURE prompts
    
    As modules are expected to select MPILIB, MPILIB_EXTRA, and SIGNATURE,
    removed Kconfig prompts.
    
    Requested-by: Linus Torvalds <torvalds@linux-foundation.org>
    Signed-off-by: Dmitry Kasatkin <dmitry.kasatkin@intel.com>
    Signed-off-by: James Morris <jmorris@namei.org>

commit 68adcad570a2ce0496918ddd9f8c83138d9bcc93
Author: Dmitry Kasatkin <dmitry.kasatkin@intel.com>
Date:   Tue Jan 17 17:12:05 2012 +0200

    lib: MPILIB Kconfig description update
    
    It was reported that description of the MPILIB_EXTRA is confusing.
    Indeed it was copy-paste typo. It is fixed here.
    
    Reported-by: Valdis Kletnieks <Valdis.Kletnieks@vt.edu>
    Signed-off-by: Dmitry Kasatkin <dmitry.kasatkin@intel.com>
    Signed-off-by: James Morris <jmorris@namei.org>

commit e7691a1ce341c80ed9504244a36b31c025217391
Merge: 5cd9599bba42 8fcc99549522
Author: Linus Torvalds <torvalds@linux-foundation.org>
Date:   Tue Jan 10 21:51:23 2012 -0800

    Merge branch 'for-linus' of git://selinuxproject.org/~jmorris/linux-security
    
    * 'for-linus' of git://selinuxproject.org/~jmorris/linux-security: (32 commits)
      ima: fix invalid memory reference
      ima: free duplicate measurement memory
      security: update security_file_mmap() docs
      selinux: Casting (void *) value returned by kmalloc is useless
      apparmor: fix module parameter handling
      Security: tomoyo: add .gitignore file
      tomoyo: add missing rcu_dereference()
      apparmor: add missing rcu_dereference()
      evm: prevent racing during tfm allocation
      evm: key must be set once during initialization
      mpi/mpi-mpow: NULL dereference on allocation failure
      digsig: build dependency fix
      KEYS: Give key types their own lockdep class for key->sem
      TPM: fix transmit_cmd error logic
      TPM: NSC and TIS drivers X86 dependency fix
      TPM: Export wait_for_stat for other vendor specific drivers
      TPM: Use vendor specific function for status probe
      tpm_tis: add delay after aborting command
      tpm_tis: Check return code from getting timeouts/durations
      tpm: Introduce function to poll for result of self test
      ...
    
    Fix up trivial conflict in lib/Makefile due to addition of CONFIG_MPI
    and SIGSIG next to CONFIG_DQL addition.

commit 74e07f3e309599864656fb4560c498478d22d43c
Author: Don Kramer <dgkramer@comcast.net>
Date:   Mon Jan 2 16:15:44 2012 -0300

    [media] [resend] em28xx: Add Plextor ConvertX PX-AV100U to em28xx-cards.c
    
    Adds support for the Plextor ConvertX PX-AV100U, which uses the
    eMPIA EM2820 chip.  The device has a device_id of '0x093b, 0xa003'.  I
    am using the existing EM2820_BOARD_PINNACLE_DVC_90 board profile, as
    the Pinnacle Dazzle DVC 90/100/101/107, Kaiser Baas Video to DVD
    maker, and Kworld DVD Maker 2 were already mapped to it.  Some more
    background on the device and my testing can be found at
    http://www.donkramer.net/plextor_122710.pdf
    
    Signed-off-by: Don Kramer <dgkramer@comcast.net>
    Signed-off-by: Mauro Carvalho Chehab <mchehab@redhat.com>

commit 1ec332a3756a22405d2fbd5352e3afab556cb205
Author: Janusz Krzysztofik <jkrzyszt@tis.icnet.pl>
Date:   Thu Dec 1 22:45:47 2011 +0100

    ARM: 7184/1: fix $(CROSS_COMPILE) prefix missing from size invocation
    
    Otherwise, cross compilation may fail with error messages like:
    
    ...
    size: arch/arm/boot/compressed/../../../../vmlinux: File format is ambiguous
    size: Matching formats: elf32-littlearm elf32-littlearm-symbian elf32-littlearm-vxworks
      LD      arch/arm/boot/compressed/vmlinux
      arm-angstrom-linux-uclibcgnueabi-ld:--defsym _kernel_bss_size=: syntax error
    
    Signed-off-by: Janusz Krzysztofik <jkrzyszt@tis.icnet.pl>
    Signed-off-by: Russell King <rmk+kernel@arm.linux.org.uk>

commit eb975652b8fa0c4f08a52744d34bdebf66589d4b
Author: Josh Boyer <jwboyer@redhat.com>
Date:   Tue Dec 20 10:41:28 2011 -0500

    powerpc/44x: Fix build error on currituck platform
    
    The MPIC_PRIMARY define was recently made "default" and the meaning was
    inverted to MPIC_SECONDARY.  This causes compile errors in currituck now, so
    fix it to the new manner of allocating mpics.
    
    Signed-off-by: Josh Boyer <jwboyer@gmail.com>

commit 2d173def737946d776110f044a811ecfe772e18b
Author: Paul Gortmaker <paul.gortmaker@windriver.com>
Date:   Wed Dec 7 20:47:29 2011 -0500

    ARM: at91: delete the pcontrol_g20_defconfig
    
    In routine testing I found this file should not specify a site
    specific toolchain path.  I suggested that the defconfigs should
    not be calling out site specific toolchain locations, so we should
    delete the setting of CROSS_COMPILE.  In response, it was indicated
    that this is an obsolete defconfig and it should simply be deleted.
    
    Signed-off-by: Paul Gortmaker <paul.gortmaker@windriver.com>
    Acked-by: Jean-Christophe Plagniol-Villard <plagnioj@jcrosoft.com>

commit 4da7af9494b2f98a1503a2634059300c3e4615e6
Author: nagalakshmi.nandigama@lsi.com <nagalakshmi.nandigama@lsi.com>
Date:   Thu Dec 1 07:53:02 2011 +0530

    [SCSI] mpt2sas: Do not retry a timed out direct IO for warpdrive
    
    When an I/O request to a WarpDrive is timed out by SML and if the
    I/O request to the WarpDrive is sent as direct I/O then the aborted
    direct I/O will be retried as normal Volume I/O and which results
    in failure of Target Reset and results in host reset.
    
    The fix is to not retry a failed IO to volume when the original
    IO was sent as direct IO with an ioc status
    MPI2_IOCSTATUS_SCSI_TASK_TERMINATED.
    
    Signed-off-by: Nagalakshmi Nandigama <nagalakshmi.nandigama@lsi.com>
    Signed-off-by: James Bottomley <JBottomley@Parallels.com>

commit a6affbd5ccbb45e03168996bae4a4d0abb780874
Author: nagalakshmi.nandigama@lsi.com <nagalakshmi.nandigama@lsi.com>
Date:   Thu Dec 1 07:52:49 2011 +0530

    [SCSI] mpt2sas: MPI next revision header update
    
    1)Removed Power Management Control option for PCIe link.
    2)Added RAID Action for performing a compatibility check. Added
    product-specific range to RAID Action values.
    3)Added PhysicalPort field to SAS Device Status Change Event data.
    4)Added SpinupFlags field containing a Disable Spin-up bit to the
    SpinupGroupParameters fields of SAS IO Unit Page 4.
    
    Signed-off-by: Nagalakshmi Nandigama <nagalakshmi.nandigama@lsi.com>
    Signed-off-by: James Bottomley <JBottomley@Parallels.com>

commit c1bc0704e52f200bc747c6bddb970a3686e230ab
Author: nagalakshmi.nandigama@lsi.com <nagalakshmi.nandigama@lsi.com>
Date:   Thu Dec 1 07:43:37 2011 +0530

    [SCSI] mpt2sas: MPI next revision header update
    
    1) Added product specific range of ImageType macros for the Extended
       Image Header.
    
    2) Added Flags field and related defines to
       MPI2_TOOLBOX_ISTWI_READ_WRITE_REQUEST to support automatic
       reserve/release and page addressing.
    
    Signed-off-by: Nagalakshmi Nandigama <nagalakshmi.nandigama@lsi.com>
    Signed-off-by: James Bottomley <JBottomley@Parallels.com>

commit e1c96c8620539f056291fe42f742f331f5d291b1
Author: Florian Fainelli <florian@openwrt.org>
Date:   Wed Nov 16 19:11:12 2011 +0100

    MIPS: BCM63xx: Remove BCM6345 hacks to read base boot address
    
    Though BCM6345 does not technically have the same MPI register layout
    than the other SoCs, reading the chip-select registers is done the same
    way, and particularly for chip-select 0, which is the boot flash.
    
    Signed-off-by: Florian Fainelli <florian@openwrt.org>
    Cc: linux-mips@linux-mips.org
    Patchwork: https://patchwork.linux-mips.org/patch/3009/
    Signed-off-by: Ralf Baechle <ralf@linux-mips.org>

commit 09dc34a95bfbc6062e1e7de0b96175480924aea8
Author: Kyle Moffett <Kyle.D.Moffett@boeing.com>
Date:   Fri Dec 2 06:28:07 2011 +0000

    powerpc/mpic: Add in-core support for cascaded MPICs
    
    The Cell and PowerMac platforms use virtually identical cascaded-IRQ
    setup code, so just merge it into the core.  Ideally this code would
    trigger automatically when an MPIC device-node specifies an "interrupts"
    property, perhaps even enabling MPIC_SECONDARY along the way.
    
    Unfortunately, Benjamin Herrenschmidt has had bad experiences in the
    past with the quality of Apple PowerMac device-trees, so to be safe we
    will only try to parse out an IRQ if the MPIC_SECONDARY flag is set by
    the caller.
    
    Signed-off-by: Kyle Moffett <Kyle.D.Moffett@boeing.com>
    Signed-off-by: Benjamin Herrenschmidt <benh@kernel.crashing.org>

commit c51242e7080d2265761de309cdea222d7e27bdfe
Author: Kyle Moffett <Kyle.D.Moffett@boeing.com>
Date:   Fri Dec 2 06:28:06 2011 +0000

    powerpc/mpic: Cache the device-tree node in "struct mpic"
    
    Store the node pointer in the MPIC during initialization so that all of
    the later operational code can just reuse the cached pointer.
    
    Signed-off-by: Kyle Moffett <Kyle.D.Moffett@boeing.com>
    Signed-off-by: Benjamin Herrenschmidt <benh@kernel.crashing.org>

commit c579bc766a84a57c31d7b41276ffa9545a34ee1b
Author: Kyle Moffett <Kyle.D.Moffett@boeing.com>
Date:   Fri Dec 2 06:28:05 2011 +0000

    powerpc/mpic: Put "pic-no-reset" test back into the MPIC code
    
    There's not really any reason to have this one-liner in a separate
    static inline function, given that all the other similar tests are
    already in the alloc_mpic() code.
    
    Signed-off-by: Kyle Moffett <Kyle.D.Moffett@boeing.com>
    Signed-off-by: Benjamin Herrenschmidt <benh@kernel.crashing.org>

commit be8bec56dfac0574c4c08a50cd37e09bea941e3f
Author: Kyle Moffett <Kyle.D.Moffett@boeing.com>
Date:   Fri Dec 2 06:28:03 2011 +0000

    powerpc/mpic: Invert the meaning of MPIC_PRIMARY
    
    It turns out that there are only 2 in-tree platforms which use MPICs
    which are not "primary":  IBM Cell and PowerMac.  To reduce the
    complexity of the typical board setup code, invert the MPIC_PRIMARY bit
    into MPIC_SECONDARY.
    
    Signed-off-by: Kyle Moffett <Kyle.D.Moffett@boeing.com>
    Signed-off-by: Benjamin Herrenschmidt <benh@kernel.crashing.org>

commit e7a98675caf272a11dc1012c7a8c6c00cab09f5b
Author: Kyle Moffett <Kyle.D.Moffett@boeing.com>
Date:   Fri Dec 2 06:28:01 2011 +0000

    powerpc/mpic: Save computed phys_addr for board-specific code
    
    The MPIC code can already perform an automatic OF address translation
    step as part of mpic_alloc(), but several boards need to use that base
    address when they perform mpic_assign_isu().
    
    The easiest solution is to save the computed physical address into the
    "struct mpic" for later use by the board code.
    
    Signed-off-by: Kyle Moffett <Kyle.D.Moffett@boeing.com>
    Signed-off-by: Benjamin Herrenschmidt <benh@kernel.crashing.org>

commit 03f4201bd44e7d3ca7dc26b30d4251a07c77e9f2
Author: Kumar Gala <galak@kernel.crashing.org>
Date:   Mon Nov 7 10:22:36 2011 -0600

    powerpc/85xx: Rework P5020DS device tree
    
    Utilize new split between board & SoC, and new SoC device trees split
    into pre & post utilizing 'template' includes for SoC IP blocks.
    
    Other changes include:
    * Adding of MPIC timer blocks
    * Dropping "fsl,p5020-IP..." from compatibles for standard blocks
    * Removed mpic interrupt-parent from dcsr-epu node, just use top level
    * Removed mpic interrupt-parent from sec nodes, just use top level
    
    Signed-off-by: Kumar Gala <galak@kernel.crashing.org>

commit b9db022c62f72bc5a029f20851b012895a6ea7ca
Author: Kumar Gala <galak@kernel.crashing.org>
Date:   Fri Nov 4 09:47:49 2011 -0500

    powerpc/85xx: Rework P4080DS device trees
    
    Utilize new split between board & SoC, and new SoC device trees split
    into pre & post utilizing 'template' includes for SoC IP blocks.
    
    Other changes include:
    * Adding of MPIC timer blocks
    * Dropping "fsl,p4080-IP..." from compatibles for standard blocks
    * Removed mpic interrupt-parent from dcsr-epu node, just use top level
    * Removed mpic interrupt-parent from sec nodes, just use top level
    
    Signed-off-by: Kumar Gala <galak@kernel.crashing.org>

commit 8389c823b50bfb81eccdb115f486459adacf4b17
Author: Kumar Gala <galak@kernel.crashing.org>
Date:   Wed Nov 9 13:21:57 2011 -0600

    powerpc/85xx: Rework P3060QDS device tree
    
    Utilize new split between board & SoC, and new SoC device trees split
    into pre & post utilizing 'template' includes for SoC IP blocks.
    
    Other changes include:
    * Adding of MPIC timer blocks
    * Dropping "fsl,p3060-IP..." from compatibles for standard blocks
    * Removed mpic interrupt-parent from dcsr-epu node, just use top level
    * Removed mpic interrupt-parent from sec nodes, just use top level
    * Fixed l3-cache IRQs, we have 2 CPCs, so we should have IRQs for both
    
    Signed-off-by: Kumar Gala <galak@kernel.crashing.org>

commit b4c3804d18d37130625e1dd4d08fd9625f7eaba4
Author: Kumar Gala <galak@kernel.crashing.org>
Date:   Mon Nov 7 10:38:56 2011 -0600

    powerpc/85xx: Rework P3041DS device tree
    
    Utilize new split between board & SoC, and new SoC device trees split
    into pre & post utilizing 'template' includes for SoC IP blocks.
    
    Other changes include:
    * Adding of MPIC timer blocks
    * Dropping "fsl,p3041-IP..." from compatibles for standard blocks
    * Removed mpic interrupt-parent from dcsr-epu node, just use top level
    * Fixed some dcsr compatiable typo's from 'p43041' to 'p3041'
    
    Signed-off-by: Kumar Gala <galak@kernel.crashing.org>

commit 8b8673b8502b2bebf37db6c079699f76d421abc2
Author: Kumar Gala <galak@kernel.crashing.org>
Date:   Mon Nov 7 10:58:28 2011 -0600

    powerpc/85xx: Rework P2041RDB device tree
    
    Utilize new split between board & SoC, and new SoC device trees split
    into pre & post utilizing 'template' includes for SoC IP blocks.
    
    Other changes include:
    * Adding of MPIC timer blocks
    * Dropping "fsl,p2041-IP..." from compatibles for standard blocks
    * Removed mpic interrupt-parent from dcsr-epu node, just use top level
    
    Signed-off-by: Kumar Gala <galak@kernel.crashing.org>

commit 941d71c7361815c02e2b2831bbb9f06a504a3d24
Author: Kumar Gala <galak@kernel.crashing.org>
Date:   Fri Nov 4 00:48:57 2011 -0500

    powerpc/85xx: Rework P2020RDB device tree
    
    Utilize new split between board & SoC, and new SoC device trees split
    into pre & post utilizing 'template' includes for SoC IP blocks.
    
    Other changes include:
    
    * Moved to specifying interrupt-parent for mpic at root
    * Moved to 4-cell mpic interrupt cells to support MPIC timers
    * Reworked PCIe nodes to allow supportin IRQs for controller (errors) and
      moved PCI device IRQs down to virtual bridge level
    * Updated spi node to new espi binding specification
    * Renamed 'sdhci' node to 'sdhc'
    * Changed GPIO compatiable from 'fsl,mpc8572-gpio' to 'fsl,pq3-gpio' as the
     'mpc8572' compatiable is to deal with a 'mpc8572' specific to an erratum
    * Fixed wrong reg offsets for mdio nodes associated with etsec2 &
    * etsec3
    * Dropping "fsl,p2020-IP..." from compatibles for standard blocks
    
    Signed-off-by: Kumar Gala <galak@kernel.crashing.org>

commit 7f9ce7143efe1231d66a5c91e57fce55fce6728e
Author: Kumar Gala <galak@kernel.crashing.org>
Date:   Wed Oct 26 08:35:24 2011 -0500

    powerpc/85xx: Rework P2020DS device tree
    
    Utilize new split between board & SoC, and new SoC device trees split
    into pre & post utilizing 'template' includes for SoC IP blocks.
    
    Other changes include:
    
    * Moved to specifying interrupt-parent for mpic at root
    * Moved to 4-cell mpic interrupt cells to support MPIC timers
    * Reworked PCIe nodes to allow supportin IRQs for controller (errors)
      and moved PCI device IRQs down to virtual bridge level
    * Updated spi node to new espi binding specification
    * Renamed 'sdhci' node to 'sdhc'
    * Changed GPIO compatiable from 'fsl,mpc8572-gpio' to 'fsl,pq3-gpio' as the
     'mpc8572' compatiable is to deal with a 'mpc8572' specific to an erratum
    * Fixed wrong reg offsets for mdio nodes associated with etsec2 & etsec3
    * Dropping "fsl,p2020-IP..." from compatibles for standard blocks
    
    Signed-off-by: Kumar Gala <galak@kernel.crashing.org>

commit b0e2f248b4ed6aea3191c3419e6f70407d53d8d8
Author: Kumar Gala <galak@kernel.crashing.org>
Date:   Wed Nov 9 14:53:33 2011 -0600

    powerpc/85xx: Rework P1023RDS device tree
    
    Utilize new split between board & SoC, and new SoC device trees split
    into pre & post utilizing 'template' includes for SoC IP blocks.
    
    Other changes include:
    * Moved to specifying interrupt-parent for mpic at root
    * Moved to 4-cell mpic interrupt cells to support MPIC timers
    * Dropping "fsl,p1023-IP..." from compatibles for standard blocks
    * Removed incorrect power/pmc node, there are no etsec on P1023
    
    Signed-off-by: Kumar Gala <galak@kernel.crashing.org>

commit ffeb33d20c6217bb8f0ab46d3f1396021c00c24f
Author: Kumar Gala <galak@kernel.crashing.org>
Date:   Wed Nov 2 10:15:30 2011 -0500

    powerpc/85xx: Rework P1021MDS device tree
    
    Utilize new split between board & SoC, and new SoC device trees split
    into pre & post utilizing 'template' includes for SoC IP blocks.
    
    Other changes include:
    
    * Moved to specifying interrupt-parent for mpic at root
    * Moved to 4-cell mpic interrupt cells to support MPIC timers
    * Reworked PCIe nodes to allow supportin IRQs for controller (errors) and
      moved PCI device IRQs down to virtual bridge level
    * Renamed SDHC node from 'sdhci' to 'sdhc'
    * Added usb node for 2nd usb controller
    * Dropping "fsl,p1021-IP..." from compatibles for standard blocks
    
    Signed-off-by: Kumar Gala <galak@kernel.crashing.org>

commit 96488746bbfb3e25a9c451e198c4d7c4b2e0731f
Author: Kumar Gala <galak@kernel.crashing.org>
Date:   Sat Oct 22 16:58:40 2011 -0500

    powerpc/85xx: Rework P1010RDB and P1010 device tree
    
    Utilize new split between board & SoC, and new SoC device trees split
    into pre & post utilizing 'template' includes for SoC IP blocks.
    
    Other changes include:
    * Moved to specifying interrupt-parent for mpic at root
    * Moved to 4-cell mpic interrupt cells to support MPIC timers
    * Dropping "fsl,p1010-IP..." from compatibles for standard blocks
    * PCI interrupt map - wrong IRQs for PCI-0 controller
    * SDHC interrupt sense was wrong
    
    Signed-off-by: Kumar Gala <galak@kernel.crashing.org>

commit 532919592fcfb824aad0494f54e45a0acc83a776
Author: Kumar Gala <galak@kernel.crashing.org>
Date:   Thu Nov 3 01:07:56 2011 -0500

    powerpc/85xx: Rework MPC8572DS device tree
    
    Utilize new split between board & SoC, and new SoC device trees split
    into pre & post utilizing 'template' includes for SoC IP blocks.
    
    Other changes include:
    
    * Moved to specifying interrupt-parent for mpic at root
    * Moved to 4-cell mpic interrupt cells to support MPIC timers
    * Removed CPU properties setup by u-boot to match other .dts
    * Reworked PCIe nodes to allow supportin IRQs for controller (errors) and
      moved PCI device IRQs down to virtual bridge level
    * Moved mdio nodes up one level instead of under tsec nodes
    * Added GPIO controller node to MPC8572 SoC template
    * Dropping "fsl,mpc8572-IP..." from compatibles for standard blocks
    
    Signed-off-by: Kumar Gala <galak@kernel.crashing.org>

commit e7a7b329f2001da8fbc3a35735adf32e516b9f93
Author: Kumar Gala <galak@kernel.crashing.org>
Date:   Wed Nov 9 16:26:13 2011 -0600

    powerpc/85xx: Rework MPC8569MDS device tree
    
    Utilize new split between board & SoC, and new SoC device trees split
    into pre & post utilizing 'template' includes for SoC IP blocks.
    
    Other changes include:
    * Moved to a standard 2 #address-cells & #size-cells at top-level
    * Moved to specifying interrupt-parent for mpic at root
    * Moved to 4-cell mpic interrupt cells to support MPIC timers
    * Removed CPU properties setup by u-boot to match other .dts
    * Reworked PCIe nodes to allow supportin IRQs for controller (errors)
      and moved PCI device IRQs down to virtual bridge level
    * Renamed SDHC node from 'sdhci' to 'sdhc'
    * Dropping "fsl,mpc8569-IP..." from compatibles for standard blocks
    
    Signed-off-by: Kumar Gala <galak@kernel.crashing.org>

commit 1a23b4a64a6ede84eae820f35e02a869bdf09b77
Author: Kumar Gala <galak@kernel.crashing.org>
Date:   Thu Nov 10 08:05:16 2011 -0600

    powerpc/85xx: Rework MPC8568MDS device tree
    
    Utilize new split between board & SoC, and new SoC device trees split
    into pre & post utilizing 'template' includes for SoC IP blocks.
    
    Other changes include:
    * Moved to a standard 2 #address-cells & #size-cells at top-level
    * Moved to specifying interrupt-parent for mpic at root
    * Moved to 4-cell mpic interrupt cells to support MPIC timers
    * Removed CPU properties setup by u-boot to match other .dts
    * Reworked PCIe nodes to allow supportin IRQs for controller (errors)
      and moved PCI device IRQs down to virtual bridge level
    * Dropping "fsl,mpc8568-IP..." from compatibles for standard blocks
    
    Signed-off-by: Kumar Gala <galak@kernel.crashing.org>

commit 53e23dcb1894604ac8377fd4293d29116b9ae904
Author: Kumar Gala <galak@kernel.crashing.org>
Date:   Fri Nov 4 00:26:10 2011 -0500

    powerpc/85xx: Rework MPC8548CDS device trees
    
    Utilize new split between board & SoC, and new SoC device trees split
    into pre & post utilizing 'template' includes for SoC IP blocks.
    
    Other changes include:
    * Moved to a standard 2 #address-cells & #size-cells at top-level
    * Moved to specifying interrupt-parent for mpic at root
    * Moved to 4-cell mpic interrupt cells to support MPIC timers
    * Moved mdio nodes up one level instead of under tsec nodes
    * Reworked PCIe nodes to allow supportin IRQs for controller (errors)
      and moved PCI device IRQs down to virtual bridge level
    * Removed CPU properties setup by u-boot to match other .dts
    * Added localbus node, but no chipselect details at this point
    * Added MPIC / PCIe msi node
    * Dropping "fsl,mpc8548-IP..." from compatibles for standard blocks
    
    Signed-off-by: Kumar Gala <galak@kernel.crashing.org>

commit b7f817547d7e1b56c1afbf4411df6fd73a0d78e9
Author: Kumar Gala <galak@kernel.crashing.org>
Date:   Thu Nov 3 23:24:12 2011 -0500

    powerpc/85xx: Rework MPC8544DS device tree
    
    Utilize new split between board & SoC, and new SoC device trees split
    into pre & post utilizing 'template' includes for SoC IP blocks.
    
    Other changes include:
    * Moved to a standard 2 #address-cells & #size-cells at top-level
    * Moved to specifying interrupt-parent for mpic at root
    * Moved to 4-cell mpic interrupt cells to support MPIC timers
    * Removed CPU properties setup by u-boot to match other .dts
    * Added localbus node, but no chipselect details at this point
    * Reworked PCIe nodes to allow supportin IRQs for controller (errors)
      and moved PCI device IRQs down to virtual bridge level
    * Moved mdio nodes up one level instead of under tsec nodes
    * Updated ethernet 'model' to 'eTSEC' as that's what on MPC8544
    * Dropping "fsl,mpc8544-IP..." from compatibles for standard blocks
    
    Signed-off-by: Kumar Gala <galak@kernel.crashing.org>

commit 2e8685a491c1063a4126598b10ecb78d1d20f537
Author: Kumar Gala <galak@kernel.crashing.org>
Date:   Thu Nov 3 16:16:07 2011 -0500

    powerpc/85xx: Rework MPC8536DS device trees
    
    Utilize new split between board & SoC, and new SoC device trees split
    into pre & post utilizing 'template' includes for SoC IP blocks.
    
    Other changes include:
    * Moved to specifying interrupt-parent for mpic at root
    * Moved to 4-cell mpic interrupt cells to support MPIC timers
    * Added localbus node, but no chipselect details at this point
    * Reworked PCIe nodes to allow supportin IRQs for controller (errors)
    * and moved
      PCI device IRQs down to virtual bridge level
    * Moved mdio nodes up one level instead of under tsec nodes
    * Added GPIO controller node to MPC8536 SoC template
      [ marked as MPC8572 compatiable to get errata handling that applies ]
    * Added missing cache-line-size & cache-size properties missing from
      L2-cache node
    * Added IP level IEEE 1588 / ptp timer node
    
    Signed-off-by: Kumar Gala <galak@kernel.crashing.org>

commit 6e3e939f3b1bf8534b32ad09ff199d88800835a0
Author: Johannes Berg <johannes.berg@intel.com>
Date:   Wed Nov 9 10:15:42 2011 +0100

    net: add wireless TX status socket option
    
    The 802.1X EAPOL handshake hostapd does requires
    knowing whether the frame was ack'ed by the peer.
    Currently, we fudge this pretty badly by not even
    transmitting the frame as a normal data frame but
    injecting it with radiotap and getting the status
    out of radiotap monitor as well. This is rather
    complex, confuses users (mon.wlan0 presence) and
    doesn't work with all hardware.
    
    To get rid of that hack, introduce a real wifi TX
    status option for data frame transmissions.
    
    This works similar to the existing TX timestamping
    in that it reflects the SKB back to the socket's
    error queue with a SCM_WIFI_STATUS cmsg that has
    an int indicating ACK status (0/1).
    
    Since it is possible that at some point we will
    want to have TX timestamping and wifi status in a
    single errqueue SKB (there's little point in not
    doing that), redefine SO_EE_ORIGIN_TIMESTAMPING
    to SO_EE_ORIGIN_TXSTATUS which can collect more
    than just the timestamp; keep the old constant
    as an alias of course. Currently the internal APIs
    don't make that possible, but it wouldn't be hard
    to split them up in a way that makes it possible.
    
    Thanks to Neil Horman for helping me figure out
    the functions that add the control messages.
    
    Signed-off-by: Johannes Berg <johannes.berg@intel.com>
    Signed-off-by: John W. Linville <linville@tuxdriver.com>

commit 7e8dec918ef8e0f68b4937c3c50fa57002077a4d
Author: Dmitry Kasatkin <dmitry.kasatkin@intel.com>
Date:   Mon Nov 7 15:16:37 2011 +0200

    crypto: GnuPG based MPI lib - additional sources (part 4)
    
    Adds the multi-precision-integer maths library which was originally taken
    from GnuPG and ported to the kernel by (among others) David Howells.
    This version is taken from Fedora kernel 2.6.32-71.14.1.el6.
    The difference is that checkpatch reported errors and warnings have been fixed.
    
    This library is used to implemenet RSA digital signature verification
    used in IMA/EVM integrity protection subsystem.
    
    Due to patch size limitation, the patch is divided into 4 parts.
    
    This code is unnecessary for RSA digital signature verification,
    but for completeness it is included here and can be compiled,
    if CONFIG_MPILIB_EXTRA is enabled.
    
    Signed-off-by: Dmitry Kasatkin <dmitry.kasatkin@intel.com>

commit d9c46b184fcfd33c85a7dc48a653435a08e21f56
Author: Dmitry Kasatkin <dmitry.kasatkin@intel.com>
Date:   Wed Aug 31 14:05:16 2011 +0300

    crypto: GnuPG based MPI lib - make files (part 3)
    
    Adds the multi-precision-integer maths library which was originally taken
    from GnuPG and ported to the kernel by (among others) David Howells.
    This version is taken from Fedora kernel 2.6.32-71.14.1.el6.
    The difference is that checkpatch reported errors and warnings have been fixed.
    
    This library is used to implemenet RSA digital signature verification
    used in IMA/EVM integrity protection subsystem.
    
    Due to patch size limitation, the patch is divided into 4 parts.
    
    Signed-off-by: Dmitry Kasatkin <dmitry.kasatkin@intel.com>

commit 5ce3e312ec5c11abce13215be70700778bf601f0
Author: Dmitry Kasatkin <dmitry.kasatkin@intel.com>
Date:   Wed Aug 31 14:05:16 2011 +0300

    crypto: GnuPG based MPI lib - header files (part 2)
    
    Adds the multi-precision-integer maths library which was originally taken
    from GnuPG and ported to the kernel by (among others) David Howells.
    This version is taken from Fedora kernel 2.6.32-71.14.1.el6.
    The difference is that checkpatch reported errors and warnings have been fixed.
    
    This library is used to implemenet RSA digital signature verification
    used in IMA/EVM integrity protection subsystem.
    
    Due to patch size limitation, the patch is divided into 4 parts.
    
    Signed-off-by: Dmitry Kasatkin <dmitry.kasatkin@intel.com>

commit cdec9cb5167ab1113ba9c58e395f664d9d3f9acb
Author: Dmitry Kasatkin <dmitry.kasatkin@intel.com>
Date:   Wed Aug 31 14:05:16 2011 +0300

    crypto: GnuPG based MPI lib - source files (part 1)
    
    Adds the multi-precision-integer maths library which was originally taken
    from GnuPG and ported to the kernel by (among others) David Howells.
    This version is taken from Fedora kernel 2.6.32-71.14.1.el6.
    The difference is that checkpatch reported errors and warnings have been fixed.
    
    This library is used to implemenet RSA digital signature verification
    used in IMA/EVM integrity protection subsystem.
    
    Due to patch size limitation, the patch is divided into 4 parts.
    
    Signed-off-by: Dmitry Kasatkin <dmitry.kasatkin@intel.com>

commit 44f16fcf2fba79cffb268d8f3c1f744efefa5dc9
Author: Matthew McClintock <msm@freescale.com>
Date:   Wed Oct 26 13:46:57 2011 -0500

    powerpc/85xx: issue 15 EOI after core reset for FSL CoreNet devices
    
    This is listed as a requirement for Freescale CoreNet based devices  (e.g
    p4080ds with MPIC v4.x) after issuing a core reset to properly clear pending
    interrupts.
    
    Signed-off-by: Matthew McClintock <msm@freescale.com>
    Signed-off-by: Kumar Gala <galak@kernel.crashing.org>

commit fcf634098c00dd9cd247447368495f0b79be12d1
Author: Christopher Yeoh <cyeoh@au1.ibm.com>
Date:   Mon Oct 31 17:06:39 2011 -0700

    Cross Memory Attach
    
    The basic idea behind cross memory attach is to allow MPI programs doing
    intra-node communication to do a single copy of the message rather than a
    double copy of the message via shared memory.
    
    The following patch attempts to achieve this by allowing a destination
    process, given an address and size from a source process, to copy memory
    directly from the source process into its own address space via a system
    call.  There is also a symmetrical ability to copy from the current
    process's address space into a destination process's address space.
    
    - Use of /proc/pid/mem has been considered, but there are issues with
      using it:
      - Does not allow for specifying iovecs for both src and dest, assuming
        preadv or pwritev was implemented either the area read from or
      written to would need to be contiguous.
      - Currently mem_read allows only processes who are currently
      ptrace'ing the target and are still able to ptrace the target to read
      from the target. This check could possibly be moved to the open call,
      but its not clear exactly what race this restriction is stopping
      (reason  appears to have been lost)
      - Having to send the fd of /proc/self/mem via SCM_RIGHTS on unix
      domain socket is a bit ugly from a userspace point of view,
      especially when you may have hundreds if not (eventually) thousands
      of processes  that all need to do this with each other
      - Doesn't allow for some future use of the interface we would like to
      consider adding in the future (see below)
      - Interestingly reading from /proc/pid/mem currently actually
      involves two copies! (But this could be fixed pretty easily)
    
    As mentioned previously use of vmsplice instead was considered, but has
    problems.  Since you need the reader and writer working co-operatively if
    the pipe is not drained then you block.  Which requires some wrapping to
    do non blocking on the send side or polling on the receive.  In all to all
    communication it requires ordering otherwise you can deadlock.  And in the
    example of many MPI tasks writing to one MPI task vmsplice serialises the
    copying.
    
    There are some cases of MPI collectives where even a single copy interface
    does not get us the performance gain we could.  For example in an
    MPI_Reduce rather than copy the data from the source we would like to
    instead use it directly in a mathops (say the reduce is doing a sum) as
    this would save us doing a copy.  We don't need to keep a copy of the data
    from the source.  I haven't implemented this, but I think this interface
    could in the future do all this through the use of the flags - eg could
    specify the math operation and type and the kernel rather than just
    copying the data would apply the specified operation between the source
    and destination and store it in the destination.
    
    Although we don't have a "second user" of the interface (though I've had
    some nibbles from people who may be interested in using it for intra
    process messaging which is not MPI).  This interface is something which
    hardware vendors are already doing for their custom drivers to implement
    fast local communication.  And so in addition to this being useful for
    OpenMPI it would mean the driver maintainers don't have to fix things up
    when the mm changes.
    
    There was some discussion about how much faster a true zero copy would
    go. Here's a link back to the email with some testing I did on that:
    
    http://marc.info/?l=linux-mm&m=130105930902915&w=2
    
    There is a basic man page for the proposed interface here:
    
    http://ozlabs.org/~cyeoh/cma/process_vm_readv.txt
    
    This has been implemented for x86 and powerpc, other architecture should
    mainly (I think) just need to add syscall numbers for the process_vm_readv
    and process_vm_writev. There are 32 bit compatibility versions for
    64-bit kernels.
    
    For arch maintainers there are some simple tests to be able to quickly
    verify that the syscalls are working correctly here:
    
    http://ozlabs.org/~cyeoh/cma/cma-test-20110718.tgz
    
    Signed-off-by: Chris Yeoh <yeohc@au1.ibm.com>
    Cc: Ingo Molnar <mingo@elte.hu>
    Cc: "H. Peter Anvin" <hpa@zytor.com>
    Cc: Thomas Gleixner <tglx@linutronix.de>
    Cc: Arnd Bergmann <arnd@arndb.de>
    Cc: Paul Mackerras <paulus@samba.org>
    Cc: Benjamin Herrenschmidt <benh@kernel.crashing.org>
    Cc: David Howells <dhowells@redhat.com>
    Cc: James Morris <jmorris@namei.org>
    Cc: <linux-man@vger.kernel.org>
    Cc: <linux-arch@vger.kernel.org>
    Signed-off-by: Andrew Morton <akpm@linux-foundation.org>
    Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>

commit 35116db95c42937061bfca93998291f6562e9e92
Author: nagalakshmi.nandigama@lsi.com <nagalakshmi.nandigama@lsi.com>
Date:   Fri Oct 21 10:08:07 2011 +0530

    [SCSI] mpt2sas: Fix for Panic when inactive volume is tried deleting
    
    The driver was setting the action to MPI2_CONFIG_ACTION_PAGE_READ_CURRENT,
    which only returns active volumes. In order to get info on inactive volumes,
    the driver needs to change the action to
    MPI2_RAID_PGAD_FORM_GET_NEXT_CONFIGNUM, and traverse each config till the
    iocstatus is MPI2_IOCSTATUS_CONFIG_INVALID_PAGE returned.
    Added a change in the driver to remove the instance of
    sas_device object when the driver returns "1" from the slave_configure callback.
    Also fixed code to report the hot spares to the operating system with a /dev/sg
    assigned.
    
    Signed-off-by: Nagalakshmi Nandigama <nagalakshmi.nandigama@lsi.com>
    Cc: stable@kernel.org
    Signed-off-by: James Bottomley <JBottomley@Parallels.com>

commit 24f09b598dc455be84991e69ab9e6a339fd66bcf
Author: nagalakshmi.nandigama@lsi.com <nagalakshmi.nandigama@lsi.com>
Date:   Wed Oct 19 15:36:47 2011 +0530

    [SCSI] mpt2sas: Fix failure message displayed during diag reset
    
    The fix is to inhibit the warning message in _scsih_get_sas_address
    when the MPI2_IOCSTATUS_CONFIG_INVALID_PAGE ioc status is returned.
    
    Signed-off-by: Nagalakshmi Nandigama <nagalakshmi.nandigama@lsi.com>
    Signed-off-by: James Bottomley <JBottomley@Parallels.com>

commit f9d979ce10c98dfd6d8d2a26217c3c4885ef97f6
Author: nagalakshmi.nandigama@lsi.com <nagalakshmi.nandigama@lsi.com>
Date:   Wed Oct 19 15:36:05 2011 +0530

    [SCSI] mpt2sas: MPI next revision header update
    
    1)Added ProxyVF_ID field to Configuration Request message.
    2)Added IO Unit Page 8, IO Unit Page 9,and IO Unit Page 10.
    3)Added SASNotifyPrimitiveMasks field to IOC Page 7.
    4)Added SAS NOTIFY Primitive event.
    5)Added Temperature Threshold Event.
    6)Added Host Message Event.
    7)Added Send Host Message request and reply.
    
    Signed-off-by: Nagalakshmi Nandigama <nagalakshmi.nandigama@lsi.com>
    Signed-off-by: James Bottomley <JBottomley@Parallels.com>

commit 2425717b27eb92b175335ca4ff0bb218cbe0cb64
Author: John Fastabend <john.r.fastabend@intel.com>
Date:   Mon Oct 10 09:16:41 2011 +0000

    net: allow vlan traffic to be received under bond
    
    The following configuration used to work as I expected. At least
    we could use the fcoe interfaces to do MPIO and the bond0 iface
    to do load balancing or failover.
    
           ---eth2.228-fcoe
           |
    eth2 -----|
              |
              |---- bond0
              |
    eth3 -----|
           |
           ---eth3.228-fcoe
    
    This worked because of a change we added to allow inactive slaves
    to rx 'exact' matches. This functionality was kept intact with the
    rx_handler mechanism. However now the vlan interface attached to the
    active slave never receives traffic because the bonding rx_handler
    updates the skb->dev and goto's another_round. Previously, the
    vlan_do_receive() logic was called before the bonding rx_handler.
    
    Now by the time vlan_do_receive calls vlan_find_dev() the
    skb->dev is set to bond0 and it is clear no vlan is attached
    to this iface. The vlan lookup fails.
    
    This patch moves the VLAN check above the rx_handler. A VLAN
    tagged frame is now routed to the eth2.228-fcoe iface in the
    above schematic. Untagged frames continue to the bond0 as
    normal. This case also remains intact,
    
    eth2 --> bond0 --> vlan.228
    
    Here the skb is VLAN tagged but the vlan lookup fails on eth2
    causing the bonding rx_handler to be called. On the second
    pass the vlan lookup is on the bond0 iface and completes as
    expected.
    
    Putting a VLAN.228 on both the bond0 and eth2 device will
    result in eth2.228 receiving the skb. I don't think this is
    completely unexpected and was the result prior to the rx_handler
    result.
    
    Note, the same setup is also used for other storage traffic that
    MPIO is used with eg. iSCSI and similar setups can be contrived
    without storage protocols.
    
    Signed-off-by: John Fastabend <john.r.fastabend@intel.com>
    Acked-by: Jesse Gross <jesse@nicira.com>
    Reviewed-by: Jiri Pirko <jpirko@redhat.com>
    Tested-by: Hans Schillstrom <hams.schillstrom@ericsson.com>
    Signed-off-by: David S. Miller <davem@davemloft.net>

commit c9018aab8eee24b993c12c7aff7fc99d3d73f298
Author: Vincent Guittot <vincent.guittot@linaro.org>
Date:   Mon Aug 8 13:21:59 2011 +0100

    ARM: 7011/1: Add ARM cpu topology definition
    
    The affinity between ARM processors is defined in the MPIDR register.
    We can identify which processors are in the same cluster,
    and which ones have performance interdependency. We can define the
    cpu topology of ARM platform, that is then used by sched_mc and sched_smt.
    
    The default state of sched_mc and sched_smt config is disable.
    When enabled, the behavior of the scheduler can be modified with
    sched_mc_power_savings and sched_smt_power_savings sysfs interfaces.
    
    Changes since v4 :
    *  Remove unnecessary parentheses and blank lines
    
    Changes since v3 :
    * Update the format of printk message
    * Remove blank line
    
    Changes since v2 :
    * Update the commit message and some comments
    
    Changes since v1 :
    * Update the commit message
    * Add read_cpuid_mpidr in arch/arm/include/asm/cputype.h
    * Modify header of arch/arm/kernel/topology.c
    * Modify tests and manipulation of MPIDR's bitfields
    * Modify the place and dependancy of the config
    * Modify Noop functions
    
    Signed-off-by: Vincent Guittot <vincent.guittot@linaro.org>
    Reviewed-by: Amit Kucheria <amit.kucheria@linaro.org>
    Signed-off-by: Russell King <rmk+kernel@arm.linux.org.uk>

commit 911ae9434f83e7355d343f6c2be3ef5b00ea7aed
Author: nagalakshmi.nandigama@lsi.com <nagalakshmi.nandigama@lsi.com>
Date:   Thu Sep 8 06:18:50 2011 +0530

    [SCSI] mpt2sas: Added NUNA IO support in driver which uses multi-reply queue support of the HBA
    
    Support added for controllers capable of multi reply queues.
    
    The following are the modifications to the driver to support NUMA.
    
    1) Create the new structure adapter_reply_queue to contain the reply queue
       info for every msix vector.  This object will contain a
       reply_post_host_index, reply_post_free for each instance, msix_index, among
       other parameters.  We will track all the reply queues on a link list called
       ioc->reply_queue_list. Each reply queue is aligned with each IRQ, and is
       passed to the interrupt via the bus_id parameter.
    
    (2) The driver will figure out the msix_vector_count from the PCIe MSIX
        capabilities register instead of the IOC Facts->MaxMSIxVectors. This is
        because the firmware is not filling in this field until the driver has
        already registered MSIX support.
    
    (3) If the ioc_facts reports that the controller is MSIX compatible in the
        capabilities, then the driver will request for multiple irqs.  This count
        is calculated based on the minimum between the online cpus available and
        the ioc->msix_vector_count.  This count is reported to firmware in the
        ioc_init request.
    
    (4) New routines were added _base_free_irq and _base_request_irq, so
        registering and freeing msix vectors were done thru simple function API.
    
    (5) The new routine _base_assign_reply_queues was added to align the msix
        indexes across cpus. This will initialize the array called
        ioc->cpu_msix_table.  This array is looked up on every MPI request so the
        MSIxIndex is set appropriately.
    
    (6) A new shost sysfs attribute was added to report the reply_queue_count.
    
    (7) User needs to set the affinity cpu mask, so the interrupts occur on the
        same cpu that sent the original request.
    
    Signed-off-by: Nagalakshmi Nandigama <nagalakshmi.nandigama@lsi.com>
    Signed-off-by: James Bottomley <JBottomley@Parallels.com>

commit 14b9247019432fc25e606b78262eb16a4a33b8ed
Author: Timur Tabi <timur@freescale.com>
Date:   Fri Jul 8 11:12:42 2011 +0000

    powerpc/mpic: Add support for discontiguous cores
    
    There is one place in the MPIC driver that assumes that the cores are numbered
    from 0 to n-1.  However, this is not true if the CPUs are not numbered
    sequentially.  This can happen on a eight-core SOC where cores two and three
    are removed in the device tree.  So instead of blindly looping, we iterate
    over the discovered CPUs and use the SMP ID as the index.
    
    This means that we no longer ask the MPIC how many CPUs there are, so
    we also delete mpic->num_cpus.
    
    We also catch if the number of CPUs in the SOC exceeds the number that the
    MPIC supports.  This should never happen, of course, but it's good to be
    sure.
    
    Signed-off-by: Timur Tabi <timur@freescale.com>
    Signed-off-by: Benjamin Herrenschmidt <benh@kernel.crashing.org>

commit a38ae37fdcd77657fb6624b0a0ec57f3d21e2f40
Author: kashyap.desai@lsi.com <kashyap.desai@lsi.com>
Date:   Thu Aug 4 16:42:46 2011 +0530

    [SCSI] mptfusion: Avoid out of order Event processing due to cpu migration
    
    Driver will now schedule MPI event using "delay_work_queue_on" to
    specify same CPU to be used to schedule work.  Earlier it used
    "delay_work_queue" which can cause migration of work due to kernel'
    timer migration feature.
    
    Signed-off-by: Kashyap Desai <kashyap.desai@lsi.com>
    Signed-off-by: James Bottomley <JBottomley@Parallels.com>

commit 82a452581230b3ffc9d6475dffdb2568497b5fec
Author: Kashyap, Desai <kashyap.desai@lsi.com>
Date:   Tue Jul 5 12:40:23 2011 +0530

    [SCSI] mpt2sas: WarpDrive Infinite command retries due to wrong scsi command entry in MPI message
    
    Issue:
    
    This issue is seen on LSI H/W WarpDrive SSS6200 When filed direct I/O
    is tried as volume I/O the scmd field in internal lookup table get
    cleared and because of that the retried volume I/O never gets reported
    as completed to SML.
    
    Result:
    
    I/O timeout and Error handling thread will kicking off
    
    Fix:
    
    Setting back the scmd in the lookup table before retrying the failed
    direct i/o
    
    Signed-off-by: Kashyap Desai <kashyap.desai@lsi.com>
    Signed-off-by: James Bottomley <JBottomley@Parallels.com>

commit a63e23b932eab46dc8acf39ac86e3385e2dec058
Author: Fabio Baltieri <fabio.baltieri@gmail.com>
Date:   Tue Jul 12 09:49:43 2011 +0200

    powerpc/85xx: fix mpic configuration in CAMP mode
    
    Change the string to check for CAMP mode boot on MPC85xx (eg. P2020) to match
    the one in the corresponding dts files (p2020rdb_camp_core{0,1}.dts).
    
    Without this fix the mpic is configured as in the SMP boot mode, which causes
    the first core to report a protected source interrupt error for devices
    of the other core and lock up.
    
    Also add MPIC_SINGLE_DEST_CPU on both P2020 based architectures in CAMP
    mode as suggested by Scott Wood. Thanks.
    
    Cc: Scott Wood <scottwood@freescale.com>
    Cc: Poonam Aggrwal <poonam.aggrwal@freescale.com>
    Cc: Benjamin Herrenschmidt <benh@kernel.crashing.org>
    Signed-off-by: Fabio Baltieri <fabio.baltieri@gmail.com>
    Signed-off-by: Kumar Gala <galak@kernel.crashing.org>

commit ce7b1810def1e2f0101931f8f339f9d8a694cd19
Author: Kashyap, Desai <kashyap.desai@lsi.com>
Date:   Tue Jun 14 10:55:45 2011 +0530

    [SCSI] mpt2sas MPI next revision header update
    
    mpt2sas driver revision q header update:
    
    (1) Modified the descriptions of the LocalAddress bit in the
        Flags field of the MPI SGE Format description and the MPI
        Simple Element.
    (2) Modified Data Location Address Space bits in the Flags field
        of the IEEE Chain Element.
    (3) Added more detail to the description of the DataLength field
        for the SCSI IO Request and Target Assist Request. Removed
        restriction on using chained SGLs when using multicast or
        bidirectional support.
    (4) In Manufacturing Page 7, added ReceptacleID field to
        ConnectorInfo, and reworked how the Pinout field is used.
    (5) In IO Unit Page 7, added BoardTemperature and
        BoardTemperatureUnits fields.
    (6) In IOC Page 1, changed CoalescingTimeout to units of
        half-microsecond and updated descriptions.
    (7) Modified descriptions of SATASlumberTimeout and
        SASSlumberTimeout fields in SAS IO Unit Page 5 to indicate
        the timers start after partial mode is entered.
    (8) Added Extended Manufacturing configuration pages.
    
    Signed-off-by: Kashyap Desai <kashyap.desai@lsi.com>
    Signed-off-by: James Bottomley <JBottomley@Parallels.com>

commit 3a93261f70c7b92f84fb211b66f1d4e66c0b3dce
Author: Ashish Kalra <ashish.kalra@freescale.com>
Date:   Thu May 19 08:54:28 2011 -0500

    powerpc: introduce the ePAPR embedded hypervisor vmpic driver
    
    The Freescale ePAPR reference hypervisor provides interrupt controller
    services via a hypercall interface, instead of emulating the MPIC
    controller.  This is called the VMPIC.
    
    The ePAPR "virtual interrupt controller" provides interrupt controller
    services for external interrupts.  External interrupts received by a
    partition can come from two sources:
    
      - Hardware interrupts - hardware interrupts come from external
        interrupt lines or on-chip I/O devices.
      - Virtual interrupts - virtual interrupts are generated by the hypervisor
        as part of some hypervisor service or hypervisor-created virtual device.
    
    Both types of interrupts are processed using the same programming model and
    same set of hypercalls.
    
    Signed-off-by: Ashish Kalra <ashish.kalra@freescale.com>
    Signed-off-by: Timur Tabi <timur@freescale.com>
    Signed-off-by: Kumar Gala <galak@kernel.crashing.org>

commit 6ec36b5848a8336d3a0010727b9365c3254d2d2e
Author: Stuart Yoder <stuart.yoder@freescale.com>
Date:   Thu May 19 08:54:26 2011 -0500

    powerpc: make irq_choose_cpu() available to all PIC drivers
    
    Move irq_choose_cpu() into arch/powerpc/kernel/irq.c so that it can be used
    by other PIC drivers.  The function is not MPIC-specific.
    
    Signed-off-by: Stuart Yoder <stuart.yoder@freescale.com>
    Signed-off-by: Timur Tabi <timur@freescale.com>
    Signed-off-by: Kumar Gala <galak@kernel.crashing.org>

commit dc2c9c52b604f51b1416ed87ff54a1c77a1a8b5b
Author: Scott Wood <scottwood@freescale.com>
Date:   Thu Aug 26 02:49:07 2010 -0500

    powerpc/85xx: Set up doorbells even with no mpic
    
    In cases like when the platform is used under hypervisor we will NOT
    have an MPIC controller but still want doorbells setup.
    
    Signed-off-by: Scott Wood <scottwood@freescale.com>
    Signed-off-by: Kumar Gala <galak@kernel.crashing.org>

commit 169296b38f06b981ee7163aaa1c03f03953cc37f
Author: Kumar Gala <galak@kernel.crashing.org>
Date:   Mon May 9 14:13:13 2011 -0500

    powerpc/85xx: Updates to P4080DS device tree
    
    * Added BSD dual-license
    * Moved mpic-parent to root so we dont need to duplicate everywhere
    * Added next level cache from L2 to CPC
    * Moved to 4-cell MPIC interrupt properties
    * Added 3 MSI banks
    * Added numerous missing nodes: soc-sram-error, guts, pins, clockgen,
      rcpm, sfp, serdes, etc.
    * Reworked PCIe interrupts to be at virtual bridge level
    
    Signed-off-by: Kumar Gala <galak@kernel.crashing.org>

commit d6cf07327e691e8f7c0f08af69d0dd3887aa1e4f
Author: Richard Cochran <richardcochran@gmail.com>
Date:   Sun Jun 19 21:51:27 2011 +0000

    fec_mpc52xx: enable transmit and receive time stamping.
    
    This patch enables software (and phy device) time stamping. Software
    time stamping using the SO_TIMESTAMPING API was tested and found to be
    working on the LITE5200B board.
    
    Cc: Grant Likely <grant.likely@secretlab.ca>
    Signed-off-by: Richard Cochran <richard.cochran@omicron.at>
    Signed-off-by: David S. Miller <davem@davemloft.net>

commit 339dedf709e21d5718d6596750166f70e8bed40a
Author: Benjamin Herrenschmidt <benh@kernel.crashing.org>
Date:   Tue May 31 18:01:23 2011 +1000

    powerpc/pmac: Don't register pmac PIC syscore ops when HW not present
    
    The Apple custom PIC only exist in some earlier machine models,
    anything with an MPIC will crash on suspend if we register those
    syscore ops unconditionally.
    
    This is a regression caused by commit f5a592f7d74e ("PM / PowerPC: Use
    struct syscore_ops instead of sysdevs for PM")
    
    Signed-off-by: Benjamin Herrenschmidt <benh@kernel.crashing.org>
    Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>

commit 2bb732cdb48d271ff7a910260ffb851fb4bc8a28
Merge: f50d1d9e8d96 c4d5ee13984f
Author: Linus Torvalds <torvalds@linux-foundation.org>
Date:   Tue May 24 13:31:37 2011 -0700

    Merge branch 'kbuild' of git://git.kernel.org/pub/scm/linux/kernel/git/mmarek/kbuild-2.6
    
    * 'kbuild' of git://git.kernel.org/pub/scm/linux/kernel/git/mmarek/kbuild-2.6:
      kbuild: make KBUILD_NOCMDDEP=1 handle empty built-in.o
      scripts/kallsyms.c: fix potential segfault
      scripts/gen_initramfs_list.sh: Convert to a /bin/sh script
      kbuild: Fix GNU make v3.80 compatibility
      kbuild: Fix passing -Wno-* options to gcc 4.4+
      kbuild: move scripts/basic/docproc.c to scripts/docproc.c
      kbuild: Fix Makefile.asm-generic for um
      kbuild: Allow to combine multiple W= levels
      kbuild: Disable -Wunused-but-set-variable for gcc 4.6.0
      Fix handling of backlash character in LINUX_COMPILE_BY name
      kbuild: asm-generic support
      kbuild: implement several W= levels
      kbuild: Fix build with binutils <= 2.19
      initramfs: Use KBUILD_BUILD_TIMESTAMP for generated entries
      kbuild: Allow to override LINUX_COMPILE_BY and LINUX_COMPILE_HOST macros
      kbuild: Drop unused LINUX_COMPILE_TIME and LINUX_COMPILE_DOMAIN macros
      kbuild: Use the deterministic mode of ar
      kbuild: Call gzip with -n
      kbuild: move KALLSYMS_EXTRA_PASS from Kconfig to Makefile
      Kconfig: improve KALLSYMS_ALL documentation
    
    Fix up trivial conflict in Makefile

commit 41cd08560bbf8371bbd00e783e992b0dc7e7c83d
Author: Prabhakar Kushwaha <prabhakar@freescale.com>
Date:   Thu Apr 28 12:30:00 2011 +0530

    powerpc/85xx: Create dts of each core in CAMP mode for P1020RDB
    
    Create the dts files for each core and splits the devices between the two
    cores for P1020RDB.
    
    Core0 has core0 to have memory, l2, i2c, spi, gpio, tdm, dma, usb, eth1,
    eth2, sdhc, crypto, global-util, message, pci0, pci1, msi.
    Core1 has l2, eth0, crypto.
    
    MPIC is shared between two cores but each core will protect its interrupts
    from other core by using "protected-sources" of mpic.
    
    Fix compatible property for global-util node of P1020si.dtsi.
    
    Signed-off-by: Prabhakar Kushwaha <prabhakar@freescale.com>
    Signed-off-by: Kumar Gala <galak@kernel.crashing.org>

commit ea94187face757e723aa461a60698ca43c09fbb9
Author: Scott Wood <scottwood@freescale.com>
Date:   Thu Mar 24 16:43:55 2011 -0500

    powerpc/mpic: add the mpic global timer support
    
    Add support for MPIC timers as requestable interrupt sources.
    
    Based on http://patchwork.ozlabs.org/patch/20941/ by Dave Liu.
    
    Signed-off-by: Dave Liu <daveliu@freescale.com>
    Signed-off-by: Scott Wood <scottwood@freescale.com>
    Signed-off-by: Kumar Gala <galak@kernel.crashing.org>

commit 180076cb11a5f02de7d26f8cb82969b895a26f40
Author: Scott Wood <scottwood@freescale.com>
Date:   Thu Mar 24 16:43:15 2011 -0500

    powerpc: Add fsl mpic timer binding
    
    Update the existing example in the general mpic binding to have a
    separate TCRx region.  Currently the example doesn't describe TCRx at
    all.  The one upstream device tree with an mpic timer node (p1022ds)
    uses one large reg region to describe both, even though there are other
    unrelated registers in between.  That device tree also contains a bogus
    interrupt specifier, and there's no upstream software that uses this yet,
    so changing this shouldn't be a problem.
    
    Add a full binding for the MPIC timer node, not just an example of
    4-cell interrupts in the MPIC binding.
    
    Add fsl,available-ranges, similar to msi-available-ranges.
    
    Signed-off-by: Scott Wood <scottwood@freescale.com>
    Signed-off-by: Kumar Gala <galak@kernel.crashing.org>

commit f07726048d599acd6bac438e304645a78db753c0
Author: Marcin Nowakowski <marcin.nowakowski.000@gmail.com>
Date:   Mon Apr 25 13:35:21 2011 +0100

    Fix handling of backlash character in LINUX_COMPILE_BY name
    
    When using a domain login, `whoami` returns the login in
    user\domain format. This leads to either warnings on unrecognised
    escape sequences or escaped characters being generated for the user.
    This patch ensures that any backslash is escaped to a double-backslash
    to make sure the name is preserved correctly. This patch does not
    enforce escaping on the KBUILD_BUILD_USER variable, as this is something
    the user has control of and can escape if required.
    
    Signed-off-by: Marcin Nowakowski <marcin.nowakowski.000@gmail.com>
    Signed-off-by: Michal Marek <mmarek@suse.cz>

commit 53e6892c0411006848882eacfcfea9e93681b55d
Author: Michal Marek <mmarek@suse.cz>
Date:   Tue Apr 5 14:32:30 2011 +0200

    kbuild: Allow to override LINUX_COMPILE_BY and LINUX_COMPILE_HOST macros
    
    Make it possible to override the user@host string displayed during boot
    and in /proc/version by the environment variables KBUILD_BUILD_USER and
    KBUILD_BUILD_HOST. Several distributions patch scripts/mkcompile_h to
    achieve this, so let's provide an official way. Also, document the
    KBUILD_BUILD_TIMESTAMP variable while at it.
    
    Signed-off-by: Michal Marek <mmarek@suse.cz>

commit 061296dc2c14f852604fc6849669fe0b78bb1eda
Author: Michal Marek <mmarek@suse.cz>
Date:   Thu Mar 31 17:13:55 2011 +0200

    kbuild: Drop unused LINUX_COMPILE_TIME and LINUX_COMPILE_DOMAIN macros
    
    Signed-off-by: Michal Marek <mmarek@suse.cz>

commit 45e07fd045153c0049c99b0cf6cf7254c164d37b
Author: Benjamin Herrenschmidt <benh@kernel.crashing.org>
Date:   Mon Feb 21 16:31:49 2011 +1100

    powerpc/pmac/smp: Fixup smp_core99_cpu_disable() and use it on 64-bit
    
    Use the generic code, just add the MPIC priority setting,
    
    I don't see any use in mucking around with the decrementer,
    as 32-bit will have EE off all along, and 64-bit will be able
    to deal with it.
    
    Signed-off-by: Benjamin Herrenschmidt <benh@kernel.crashing.org>

commit b7c594f128716d94767c9c165c5aee38639e7b6f
Author: Kashyap, Desai <kashyap.desai@lsi.com>
Date:   Tue Jan 4 11:40:23 2011 +0530

    mpt2sas: fix Integrated Raid unsynced on shutdown problem
    
    commit 3a9c913a3e57b170887d39456e04c18f2305ec67 upstream.
    
    Issue:
    IR shutdown(sending) and IR shutdown(complete) messages not
    listed in /var/log/messages when driver is removed.
    
    The driver needs to issue a MPI2_RAID_ACTION_SYSTEM_SHUTDOWN_INITIATED
    request when the driver is unloaded so the IR metadata journal is updated.
    If this request is not sent, then the volume would need a "check
    consistency" issued on the next bootup if the volume was roamed from one
    initiator to another. The current driver supports this feature only when the
    system is rebooted, however this also need to be supported if the driver is
    unloaded
    
    Fix:
    To fix this issue, the driver is going
    to need to call the _scsih_ir_shutdown prior to reporting
    the volumes missing from the OS, hence the device handles
    are still present.
    
    Signed-off-by: Kashyap Desai <kashyap.desai@lsi.com>
    Signed-off-by: James Bottomley <James.Bottomley@suse.de>
    Signed-off-by: Greg Kroah-Hartman <gregkh@suse.de>

commit 6ee5c420acc062e2beaa8df205cfc73925e26f8e
Author: Steve Wise <swise@opengridcomputing.com>
Date:   Sat Sep 18 19:38:21 2010 -0500

    RDMA/cxgb3: Turn off RX coalescing for iWARP connections
    
    commit bec658ff31453a5726b1c188674d587a5d40c482 upstream.
    
    The HW by default has RX coalescing on.  For iWARP connections, this
    causes a 100ms delay in connection establishement due to the ingress
    MPA Start message being stalled in HW.  So explicitly turn RX
    coalescing off when setting up iWARP connections.
    
    This was causing very bad performance for NP64 gather operations using
    Open MPI, due to the way it sets up connections on larger jobs.
    
    Signed-off-by: Steve Wise <swise@opengridcomputing.com>
    Signed-off-by: Roland Dreier <rolandd@cisco.com>
    Signed-off-by: Greg Kroah-Hartman <gregkh@suse.de>

commit 111f4268bd69cb040bf05038785cfbc4087f6341
Merge: a44f99c7efdb a71f5d5d2793
Author: Linus Torvalds <torvalds@linux-foundation.org>
Date:   Mon Mar 21 09:52:27 2011 -0700

    Merge branch 'merge' of git://git.kernel.org/pub/scm/linux/kernel/git/benh/powerpc
    
    * 'merge' of git://git.kernel.org/pub/scm/linux/kernel/git/benh/powerpc:
      powerpc/ptrace: Remove BUG_ON when full register set not available
      powerpc: Factoring mpic cpu id fetching into a function
      powerpc: Make MPIC honor the "pic-no-reset" device tree property
      powerpc: Document the Open PIC device tree binding
      powerpc/pci: Fix crash in PCI code on ppc64 when matching device nodes

commit d6a2639b887fcf90b422caccca4aee216bd1120e
Author: Meador Inge <meador_inge@mentor.com>
Date:   Mon Mar 14 10:01:07 2011 +0000

    powerpc: Factoring mpic cpu id fetching into a function
    
    The following code snippet:
    
            unsigned int cpu = 0;
            if (mpic->flags & MPIC_PRIMARY)
                    cpu = hard_smp_processor_id();
    
    is seen in several places in the 'mpic.c' code.  This changeset factors
    that pattern out into a helper function called 'mpic_processor_id'.
    
    Signed-off-by: Meador Inge <meador_inge@mentor.com>
    Cc: Benjamin Herrenschmidt <benh@kernel.crashing.org>
    Signed-off-by: Benjamin Herrenschmidt <benh@kernel.crashing.org>

commit dfec2202729e2460d67649a04756f0c3d8dcd8a6
Author: Meador Inge <meador_inge@mentor.com>
Date:   Mon Mar 14 10:01:06 2011 +0000

    powerpc: Make MPIC honor the "pic-no-reset" device tree property
    
    This property, defined in the Open PIC binding, tells the kernel not to use
    the reset bit in the global configuration register.  Additionally, its
    presence mandates that only sources which are actually used (i.e. appear in
    the device tree) should have their VECPRI bits initialized.
    
    Although, "pic-no-reset" can be used for the same use cases that
    "protected-sources" is covering, the "protected-sources" implementation was
    left completely intact.  This is a more pragmatic approach as there are
    already several existing systems which use protected sources.  If
    "pic-no-reset" *and* "protected-sources" are both used, however, then
    "pic-no-reset" takes precedence in terms of the init behavior and the
    sanity checks done by protected sources will still take place.
    
    Signed-off-by: Meador Inge <meador_inge@mentor.com>
    Cc: Hollis Blanchard <hollis_blanchard@mentor.com>
    Cc: Benjamin Herrenschmidt <benh@kernel.crashing.org>
    Signed-off-by: Benjamin Herrenschmidt <benh@kernel.crashing.org>

commit a99eff39c0549fe68fed150d39ec0c750e5ce1f1
Author: Meador Inge <meador_inge@mentor.com>
Date:   Mon Mar 14 10:01:05 2011 +0000

    powerpc: Document the Open PIC device tree binding
    
    This binding documents several properties that have been in use for quite
    some time, and adds one new property 'pic-no-reset', which controls the
    runtime initialization behavior of the PIC.  More specifically, the presence
    of 'pic-no-reset' mandates that the PIC shall not be reset during runtime
    initialization and that any initialization related to interrupt sources
    shall be limited to sources explicitly referenced in the device tree.  This
    functionality is useful in AMP systems where multiple OSes are sharing the
    PIC and the reinitialization of the PIC can interfere with OSes that are
    already up and running.
    
    The interrupt specifier definition is based off of Stuart Yoder's FSL MPIC
    binding.
    
    Signed-off-by: Meador Inge <meador_inge@mentor.com>
    Cc: Grant Likely <grant.likely@secretlab.ca>
    Cc: Stuart Yoder <stuart.yoder@freescale.com>
    Cc: Hollis Blanchard <hollis_blanchard@mentor.com>
    Signed-off-by: Benjamin Herrenschmidt <benh@kernel.crashing.org>

commit a693e69897e7811e2790295f38a0ce3a92c4b45c
Author: Anders Berggren <anders@halon.se>
Date:   Mon Feb 28 12:32:11 2011 -0800

    net: TX timestamps for IPv6 UDP packets
    
    Enabling TX timestamps (SO_TIMESTAMPING) for IPv6 UDP packets, in
    the same fashion as for IPv4. Necessary in order for NICs such as
    Intel 82580 to timestamp IPv6 packets.
    
    Signed-off-by: Anders Berggren <anders@halon.se>
    Signed-off-by: David S. Miller <davem@davemloft.net>

commit b770e599b231a81cf53e00beee29261cfc8be46c
Author: Russell King <rmk+kernel@arm.linux.org.uk>
Date:   Sun Jan 30 16:40:20 2011 +0000

    ARM: smp_on_up: allow non-ARM SMP processors
    
    commit e98ff0f55a0232b578c9aa7f1c245868277ac7bc upstream.
    
    Allow non-ARM SMP processors to use the SMP_ON_UP feature.  CPUs
    supporting SMP must have the new CPU ID format, so check for this first.
    Then check for ARM11MPCore, which fails the MPIDR check.  Lastly check
    the MPIDR reports multiprocessing extensions and that the CPU is part of
    a multiprocessing system.
    
    Reported-and-Tested-by: Stephen Boyd <sboyd@codeaurora.org>
    Acked-by: Will Deacon <will.deacon@arm.com>
    Signed-off-by: Russell King <rmk+kernel@arm.linux.org.uk>
    Signed-off-by: Greg Kroah-Hartman <gregkh@suse.de>

commit 6093ad9cb8c50534132f63a5c70ed846e16e4511
Author: Kashyap, Desai <kashyap.desai@lsi.com>
Date:   Tue Jan 4 11:34:17 2011 +0530

    mpt2sas: fix internal device reset for older firmware prior to MPI Rev K
    
    commit efe82a16bc0f9f9e1fc8fa706eb0309fcd57770a upstream.
    
    The "internal device reset complete" event is not supported
    for older firmware prior to MPI Rev K We added
    a check in the driver so the "internal device reset" event is
    ignored for older firmware.  When ignored, the tm_busy flag doesn't
    get set nor cleared.  Without this fix, IO queues would be froozen
    indefinetly after the "internal device reset" event, as the "complete" event
    never sent to clear the flag.
    
    Signed-off-by: Kashyap Desai <kashyap.desai@lsi.com>
    Signed-off-by: James Bottomley <James.Bottomley@suse.de>
    Signed-off-by: Greg Kroah-Hartman <gregkh@suse.de>

commit 9e449dbf515e4b45e5a5b6e15b347b01e7cef450
Author: Kashyap, Desai <kashyap.desai@lsi.com>
Date:   Tue Jan 4 11:40:23 2011 +0530

    mpt2sas: fix Integrated Raid unsynced on shutdown problem
    
    commit 3a9c913a3e57b170887d39456e04c18f2305ec67 upstream.
    
    Issue:
    IR shutdown(sending) and IR shutdown(complete) messages not
    listed in /var/log/messages when driver is removed.
    
    The driver needs to issue a MPI2_RAID_ACTION_SYSTEM_SHUTDOWN_INITIATED
    request when the driver is unloaded so the IR metadata journal is updated.
    If this request is not sent, then the volume would need a "check
    consistency" issued on the next bootup if the volume was roamed from one
    initiator to another. The current driver supports this feature only when the
    system is rebooted, however this also need to be supported if the driver is
    unloaded
    
    Fix:
    To fix this issue, the driver is going
    to need to call the _scsih_ir_shutdown prior to reporting
    the volumes missing from the OS, hence the device handles
    are still present.
    
    Signed-off-by: Kashyap Desai <kashyap.desai@lsi.com>
    Signed-off-by: James Bottomley <James.Bottomley@suse.de>
    Signed-off-by: Greg Kroah-Hartman <gregkh@suse.de>

commit 6866dfaf4ca45b3285e0f91b12d08696848a1eea
Author: Kashyap, Desai <kashyap.desai@lsi.com>
Date:   Tue Jan 4 11:34:17 2011 +0530

    mpt2sas: fix internal device reset for older firmware prior to MPI Rev K
    
    commit efe82a16bc0f9f9e1fc8fa706eb0309fcd57770a upstream.
    
    The "internal device reset complete" event is not supported
    for older firmware prior to MPI Rev K We added
    a check in the driver so the "internal device reset" event is
    ignored for older firmware.  When ignored, the tm_busy flag doesn't
    get set nor cleared.  Without this fix, IO queues would be froozen
    indefinetly after the "internal device reset" event, as the "complete" event
    never sent to clear the flag.
    
    Signed-off-by: Kashyap Desai <kashyap.desai@lsi.com>
    Signed-off-by: James Bottomley <James.Bottomley@suse.de>
    Signed-off-by: Greg Kroah-Hartman <gregkh@suse.de>

commit 5c52e065997c9eda03fe5f1011ff05ed7efda402
Author: Kashyap, Desai <kashyap.desai@lsi.com>
Date:   Tue Jan 4 11:40:23 2011 +0530

    mpt2sas: fix Integrated Raid unsynced on shutdown problem
    
    commit 3a9c913a3e57b170887d39456e04c18f2305ec67 upstream.
    
    Issue:
    IR shutdown(sending) and IR shutdown(complete) messages not
    listed in /var/log/messages when driver is removed.
    
    The driver needs to issue a MPI2_RAID_ACTION_SYSTEM_SHUTDOWN_INITIATED
    request when the driver is unloaded so the IR metadata journal is updated.
    If this request is not sent, then the volume would need a "check
    consistency" issued on the next bootup if the volume was roamed from one
    initiator to another. The current driver supports this feature only when the
    system is rebooted, however this also need to be supported if the driver is
    unloaded
    
    Fix:
    To fix this issue, the driver is going
    to need to call the _scsih_ir_shutdown prior to reporting
    the volumes missing from the OS, hence the device handles
    are still present.
    
    Signed-off-by: Kashyap Desai <kashyap.desai@lsi.com>
    Signed-off-by: James Bottomley <James.Bottomley@suse.de>
    Signed-off-by: Greg Kroah-Hartman <gregkh@suse.de>

commit 008aef526eb3c67239f1340aa74891355d8b609e
Merge: 831d52bc1539 9ee91f7fb550
Author: Linus Torvalds <torvalds@linux-foundation.org>
Date:   Thu Feb 3 13:53:58 2011 -0800

    Merge git://git.kernel.org/pub/scm/linux/kernel/git/jejb/scsi-rc-fixes-2.6
    
    * git://git.kernel.org/pub/scm/linux/kernel/git/jejb/scsi-rc-fixes-2.6:
      [SCSI] libsas: fix runaway error handler problem
      [SCSI] fix incorrect value of SCSI_MAX_SG_CHAIN_SEGMENTS due to include file ordering
      [SCSI] arcmsr: Fix the issue of system hangup after commands timeout on ARC-1200
      [SCSI] mpt2sas: fix Integrated Raid unsynced on shutdown problem
      [SCSI] mpt2sas: Kernel Panic during Large Topology discovery
      [SCSI] mpt2sas: Fix the race between broadcast asyn event and scsi command completion
      [SCSI] mpt2sas: Correct resizing calculation for max_queue_depth
      [SCSI] mpt2sas: fix internal device reset for older firmware prior to MPI Rev K
      [SCSI] mpt2sas: Fix device removal handshake for zoned devices

commit e98ff0f55a0232b578c9aa7f1c245868277ac7bc
Author: Russell King <rmk+kernel@arm.linux.org.uk>
Date:   Sun Jan 30 16:40:20 2011 +0000

    ARM: smp_on_up: allow non-ARM SMP processors
    
    Allow non-ARM SMP processors to use the SMP_ON_UP feature.  CPUs
    supporting SMP must have the new CPU ID format, so check for this first.
    Then check for ARM11MPCore, which fails the MPIDR check.  Lastly check
    the MPIDR reports multiprocessing extensions and that the CPU is part of
    a multiprocessing system.
    
    Cc: <stable@kernel.org>
    Reported-and-Tested-by: Stephen Boyd <sboyd@codeaurora.org>
    Acked-by: Will Deacon <will.deacon@arm.com>
    Signed-off-by: Russell King <rmk+kernel@arm.linux.org.uk>

commit 9af05d90e91026838330a2bf86a6692c86f3c4e7
Author: Kashyap, Desai <kashyap.desai@lsi.com>
Date:   Tue Jan 4 11:35:41 2011 +0530

    [SCSI] mpt2sas: Revision P MPI Header Update
    
    Revision P MPI Header Update:
    a) Added enable/disable SATA NCQ operations to SAS IO Unit Control
    Request.
    b) Modified Host Based Discovery Action Request message format.
    c) Removed Device Path bit from IO Unit Page 1 Flags field.
    d) Added description of ChainOffset field for Diagnostic Data Upload
    Tool.Chaining is not allowed.
    
    Removed mpi2_history.txt file
    
    Signed-off-by: Kashyap Desai <kashyap.desai@lsi.com>
    Signed-off-by: James Bottomley <James.Bottomley@suse.de>

commit 3a9c913a3e57b170887d39456e04c18f2305ec67
Author: Kashyap, Desai <kashyap.desai@lsi.com>
Date:   Tue Jan 4 11:40:23 2011 +0530

    [SCSI] mpt2sas: fix Integrated Raid unsynced on shutdown problem
    
    Issue:
    IR shutdown(sending) and IR shutdown(complete) messages not
    listed in /var/log/messages when driver is removed.
    
    The driver needs to issue a MPI2_RAID_ACTION_SYSTEM_SHUTDOWN_INITIATED
    request when the driver is unloaded so the IR metadata journal is updated.
    If this request is not sent, then the volume would need a "check
    consistency" issued on the next bootup if the volume was roamed from one
    initiator to another. The current driver supports this feature only when the
    system is rebooted, however this also need to be supported if the driver is
    unloaded
    
    Fix:
    To fix this issue, the driver is going
    to need to call the _scsih_ir_shutdown prior to reporting
    the volumes missing from the OS, hence the device handles
    are still present.
    
    Signed-off-by: Kashyap Desai <kashyap.desai@lsi.com>
    Cc: stable@kernel.org
    Signed-off-by: James Bottomley <James.Bottomley@suse.de>

commit efe82a16bc0f9f9e1fc8fa706eb0309fcd57770a
Author: Kashyap, Desai <kashyap.desai@lsi.com>
Date:   Tue Jan 4 11:34:17 2011 +0530

    [SCSI] mpt2sas: fix internal device reset for older firmware prior to MPI Rev K
    
    The "internal device reset complete" event is not supported
    for older firmware prior to MPI Rev K We added
    a check in the driver so the "internal device reset" event is
    ignored for older firmware.  When ignored, the tm_busy flag doesn't
    get set nor cleared.  Without this fix, IO queues would be froozen
    indefinetly after the "internal device reset" event, as the "complete" event
    never sent to clear the flag.
    
    Signed-off-by: Kashyap Desai <kashyap.desai@lsi.com>
    Cc: stable@kernel.org
    Signed-off-by: James Bottomley <James.Bottomley@suse.de>

commit b1b27e4a677bc8c92b3c83541b4981c000934bc2
Author: Eric Dumazet <eric.dumazet@gmail.com>
Date:   Sun Dec 5 18:50:32 2010 +0000

    net: fix skb_defer_rx_timestamp()
    
    [ Upstream commit a19faf0250e09b16cac169354126404bc8aa342b ]
    
    After commit c1f19b51d1d8 (net: support time stamping in phy devices.),
    kernel might crash if CONFIG_NETWORK_PHY_TIMESTAMPING=y and
    skb_defer_rx_timestamp() handles a packet without an ethernet header.
    
    Fixes kernel bugzilla #24102
    
    Reference: https://bugzilla.kernel.org/show_bug.cgi?id=24102
    Reported-and-tested-by: Andrew Watts <akwatts@ymail.com>
    Signed-off-by: Eric Dumazet <eric.dumazet@gmail.com>
    Signed-off-by: David S. Miller <davem@davemloft.net>
    Signed-off-by: Greg Kroah-Hartman <gregkh@suse.de>

commit 330dc1be8569f7eb671779928a876002bf69cade
Author: Steve Wise <swise@opengridcomputing.com>
Date:   Sat Sep 18 19:38:21 2010 -0500

    RDMA/cxgb3: Turn off RX coalescing for iWARP connections
    
    commit bec658ff31453a5726b1c188674d587a5d40c482 upstream.
    
    The HW by default has RX coalescing on.  For iWARP connections, this
    causes a 100ms delay in connection establishement due to the ingress
    MPA Start message being stalled in HW.  So explicitly turn RX
    coalescing off when setting up iWARP connections.
    
    This was causing very bad performance for NP64 gather operations using
    Open MPI, due to the way it sets up connections on larger jobs.
    
    Signed-off-by: Steve Wise <swise@opengridcomputing.com>
    Signed-off-by: Roland Dreier <rolandd@cisco.com>
    Signed-off-by: Paul Gortmaker <paul.gortmaker@windriver.com>

commit 90d2a672250b9d6e5c700f2d2c07c19d6fad064a
Author: Kashyap, Desai <kashyap.desai@lsi.com>
Date:   Sat Nov 13 04:37:36 2010 +0530

    [SCSI] mpt2sas: Remove code for TASK_SET_FULL from driver.
    
    remove support for MPI2_EVENT_TASK_SET_FULL
    This event is obsoleted, so this processing of this event
    needs to be removed from the driver.  The controller firmware is going
    to handle TASK_SET_FULL, the driver doesn't need to do anything.
    Even though we are removing the EVENT handling, the behavour has not
    changed between driver versions becuase fimrware will still be handling
    queue throttling, and retrying of commands when the target device queues
    are full.
    
    Signed-off-by: Kashyap Desai <kashyap.desai@lsi.com>
    Signed-off-by: James Bottomley <James.Bottomley@suse.de>

commit 7d061402590efc37d553a9155dbf41277675c179
Author: Kashyap, Desai <kashyap.desai@lsi.com>
Date:   Sat Nov 13 04:36:14 2010 +0530

    [SCSI] mpt2sas: MPI 2.0 Header updated
    
    MPI2 Rev header files.
    
    1) Removed Task Set Full Event. Modified description of Disable SCSI
    Initiator Task Set Full Handling bit in the Flags field of IO Unit
    Page 1. Modified the descriptions for the three queue depth fields in
    SAS IO Unit Page 1.
    (2) Added new value for the Current Operation bits of the Flags field
    in the RAID Volume Indicator Structure to indicate that the Make Data
    Consistent operation is running.
    (3) Added a value of 0x6 to various SAS link rate fields to indicate an
    attached PHY that is not using any commonly supported settings.
    (4) Added Volume Not Consistent bit to the VolumeStatusFlags field of
    RAID Volume Page 0.
    (5) Added a new value for the IncompatibleReason field of RAID Physical
    Disk Page 0 to indicate an incompatible media type.
    (6) Added Diagnostic Data Upload tool for the Toolbox Request.
    
    Signed-off-by: Kashyap Desai <kashyap.desai@lsi.com>
    Signed-off-by: James Bottomley <James.Bottomley@suse.de>

commit a19faf0250e09b16cac169354126404bc8aa342b
Author: Eric Dumazet <eric.dumazet@gmail.com>
Date:   Sun Dec 5 18:50:32 2010 +0000

    net: fix skb_defer_rx_timestamp()
    
    After commit c1f19b51d1d8 (net: support time stamping in phy devices.),
    kernel might crash if CONFIG_NETWORK_PHY_TIMESTAMPING=y and
    skb_defer_rx_timestamp() handles a packet without an ethernet header.
    
    Fixes kernel bugzilla #24102
    
    Reference: https://bugzilla.kernel.org/show_bug.cgi?id=24102
    Reported-and-tested-by: Andrew Watts <akwatts@ymail.com>
    Signed-off-by: Eric Dumazet <eric.dumazet@gmail.com>
    Signed-off-by: David S. Miller <davem@davemloft.net>

commit b8a7e2b687977fa0a2d0969d8e32fe6f5a4fbff4
Author: Steve Wise <swise@opengridcomputing.com>
Date:   Sat Sep 18 19:38:21 2010 -0500

    RDMA/cxgb3: Turn off RX coalescing for iWARP connections
    
    commit bec658ff31453a5726b1c188674d587a5d40c482 upstream.
    
    The HW by default has RX coalescing on.  For iWARP connections, this
    causes a 100ms delay in connection establishement due to the ingress
    MPA Start message being stalled in HW.  So explicitly turn RX
    coalescing off when setting up iWARP connections.
    
    This was causing very bad performance for NP64 gather operations using
    Open MPI, due to the way it sets up connections on larger jobs.
    
    Signed-off-by: Steve Wise <swise@opengridcomputing.com>
    Signed-off-by: Roland Dreier <rolandd@cisco.com>
    Signed-off-by: Greg Kroah-Hartman <gregkh@suse.de>

commit f4fe0c68bc27a9d5d26fdaa13e308a6acfde8bba
Author: Steve Wise <swise@opengridcomputing.com>
Date:   Sat Sep 18 19:38:21 2010 -0500

    RDMA/cxgb3: Turn off RX coalescing for iWARP connections
    
    commit bec658ff31453a5726b1c188674d587a5d40c482 upstream.
    
    The HW by default has RX coalescing on.  For iWARP connections, this
    causes a 100ms delay in connection establishement due to the ingress
    MPA Start message being stalled in HW.  So explicitly turn RX
    coalescing off when setting up iWARP connections.
    
    This was causing very bad performance for NP64 gather operations using
    Open MPI, due to the way it sets up connections on larger jobs.
    
    Signed-off-by: Steve Wise <swise@opengridcomputing.com>
    Signed-off-by: Roland Dreier <rolandd@cisco.com>
    Signed-off-by: Greg Kroah-Hartman <gregkh@suse.de>

commit 97cb7e40c69618ba03030b467faf60dc3ee982ee
Author: Steve Wise <swise@opengridcomputing.com>
Date:   Fri Aug 13 20:56:34 2010 +0000

    RDMA/ucma: Allow tuning the max listen backlog
    
    For iWARP connections, the connect request is carried in a TCP payload
    on an already established TCP connection.  So if the ucma's backlog is
    full, the connection request is transmitted and acked at the TCP level
    by the time the connect request gets dropped in the ucma.  The end
    result is the connection gets rejected by the iWARP provider.
    Further, a 32 node 256NP OpenMPI job will generate > 128 connect
    requests on some ranks.
    
    This patch increases the default max backlog to 1024, and adds a
    sysctl variable so the backlog can be adjusted at run time.
    
    Signed-off-by: Steve Wise <swise@opengridcomputing.com>
    Signed-off-by: Roland Dreier <rolandd@cisco.com>

commit 067173526c3bbc2eaeefcf6b7b2a9d998b9e8042
Author: Russell King <rmk+kernel@arm.linux.org.uk>
Date:   Sat Sep 4 16:14:20 2010 +0100

    ARM: Provide common header for hard_smp_processor_id()
    
    Provide a common header to read the SMP CPU number from the MPIDR.
    
    Signed-off-by: Russell King <rmk+kernel@arm.linux.org.uk>

commit bec658ff31453a5726b1c188674d587a5d40c482
Author: Steve Wise <swise@opengridcomputing.com>
Date:   Sat Sep 18 19:38:21 2010 -0500

    RDMA/cxgb3: Turn off RX coalescing for iWARP connections
    
    The HW by default has RX coalescing on.  For iWARP connections, this
    causes a 100ms delay in connection establishement due to the ingress
    MPA Start message being stalled in HW.  So explicitly turn RX
    coalescing off when setting up iWARP connections.
    
    This was causing very bad performance for NP64 gather operations using
    Open MPI, due to the way it sets up connections on larger jobs.
    
    Signed-off-by: Steve Wise <swise@opengridcomputing.com>
    Cc: <stable@kernel.org>
    Signed-off-by: Roland Dreier <rolandd@cisco.com>

commit f155ee1b5def75927fd86a839d7ab10b8fa07e79
Author: Steve Wise <swise@opengridcomputing.com>
Date:   Sat Aug 28 13:35:05 2010 +0000

    RDMA/cxgb3: Don't exceed the max HW CQ depth
    
    commit dc4e96ce2dceb649224ee84f83592aac8c54c9b7 upstream.
    
    The max depth supported by T3 is 64K entries.  This fixes a bug
    introduced in commit 9918b28d ("RDMA/cxgb3: Increase the max CQ
    depth") that causes stalls and possibly crashes in large MPI clusters.
    
    Signed-off-by: Steve Wise <swise@opengridcomputing.com>
    Signed-off-by: Roland Dreier <rolandd@cisco.com>
    Signed-off-by: Greg Kroah-Hartman <gregkh@suse.de>

commit b1d46989c12ec4d93f274ca8378bb1a6014d244a
Author: Madhuranath Iyengar <madhuranath.iyengar@qlogic.com>
Date:   Fri Sep 3 15:20:54 2010 -0700

    [SCSI] qla2xxx: Handle MPI timeout indicated by AE8002
    
    In case the MPI times out, the FW issues an async event AE8002
    to indicate this to every FCoE function. The FC/FCoE driver is
    required to handle this, by doing a soft reset and issuing a
    Write MPI register mailbox command to reset the MPI.
    
    Signed-off-by: Giridhar Malavali <giridhar.malavali@qlogic.com>
    Signed-off-by: James Bottomley <James.Bottomley@suse.de>

commit dc4e96ce2dceb649224ee84f83592aac8c54c9b7
Author: Steve Wise <swise@opengridcomputing.com>
Date:   Sat Aug 28 13:35:05 2010 +0000

    RDMA/cxgb3: Don't exceed the max HW CQ depth
    
    The max depth supported by T3 is 64K entries.  This fixes a bug
    introduced in commit 9918b28d ("RDMA/cxgb3: Increase the max CQ
    depth") that causes stalls and possibly crashes in large MPI clusters.
    
    Signed-off-by: Steve Wise <swise@opengridcomputing.com>
    Cc: <stable@kernel.org>
    Signed-off-by: Roland Dreier <rolandd@cisco.com>

commit bd45fe539f0e26ff8d76b4cb954195ab8a6467af
Merge: e1f1f07334e7 314b389b1795
Author: Linus Torvalds <torvalds@linux-foundation.org>
Date:   Tue Aug 24 00:26:34 2010 -0700

    Merge git://git.kernel.org/pub/scm/linux/kernel/git/benh/powerpc
    
    * git://git.kernel.org/pub/scm/linux/kernel/git/benh/powerpc: (25 commits)
      powerpc: Fix config dependency problem with MPIC_U3_HT_IRQS
      via-pmu: Add compat_pmu_ioctl
      powerpc: Wire up fanotify_init, fanotify_mark, prlimit64 syscalls
      powerpc/pci: Fix checking for child bridges in PCI code.
      powerpc: Fix typo in uImage target
      powerpc: Initialise paca->kstack before early_setup_secondary
      powerpc: Fix bogus it_blocksize in VIO iommu code
      powerpc: Inline ppc64_runlatch_off
      powerpc: Correct smt_enabled=X boot option for > 2 threads per core
      powerpc: Silence xics_migrate_irqs_away() during cpu offline
      powerpc: Silence __cpu_up() under normal operation
      powerpc: Re-enable preemption before cpu_die()
      powerpc/pci: Drop unnecessary null test
      powerpc/powermac: Drop unnecessary null test
      powerpc/powermac: Drop unnecessary of_node_put
      powerpc/kdump: Stop all other CPUs before running crash handlers
      powerpc/mm: Fix vsid_scrample typo
      powerpc: Use is_32bit_task() helper to test 32 bit binary
      powerpc: Export memstart_addr and kernstart_addr on ppc64
      powerpc: Make rwsem use "long" type
      ...

commit 314b389b1795286400f109a25e9c2f02ab3b9b15
Author: Andreas Schwab <schwab@linux-m68k.org>
Date:   Mon Aug 23 07:36:41 2010 +0000

    powerpc: Fix config dependency problem with MPIC_U3_HT_IRQS
    
    MPIC_U3_HT_IRQS is selected both by PPC_PMAC64 and PPC_MAPLE, but depends
    on PPC_MAPLE, so a PPC_PMAC64-only config gets this warning:
    
    warning: (PPC_PMAC64 && PPC_PMAC && POWER4 || PPC_MAPLE && PPC64 && PPC_BOOK3S) selects MPIC_U3_HT_IRQS which has unmet direct dependencies (PPC_MAPLE)
    
    Fix that by removing the dependency on PPC_MAPLE.
    
    Signed-off-by: Andreas Schwab <schwab@linux-m68k.org>
    Signed-off-by: Benjamin Herrenschmidt <benh@kernel.crashing.org>

commit 7a1b29a82ba76427de791098c095ce31dab9333d
Merge: d7824370e263 a5854dd7f30c
Author: Linus Torvalds <torvalds@linux-foundation.org>
Date:   Sun Aug 15 17:31:43 2010 -0700

    Merge git://git.kernel.org/pub/scm/linux/kernel/git/cmetcalf/linux-tile
    
    * git://git.kernel.org/pub/scm/linux/kernel/git/cmetcalf/linux-tile:
      arch/tile: don't validate CROSS_COMPILE needlessly
      arch/tile: export only COMMAND_LINE_SIZE to userspace.
      arch/tile: rename ARCH_KMALLOC_MINALIGN to ARCH_DMA_MINALIGN
      arch/tile: Rename the hweight() implementations to __arch_hweight()
      arch/tile: extend syscall ABI to set r1 on return as well.
      arch/tile: Various cleanups.
      arch/tile: support backtracing on TILE-Gx
      arch/tile: Fix a couple of issues with the COMPAT code for TILE-Gx.
      arch/tile: Use separate, better minsec values for clocksource and sched_clock.
      arch/tile: correct a bug in freeing bootmem by VA for the optional second initrd.
      arch: tile: mm: pgtable.c: Removed duplicated #include
      arch: tile: kernel/proc.c Removed duplicated #include
      Add fanotify syscalls to <asm-generic/unistd.h>.
      arch/tile: support new kunmap_atomic() naming convention.
      tile: remove unused ISA_DMA_THRESHOLD define
    
    Conflicts in arch/tile/configs/tile_defconfig (pick the mainline version
    with the reduced defconfig).

commit a5854dd7f30c3849edf9b9711362e2dd51d3f855
Author: Chris Metcalf <cmetcalf@tilera.com>
Date:   Sun Aug 15 15:01:45 2010 -0400

    arch/tile: don't validate CROSS_COMPILE needlessly
    
    With this change, the arch/tile Makefile will only check for a valid
    combination of CROSS_COMPILE vs "uname -m" for a few common targets
    that are typically the ones we get wrong (vmlinux, all, and modules).
    The change handles the case of an empty "make" goal like "make all".
    
    Signed-off-by: Chris Metcalf <cmetcalf@tilera.com>
    Reviewed-by: Sam Ravnborg <sam@ravnborg.org>

commit 9a459f6812fc26e0eb24bbe9c388000e23f67f6b
Merge: 090b710e8a0b 55c640c3abff
Author: Linus Torvalds <torvalds@linux-foundation.org>
Date:   Fri Aug 13 17:57:56 2010 -0700

    Merge branch 'kbuild' of git://git.kernel.org/pub/scm/linux/kernel/git/mmarek/kbuild-2.6
    
    * 'kbuild' of git://git.kernel.org/pub/scm/linux/kernel/git/mmarek/kbuild-2.6:
      setlocalversion: fix version for untaged nontip mercurial revs
      Fix CONFIG_CROSS_COMPILE issue in .config

commit 235caa235cb6f88fd04bc58a288f45463e5361c7
Author: Yegor Yefremov <yegorslists@googlemail.com>
Date:   Wed Aug 4 14:16:15 2010 +0200

    Fix CONFIG_CROSS_COMPILE issue in .config
    
    Signed-off-by: Yegor Yefremov <yegorslists@googlemail.com>
    Signed-off-by: Michal Marek <mmarek@suse.cz>

commit 7e48b30af033076c85ab48a8306b5588faf5fb4b
Author: Jarod Wilson <jarod@redhat.com>
Date:   Sun Mar 7 17:55:43 2010 -0300

    V4L/DVB: dvb: add support for kworld 340u and ub435-q to em28xx-dvb
    
    This adds support for the KWorld PlusTV 340U and KWorld UB345-Q ATSC
    sticks, which are really the same device. The sticks have an eMPIA
    em2870 usb bridge chipset, an LG Electronics LGDT3304 ATSC/QAM
    demodulator and an NXP TDA18271HD tuner -- early versions of the 340U
    have a a TDA18271HD/C1, later models and the UB435-Q have a C2.
    
    The stick has been tested succesfully with both VSB_8 and QAM_256 signals.
    Its using lgdt3304 support added to the lgdt3305 driver by a prior patch,
    rather than the current lgdt3304 driver, as its severely lacking in
    functionality by comparison (see said patch for details).
    
    Signed-off-by: Jarod Wilson <jarod@redhat.com>
    Signed-off-by: Michael Krufky <mkrufky@kernellabs.com>
    Signed-off-by: Mauro Carvalho Chehab <mchehab@redhat.com>

commit 18642a57df02a044b91219d3176128996ddc81a5
Author: H. Peter Anvin <hpa@zytor.com>
Date:   Tue Jul 27 23:52:29 2010 -0700

    x86, vdso: Don't quote $nm in the script for checking vdso references
    
    Don't quote $nm in the script for checking the vdso for external
    references.  Doing so breaks multiword constructs, like using
    CROSS_COMPILE='ccache '.
    
    Reported-by: Stephen Rothwell <sfr@canb.auug.org.au>
    Signed-off-by: H. Peter Anvin <hpa@zytor.com>
    LKML-Reference: <20100728134252.2e4c27cf.sfr@canb.auug.org.au>

commit 203d65b16cfef448dbfb79f66b672be4511fc6a9
Author: Kashyap, Desai <kashyap.desai@lsi.com>
Date:   Thu Jun 17 13:37:59 2010 +0530

    [SCSI] mpt2sas: MPI header version N is updated.
    
    Updating MPI header version N.
    Removed mpi_history.txt.
    
    Signed-off-by: Kashyap Desai <kashyap.desai@lsi.com>
    Signed-off-by: James Bottomley <James.Bottomley@suse.de>

commit 66953ebef60ffe94650a735b445f1495d989c523
Author: Matthew McClintock <msm@freescale.com>
Date:   Tue Jun 29 09:42:26 2010 +0000

    powerpc/mpic: Add ability to reset a core via MPIC
    
    We need the ability to reset cores for use with kexec/kdump for
    SMP systems. Calling this function with the specific core you want
    to reset will cause the CPU to spin in reset.
    
    Signed-off-by: Matthew McClintock <msm@freescale.com>
    Signed-off-by: Benjamin Herrenschmidt <benh@kernel.crashing.org>

commit 1973e8b8edea68d2408328d25b318ee7401293be
Author: Steve Wise <swise@opengridcomputing.com>
Date:   Thu Jun 10 19:03:06 2010 +0000

    RDMA/cxgb4: Avoid false GTS CIDX_INC overflows
    
    The T4 IQ hw design assumes CIDX_INC credits will be returned on a
    regular basis and always before the CIDX counter crosses over the PIDX
    counter.  For RDMA CQs, however, returning CIDX_INC credits is only
    needed and desired when and if the CQ is armed for notification.  This
    can lead to a GTS write returning credits that causes the HW to reject
    the credit update because it causes CIDX to pass PIDX.  Once this
    happens, the CIDX/PIDX counters get out of whack and an application
    can miss a notification and get stuck blocked awaiting a notification.
    
    To avoid this, we allocate the HW IQ 2x times the requested size.
    This seems to avoid the false overflow failures.  If we see more
    issues with this, then we'll have to add code in the poll path to
    return credits periodically like when the amount reaches 1/2 the queue
    depth).  I would like to avoid this as it adds a PCI write transaction
    for applications that never arm the CQ (like most MPIs).
    
    Signed-off-by: Steve Wise <swise@opengridcomputing.com>
    Signed-off-by: Roland Dreier <rolandd@cisco.com>

commit c6d409cfd0fd41e7a0847875e4338ad648c9b96b
Author: Eric Dumazet <eric.dumazet@gmail.com>
Date:   Thu Jun 3 20:03:40 2010 -0700

    From abbffa2aa9bd6f8df16d0d0a102af677510d8b9a Mon Sep 17 00:00:00 2001
    From: Eric Dumazet <eric.dumazet@gmail.com>
    Date: Thu, 3 Jun 2010 04:29:41 +0000
    Subject: [PATCH 2/3] net: net/socket.c and net/compat.c cleanups
    
    cleanup patch, to match modern coding style.
    
    Signed-off-by: Eric Dumazet <eric.dumazet@gmail.com>
    Signed-off-by: David S. Miller <davem@davemloft.net>
    ---
     net/compat.c |   47 ++++++++---------
     net/socket.c |  165 ++++++++++++++++++++++++++++------------------------------
     2 files changed, 102 insertions(+), 110 deletions(-)
    
    diff --git a/net/compat.c b/net/compat.c
    index 1cf7590..63d260e 100644
    --- a/net/compat.c
    +++ b/net/compat.c
    @@ -81,7 +81,7 @@ int verify_compat_iovec(struct msghdr *kern_msg, struct iovec *kern_iov,
            int tot_len;
    
            if (kern_msg->msg_namelen) {
    -               if (mode==VERIFY_READ) {
    +               if (mode == VERIFY_READ) {
                            int err = move_addr_to_kernel(kern_msg->msg_name,
                                                          kern_msg->msg_namelen,
                                                          kern_address);
    @@ -354,7 +354,7 @@ static int do_set_attach_filter(struct socket *sock, int level, int optname,
     static int do_set_sock_timeout(struct socket *sock, int level,
                    int optname, char __user *optval, unsigned int optlen)
     {
    -       struct compat_timeval __user *up = (struct compat_timeval __user *) optval;
    +       struct compat_timeval __user *up = (struct compat_timeval __user *)optval;
            struct timeval ktime;
            mm_segment_t old_fs;
            int err;
    @@ -367,7 +367,7 @@ static int do_set_sock_timeout(struct socket *sock, int level,
                    return -EFAULT;
            old_fs = get_fs();
            set_fs(KERNEL_DS);
    -       err = sock_setsockopt(sock, level, optname, (char *) &ktime, sizeof(ktime));
    +       err = sock_setsockopt(sock, level, optname, (char *)&ktime, sizeof(ktime));
            set_fs(old_fs);
    
            return err;
    @@ -389,11 +389,10 @@ asmlinkage long compat_sys_setsockopt(int fd, int level, int optname,
                                    char __user *optval, unsigned int optlen)
     {
            int err;
    -       struct socket *sock;
    +       struct socket *sock = sockfd_lookup(fd, &err);
    
    -       if ((sock = sockfd_lookup(fd, &err))!=NULL)
    -       {
    -               err = security_socket_setsockopt(sock,level,optname);
    +       if (sock) {
    +               err = security_socket_setsockopt(sock, level, optname);
                    if (err) {
                            sockfd_put(sock);
                            return err;
    @@ -453,7 +452,7 @@ static int compat_sock_getsockopt(struct socket *sock, int level, int optname,
     int compat_sock_get_timestamp(struct sock *sk, struct timeval __user *userstamp)
     {
            struct compat_timeval __user *ctv =
    -                       (struct compat_timeval __user*) userstamp;
    +                       (struct compat_timeval __user *) userstamp;
            int err = -ENOENT;
            struct timeval tv;
    
    @@ -477,7 +476,7 @@ EXPORT_SYMBOL(compat_sock_get_timestamp);
     int compat_sock_get_timestampns(struct sock *sk, struct timespec __user *userstamp)
     {
            struct compat_timespec __user *ctv =
    -                       (struct compat_timespec __user*) userstamp;
    +                       (struct compat_timespec __user *) userstamp;
            int err = -ENOENT;
            struct timespec ts;
    
    @@ -502,12 +501,10 @@ asmlinkage long compat_sys_getsockopt(int fd, int level, int optname,
                                    char __user *optval, int __user *optlen)
     {
            int err;
    -       struct socket *sock;
    +       struct socket *sock = sockfd_lookup(fd, &err);
    
    -       if ((sock = sockfd_lookup(fd, &err))!=NULL)
    -       {
    -               err = security_socket_getsockopt(sock, level,
    -                                                          optname);
    +       if (sock) {
    +               err = security_socket_getsockopt(sock, level, optname);
                    if (err) {
                            sockfd_put(sock);
                            return err;
    @@ -557,7 +554,7 @@ struct compat_group_filter {
    
     int compat_mc_setsockopt(struct sock *sock, int level, int optname,
            char __user *optval, unsigned int optlen,
    -       int (*setsockopt)(struct sock *,int,int,char __user *,unsigned int))
    +       int (*setsockopt)(struct sock *, int, int, char __user *, unsigned int))
     {
            char __user     *koptval = optval;
            int             koptlen = optlen;
    @@ -640,12 +637,11 @@ int compat_mc_setsockopt(struct sock *sock, int level, int optname,
            }
            return setsockopt(sock, level, optname, koptval, koptlen);
     }
    -
     EXPORT_SYMBOL(compat_mc_setsockopt);
    
     int compat_mc_getsockopt(struct sock *sock, int level, int optname,
            char __user *optval, int __user *optlen,
    -       int (*getsockopt)(struct sock *,int,int,char __user *,int __user *))
    +       int (*getsockopt)(struct sock *, int, int, char __user *, int __user *))
     {
            struct compat_group_filter __user *gf32 = (void *)optval;
            struct group_filter __user *kgf;
    @@ -681,7 +677,7 @@ int compat_mc_getsockopt(struct sock *sock, int level, int optname,
                __put_user(interface, &kgf->gf_interface) ||
                __put_user(fmode, &kgf->gf_fmode) ||
                __put_user(numsrc, &kgf->gf_numsrc) ||
    -           copy_in_user(&kgf->gf_group,&gf32->gf_group,sizeof(kgf->gf_group)))
    +           copy_in_user(&kgf->gf_group, &gf32->gf_group, sizeof(kgf->gf_group)))
                    return -EFAULT;
    
            err = getsockopt(sock, level, optname, (char __user *)kgf, koptlen);
    @@ -714,21 +710,22 @@ int compat_mc_getsockopt(struct sock *sock, int level, int optname,
                    copylen = numsrc * sizeof(gf32->gf_slist[0]);
                    if (copylen > klen)
                            copylen = klen;
    -               if (copy_in_user(gf32->gf_slist, kgf->gf_slist, copylen))
    +               if (copy_in_user(gf32->gf_slist, kgf->gf_slist, copylen))
                            return -EFAULT;
            }
            return err;
     }
    -
     EXPORT_SYMBOL(compat_mc_getsockopt);
    
     /* Argument list sizes for compat_sys_socketcall */
     #define AL(x) ((x) * sizeof(u32))
    -static unsigned char nas[20]={AL(0),AL(3),AL(3),AL(3),AL(2),AL(3),
    -                               AL(3),AL(3),AL(4),AL(4),AL(4),AL(6),
    -                               AL(6),AL(2),AL(5),AL(5),AL(3),AL(3),
    -                               AL(4),AL(5)};
    +static unsigned char nas[20] = {
    +       AL(0), AL(3), AL(3), AL(3), AL(2), AL(3),
    +       AL(3), AL(3), AL(4), AL(4), AL(4), AL(6),
    +       AL(6), AL(2), AL(5), AL(5), AL(3), AL(3),
    +       AL(4), AL(5)
    +};
     #undef AL
    
     asmlinkage long compat_sys_sendmsg(int fd, struct compat_msghdr __user *msg, unsigned flags)
    @@ -827,7 +824,7 @@ asmlinkage long compat_sys_socketcall(int call, u32 __user *args)
                                              compat_ptr(a[4]), compat_ptr(a[5]));
                    break;
            case SYS_SHUTDOWN:
    -               ret = sys_shutdown(a0,a1);
    +               ret = sys_shutdown(a0, a1);
                    break;
            case SYS_SETSOCKOPT:
                    ret = compat_sys_setsockopt(a0, a1, a[2],
    diff --git a/net/socket.c b/net/socket.c
    index 367d547..b63c051 100644
    --- a/net/socket.c
    +++ b/net/socket.c
    @@ -124,7 +124,7 @@ static int sock_fasync(int fd, struct file *filp, int on);
     static ssize_t sock_sendpage(struct file *file, struct page *page,
                                 int offset, size_t size, loff_t *ppos, int more);
     static ssize_t sock_splice_read(struct file *file, loff_t *ppos,
    -                               struct pipe_inode_info *pipe, size_t len,
    +                               struct pipe_inode_info *pipe, size_t len,
                                    unsigned int flags);
    
     /*
    @@ -162,7 +162,7 @@ static const struct net_proto_family *net_families[NPROTO] __read_mostly;
      *     Statistics counters of the socket lists
      */
    
    -static DEFINE_PER_CPU(int, sockets_in_use) = 0;
    +static DEFINE_PER_CPU(int, sockets_in_use);
    
     /*
      * Support routines.
    @@ -309,9 +309,9 @@ static int init_inodecache(void)
     }
    
     static const struct super_operations sockfs_ops = {
    -       .alloc_inode =  sock_alloc_inode,
    -       .destroy_inode =sock_destroy_inode,
    -       .statfs =       simple_statfs,
    +       .alloc_inode    = sock_alloc_inode,
    +       .destroy_inode  = sock_destroy_inode,
    +       .statfs         = simple_statfs,
     };
    
     static int sockfs_get_sb(struct file_system_type *fs_type,
    @@ -411,6 +411,7 @@ int sock_map_fd(struct socket *sock, int flags)
    
            return fd;
     }
    +EXPORT_SYMBOL(sock_map_fd);
    
     static struct socket *sock_from_file(struct file *file, int *err)
     {
    @@ -422,7 +423,7 @@ static struct socket *sock_from_file(struct file *file, int *err)
     }
    
     /**
    - *     sockfd_lookup   -       Go from a file number to its socket slot
    + *     sockfd_lookup - Go from a file number to its socket slot
      *     @fd: file handle
      *     @err: pointer to an error code return
      *
    @@ -450,6 +451,7 @@ struct socket *sockfd_lookup(int fd, int *err)
                    fput(file);
            return sock;
     }
    +EXPORT_SYMBOL(sockfd_lookup);
    
     static struct socket *sockfd_lookup_light(int fd, int *err, int *fput_needed)
     {
    @@ -540,6 +542,7 @@ void sock_release(struct socket *sock)
            }
            sock->file = NULL;
     }
    +EXPORT_SYMBOL(sock_release);
    
     int sock_tx_timestamp(struct msghdr *msg, struct sock *sk,
                          union skb_shared_tx *shtx)
    @@ -586,6 +589,7 @@ int sock_sendmsg(struct socket *sock, struct msghdr *msg, size_t size)
                    ret = wait_on_sync_kiocb(&iocb);
            return ret;
     }
    +EXPORT_SYMBOL(sock_sendmsg);
    
     int kernel_sendmsg(struct socket *sock, struct msghdr *msg,
                       struct kvec *vec, size_t num, size_t size)
    @@ -604,6 +608,7 @@ int kernel_sendmsg(struct socket *sock, struct msghdr *msg,
            set_fs(oldfs);
            return result;
     }
    +EXPORT_SYMBOL(kernel_sendmsg);
    
     static int ktime2ts(ktime_t kt, struct timespec *ts)
     {
    @@ -664,7 +669,6 @@ void __sock_recv_timestamp(struct msghdr *msg, struct sock *sk,
                    put_cmsg(msg, SOL_SOCKET,
                             SCM_TIMESTAMPING, sizeof(ts), &ts);
     }
    -
     EXPORT_SYMBOL_GPL(__sock_recv_timestamp);
    
     inline void sock_recv_drops(struct msghdr *msg, struct sock *sk, struct sk_buff *skb)
    @@ -720,6 +724,7 @@ int sock_recvmsg(struct socket *sock, struct msghdr *msg,
                    ret = wait_on_sync_kiocb(&iocb);
            return ret;
     }
    +EXPORT_SYMBOL(sock_recvmsg);
    
     static int sock_recvmsg_nosec(struct socket *sock, struct msghdr *msg,
                                  size_t size, int flags)
    @@ -752,6 +757,7 @@ int kernel_recvmsg(struct socket *sock, struct msghdr *msg,
            set_fs(oldfs);
            return result;
     }
    +EXPORT_SYMBOL(kernel_recvmsg);
    
     static void sock_aio_dtor(struct kiocb *iocb)
     {
    @@ -774,7 +780,7 @@ static ssize_t sock_sendpage(struct file *file, struct page *page,
     }
    
     static ssize_t sock_splice_read(struct file *file, loff_t *ppos,
    -                               struct pipe_inode_info *pipe, size_t len,
    +                               struct pipe_inode_info *pipe, size_t len,
                                    unsigned int flags)
     {
            struct socket *sock = file->private_data;
    @@ -887,7 +893,7 @@ static ssize_t sock_aio_write(struct kiocb *iocb, const struct iovec *iov,
      */
    
     static DEFINE_MUTEX(br_ioctl_mutex);
    -static int (*br_ioctl_hook) (struct net *, unsigned int cmd, void __user *arg) = NULL;
    +static int (*br_ioctl_hook) (struct net *, unsigned int cmd, void __user *arg);
    
     void brioctl_set(int (*hook) (struct net *, unsigned int, void __user *))
     {
    @@ -895,7 +901,6 @@ void brioctl_set(int (*hook) (struct net *, unsigned int, void __user *))
            br_ioctl_hook = hook;
            mutex_unlock(&br_ioctl_mutex);
     }
    -
     EXPORT_SYMBOL(brioctl_set);
    
     static DEFINE_MUTEX(vlan_ioctl_mutex);
    @@ -907,7 +912,6 @@ void vlan_ioctl_set(int (*hook) (struct net *, void __user *))
            vlan_ioctl_hook = hook;
            mutex_unlock(&vlan_ioctl_mutex);
     }
    -
     EXPORT_SYMBOL(vlan_ioctl_set);
    
     static DEFINE_MUTEX(dlci_ioctl_mutex);
    @@ -919,7 +923,6 @@ void dlci_ioctl_set(int (*hook) (unsigned int, void __user *))
            dlci_ioctl_hook = hook;
            mutex_unlock(&dlci_ioctl_mutex);
     }
    -
     EXPORT_SYMBOL(dlci_ioctl_set);
    
     static long sock_do_ioctl(struct net *net, struct socket *sock,
    @@ -1047,6 +1050,7 @@ out_release:
            sock = NULL;
            goto out;
     }
    +EXPORT_SYMBOL(sock_create_lite);
    
     /* No kernel lock held - perfect */
     static unsigned int sock_poll(struct file *file, poll_table *wait)
    @@ -1147,6 +1151,7 @@ call_kill:
            rcu_read_unlock();
            return 0;
     }
    +EXPORT_SYMBOL(sock_wake_async);
    
     static int __sock_create(struct net *net, int family, int type, int protocol,
                             struct socket **res, int kern)
    @@ -1265,11 +1270,13 @@ int sock_create(int family, int type, int protocol, struct socket **res)
     {
            return __sock_create(current->nsproxy->net_ns, family, type, protocol, res, 0);
     }
    +EXPORT_SYMBOL(sock_create);
    
     int sock_create_kern(int family, int type, int protocol, struct socket **res)
     {
            return __sock_create(&init_net, family, type, protocol, res, 1);
     }
    +EXPORT_SYMBOL(sock_create_kern);
    
     SYSCALL_DEFINE3(socket, int, family, int, type, int, protocol)
     {
    @@ -1474,7 +1481,8 @@ SYSCALL_DEFINE4(accept4, int, fd, struct sockaddr __user *, upeer_sockaddr,
                    goto out;
    
            err = -ENFILE;
    -       if (!(newsock = sock_alloc()))
    +       newsock = sock_alloc();
    +       if (!newsock)
                    goto out_put;
    
            newsock->type = sock->type;
    @@ -1861,8 +1869,7 @@ SYSCALL_DEFINE3(sendmsg, int, fd, struct msghdr __user *, msg, unsigned, flags)
            if (MSG_CMSG_COMPAT & flags) {
                    if (get_compat_msghdr(&msg_sys, msg_compat))
                            return -EFAULT;
    -       }
    -       else if (copy_from_user(&msg_sys, msg, sizeof(struct msghdr)))
    +       } else if (copy_from_user(&msg_sys, msg, sizeof(struct msghdr)))
                    return -EFAULT;
    
            sock = sockfd_lookup_light(fd, &err, &fput_needed);
    @@ -1964,8 +1971,7 @@ static int __sys_recvmsg(struct socket *sock, struct msghdr __user *msg,
            if (MSG_CMSG_COMPAT & flags) {
                    if (get_compat_msghdr(msg_sys, msg_compat))
                            return -EFAULT;
    -       }
    -       else if (copy_from_user(msg_sys, msg, sizeof(struct msghdr)))
    +       } else if (copy_from_user(msg_sys, msg, sizeof(struct msghdr)))
                    return -EFAULT;
    
            err = -EMSGSIZE;
    @@ -2191,10 +2197,10 @@ SYSCALL_DEFINE5(recvmmsg, int, fd, struct mmsghdr __user *, mmsg,
     /* Argument list sizes for sys_socketcall */
     #define AL(x) ((x) * sizeof(unsigned long))
     static const unsigned char nargs[20] = {
    -       AL(0),AL(3),AL(3),AL(3),AL(2),AL(3),
    -       AL(3),AL(3),AL(4),AL(4),AL(4),AL(6),
    -       AL(6),AL(2),AL(5),AL(5),AL(3),AL(3),
    -       AL(4),AL(5)
    +       AL(0), AL(3), AL(3), AL(3), AL(2), AL(3),
    +       AL(3), AL(3), AL(4), AL(4), AL(4), AL(6),
    +       AL(6), AL(2), AL(5), AL(5), AL(3), AL(3),
    +       AL(4), AL(5)
     };
    
     #undef AL
    @@ -2340,6 +2346,7 @@ int sock_register(const struct net_proto_family *ops)
            printk(KERN_INFO "NET: Registered protocol family %d\n", ops->family);
            return err;
     }
    +EXPORT_SYMBOL(sock_register);
    
     /**
      *     sock_unregister - remove a protocol handler
    @@ -2366,6 +2373,7 @@ void sock_unregister(int family)
    
            printk(KERN_INFO "NET: Unregistered protocol family %d\n", family);
     }
    +EXPORT_SYMBOL(sock_unregister);
    
     static int __init sock_init(void)
     {
    @@ -2490,13 +2498,13 @@ static int dev_ifconf(struct net *net, struct compat_ifconf __user *uifc32)
                    ifc.ifc_req = NULL;
                    uifc = compat_alloc_user_space(sizeof(struct ifconf));
            } else {
    -               size_t len =((ifc32.ifc_len / sizeof (struct compat_ifreq)) + 1) *
    -                       sizeof (struct ifreq);
    +               size_t len = ((ifc32.ifc_len / sizeof(struct compat_ifreq)) + 1) *
    +                       sizeof(struct ifreq);
                    uifc = compat_alloc_user_space(sizeof(struct ifconf) + len);
                    ifc.ifc_len = len;
                    ifr = ifc.ifc_req = (void __user *)(uifc + 1);
                    ifr32 = compat_ptr(ifc32.ifcbuf);
    -               for (i = 0; i < ifc32.ifc_len; i += sizeof (struct compat_ifreq)) {
    +               for (i = 0; i < ifc32.ifc_len; i += sizeof(struct compat_ifreq)) {
                            if (copy_in_user(ifr, ifr32, sizeof(struct compat_ifreq)))
                                    return -EFAULT;
                            ifr++;
    @@ -2516,9 +2524,9 @@ static int dev_ifconf(struct net *net, struct compat_ifconf __user *uifc32)
            ifr = ifc.ifc_req;
            ifr32 = compat_ptr(ifc32.ifcbuf);
            for (i = 0, j = 0;
    -             i + sizeof (struct compat_ifreq) <= ifc32.ifc_len && j < ifc.ifc_len;
    -            i += sizeof (struct compat_ifreq), j += sizeof (struct ifreq)) {
    -               if (copy_in_user(ifr32, ifr, sizeof (struct compat_ifreq)))
    +            i + sizeof(struct compat_ifreq) <= ifc32.ifc_len && j < ifc.ifc_len;
    +            i += sizeof(struct compat_ifreq), j += sizeof(struct ifreq)) {
    +               if (copy_in_user(ifr32, ifr, sizeof(struct compat_ifreq)))
                            return -EFAULT;
                    ifr32++;
                    ifr++;
    @@ -2567,7 +2575,7 @@ static int compat_siocwandev(struct net *net, struct compat_ifreq __user *uifr32
            compat_uptr_t uptr32;
            struct ifreq __user *uifr;
    
    -       uifr = compat_alloc_user_space(sizeof (*uifr));
    +       uifr = compat_alloc_user_space(sizeof(*uifr));
            if (copy_in_user(uifr, uifr32, sizeof(struct compat_ifreq)))
                    return -EFAULT;
    
    @@ -2601,9 +2609,9 @@ static int bond_ioctl(struct net *net, unsigned int cmd,
                            return -EFAULT;
    
                    old_fs = get_fs();
    -               set_fs (KERNEL_DS);
    +               set_fs(KERNEL_DS);
                    err = dev_ioctl(net, cmd, &kifr);
    -               set_fs (old_fs);
    +               set_fs(old_fs);
    
                    return err;
            case SIOCBONDSLAVEINFOQUERY:
    @@ -2710,9 +2718,9 @@ static int compat_sioc_ifmap(struct net *net, unsigned int cmd,
                    return -EFAULT;
    
            old_fs = get_fs();
    -       set_fs (KERNEL_DS);
    +       set_fs(KERNEL_DS);
            err = dev_ioctl(net, cmd, (void __user *)&ifr);
    -       set_fs (old_fs);
    +       set_fs(old_fs);
    
            if (cmd == SIOCGIFMAP && !err) {
                    err = copy_to_user(uifr32, &ifr, sizeof(ifr.ifr_name));
    @@ -2734,7 +2742,7 @@ static int compat_siocshwtstamp(struct net *net, struct compat_ifreq __user *uif
            compat_uptr_t uptr32;
            struct ifreq __user *uifr;
    
    -       uifr = compat_alloc_user_space(sizeof (*uifr));
    +       uifr = compat_alloc_user_space(sizeof(*uifr));
            if (copy_in_user(uifr, uifr32, sizeof(struct compat_ifreq)))
                    return -EFAULT;
    
    @@ -2750,20 +2758,20 @@ static int compat_siocshwtstamp(struct net *net, struct compat_ifreq __user *uif
     }
    
     struct rtentry32 {
    -       u32             rt_pad1;
    +       u32             rt_pad1;
            struct sockaddr rt_dst;         /* target address               */
            struct sockaddr rt_gateway;     /* gateway addr (RTF_GATEWAY)   */
            struct sockaddr rt_genmask;     /* target network mask (IP)     */
    -       unsigned short  rt_flags;
    -       short           rt_pad2;
    -       u32             rt_pad3;
    -       unsigned char   rt_tos;
    -       unsigned char   rt_class;
    -       short           rt_pad4;
    -       short           rt_metric;      /* +1 for binary compatibility! */
    +       unsigned short  rt_flags;
    +       short           rt_pad2;
    +       u32             rt_pad3;
    +       unsigned char   rt_tos;
    +       unsigned char   rt_class;
    +       short           rt_pad4;
    +       short           rt_metric;      /* +1 for binary compatibility! */
            /* char * */ u32 rt_dev;        /* forcing the device at add    */
    -       u32             rt_mtu;         /* per route MTU/Window         */
    -       u32             rt_window;      /* Window clamping              */
    +       u32             rt_mtu;         /* per route MTU/Window         */
    +       u32             rt_window;      /* Window clamping              */
            unsigned short  rt_irtt;        /* Initial RTT                  */
     };
    
    @@ -2793,29 +2801,29 @@ static int routing_ioctl(struct net *net, struct socket *sock,
    
            if (sock && sock->sk && sock->sk->sk_family == AF_INET6) { /* ipv6 */
                    struct in6_rtmsg32 __user *ur6 = argp;
    -               ret = copy_from_user (&r6.rtmsg_dst, &(ur6->rtmsg_dst),
    +               ret = copy_from_user(&r6.rtmsg_dst, &(ur6->rtmsg_dst),
                            3 * sizeof(struct in6_addr));
    -               ret |= __get_user (r6.rtmsg_type, &(ur6->rtmsg_type));
    -               ret |= __get_user (r6.rtmsg_dst_len, &(ur6->rtmsg_dst_len));
    -               ret |= __get_user (r6.rtmsg_src_len, &(ur6->rtmsg_src_len));
    -               ret |= __get_user (r6.rtmsg_metric, &(ur6->rtmsg_metric));
    -               ret |= __get_user (r6.rtmsg_info, &(ur6->rtmsg_info));
    -               ret |= __get_user (r6.rtmsg_flags, &(ur6->rtmsg_flags));
    -               ret |= __get_user (r6.rtmsg_ifindex, &(ur6->rtmsg_ifindex));
    +               ret |= __get_user(r6.rtmsg_type, &(ur6->rtmsg_type));
    +               ret |= __get_user(r6.rtmsg_dst_len, &(ur6->rtmsg_dst_len));
    +               ret |= __get_user(r6.rtmsg_src_len, &(ur6->rtmsg_src_len));
    +               ret |= __get_user(r6.rtmsg_metric, &(ur6->rtmsg_metric));
    +               ret |= __get_user(r6.rtmsg_info, &(ur6->rtmsg_info));
    +               ret |= __get_user(r6.rtmsg_flags, &(ur6->rtmsg_flags));
    +               ret |= __get_user(r6.rtmsg_ifindex, &(ur6->rtmsg_ifindex));
    
                    r = (void *) &r6;
            } else { /* ipv4 */
                    struct rtentry32 __user *ur4 = argp;
    -               ret = copy_from_user (&r4.rt_dst, &(ur4->rt_dst),
    +               ret = copy_from_user(&r4.rt_dst, &(ur4->rt_dst),
                                            3 * sizeof(struct sockaddr));
    -               ret |= __get_user (r4.rt_flags, &(ur4->rt_flags));
    -               ret |= __get_user (r4.rt_metric, &(ur4->rt_metric));
    -               ret |= __get_user (r4.rt_mtu, &(ur4->rt_mtu));
    -               ret |= __get_user (r4.rt_window, &(ur4->rt_window));
    -               ret |= __get_user (r4.rt_irtt, &(ur4->rt_irtt));
    -               ret |= __get_user (rtdev, &(ur4->rt_dev));
    +               ret |= __get_user(r4.rt_flags, &(ur4->rt_flags));
    +               ret |= __get_user(r4.rt_metric, &(ur4->rt_metric));
    +               ret |= __get_user(r4.rt_mtu, &(ur4->rt_mtu));
    +               ret |= __get_user(r4.rt_window, &(ur4->rt_window));
    +               ret |= __get_user(r4.rt_irtt, &(ur4->rt_irtt));
    +               ret |= __get_user(rtdev, &(ur4->rt_dev));
                    if (rtdev) {
    -                       ret |= copy_from_user (devname, compat_ptr(rtdev), 15);
    +                       ret |= copy_from_user(devname, compat_ptr(rtdev), 15);
                            r4.rt_dev = devname; devname[15] = 0;
                    } else
                            r4.rt_dev = NULL;
    @@ -2828,9 +2836,9 @@ static int routing_ioctl(struct net *net, struct socket *sock,
                    goto out;
            }
    
    -       set_fs (KERNEL_DS);
    +       set_fs(KERNEL_DS);
            ret = sock_do_ioctl(net, sock, cmd, (unsigned long) r);
    -       set_fs (old_fs);
    +       set_fs(old_fs);
    
     out:
            return ret;
    @@ -2993,11 +3001,13 @@ int kernel_bind(struct socket *sock, struct sockaddr *addr, int addrlen)
     {
            return sock->ops->bind(sock, addr, addrlen);
     }
    +EXPORT_SYMBOL(kernel_bind);
    
     int kernel_listen(struct socket *sock, int backlog)
     {
            return sock->ops->listen(sock, backlog);
     }
    +EXPORT_SYMBOL(kernel_listen);
    
     int kernel_accept(struct socket *sock, struct socket **newsock, int flags)
     {
    @@ -3022,24 +3032,28 @@ int kernel_accept(struct socket *sock, struct socket **newsock, int flags)
     done:
            return err;
     }
    +EXPORT_SYMBOL(kernel_accept);
    
     int kernel_connect(struct socket *sock, struct sockaddr *addr, int addrlen,
                       int flags)
     {
            return sock->ops->connect(sock, addr, addrlen, flags);
     }
    +EXPORT_SYMBOL(kernel_connect);
    
     int kernel_getsockname(struct socket *sock, struct sockaddr *addr,
                             int *addrlen)
     {
            return sock->ops->getname(sock, addr, addrlen, 0);
     }
    +EXPORT_SYMBOL(kernel_getsockname);
    
     int kernel_getpeername(struct socket *sock, struct sockaddr *addr,
                             int *addrlen)
     {
            return sock->ops->getname(sock, addr, addrlen, 1);
     }
    +EXPORT_SYMBOL(kernel_getpeername);
    
     int kernel_getsockopt(struct socket *sock, int level, int optname,
                            char *optval, int *optlen)
    @@ -3056,6 +3070,7 @@ int kernel_getsockopt(struct socket *sock, int level, int optname,
            set_fs(oldfs);
            return err;
     }
    +EXPORT_SYMBOL(kernel_getsockopt);
    
     int kernel_setsockopt(struct socket *sock, int level, int optname,
                            char *optval, unsigned int optlen)
    @@ -3072,6 +3087,7 @@ int kernel_setsockopt(struct socket *sock, int level, int optname,
            set_fs(oldfs);
            return err;
     }
    +EXPORT_SYMBOL(kernel_setsockopt);
    
     int kernel_sendpage(struct socket *sock, struct page *page, int offset,
                        size_t size, int flags)
    @@ -3083,6 +3099,7 @@ int kernel_sendpage(struct socket *sock, struct page *page, int offset,
    
            return sock_no_sendpage(sock, page, offset, size, flags);
     }
    +EXPORT_SYMBOL(kernel_sendpage);
    
     int kernel_sock_ioctl(struct socket *sock, int cmd, unsigned long arg)
     {
    @@ -3095,33 +3112,11 @@ int kernel_sock_ioctl(struct socket *sock, int cmd, unsigned long arg)
    
            return err;
     }
    +EXPORT_SYMBOL(kernel_sock_ioctl);
    
     int kernel_sock_shutdown(struct socket *sock, enum sock_shutdown_cmd how)
     {
            return sock->ops->shutdown(sock, how);
     }
    -
    -EXPORT_SYMBOL(sock_create);
    -EXPORT_SYMBOL(sock_create_kern);
    -EXPORT_SYMBOL(sock_create_lite);
    -EXPORT_SYMBOL(sock_map_fd);
    -EXPORT_SYMBOL(sock_recvmsg);
    -EXPORT_SYMBOL(sock_register);
    -EXPORT_SYMBOL(sock_release);
    -EXPORT_SYMBOL(sock_sendmsg);
    -EXPORT_SYMBOL(sock_unregister);
    -EXPORT_SYMBOL(sock_wake_async);
    -EXPORT_SYMBOL(sockfd_lookup);
    -EXPORT_SYMBOL(kernel_sendmsg);
    -EXPORT_SYMBOL(kernel_recvmsg);
    -EXPORT_SYMBOL(kernel_bind);
    -EXPORT_SYMBOL(kernel_listen);
    -EXPORT_SYMBOL(kernel_accept);
    -EXPORT_SYMBOL(kernel_connect);
    -EXPORT_SYMBOL(kernel_getsockname);
    -EXPORT_SYMBOL(kernel_getpeername);
    -EXPORT_SYMBOL(kernel_getsockopt);
    -EXPORT_SYMBOL(kernel_setsockopt);
    -EXPORT_SYMBOL(kernel_sendpage);
    -EXPORT_SYMBOL(kernel_sock_ioctl);
     EXPORT_SYMBOL(kernel_sock_shutdown);
    +
    --
    1.7.0.4

commit 614f60fa9d73a9e8fdff3df83381907fea7c5649
Author: Scott McMillan <scott.a.mcmillan@intel.com>
Date:   Wed Jun 2 05:53:56 2010 -0700

    packet_mmap: expose hw packet timestamps to network packet capture utilities
    
    This patch adds a setting, PACKET_TIMESTAMP, to specify the packet
    timestamp source that is exported to capture utilities like tcpdump by
    packet_mmap.
    
    PACKET_TIMESTAMP accepts the same integer bit field as
    SO_TIMESTAMPING.  However, only the SOF_TIMESTAMPING_SYS_HARDWARE and
    SOF_TIMESTAMPING_RAW_HARDWARE values are currently recognized by
    PACKET_TIMESTAMP.  SOF_TIMESTAMPING_SYS_HARDWARE takes precedence over
    SOF_TIMESTAMPING_RAW_HARDWARE if both bits are set.
    
    If PACKET_TIMESTAMP is not set, a software timestamp generated inside
    the networking stack is used (the behavior before this setting was
    added).
    
    Signed-off-by: Scott McMillan <scott.a.mcmillan@intel.com>
    Signed-off-by: David S. Miller <davem@davemloft.net>

commit ca5d0674c37840366f04a7bbfbf78e7b5f3ce0a4
Author: Andreas Schwab <schwab@linux-m68k.org>
Date:   Tue May 18 08:15:21 2010 +0000

    powerpc: Fix string library functions
    
    The powerpc strncmp implementation does not correctly handle a zero
    length, despite the claim in 0119536cd314ef95553604208c25bc35581f7f0a
    (Add hand-coded assembly strcmp).
    
    Additionally, all the length arguments are size_t, not int, so use
    PPC_LCMPI and eq instead of cmpwi and le throughout.
    
    Signed-off-by: Andreas Schwab <schwab@linux-m68k.org>
    Acked-by: Paul Mackerras <paulus@samba.org>
    Signed-off-by: Benjamin Herrenschmidt <benh@kernel.crashing.org>

commit 52a9b2319628e2cbbff7abc4f1092f4597c75a4f
Author: Bruce Allan <bruce.w.allan@intel.com>
Date:   Mon May 10 15:00:10 2010 +0000

    e1000e: s/w initiated LSC MSI-X interrupts not generated; no transmit
    
    In MSI-X mode when an IMPI SoL session was active (i.e. the PHY reset was
    blocked), the LSC interrupt generated by s/w to start the watchdog which
    started the transmitter was not getting fired by the hardware because bit
    24 (the 'other' cause bit) also needed to be set.  Without an active SoL
    session, the PHY was reset which caused the h/w to fire the LSC interrupt.
    
    Signed-off-by: Bruce Allan <bruce.w.allan@intel.com>
    Signed-off-by: Jeff Kirsher <jeffrey.t.kirsher@intel.com>
    Signed-off-by: David S. Miller <davem@davemloft.net>

commit ed85b565b825566da34e55eee9ad150ed93fdda0
Author: Richard Cochran <richardcochran@gmail.com>
Date:   Wed Apr 7 22:41:28 2010 +0000

    packet: support for TX time stamps on RAW sockets
    
    Enable the SO_TIMESTAMPING socket infrastructure for raw packet sockets.
    We introduce PACKET_TX_TIMESTAMP for the control message cmsg_type.
    
    Similar support for UDP and CAN sockets was added in commit
    51f31cabe3ce5345b51e4a4f82138b38c4d5dc91
    
    Signed-off-by: Richard Cochran <richard.cochran@omicron.at>
    Signed-off-by: David S. Miller <davem@davemloft.net>

commit 0cf0f23c286459625eb5cbf9934135ff3156ce95
Author: Kashyap, Desai <kashyap.desai@lsi.com>
Date:   Thu Mar 18 19:24:57 2010 +0530

    [SCSI] mptfusion: Proper error handling is added after mpt_config timeout
    
    Added proper error handling after mpt_config.
    Now check of MPI_IOCSTATUS_CONFIG_INVALID_PAGE is added.
    If error is MPI_IOCSTATUS_CONFIG_INVALID_PAGE, driver will return -ENODEV.
    
    Signed-off-by: Kashyap Desai <kashyap.desai@lsi.com>
    Signed-off-by: James Bottomley <James.Bottomley@suse.de>

commit f891dcfdc11d2004253861f51d627bfda6773c76
Author: Kashyap, Desai <kashyap.desai@lsi.com>
Date:   Wed Mar 17 16:22:21 2010 +0530

    [SCSI] mpt2sas: Corrected conditional checks for Internal device Reset
    
    bug fix in the handling of the internal device reset event
    The reason code check in scsih_sas_device_status_change_event never
    evaluates as true for internal device reset, hence driver never quiesce s IO
    when firmware is sending a device reset. The fix is to change the
    evaluate to:
    if (event_data->ReasonCode !=
        MPI2_EVENT_SAS_DEV_STAT_RC_INTERNAL_DEVICE_RESET &&
       event_data->ReasonCode !=
        MPI2_EVENT_SAS_DEV_STAT_RC_CMP_INTERNAL_DEV_RESET)
            return;
    
    Signed-off-by: Kashyap Desai <kashyap.desai@lsi.com>
    Signed-off-by: James Bottomley <James.Bottomley@suse.de>

commit e998f245c4b2d36ae2c35446e54ccbf1fb29d9de
Author: Steve Wise <swise@opengridcomputing.com>
Date:   Wed Jan 27 17:03:34 2010 +0000

    RDMA/cxgb3: Doorbell overflow avoidance and recovery
    
    T3 hardware doorbell FIFO overflows can cause application stalls due
    to lost doorbell ring events.  This has been seen when running large
    NP IMB alltoall MPI jobs.  The T3 hardware supports an xon/xoff-type
    flow control mechanism to help avoid overflowing the HW doorbell FIFO.
    
    This patch uses these interrupts to disable RDMA QP doorbell rings
    when we near an overflow condition, and then turn them back on (and
    ring all the active QP doorbells) when when the doorbell FIFO empties
    out.  In addition if an doorbell ring is dropped by the hardware, the
    code will now recover.
    
    Design:
    
    cxgb3:
    - enable these DB interrupts
    - in the interrupt handler, schedule work tasks to call the ULPs event
      handlers with the new events.
    - ring all the qset txqs when an overflow is detected.
    
    iw_cxgb3:
    - disable db ringing on all active qps when we get the DB_FULL event
    - enable db ringing on all active qps and ring all active dbs when we get
      the DB_EMPTY event
    - On DB_DROP event:
           - disable db rings in the event handler
           - delay-schedule a work task which rings and enables the dbs on
             all active qps.
    - in post_send and post_recv logic, don't ring the db if it's disabled.
    
    Signed-off-by: Steve Wise <swise@opengridcomputing.com>
    Signed-off-by: Roland Dreier <rolandd@cisco.com>

commit 6e10d2e407542605b2bdca43dc88c35fa8bd24b2
Author: Faisal Latif <faisal.latif@intel.com>
Date:   Fri Feb 12 19:55:03 2010 +0000

    RDMA/nes: Use atomic counters for CM listener create and destroy
    
    After running long iterative MPI tests, sometimes ethtool reports a
    "CM Destroy Listener" count more than the "CM Create Listener" count.
    This inconsistency is fixed by making counter variables atomic.
    
    Signed-off-by: Faisal Latif <faisal.latif@intel.com>
    Signed-off-by: Roland Dreier <rolandd@cisco.com>

commit fa644298eb24ab05b32acf6cc0f2265b833280e1
Author: Anton Vorontsov <avorontsov@ru.mvista.com>
Date:   Tue Dec 15 12:58:09 2009 +0000

    powerpc/85xx: Fix oops during MSI driver probe on MPC85xxMDS boards
    
    MPC85xx chips report the wrong value in feature reporting register,
    and that causes the following oops:
    
     Unable to handle kernel paging request for data at address 0x00000c00
     Faulting instruction address: 0xc0019294
     Oops: Kernel access of bad area, sig: 11 [#1]
     MPC8569 MDS
     Modules linked in:
     [...]
     NIP [c0019294] mpic_set_irq_type+0x2f0/0x368
     LR [c0019124] mpic_set_irq_type+0x180/0x368
     Call Trace:
     [ef851d60] [c0019124] mpic_set_irq_type+0x180/0x368 (unreliable)
     [ef851d90] [c007958c] __irq_set_trigger+0x44/0xd4
     [ef851db0] [c007b550] set_irq_type+0x40/0x7c
     [ef851dc0] [c0004a60] irq_create_of_mapping+0xb4/0x114
     [ef851df0] [c0004af0] irq_of_parse_and_map+0x30/0x40
     [ef851e20] [c0405678] fsl_of_msi_probe+0x1a0/0x328
     [ef851e60] [c02e6438] of_platform_device_probe+0x5c/0x84
     [...]
    
    This is because mpic_alloc() assigns wrong values to
    mpic->isu_{size,shift,mask}, and things eventually break when
    _mpic_irq_read() is trying to use them.
    
    This patch fixes the issue by enabling MPIC_BROKEN_FRR_NIRQS quirk.
    
    Signed-off-by: Anton Vorontsov <avorontsov@ru.mvista.com>
    Signed-off-by: Kumar Gala <galak@kernel.crashing.org>

commit 8523c0480979080e8088e40f25459e5b2d19f621
Author: Sean Hefty <sean.hefty@intel.com>
Date:   Mon Feb 8 16:41:15 2010 -0800

    RDMA/cm: Revert association of an RDMA device when binding to loopback
    
    Revert the following change from commit 6f8372b6 ("RDMA/cm: fix
    loopback address support")
    
       The defined behavior of rdma_bind_addr is to associate an RDMA
       device with an rdma_cm_id, as long as the user specified a non-
       zero address.  (ie they weren't just trying to reserve a port)
       Currently, if the loopback address is passed to rdma_bind_addr,
       no device is associated with the rdma_cm_id.  Fix this.
    
    It turns out that important apps such as Open MPI depend on
    rdma_bind_addr() NOT associating any RDMA device when binding to a
    loopback address.  Open MPI is being updated to deal with this, but at
    least until a new Open MPI release is available, maintain the previous
    behavior: allow rdma_bind_addr() to succeed, but do not bind to a
    device.
    
    Signed-off-by: Sean Hefty <sean.hefty@intel.com>
    Acked-by: Steve Wise <swise@opengridcomputing.com>
    Signed-off-by: Roland Dreier <rolandd@cisco.com>

commit 84f0b04a0e3b279a0b0a851b93eb403a626ca4b8
Author: Kashyap, Desai <kashyap.desai@lsi.com>
Date:   Wed Dec 16 18:56:28 2009 +0530

    [SCSI] mpt2sas: Enable TLR for SSP TAPE drives (Added SAS Transport APIs)
    
    If TLR is supported for end device, MPT2SAS driver will enable the TLR
    bit in the SCSI_IO for every request. If there is a response with
    MPI2_SCSITASKMGMT_RSP_INVALID_FRAME, the driver will turn off the TLR
    logic.
    
    [jejb: updated to new transport class TLR API]
    Signed-off-by: Kashyap Desai <kashyap.desai@lsi.com>
    Reviewed-by: Eric Moore <Eric.moore@lsi.com>
    Signed-off-by: James Bottomley <James.Bottomley@suse.de>

commit f4af3c14113d1b0d98d5a5e717b8aa1f484065b6
Author: Kashyap, Desai <kashyap.desai@lsi.com>
Date:   Wed Dec 16 18:55:54 2009 +0530

    [SCSI] mpt2sas: Update driver header to latest MPI Spec.
    
    Update header to latest MPI SPEC revision.
    
    Signed-off-by: Kashyap Desai <kashyap.desai@lsi.com>
    Reviewed-by: Eric Moore <eric.moore@lsi.com>
    Signed-off-by: James Bottomley <James.Bottomley@suse.de>

commit 52e13e219d5930fb8fb774050e6ecffa244a60a9
Author: Hui Zhu <hui.zhu@windriver.com>
Date:   Tue Jan 26 17:13:07 2010 +0800

    markup_oops.pl: add options to improve cross-sompilation environments
    
    The markup_oops.pl have 3 troubles to support cross-compiler environment:
    1.  It use objdump directly.
    2.  It use modinfo to get the message of module.
    3.  It use hex function that cannot support 64-bit number in 32-bit arch.
    
    This patch add 3 options to markup_oops.pl:
    1. -c CROSS_COMPILE     Specify the prefix used for toolchain.
    2. -m MODULE_DIRNAME    Specify the module directory name.
    3. Change hex function to Math::BigInt->from_hex.
    
    After this patch, parse the x8664 oops in x86, we can:
    cat amd64m | perl ~/kernel/tmp/m.pl -c /home/teawater/kernel/bin/x8664- -m ./e.ko vmlinux
    
    Thanks,
    Hui
    
    Signed-off-by: Hui Zhu <teawater@gmail.com>
    Cc: Andrew Morton <akpm@linux-foundation.org>
    Cc: Arjan van de Ven <arjan@linux.intel.com>
    Cc: Sam Ravnborg <sam@ravnborg.org>
    Cc: ozan@pardus.org.tr
    Cc: Matthew Wilcox <willy@linux.intel.com>
    Acked-by: WANG Cong <xiyou.wangcong@gmail.com>
    Signed-off-by: Michal Marek <mmarek@suse.cz>

commit 5358db0b0e16470337c6ec08177deb3f68ed7673
Author: Rabin Vincent <rabin@rab.in>
Date:   Tue Jan 5 20:27:58 2010 +0530

    scripts: add ARM support to decodecode
    
    This patch adds support for decoding ARM oopses to scripts/decodecode.
    The following things are handled:
    
     - ARCH and CROSS_COMPILE environment variables are respected.
    
     - The Code: in x86 oopses is in bytes, while it is in either words (4
       bytes) or halfwords for ARM.
    
     - Some versions of ARM objdump refuse to disassemble instructions
       generated by literal constants (".word 0x...").  The workaround is to
       strip the object file first.
    
     - The faulting instruction is marked (liked so) in ARM, but <like so>
       in x86.
    
     - ARM mnemonics may include characters such as [] which need to be
       escaped before being passed to sed for the "<- trapping instruction"
       substitution.
    
    Signed-off-by: Rabin Vincent <rabin@rab.in>
    Signed-off-by: Michal Marek <mmarek@suse.cz>

commit 84336466011c589b6af554f2f2f1fcfa1a5c1437
Author: Roland McGrath <roland@redhat.com>
Date:   Mon Dec 21 16:24:06 2009 -0800

    kconfig CROSS_COMPILE option
    
    This adds CROSS_COMPILE as a kconfig string so you can store it in
    .config.  Then you can use plain "make" in the configured kernel build
    directory to do the right cross compilation without setting the
    command-line or environment variable every time.
    
    With this, you can set up different build directories for different kernel
    configurations, whether native or cross-builds, and then use the simple:
    
            make -C /build/dir M=module-source-dir
    
    idiom to build modules for any given target kernel, indicating which one
    by nothing but the build directory chosen.
    
    I tried a version that defaults the string with env="CROSS_COMPILE" so
    that in a "make oldconfig" with CROSS_COMPILE in the environment you can
    just hit return to store the way you're building it.  But the kconfig
    prompt for strings doesn't give you any way to say you want an empty
    string instead of the default, so I punted that.
    
    Signed-off-by: Roland McGrath <roland@redhat.com>
    Cc: Sam Ravnborg <sam@ravnborg.org>
    Cc: Anibal Monsalve Salazar <anibal@debian.org>
    Cc: Steven Rostedt <rostedt@goodmis.org>
    Cc: Michal Marek <mmarek@suse.cz>
    Signed-off-by: Andrew Morton <akpm@linux-foundation.org>
    Signed-off-by: Michal Marek <mmarek@suse.cz>

commit 002464c610da98684edbde2aaf8d728c098f3486
Author: Kashyap, Desai <kashyap.desai@lsi.com>
Date:   Wed Sep 23 17:24:27 2009 +0530

    mpt2sas: New device SAS2208 support is added
    
    commit db27136a89d061bf9dceb28953a61a8ef862ca7f upstream.
    
    Added device ids range for { 0x80 - 87 } , modified mpi/mpi2_cnfg.h containing
    MPI2_MFGPAGE_DEVID_SAS2208_X.
    
    Signed-off-by: Kashyap Desai <kashyap.desai@lsi.com>
    Signed-off-by: Eric Moore <Eric.moore@lsi.com>
    Signed-off-by: James Bottomley <James.Bottomley@suse.de>
    Cc: Ben Hutchings <ben@decadent.org.uk>
    Signed-off-by: Greg Kroah-Hartman <gregkh@suse.de>

commit de81562f2f9852a1f2c609ede1e26c07ed457c60
Author: Kashyap, Desai <kashyap.desai@lsi.com>
Date:   Wed Dec 16 19:02:59 2009 +0530

    [SCSI] mptfusion: corrected if condition check for SCSIIO and PASSTHROUGH commands
    
    Modified the function type check to verify it is not
    MPI_FUNCTION_RAID_SCSI_IO_PASSTHROUGH or MPI_FUNCTION_SCSI_IO_REQUEST.
    
    Signed-off-by: Kashyap Desai <kashyap.desai@lsi.com>
    Signed-off-by: James Bottomley <James.Bottomley@suse.de>

commit 65f89c2396aa113a06fe7e2f6ba46f0712cb4806
Author: Kashyap, Desai <kashyap.desai@lsi.com>
Date:   Wed Dec 16 19:01:13 2009 +0530

    [SCSI] mptfusion: Added MPI_SCSIIO_CONTROL_HEADOFQ priority
    
    There is a 'ioprio' field in the BIO and the Request structure.
    check this priority field and set MPI_SCSIIO_CONTROL_HEADOFQ
    to pass down I/O priority.
    An enhancement to the LSI Disk Array Controller firmware is being
    developed to look at the Head Of Queue bit to allow I/Os with the HOQ bit
    set to be processed before I/Os which do not have the HOQ bit set.
    In order to set the HOQ bit, the mpt fusion driver  needs to look at the
    'ioprio' field in the request structure associated with the scsi command.
    
    Signed-off-by: Kashyap Desai <kashyap.desai@lsi.com>
    Signed-off-by: James Bottomley <James.Bottomley@suse.de>

commit 3f884bf54dde417e963a0e6effb8f2c01f95abee
Author: Peter Tyser <ptyser@xes-inc.com>
Date:   Wed Dec 30 15:23:26 2009 -0700

    powerpc: Use scripts/mkuboot.sh instead of 'mkimage'
    
    mkuboot.sh provides a basic wrapper for the 'mkimage' utility.  Using
    mkuboot.sh provides clearer error reporting and allows a toolchain to
    use its own 'mkimage' executable specified by ${CROSS_COMPILE}mkimage.
    Additionally, this brings PowerPC in line with other architectures
    which already call mkimage via mkuboot.sh.
    
    Signed-off-by: Peter Tyser <ptyser@xes-inc.com>
    Signed-off-by: Grant Likely <grant.likely@secretlab.ca>

commit cc835752ae3634acd2d487fdf5152f6075f45aef
Author: Jamie Iles <jamie.iles@picochip.com>
Date:   Fri Dec 11 09:21:00 2009 +0000

    perf tools: Allow cross compiling
    
    For embedded platforms, we want to be able to build the perf
    tools on a build machine to run on a different arch. This patch
    allows $CROSS_COMPILE to set the cross compiler.
    
    Additionally, if NO_LIBPERL is set, then don't use perl include
    paths as they will be for the host arch.
    
    Signed-off-by: Jamie Iles <jamie.iles@picochip.com>
    Cc: Peter Zijlstra <peterz@infradead.org>
    LKML-Reference: <1260523260-15694-2-git-send-email-jamie.iles@picochip.com>
    Signed-off-by: Ingo Molnar <mingo@elte.hu>

commit 29c5397fc1d28f9b75057644ce8e546671d2a9a9
Author: Lalit Chandivade <lalit.chandivade@qlogic.com>
Date:   Tue Oct 13 15:16:47 2009 -0700

    [SCSI] qla2xxx: Reread firmware versions information after an ISP abort.
    
    In some case, the MPI and PHY versions when retrieved after the
    Execute-FW mailbox-command are incorrect (255.255.255.255).
    Instead, query the information after the check for firmware ready
    is done in the abort ISP path.
    
    Signed-off-by: Lalit Chandivade <lalit.chandivade@qlogic.com>
    Signed-off-by: Andrew Vasquez <andrew.vasquez@qlogic.com>
    Signed-off-by: Giridhar Malavali <giridhar.malavali@qlogic.com>
    Signed-off-by: James Bottomley <James.Bottomley@suse.de>

commit a7ca1f00ed2921b804d7ebda0f6fca8c9078fa42
Author: Sean Hefty <sean.hefty@intel.com>
Date:   Mon Nov 16 09:30:33 2009 -0800

    RDMA/ucma: Add option to manually set IB path
    
    Export rdma_set_ib_paths to user space to allow applications to
    manually set the IB path used for connections.  This allows
    alternative ways for a user space application or library to obtain
    path record information, including retrieving path information
    from cached data, avoiding direct interaction with the IB SA.
    The IB SA is a single, centralized entity that can limit scaling
    on large clusters running MPI applications.
    
    Future changes to the rdma cm can expand on this framework to
    support the full range of features allowed by the IB CM, such as
    separate forward and reverse paths and APM.
    
    Signed-off-by: Sean Hefty <sean.hefty@intel.com>
    Reviewed-By: Jason Gunthorpe <jgunthorpe@obsidianresearch.com>
    Signed-off-by: Roland Dreier <rolandd@cisco.com>

commit dc2e673dbcbaebdf84c09956b85c3be3a8b7bd02
Author: Poonam Aggrwal <poonam.aggrwal@freescale.com>
Date:   Sat Sep 19 22:43:56 2009 +0530

    powerpc/85xx: Create dts for each core in CAMP mode for P2020RDB
    
    This patch creates the dts files for each core and splits the devices
    between the two cores for P2020RDB.
    
    core0 has memory, L2, i2c, spi, dma1, usb, eth0, eth1, crypto,
                    global-util, pci0,
    core1 has L2, dma2, eth0, pci1, msi.
    
    MPIC is shared between two cores but each core will protect its
    interrupts from other core by using "protected-sources" of mpic.
    
    Signed-off-by: Poonam Aggrwal <poonam.aggrwal@freescale.com>
    Signed-off-by: Kumar Gala <galak@kernel.crashing.org>

commit e7d59c17a70e59a052d29467bbefb23ce700dcd4
Author: Kashyap, Desai <kashyap.desai@lsi.com>
Date:   Wed Sep 23 17:36:52 2009 +0530

    [SCSI] mpt2sas: No link rate change, do not call update links nor unblock device
    
    (1) target resets are sending link change rate events with no link rate
    change -> thus said the driver was modified so when there is no link rate
    change, we don't need to call mpt2sas_transport_update_links nor
    _scsih_ublock_io_device.
    (2) There were changes made in _scsih_sas_topology_change_event_debug to
    change the debug strings so they are more clear.  Also the link rate change
    information was added to display the new and previous link rate.
    for the MPI2_EVENT_SAS_TOPOLOGY_CHANGE_LIST event when the ExpStatus is
    set to zero, display "responding" instead of "unknown status".
    
    Signed-off-by: Kashyap Desai <kashyap.desai@lsi.com>
    Signed-off-by: Eric Moore <Eric.moore@lsi.com>
    Signed-off-by: James Bottomley <James.Bottomley@suse.de>

commit 744090d38b47ed8ead8f68b6f0c65866c0b9b17a
Author: Kashyap, Desai <kashyap.desai@lsi.com>
Date:   Mon Oct 5 15:56:56 2009 +0530

    [SCSI] mpt2sas : Add support for RAID Action System Shutdown Initiated at OS shutdown
    
    (1) Added new function _scsih_ir_shutdown.  This function will issue the
    MPI2_RAID_ACTION_SYSTEM_SHUTDOWN_INITIATED request via
    MPI2_FUNCTION_RAID_ACTION. The function will wait 10 seconds for reply
    message frame, then print out the ioc status and loginfo.  This function is
    only called when there are raid volumes present.
    
    (2) Add shutdown callback in the struct pci_driver object scsih_driver. This
    will be called only when the system is shutting down. From this function, we
    will call _scsih_ir_shutdown mentioned above.
    
    (3) Add support in _scsih_remove to call _scsih_ir_shutdown. The function
    _scsih_remove will be called when the driver is unloaded (and system is
    still running).
    
    scsih internal command contex is added to send internal message frames
    from mpt2sas_scsih.c.
    
    Signed-off-by: Kashyap Desai <kashyap.desai@lsi.com>
    Signed-off-by: Eric Moore <Eric.moore@lsi.com>
    Signed-off-by: James Bottomley <James.Bottomley@suse.de>

commit 8ffc457ed6fe33728657a0cfb7509b90d554c21f
Author: Kashyap, Desai <kashyap.desai@lsi.com>
Date:   Wed Sep 23 17:35:41 2009 +0530

    [SCSI] mpt2sas: Freeze the sdev IO queue when firmware sends internal dev reset
    
    When receiving the MPI2_EVENT_SAS_DEV_STAT_RC_INTERNAL_DEVICE_RESET event,
    the driver will set the tm_busy flag in the sdev private host data, When
    tm_busy flag is set, the driver will return SCSI_MLQUEUE_DEVICE_BUSY,
    effectly freezing the IO to the device. The tm_busy flag is cleared with the
    MPI2_EVENT_SAS_DEV_STAT_RC_CMP_INTERNAL_DEV_RESET event.
    
    Signed-off-by: Kashyap Desai <kashyap.desai@lsi.com>
    Signed-off-by: Eric Moore <Eric.moore@lsi.com>
    Signed-off-by: James Bottomley <James.Bottomley@suse.de>

commit e4e7c7ed3485bc530499158e28539e00d47f9ef2
Author: Kashyap, Desai <kashyap.desai@lsi.com>
Date:   Wed Sep 23 17:33:14 2009 +0530

    [SCSI] mpt2sas: Return DID_TRANSPORT_DISRUPTED in nexus loss,SCSI_MLQUEUE_DEVICE_BUSY if device is busy
    
    1 Its observed that the OS was sending request to the driver after it had been
    put into blocking state, so the driver was modified to return
    SCSI_MLQUEUE_DEVICE_BUSY.
    2. Driver will return DID_TRANSPORT_DISRUPTED when sdev is haivng nexus loss.
    This occurrs when sdev is blocked, between the
    MPI2_EVENT_SAS_TOPO_RC_DELAY_NOT_RESPONDING and
    MPI2_EVENT_SAS_TOPO_RC_TARG_NOT_RESPONDING events.
    
    Signed-off-by: Kashyap Desai <kashyap.desai@lsi.com>
    Signed-off-by: Eric Moore <Eric.moore@lsi.com>
    Signed-off-by: James Bottomley <James.Bottomley@suse.de>

commit ec6c2b43b08f29e08ed5440abae1ec18d80fa8b7
Author: Kashyap, Desai <kashyap.desai@lsi.com>
Date:   Wed Sep 23 17:31:01 2009 +0530

    [SCSI] mpt2sas: Added new info messages for IR and Expander events.
    
    (1) for the MPI2_EVENT_IR_OPERATION_STATUS event, add support to print
    "background init" or "make data consistent" for debugging purposes.  If the
    RAIDOperation is set to a value not defined, then don't print anything
    
    (2) for the MPI2_EVENT_SAS_DEVICE_STATUS_CHANGE event, add support to print
    "expander reduced functionality" and "expander reduced functionality
    complete", which are new events.
    
    Signed-off-by: Kashyap Desai <kashyap.desai@lsi.com>
    Signed-off-by: Eric Moore <Eric.moore@lsi.com>
    Signed-off-by: James Bottomley <James.Bottomley@suse.de>

commit 9fec5f9fc2fbe7c6e39db01ae296528d9a20a5b1
Author: Kashyap, Desai <kashyap.desai@lsi.com>
Date:   Wed Sep 23 17:26:20 2009 +0530

    [SCSI] mpt2sas: Adding MPI Headers - revision L
    
    The new headers contain the following changes:
    (1) Added IO Unit Page 7.
    (2) Added new device ids for SAS2208.
    (3) Added SAS IO Unit Page 5.
    (4) Added partial and slumber power management capable flags to SAS Device
        Page 0 Flags field.
    (5) Added PhyInfo defines for power condition.
    (6) Added Ethernet configuration pages.
    
    Signed-off-by: Kashyap Desai <kashyap.desai@lsi.com>
    Signed-off-by: Eric Moore <Eric.moore@lsi.com>
    Signed-off-by: James Bottomley <James.Bottomley@suse.de>

commit db27136a89d061bf9dceb28953a61a8ef862ca7f
Author: Kashyap, Desai <kashyap.desai@lsi.com>
Date:   Wed Sep 23 17:24:27 2009 +0530

    [SCSI] mpt2sas: New device SAS2208 support is added
    
    Added device ids range for { 0x80 - 87 } , modified mpi/mpi2_cnfg.h containing
    MPI2_MFGPAGE_DEVID_SAS2208_X.
    
    Signed-off-by: Kashyap Desai <kashyap.desai@lsi.com>
    Signed-off-by: Eric Moore <Eric.moore@lsi.com>
    Signed-off-by: James Bottomley <James.Bottomley@suse.de>

commit 9982f59450930138eb0bf9a4ebf865e8c06ba705
Author: Kashyap, Desai <kashyap.desai@lsi.com>
Date:   Wed Sep 23 17:23:07 2009 +0530

    [SCSI] mpt2sas: Add support in the driver to check for valid response info
    
    Add support in the driver to check for valid response info in the scsi
    state, then check to see if the response code is
    MPI2_SCSITASKMGMT_RSP_INVALID_FRAME; when this condition occurrs, the driver
    will return DID_SOFT_ERROR.  A return code of DID_SOFT_ERROR will result in
    a retry at the scsi-mid layer level.  An additional change added to obtain
    the response code from the 1st byte of the response info instead of last.
    
    Signed-off-by: Kashyap Desai <kashyap.desai@lsi.com>
    Signed-off-by: Eric Moore <Eric.moore@lsi.com>
    Signed-off-by: James Bottomley <James.Bottomley@suse.de>

commit 25d591587d3b0676fb89c29e7e55fe4a08597ec1
Merge: 86ae13b006e4 2331d1a6cd3d
Author: Linus Torvalds <torvalds@linux-foundation.org>
Date:   Tue Oct 13 10:20:53 2009 -0700

    Merge git://git.kernel.org/pub/scm/linux/kernel/git/sam/kbuild-fixes
    
    * git://git.kernel.org/pub/scm/linux/kernel/git/sam/kbuild-fixes:
      kbuild: revert "save ARCH & CROSS_COMPILE ..."
      warn about use of uninstalled kernel headers
      kbuild: mkcompile_h: trivial cleanups
      kbuild: fix warning when domainname is not available
      kbuild: Fix size_append issue for bzip2/lzma kernel
      kbuild,scripts: use non-builtin echo for '-e'
      kbuild: fix the binrpm-pkg target to work with KBUILD_OUTPUT set

commit 2331d1a6cd3d6e580bc88b9a160066d9e1177fe1
Author: Sam Ravnborg <sam@ravnborg.org>
Date:   Sun Oct 11 23:22:58 2009 +0200

    kbuild: revert "save ARCH & CROSS_COMPILE ..."
    
    Revert commit 575543347b5baed0ca927cb90ba8807396fe9cc9
    
    It caused following issues:
    
    - On architectures where ARCH= setting is used to select between
      32 and 64 bit this was no longer possible without "make mrproper"
    - If ARCH was changed then kbuild refused to run "make mrproper"
      because ARCH had changed
    - When CROSS_COMPILE was changed people were asked to run "make mrproper"
      but kbuild refused to run "make mrproper" because CROSS_COMPILE changed.
    - Spaces in CROSS_COMPILE was not 'supported'
    - If an non-existing ARCH= was used kbuild could get stuck
    
    Lessons learned:
    . Despite being simple and straghtforward people uses very different
      approaches when building the kernel.
    
    . CROSS_COMPILE is sometimes used for ccache despite cache being
      only a CC frontend so one would have expected CC to be
      used for this purpose.
    
    . And obviously this was not tested widely enough.
    
    Signed-off-by: Sam Ravnborg <sam@ravnborg.org>
    Cc: Pavel Machek <pavel@ucw.cz>
    Cc: Ingo Molnar <mingo@elte.hu>
    Cc: Peter Zijlstra <peterz@infradead.org>
    Cc: Andrew Morton <akpm@linux-foundation.org>

commit 69585dd69e663a40729492c7b52eb82477a2027a
Merge: bd381934bf13 c7922a911c42
Author: Linus Torvalds <torvalds@linux-foundation.org>
Date:   Sun Oct 11 11:12:33 2009 -0700

    Merge git://git.kernel.org/pub/scm/linux/kernel/git/jejb/scsi-rc-fixes-2.6
    
    * git://git.kernel.org/pub/scm/linux/kernel/git/jejb/scsi-rc-fixes-2.6: (34 commits)
      [SCSI] qla2xxx: Fix NULL ptr deref bug in fail path during queue create
      [SCSI] st: fix possible memory use after free after MTSETBLK ioctl
      [SCSI] be2iscsi: Moving to pci_pools v3
      [SCSI] libiscsi: iscsi_session_setup to allow for private space
      [SCSI] be2iscsi: add 10Gbps iSCSI - BladeEngine 2 driver
      [SCSI] zfcp: Fix hang when offlining device with offline chpid
      [SCSI] zfcp: Fix lockdep warning when offlining device with offline chpid
      [SCSI] zfcp: Fix oops during shutdown of offline device
      [SCSI] zfcp: Fix initial device and cfdc for delayed adapter allocation
      [SCSI] zfcp: correctly initialize unchained requests
      [SCSI] mpt2sas: Bump version 02.100.03.00
      [SCSI] mpt2sas: Support dev remove when phy status is MPI2_EVENT_SAS_TOPO_PHYSTATUS_VACANT
      [SCSI] mpt2sas: Timeout occurred within the HANDSHAKE logic while waiting on firmware to ACK.
      [SCSI] mpt2sas: Call init_completion on a per request basis.
      [SCSI] mpt2sas: Target Reset will be issued from Interrupt context.
      [SCSI] mpt2sas: Added SCSIIO, Internal and high priority memory pools to support multiple TM
      [SCSI] mpt2sas: Copyright change to 2009.
      [SCSI] mpt2sas: Added mpi2_history.txt for MPI2 headers.
      [SCSI] mpt2sas: Update driver to MPI2 REV K headers.
      [SCSI] bfa: Brocade BFA FC SCSI driver
      ...

commit 308609c63c6d6144c1210c9583c68bc532acb8d2
Author: Kashyap, Desai <kashyap.desai@lsi.com>
Date:   Mon Sep 14 11:07:23 2009 +0530

    [SCSI] mpt2sas: Support dev remove when phy status is MPI2_EVENT_SAS_TOPO_PHYSTATUS_VACANT
    
    Add support to process device removal events when the phy status is set to
    MPI2_EVENT_SAS_TOPO_PHYSTATUS_VACANT.
    
    Signed-off-by: Kashyap Desai <kashyap.desai@lsi.com>
    Signed-off-by: James Bottomley <James.Bottomley@suse.de>

commit 57442b16e52403d64f83840bd7694ea59e8469af
Author: Kashyap, Desai <kashyap.desai@lsi.com>
Date:   Mon Sep 14 11:00:43 2009 +0530

    [SCSI] mpt2sas: Added mpi2_history.txt for MPI2 headers.
    
    Added new file for MPI2 header version history.
    
    Signed-off-by: Kashyap Desai <kashyap.desai@lsi.com>
    Signed-off-by: James Bottomley <James.Bottomley@suse.de>

commit 7b936b02293b2891d899233d3f4bb45295e8c1f9
Author: Kashyap, Desai <kashyap.desai@lsi.com>
Date:   Fri Sep 25 11:44:41 2009 +0530

    [SCSI] mpt2sas: Update driver to MPI2 REV K headers.
    
    Drivers header are updated to the MPI2 REV K headers.
    Renamed VF_ID to msix_index in all call back handlers.
    VF_ID is removed from all request descriptor.
    
    Signed-off-by: Kashyap Desai <kashyap.desai@lsi.com>
    Signed-off-by: James Bottomley <James.Bottomley@suse.de>

commit 575543347b5baed0ca927cb90ba8807396fe9cc9
Author: Sam Ravnborg <sam@ravnborg.org>
Date:   Sun Sep 20 12:24:55 2009 +0200

    kbuild: save ARCH & CROSS_COMPILE when building a kernel
    
    When building a kernel for a different architecture
    kbuild requires the user always to specify ARCH and
    CROSS_COMPILE on the command-line.
    
    We use the asm symlink to detect if user forgets to
    specify the correct ARCH value - but that symlink
    is about to die. And we do now want to loose this check.
    
    This patch save the settings of ARCH and CROSS_COMPILE
    in two files named:
    
        include/generated/kernel.arch
        include/generated/kernel.cross
    
    The settings are saved during "make *config" time
    and always read.
    
    If user try to change the settings we error out.
    
    This works both for plain builds and for O=...
    builds.
    
    So now you can do:
    $ mkdir sparc64
    $ make O=sparc64 ARCH=sparc64 CROSS_COMPILE=sparc64-linux- defconfig
    $ cd sparc64
    $ make
    
    Notice that you no longer need to tell kbuild
    the settings of ARCH and CROSS_COMPILE when you type make
    in the output directory.
    
    Likewise for plain builds where you do not use O=...
    
    Signed-off-by: Sam Ravnborg <sam@ravnborg.org>
    Cc: Roland McGrath <roland@redhat.com>

commit caa27b66bd7188fd063769eaf4b33533ef0709e6
Author: Sam Ravnborg <sam@ravnborg.org>
Date:   Mon Jul 20 21:37:11 2009 +0200

    kbuild: use INSTALLKERNEL to select customized installkernel script
    
    Replace the use of CROSS_COMPILE to select a customized
    installkernel script with the possibility to set INSTALLKERNEL
    to select a custom installkernel script when running make:
    
        make INSTALLKERNEL=arm-installkernel install
    
    With this patch we are now more consistent across
    different architectures - they did not all support use
    of CROSS_COMPILE.
    
    The use of CROSS_COMPILE was a hack as this really belongs
    to gcc/binutils and the installkernel script does not change
    just because we change toolchain.
    
    The use of CROSS_COMPILE caused troubles with an upcoming patch
    that saves CROSS_COMPILE when a kernel is built - it would no
    longer be installable.
    [Thanks to Peter Z. for this hint]
    
    This patch undos what Ian did in commit:
    
      0f8e2d62fa04441cd12c08ce521e84e5bd3f8a46
      ("use ${CROSS_COMPILE}installkernel in arch/*/boot/install.sh")
    
    The patch has been lightly tested on x86 only - but all changes
    looks obvious.
    
    Acked-by: Peter Zijlstra <peterz@infradead.org>
    Acked-by: Mike Frysinger <vapier@gentoo.org> [blackfin]
    Acked-by: Russell King <linux@arm.linux.org.uk> [arm]
    Acked-by: Paul Mundt <lethal@linux-sh.org> [sh]
    Acked-by: "H. Peter Anvin" <hpa@zytor.com> [x86]
    Cc: Ian Campbell <icampbell@arcom.com>
    Cc: Tony Luck <tony.luck@intel.com> [ia64]
    Cc: Fenghua Yu <fenghua.yu@intel.com> [ia64]
    Cc: Hirokazu Takata <takata@linux-m32r.org> [m32r]
    Cc: Geert Uytterhoeven <geert@linux-m68k.org> [m68k]
    Cc: Kyle McMartin <kyle@mcmartin.ca> [parisc]
    Cc: Benjamin Herrenschmidt <benh@kernel.crashing.org> [powerpc]
    Cc: Martin Schwidefsky <schwidefsky@de.ibm.com> [s390]
    Cc: Thomas Gleixner <tglx@linutronix.de> [x86]
    Cc: Ingo Molnar <mingo@redhat.com> [x86]
    Signed-off-by: Sam Ravnborg <sam@ravnborg.org>

commit 534cc9c165017dd29ae0f4458832893dc8033c6f
Author: Anil Veerabhadrappa <anilgv@broadcom.com>
Date:   Wed Jul 29 21:49:48 2009 -0700

    [SCSI] bnx2i : Fix command session number jump issue seen during cable pull test
    
    Without the fix bnx2i would fail tt->xmit_task() when link is down and
    libiscsi would have already incremented session->cmdsn before calling bnx2i's
    xmit_task() entry point and will just return the command to SCSI-ML when
    xmit_task() fails. libiscsi does not retract the session->cmdsn as the command
    was never sent on wire.  It is generally good idea for LLD, bnx2i to accept
    the scsi cmnd/nopout and let upper layer timeout and go though normal session
    recovery process.  When link is down, unsolicited nopout will not be accepted
    by bnx2i and connection will never enter recovery state. This fix is required
    for MPIO to work corectly
    
    Signed-off-by: Anil Veerabhadrappa <anilgv@broadcom.com>
    Signed-off-by: James Bottomley <James.Bottomley@HansenPartnership.com>
    Signed-off-by: James Bottomley <James.Bottomley@suse.de>

commit 11a6b292c1bc9cb39970e44edd6958250f23d3a8
Author: Michael Ellerman <michael@ellerman.id.au>
Date:   Sun Jul 5 16:08:52 2009 +0000

    powerpc/mpic: Fix MPIC_BROKEN_REGREAD on non broken MPICs
    
    The workaround enabled by CONFIG_MPIC_BROKEN_REGREAD does not work
    on non-broken MPICs. The symptom is no interrupts being received.
    
    The fix is twofold. Firstly the code was broken for multiple isus,
    we need to index into the shadow array with the src_no, not the idx.
    Secondly, we always do the read, but only use the VECPRI_MASK and
    VECPRI_ACTIVITY bits from the hardware, the rest of "val" comes
    from the shadow.
    
    Signed-off-by: Michael Ellerman <michael@ellerman.id.au>
    Signed-off-by: Olof Johansson <olof@lixom.net>
    Signed-off-by: Benjamin Herrenschmidt <benh@kernel.crashing.org>

commit 07610a8a67bc0893a1bcb9f98e9ef25e924d5e28
Author: Benjamin Herrenschmidt <benh@kernel.crashing.org>
Date:   Mon Jun 22 16:47:59 2009 +0000

    powerpc/mpic: Fix mapping of "DCR" based MPIC variants
    
    commit 5a2642f620eb6e40792822fa0eafe23046fbb55e upstream.
    
    Commit 31207dab7d2e63795eb15823947bd2f7025b08e2
    "Fix incorrect allocation of interrupt rev-map"
    introduced a regression crashing on boot on machines using
    a "DCR" based MPIC, such as the Cell blades.
    
    The reason is that the irq host data structure is initialized
    much later as a result of that patch, causing our calls to
    mpic_map() do be done before we have a host setup.
    
    Unfortunately, this breaks _mpic_map_dcr() which uses the
    mpic->irqhost to get to the device node.
    
    This fixes it by, instead, passing the device node explicitely
    to mpic_map().
    
    Signed-off-by: Benjamin Herrenschmidt <benh@kernel.crashing.org>
    Acked-by: Akira Tsukamoto <akirat@rd.scei.sony.co.jp>
    Signed-off-by: Greg Kroah-Hartman <gregkh@suse.de>

commit 402168cee1a0b791c54c54a68ae21bb26880f40b
Merge: 12e8ffe35eac a947a39d52f5
Author: Linus Torvalds <torvalds@linux-foundation.org>
Date:   Wed Jul 22 09:49:58 2009 -0700

    Merge git://git.kernel.org/pub/scm/linux/kernel/git/davem/net-2.6
    
    * git://git.kernel.org/pub/scm/linux/kernel/git/davem/net-2.6: (37 commits)
      sky2: Avoid races in sky2_down
      drivers/net/mlx4: Adjust constant
      drivers/net: Move a dereference below a NULL test
      drivers/net: Move a dereference below a NULL test
      connector: maintainer/mail update.
      USB host CDC Phonet network interface driver
      macsonic, jazzsonic: fix oops on module unload
      macsonic: move probe function to .devinit.text
      can: switch carrier on if device was stopped while in bus-off state
      can: restart device even if dev_alloc_skb() fails
      can: sja1000: remove duplicated includes
      New device ID for sc92031 [1088:2031]
      3c589_cs: re-initialize the multicast in the tc589_reset
      Fix error return for setsockopt(SO_TIMESTAMPING)
      netxen: fix thermal check and shutdown
      netxen: fix deadlock on dev close
      netxen: fix context deletion sequence
      net: Micrel KS8851 SPI network driver
      tcp: Use correct peer adr when copying MD5 keys
      tcp: Fix MD5 signature checking on IPv4 mapped sockets
      ...

commit f249fb783092471a4808e5fc5bda071d2724810d
Author: Rmi Denis-Courmont <remi.denis-courmont@nokia.com>
Date:   Mon Jul 20 00:47:04 2009 +0000

    Fix error return for setsockopt(SO_TIMESTAMPING)
    
    I guess it should be -EINVAL rather than EINVAL. I have not checked
    when the bug came in. Perhaps a candidate for -stable?
    
    Signed-off-by: Rmi Denis-Courmont <remi.denis-courmont@nokia.com>
    Signed-off-by: David S. Miller <davem@davemloft.net>

commit 919a6d10fdd9e256dfcd31937fb0b18d1c066be6
Merge: cf2acfb2051f fd0cca754f3f
Author: Linus Torvalds <torvalds@linux-foundation.org>
Date:   Fri Jun 26 09:39:02 2009 -0700

    Merge branch 'merge' of git://git.kernel.org/pub/scm/linux/kernel/git/benh/powerpc
    
    * 'merge' of git://git.kernel.org/pub/scm/linux/kernel/git/benh/powerpc: (29 commits)
      powerpc/rtas: Fix watchdog driver temperature read functionality
      powerpc/mm: Fix potential access to freed pages when using hugetlbfs
      powerpc/440: Fix warning early debug code
      powerpc/of: Fix usage of dev_set_name() in of_device_alloc()
      powerpc/pasemi: Use raw spinlock in SMP TB sync
      powerpc: Use one common impl. of RTAS timebase sync and use raw spinlock
      powerpc/rtas: Turn rtas lock into a raw spinlock
      powerpc: Add irqtrace support for 32-bit powerpc
      powerpc/BSR: Fix BSR to allow mmap of small BSR on 64k kernel
      powerpc/BSR: add 4096 byte BSR size
      powerpc: Map more memory early on 601 processors
      powerpc/pmac: Fix DMA ops for MacIO devices
      powerpc/mm: Make k(un)map_atomic out of line
      powerpc: Fix mpic alloc warning
      powerpc: Fix output from show_regs
      powerpc/pmac: Fix issues with PowerMac "PowerSurge" SMP
      powerpc/amigaone: Limit ISA I/O range to 4k in the device tree
      powerpc/warp: Platform fix for i2c change
      powerpc: Have git ignore generated files from dtc compile
      powerpc/mpic: Fix mapping of "DCR" based MPIC variants
      ...

commit 5a2642f620eb6e40792822fa0eafe23046fbb55e
Author: Benjamin Herrenschmidt <benh@kernel.crashing.org>
Date:   Mon Jun 22 16:47:59 2009 +0000

    powerpc/mpic: Fix mapping of "DCR" based MPIC variants
    
    Commit 31207dab7d2e63795eb15823947bd2f7025b08e2
    "Fix incorrect allocation of interrupt rev-map"
    introduced a regression crashing on boot on machines using
    a "DCR" based MPIC, such as the Cell blades.
    
    The reason is that the irq host data structure is initialized
    much later as a result of that patch, causing our calls to
    mpic_map() do be done before we have a host setup.
    
    Unfortunately, this breaks _mpic_map_dcr() which uses the
    mpic->irqhost to get to the device node.
    
    This fixes it by, instead, passing the device node explicitely
    to mpic_map().
    
    Signed-off-by: Benjamin Herrenschmidt <benh@kernel.crashing.org>
    Acked-by: Akira Tsukamoto <akirat@rd.scei.sony.co.jp>

commit 836ce679c0b5b5040164171afc33753396864b30
Author: Jack Steiner <steiner@sgi.com>
Date:   Wed Jun 17 16:28:22 2009 -0700

    gru: change resource assignment for kernel threads
    
    Change the way GRU resources are assigned for kernel threads.  GRU
    contexts for kernel threads are now allocated on demand and can be stolen
    by user processes when idle.  This allows MPI jobs to use ALL of the GRU
    resources when the kernel is not using them.
    
    Signed-off-by: Jack Steiner <steiner@sgi.com>
    Signed-off-by: Andrew Morton <akpm@linux-foundation.org>
    Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>

commit 14d0f0b063f5363984dd305a792854f9c23e9e97
Author: Kashyap, Desai <kashyap.desai@lsi.com>
Date:   Fri May 29 16:37:04 2009 +0530

    [SCSI] mpt fusion: Fixing 1078 data corruption issue for 36GB memory region
    
    The reason for this change is there is a data corruption when four different
    physical memory regions in the 36GB to 37GB region are
    accessed. This is only affecting 1078.
    
    The solution is we need to use different addressing when filling in
    the scatter gather table for the effected memory regions.  So instead
    of snooping on all four different memory holes, we treat any physical
    addresses in the 36GB address with the same algorithm.
    
    The fix is explained below
    1) Ensure that the message frames are NOT located in the trouble
    region. There is no remapping available for message frames, they must
    be allocated outside the problem region.
    2) Ensure that Sense buffers are NOT in the trouble region. There is
    no remapping available.
    3) Walk through the SGE entries and if any are inside the trouble region
       then they need to be remapped as discussed below.
            1) Set the Local Address bit in the SGE Flags field.
            MPI_SGE_FLAGS_LOCAL_ADDRESS
            2) Ensure we are using 64-bit SGEs
            3) Set MSb (Bit 63) of the 64-bit address, this will indicate buffer
            location is Host Memory.
    
    Signed-off-by: Kashyap Desai <kadesai@lsi.com>
    Signed-off-by: James Bottomley <James.Bottomley@HansenPartnership.com>

commit 18e7555a38eaadb757353c4b76667e07166ad26c
Author: Andrew Vasquez <andrew.vasquez@qlogic.com>
Date:   Wed Jun 3 09:55:30 2009 -0700

    [SCSI] qla2xxx: Synchronize MPI settings after a PE Reset.
    
    Ensure MPS remains in synchronization across all NIC/FCoE
    functions after a reset.
    
    Signed-off-by: Andrew Vasquez <andrew.vasquez@qlogic.com>
    Signed-off-by: James Bottomley <James.Bottomley@HansenPartnership.com>

commit 993e0da7b767c0a7c1fd0079b16f3d28e6f25a48
Author: Eric Moore <eric.moore@lsi.com>
Date:   Mon May 18 13:00:45 2009 -0600

    [SCSI] mpt2sas: LUN Reset Support
    
    Adding new eh_target_reset_handler for target reset. Change the
    eh_device_reset_handler so its sending
    MPI2_SCSITASKMGMT_TASKTYPE_LOGICAL_UNIT_RESET, instead of
    MPI2_SCSITASKMGMT_TASKTYPE_TARGET_RESET.  Add new function
    _scsih_scsi_lookup_find_by_lun as a sanity check to insure I_T_L commands are
    completed upon completing lun reset.
    
    Signed-off-by: Eric Moore <eric.moore@lsi.com>
    Signed-off-by: James Bottomley <James.Bottomley@HansenPartnership.com>

commit 2b6b6d385d2933c105e27f2d25fdb36d392d7f59
Merge: 3e862dd5c94c 0a8c791437db
Author: Linus Torvalds <torvalds@linux-foundation.org>
Date:   Tue Apr 14 10:10:16 2009 -0700

    Merge branch 'fixes-for-linus' of git://git.monstr.eu/linux-2.6-microblaze
    
    * 'fixes-for-linus' of git://git.monstr.eu/linux-2.6-microblaze:
      microblaze: Add missing FILE tag to MAINTAINERS
      microblaze: remove duplicated #include's
      microblaze: struct device - replace bus_id with dev_name()
      microblaze: Simplify copy_thread()
      microblaze: Add TIMESTAMPING constants to socket.h
      microblaze: Add missing empty ftrace.h file
      microblaze: Fix problem with removing zero length files

commit 39141bfcad22e6d7393c0d0f81b2e180db6983df
Author: Michal Simek <monstr@monstr.eu>
Date:   Tue Apr 14 09:16:01 2009 +0200

    microblaze: Add TIMESTAMPING constants to socket.h
    
    This changes was introduce with
    commit: cb9eff097831007afb30d64373f29d99825d0068
    
    net: new user space API for time stamping of incoming and outgoing packets
    
    Signed-off-by: Michal Simek <monstr@monstr.eu>

commit d91e4ea7047d96733d763f1626f1f21ff4298cef
Author: Kumar Gala <galak@kernel.crashing.org>
Date:   Wed Jan 7 15:53:29 2009 -0600

    powerpc: Add support for CoreInt delivery of interrupts on MPIC
    
    CoreInt provides a mechansim to deliver the IRQ vector directly
    into the core on an interrupt (via the SPR EPR) rather than having
    to go IACK on the PIC.  This is suppose to provide an improvment
    in interrupt latency by reducing the time to get the IRQ vector.
    
    Signed-off-by: Kumar Gala <galak@kernel.crashing.org>

commit 55a961581fd34632bf724dd144c0dbf740c9fede
Author: Andrew Vasquez <andrew.vasquez@qlogic.com>
Date:   Tue Mar 24 09:08:03 2009 -0700

    [SCSI] qla2xxx: Update MPI/PHY version retrieval codes.
    
    Reflects layout and format of latest specification.
    
    Signed-off-by: Andrew Vasquez <andrew.vasquez@qlogic.com>
    Signed-off-by: James Bottomley <James.Bottomley@HansenPartnership.com>

commit f74a61e3c6f218053742c2caf3e247fb41bf395e
Author: Indika Katugampala <indika_20012001@yahoo.co.jp>
Date:   Wed Feb 11 11:13:05 2009 -0300

    V4L/DVB (10528): em28xx: support added for IO-DATA GV/MVP SZ - EMPIA-2820 chipset
    
    [dougsland@redhat.com: Fixed CodingStyle]
    Signed-off-by: Indika Katugampala <indika_20012001@yahoo.co.jp>
    Signed-off-by: Douglas Schilling Landgraf <dougsland@redhat.com>
    Signed-off-by: Mauro Carvalho Chehab <mchehab@redhat.com>

commit ae2bc4d2561258f8ce41c0dfd67bea094adf1b3f
Author: Linus Torvalds <torvalds@linux-foundation.org>
Date:   Thu Mar 19 15:53:19 2009 -0700

    Move cc-option to below arch-specific setup
    
    commit d0115552cdb0b4d4146975889fee2e9355515c4b upstream.
    
    Sam Ravnborg says:
     "We have several architectures that plays strange games with $(CC) and
      $(CROSS_COMPILE).
    
      So we need to postpone any use of $(call cc-option..) until we have
      included the arch specific Makefile so we try with the correct $(CC)
      version."
    
    Requested-by: Sam Ravnborg <sam@ravnborg.org>
    Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>
    Signed-off-by: Greg Kroah-Hartman <gregkh@suse.de>

commit 7c87d3575a24b7dfe80a59fd4f4df90552aaa5db
Author: Linus Torvalds <torvalds@linux-foundation.org>
Date:   Thu Mar 19 15:53:19 2009 -0700

    Move cc-option to below arch-specific setup
    
    commit d0115552cdb0b4d4146975889fee2e9355515c4b upstream.
    
    Sam Ravnborg says:
     "We have several architectures that plays strange games with $(CC) and
      $(CROSS_COMPILE).
    
      So we need to postpone any use of $(call cc-option..) until we have
      included the arch specific Makefile so we try with the correct $(CC)
      version."
    
    Requested-by: Sam Ravnborg <sam@ravnborg.org>
    Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>
    Signed-off-by: Greg Kroah-Hartman <gregkh@suse.de>

commit d0115552cdb0b4d4146975889fee2e9355515c4b
Author: Linus Torvalds <torvalds@linux-foundation.org>
Date:   Thu Mar 19 15:53:19 2009 -0700

    Move cc-option to below arch-specific setup
    
    Sam Ravnborg says:
     "We have several architectures that plays strange games with $(CC) and
      $(CROSS_COMPILE).
    
      So we need to postpone any use of $(call cc-option..) until we have
      included the arch specific Makefile so we try with the correct $(CC)
      version."
    
    Requested-by: Sam Ravnborg <sam@ravnborg.org>
    Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>

commit 3599c9c24e57eba1427c604e4a7ae3b0864affda
Author: Faisal Latif <faisal.latif@intel.com>
Date:   Thu Mar 12 14:34:59 2009 -0700

    RDMA/nes: Don't allow userspace QPs to use STag zero
    
    commit c12e56ef6951f4fce1afe9ef6aab9243ea9a9b04 upstream.
    
    STag zero is a special STag that allows consumers to access any bus
    address without registering memory.  The nes driver unfortunately
    allows STag zero to be used even with QPs created by unprivileged
    userspace consumers, which means that any process with direct verbs
    access to the nes device can read and write any memory accessible to
    the underlying PCI device (usually any memory in the system).  Such
    access is usually given for cluster software such as MPI to use, so
    this is a local privilege escalation bug on most systems running this
    driver.
    
    The driver was using STag zero to receive the last streaming mode
    data; to allow STag zero to be disabled for unprivileged QPs, the
    driver now registers a special MR for this data.
    
    Signed-off-by: Faisal Latif <faisal.latif@intel.com>
    Signed-off-by: Roland Dreier <rolandd@cisco.com>
    Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>
    Signed-off-by: Greg Kroah-Hartman <gregkh@suse.de>

commit ceb5722adfe975c1014180a94360e8d410924b4b
Author: Faisal Latif <faisal.latif@intel.com>
Date:   Thu Mar 12 14:34:59 2009 -0700

    RDMA/nes: Don't allow userspace QPs to use STag zero
    
    commit c12e56ef6951f4fce1afe9ef6aab9243ea9a9b04 upstream.
    
    STag zero is a special STag that allows consumers to access any bus
    address without registering memory.  The nes driver unfortunately
    allows STag zero to be used even with QPs created by unprivileged
    userspace consumers, which means that any process with direct verbs
    access to the nes device can read and write any memory accessible to
    the underlying PCI device (usually any memory in the system).  Such
    access is usually given for cluster software such as MPI to use, so
    this is a local privilege escalation bug on most systems running this
    driver.
    
    The driver was using STag zero to receive the last streaming mode
    data; to allow STag zero to be disabled for unprivileged QPs, the
    driver now registers a special MR for this data.
    
    Signed-off-by: Faisal Latif <faisal.latif@intel.com>
    Signed-off-by: Roland Dreier <rolandd@cisco.com>
    Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>
    Signed-off-by: Greg Kroah-Hartman <gregkh@suse.de>

commit c12e56ef6951f4fce1afe9ef6aab9243ea9a9b04
Author: Faisal Latif <faisal.latif@intel.com>
Date:   Thu Mar 12 14:34:59 2009 -0700

    RDMA/nes: Don't allow userspace QPs to use STag zero
    
    STag zero is a special STag that allows consumers to access any bus
    address without registering memory.  The nes driver unfortunately
    allows STag zero to be used even with QPs created by unprivileged
    userspace consumers, which means that any process with direct verbs
    access to the nes device can read and write any memory accessible to
    the underlying PCI device (usually any memory in the system).  Such
    access is usually given for cluster software such as MPI to use, so
    this is a local privilege escalation bug on most systems running this
    driver.
    
    The driver was using STag zero to receive the last streaming mode
    data; to allow STag zero to be disabled for unprivileged QPs, the
    driver now registers a special MR for this data.
    
    Cc: <stable@kernel.org>
    Signed-off-by: Faisal Latif <faisal.latif@intel.com>
    Signed-off-by: Roland Dreier <rolandd@cisco.com>
    Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>

commit 563fdd4a0af509d8cb78901750f7d00db345d864
Author: Kumar Gala <galak@kernel.crashing.org>
Date:   Wed Feb 11 22:50:42 2009 -0600

    powerpc/85xx: Update smp support to handle doorbells and non-mpic init
    
    Use device tree to determine if we actually have an MPIC and use
    CPU feature to decide if we should use doorbells for IPIs.
    
    Signed-off-by: Kumar Gala <galak@kernel.crashing.org>

commit 7c92191cb4203d3900461074f90851e9e7b56fcb
Author: Ron Mercer <ron.mercer@qlogic.com>
Date:   Tue Mar 3 12:10:35 2009 +0000

    qlge: Improve handling for firmware init failure.
    
    This event will arrive at boot time or after an
    MPI processor reset if the firmware failed to initialize.
    
    Signed-off-by: Ron Mercer <ron.mercer@qlogic.com>
    Signed-off-by: David S. Miller <davem@davemloft.net>

commit 20d4947353be60e909e6b1a79d241457edd6833f
Author: Patrick Ohly <patrick.ohly@intel.com>
Date:   Thu Feb 12 05:03:38 2009 +0000

    net: socket infrastructure for SO_TIMESTAMPING
    
    The overlap with the old SO_TIMESTAMP[NS] options is handled so
    that time stamping in software (net_enable_timestamp()) is
    enabled when SO_TIMESTAMP[NS] and/or SO_TIMESTAMPING_RX_SOFTWARE
    is set.  It's disabled if all of these are off.
    
    Signed-off-by: Patrick Ohly <patrick.ohly@intel.com>
    Signed-off-by: David S. Miller <davem@davemloft.net>

commit ebd9026d9f8499abc60d82d949bd37f88fe34a41
Author: Ingo Molnar <mingo@elte.hu>
Date:   Wed Feb 11 12:17:29 2009 +0100

    stackprotector: fix multi-word cross-builds
    
    Stackprotector builds were failing if CROSS_COMPILER was more than
    a single world (such as when distcc was used) - because the check
    scripts used $1 instead of $*.
    
    Signed-off-by: Ingo Molnar <mingo@elte.hu>

commit a11d9b623ea7cdcd647318bb2b3282d4c337f086
Merge: 4c44323db15f 32aeef605aa0
Author: Linus Torvalds <torvalds@linux-foundation.org>
Date:   Fri Jan 16 08:40:40 2009 -0800

    Merge git://git.kernel.org/pub/scm/linux/kernel/git/jejb/scsi-rc-fixes-2.6
    
    * git://git.kernel.org/pub/scm/linux/kernel/git/jejb/scsi-rc-fixes-2.6:
      [SCSI] Skip deleted devices in __scsi_device_lookup_by_target()
      [SCSI] Add SUN Universal Xport to no attach blacklist
      [SCSI] iscsi_tcp: make padbuf non-static
      [SCSI] mpt fusion: Add Firmware debug support
      [SCSI] mpt fusion: Add separate msi enable disable for FC,SPI,SAS
      [SCSI] mpt fusion: Update MPI Headers to version 01.05.19
      [SCSI] qla2xxx: Fix ISP restart bug in multiq code

commit fd7a253311412b3fc7c85586552c90eca61e7d23
Author: Kashyap, Desai <kashyap.desai@lsi.com>
Date:   Tue Jan 6 14:56:31 2009 +0530

    [SCSI] mpt fusion: Update MPI Headers to version 01.05.19
    
    This Patch is submitted to increment the MPI headers used by LSI MPT
    fusion drivers to the latest version 01.05.19.  Year is changed in
    CopyRight.
    
    Signed-off-by: Kashyap Desai <kadesai@lsi.com>
    Signed-off-by: James Bottomley <James.Bottomley@HansenPartnership.com>

commit def434c2319c5a336633cd73322e0f28a7091b01
Author: Benjamin Krill <ben@codiert.org>
Date:   Thu Nov 27 16:15:44 2008 +0100

    powerpc/cell: add QPACE as a separate Cell platform
    
    Since the QPACE (Chromodynamics Parallel Computing on the
    Cell Broadband Engine) platform doesn't use a iommu, doesn't
    have PCI devices and a MPIC much lesser setup and
    configurations are needed. So far all devices are detected
    as OF device. A notifier function is used to set the dma_ops
    for the of_platform bus. Further this patch splits the
    PPC_CELL_NATIVE into PPC_CELL_COMMON which are parts that are
    shared with the QPACE platform and the rest.
    
    Signed-off-by: Benjamin Krill <ben@codiert.org>
    Signed-off-by: Arnd Bergmann <arnd@arndb.de>

commit d9ede5db9ab5226df0931a6eaef53f00c838646c
Author: Arnd Bergmann <arnd@arndb.de>
Date:   Fri Nov 28 09:51:23 2008 +0000

    powerpc/mpic: Don't reset affinity for secondary MPIC on boot
    
    commit cc353c30bbdb84f4317a6c149ebb11cde2232e40 upstream.
    
    Kexec/kdump currently fails on the IBM QS2x blades when the kexec happens
    on a CPU other than the initial boot CPU.  It turns out that this is the
    result of mpic_init trying to set affinity of each interrupt vector to the
    current boot CPU.
    
    As far as I can tell,  the same problem is likely to exist on any
    secondary MPIC, because they have to deliver interrupts to the first
    output all the time. There are two potential solutions for this: either
    not set up affinity at all for secondary MPICs, or assume that a single
    CPU output is connected to the upstream interrupt controller and hardcode
    affinity to that per architecture.
    
    This patch implements the second approach, defaulting to the first output.
    Currently, all known secondary MPICs are routed to their upstream port
    using the first destination, so we hardcode that.
    
    Signed-off-by: Arnd Bergmann <arnd@arndb.de>
    Signed-off-by: Paul Mackerras <paulus@samba.org>
    Signed-off-by: Greg Kroah-Hartman <gregkh@suse.de>

commit 361425fc32422c9716fc69e52455b7d44fc02c18
Author: Haiying Wang <Haiying.Wang@freescale.com>
Date:   Wed Dec 3 14:03:09 2008 -0500

    powerpc/85xx: Create dts for each core in CAMP mode for MPC8572DS
    
    This patch creates the dts files for each core and splits the devices
    between the two cores for MPC8572DS.
    
    core0 has memory, L2, i2c, dma1, global-util, eth0, eth1, crypto, pci0, pci1.
    core1 has L2, dma2, eth2, eth3, pci2, msi.
    
    MPIC is shared between two cores but each core will protect its interrupts
    from other core by using "protected-sources" of mpic.
    
    Signed-off-by: Haiying Wang <Haiying.Wang@freescale.com>
    Signed-off-by: Kumar Gala <galak@kernel.crashing.org>

commit 06be64a366885569f46a7e0e50b351266d28f5fc
Author: Haiying Wang <Haiying.Wang@freescale.com>
Date:   Thu Nov 13 07:46:12 2008 -0600

    powerpc/85xx: Don't reset the MPIC for CAMP mode on MPC8572DS
    
    The flag MPIC_WANTS_RESET shouldn't be set if we are doing cooperative
    asymmetric MP.  The second linux shouldn't reset the pic or the first
    one gets very confused.
    
    Signed-off-by: Haiying Wang <Haiying.Wang@freescale.com>
    Signed-off-by: Kumar Gala <galak@kernel.crashing.org>

commit d5b26db2cfcf09f28f4839c8c3484279cd5ea5b3
Author: Kumar Gala <galak@kernel.crashing.org>
Date:   Wed Nov 19 09:35:56 2008 -0600

    powerpc/85xx: Add support for SMP initialization
    
    Added 85xx specifc smp_ops structure.  We use ePAPR style boot release
    and the MPIC for IPIs at this point.
    
    Additionally added routines for secondary cpu entry and initializtion.
    
    Signed-off-by: Andy Fleming <afleming@freescale.com>
    Signed-off-by: Trent Piepho <tpiepho@freescale.com>
    Signed-off-by: Kumar Gala <galak@kernel.crashing.org>

commit 03cfdb86ac66677dbe76accae3f22c374a15b814
Merge: 4ec8f077e4dd ab598b6680f1
Author: Linus Torvalds <torvalds@linux-foundation.org>
Date:   Sun Nov 30 16:44:18 2008 -0800

    Merge branch 'merge' of git://git.kernel.org/pub/scm/linux/kernel/git/paulus/powerpc
    
    * 'merge' of git://git.kernel.org/pub/scm/linux/kernel/git/paulus/powerpc:
      powerpc: Fix system calls on Cell entered with XER.SO=1
      powerpc/cell: Fix GDB watchpoints, again
      powerpc/mpic: Don't reset affinity for secondary MPIC on boot
      powerpc/cell/axon-msi: Retry on missing interrupt
      powerpc: Fix boot freeze on machine with empty memory node
      powerpc: Fix IRQ assignment for some PCIe devices
      powerpc/spufs: Fix spinning in spufs_ps_fault on signal
      powerpc/mpc832x_rdb: fix swapped ethernet ids
      powerpc: Use generic PHY driver for Marvell 88E1111 PHY on GE Fanuc SBC610
      powerpc/85xx: L2 cache size wrong in 8572DS dts
      powerpc/virtex: Update defconfigs
      powerpc/52xx: update defconfigs
      xsysace: Fix driver to use resource_size_t instead of unsigned long
      powerpc/virtex: fix various format/casting printk mismatches
      powerpc/mpc5200: fix bestcomm Kconfig dependencies
      powerpc/44x: Fix 460EX/460GT machine check handling
      powerpc/40x: Limit allocable DRAM during early mapping

commit cc353c30bbdb84f4317a6c149ebb11cde2232e40
Author: Arnd Bergmann <arnd@arndb.de>
Date:   Fri Nov 28 09:51:23 2008 +0000

    powerpc/mpic: Don't reset affinity for secondary MPIC on boot
    
    Kexec/kdump currently fails on the IBM QS2x blades when the kexec happens
    on a CPU other than the initial boot CPU.  It turns out that this is the
    result of mpic_init trying to set affinity of each interrupt vector to the
    current boot CPU.
    
    As far as I can tell,  the same problem is likely to exist on any
    secondary MPIC, because they have to deliver interrupts to the first
    output all the time. There are two potential solutions for this: either
    not set up affinity at all for secondary MPICs, or assume that a single
    CPU output is connected to the upstream interrupt controller and hardcode
    affinity to that per architecture.
    
    This patch implements the second approach, defaulting to the first output.
    Currently, all known secondary MPICs are routed to their upstream port
    using the first destination, so we hardcode that.
    
    Signed-off-by: Arnd Bergmann <arnd@arndb.de>
    Signed-off-by: Paul Mackerras <paulus@samba.org>

commit d015fe9951641b2d869a7ae4a690be2a05a9dc7f
Author: Arnd Bergmann <arnd@arndb.de>
Date:   Fri Nov 28 09:51:22 2008 +0000

    powerpc/cell/axon-msi: Retry on missing interrupt
    
    The MSI capture logic for the axon bridge can sometimes
    lose interrupts in case of high DMA and interrupt load,
    when it signals an MSI interrupt to the MPIC interrupt
    controller while we are already handling another MSI.
    
    Each MSI vector gets written into a FIFO buffer in main
    memory using DMA, and that DMA access is normally flushed
    by the actual interrupt packet on the IOIF.  An MMIO
    register in the MSIC holds the position of the last
    entry in the FIFO buffer that was written.  However,
    reading that position does not flush the DMA, so that
    we can observe stale data in the buffer.
    
    In a stress test, we have observed the DMA to arrive
    up to 14 microseconds after reading the register.
    
    This patch works around this problem by retrying the
    access to the FIFO buffer.
    
    We can reliably detect the conditioning by writing
    an invalid MSI vector into the FIFO buffer after
    reading from it, assuming that all MSIs we get
    are valid.  After detecting an invalid MSI vector,
    we udelay(1) in the interrupt cascade for up to
    100 times before giving up.
    
    Signed-off-by: Arnd Bergmann <arnd@arndb.de>
    Signed-off-by: Paul Mackerras <paulus@samba.org>

commit 591ffdd8f5f92f9245071131ae137568d1940ba0
Author: Kumar Gala <galak@kernel.crashing.org>
Date:   Tue Oct 28 18:01:39 2008 +0000

    powerpc/mpic: Fix regression caused by change of default IRQ affinity
    
    commit 3c10c9c45e290022ca7d2aa1ad33a0b6ed767520 upstream.
    
    The Freescale implementation of MPIC only allows a single CPU destination
    for non-IPI interrupts.  We add a flag to the mpic_init to distinquish
    these variants of MPIC.  We pull in the irq_choose_cpu from sparc64 to
    select a single CPU as the destination of the interrupt.
    
    This is to deal with the fact that the default smp affinity was
    changed by commit 18404756765c713a0be4eb1082920c04822ce588 ("genirq:
    Expose default irq affinity mask (take 3)") to be all CPUs.
    
    Signed-off-by: Kumar Gala <galak@kernel.crashing.org>
    Signed-off-by: Paul Mackerras <paulus@samba.org>
    Signed-off-by: Greg Kroah-Hartman <gregkh@suse.de>

commit 78608dd32ce46789e970d6c3c423cd668c138d6c
Author: Milton Miller <miltonm@bga.com>
Date:   Fri Oct 10 01:56:50 2008 +0000

    powerpc/mpic: Use new smp_request_message_ipi
    
    MPIC has 4 ipis, so it can use the new smp_request_message_ipi to
    reduce pathlength when receiving an ipi.
    
    This has the side effect of using the common ipi names, and also
    continuing to try request the remaining messages when one fails.
    
    Signed-off-by: Milton Miller <miltonm@bga.com>
    Signed-off-by: Paul Mackerras <paulus@samba.org>

commit 3c10c9c45e290022ca7d2aa1ad33a0b6ed767520
Author: Kumar Gala <galak@kernel.crashing.org>
Date:   Tue Oct 28 18:01:39 2008 +0000

    powerpc/mpic: Fix regression caused by change of default IRQ affinity
    
    The Freescale implementation of MPIC only allows a single CPU destination
    for non-IPI interrupts.  We add a flag to the mpic_init to distinquish
    these variants of MPIC.  We pull in the irq_choose_cpu from sparc64 to
    select a single CPU as the destination of the interrupt.
    
    This is to deal with the fact that the default smp affinity was
    changed by commit 18404756765c713a0be4eb1082920c04822ce588 ("genirq:
    Expose default irq affinity mask (take 3)") to be all CPUs.
    
    Signed-off-by: Kumar Gala <galak@kernel.crashing.org>
    Signed-off-by: Paul Mackerras <paulus@samba.org>

commit 612f9d338a6060f814ef35b7108b43407a5df423
Author: Timur Tabi <timur@freescale.com>
Date:   Tue Sep 9 14:43:39 2008 -0500

    powerpc: Fix interrupt values for DMA2 in MPC8610 HPCD device tree
    
    For Freescale 8xxx devices that use an MPIC, the interrupt numbers in
    the device tree must be 16 greater than the values documented in the
    reference manual.  In these chips, the MPIC is wired to use the first
    16 numbers for external interrupts, but the documentation numbers
    internal interrupts from 0.
    
    In the MPC8610 HPCD device tree, the interrupt properties for the DMA
    channels for DMA2 were not the adjusted values.  This fixes that.
    
    Signed-off-by: Timur Tabi <timur@freescale.com>
    Signed-off-by: Kumar Gala <galak@kernel.crashing.org>
    Signed-off-by: Paul Mackerras <paulus@samba.org>

commit 25235f712b680d00756a73ee64289137989fc6fd
Author: Michael Ellerman <michael@ellerman.id.au>
Date:   Wed Aug 6 09:10:03 2008 +1000

    powerpc: Convert the MPIC MSI code to use msi_bitmap
    
    This affects the U3 MSI code as well as the PASEMI MSI code.  We keep
    some of the MPIC routines as helpers, and also the U3 best-guess
    reservation logic.  The rest is replaced by the generic code.
    
    And a few printk format changes due to hwirq type change.
    
    Signed-off-by: Michael Ellerman <michael@ellerman.id.au>
    Signed-off-by: Paul Mackerras <paulus@samba.org>

commit 7e302869e0c5261aba779e059cddcd2fbf7aedbe
Author: Michael Ellerman <michael@ellerman.id.au>
Date:   Wed Aug 6 09:10:01 2008 +1000

    powerpc: Split-out common MSI bitmap logic into msi_bitmap.c
    
    There are now two almost identical implementations of an MSI bitmap
    allocator, one in mpic_msi.c and the other in fsl_msi.c.
    
    Merge them together and put the result in msi_bitmap.c.  Some of the
    MPIC bits will remain to provide a nicer interface for the MPIC users.
    
    In the process we fix two buglets.  The first is that the allocation
    routines, now msi_bitmap_alloc_hwirqs(), returned an unsigned result,
    even though they use -1 to indicate allocation failure.  Although all
    the callers were checking correctly, it is much better for the routine
    to just return an int.  At least until someone wants > ~2 billion MSIs.
    
    The second buglet is that the device tree reservation logic only
    allowed power-of-two reservations.  AFAICT that didn't effect any
    existing code but it's nicer if we can reserve arbitrary irqs from MSI
    use.
    
    We also add some selftests, which exposed the two buglets and now test
    for them, as well as some basic sanity tests.  The tests are only built
    when CONFIG_DEBUG_KERNEL=y.
    
    Signed-off-by: Michael Ellerman <michael@ellerman.id.au>
    Signed-off-by: Paul Mackerras <paulus@samba.org>

commit 6492cdf3a24fd620660c399745b5e169a0ed27d6
Author: Faisal Latif <flatif@neteffect.com>
Date:   Thu Jul 24 20:50:45 2008 -0700

    RDMA/nes: CM connection setup/teardown rework
    
    Major rework of CM connection setup/teardown.  We had a number of issues
    with MPI applications not starting/terminating properly over time.
    With these changes we were able to run longer on larger clusters.
    
    * Remove memory allocation from nes_connect() and nes_cm_connect().
    * Fix mini_cm_dec_refcnt_listen() when destroying listener.
    * Remove unnecessary code from schedule_nes_timer() and nes_cm_timer_tick().
    * Functionalize mini_cm_recv_pkt() and process_packet().
    * Clean up cm_node->ref_count usage.
    * Reuse skbs if available.
    
    Signed-off-by: Faisal Latif <flatif@neteffect.com>
    Signed-off-by: Roland Dreier <rolandd@cisco.com>

commit df8666198dd058b9498ebdbc52c61957206d30a5
Author: Ralph Campbell <ralph.campbell@qlogic.com>
Date:   Mon Jul 14 23:48:52 2008 -0700

    IB/ipath: Use IEEE OUI for vendor_id reported by ibv_query_device()
    
    The IB spe. for SubnGet(NodeInfo) and query HCA says that the vendor
    ID field should be the IEEE OUI assigned to the vendor.  The ipath
    driver was returning the PCI vendor ID instead.  This will affect
    applications which call ibv_query_device().  The old value was
    0x001fc1 or 0x001077, the new value is 0x001175.
    
    The vendor ID doesn't appear to be exported via /sys so that should
    reduce possible compatibility issues.  I'm only aware of Open MPI as a
    major application which depends on this change, and they have made
    necessary adjustments.
    
    Signed-off-by: Ralph Campbell <ralph.campbell@qlogic.com>
    Signed-off-by: Roland Dreier <rolandd@cisco.com>

commit 0fe9b1ea60bc209c8c87afcbb1c2ec0b28835aa4
Author: Kumar Gala <galak@kernel.crashing.org>
Date:   Mon Jun 30 23:24:14 2008 -0500

    powerpc/85xx: Fix KSI8560 .dts
    
    Rename MPIC label to mpic to match all other 85xx .dts and to fix compile
    issue introduced by addition of the DMA node.
    
    Signed-off-by: Kumar Gala <galak@kernel.crashing.org>

commit c71b47835188d0c2a1e1f9590564f1b71c651710
Author: Mike Frysinger <vapier.adi@gmail.com>
Date:   Mon Jul 14 17:10:50 2008 +0800

    Blackfin arch: set CROSS_COMPILE in our arch Makefile so it gets used by default
    
    Signed-off-by: Mike Frysinger <vapier.adi@gmail.com>
    Signed-off-by: Bryan Wu <cooloney@kernel.org>

commit 5888da18765ca9af7f10015263d8bc8e3057f128
Author: Kumar Gala <galak@kernel.crashing.org>
Date:   Wed Jul 2 01:16:16 2008 +1000

    powerpc: Fix building of feature-fixup tests on ppc32
    
    We need to use PPC_LCMPI otherwise we get compile errors like:
    
    arch/powerpc/lib/feature-fixups-test.S: Assembler messages:
    arch/powerpc/lib/feature-fixups-test.S:142: Error: Unrecognized opcode: `cmpdi'
    arch/powerpc/lib/feature-fixups-test.S:149: Error: Unrecognized opcode: `cmpdi'
    arch/powerpc/lib/feature-fixups-test.S:164: Error: Unrecognized opcode: `cmpdi'
    
    Signed-off-by: Kumar Gala <galak@kernel.crashing.org>
    Signed-off-by: Paul Mackerras <paulus@samba.org>

commit 760378e1497841246ea7e42abad617d8a8ac0bcc
Author: Ingo Molnar <mingo@elte.hu>
Date:   Tue Jul 1 17:35:06 2008 +0200

    fix "ftrace: store mcount address in rec->ip"
    
    Alexander Beregalov reported this build failure:
    
    $ make CROSS_COMPILE=sparc64-unknown-linux-gnu- image modules && sudo
    make modules_install
      CHK     include/linux/version.h
      CHK     include/linux/utsrelease.h
      CALL    scripts/checksyscalls.sh
      CHK     include/linux/compile.h
    dnsdomainname: Unknown host
      CC      arch/sparc64/kernel/sparc64_ksyms.o
    arch/sparc64/kernel/sparc64_ksyms.c:116: error: '_mcount' undeclared
    here (not in a function)
    cc1: warnings being treated as errors
    arch/sparc64/kernel/sparc64_ksyms.c:116: error: type defaults to 'int'
    in declaration of '_mcount'
    
    And bisected it back to:
    
    | commit 395a59d0f8e86bb39cd700c3d185d30c670bb958
    | Author: Abhishek Sagar <sagar.abhishek@gmail.com>
    | Date:   Sat Jun 21 23:47:27 2008 +0530
    |
    |     ftrace: store mcount address in rec->ip
    
    the mcount prototype is only available under CONFIG_FTRACE,
    extend it to CONFIG_MCOUNT as well.
    
    Reported-and-bisected-by: Alexander Beregalov <a.beregalov@gmail.com>
    Signed-off-by: Ingo Molnar <mingo@elte.hu>

commit bdb144b67a7660ce5d044ae9a2fd1a8030f12523
Author: Jesper Nilsson <jesper@jni.nu>
Date:   Sun Jun 29 23:15:19 2008 +0200

    [CRIS] Build fixes for compressed and rescue images for v10 and v32:
    
    - Use the normal cross gcc instead of using an elf specific cris toolchain.
      This removes the dependency of this second toolchain.
    
    - Use the normal cross objcopy instead of overriding it to use elf-toolchain.
      This allows compiling using "CROSS_COMPILE=$CRIS_GCC/cris-axis-linux-gnu-"
      instead of just "CROSS_COMPILE=$CRIS_GCC/cris-axis-linux-gnu/bin/"
    
    - Remove redundant rules for compiling, the implicit rules are sufficient.
    
    - Convert the arch/cris/arch-v10/boot/compressed/head.S to format
      accepted by the cris-axis-linux-gnu-gcc (registers must be prefixed
      with '$', remove explicit underscore on exported symbols)
    
    - Remove a number of unused (and duplicated) prototypes from
      arch/cris/arch-v10/boot/compressed/misc.c.
    
    - Correct memcpy and memset return values (actually return them!)
    
    Signed-off-by: Jesper Nilsson <jesper.nilsson@axis.com>

commit 34e36c1541fe70e5b3842a3278c0e7631d31f4cb
Author: Jason Jin <Jason.jin@freescale.com>
Date:   Fri May 23 16:32:46 2008 +0800

    [POWERPC] fsl: PCIe MSI support for 83xx/85xx/86xx processors.
    
    This MSI driver can be used on 83xx/85xx/86xx board.
    In this driver, virtual interrupt host and chip were
    setup. There are 256 MSI interrupts in this host, Every 32
    MSI interrupts cascaded to one IPIC/MPIC interrupt.
    The chip was treated as edge sensitive and some necessary
    functions were setup for this chip.
    
    Before using the MSI interrupt, PCI/PCIE device need to
    ask for a MSI interrupt in the 256 MSI interrupts. A 256bit
    bitmap show which MSI interrupt was used, reserve bit in
    the bitmap can be used to force the device use some designate
    MSI interrupt in the 256 MSI interrupts. Sometimes this is useful
    for testing the all the MSI interrupts. The msi-available-ranges
    property in the dts file was used for this purpose.
    
    Signed-off-by: Jason Jin <Jason.jin@freescale.com>
    Signed-off-by: Kumar Gala <galak@kernel.crashing.org>

commit f8b0dfd15277974b5c9f3ff17f9e3ab6fdbe45ee
Author: Steve Wise <swise@opengridcomputing.com>
Date:   Tue Apr 29 13:46:52 2008 -0700

    RDMA/cxgb3: Support peer-2-peer connection setup
    
    Open MPI, Intel MPI and other applications don't respect the iWARP
    requirement that the client (active) side of the connection send the
    first RDMA message.  This class of application connection setup is
    called peer-to-peer.  Typically once the connection is setup, _both_
    sides want to send data.
    
    This patch enables supporting peer-to-peer over the chelsio RNIC by
    enforcing this iWARP requirement in the driver itself as part of RDMA
    connection setup.
    
    Connection setup is extended, when the peer2peer module option is 1,
    such that the MPA initiator will send a 0B Read (the RTR) just after
    connection setup.  The MPA responder will suspend SQ processing until
    the RTR message is received and reply-to.
    
    In the longer term, this will be handled in a standardized way by
    enhancing the MPA negotiation so peers can indicate whether they
    want/need the RTR and what type of RTR (0B read, 0B write, or 0B send)
    should be sent.  This will be done by standardizing a few bits of the
    private data in order to negotiate all this.  However this patch
    enables peer-to-peer applications now and allows most of the required
    firmware and driver changes to be done and tested now.
    
    Design:
    
     - Add a module option, peer2peer, to enable this mode.
    
     - New firmware support for peer-to-peer mode:
    
            - a new bit in the rdma_init WR to tell it to do peer-2-peer
              and what form of RTR message to send or expect.
    
            - process _all_ preposted recvs before moving the connection
              into rdma mode.
    
            - passive side: defer completing the rdma_init WR until all
              pre-posted recvs are processed.  Suspend SQ processing until
              the RTR is received.
    
            - active side: expect and process the 0B read WR on offload TX
              queue. Defer completing the rdma_init WR until all
              pre-posted recvs are processed.  Suspend SQ processing until
              the 0B read WR is processed from the offload TX queue.
    
     - If peer2peer is set, driver posts 0B read request on offload TX
       queue just after posting the rdma_init WR to the offload TX queue.
    
     - Add CQ poll logic to ignore unsolicitied read responses.
    
    Signed-off-by: Steve Wise <swise@opengridcomputing.com>
    Signed-off-by: Roland Dreier <rolandd@cisco.com>

commit 989a1780698c65dfe093a6aa89ceeff84c31f528
Author: Steve Wise <swise@opengridcomputing.com>
Date:   Tue Apr 29 13:46:51 2008 -0700

    RDMA/cxgb3: Correctly serialize peer abort path
    
    Open MPI and other stress testing exposed a few bad bugs in handling
    aborts in the middle of a normal close.  Fix these by:
    
     - serializing abort reply and peer abort processing with disconnect
       processing
    
     - warning (and ignoring) if ep timer is stopped when it wasn't running
    
     - cleaning up disconnect path to correctly deal with aborting and
       dead endpoints
    
     - in iwch_modify_qp(), taking a ref on the ep before releasing the qp
       lock if iwch_ep_disconnect() will be called.  The ref is dropped
       after calling disconnect.
    
    Signed-off-by: Steve Wise <swise@opengridcomputing.com>
    Signed-off-by: Roland Dreier <rolandd@cisco.com>

commit 7132799b0e49c48cf119dbe02d20810860d20991
Author: Valentine Barshak <vbarshak@ru.mvista.com>
Date:   Thu Apr 3 23:09:43 2008 +0400

    [POWERPC] kexec: MPIC ack interrupts at mpic_teardown_this_cpu()
    
    We really need to ack interrupts at mpic_teardown, since
    not all platforms reset mpic at kernel start-up. For example,
    kexec'ed kernel hangs on P.A. Semi if mpic_eoi() isn't called.
    
    Signed-off-by: Valentine Barshak <vbarshak@ru.mvista.com>
    Signed-off-by: Olof Johansson <olof@lixom.net>

commit 0a69631b2869093d7306e8f66cca8eb0a05aa919
Author: Ralph Campbell <ralph.campbell@qlogic.com>
Date:   Tue Jan 15 15:58:13 2008 -0800

    IB/ipath: Fix receiving UD messages with immediate data
    
    This fixes a small bug in ipath_ud_rcv()'s handling of UD messages
    with immediate data.  We need to test whether immediate data is
    present and update the header size accordingly *before* testing the
    packet size from the header against the actual received length.
    Otherwise the wrong header size will be used and all messages with
    immediate data will be dropped.
    
    This bug keeps MVAPICH-UD and HP MPI from working at all on ipath devices.
    
    Signed-off-by: Ralph Campbell <ralph.campbell@qlogic.com>
    Signed-off-by: Roland Dreier <rolandd@cisco.com>

commit 38958dd9113c19cd7a927009ae585bd5aba3295e
Author: Olof Johansson <olof@lixom.net>
Date:   Wed Dec 12 17:44:46 2007 +1100

    [POWERPC] pasemi: Implement MSI support
    
    Implement MSI support for PA Semi PWRficient platforms. MSI is done
    through a special range of sources on the openpic controller, and they're
    unfortunately breaking the usual concepts of how sources are programmed:
    
    * The source is calculated as 512 + the value written into the MSI
      register
    * The vector for this source is added to the source and reported
      through IACK
    
    This means that for simplicity, it makes much more sense to just set the
    vector to 0 for the source, since that's really the vector we expect to
    see from IACK.
    
    Also, the affinity/priority registers will affect 16 sources at a
    time. To avoid most (simple) users from being limited by this, allocate
    16 sources per device but use only one. This means that there's a total
    of 32 sources.
    
    If we get usage scenarions that need more sources, the allocator should
    probably be revised to take an alignment argument and size, not just do
    natural alignment.
    
    Finally, since I'm already touching the MPIC names on pasemi, rename
    the base one from the somewhat odd " PAS-OPIC  " to "PASEMI-OPIC".
    
    Signed-off-by: Olof Johansson <olof@lixom.net>
    Acked-by: Michael Ellerman <michael@ellerman.id.au>
    Signed-off-by: Paul Mackerras <paulus@samba.org>

commit 194046a17ee2600908541bc9cd5d6d421805f132
Author: Olof Johansson <olof@lixom.net>
Date:   Sat Oct 20 09:49:50 2007 +1000

    [POWERPC] MPIC: Minor optimization of ipi handler
    
    Optimize MPIC IPIs, by passing in the IPI number as the argument to the
    handler, since all we did was translate it back based on which mpic
    the interrupt came though on (and that was always the primary mpic).
    
    Signed-off-by: Olof Johansson <olof@lixom.net>
    Acked-by: Benjamin Herrenschmidt <benh@kernel.crashing.org>
    Signed-off-by: Paul Mackerras <paulus@samba.org>

commit 910b40468a9ce3f2f5d48c5d260329c27d45adb5
Author: Sam Ravnborg <sam@neptun.(none)>
Date:   Fri Oct 19 21:46:01 2007 +0200

    kbuild: introduce cc-cross-prefix
    
    cc-cross-prefix is useful for the architecture that like
    to provide a default CROSS_COMPILE value,
    but may have several to select between.
    
    Sample usage:
    
    ifneq ($(SUBARCH),$(ARCH))
            ifeq ($(CROSS_COMPILE),)
                   CROSS_COMPILE := $(call cc-cross-prefix, m68k-linux-gnu- m68k-linux-)
            endif
    endif
    
    Actual usage by the different archs will taken care of later.
    
    Signed-off-by: Sam Ravnborg <sam@ravnborg.org>

commit 85ad93ad56f4baf52e7c40f2e01c4df8e14d4c9c
Author: Bartlomiej Zolnierkiewicz <bzolnier@gmail.com>
Date:   Fri Oct 19 00:30:12 2007 +0200

    ide: set drive->autotune in ide_pci_setup_ports()
    
    Majority of host drivers using IDE PCI layer set drive->autotune, the only
    exceptions are:
    
    generic.c
    ns87415.c
    rz1000.c
    trm290.c
    * no ->set_pio_mode method
    
    it821x.c:
    * if memory allocation fails drive->autotune won't be set
      (but there also won't be ->set_pio_mode method in such case)
    
    piix.c:
    * MPIIX controller (no ->init_hwif method so also no ->set_pio_mode method)
    
    However if there is no ->set_pio_mode method there are no changes in behavior
    w.r.t. PIO tuning so always set drive->autotune in ide_pci_setup_ports().
    
    Signed-off-by: Bartlomiej Zolnierkiewicz <bzolnier@gmail.com>

commit 3985ee3b4c5f9e1d73623b92715375b089c54353
Author: Bartlomiej Zolnierkiewicz <bzolnier@gmail.com>
Date:   Fri Oct 19 00:30:11 2007 +0200

    ide: add IDE_HFLAG_LEGACY_IRQS host flag
    
    Add IDE_HFLAG_LEGACY_IRQS host flag to tell ide_pci_setup_ports() to set
    hwif->irq to legacy IRQ 14/15 (iff hwif->irq is not already set) and convert
    atiixp, piix, serverworks, sis5513 and slc90e66 host drivers to use it.
    
    While at it:
    
    * In piix.c add IDE_HFLAGS_PIIX define and don't use ->init_hwif for MPIIX.
    
    Acked-by: Sergei Shtylyov <sshtylyov@ru.mvista.com>
    Signed-off-by: Bartlomiej Zolnierkiewicz <bzolnier@gmail.com>

commit fb8dd014220f51dadcbfb91e6d1dfca69d0910a7
Author: Ralf Baechle <ralf@linux-mips.org>
Date:   Wed Oct 17 11:32:21 2007 +0100

    [MIPS] MTX1: Enable CONFIG_CROSSCOMPILE in defconfig.
    
    Signed-off-by: Ralf Baechle <ralf@linux-mips.org>

commit 64f2758514e3bad19cab03d22851ab37654399a4
Author: Olof Johansson <olof@lixom.net>
Date:   Wed Oct 10 10:38:24 2007 +1000

    [POWERPC] Don't enable cpu hotplug on pSeries machines with MPIC
    
    Don't allow cpu hotplug on systems lacking XICS interrupt controller
    (i.e. with an MPIC interrupt controller), since the current pSeries
    platform code is hardcoded for XICS.
    
    This works around the bug reported by Paul Mackerras where the
    disable_nonboot_cpus() call recently added to the shutdown path will
    cause an oops on older pSeries machines.
    
    Signed-off-by: Olof Johansson <olof@lixom.net>
    Signed-off-by: Paul Mackerras <paulus@samba.org>

commit d73ae55ad46be6a0a11b9b71f9910c73c1b9dbb7
Author: Bill Nottingham <notting@redhat.com>
Date:   Fri Jul 27 19:43:17 2007 -0400

    [PATCH] remove gratuitous space in airo module description
    
    Currently the modinfo looks like:
    
    description:    Support for Cisco/Aironet 802.11 wireless ethernet                    cards.  Direct support for ISA/PCI/MPI cards and support               for PCMCIA when used with airo_cs.
    
    Arguably, it should be cut at the end of the first sentence.
    This at least makes it somewhat more legible.
    
    Signed-off-by: Bill Nottingham <notting@redhat.com>
    Signed-off-by: John W. Linville <linville@tuxdriver.com>

commit cccd21027c17c27ad275093c22475354b4495814
Author: Anton Vorontsov <avorontsov@ru.mvista.com>
Date:   Fri Oct 5 21:47:29 2007 +0400

    [POWERPC] QEIC: Implement pluggable handlers, fix MPIC cascading
    
    set_irq_chained_handler overwrites MPIC's handle_irq function
    (handle_fasteoi_irq) thus MPIC never gets eoi event from the
    cascaded IRQ. This situation hangs MPIC on MPC8568E.
    
    To solve this problem efficiently, QEIC needs pluggable handlers,
    specific to the underlaying interrupt controller.
    
    Patch extends qe_ic_init() function to accept low and high interrupt
    handlers. To avoid #ifdefs, stack of interrupt handlers specified in
    the header file and functions are marked 'static inline', thus
    handlers are compiled-in only if actually used (in the board file).
    Another option would be to lookup for parent controller and
    automatically detect handlers (will waste text size because of
    never used handlers, so this option abolished).
    
    qe_ic_init() also changed in regard to support multiplexed high/low
    lines as found in MPC8568E-MDS, plus qe_ic_cascade_muxed_mpic()
    handler implemented appropriately.
    
    Signed-off-by: Anton Vorontsov <avorontsov@ru.mvista.com>
    Acked-by: Benjamin Herrenschmidt <benh@kernel.crashing.org>
    Signed-off-by: Kumar Gala <galak@kernel.crashing.org>

commit ca786f83a97d7897b013b1e9b290c9010b69af9b
Author: Adrian Bunk <bunk@kernel.org>
Date:   Tue Oct 2 13:30:09 2007 -0700

    [POWERPC] Select proper defconfig for crosscompiles
    
    The trick for finding the right defconfig is neat, but you forgot to
    provide an i686_defconfig.  ;-)
    
    More seriously, cross compiling the defconfig is often useful, e.g. for
    testing the compilation of patches that touch multiple architectures,
    and this patch therefore chooses g5_defconfig if $(CROSS_COMPILE) is
    non-empty.
    
    Signed-off-by: Adrian Bunk <bunk@kernel.org>
    Acked-by: Sam Ravnborg <sam@ravnborg.org>
    Cc: Benjamin Herrenschmidt <benh@kernel.crashing.org>
    Cc: Olof Johansson <olof@lixom.net>
    Signed-off-by: Andrew Morton <akpm@linux-foundation.org>
    Signed-off-by: Paul Mackerras <paulus@samba.org>

commit 21ccdd31e9c70f42b00d9ea152f6c4e0ff3f536e
Author: Michael Ellerman <michael@ellerman.id.au>
Date:   Thu Sep 20 16:36:51 2007 +1000

    [POWERPC] Inline u3msi_compose_msi_msg()
    
    In the MPIC U3 MSI code, we call u3msi_compose_msi_msg() once for each MSI.
    This is overkill, as the address is per pci device, not per MSI. So setup
    the address once, and just set the data per MSI.
    
    Signed-off-by: Michael Ellerman <michael@ellerman.id.au>
    Acked-by: Benjamin Herrenschmidt <benh@kernel.crashing.org>
    Signed-off-by: Paul Mackerras <paulus@samba.org>

commit 0d72ba930cbc9140a584af7e4e65041b6c7a7d18
Author: Olof Johansson <olof@lixom.net>
Date:   Sat Sep 8 05:13:19 2007 +1000

    [POWERPC] Add workaround for MPICs with broken register reads
    
    Some versions of PWRficient 1682M have an interrupt controller in which
    the first register in each pair for interrupt sources doesn't always
    read with the right polarity/sense values.
    
    To work around this, keep a software copy of the register instead.  Since
    it's not modified from the mpic itself, it's a feasible solution.  Still,
    keep it under a config option to avoid wasting memory on other platforms.
    
    Signed-off-by: Olof Johansson <olof@lixom.net>
    Signed-off-by: Paul Mackerras <paulus@samba.org>

commit 8ff262df2cf3f7878ba064a10f56c1b42fefa534
Author: Hirokazu Takata <takata@linux-m32r.org>
Date:   Wed Aug 1 20:54:38 2007 +0900

    m32r: Move defconfig files to arch/m32r/configs/
    
    Change defconfig file's location from arch/m32r/{platform}/defconfig*
    to arch/m32r/configs/{platform}_defconfig.
    
    Applying this patch, we can use defconfig file for each m32r platform
    easily, like other architectures.
    
      ex. Setup defconfig for cross-building
        $ make ARCH=m32r CROSS_COMPILE=m32r-linux-gnu- {platform}_defconfig.
    
      platform    defconfig                 Note
     ----------  ----------------------    ---------------------------
      m32104ut    m32104ut_defconfig        MMU-less
      m32700ut    m32700ut.smp_defconfig    SMP
      m32700ut    m32700ut.up_defconfig     UP
      mappi       mappi.smp_defconfig       SMP
      mappi       mappi.up_defconfig        UP
      mappi       mappi.nommu_defconfig     MMU-less
      mappi2      mappi2.opsp_defconfig     FPGA env. (CPU Core: OPSP)
      mappi2      mappi2.vdec2_defconfig    FPGA env. (CPU Core: VDEC2)
      mappi3      imappi3.smp_defconfig     SMP
      oaks32r     oaks32r_defconfig         MMU-less
      opsput      opsput_defconfig          UP
    
    Signed-off-by: Hirokazu Takata <takata@linux-m32r.org>

commit 0de085bb474f64e4fdb2f1ff3268590792648c7b
Merge: 3836df6b520a e58712111fe6
Author: Linus Torvalds <torvalds@woody.linux-foundation.org>
Date:   Tue Jul 24 20:26:25 2007 -0700

    Merge branch 'for_paulus' of master.kernel.org:/pub/scm/linux/kernel/git/galak/powerpc
    
    * 'for_paulus' of master.kernel.org:/pub/scm/linux/kernel/git/galak/powerpc: (25 commits)
      [POWERPC] 85xx: Added needed MPC85xx PCI device IDs
      [POWERPC] Add Freescale PCI VENDOR ID and 8641 device IDs
      [POWERPC] 85xxCDS: MPC8548 DTS cleanup.
      [POWERPC] 85xxCDS: Misc 8548 PCI Corrections.
      [POWERPC] 85xxCDS: Delay 8259 cascade hookup.
      [POWERPC] 85xxCDS: Make sure restart resets the PCI bus.
      [POWERPC] 85xxCDS: Allow 8259 cascade to share an MPIC interrupt line.
      [POWERPC] FSL: Add support for PCI-X controllers
      [POWERPC] Make sure virtual P2P bridge registers are setup on PCIe PHB
      [POWERPC] Provide ability to setup P2P bridge registers from struct resource
      [POWERPC] Add basic PCI/PCI Express support for 8544DS board
      [POWERPC] Make endianess of cfg_addr for indirect pci ops runtime
      [POWERPC] Removed setup_indirect_pci_nomap
      [POWERPC] 85xx: Add quirk to ignore bogus FPGA on CDS
      [POWERPC] 85xx: Added 8568 PCIe support
      [POWERPC] Fixup resources on pci_bus for PCIe PHB when no device is connected
      [POWERPC] Add basic PCI node for mpc8568mds board
      [POWERPC] Use Freescale pci/pcie common code for 85xx boards
      [POWERPC] Update PCI nodes in the 83xx/85xx boards device tree
      [POWERPC] Add 8548 CDS PCI express controller node and PCI-X device node
      ...

commit 3620fc1da28ad32d10d7c83eab33f48ec5b1da54
Author: Randy Vinson <rvinson@mvista.com>
Date:   Wed Jun 6 16:26:15 2007 -0700

    [POWERPC] 85xxCDS: Allow 8259 cascade to share an MPIC interrupt line.
    
    The Freescale MPC8555CDS and MPC8548CDS reference hardware has a legacy
    8259 interrupt controller pair contained within a VIA VT82C686B Southbridge
    on the main carrier board. The processor complex plugs into the carrier
    card using a PCI slot which limits the available interrupts to the
    INTA-INTD PCI interrupts. The output of the 8259 cascade pair is routed
    through a gate array and connected to the PCI INTA interrupt line.
    The normal interrupt chaining hook (set_irq_chained_handler) does
    not allow sharing of the chained interrupt which prevents the
    use of PCI INTA by PCI devices. This patch allows the 8259 cascade
    pair to share their interrupt line with PCI devices.
    
    NOTE: The addition of the .end routine for the MPIC is not strictly
    necessary for this patch. It's there so this code will run from within
    the threaded interrupt context used by the Real Time patch.
    
    Signed-off-by: Randy Vinson <rvinson@mvista.com>
    Signed-off-by: Kumar Gala <galak@kernel.crashing.org>

commit dc79747019b43c28d1f50aad69b8039f8d8db301
Merge: 0f760f130123 7bd02a20d5fc
Author: Linus Torvalds <torvalds@woody.linux-foundation.org>
Date:   Sun Jul 22 11:17:35 2007 -0700

    Merge branch 'merge' of git://git.kernel.org/pub/scm/linux/kernel/git/paulus/powerpc
    
    * 'merge' of git://git.kernel.org/pub/scm/linux/kernel/git/paulus/powerpc:
      [POWERPC] Clean up duplicate includes in drivers/macintosh/
      [POWERPC] Quiet section mismatch warning on pcibios_setup
      [POWERPC] init and exit markings for hvc_iseries
      [POWERPC] Quiet section mismatch in hvc_rtas.c
      [POWERPC] Constify of_platform_driver match_table
      [POWERPC] hvcs: Make some things static and const
      [POWERPC] Constify of_platform_driver name
      [POWERPC] MPIC protected sources
      [POWERPC] of_detach_node()'s device node argument cannot be const
      [POWERPC] Fix ARCH=ppc builds
      [POWERPC] mv64x60: Use mutex instead of semaphore
      [POWERPC] Allow smp_call_function_single() to current cpu
      [POWERPC] Allow exec faults on readable areas on classic 32-bit PowerPC
      [POWERPC] Fix future firmware feature fixups function failure
      [POWERPC] fix showing xmon help
      [POWERPC] Make xmon_write accept a const buffer
      [POWERPC] Fix misspelled "CONFIG_CHECK_CACHE_COHERENCY" Kconfig option.
      [POWERPC] cell: CONFIG_SPE_BASE is a typo

commit 7fd7218610600b16f6f0af3f9d9353ba0265c09f
Author: Benjamin Herrenschmidt <benh@kernel.crashing.org>
Date:   Sat Jul 21 09:55:21 2007 +1000

    [POWERPC] MPIC protected sources
    
    Some HW platforms, such as the new cell blades, requires some MPIC sources
    to be left alone by the operating system. This implements support for
    a "protected-sources" property in the mpic controller node containing a list
    of source numbers to be protected against operating system interference.
    
    For those interested in the gory details, the MPIC on the southbridge of
    those blades has some of the processor outputs routed to the cell, and
    at least one routed as a GPIO to the service processor. It will be used
    in the GA product for routing some of the southbridge error interrupts
    to the service processor which implements some of the RAS stuff, such
    as checkstopping when fatal errors occurs before they can propagate.
    
    Signed-off-by: Benjamin Herrenschmidt <benh@kernel.crashing.org>
    Acked-by: Arnd Bergmann <arnd.bergmann@de.ibm.com>
    Signed-off-by: Paul Mackerras <paulus@samba.org>

commit ce21b3c9648ae55181787bf25ee00cf91dfd5c91
Author: Michael Ellerman <michael@ellerman.id.au>
Date:   Fri Jul 20 21:39:28 2007 +0200

    [CELL] add support for MSI on Axon-based Cell systems
    
    This patch adds support for the setup and decoding of MSIs
    on Axon-based Cell systems, using the MSIC mechanism.
    
    This involves setting up an area of BE memory which the Axon
    then uses as a FIFO for MSI messages. When one or more MSIs
    are decoded by the MSIC we receive an interrupt on the MPIC,
    and the MSI messages are written into the FIFO. At the moment
    we use a 64KB FIFO, one per MSIC/BE.
    
    Signed-off-by: Michael Ellerman <michael@ellerman.id.au>
    Signed-off-by: Arnd Bergmann <arnd.bergmann@de.ibm.com>

commit edb9068d0d7a3ba92f66b8c86cba625f3a439f64
Author: Prakash, Sathya <sathya.prakash@lsi.com>
Date:   Tue Jul 17 14:39:14 2007 +0530

    [SCSI] mpt fusion: add sysfs attributes to display IOC parameters
    
    New sysfs scsi_host attributes are added to provide information about Firmware
    version, BIOS version, MPI version and other product related information
    
    signed-off-by: Sathya Praksh <sathya.prakash@lsi.com>
    Acked-by: "Moore, Eric" <Eric.Moore@lsi.com>
    Signed-off-by: James Bottomley <James.Bottomley@SteelEye.com>

commit 37a7e9b7f28fbef4b6abda102fa41c1467f6022f
Author: Ralph Campbell <ralph.campbell@qlogic.com>
Date:   Fri Jul 6 12:48:38 2007 -0700

    IB/ipath: Lower default number of kernel send buffers
    
    The default calculation for the number of send buffers to allocate to
    the kernel was too high for the PCIe version of the chip thus leaving
    fewer than desired send buffers for user MPI applications.
    
    Signed-off-by: Ralph Campbell <ralph.campbell@qlogic.com>
    Signed-off-by: Roland Dreier <rolandd@cisco.com>

commit e58ca3de64927e96beb2f1594975dc4a29b79459
Author: David Gibson <david@gibson.dropbear.id.au>
Date:   Wed Jun 13 14:53:00 2007 +1000

    [POWERPC] Fix problems with device tree representation of TSI-1xx bridges
    
    This fixes some problems with the way the some things
    represented in the device tree for the Holly and Taiga boards.  This
    means changes both to the dts files, and to the code which
    instantiates the tsi108 ethernet platform devices based on the device
    tree.
    
            - First, and most importantly, the ethernet PHYs are given
    with an identical 'reg' property.  This reg currently encodes the
    accessible register used to initiate mdio interaction with the PHYs,
    rather than a meaningful address on the parent bus (mdio in this
    case), which is incorrect.  Instead we give the address of these
    registers as 'reg' in the mdio node itself, and encode the ID of each
    phy in their 'reg' propertyies.
            - Currently the platform device constructor enables a
    workaround in the tsi108 ethernet driver based on the compatible
    property of the PHY.  This is incorrect, because the workaround in
    question is necessary due to the board's wiring of the PHY, not the
    model of PHY itself.  This patch alters the constructor to instead
    enable the workaround based on a new special property in the PHY node.
            - The compatible properties on a number of nodes in the device
    tree are insufficiently precise.  In particular the PHYs give only
    "bcm54xx", which is broken, since there are many bcm54xx PHY models,
    and they have differences which matter.  The mdio had a compatible
    property of "tsi-ethernet" identical to the ethernet MAC nodes, which
    doesn't make sense.  The ethernet, i2c, bridge and PCI nodes were
    given only as "tsi-*" which is somewhat inprecise, we replace with
    "tsi108-*" in the case of Taiga (which has a TSI108 bridge), and
    "tsi109-*", "tsi108-*" in the case of Holly (which has a TSI109
    bridge).
            - We remove some "model" properties from the ethernets on
    Taiga board which were neither useful nor adequately precise.
            - On Holly we change to using a dtc label instead of a full
    path to reference the MPIC node, which makes the dts a little more
    readable.
    
    Signed-off-by: David Gibson <david@gibson.dropbear.id.au>
    Signed-off-by: Paul Mackerras <paulus@samba.org>

commit ec56dc0b7f6c3fec20bbc2e98ff1a06edf2fc9b9
Author: Michael S. Tsirkin <mst@dev.mellanox.co.il>
Date:   Mon May 28 14:37:27 2007 +0300

    IPoIB/cm: Fix performance regression on Mellanox
    
    commit 518b1646 ("IPoIB/cm: Fix SRQ WR leak") introduced a severe
    performance regression on Mellanox cards, because keeping a QP in the
    error state for extended periods of time moves hardware to the slow
    path (until the QP is destroyed).  For example, MPI latency goes from
    ~3 usecs to ~7 usecs.
    
    Fix this by posting a send WR on one of the QPs that are being
    flushed, instead of using a separate drain QP that is kept in the
    error state.
    
    This fixes bug <https://bugs.openfabrics.org/show_bug.cgi?id=636>,
    reported and bisected by Scott Weitzenkamp at Cisco and debugged by
    Sasha Mikheev at Voltaire.
    
    Signed-off-by: Michael S. Tsirkin <mst@dev.mellanox.co.il>
    Signed-off-by: Roland Dreier <rolandd@cisco.com>

commit df6d3916f3b7b7e2067567a256dd4f0c1ea854a2
Merge: 74add80cbd7f 197686dfe003
Author: Linus Torvalds <torvalds@woody.linux-foundation.org>
Date:   Tue May 8 11:50:19 2007 -0700

    Merge branch 'master' of git://git.kernel.org/pub/scm/linux/kernel/git/paulus/powerpc
    
    * 'master' of git://git.kernel.org/pub/scm/linux/kernel/git/paulus/powerpc: (77 commits)
      [POWERPC] Abolish powerpc_flash_init()
      [POWERPC] Early serial debug support for PPC44x
      [POWERPC] Support for the Ebony 440GP reference board in arch/powerpc
      [POWERPC] Add device tree for Ebony
      [POWERPC] Add powerpc/platforms/44x, disable platforms/4xx for now
      [POWERPC] MPIC U3/U4 MSI backend
      [POWERPC] MPIC MSI allocator
      [POWERPC] Enable MSI mappings for MPIC
      [POWERPC] Tell Phyp we support MSI
      [POWERPC] RTAS MSI implementation
      [POWERPC] PowerPC MSI infrastructure
      [POWERPC] Rip out the existing powerpc msi stubs
      [POWERPC] Remove use of 4level-fixup.h for ppc32
      [POWERPC] Add powerpc PCI-E reset API implementation
      [POWERPC] Holly bootwrapper
      [POWERPC] Holly DTS
      [POWERPC] Holly defconfig
      [POWERPC] Add support for 750CL Holly board
      [POWERPC] Generalize tsi108 PCI setup
      [POWERPC] Generalize tsi108 PHY types
      ...
    
    Fixed conflict in include/asm-powerpc/kdebug.h manually
    
    Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>

commit 05af7bd2d75e5098021864d83fbb831111755fa0
Author: Michael Ellerman <michael@ellerman.id.au>
Date:   Tue May 8 12:58:37 2007 +1000

    [POWERPC] MPIC U3/U4 MSI backend
    
    MPIC U3/U4 MSI backend. Based on code from Segher, heavily hacked by me.
    This only deals with MSI on U3/U4 MPICs, aka. CPC 9x5.
    
    If we find a U3/U4 then we enable this backend, ie. take over the ppc_md
    MSI hooks. We might need more elaborate logic in future to decide which
    backend is enabled.
    
    We need our own irq_chip so that we can do MSI masking/unmasking on
    the device itself. We also need to mask explicitly on shutdown to make
    sure we don't get bitten by lazy-disable semantics.
    
    Signed-off-by: Michael Ellerman <michael@ellerman.id.au>
    Signed-off-by: Paul Mackerras <paulus@samba.org>

commit a7de7c74227edda719b257eb15aecd73790ff894
Author: Michael Ellerman <michael@ellerman.id.au>
Date:   Tue May 8 12:58:36 2007 +1000

    [POWERPC] MPIC MSI allocator
    
    To support MSI on MPIC we need a way to reserve and allocate hardware irq
    numbers, this patch implements an allocator for that purpose.
    
    New firmware platforms must define a "msi-available-ranges" property on their
    MPIC node for MSI to work. For U3/U4 we do a best-guess setup.
    
    Signed-off-by: Michael Ellerman <michael@ellerman.id.au>
    Signed-off-by: Paul Mackerras <paulus@samba.org>

commit 812fd1fd63caf2d72906603ebb9c6049a19ef4d2
Author: Michael Ellerman <michael@ellerman.id.au>
Date:   Tue May 8 12:58:36 2007 +1000

    [POWERPC] Enable MSI mappings for MPIC
    
    On some Apple machines the HT MSI mappings are not enabled by firmware, so
    we need to do it by hand.
    
    We can't use the pci routines as this code runs too early.
    
    Signed-off-by: Michael Ellerman <michael@ellerman.id.au>
    Signed-off-by: Paul Mackerras <paulus@samba.org>

commit 3669e930481d6dd510718279cd4bacb15ca3ae91
Author: Johannes Berg <johannes@sipsolutions.net>
Date:   Wed May 2 16:33:41 2007 +1000

    [POWERPC] MPIC sys_device & suspend/resume
    
    This adds mpic to the system devices and implements suspend
    and resume for them.  This is necessary to get interrupts for
    modules back to where they were before a suspend to disk.
    
    Signed-off-by: Johannes Berg <johannes@sipsolutions.net>
    Acked-by: Benjamin Herrenschmidt <benh@kernel.crashing.org>
    Signed-off-by: Paul Mackerras <paulus@samba.org>

commit 15700770ef7c5d12e2f1659d2ddbeb3f658d9f37
Merge: 6de410c2b0cc 11de39e2fbbc
Author: Linus Torvalds <torvalds@woody.linux-foundation.org>
Date:   Sun May 6 13:21:57 2007 -0700

    Merge git://git.kernel.org/pub/scm/linux/kernel/git/sam/kbuild
    
    * git://git.kernel.org/pub/scm/linux/kernel/git/sam/kbuild: (38 commits)
      kconfig: fix mconf segmentation fault
      kbuild: enable use of code from a different dir
      kconfig: error out if recursive dependencies are found
      kbuild: scripts/basic/fixdep segfault on pathological string-o-death
      kconfig: correct minor typo in Kconfig warning message.
      kconfig: fix path to modules.txt in Kconfig help
      usr/Kconfig: fix typo
      kernel-doc: alphabetically-sorted entries in index.html of 'htmldocs'
      kbuild: be more explicit on missing .config file
      kbuild: clarify the creation of the LOCALVERSION_AUTO string.
      kbuild: propagate errors from find in scripts/gen_initramfs_list.sh
      kconfig: refer to qt3 if we cannot find qt libraries
      kbuild: handle compressed cpio initramfs-es
      kbuild: ignore section mismatch warning for references from .paravirtprobe to .init.text
      kbuild: remove stale comment in modpost.c
      kbuild/mkuboot.sh: allow spaces in CROSS_COMPILE
      kbuild: fix make mrproper for Documentation/DocBook/man
      kbuild: remove kconfig binaries during make mrproper
      kconfig/menuconfig: do not hardcode '.config'
      kbuild: override build timestamp & version
      ...

commit ec0203e75360638237299b78a7b0d343301075b3
Author: Geert Uytterhoeven <geert@linux-m68k.org>
Date:   Tue May 1 22:32:40 2007 +0200

    m68k: CROSS_COMPILE = m68k-linux-gnu-
    
    Recent cross-compilers are called m68k-linux-gnu-gcc instead of m68k-linux-gcc
    
    Signed-off-by: Geert Uytterhoeven <geert@linux-m68k.org>
    Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>

commit f03e1666d6164da6f098dc1a2e539eced3e4461a
Author: Uwe kleine-Knig <ukleinek@informatik.uni-freiburg.de>
Date:   Wed Mar 28 16:55:55 2007 +0200

    kbuild/mkuboot.sh: allow spaces in CROSS_COMPILE
    
    I'm currently using CROSS_COMPILE="ccache arm-linux-".  With that the bash
    builtin command "type" searches for ccache and arm-linux-mkimage and so sets
    MKIMAGE="/path/to/ccache" as I don't have arm-linux-mkimage.  Then the script
    dies with an error, that ccache doesn't support the argument -A.
    
    This patch adds some quoting such that it works again for me.
    
    Please note that this patch doesn't help you if you use ${CROSSCOMPILE}-mkimage
    and ccache as mkuboot.sh now searches for the command
    "ccache arm-linux-mkimage".
    
    Signed-off-by: Uwe Kleine-Knig <ukleinek@informatik.uni-freiburg.de>
    Signed-off-by: Sam Ravnborg <sam@ravnborg.org>

commit e073ae1b34d5600ffc550407625dcb2d4cf46c6e
Author: Ravikiran G Thirumalai <kiran@scalex86.org>
Date:   Wed May 2 19:27:08 2007 +0200

    [PATCH] x86-64: Set HASHDIST_DEFAULT to 1 for x86_64 NUMA
    
    Enable system hashtable memory to be distributed among nodes on x86_64 NUMA
    
    Forcing the kernel to use node interleaved vmalloc instead of bootmem for
    the system hashtable memory (alloc_large_system_hash) reduces the memory
    imbalance on node 0 by around 40MB on a 8 node x86_64 NUMA box:
    
    Before the following patch, on bootup of a 8 node box:
    
    Node 0 MemTotal:      3407488 kB
    Node 0 MemFree:       3206296 kB
    Node 0 MemUsed:        201192 kB
    Node 0 Active:           7012 kB
    Node 0 Inactive:          512 kB
    Node 0 Dirty:               0 kB
    Node 0 Writeback:           0 kB
    Node 0 FilePages:        1912 kB
    Node 0 Mapped:            420 kB
    Node 0 AnonPages:        5612 kB
    Node 0 PageTables:        468 kB
    Node 0 NFS_Unstable:        0 kB
    Node 0 Bounce:              0 kB
    Node 0 Slab:             5408 kB
    Node 0 SReclaimable:      644 kB
    Node 0 SUnreclaim:       4764 kB
    
    After the patch (or using hashdist=1 on the kernel command line):
    
    Node 0 MemTotal:      3407488 kB
    Node 0 MemFree:       3247608 kB
    Node 0 MemUsed:        159880 kB
    Node 0 Active:           3012 kB
    Node 0 Inactive:          616 kB
    Node 0 Dirty:               0 kB
    Node 0 Writeback:           0 kB
    Node 0 FilePages:        2424 kB
    Node 0 Mapped:            380 kB
    Node 0 AnonPages:        1200 kB
    Node 0 PageTables:        396 kB
    Node 0 NFS_Unstable:        0 kB
    Node 0 Bounce:              0 kB
    Node 0 Slab:             6304 kB
    Node 0 SReclaimable:     1596 kB
    Node 0 SUnreclaim:       4708 kB
    
    I guess it is a good idea to keep HASHDIST_DEFAULT "on" for x86_64 NUMA
    since x86_64 has no dearth of vmalloc space?  Or maybe enable hash
    distribution for all 64bit NUMA arches?  The following patch does it only
    for x86_64.
    
    I ran a HPC MPI benchmark -- 'Ansys wingsolid', which takes up quite a bit of
    memory and uses up tlb entries.  This was on a 4 way, 2 socket
    Tyan AMD box (non vsmp), with 8G total memory (4G pernode).
    
    The results with and without hash distribution are:
    
    1. Vanilla - runtime of 1188.000s
    2. With hashdist=1 runtime of 1154.000s
    
    Oprofile output for the duration of run is:
    
    1. Vanilla:
    PU: AMD64 processors, speed 2411.16 MHz (estimated)
    Counted L1_AND_L2_DTLB_MISSES events (L1 and L2 DTLB misses) with a unit
    mask of 0x00 (No unit mask) count 500
    samples  %        app name                 symbol name
    163054    6.5513  libansys1.so             MultiFront::decompose(int, int,
    Elemset *, int *, int, int, int)
    162061    6.5114  libansys3.so             blockSaxpy6L_fd
    162042    6.5107  libansys3.so             blockInnerProduct6L_fd
    156286    6.2794  libansys3.so             maxb33_
    87879     3.5309  libansys1.so             elmatrixmultpcg_
    84857     3.4095  libansys4.so             saxpy_pcg
    58637     2.3560  libansys4.so             .st4560
    46612     1.8728  libansys4.so             .st4282
    43043     1.7294  vmlinux-t                copy_user_generic_string
    41326     1.6604  libansys3.so             blockSaxpyBackSolve6L_fd
    41288     1.6589  libansys3.so             blockInnerProductBackSolve6L_fd
    
    2. With hashdist=1
    CPU: AMD64 processors, speed 2411.13 MHz (estimated)
    Counted L1_AND_L2_DTLB_MISSES events (L1 and L2 DTLB misses) with a unit
    mask of 0x00 (No unit mask) count 500
    samples  %        app name                 symbol name
    162993    6.9814  libansys1.so             MultiFront::decompose(int, int,
    Elemset *, int *, int, int, int)
    160799    6.8874  libansys3.so             blockInnerProduct6L_fd
    160459    6.8729  libansys3.so             blockSaxpy6L_fd
    156018    6.6826  libansys3.so             maxb33_
    84700     3.6279  libansys4.so             saxpy_pcg
    83434     3.5737  libansys1.so             elmatrixmultpcg_
    58074     2.4875  libansys4.so             .st4560
    46000     1.9703  libansys4.so             .st4282
    41166     1.7632  libansys3.so             blockSaxpyBackSolve6L_fd
    41033     1.7575  libansys3.so             blockInnerProductBackSolve6L_fd
    35762     1.5318  libansys1.so             inner_product_sub
    35591     1.5245  libansys1.so             inner_product_sub2
    28259     1.2104  libansys4.so             addVectors
    
    Signed-off-by: Pravin B. Shelar <pravin.shelar@calsoftinc.com>
    Signed-off-by: Ravikiran Thirumalai <kiran@scalex86.org>
    Signed-off-by: Shai Fultheim <shai@scalex86.org>
    Signed-off-by: Andi Kleen <ak@suse.de>
    Acked-by: Christoph Lameter <clameter@engr.sgi.com>
    Cc: Andi Kleen <ak@suse.de>
    Signed-off-by: Andrew Morton <akpm@linux-foundation.org>

commit 5cddd2e355d0df400782dae80722945c8197b1c5
Author: Josh Boyer <jwboyer@linux.vnet.ibm.com>
Date:   Tue May 1 06:38:11 2007 +1000

    [POWERPC] Fix spurious vectors on weird MPIC
    
    The weird TSI 10x MPIC needs an EOI after getting a spurious vector.  This
    patch uses the existing MPIC_SPV_EOI flag to fix this issue.
    
    Signed-off-by: Josh Boyer <jwboyer@linux.vnet.ibm.com>
    Signed-off-by: Paul Mackerras <paulus@samba.org>

commit 9ba6d5529dd919b442eedf5bef1dd28aca2ee9fe
Author: Michael S. Tsirkin <mst@mellanox.co.il>
Date:   Thu Apr 12 18:10:25 2007 +0300

    IB/mthca: Work around kernel QP starvation
    
    With mthca, RC QPs can starve each other and even UD QPs on the same
    hardware schedule queue.  As a result, userspace MPI can starve
    e.g. IPoIB traffic, with netdev watchdog warnings getting printed out,
    and TCP connections getting stuck or failing.
    
    Reduce the chance of this happening by using three separate hardware
    schedule queues: one for userspace RC QPs, one for kernel RC QPs, and
    one for all other QPs.
    
    Signed-off-by: Michael S. Tsirkin <mst@dev.mellanox.co.il>
    Signed-off-by: Roland Dreier <rolandd@cisco.com>

commit 6cfef5b27e49e826125f12637ee0d7210a896044
Author: Michael Ellerman <michael@ellerman.id.au>
Date:   Mon Apr 23 18:47:08 2007 +1000

    [POWERPC] Rename MPIC_BROKEN_U3 to MPIC_U3_HT_IRQS
    
    Rename MPIC_BROKEN_U3 to something a little more descriptive. Its
    effect is to enable support for HT irqs behind the PCI-X/HT bridge on
    U3/U4 (aka. CPC9x5) parts.
    
    Signed-off-by: Michael Ellerman <michael@ellerman.id.au>
    Signed-off-by: Paul Mackerras <paulus@samba.org>

commit 7e8bddf56661a16b7d5945390a37cd2e9c5e45fe
Author: Olof Johansson <olof@lixom.net>
Date:   Mon Apr 16 16:28:38 2007 +1000

    [POWERPC] pasemi: Reset mpic on boot
    
    Reset MPIC on boot to clear some timer state that firmware might
    leave configured.
    
    Signed-off-by: Olof Johansson <olof@lixom.net>
    Signed-off-by: Paul Mackerras <paulus@samba.org>

commit 087d7ecd5273b480d13f4309a159842700afe276
Author: Johannes Berg <johannes@sipsolutions.net>
Date:   Mon Feb 12 16:20:18 2007 +0100

    [POWERPC] mpic: set IPIs to be per-CPU
    
    This patch changes the MPIC IPIs to be per-CPU to avoid getting a
    warning ("Cannot set affinity for irq 251") when taking a CPU
    offline via sysfs or during suspend.
    
    Signed-off-by: Johannes Berg <johannes@sipsolutions.net>
    Signed-off-by: Paul Mackerras <paulus@samba.org>

commit 8c7e4498adfdb4aea5a0d056590ec18d099ba062
Author: Mike Frysinger <vapier.adi@gmail.com>
Date:   Wed Feb 14 00:32:54 2007 -0800

    [PATCH] search a little harder for mkimage
    
    Check to see if `${CROSS_COMPILE}mkimage` exists and if not, fall back to
    the standard `mkimage`
    
    The Blackfin toolchain includes mkimage, but we dont want to namespace
    collide with any of the user's system setup, so we prefix it with our
    toolchain name.
    
    Signed-off-by: Mike Frysinger <vapier@gentoo.org>
    Cc: Sam Ravnborg <sam@ravnborg.org>
    Cc: Oleg Verych <olecom@flower.upol.cz>
    Signed-off-by: Andrew Morton <akpm@linux-foundation.org>
    Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>

commit f90203e0cf0d5a8b027d511af318bb3db4758fe2
Merge: 33e563c1190c 719c91ccadd3
Author: Linus Torvalds <torvalds@woody.linux-foundation.org>
Date:   Tue Feb 13 17:34:23 2007 -0800

    Merge master.kernel.org:/pub/scm/linux/kernel/git/paulus/powerpc
    
    * master.kernel.org:/pub/scm/linux/kernel/git/paulus/powerpc: (61 commits)
      [POWERPC] Use udbg_early_init() on ppc32
      [POWERPC] Open Firmware serial port driver
      [POWERPC] Move MPIC smp routines into mpic.c
      [POWERPC] Cleanup pseries kexec code
      [POWERPC] Cleanup pseries smp initialisation code
      [POWERPC] Consolidate pseries platform header files into pseries.h
      [POWERPC] 85xx: Drop use of SYNC macro in head_fsl_booke.S
      [POWERPC] cell: pm_rtas_activat_signals routine cleanup
      [POWERPC] cell: PPU Oprofile cleanup patch
      [POWERPC] spufs: avoid accessing kernel memory through mmapped /mem node
      [POWERPC] spu sched: static timeslicing for SCHED_RR contexts
      [POWERPC] spu sched: use DECLARE_BITMAP
      [POWERPC] spu sched: forced preemption at execution
      [POWERPC] spu sched: update some comments
      [POWERPC] spu sched: simplity spu_remove_from_active_list
      [POWERPC] spufs: optimize spu_run
      [POWERPC] spufs: runqueue simplification
      [POWERPC] spufs: move prio to spu_context
      [POWERPC] spufs: state_mutex cleanup
      [POWERPC] spufs: simplify state_mutex
      ...

commit 775aeff44774c6933d8f9c14e1f325d8acd03136
Author: Michael Ellerman <michael@ellerman.id.au>
Date:   Thu Feb 8 18:34:04 2007 +1100

    [POWERPC] Move MPIC smp routines into mpic.c
    
    Move a couple of MPIC smp routines into mpic.c, they're inside an SMP
    block in mpic.c - so they're still only built for SMP.
    
    Signed-off-by: Michael Ellerman <michael@ellerman.id.au>
    Signed-off-by: Paul Mackerras <paulus@samba.org>

commit 92ae78493f5f3de323652f3ea0ec8b7b2839c3d2
Author: Sergei Shtylyov <sshtylyov@ru.mvista.com>
Date:   Mon Feb 5 21:08:55 2007 +0300

    (2.6.20) pata_mpiix: probing cleanup (resend)
    
    MPIIX has only single channel IDE which can be configured for either primary or
    secondary legacy I/O ports and IRQ.  So, get rid of the unneeded second probe
    entry in mpiix_init_one() and of the invalid (but unused anyway) enable bits in
    mpiix_pre_reset().
    
    Warning: this cleanup has only been compile-tested...
    
    Signed-off-by: Sergei Shtylyov <sshtylyov@ru.mvista.com>
    Signed-off-by: Jeff Garzik <jeff@garzik.org>

commit d2872239737ad6394b49c7c9ce9ae8d0f07165e5
Author: Sergei Shtylyov <sshtylyov@ru.mvista.com>
Date:   Wed Feb 7 18:18:25 2007 +0100

    piix: fix 82371MX enablebits
    
    According to the datasheet, Intel 82371MX (MPIIX) actually has only a
    single IDE channel mapped to the primary or secondary ports depending on
    the value of the bit 14 of the IDETIM register at PCI config.  offset 0x6C
    (the register at 0x6F which the driver refers to.  doesn't exist).  So,
    disguise the controller as dual channel and set enablebits masks/values
    such that only either primary or secondary channel is detected enabled.
    Also, preclude the IDE probing code from reading PCI BARs, this controller
    just doesn't have them (it's not the separate PCI function like the other
    PCI controllers), it only decodes the legacy addresses.
    
    [ Alan sayeth " MPIIX does not work with or without the change.  It needs its
      own different driver and not to use setup-pci.  Huge job and since it works
      well with libata who cares.  Ditto the early PIIX chip." ]
    
    Signed-off-by: Sergei Shtylyov <sshtylyov@ru.mvista.com>
    Cc: Alan Cox <alan@lxorguk.ukuu.org.uk>
    Signed-off-by: Andrew Morton <akpm@osdl.org>
    Signed-off-by: Bartlomiej Zolnierkiewicz <bzolnier@gmail.com>

commit 7df2457db83bc922fcc8b462526b77f1ffe8c84b
Author: Olof Johansson <olof@lixom.net>
Date:   Sun Jan 28 23:33:18 2007 -0600

    [POWERPC] MPIC: support more than 256 sources
    
    Allow more than the default 256 MPIC sources. Allocates a new flag
    (MPIC_LARGE_VECTORS) to be used by platform code when instantiating
    the mpic.
    
    I picked 11 bits worth right now since it would cover the number of
    sources on any hardware I have seen. It can always be increased later
    if needed.
    
    Signed-off-by: Olof Johansson <olof@lixom.net>
    Signed-off-by: Paul Mackerras <paulus@samba.org>

commit 365bbe0d0caaf2ba74d56556827babf0bc66965d
Merge: 0bf98542a07e 3ef49a3b45c3
Author: Linus Torvalds <torvalds@woody.linux-foundation.org>
Date:   Mon Jan 22 10:35:34 2007 -0800

    Merge master.kernel.org:/pub/scm/linux/kernel/git/jejb/scsi-rc-fixes-2.6
    
    * master.kernel.org:/pub/scm/linux/kernel/git/jejb/scsi-rc-fixes-2.6: (30 commits)
      [SCSI] qla1280: set residual correctly
      [SCSI] fusion: bump version
      [SCSI] fusion: MODULE_VERSION support
      [SCSI] fusion: power pc and miscellaneous bug fixs
      [SCSI] fusion: fibre channel: return DID_ERROR for MPI_IOCSTATUS_SCSI_IOC_TERMINATED
      [SCSI] megaraid_sas: Update module author
      [SCSI] 3ware 8000 serialize reset code
      [SCSI] sr: fix error code check in sr_block_ioctl()
      [SCSI] scsi: lpfc error path fix
      [SCSI] aacraid: Product List Update
      [SCSI] libiscsi: fix senselen calculation
      [SCSI] iscsi: simplify IPv6 and IPv4 address printing
      [SCSI] iscsi: newline in printk
      [SCSI] iscsi: fix crypto_alloc_hash() error check
      [SCSI] iscsi: fix 2.6.19 data digest calculation bug
      [SCSI] scsi_scan: fix report lun problems with CDROM or RBC devices
      [SCSI] qla2xxx: Update version number to 8.01.07-k4.
      [SCSI] qla2xxx: Use generic isp_ops.fw_dump() function.
      [SCSI] qla2xxx: Perform a fw-dump when an ISP23xx RISC-paused state is detected.
      [SCSI] qla2xxx: Correct reset handling logic.
      ...

commit 86dd424266530cda55258b2b33d04c23a88b9a9c
Author: Eric Moore <eric.moore@lsil.com>
Date:   Thu Jan 4 20:44:01 2007 -0700

    [SCSI] fusion: fibre channel: return DID_ERROR for MPI_IOCSTATUS_SCSI_IOC_TERMINATED
    
    A repost of a patch forwarded by Mikael Reed from 2006-12-20.
    
    The fibre channel IOC may kill a request for a variety of
    reasons, some of which may be recovered by a retry, some of
    which are unlikely to be recovered.  Return DID_ERROR
    instead of DID_RESET to permit retry of the command,
    just not an infinite number of them.
    
    Signed-off-by: Michael Reed <mdr@sgi.com>
    Signed-off-by: Eric Moore <Eric.Moore@lsi.com>
    Signed-off-by: James Bottomley <James.Bottomley@SteelEye.com>

commit 21fb5a1d9f554970c680b801ba32184bc7c34aa0
Author: Benjamin Herrenschmidt <benh@kernel.crashing.org>
Date:   Sat Nov 11 17:24:58 2006 +1100

    [POWERPC] Native cell support for MPIC in southbridge
    
    Add support for southbridges using the MPIC interrupt controller to
    the native cell platforms.
    
    Signed-off-by: Benjamin Herrenschmidt <benh@kernel.crashing.org>
    Signed-off-by: Paul Mackerras <paulus@samba.org>

commit a959ff56bbf07954ea4fa1cf72f99a38795eadb3
Author: Benjamin Herrenschmidt <benh@kernel.crashing.org>
Date:   Sat Nov 11 17:24:56 2006 +1100

    [POWERPC] Improve MPIC driver auto-configuration from DT
    
    This patch applies on top of the MPIC DCR support. It makes the MPIC
    driver capable of a lot more auto-configuration based on the device-tree,
    for example, it can retreive it's own physical address if not passed as
    an argument, find out if it's DCR or MMIO mapped, and set the BIG_ENDIAN
    flag automatically in the presence of a "big-endian" property in the
    device-tree node.
    
    Signed-off-by: Benjamin Herrenschmidt <benh@kernel.crashing.org>
    Signed-off-by: Paul Mackerras <paulus@samba.org>

commit fbf0274e43b7e17ee740fee2d693932be093d56d
Author: Benjamin Herrenschmidt <benh@kernel.crashing.org>
Date:   Sat Nov 11 17:24:55 2006 +1100

    [POWERPC] Support for DCR based MPIC
    
    This patch implements support for DCR based MPIC implementations. Such
    implementations have the MPIC_USES_DCR flag set and don't use the phys_addr
    argument of mpic_alloc (they require a valid dcr mapping in the device node)
    
    This version of the patch can use a little bif of cleanup still (I can
    probably consolidate rb->dbase/doff, at least once I'm sure on how the
    hardware is actually supposed to work vs. possible simulator issues) and
    it should be possible to build a DCR-only version of the driver. I need
    to cleanup a bit the CONFIG_* handling for that and probably introduce
    CONFIG_MPIC_MMIO and CONFIG_MPIC_DCR.
    
    Signed-off-by: Benjamin Herrenschmidt <benh@kernel.crashing.org>
    Signed-off-by: Paul Mackerras <paulus@samba.org>

commit 3c693024cffa5c96a20b969f4efd058675e7700f
Merge: 107c3a73e0ee 10270613fb4d
Author: Linus Torvalds <torvalds@g5.osdl.org>
Date:   Tue Oct 10 16:16:33 2006 -0700

    Merge branch 'merge' of git://git.kernel.org/pub/scm/linux/kernel/git/paulus/powerpc
    
    * 'merge' of git://git.kernel.org/pub/scm/linux/kernel/git/paulus/powerpc:
      [POWERPC] Fix windfarm platform device usage
      [POWERPC] Fix i2c-powermac platform device usage
      [POWERPC] Fix secondary CPU startup on old "powersurge" SMP powermacs
      [POWERPC] ARCH=ppc pt_regs fixes
      [POWERPC] Update maple defconfig
      [POWERPC] Fix Maple secondary IDE interrupt
      [POWERPC] Make U4 PCIe work on maple
      [POWERPC] cell: fix default zImage build target
      [POWERPC] Fix boot wrapper invocation if CROSS_COMPILE contains spaces
      [POWERPC] Fix xmon IRQ handler for pt_regs removal

commit dcf9065122660f4e3df02a47a75dc702d5531244
Author: Michael Ellerman <michael@ellerman.id.au>
Date:   Sat Sep 30 11:54:09 2006 +1000

    [POWERPC] Fix boot wrapper invocation if CROSS_COMPILE contains spaces
    
    My CROSS_COMPILE is "ccache /opt/compilers/blah", which confuses
    the boot wrapper script. Quote CROSS_COMPILE and CROSS32_COMPILE
    so they can safely contain spaces.
    
    Signed-off-by: Michael Ellerman <michael@ellerman.id.au>
    Signed-off-by: Paul Mackerras <paulus@samba.org>

commit eb328111efde7bca782f340fe805756039ec6a0c
Author: Thomas Graf <tgraf@suug.ch>
Date:   Mon Sep 18 00:01:59 2006 -0700

    [GENL]: Provide more information to userspace about registered genl families
    
    Additionaly exports the following information when providing
    the list of registered generic netlink families:
      - protocol version
      - header size
      - maximum number of attributes
      - list of available operations including
          - id
          - flags
          - avaiability of policy and doit/dumpit function
    
    libnl HEAD provides a utility to read this new information:
    
            0x0010 nlctrl version 1
                hdrsize 0 maxattr 6
                  op GETFAMILY (0x03) [POLICY,DOIT,DUMPIT]
            0x0011 NLBL_MGMT version 1
                hdrsize 0 maxattr 0
                  op unknown (0x02) [DOIT]
                  op unknown (0x03) [DOIT]
                  ....
    
    Signed-off-by: Thomas Graf <tgraf@suug.ch>
    Signed-off-by: David S. Miller <davem@davemloft.net>

commit 4c15343167b5febe7bb0ba96aad5bef42ae94d3b
Merge: eb36c2884a1a d0027bf09f09
Author: Linus Torvalds <torvalds@g5.osdl.org>
Date:   Wed Aug 30 21:44:06 2006 -0700

    Merge branch 'merge' of git://git.kernel.org/pub/scm/linux/kernel/git/paulus/powerpc
    
    * 'merge' of git://git.kernel.org/pub/scm/linux/kernel/git/paulus/powerpc:
      [POWERPC] Fix return value from memcpy
      [POWERPC] iseries: Define insw et al. so libata/ide will compile
      [POWERPC] Fix irq enable/disable in smp_generic_take_timebase
      [POWERPC] Fix problem with time not advancing on 32-bit platforms
      [POWERPC] Restore copyright notice in arch/powerpc/kernel/fpu.S
      [POWERPC] Fix up ibm_architecture_vec definition
      [POWERPC] Make OF irq map code detect more error cases
      [POWERPC] Support for "weird" MPICs and fixup mpc7448_hpc2
      [POWERPC] Fix MPIC sense codes in documentation
      [POWERPC] Fix performance regression in IRQ radix tree locking
      [POWERPC] Add mpc7448hpc2 device tree source file
      [POWERPC] Add MPC8349E MDS device tree source file to arch/powerpc/boot/dts
      [POWERPC] modify mpc83xx platforms to use new IRQ layer
      [POWERPC] Adapt ipic driver to new host_ops interface, add set_irq_type to set IRQ sense
      [POWERPC] back up old school ipic.[hc] to arch/ppc
      [POWERPC] Use mpc8641hpcn PIC base address from dev tree.
      [POWERPC] Allow MPC8641 HPCN to build with CONFIG_PCI disabled too.
      [POWERPC] Fix powerpc 44x_mmu build
      [POWERPC] Remove flush_dcache_all export

commit 7233593b7844c2db930594ee9c0c872a6900bfcc
Author: Zang Roy-r61911 <tie-fei.zang@freescale.com>
Date:   Fri Aug 25 14:16:30 2006 +1000

    [POWERPC] Support for "weird" MPICs and fixup mpc7448_hpc2
    
    This adds a new hardware information table for mpic. This enables
    the mpic code to deal with mpic controllers with different register
    layouts and hardware behaviours.
    
    This introduces CONFIG_MPIC_WEIRD.  For boards with non standard mpic
    controllers, select CONFIG_MPIC_WEIRD and add its hardware information
    in the mpic_infos[] array.
    
    TSI108/109 PIC takes the first index of weird hardware information
    table.  :)  The table can be extended. The Tsi108/109 PIC looks like
    standard OpenPIC but, in fact, is different in register mapping and
    behavior.
    
    The patch does not affect the behavior of standard mpic.  If
    CONFIG_MPIC_WEIRD is not defined, the code is essentially identical to
    the current code.
    
    [benh@kernel.crashing.org:
    This patch is a slightly cleaned up version of Zang Roy's support for
    the TSI108 MPIC variant. It also fixes up MPC7448_hpc2 to use the new
    version of the type macros and changes the way MPIC is selected in
    Kconfig to better match what is done for other system devices.
    ]
    
    Signed-off-by: Roy Zang <tie-fei.zang@freescale.com>
    Signed-off-by: Benjamin Herrenschmidt <benh@kernel.crashing.org>
    Signed-off-by: Paul Mackerras <paulus@samba.org>

commit 3efbdd136e52ee4028b5bb5b848a6043cf61cd6e
Author: Benjamin Herrenschmidt <benh@kernel.crashing.org>
Date:   Wed Aug 30 08:58:00 2006 +1000

    [POWERPC] Fix MPIC sense codes in documentation
    
    The booting-without-of.txt had incorrect definition for the sense codes
    for an OpenPIC controller
    
    Signed-off-by: Benjamin Herrenschmidt <benh@kernel.crashing.org>
    Signed-off-by: Paul Mackerras <paulus@samba.org>

commit c9eca0b91015bc685c2f35a50efc63d73fdf943a
Author: Sam Ravnborg <sam@mars.ravnborg.org>
Date:   Wed Aug 16 21:14:08 2006 +0200

    kbuild: correct assingment to CFLAGS with CROSS_COMPILE
    
    Some architectures change $CC in arch/$(ARCH)/Makefile
    mips is one example.
    
    That have impact on what options are supported by gcc so move all
    $(call cc-option, ...) after include of arch specific Makefile.
    
    Signed-off-by: Sam Ravnborg <sam@ravnborg.org>

commit 49b1e3ea19b1c95c2f012b8331ffb3b169e4c042
Merge: ce38cac48209 8d950cb8896f
Author: Linus Torvalds <torvalds@g5.osdl.org>
Date:   Mon Jul 31 13:39:52 2006 -0700

    Merge branch 'merge' of git://git.kernel.org/pub/scm/linux/kernel/git/paulus/powerpc
    
    * 'merge' of git://git.kernel.org/pub/scm/linux/kernel/git/paulus/powerpc:
      [POWERPC] Minor comment fix for misc_64.S
      [POWERPC] Use H_CEDE on non-SMT
      [POWERPC] force 64bit mode in fwnmi handlers to workaround firmware bugs
      [POWERPC] PMAC_APM_EMU should depend on ADB_PMU
      [POWERPC] Fix new interrupt code (MPIC detection)
      [POWERPC] Fix new interrupt code (MPIC endianness)
      [POWERPC] Add cpufreq support for Xserve G5
      [POWERPC] Xserve G5 thermal control fixes
      [POWERPC] Fix mem= handling when the memory limit is > RMO size
      [POWERPC] More offb/bootx fixes
      [POWERPC] Fix legacy_serial.c error handling on 32 bits
      [POWERPC] Fix default clock for udbg_16550
      [POWERPC] Fix non-MPIC CHRPs with CONFIG_SMP set
      [POWERPC] Fix 32 bits warning in prom_init.c
      [POWERPC] Workaround Pegasos incorrect ISA "ranges"
      [POWERPC] fix up front-LED Kconfig

commit 96278d21000568a9261f016e8b2569a95a2d4c9e
Author: Segher Boessenkool <segher@kernel.crashing.org>
Date:   Sat Jul 8 02:37:20 2006 +0200

    [POWERPC] Fix new interrupt code (MPIC detection)
    
    As the code comment already says, the Maple device-tree is incorrect here;
    make the Linux code detect the correct thing, too.
    
    Signed-off-by: Segher Boessenkool <segher@kernel.crashing.org>
    Acked-by: Benjamin Herrenschmidt <benh@kernel.crashing.org>
    Signed-off-by: Paul Mackerras <paulus@samba.org>

commit d319a03bf87209b3914fdf2ede88a2161123b3eb
Author: Segher Boessenkool <segher@kernel.crashing.org>
Date:   Sat Jul 8 02:37:23 2006 +0200

    [POWERPC] Fix new interrupt code (MPIC endianness)
    
    All U3/U4 based systems are big-endian, not all express it in their
    device trees.
    
    Signed-off-by: Segher Boessenkool <segher@kernel.crashing.org>
    Acked-by: Benjamin Herrenschmidt <benh@kernel.crashing.org>
    Signed-off-by: Paul Mackerras <paulus@samba.org>

commit 8cffc6ac66a2b251df2490702923611aa4ac1fc5
Author: Benjamin Herrenschmidt <benh@kernel.crashing.org>
Date:   Tue Jul 4 14:09:36 2006 +1000

    [POWERPC] Fix non-MPIC CHRPs with CONFIG_SMP set
    
    Pseudo-CHRP machines like Pegasos without an MPIC would crash at boot if
    CONFIG_SMP was set because the "smp_ops" pointer was set to MPIC related
    ops unconditionally. This patch makes it NULL on machines that don't
    support SMP and provides proper default behaviour in the callers when
    smp_ops is NULL.
    
    Signed-off-by: Benjamin Herrenschmidt <benh@kernel.crashing.org>
    Signed-off-by: Paul Mackerras <paulus@samba.org>

commit 06fe98e6369330d522705d5e67a2eddac2fd5bba
Author: Benjamin Herrenschmidt <benh@kernel.crashing.org>
Date:   Mon Jul 10 04:44:43 2006 -0700

    [PATCH] powerpc: fix MPIC OF tree parsing on Apple quad g5
    
    The quad g5 currently doesn't boot due to two problems.  This patch fixes the
    first one: Apple new way of doing interrupt specifiers in OF for devices using
    the HT APIC isn't properly parsed by the new MPIC driver code.
    
    Signed-off-by: Benjamin Herrenschmidt <benh@kernel.crashing.org>
    Cc: Paul Mackerras <paulus@samba.org>
    Signed-off-by: Andrew Morton <akpm@osdl.org>
    Signed-off-by: Linus Torvalds <torvalds@osdl.org>

commit 6e99e4582861578fb00d84d085f8f283569f51dd
Author: Benjamin Herrenschmidt <benh@kernel.crashing.org>
Date:   Mon Jul 10 04:44:42 2006 -0700

    [PATCH] powerpc: fix trigger handling in the new irq code
    
    This patch slightly reworks the new irq code to fix a small design error.  I
    removed the passing of the trigger to the map() calls entirely, it was not a
    good idea to have one call do two different things.  It also fixes a couple of
    corner cases.
    
    Mapping a linux virtual irq to a physical irq now does only that.  Setting the
    trigger is a different action which has a different call.
    
    The main changes are:
    
    - I no longer call host->ops->map() for an already mapped irq, I just return
      the virtual number that was already mapped.  It was called before to give an
      opportunity to change the trigger, but that was causing issues as that could
      happen while the interrupt was in use by a device, and because of the
      trigger change, map would potentially muck around with things in a racy way.
       That was causing much burden on a given's controller implementation of
      map() to get it right.  This is much simpler now.  map() is only called on
      the initial mapping of an irq, meaning that you know that this irq is _not_
      being used.  You can initialize the hardware if you want (though you don't
      have to).
    
    - Controllers that can handle different type of triggers (level/edge/etc...)
      now implement the standard irq_chip->set_type() call as defined by the
      generic code.  That means that you can use the standard set_irq_type() to
      configure an irq line manually if you wish or (though I don't like that
      interface), pass explicit trigger flags to request_irq() as defined by the
      generic kernel interfaces.  Also, using those interfaces guarantees that
      your controller set_type callback is called with the descriptor lock held,
      thus providing locking against activity on the same interrupt (including
      mask/unmask/etc...) automatically.  A result is that, for example, MPIC's
      own map() implementation calls irq_set_type(NONE) to configure the hardware
      to the default triggers.
    
    - To allow the above, the irq_map array entry for the new mapped interrupt
      is now set before map() callback is called for the controller.
    
    - The irq_create_of_mapping() (also used by irq_of_parse_and_map()) function
      for mapping interrupts from the device-tree now also call the separate
      set_irq_type(), and only does so if there is a change in the trigger type.
    
    - While I was at it, I changed pci_read_irq_line() (which is the helper I
      would expect most archs to use in their pcibios_fixup() to get the PCI
      interrupt routing from the device tree) to also handle a fallback when the
      DT mapping fails consisting of reading the PCI_INTERRUPT_PIN to know wether
      the device has an interrupt at all, and the the PCI_INTERRUPT_LINE to get an
      interrupt number from the device.  That number is then mapped using the
      default controller, and the trigger is set to level low.  That default
      behaviour works for several platforms that don't have a proper interrupt
      tree like Pegasos.  If it doesn't work for your platform, then either
      provide a proper interrupt tree from the firmware so that fallback isn't
      needed, or don't call pci_read_irq_line()
    
    - Add back a bit that got dropped by my main rework patch for properly
      clearing pending IPIs on pSeries when using a kexec
    
    Signed-off-by: Benjamin Herrenschmidt <benh@kernel.crashing.org>
    Cc: Paul Mackerras <paulus@samba.org>
    Signed-off-by: Andrew Morton <akpm@osdl.org>
    Signed-off-by: Linus Torvalds <torvalds@osdl.org>

commit 1e031d65b0cb5f882b20ebc356ea0345ff18dbf0
Author: Benjamin Herrenschmidt <benh@kernel.crashing.org>
Date:   Tue Jul 4 14:09:36 2006 +1000

    [POWERPC] Fix non-MPIC CHRPs with CONFIG_SMP set
    
    Pseudo-CHRP machines like Pegasos without an MPIC would crash at boot if
    CONFIG_SMP was set because the "smp_ops" pointer was set to MPIC related
    ops unconditionally. This patch makes it NULL on machines that don't
    support SMP and provides proper default behaviour in the callers when
    smp_ops is NULL.
    
    Signed-off-by: Benjamin Herrenschmidt <benh@kernel.crashing.org>
    Signed-off-by: Paul Mackerras <paulus@samba.org>

commit ba1826e5eced176cc9ec0033ad8ee0f1cd5ad2e4
Author: Benjamin Herrenschmidt <benh@kernel.crashing.org>
Date:   Wed Jul 5 15:36:15 2006 +1000

    [PATCH] powerpc: Fix loss of interrupts with MPIC
    
    With the new interrupt rework, an interrupt "host" map() callback can be
    called after the interrupt is already active.
    
    It's called again for an already mapped interrupt to allow changing the
    trigger setup, and currently this is not guarded with a test of wether
    the interrupt is requested or not.
    
    I plan to change some of this logic to be a bit less lenient against
    random reconfiguring of live interrupts but just not yet.
    
    The ported MPIC driver has a bug where when that happens, it will mask
    the interrupt.  This changes it to preserve the previous masking of the
    interrupt instead.
    
    Signed-off-by: Benjamin Herrenschmidt <benh@kernel.crashing.org>
    Signed-off-by: Linus Torvalds <torvalds@osdl.org>

commit 2076eb6ab8339bf09620a0160be3607bbbb61a50
Author: Eric Moore <eric.moore@lsil.com>
Date:   Tue Jun 27 14:39:06 2006 -0600

    [SCSI] fusion : mpi header update
    
    MPI Header Update
    
    Signed-off-by: Eric Moore <Eric.Moore@lsil.com>
    Signed-off-by: James Bottomley <James.Bottomley@SteelEye.com>

commit dd4cb9f8ac9717c9db2b2afc5a82cb95a3d5dec3
Author: Jack Steiner <steiner@sgi.com>
Date:   Sat Apr 22 09:37:19 2006 -0500

    [IA64-SGI] - Reduce overhead of reading sn_topology
    
    MPI programs using certain debug options have a long
    startup time. This was traced to a "vmalloc/vfree" in
    the code that reads /proc/sgi_sn/sn_topology. On large
    systems, vfree requires an IPI to all cpus to do TLB
    purging.
    
    Replace the vmalloc/vfree with kmalloc/kfree. Although
    the size of the structure being allocated is unknown, it
    will not not exceed 96 bytes.
    
    Signed-off-by: Jack Steiner <steiner@sgi.com>
    Signed-off-by: Tony Luck <tony.luck@intel.com>

commit a9aa0e24f7ed5acf2e0e1799fb28daf928293ba1
Merge: 7c1c3eb855b5 ee1cca1b0661
Author: Linus Torvalds <torvalds@g5.osdl.org>
Date:   Thu Apr 27 14:24:49 2006 -0700

    Merge branch 'upstream' of git://ftp.linux-mips.org/pub/scm/upstream-linus
    
    * 'upstream' of git://ftp.linux-mips.org/pub/scm/upstream-linus:
      [MIPS] Fix branch emulation for floating-point exceptions.
      [MIPS] Cleanup inode->r_dev usage.
      [MIPS] Update MIPS defconfigs.
      [MIPS] Get rid of CONFIG_ADVANCED.
      [MIPS] Kconfig: Clarify description of CROSSCOMPILE.
      [MIPS] 24K LV: Add core card id.
      [MIPS] Sparse: fix sparse for 64-bit kernels.
      [MIPS] Use __ffs() instead of ffs() in ip32_irq0().
      [MIPS] Fix bitops for MIPS32/MIPS64 CPUs.
      [MIPS] Fix ip27 build.
      [MIPS] Oprofile: fix sparse warning.
      [MIPS] Fix oprofile module unloading

commit 3763120a316b04c29a2b9c6e817e0e4a72005dd4
Author: Ralf Baechle <ralf@linux-mips.org>
Date:   Mon Apr 24 13:08:41 2006 +0100

    [MIPS] Kconfig: Clarify description of CROSSCOMPILE.
    
    Signed-off-by: Ralf Baechle <ralf@linux-mips.org>

commit 2e1ca21d46aaef95101723fa402f39d3a95aba59
Merge: 315ab19a6d12 eae0f536f640
Author: Linus Torvalds <torvalds@g5.osdl.org>
Date:   Sat Mar 25 08:48:48 2006 -0800

    Merge master.kernel.org:/pub/scm/linux/kernel/git/sam/kbuild
    
    * master.kernel.org:/pub/scm/linux/kernel/git/sam/kbuild: (46 commits)
      kbuild: remove obsoleted scripts/reference_* files
      kbuild: fix make help & make *pkg
      kconfig: fix time ordering of writes to .kconfig.d and include/linux/autoconf.h
      Kconfig: remove the CONFIG_CC_ALIGN_* options
      kbuild: add -fverbose-asm to i386 Makefile
      kbuild: clean-up genksyms
      kbuild: Lindent genksyms.c
      kbuild: fix genksyms build error
      kbuild: in makefile.txt note that Makefile is preferred name for kbuild files
      kbuild: replace PHONY with FORCE
      kbuild: Fix bug in crc symbol generating of kernel and modules
      kbuild: change kbuild to not rely on incorrect GNU make behavior
      kbuild: when warning symbols exported twice now tell user this is the problem
      kbuild: fix make dir/file.xx when asm symlink is missing
      kbuild: in the section mismatch check try harder to find symbols
      kbuild: fix section mismatch check for unwind on IA64
      kbuild: kill false positives from section mismatch warnings for powerpc
      kbuild: kill trailing whitespace in modpost & friends
      kbuild: small update of allnoconfig description
      kbuild: make namespace.pl CROSS_COMPILE happy
      ...
    
    Trivial conflict in arch/ppc/boot/Makefile manually fixed up

commit 87fd1a11ae91ab42fac978467667c61fee9f01da
Author: Sean Hefty <sean.hefty@intel.com>
Date:   Thu Mar 2 16:50:37 2006 -0800

    IB/cm: Check cm_id state before handling a REP
    
    Move checking the state of a cm_id before modifying it when handling a
    REP.  This fixes a bug seen under MPI scale-up testing, where a NULL
    timewait_info pointer is dereferenced if a request times out before a
    REP is received.
    
    Signed-off-by: Sean Hefty <sean.hefty@intel.com>
    Signed-off-by: Roland Dreier <rolandd@cisco.com>

commit e6b2d76a49f0ee48527691867d8af2b8f9c10452
Author: Moore, Eric <Eric.Moore@lsil.com>
Date:   Tue Mar 14 09:14:24 2006 -0700

    [SCSI] fusion - expander hotplug suport in mptsas module
    
    This adds support for hot adding and removing
    expanders, and its associated attached devices.
    When there is a change in topology,
    the fusion firmware sends the
    MPI_EVENT_SAS_DISCOVERY event to the driver.
    The driver will read firmware config pages
    to determine what changes took place, and refresh
    drivers view of the world stored in ioc->sas_topology.
    
    Here is the details of the action the driver does:
    
    (1) Expander Added :  The mptsas_discovery_work
    workqueue is called.  Config pages read, and
    ioc->sas_topology is refreshed.  The sas_phy_add()
    is called for each phy of the expander.  The
    expanders attached devices are added via
    sas_rphy_add().  Added end devices are handled within
    the MPT_ADD_DEVICE logic in  mptsas_hotplug_work
    workqueue.
    
    (2) Expander Delete : The sas_rphy_delete() will be
    called for the top most compenent of the parent that the
    expander is attached to.  The sas_rphy_delete call
    will delete all the children phys, rphys, and end devices.
    This is handled from mptsas_discovery_work workqueue.
    
    Signed-off-by: Eric Moore <Eric.Moore@lsil.com>
    Signed-off-by: James Bottomley <James.Bottomley@SteelEye.com>

commit 3a25f0b19f2eefd158955ab809c8947ed8feadf1
Author: Aaron Brooks <aaron.brooks@sicortex.com>
Date:   Sun Feb 26 22:25:46 2006 -0500

    kbuild: make namespace.pl CROSS_COMPILE happy
    
    Using the fixed path to /usr/bin/{nm,objdump} does not allow
    CROSS_COMPILE environments to use namespace.pl. This patch causes
    namespace.pl to use $NM and $OBJDUMP if defined or fall back to the nm
    and objdump found in the path.
    
    Signed-off-by: Aaron Brooks <aaron.brooks@sicortex.com>
    Signed-off-by: Sam Ravnborg <sam@ravnborg.org>

commit 72b138198cd6307c679b35d677ed64105b94ab48
Author: Segher Boessenkool <segher@kernel.crashing.org>
Date:   Fri Feb 17 11:25:42 2006 +0100

    [PATCH] powerpc: Fix some MPIC + HT APIC buglets
    
    Do disable, not enable, the HT APIC IRQ in the function that is
    supposed to.
    Enable the MPIC IRQ before enabling the downstream APIC IRQ, avoids
    potentially losing an interrupt.
    
    Signed-off-by: Segher Boessenkool <segher@kernel.crashing.org>
    Acked-by: Benjamin Herrenschmidt <benh@kernel.crashing.org>
    Signed-off-by: Paul Mackerras <paulus@samba.org>

commit 2f7016d917faef8f1e016b4a7bd7f594694480b6
Author: Jack Steiner <steiner@sgi.com>
Date:   Wed Feb 1 03:05:18 2006 -0800

    [PATCH] sys_sched_getaffinity() & hotplug
    
    Change sched_getaffinity() so that it returns a bitmap that indicates the
    legally schedulable cpus that a task is allowed to run on.
    
    Without this patch, if CONFIG_HOTPLUG_CPU is enabled, sched_getaffinity()
    unconditionally returns (at least on IA64) a mask with NR_CPUS bits set.
    This conveys no useful infornmation except for a kernel compile option.
    
    This fixes a breakage we obseved running recent kernels. We have MPI jobs
    that use sched_getaffinity() to determine where to place their threads.
    Placing them on non-existant cpus is problematic :-)
    
    Signed-off-by: Jack Steiner <steiner@sgi.com>
    Acked-by: Ingo Molnar <mingo@elte.hu>
    Cc: Nathan Lynch <ntl@pobox.com>
    Cc: Paul Jackson <pj@sgi.com>
    Signed-off-by: Andrew Morton <akpm@osdl.org>
    Signed-off-by: Linus Torvalds <torvalds@osdl.org>

commit 569b11dcfa9d764e775f9e964a680c32265ab7f2
Author: Moore, Eric <Eric.Moore@lsil.com>
Date:   Fri Jan 13 16:25:29 2006 -0700

    [SCSI] fusion - fix pci express bug
    
    The fix is to write  'MPI_HIM_DIM' to the Host Interrupt Mask
    register, when enabling interrupts.  Instead of the
    tilde of MPI_HIM_RIM.
    
    Apparently writing '1's to some of the reserved bits was causing
    all the bits to go to `1`, which effectly disabled all interrupts.
    
    Signed-off-by: Eric Moore <Eric.Moore@lsil.com>
    Signed-off-by: James Bottomley <James.Bottomley@SteelEye.com>

commit c4b22f268914ff824a6334b62afd23f7ad79df11
Author: Segher Boessenkool <segher@kernel.crashing.org>
Date:   Tue Dec 13 18:04:29 2005 +1100

    [PATCH] powerpc: Update MPIC workarounds
    
    Cleanup the MPIC IO-APIC workarounds, make them a bit more generic,
    smaller and faster.
    
    Signed-off-by: Segher Boessenkool <segher@kernel.crashing.org>
    Signed-off-by: Benjamin Herrenschmidt <benh@kernel.crashing.org>
    Signed-off-by: Paul Mackerras <paulus@samba.org>

commit e53566409c38d38680cc02299fa9fa5fe8623e9f
Author: Benjamin Herrenschmidt <benh@kernel.crashing.org>
Date:   Fri Nov 18 17:18:15 2005 +1100

    [PATCH] powerpc: Fix setting MPIC priority
    
    Trying to set the priority would just disable the interrupt due to an
    incorrect mask used. We rarely use that call, in fact, I think only in
    the powermac code for the cmd-power key combo that triggers xmon. So it
    got unnoticed for a while.
    
    Signed-off-by: Benjamin Herrenschmidt <benh@kernel.crashing.org>
    Signed-off-by: Paul Mackerras <paulus@samba.org>

commit bd561c79dce9036c9efb17420b6cf8763c8c9de3
Author: Paul Mackerras <paulus@samba.org>
Date:   Wed Oct 26 21:55:33 2005 +1000

    powerpc: Fix incorrect timer register addresses in mpic.c
    
    We were computing the wrong address for the MPIC timer registers,
    so when we went to initialize them we would have been hitting some
    unrelated ioremap... oops.
    
    Signed-off-by: Paul Mackerras <paulus@samba.org>

commit 5beb5f32c56b70f79117e13a1abd54824a78466c
Author: Randolph Chung <tausq@parisc-linux.org>
Date:   Fri Oct 21 22:52:00 2005 -0400

    [PARISC] Update minimum compiler version and CROSS_COMPILE for parisc64
    
    Prefix changed in debian, include "gnu" in the commandline.
    
    Signed-off-by: Carlos O'Donell <carlos@parisc-linux.org>
    
    Ensure the compiler version is new enough (>= 3.3)
    
    Signed-off-by: Randolph Chung <tausq@parisc-linux.org>
    
    Signed-off-by: Kyle McMartin <kyle@parisc-linux.org>

commit 0f8e2d62fa04441cd12c08ce521e84e5bd3f8a46
Author: Ian Campbell <icampbell@arcom.com>
Date:   Thu Jun 23 00:08:10 2005 -0700

    [PATCH] use ${CROSS_COMPILE}installkernel in arch/*/boot/install.sh
    
    The attached patch causes the various arch specific install.sh scripts to
    look for ${CROSS_COMPILE}installkernel rather than just installkernel (in
    both /sbin/ and ~/bin/ where the script already did this).  This allows you
    to have e.g.  arm-linux-installkernel as a handy way to install on your
    cross target.  It also prevents the script picking up on the host
    /sbin/installkernel which causes the script to fall through and do the
    install itself (which is what I actually use myself, with $INSTALL_PATH
    set).
    
    I don't believe it causes back-compatibility problems since calling the
    host installkernel was never likely to work or be what you wanted when
    cross compiling anyway.  If $CROSS_COMPILE isn't set then nothing changes.
    
    I only use ARM and i386 myself but I figured it couldn't hurt to do the
    whole lot.  I've cc'd those who I hope are the arch maintainers for files
    that I've touched.
    
    Signed-off-by: Ian Campbell <icampbell@arcom.com>
    Signed-off-by: Andrew Morton <akpm@osdl.org>
    Signed-off-by: Linus Torvalds <torvalds@osdl.org>

commit f14f75b81187cdbe10cc53a521bf9fdf97b59f8c
Author: Jes Sorensen <jes@wildopensource.com>
Date:   Tue Jun 21 17:15:02 2005 -0700

    [PATCH] ia64 uncached alloc
    
    This patch contains the ia64 uncached page allocator and the generic
    allocator (genalloc).  The uncached allocator was formerly part of the SN2
    mspec driver but there are several other users of it so it has been split
    off from the driver.
    
    The generic allocator can be used by device driver to manage special memory
    etc.  The generic allocator is based on the allocator from the sym53c8xx_2
    driver.
    
    Various users on ia64 needs uncached memory.  The SGI SN architecture requires
    it for inter-partition communication between partitions within a large NUMA
    cluster.  The specific user for this is the XPC code.  Another application is
    large MPI style applications which use it for synchronization, on SN this can
    be done using special 'fetchop' operations but it also benefits non SN
    hardware which may use regular uncached memory for this purpose.  Performance
    of doing this through uncached vs cached memory is pretty substantial.  This
    is handled by the mspec driver which I will push out in a seperate patch.
    
    Rather than creating a specific allocator for just uncached memory I came up
    with genalloc which is a generic purpose allocator that can be used by device
    drivers and other subsystems as they please.  For instance to handle onboard
    device memory.  It was derived from the sym53c7xx_2 driver's allocator which
    is also an example of a potential user (I am refraining from modifying sym2
    right now as it seems to have been under fairly heavy development recently).
    
    On ia64 memory has various properties within a granule, ie.  it isn't safe to
    access memory as uncached within the same granule as currently has memory
    accessed in cached mode.  The regular system therefore doesn't utilize memory
    in the lower granules which is mixed in with device PAL code etc.  The
    uncached driver walks the EFI memmap and pulls out the spill uncached pages
    and sticks them into the uncached pool.  Only after these chunks have been
    utilized, will it start converting regular cached memory into uncached memory.
    Hence the reason for the EFI related code additions.
    
    Signed-off-by: Jes Sorensen <jes@wildopensource.com>
    Signed-off-by: Andrew Morton <akpm@osdl.org>
    Signed-off-by: Linus Torvalds <torvalds@osdl.org>

commit 41480af27a85d6008d9e11db8bc2730407c25e1d
Author: Dan Williams <dcbw@redhat.com>
Date:   Tue May 10 09:45:51 2005 -0400

    [PATCH] wireless/airo: WEXT and quality corrections
    
    This patch brings the airo driver into line with the current
    WEXT specification of signal quality.  It also fixes the values
    used to determine signal quality and level for MPI & PCMCIA 350
    cards.  It turns out that BSSListRid.rssi was actually in dBm
    for 350 series cards, and that we can use the normalized
    signal strength reported by the card as our "quality" value, on
    a scale of 0 - 100.  Since signal level values are in dBm for
    this driver, max_qual->level MUST be 0, as specified in the WEXT
    spec.  This patch also uses the IW_QUAL constants new in WEXT
    version 17.
    
    Signed-off-by: Dan Williams <dcbw@redhat.com>
